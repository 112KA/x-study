var j=i=>{throw TypeError(i)};var y=(i,e,t)=>e.has(i)||j("Cannot "+t);var s=(i,e,t)=>(y(i,e,"read from private field"),t?t.call(i):e.get(i)),r=(i,e,t)=>e.has(i)?j("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(i):e.set(i,t),n=(i,e,t,a)=>(y(i,e,"write to private field"),a?a.call(i,t):e.set(i,t),t),p=(i,e,t)=>(y(i,e,"access private method"),t);import"./global-BgcujqX7.js";import{k as G,P as V,l as q,W as U,O as Z,m as W,$,b as J,t as N,a0 as K,_ as Q,a1 as X}from"./vendor-7bT8h9h2.js";import{a as Y,n as tt}from"./x-CdHasm9z.js";import{I as O,A as et,a as st}from"./x3-BoGYenvZ.js";class it{constructor({canvas:e}){var a;this.scene=new G,this.camera=new V(45,1,.1,1e4),this._stats=q(),this.renderer=new U({canvas:e,antialias:!1,alpha:!1}),this.renderer.setClearColor(0,0),this.renderer.setPixelRatio(1),this.camera.position.set(0,5,10),this._cameraControls=new Z(this.camera,this.renderer.domElement);const t=[];t[0]=new W(16777215,1,0),t[1]=new W(16777215,1,0),t[2]=new W(16777215,1,0),t[0].position.set(0,200,0),t[1].position.set(100,200,100),t[2].position.set(-100,-200,-100),this.scene.add(...t),this.grid=new $(40,20),this.scene.add(this.grid),(a=document.querySelector("body"))==null||a.appendChild(this._stats.dom)}render(){this._cameraControls.update(),this.renderer.render(this.scene,this.camera),this._stats.update()}resize(){const e=window.innerWidth,t=window.innerHeight;this.renderer.setSize(e,t),this.camera.aspect=e/t,this.camera.updateProjectionMatrix()}setDeviceSize(e){console.log({deviceSize:e})}}var u,m,c,h,o,b,d,x,l,L,_;class at{constructor(e,t,a){r(this,l);r(this,u);r(this,m);r(this,c);r(this,h);r(this,o);r(this,b);r(this,d);r(this,x);this.instanceIndex=e,n(this,u,!0),this.matrix=new J,n(this,h,{}),n(this,o,""),n(this,d,new N((.5-Math.random())*40,0,(.5-Math.random())*40)),n(this,x,new N(1,1,1)),n(this,m,new K(t)),n(this,c,t),n(this,b,s(this,c).matrix.clone().invert()),s(this,h).idle=s(this,m).clipAction(a[0]),s(this,h).running=s(this,m).clipAction(a[1]),p(this,l,L).call(this)}update(e){s(this,u)&&(s(this,o)==="running"&&(s(this,d).z+=.06,s(this,d).z>20&&(s(this,d).z=-20),p(this,l,_).call(this)),s(this,m).update(e),s(this,c).updateMatrixWorld(),s(this,c).traverse(t=>{if(t instanceof O){t.updateMatrixWorld();for(const a of t.skeleton.bones)a.updateMatrixWorld();t.skeleton.updateAt(this.instanceIndex)}}))}executeCrossFade(e,t,a){this.setWeight(t,1),e.crossFadeTo(t,a,!1)}setWeight(e,t){e.enabled=!0,e.setEffectiveTimeScale(1),e.setEffectiveWeight(t)}set enabled(e){n(this,u,e);const t=s(this,u)?1:0;s(this,x).setScalar(t),p(this,l,_).call(this)}}u=new WeakMap,m=new WeakMap,c=new WeakMap,h=new WeakMap,o=new WeakMap,b=new WeakMap,d=new WeakMap,x=new WeakMap,l=new WeakSet,L=async function(){switch(s(this,o)){case"":s(this,h).running.play(),s(this,h).idle.play(),s(this,h).idle.setEffectiveWeight(0),n(this,o,"running");break;case"idle":this.executeCrossFade(s(this,h).idle,s(this,h).running,.5),n(this,o,"running");break;case"running":this.executeCrossFade(s(this,h).running,s(this,h).idle,.5),n(this,o,"idle");break}await Y(5e3+5e3*Math.random()),p(this,l,L).call(this)},_=function(){this.matrix.identity(),this.matrix.scale(s(this,x)),this.matrix.setPosition(s(this,d).clone().applyMatrix4(s(this,b))),s(this,c).traverse(e=>{e instanceof O&&(e.setMatrixAt(this.instanceIndex,this.matrix),e.updateMatrix())})};var w,M,v,I,C,P;class nt{constructor({renderer:e,grid:t},a){r(this,C);r(this,w);r(this,M);r(this,v);r(this,I);n(this,w,new Q.Pane),this.n=100,this.drawcalls="0",n(this,M,e),n(this,v,a),n(this,I,s(this,w).addInput(this,"drawcalls",{disabled:!0})),s(this,w).addInput(this,"n",{min:1,max:300,step:1}).on("change",k=>{p(this,C,P).call(this)}),p(this,C,P).call(this),s(this,w).addInput(t,"visible",{label:"grid"})}update(){this.drawcalls=s(this,M).info.render.calls.toString(),s(this,I).refresh()}}w=new WeakMap,M=new WeakMap,v=new WeakMap,I=new WeakMap,C=new WeakSet,P=function(){s(this,v).forEach((e,t)=>{e.enabled=t<this.n})};const rt="/sketches/assets/model-CdoVpRZ-.glb",B=document.getElementById("canvas");tt(B);const g=new it({canvas:B}),z=new et,E=300;async function ht(){z.addResources([{name:"model",path:rt}]),await z.load();const{scene:i,animations:e}=z.models.model,t=i.getObjectByName("Armature"),a=st.convertToInstancedObject(t,E),k=new X(a);g.scene.add(a),a.updateMatrix(),k.material.linewidth=2,g.scene.add(k);let D=0;const S=[];for(let f=0;f<E;f++)S.push(new at(f,a,e));const F=new nt(g,S);let H=0;g.renderer.setAnimationLoop(f=>{if(H++%2===0)return;const R=(f-D)/1e3;for(let A=0;A<E;A++)S[A].update(R);g.render(),D=f,F.update()}),T(),window.addEventListener("resize",T)}function T(){g.resize()}ht();
