/*! For license information please see main.d1a10fad.js.LICENSE.txt */
!function(){var e={7362:function(e,t,n){"use strict";n.d(t,{Z:function(){return ie}});var o=function(){function e(e){var t=this;this._insertTag=function(e){var n;n=0===t.tags.length?t.insertionPoint?t.insertionPoint.nextSibling:t.prepend?t.container.firstChild:t.before:t.tags[t.tags.length-1].nextSibling,t.container.insertBefore(e,n),t.tags.push(e)},this.isSpeedy=void 0===e.speedy||e.speedy,this.tags=[],this.ctr=0,this.nonce=e.nonce,this.key=e.key,this.container=e.container,this.prepend=e.prepend,this.insertionPoint=e.insertionPoint,this.before=null}var t=e.prototype;return t.hydrate=function(e){e.forEach(this._insertTag)},t.insert=function(e){this.ctr%(this.isSpeedy?65e3:1)===0&&this._insertTag(function(e){var t=document.createElement("style");return t.setAttribute("data-emotion",e.key),void 0!==e.nonce&&t.setAttribute("nonce",e.nonce),t.appendChild(document.createTextNode("")),t.setAttribute("data-s",""),t}(this));var t=this.tags[this.tags.length-1];if(this.isSpeedy){var n=function(e){if(e.sheet)return e.sheet;for(var t=0;t<document.styleSheets.length;t++)if(document.styleSheets[t].ownerNode===e)return document.styleSheets[t]}(t);try{n.insertRule(e,n.cssRules.length)}catch(o){0}}else t.appendChild(document.createTextNode(e));this.ctr++},t.flush=function(){this.tags.forEach((function(e){return e.parentNode&&e.parentNode.removeChild(e)})),this.tags=[],this.ctr=0},e}(),r=Math.abs,i=String.fromCharCode,a=Object.assign;function s(e){return e.trim()}function u(e,t,n){return e.replace(t,n)}function c(e,t){return e.indexOf(t)}function l(e,t){return 0|e.charCodeAt(t)}function d(e,t,n){return e.slice(t,n)}function p(e){return e.length}function f(e){return e.length}function h(e,t){return t.push(e),e}var g=1,v=1,m=0,_=0,y=0,M="";function I(e,t,n,o,r,i,a){return{value:e,root:t,parent:n,type:o,props:r,children:i,line:g,column:v,length:a,return:""}}function C(e,t){return a(I("",null,null,"",null,null,0),e,{length:-e.length},t)}function k(){return y=_>0?l(M,--_):0,v--,10===y&&(v=1,g--),y}function T(){return y=_<m?l(M,_++):0,v++,10===y&&(v=1,g++),y}function S(){return l(M,_)}function b(){return _}function D(e,t){return d(M,e,t)}function E(e){switch(e){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function A(e){return g=v=1,m=p(M=e),_=0,[]}function L(e){return M="",e}function R(e){return s(D(_-1,N(91===e?e+2:40===e?e+1:e)))}function w(e){for(;(y=S())&&y<33;)T();return E(e)>2||E(y)>3?"":" "}function O(e,t){for(;--t&&T()&&!(y<48||y>102||y>57&&y<65||y>70&&y<97););return D(e,b()+(t<6&&32==S()&&32==T()))}function N(e){for(;T();)switch(y){case e:return _;case 34:case 39:34!==e&&39!==e&&N(y);break;case 40:41===e&&N(e);break;case 92:T()}return _}function P(e,t){for(;T()&&e+y!==57&&(e+y!==84||47!==S()););return"/*"+D(t,_-1)+"*"+i(47===e?e:T())}function G(e){for(;!E(S());)T();return D(e,_)}var U="-ms-",x="-moz-",F="-webkit-",q="comm",B="rule",V="decl",H="@import",K="@keyframes";function j(e,t){for(var n="",o=f(e),r=0;r<o;r++)n+=t(e[r],r,e,t)||"";return n}function z(e,t,n,o){switch(e.type){case H:case V:return e.return=e.return||e.value;case q:return"";case K:return e.return=e.value+"{"+j(e.children,o)+"}";case B:e.value=e.props.join(",")}return p(n=j(e.children,o))?e.return=e.value+"{"+n+"}":""}function Z(e){return L(W("",null,null,null,[""],e=A(e),0,[0],e))}function W(e,t,n,o,r,a,s,d,f){for(var g=0,v=0,m=s,_=0,y=0,M=0,I=1,C=1,D=1,E=0,A="",L=r,N=a,U=o,x=A;C;)switch(M=E,E=T()){case 40:if(108!=M&&58==l(x,m-1)){-1!=c(x+=u(R(E),"&","&\f"),"&\f")&&(D=-1);break}case 34:case 39:case 91:x+=R(E);break;case 9:case 10:case 13:case 32:x+=w(M);break;case 92:x+=O(b()-1,7);continue;case 47:switch(S()){case 42:case 47:h(J(P(T(),b()),t,n),f);break;default:x+="/"}break;case 123*I:d[g++]=p(x)*D;case 125*I:case 59:case 0:switch(E){case 0:case 125:C=0;case 59+v:y>0&&p(x)-m&&h(y>32?X(x+";",o,n,m-1):X(u(x," ","")+";",o,n,m-2),f);break;case 59:x+=";";default:if(h(U=Y(x,t,n,g,v,r,d,A,L=[],N=[],m),a),123===E)if(0===v)W(x,t,U,U,L,a,m,d,N);else switch(99===_&&110===l(x,3)?100:_){case 100:case 109:case 115:W(e,U,U,o&&h(Y(e,U,U,0,0,r,d,A,r,L=[],m),N),r,N,m,d,o?L:N);break;default:W(x,U,U,U,[""],N,0,d,N)}}g=v=y=0,I=D=1,A=x="",m=s;break;case 58:m=1+p(x),y=M;default:if(I<1)if(123==E)--I;else if(125==E&&0==I++&&125==k())continue;switch(x+=i(E),E*I){case 38:D=v>0?1:(x+="\f",-1);break;case 44:d[g++]=(p(x)-1)*D,D=1;break;case 64:45===S()&&(x+=R(T())),_=S(),v=m=p(A=x+=G(b())),E++;break;case 45:45===M&&2==p(x)&&(I=0)}}return a}function Y(e,t,n,o,i,a,c,l,p,h,g){for(var v=i-1,m=0===i?a:[""],_=f(m),y=0,M=0,C=0;y<o;++y)for(var k=0,T=d(e,v+1,v=r(M=c[y])),S=e;k<_;++k)(S=s(M>0?m[k]+" "+T:u(T,/&\f/g,m[k])))&&(p[C++]=S);return I(e,t,n,0===i?B:l,p,h,g)}function J(e,t,n){return I(e,t,n,q,i(y),d(e,2,-2),0)}function X(e,t,n,o){return I(e,t,n,V,d(e,0,o),d(e,o+1,-1),o)}var $=function(e,t,n){for(var o=0,r=0;o=r,r=S(),38===o&&12===r&&(t[n]=1),!E(r);)T();return D(e,_)},Q=function(e,t){return L(function(e,t){var n=-1,o=44;do{switch(E(o)){case 0:38===o&&12===S()&&(t[n]=1),e[n]+=$(_-1,t,n);break;case 2:e[n]+=R(o);break;case 4:if(44===o){e[++n]=58===S()?"&\f":"",t[n]=e[n].length;break}default:e[n]+=i(o)}}while(o=T());return e}(A(e),t))},ee=new WeakMap,te=function(e){if("rule"===e.type&&e.parent&&!(e.length<1)){for(var t=e.value,n=e.parent,o=e.column===n.column&&e.line===n.line;"rule"!==n.type;)if(!(n=n.parent))return;if((1!==e.props.length||58===t.charCodeAt(0)||ee.get(n))&&!o){ee.set(e,!0);for(var r=[],i=Q(t,r),a=n.props,s=0,u=0;s<i.length;s++)for(var c=0;c<a.length;c++,u++)e.props[u]=r[s]?i[s].replace(/&\f/g,a[c]):a[c]+" "+i[s]}}},ne=function(e){if("decl"===e.type){var t=e.value;108===t.charCodeAt(0)&&98===t.charCodeAt(2)&&(e.return="",e.value="")}};function oe(e,t){switch(function(e,t){return 45^l(e,0)?(((t<<2^l(e,0))<<2^l(e,1))<<2^l(e,2))<<2^l(e,3):0}(e,t)){case 5103:return F+"print-"+e+e;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return F+e+e;case 5349:case 4246:case 4810:case 6968:case 2756:return F+e+x+e+U+e+e;case 6828:case 4268:return F+e+U+e+e;case 6165:return F+e+U+"flex-"+e+e;case 5187:return F+e+u(e,/(\w+).+(:[^]+)/,F+"box-$1$2"+U+"flex-$1$2")+e;case 5443:return F+e+U+"flex-item-"+u(e,/flex-|-self/,"")+e;case 4675:return F+e+U+"flex-line-pack"+u(e,/align-content|flex-|-self/,"")+e;case 5548:return F+e+U+u(e,"shrink","negative")+e;case 5292:return F+e+U+u(e,"basis","preferred-size")+e;case 6060:return F+"box-"+u(e,"-grow","")+F+e+U+u(e,"grow","positive")+e;case 4554:return F+u(e,/([^-])(transform)/g,"$1"+F+"$2")+e;case 6187:return u(u(u(e,/(zoom-|grab)/,F+"$1"),/(image-set)/,F+"$1"),e,"")+e;case 5495:case 3959:return u(e,/(image-set\([^]*)/,F+"$1$`$1");case 4968:return u(u(e,/(.+:)(flex-)?(.*)/,F+"box-pack:$3"+U+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+F+e+e;case 4095:case 3583:case 4068:case 2532:return u(e,/(.+)-inline(.+)/,F+"$1$2")+e;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(p(e)-1-t>6)switch(l(e,t+1)){case 109:if(45!==l(e,t+4))break;case 102:return u(e,/(.+:)(.+)-([^]+)/,"$1"+F+"$2-$3$1"+x+(108==l(e,t+3)?"$3":"$2-$3"))+e;case 115:return~c(e,"stretch")?oe(u(e,"stretch","fill-available"),t)+e:e}break;case 4949:if(115!==l(e,t+1))break;case 6444:switch(l(e,p(e)-3-(~c(e,"!important")&&10))){case 107:return u(e,":",":"+F)+e;case 101:return u(e,/(.+:)([^;!]+)(;|!.+)?/,"$1"+F+(45===l(e,14)?"inline-":"")+"box$3$1"+F+"$2$3$1"+U+"$2box$3")+e}break;case 5936:switch(l(e,t+11)){case 114:return F+e+U+u(e,/[svh]\w+-[tblr]{2}/,"tb")+e;case 108:return F+e+U+u(e,/[svh]\w+-[tblr]{2}/,"tb-rl")+e;case 45:return F+e+U+u(e,/[svh]\w+-[tblr]{2}/,"lr")+e}return F+e+U+e+e}return e}var re=[function(e,t,n,o){if(e.length>-1&&!e.return)switch(e.type){case V:e.return=oe(e.value,e.length);break;case K:return j([C(e,{value:u(e.value,"@","@"+F)})],o);case B:if(e.length)return function(e,t){return e.map(t).join("")}(e.props,(function(t){switch(function(e,t){return(e=t.exec(e))?e[0]:e}(t,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return j([C(e,{props:[u(t,/:(read-\w+)/,":"+x+"$1")]})],o);case"::placeholder":return j([C(e,{props:[u(t,/:(plac\w+)/,":"+F+"input-$1")]}),C(e,{props:[u(t,/:(plac\w+)/,":"+x+"$1")]}),C(e,{props:[u(t,/:(plac\w+)/,U+"input-$1")]})],o)}return""}))}}],ie=function(e){var t=e.key;if("css"===t){var n=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(n,(function(e){-1!==e.getAttribute("data-emotion").indexOf(" ")&&(document.head.appendChild(e),e.setAttribute("data-s",""))}))}var r=e.stylisPlugins||re;var i,a,s={},u=[];i=e.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+t+' "]'),(function(e){for(var t=e.getAttribute("data-emotion").split(" "),n=1;n<t.length;n++)s[t[n]]=!0;u.push(e)}));var c,l,d=[z,(l=function(e){c.insert(e)},function(e){e.root||(e=e.return)&&l(e)})],p=function(e){var t=f(e);return function(n,o,r,i){for(var a="",s=0;s<t;s++)a+=e[s](n,o,r,i)||"";return a}}([te,ne].concat(r,d));a=function(e,t,n,o){c=n,j(Z(e?e+"{"+t.styles+"}":t.styles),p),o&&(h.inserted[t.name]=!0)};var h={key:t,sheet:new o({key:t,container:i,nonce:e.nonce,speedy:e.speedy,prepend:e.prepend,insertionPoint:e.insertionPoint}),nonce:e.nonce,inserted:s,registered:{},insert:a};return h.sheet.hydrate(u),h}},1124:function(e,t){"use strict";t.Z=function(e){var t=Object.create(null);return function(n){return void 0===t[n]&&(t[n]=e(n)),t[n]}}},1469:function(e,t,n){"use strict";n.d(t,{E:function(){return g},T:function(){return d},c:function(){return f},h:function(){return u},w:function(){return l}});var o=n(3371),r=n(7362),i=n(6805),a=n(7758),s=n(527),u={}.hasOwnProperty,c=(0,o.createContext)("undefined"!==typeof HTMLElement?(0,r.Z)({key:"css"}):null);c.Provider;var l=function(e){return(0,o.forwardRef)((function(t,n){var r=(0,o.useContext)(c);return e(t,r,n)}))},d=(0,o.createContext)({});var p="__EMOTION_TYPE_PLEASE_DO_NOT_USE__",f=function(e,t){var n={};for(var o in t)u.call(t,o)&&(n[o]=t[o]);return n[p]=e,n},h=function(e){var t=e.cache,n=e.serialized,o=e.isStringTag;(0,i.hC)(t,n,o);(0,s.L)((function(){return(0,i.My)(t,n,o)}));return null},g=l((function(e,t,n){var r=e.css;"string"===typeof r&&void 0!==t.registered[r]&&(r=t.registered[r]);var s=e[p],c=[r],l="";"string"===typeof e.className?l=(0,i.fp)(t.registered,c,e.className):null!=e.className&&(l=e.className+" ");var f=(0,a.O)(c,void 0,(0,o.useContext)(d));l+=t.key+"-"+f.name;var g={};for(var v in e)u.call(e,v)&&"css"!==v&&v!==p&&(g[v]=e[v]);return g.ref=n,g.className=l,(0,o.createElement)(o.Fragment,null,(0,o.createElement)(h,{cache:t,serialized:f,isStringTag:"string"===typeof s}),(0,o.createElement)(s,g))}))},7758:function(e,t,n){"use strict";n.d(t,{O:function(){return g}});var o=function(e){for(var t,n=0,o=0,r=e.length;r>=4;++o,r-=4)t=1540483477*(65535&(t=255&e.charCodeAt(o)|(255&e.charCodeAt(++o))<<8|(255&e.charCodeAt(++o))<<16|(255&e.charCodeAt(++o))<<24))+(59797*(t>>>16)<<16),n=1540483477*(65535&(t^=t>>>24))+(59797*(t>>>16)<<16)^1540483477*(65535&n)+(59797*(n>>>16)<<16);switch(r){case 3:n^=(255&e.charCodeAt(o+2))<<16;case 2:n^=(255&e.charCodeAt(o+1))<<8;case 1:n=1540483477*(65535&(n^=255&e.charCodeAt(o)))+(59797*(n>>>16)<<16)}return(((n=1540483477*(65535&(n^=n>>>13))+(59797*(n>>>16)<<16))^n>>>15)>>>0).toString(36)},r={animationIterationCount:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},i=n(1124),a=/[A-Z]|^ms/g,s=/_EMO_([^_]+?)_([^]*?)_EMO_/g,u=function(e){return 45===e.charCodeAt(1)},c=function(e){return null!=e&&"boolean"!==typeof e},l=(0,i.Z)((function(e){return u(e)?e:e.replace(a,"-$&").toLowerCase()})),d=function(e,t){switch(e){case"animation":case"animationName":if("string"===typeof t)return t.replace(s,(function(e,t,n){return f={name:t,styles:n,next:f},t}))}return 1===r[e]||u(e)||"number"!==typeof t||0===t?t:t+"px"};function p(e,t,n){if(null==n)return"";if(void 0!==n.__emotion_styles)return n;switch(typeof n){case"boolean":return"";case"object":if(1===n.anim)return f={name:n.name,styles:n.styles,next:f},n.name;if(void 0!==n.styles){var o=n.next;if(void 0!==o)for(;void 0!==o;)f={name:o.name,styles:o.styles,next:f},o=o.next;return n.styles+";"}return function(e,t,n){var o="";if(Array.isArray(n))for(var r=0;r<n.length;r++)o+=p(e,t,n[r])+";";else for(var i in n){var a=n[i];if("object"!==typeof a)null!=t&&void 0!==t[a]?o+=i+"{"+t[a]+"}":c(a)&&(o+=l(i)+":"+d(i,a)+";");else if(!Array.isArray(a)||"string"!==typeof a[0]||null!=t&&void 0!==t[a[0]]){var s=p(e,t,a);switch(i){case"animation":case"animationName":o+=l(i)+":"+s+";";break;default:o+=i+"{"+s+"}"}}else for(var u=0;u<a.length;u++)c(a[u])&&(o+=l(i)+":"+d(i,a[u])+";")}return o}(e,t,n);case"function":if(void 0!==e){var r=f,i=n(e);return f=r,p(e,t,i)}}if(null==t)return n;var a=t[n];return void 0!==a?a:n}var f,h=/label:\s*([^\s;\n{]+)\s*(;|$)/g;var g=function(e,t,n){if(1===e.length&&"object"===typeof e[0]&&null!==e[0]&&void 0!==e[0].styles)return e[0];var r=!0,i="";f=void 0;var a=e[0];null==a||void 0===a.raw?(r=!1,i+=p(n,t,a)):i+=a[0];for(var s=1;s<e.length;s++)i+=p(n,t,e[s]),r&&(i+=a[s]);h.lastIndex=0;for(var u,c="";null!==(u=h.exec(i));)c+="-"+u[1];return{name:o(i)+c,styles:i,next:f}}},527:function(e,t,n){"use strict";var o;n.d(t,{L:function(){return a},j:function(){return s}});var r=n(3371),i=!!(o||(o=n.t(r,2))).useInsertionEffect&&(o||(o=n.t(r,2))).useInsertionEffect,a=i||function(e){return e()},s=i||r.useLayoutEffect},6805:function(e,t,n){"use strict";n.d(t,{My:function(){return i},fp:function(){return o},hC:function(){return r}});function o(e,t,n){var o="";return n.split(" ").forEach((function(n){void 0!==e[n]?t.push(e[n]+";"):o+=n+" "})),o}var r=function(e,t,n){var o=e.key+"-"+t.name;!1===n&&void 0===e.registered[o]&&(e.registered[o]=t.styles)},i=function(e,t,n){r(e,t,n);var o=e.key+"-"+t.name;if(void 0===e.inserted[t.name]){var i=t;do{e.insert(t===i?"."+o:"",i,e.sheet,!0);i=i.next}while(void 0!==i)}}},3818:function(e,t,n){"use strict";var o=n(8772);t.Z=void 0;!function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==typeof e&&"function"!==typeof e)return{default:e};var n=a(t);if(n&&n.has(e))return n.get(e);var o={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if("default"!==i&&Object.prototype.hasOwnProperty.call(e,i)){var s=r?Object.getOwnPropertyDescriptor(e,i):null;s&&(s.get||s.set)?Object.defineProperty(o,i,s):o[i]=e[i]}o.default=e,n&&n.set(e,o)}(n(3371));var r=o(n(3017)),i=n(3241);function a(e){if("function"!==typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(a=function(e){return e?n:t})(e)}var s=(0,r.default)((0,i.jsx)("path",{d:"M12 1.27a11 11 0 00-3.48 21.46c.55.09.73-.28.73-.55v-1.84c-3.03.64-3.67-1.46-3.67-1.46-.55-1.29-1.28-1.65-1.28-1.65-.92-.65.1-.65.1-.65 1.1 0 1.73 1.1 1.73 1.1.92 1.65 2.57 1.2 3.21.92a2 2 0 01.64-1.47c-2.47-.27-5.04-1.19-5.04-5.5 0-1.1.46-2.1 1.2-2.84a3.76 3.76 0 010-2.93s.91-.28 3.11 1.1c1.8-.49 3.7-.49 5.5 0 2.1-1.38 3.02-1.1 3.02-1.1a3.76 3.76 0 010 2.93c.83.74 1.2 1.74 1.2 2.94 0 4.21-2.57 5.13-5.04 5.4.45.37.82.92.82 2.02v3.03c0 .27.1.64.73.55A11 11 0 0012 1.27"}),"GitHub");t.Z=s},7967:function(e,t,n){"use strict";var o=n(8772);t.Z=void 0;var r=o(n(3017)),i=n(3241),a=(0,r.default)((0,i.jsx)("path",{d:"M2.01 21 23 12 2.01 3 2 10l15 2-15 2z"}),"Send");t.Z=a},3017:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return o.createSvgIcon}});var o=n(3414)},2763:function(e,t,n){"use strict";n.d(t,{Z:function(){return K}});var o=n(1163),r=n(574),i=n(9958),a=n(92),s=n(1997),u=n(6615),c=n(2003),l=n(4572);function d(e,t){var n;return(0,o.Z)({toolbar:(n={minHeight:56},(0,l.Z)(n,e.up("xs"),{"@media (orientation: landscape)":{minHeight:48}}),(0,l.Z)(n,e.up("sm"),{minHeight:64}),n)},t)}var p=n(2131),f={black:"#000",white:"#fff"},h={50:"#fafafa",100:"#f5f5f5",200:"#eeeeee",300:"#e0e0e0",400:"#bdbdbd",500:"#9e9e9e",600:"#757575",700:"#616161",800:"#424242",900:"#212121",A100:"#f5f5f5",A200:"#eeeeee",A400:"#bdbdbd",A700:"#616161"},g={50:"#f3e5f5",100:"#e1bee7",200:"#ce93d8",300:"#ba68c8",400:"#ab47bc",500:"#9c27b0",600:"#8e24aa",700:"#7b1fa2",800:"#6a1b9a",900:"#4a148c",A100:"#ea80fc",A200:"#e040fb",A400:"#d500f9",A700:"#aa00ff"},v={50:"#ffebee",100:"#ffcdd2",200:"#ef9a9a",300:"#e57373",400:"#ef5350",500:"#f44336",600:"#e53935",700:"#d32f2f",800:"#c62828",900:"#b71c1c",A100:"#ff8a80",A200:"#ff5252",A400:"#ff1744",A700:"#d50000"},m={50:"#fff3e0",100:"#ffe0b2",200:"#ffcc80",300:"#ffb74d",400:"#ffa726",500:"#ff9800",600:"#fb8c00",700:"#f57c00",800:"#ef6c00",900:"#e65100",A100:"#ffd180",A200:"#ffab40",A400:"#ff9100",A700:"#ff6d00"},_={50:"#e3f2fd",100:"#bbdefb",200:"#90caf9",300:"#64b5f6",400:"#42a5f5",500:"#2196f3",600:"#1e88e5",700:"#1976d2",800:"#1565c0",900:"#0d47a1",A100:"#82b1ff",A200:"#448aff",A400:"#2979ff",A700:"#2962ff"},y={50:"#e1f5fe",100:"#b3e5fc",200:"#81d4fa",300:"#4fc3f7",400:"#29b6f6",500:"#03a9f4",600:"#039be5",700:"#0288d1",800:"#0277bd",900:"#01579b",A100:"#80d8ff",A200:"#40c4ff",A400:"#00b0ff",A700:"#0091ea"},M={50:"#e8f5e9",100:"#c8e6c9",200:"#a5d6a7",300:"#81c784",400:"#66bb6a",500:"#4caf50",600:"#43a047",700:"#388e3c",800:"#2e7d32",900:"#1b5e20",A100:"#b9f6ca",A200:"#69f0ae",A400:"#00e676",A700:"#00c853"},I=["mode","contrastThreshold","tonalOffset"],C={text:{primary:"rgba(0, 0, 0, 0.87)",secondary:"rgba(0, 0, 0, 0.6)",disabled:"rgba(0, 0, 0, 0.38)"},divider:"rgba(0, 0, 0, 0.12)",background:{paper:f.white,default:f.white},action:{active:"rgba(0, 0, 0, 0.54)",hover:"rgba(0, 0, 0, 0.04)",hoverOpacity:.04,selected:"rgba(0, 0, 0, 0.08)",selectedOpacity:.08,disabled:"rgba(0, 0, 0, 0.26)",disabledBackground:"rgba(0, 0, 0, 0.12)",disabledOpacity:.38,focus:"rgba(0, 0, 0, 0.12)",focusOpacity:.12,activatedOpacity:.12}},k={text:{primary:f.white,secondary:"rgba(255, 255, 255, 0.7)",disabled:"rgba(255, 255, 255, 0.5)",icon:"rgba(255, 255, 255, 0.5)"},divider:"rgba(255, 255, 255, 0.12)",background:{paper:"#121212",default:"#121212"},action:{active:f.white,hover:"rgba(255, 255, 255, 0.08)",hoverOpacity:.08,selected:"rgba(255, 255, 255, 0.16)",selectedOpacity:.16,disabled:"rgba(255, 255, 255, 0.3)",disabledBackground:"rgba(255, 255, 255, 0.12)",disabledOpacity:.38,focus:"rgba(255, 255, 255, 0.12)",focusOpacity:.12,activatedOpacity:.24}};function T(e,t,n,o){var r=o.light||o,i=o.dark||1.5*o;e[t]||(e.hasOwnProperty(n)?e[t]=e[n]:"light"===t?e.light=(0,p.$n)(e.main,r):"dark"===t&&(e.dark=(0,p._j)(e.main,i)))}function S(e){var t=e.mode,n=void 0===t?"light":t,s=e.contrastThreshold,u=void 0===s?3:s,c=e.tonalOffset,l=void 0===c?.2:c,d=(0,r.Z)(e,I),S=e.primary||function(){return"dark"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"light")?{main:_[200],light:_[50],dark:_[400]}:{main:_[700],light:_[400],dark:_[800]}}(n),b=e.secondary||function(){return"dark"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"light")?{main:g[200],light:g[50],dark:g[400]}:{main:g[500],light:g[300],dark:g[700]}}(n),D=e.error||function(){return"dark"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"light")?{main:v[500],light:v[300],dark:v[700]}:{main:v[700],light:v[400],dark:v[800]}}(n),E=e.info||function(){return"dark"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"light")?{main:y[400],light:y[300],dark:y[700]}:{main:y[700],light:y[500],dark:y[900]}}(n),A=e.success||function(){return"dark"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"light")?{main:M[400],light:M[300],dark:M[700]}:{main:M[800],light:M[500],dark:M[900]}}(n),L=e.warning||function(){return"dark"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"light")?{main:m[400],light:m[300],dark:m[700]}:{main:"#ed6c02",light:m[500],dark:m[900]}}(n);function R(e){return(0,p.mi)(e,k.text.primary)>=u?k.text.primary:C.text.primary}var w=function(e){var t=e.color,n=e.name,r=e.mainShade,a=void 0===r?500:r,s=e.lightShade,u=void 0===s?300:s,c=e.darkShade,d=void 0===c?700:c;if(!(t=(0,o.Z)({},t)).main&&t[a]&&(t.main=t[a]),!t.hasOwnProperty("main"))throw new Error((0,i.Z)(11,n?" (".concat(n,")"):"",a));if("string"!==typeof t.main)throw new Error((0,i.Z)(12,n?" (".concat(n,")"):"",JSON.stringify(t.main)));return T(t,"light",u,l),T(t,"dark",d,l),t.contrastText||(t.contrastText=R(t.main)),t},O={dark:k,light:C};return(0,a.Z)((0,o.Z)({common:(0,o.Z)({},f),mode:n,primary:w({color:S,name:"primary"}),secondary:w({color:b,name:"secondary",mainShade:"A400",lightShade:"A200",darkShade:"A700"}),error:w({color:D,name:"error"}),warning:w({color:L,name:"warning"}),info:w({color:E,name:"info"}),success:w({color:A,name:"success"}),grey:h,contrastThreshold:u,getContrastText:R,augmentColor:w,tonalOffset:l},O[n]),d)}var b=["fontFamily","fontSize","fontWeightLight","fontWeightRegular","fontWeightMedium","fontWeightBold","htmlFontSize","allVariants","pxToRem"];var D={textTransform:"uppercase"},E='"Roboto", "Helvetica", "Arial", sans-serif';function A(e,t){var n="function"===typeof t?t(e):t,i=n.fontFamily,s=void 0===i?E:i,u=n.fontSize,c=void 0===u?14:u,l=n.fontWeightLight,d=void 0===l?300:l,p=n.fontWeightRegular,f=void 0===p?400:p,h=n.fontWeightMedium,g=void 0===h?500:h,v=n.fontWeightBold,m=void 0===v?700:v,_=n.htmlFontSize,y=void 0===_?16:_,M=n.allVariants,I=n.pxToRem,C=(0,r.Z)(n,b);var k=c/14,T=I||function(e){return"".concat(e/y*k,"rem")},S=function(e,t,n,r,i){return(0,o.Z)({fontFamily:s,fontWeight:e,fontSize:T(t),lineHeight:n},s===E?{letterSpacing:"".concat((a=r/t,Math.round(1e5*a)/1e5),"em")}:{},i,M);var a},A={h1:S(d,96,1.167,-1.5),h2:S(d,60,1.2,-.5),h3:S(f,48,1.167,0),h4:S(f,34,1.235,.25),h5:S(f,24,1.334,0),h6:S(g,20,1.6,.15),subtitle1:S(f,16,1.75,.15),subtitle2:S(g,14,1.57,.1),body1:S(f,16,1.5,.15),body2:S(f,14,1.43,.15),button:S(g,14,1.75,.4,D),caption:S(f,12,1.66,.4),overline:S(f,12,2.66,1,D),inherit:{fontFamily:"inherit",fontWeight:"inherit",fontSize:"inherit",lineHeight:"inherit",letterSpacing:"inherit"}};return(0,a.Z)((0,o.Z)({htmlFontSize:y,pxToRem:T,fontFamily:s,fontSize:c,fontWeightLight:d,fontWeightRegular:f,fontWeightMedium:g,fontWeightBold:m},A),C,{clone:!1})}var L=.2,R=.14,w=.12;function O(){return["".concat(arguments.length<=0?void 0:arguments[0],"px ").concat(arguments.length<=1?void 0:arguments[1],"px ").concat(arguments.length<=2?void 0:arguments[2],"px ").concat(arguments.length<=3?void 0:arguments[3],"px rgba(0,0,0,").concat(L,")"),"".concat(arguments.length<=4?void 0:arguments[4],"px ").concat(arguments.length<=5?void 0:arguments[5],"px ").concat(arguments.length<=6?void 0:arguments[6],"px ").concat(arguments.length<=7?void 0:arguments[7],"px rgba(0,0,0,").concat(R,")"),"".concat(arguments.length<=8?void 0:arguments[8],"px ").concat(arguments.length<=9?void 0:arguments[9],"px ").concat(arguments.length<=10?void 0:arguments[10],"px ").concat(arguments.length<=11?void 0:arguments[11],"px rgba(0,0,0,").concat(w,")")].join(",")}var N=["none",O(0,2,1,-1,0,1,1,0,0,1,3,0),O(0,3,1,-2,0,2,2,0,0,1,5,0),O(0,3,3,-2,0,3,4,0,0,1,8,0),O(0,2,4,-1,0,4,5,0,0,1,10,0),O(0,3,5,-1,0,5,8,0,0,1,14,0),O(0,3,5,-1,0,6,10,0,0,1,18,0),O(0,4,5,-2,0,7,10,1,0,2,16,1),O(0,5,5,-3,0,8,10,1,0,3,14,2),O(0,5,6,-3,0,9,12,1,0,3,16,2),O(0,6,6,-3,0,10,14,1,0,4,18,3),O(0,6,7,-4,0,11,15,1,0,4,20,3),O(0,7,8,-4,0,12,17,2,0,5,22,4),O(0,7,8,-4,0,13,19,2,0,5,24,4),O(0,7,9,-4,0,14,21,2,0,5,26,4),O(0,8,9,-5,0,15,22,2,0,6,28,5),O(0,8,10,-5,0,16,24,2,0,6,30,5),O(0,8,11,-5,0,17,26,2,0,6,32,5),O(0,9,11,-5,0,18,28,2,0,7,34,6),O(0,9,12,-6,0,19,29,2,0,7,36,6),O(0,10,13,-6,0,20,31,3,0,8,38,7),O(0,10,13,-6,0,21,33,3,0,8,40,7),O(0,10,14,-6,0,22,35,3,0,8,42,7),O(0,11,14,-7,0,23,36,3,0,9,44,8),O(0,11,15,-7,0,24,38,3,0,9,46,8)],P=["duration","easing","delay"],G={easeInOut:"cubic-bezier(0.4, 0, 0.2, 1)",easeOut:"cubic-bezier(0.0, 0, 0.2, 1)",easeIn:"cubic-bezier(0.4, 0, 1, 1)",sharp:"cubic-bezier(0.4, 0, 0.6, 1)"},U={shortest:150,shorter:200,short:250,standard:300,complex:375,enteringScreen:225,leavingScreen:195};function x(e){return"".concat(Math.round(e),"ms")}function F(e){if(!e)return 0;var t=e/36;return Math.round(10*(4+15*Math.pow(t,.25)+t/5))}function q(e){var t=(0,o.Z)({},G,e.easing),n=(0,o.Z)({},U,e.duration);return(0,o.Z)({getAutoHeightDuration:F,create:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:["all"],o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=o.duration,a=void 0===i?n.standard:i,s=o.easing,u=void 0===s?t.easeInOut:s,c=o.delay,l=void 0===c?0:c;(0,r.Z)(o,P);return(Array.isArray(e)?e:[e]).map((function(e){return"".concat(e," ").concat("string"===typeof a?a:x(a)," ").concat(u," ").concat("string"===typeof l?l:x(l))})).join(",")}},e,{easing:t,duration:n})}var B={mobileStepper:1e3,fab:1050,speedDial:1050,appBar:1100,drawer:1200,modal:1300,snackbar:1400,tooltip:1500},V=["breakpoints","mixins","spacing","palette","transitions","typography","shape"];function H(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.mixins,n=void 0===t?{}:t,l=e.palette,p=void 0===l?{}:l,f=e.transitions,h=void 0===f?{}:f,g=e.typography,v=void 0===g?{}:g,m=(0,r.Z)(e,V);if(e.vars)throw new Error((0,i.Z)(18));var _=S(p),y=(0,s.Z)(e),M=(0,a.Z)(y,{mixins:d(y.breakpoints,n),palette:_,shadows:N.slice(),typography:A(_,v),transitions:q(h),zIndex:(0,o.Z)({},B)});M=(0,a.Z)(M,m);for(var I=arguments.length,C=new Array(I>1?I-1:0),k=1;k<I;k++)C[k-1]=arguments[k];return(M=C.reduce((function(e,t){return(0,a.Z)(e,t)}),M)).unstable_sxConfig=(0,o.Z)({},u.Z,null==m?void 0:m.unstable_sxConfig),M.unstable_sx=function(e){return(0,c.Z)({sx:e,theme:this})},M}var K=H()},6166:function(e,t,n){"use strict";n.d(t,{Dz:function(){return a},FO:function(){return i}});var o=n(8971),r=n(2763),i=function(e){return(0,o.x9)(e)&&"classes"!==e},a=o.x9,s=(0,o.ZP)({defaultTheme:r.Z,rootShouldForwardProp:i});t.ZP=s},7070:function(e,t,n){"use strict";n.d(t,{Z:function(){return i}});var o=n(27),r=n(2763);function i(e){var t=e.props,n=e.name;return(0,o.Z)({props:t,name:n,defaultTheme:r.Z})}},6589:function(e,t,n){"use strict";var o=n(8015);t.Z=o.Z},8380:function(e,t,n){"use strict";n.d(t,{Z:function(){return y}});var o=n(1163),r=n(3371),i=n(574),a=n(3788),s=n(1119),u=n(6589),c=n(7070),l=n(6166),d=n(3814),p=n(4095);function f(e){return(0,p.Z)("MuiSvgIcon",e)}(0,d.Z)("MuiSvgIcon",["root","colorPrimary","colorSecondary","colorAction","colorError","colorDisabled","fontSizeInherit","fontSizeSmall","fontSizeMedium","fontSizeLarge"]);var h=n(3241),g=["children","className","color","component","fontSize","htmlColor","inheritViewBox","titleAccess","viewBox"],v=(0,l.ZP)("svg",{name:"MuiSvgIcon",slot:"Root",overridesResolver:function(e,t){var n=e.ownerState;return[t.root,"inherit"!==n.color&&t["color".concat((0,u.Z)(n.color))],t["fontSize".concat((0,u.Z)(n.fontSize))]]}})((function(e){var t,n,o,r,i,a,s,u,c,l,d,p,f,h,g,v,m,_=e.theme,y=e.ownerState;return{userSelect:"none",width:"1em",height:"1em",display:"inline-block",fill:"currentColor",flexShrink:0,transition:null==(t=_.transitions)||null==(n=t.create)?void 0:n.call(t,"fill",{duration:null==(o=_.transitions)||null==(r=o.duration)?void 0:r.shorter}),fontSize:{inherit:"inherit",small:(null==(i=_.typography)||null==(a=i.pxToRem)?void 0:a.call(i,20))||"1.25rem",medium:(null==(s=_.typography)||null==(u=s.pxToRem)?void 0:u.call(s,24))||"1.5rem",large:(null==(c=_.typography)||null==(l=c.pxToRem)?void 0:l.call(c,35))||"2.1875rem"}[y.fontSize],color:null!=(d=null==(p=(_.vars||_).palette)||null==(f=p[y.color])?void 0:f.main)?d:{action:null==(h=(_.vars||_).palette)||null==(g=h.action)?void 0:g.active,disabled:null==(v=(_.vars||_).palette)||null==(m=v.action)?void 0:m.disabled,inherit:void 0}[y.color]}})),m=r.forwardRef((function(e,t){var n=(0,c.Z)({props:e,name:"MuiSvgIcon"}),r=n.children,l=n.className,d=n.color,p=void 0===d?"inherit":d,m=n.component,_=void 0===m?"svg":m,y=n.fontSize,M=void 0===y?"medium":y,I=n.htmlColor,C=n.inheritViewBox,k=void 0!==C&&C,T=n.titleAccess,S=n.viewBox,b=void 0===S?"0 0 24 24":S,D=(0,i.Z)(n,g),E=(0,o.Z)({},n,{color:p,component:_,fontSize:M,instanceFontSize:e.fontSize,inheritViewBox:k,viewBox:b}),A={};k||(A.viewBox=b);var L=function(e){var t=e.color,n=e.fontSize,o=e.classes,r={root:["root","inherit"!==t&&"color".concat((0,u.Z)(t)),"fontSize".concat((0,u.Z)(n))]};return(0,s.Z)(r,f,o)}(E);return(0,h.jsxs)(v,(0,o.Z)({as:_,className:(0,a.Z)(L.root,l),focusable:"false",color:I,"aria-hidden":!T||void 0,role:T?"img":void 0,ref:t},A,D,{ownerState:E,children:[r,T?(0,h.jsx)("title",{children:T}):null]}))}));m.muiName="SvgIcon";var _=m;function y(e,t){function n(n,r){return(0,h.jsx)(_,(0,o.Z)({"data-testid":"".concat(t,"Icon"),ref:r},n,{children:e}))}return n.muiName=_.muiName,r.memo(r.forwardRef(n))}},8755:function(e,t,n){"use strict";var o=n(7586);t.Z=o.Z},3414:function(e,t,n){"use strict";n.r(t),n.d(t,{capitalize:function(){return r.Z},createChainedFunction:function(){return i},createSvgIcon:function(){return a.Z},debounce:function(){return s.Z},deprecatedPropType:function(){return u},isMuiElement:function(){return c.Z},ownerDocument:function(){return l.Z},ownerWindow:function(){return d.Z},requirePropFactory:function(){return p},setRef:function(){return f},unstable_ClassNameGenerator:function(){return I},unstable_useEnhancedEffect:function(){return h.Z},unstable_useId:function(){return g},unsupportedProp:function(){return v},useControlled:function(){return m.Z},useEventCallback:function(){return _.Z},useForkRef:function(){return y.Z},useIsFocusVisible:function(){return M.Z}});var o=n(1241),r=n(6589),i=n(111).Z,a=n(8380),s=n(8755);var u=function(e,t){return function(){return null}},c=n(2555),l=n(8011),d=n(9860);n(1163);var p=function(e,t){return function(){return null}},f=n(6544).Z,h=n(2584),g=n(5307).Z;var v=function(e,t,n,o,r){return null},m=n(7983),_=n(5881),y=n(6935),M=n(2814),I={configure:function(e){o.Z.configure(e)}}},2555:function(e,t,n){"use strict";n.d(t,{Z:function(){return r}});var o=n(3371);var r=function(e,t){return o.isValidElement(e)&&-1!==t.indexOf(e.type.muiName)}},8011:function(e,t,n){"use strict";var o=n(4481);t.Z=o.Z},9860:function(e,t,n){"use strict";var o=n(4920);t.Z=o.Z},7983:function(e,t,n){"use strict";n.d(t,{Z:function(){return i}});var o=n(6377),r=n(3371);var i=function(e){var t=e.controlled,n=e.default,i=(e.name,e.state,r.useRef(void 0!==t).current),a=r.useState(n),s=(0,o.Z)(a,2),u=s[0],c=s[1];return[i?t:u,r.useCallback((function(e){i||c(e)}),[])]}},2584:function(e,t,n){"use strict";var o=n(1663);t.Z=o.Z},5881:function(e,t,n){"use strict";var o=n(8050);t.Z=o.Z},6935:function(e,t,n){"use strict";var o=n(9091);t.Z=o.Z},2814:function(e,t,n){"use strict";n.d(t,{Z:function(){return p}});var o,r=n(3371),i=!0,a=!1,s={text:!0,search:!0,url:!0,tel:!0,email:!0,password:!0,number:!0,date:!0,month:!0,week:!0,time:!0,datetime:!0,"datetime-local":!0};function u(e){e.metaKey||e.altKey||e.ctrlKey||(i=!0)}function c(){i=!1}function l(){"hidden"===this.visibilityState&&a&&(i=!0)}function d(e){var t=e.target;try{return t.matches(":focus-visible")}catch(n){}return i||function(e){var t=e.type,n=e.tagName;return!("INPUT"!==n||!s[t]||e.readOnly)||"TEXTAREA"===n&&!e.readOnly||!!e.isContentEditable}(t)}var p=function(){var e=r.useCallback((function(e){var t;null!=e&&((t=e.ownerDocument).addEventListener("keydown",u,!0),t.addEventListener("mousedown",c,!0),t.addEventListener("pointerdown",c,!0),t.addEventListener("touchstart",c,!0),t.addEventListener("visibilitychange",l,!0))}),[]),t=r.useRef(!1);return{isFocusVisibleRef:t,onFocus:function(e){return!!d(e)&&(t.current=!0,!0)},onBlur:function(){return!!t.current&&(a=!0,window.clearTimeout(o),o=window.setTimeout((function(){a=!1}),100),t.current=!1,!0)},ref:e}}},9380:function(e,t,n){"use strict";n.d(t,{L7:function(){return u},P$:function(){return l},VO:function(){return r},W8:function(){return s},dt:function(){return c},k9:function(){return a}});var o=n(92),r={xs:0,sm:600,md:900,lg:1200,xl:1536},i={keys:["xs","sm","md","lg","xl"],up:function(e){return"@media (min-width:".concat(r[e],"px)")}};function a(e,t,n){var o=e.theme||{};if(Array.isArray(t)){var a=o.breakpoints||i;return t.reduce((function(e,o,r){return e[a.up(a.keys[r])]=n(t[r]),e}),{})}if("object"===typeof t){var s=o.breakpoints||i;return Object.keys(t).reduce((function(e,o){if(-1!==Object.keys(s.values||r).indexOf(o)){e[s.up(o)]=n(t[o],o)}else{var i=o;e[i]=t[i]}return e}),{})}return n(t)}function s(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(null==(e=t.keys)?void 0:e.reduce((function(e,n){return e[t.up(n)]={},e}),{}))||{}}function u(e,t){return e.reduce((function(e,t){var n=e[t];return(!n||0===Object.keys(n).length)&&delete e[t],e}),t)}function c(e){for(var t=s(e),n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];var a=[t].concat(r).reduce((function(e,t){return(0,o.Z)(e,t)}),{});return u(Object.keys(t),a)}function l(e){var t,n=e.values,o=e.breakpoints,r=e.base||function(e,t){if("object"!==typeof e)return{};var n={},o=Object.keys(t);return Array.isArray(e)?o.forEach((function(t,o){o<e.length&&(n[t]=!0)})):o.forEach((function(t){null!=e[t]&&(n[t]=!0)})),n}(n,o),i=Object.keys(r);return 0===i.length?n:i.reduce((function(e,o,r){return Array.isArray(n)?(e[o]=null!=n[r]?n[r]:n[t],t=r):"object"===typeof n?(e[o]=null!=n[o]?n[o]:n[t],t=o):e[o]=n,e}),{})}},2131:function(e,t,n){"use strict";n.d(t,{$n:function(){return d},Fq:function(){return c},_j:function(){return l},mi:function(){return u}});var o=n(9958);function r(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return Math.min(Math.max(t,e),n)}function i(e){if(e.type)return e;if("#"===e.charAt(0))return i(function(e){e=e.slice(1);var t=new RegExp(".{1,".concat(e.length>=6?2:1,"}"),"g"),n=e.match(t);return n&&1===n[0].length&&(n=n.map((function(e){return e+e}))),n?"rgb".concat(4===n.length?"a":"","(").concat(n.map((function(e,t){return t<3?parseInt(e,16):Math.round(parseInt(e,16)/255*1e3)/1e3})).join(", "),")"):""}(e));var t=e.indexOf("("),n=e.substring(0,t);if(-1===["rgb","rgba","hsl","hsla","color"].indexOf(n))throw new Error((0,o.Z)(9,e));var r,a=e.substring(t+1,e.length-1);if("color"===n){if(r=(a=a.split(" ")).shift(),4===a.length&&"/"===a[3].charAt(0)&&(a[3]=a[3].slice(1)),-1===["srgb","display-p3","a98-rgb","prophoto-rgb","rec-2020"].indexOf(r))throw new Error((0,o.Z)(10,r))}else a=a.split(",");return{type:n,values:a=a.map((function(e){return parseFloat(e)})),colorSpace:r}}function a(e){var t=e.type,n=e.colorSpace,o=e.values;return-1!==t.indexOf("rgb")?o=o.map((function(e,t){return t<3?parseInt(e,10):e})):-1!==t.indexOf("hsl")&&(o[1]="".concat(o[1],"%"),o[2]="".concat(o[2],"%")),o=-1!==t.indexOf("color")?"".concat(n," ").concat(o.join(" ")):"".concat(o.join(", ")),"".concat(t,"(").concat(o,")")}function s(e){var t="hsl"===(e=i(e)).type||"hsla"===e.type?i(function(e){var t=(e=i(e)).values,n=t[0],o=t[1]/100,r=t[2]/100,s=o*Math.min(r,1-r),u=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(e+n/30)%12;return r-s*Math.max(Math.min(t-3,9-t,1),-1)},c="rgb",l=[Math.round(255*u(0)),Math.round(255*u(8)),Math.round(255*u(4))];return"hsla"===e.type&&(c+="a",l.push(t[3])),a({type:c,values:l})}(e)).values:e.values;return t=t.map((function(t){return"color"!==e.type&&(t/=255),t<=.03928?t/12.92:Math.pow((t+.055)/1.055,2.4)})),Number((.2126*t[0]+.7152*t[1]+.0722*t[2]).toFixed(3))}function u(e,t){var n=s(e),o=s(t);return(Math.max(n,o)+.05)/(Math.min(n,o)+.05)}function c(e,t){return e=i(e),t=r(t),"rgb"!==e.type&&"hsl"!==e.type||(e.type+="a"),"color"===e.type?e.values[3]="/".concat(t):e.values[3]=t,a(e)}function l(e,t){if(e=i(e),t=r(t),-1!==e.type.indexOf("hsl"))e.values[2]*=1-t;else if(-1!==e.type.indexOf("rgb")||-1!==e.type.indexOf("color"))for(var n=0;n<3;n+=1)e.values[n]*=1-t;return a(e)}function d(e,t){if(e=i(e),t=r(t),-1!==e.type.indexOf("hsl"))e.values[2]+=(100-e.values[2])*t;else if(-1!==e.type.indexOf("rgb"))for(var n=0;n<3;n+=1)e.values[n]+=(255-e.values[n])*t;else if(-1!==e.type.indexOf("color"))for(var o=0;o<3;o+=1)e.values[o]+=(1-e.values[o])*t;return a(e)}},8971:function(e,t,n){"use strict";n.d(t,{ZP:function(){return F},x9:function(){return U}});var o=n(1246),r=n(6377),i=n(574),a=n(1163),s=n(3371),u=n(1124),c=/^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|suppressHydrationWarning|valueLink|abbr|accept|acceptCharset|accessKey|action|allow|allowUserMedia|allowPaymentRequest|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|challenge|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|decoding|default|defer|dir|disabled|disablePictureInPicture|download|draggable|encType|enterKeyHint|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loading|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|translate|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|incremental|fallback|inert|itemProp|itemScope|itemType|itemID|itemRef|on|option|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class|autofocus)|(([Dd][Aa][Tt][Aa]|[Aa][Rr][Ii][Aa]|x)-.*))$/,l=(0,u.Z)((function(e){return c.test(e)||111===e.charCodeAt(0)&&110===e.charCodeAt(1)&&e.charCodeAt(2)<91})),d=n(1469),p=n(6805),f=n(7758),h=n(527),g=l,v=function(e){return"theme"!==e},m=function(e){return"string"===typeof e&&e.charCodeAt(0)>96?g:v},_=function(e,t,n){var o;if(t){var r=t.shouldForwardProp;o=e.__emotion_forwardProp&&r?function(t){return e.__emotion_forwardProp(t)&&r(t)}:r}return"function"!==typeof o&&n&&(o=e.__emotion_forwardProp),o},y=function(e){var t=e.cache,n=e.serialized,o=e.isStringTag;(0,p.hC)(t,n,o);(0,h.L)((function(){return(0,p.My)(t,n,o)}));return null},M=function e(t,n){var o,r,i=t.__emotion_real===t,u=i&&t.__emotion_base||t;void 0!==n&&(o=n.label,r=n.target);var c=_(t,n,i),l=c||m(u),h=!l("as");return function(){var g=arguments,v=i&&void 0!==t.__emotion_styles?t.__emotion_styles.slice(0):[];if(void 0!==o&&v.push("label:"+o+";"),null==g[0]||void 0===g[0].raw)v.push.apply(v,g);else{0,v.push(g[0][0]);for(var M=g.length,I=1;I<M;I++)v.push(g[I],g[0][I])}var C=(0,d.w)((function(e,t,n){var o=h&&e.as||u,i="",a=[],g=e;if(null==e.theme){for(var _ in g={},e)g[_]=e[_];g.theme=(0,s.useContext)(d.T)}"string"===typeof e.className?i=(0,p.fp)(t.registered,a,e.className):null!=e.className&&(i=e.className+" ");var M=(0,f.O)(v.concat(a),t.registered,g);i+=t.key+"-"+M.name,void 0!==r&&(i+=" "+r);var I=h&&void 0===c?m(o):l,C={};for(var k in e)h&&"as"===k||I(k)&&(C[k]=e[k]);return C.className=i,C.ref=n,(0,s.createElement)(s.Fragment,null,(0,s.createElement)(y,{cache:t,serialized:M,isStringTag:"string"===typeof o}),(0,s.createElement)(o,C))}));return C.displayName=void 0!==o?o:"Styled("+("string"===typeof u?u:u.displayName||u.name||"Component")+")",C.defaultProps=t.defaultProps,C.__emotion_real=C,C.__emotion_base=u,C.__emotion_styles=v,C.__emotion_forwardProp=c,Object.defineProperty(C,"toString",{value:function(){return"."+r}}),C.withComponent=function(t,o){return e(t,(0,a.Z)({},n,o,{shouldForwardProp:_(C,o,!0)})).apply(void 0,v)},C}},I=M.bind();["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","marquee","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"].forEach((function(e){I[e]=I(e)}));var C=I;var k=function(e,t){Array.isArray(e.__emotion_styles)&&(e.__emotion_styles=t(e.__emotion_styles))},T=n(1997),S=n(8015),b=["variant"];function D(e){return 0===e.length}function E(e){var t=e.variant,n=(0,i.Z)(e,b),o=t||"";return Object.keys(n).sort().forEach((function(t){o+="color"===t?D(o)?e[t]:(0,S.Z)(e[t]):"".concat(D(o)?t:(0,S.Z)(t)).concat((0,S.Z)(e[t].toString()))})),o}var A=n(2003),L=["name","slot","skipVariantsResolver","skipSx","overridesResolver"],R=["theme"],w=["theme"];function O(e){return 0===Object.keys(e).length}var N=function(e,t){return t.components&&t.components[e]&&t.components[e].styleOverrides?t.components[e].styleOverrides:null},P=function(e,t){var n=[];t&&t.components&&t.components[e]&&t.components[e].variants&&(n=t.components[e].variants);var o={};return n.forEach((function(e){var t=E(e.props);o[t]=e.style})),o},G=function(e,t,n,o){var r,i,a=e.ownerState,s=void 0===a?{}:a,u=[],c=null==n||null==(r=n.components)||null==(i=r[o])?void 0:i.variants;return c&&c.forEach((function(n){var o=!0;Object.keys(n.props).forEach((function(t){s[t]!==n.props[t]&&e[t]!==n.props[t]&&(o=!1)})),o&&u.push(t[E(n.props)])})),u};function U(e){return"ownerState"!==e&&"theme"!==e&&"sx"!==e&&"as"!==e}var x=(0,T.Z)();function F(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.defaultTheme,n=void 0===t?x:t,s=e.rootShouldForwardProp,u=void 0===s?U:s,c=e.slotShouldForwardProp,l=void 0===c?U:c,d=function(e){var t=O(e.theme)?n:e.theme;return(0,A.Z)((0,a.Z)({},e,{theme:t}))};return d.__mui_systemSx=!0,function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};k(e,(function(e){return e.filter((function(e){return!(null!=e&&e.__mui_systemSx)}))}));var s=t.name,c=t.slot,p=t.skipVariantsResolver,f=t.skipSx,h=t.overridesResolver,g=(0,i.Z)(t,L),v=void 0!==p?p:c&&"Root"!==c||!1,m=f||!1;var _=U;"Root"===c?_=u:c?_=l:function(e){return"string"===typeof e&&e.charCodeAt(0)>96}(e)&&(_=void 0);var y=function(e,t){return C(e,t)}(e,(0,a.Z)({shouldForwardProp:_,label:undefined},g)),M=function(e){for(var t=arguments.length,u=new Array(t>1?t-1:0),c=1;c<t;c++)u[c-1]=arguments[c];var l=u?u.map((function(e){return"function"===typeof e&&e.__emotion_real!==e?function(t){var o=t.theme,r=(0,i.Z)(t,R);return e((0,a.Z)({theme:O(o)?n:o},r))}:e})):[],p=e;s&&h&&l.push((function(e){var t=O(e.theme)?n:e.theme,o=N(s,t);if(o){var i={};return Object.entries(o).forEach((function(n){var o=(0,r.Z)(n,2),s=o[0],u=o[1];i[s]="function"===typeof u?u((0,a.Z)({},e,{theme:t})):u})),h(e,i)}return null})),s&&!v&&l.push((function(e){var t=O(e.theme)?n:e.theme;return G(e,P(s,t),t,s)})),m||l.push(d);var f=l.length-u.length;if(Array.isArray(e)&&f>0){var g=new Array(f).fill("");(p=[].concat((0,o.Z)(e),(0,o.Z)(g))).raw=[].concat((0,o.Z)(e.raw),(0,o.Z)(g))}else"function"===typeof e&&e.__emotion_real!==e&&(p=function(t){var o=t.theme,r=(0,i.Z)(t,w);return e((0,a.Z)({theme:O(o)?n:o},r))});return y.apply(void 0,[p].concat((0,o.Z)(l)))};return y.withConfig&&(M.withConfig=y.withConfig),M}}},1997:function(e,t,n){"use strict";n.d(t,{Z:function(){return h}});var o=n(1163),r=n(574),i=n(92),a=n(4572),s=["values","unit","step"],u=function(e){var t=Object.keys(e).map((function(t){return{key:t,val:e[t]}}))||[];return t.sort((function(e,t){return e.val-t.val})),t.reduce((function(e,t){return(0,o.Z)({},e,(0,a.Z)({},t.key,t.val))}),{})};var c={borderRadius:4},l=n(782);var d=n(2003),p=n(6615),f=["breakpoints","palette","spacing","shape"];var h=function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.breakpoints,n=void 0===t?{}:t,a=e.palette,h=void 0===a?{}:a,g=e.spacing,v=e.shape,m=void 0===v?{}:v,_=(0,r.Z)(e,f),y=function(e){var t=e.values,n=void 0===t?{xs:0,sm:600,md:900,lg:1200,xl:1536}:t,i=e.unit,a=void 0===i?"px":i,c=e.step,l=void 0===c?5:c,d=(0,r.Z)(e,s),p=u(n),f=Object.keys(p);function h(e){var t="number"===typeof n[e]?n[e]:e;return"@media (min-width:".concat(t).concat(a,")")}function g(e){var t="number"===typeof n[e]?n[e]:e;return"@media (max-width:".concat(t-l/100).concat(a,")")}function v(e,t){var o=f.indexOf(t);return"@media (min-width:".concat("number"===typeof n[e]?n[e]:e).concat(a,") and ")+"(max-width:".concat((-1!==o&&"number"===typeof n[f[o]]?n[f[o]]:t)-l/100).concat(a,")")}return(0,o.Z)({keys:f,values:p,up:h,down:g,between:v,only:function(e){return f.indexOf(e)+1<f.length?v(e,f[f.indexOf(e)+1]):h(e)},not:function(e){var t=f.indexOf(e);return 0===t?h(f[1]):t===f.length-1?g(f[t]):v(e,f[f.indexOf(e)+1]).replace("@media","@media not all and")},unit:a},d)}(n),M=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:8;if(e.mui)return e;var t=(0,l.hB)({spacing:e}),n=function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return(0===n.length?[1]:n).map((function(e){var n=t(e);return"number"===typeof n?"".concat(n,"px"):n})).join(" ")};return n.mui=!0,n}(g),I=(0,i.Z)({breakpoints:y,direction:"ltr",components:{},palette:(0,o.Z)({mode:"light"},h),spacing:M,shape:(0,o.Z)({},c,m)},_),C=arguments.length,k=new Array(C>1?C-1:0),T=1;T<C;T++)k[T-1]=arguments[T];return(I=k.reduce((function(e,t){return(0,i.Z)(e,t)}),I)).unstable_sxConfig=(0,o.Z)({},p.Z,null==_?void 0:_.unstable_sxConfig),I.unstable_sx=function(e){return(0,d.Z)({sx:e,theme:this})},I}},4669:function(e,t,n){"use strict";var o=n(92);t.Z=function(e,t){return t?(0,o.Z)(e,t,{clone:!1}):e}},782:function(e,t,n){"use strict";n.d(t,{hB:function(){return g},eI:function(){return h},NA:function(){return v},e6:function(){return y},o3:function(){return M}});var o=n(6377),r=n(9380),i=n(6197),a=n(4669);var s={m:"margin",p:"padding"},u={t:"Top",r:"Right",b:"Bottom",l:"Left",x:["Left","Right"],y:["Top","Bottom"]},c={marginX:"mx",marginY:"my",paddingX:"px",paddingY:"py"},l=function(e){var t={};return function(n){return void 0===t[n]&&(t[n]=e(n)),t[n]}}((function(e){if(e.length>2){if(!c[e])return[e];e=c[e]}var t=e.split(""),n=(0,o.Z)(t,2),r=n[0],i=n[1],a=s[r],l=u[i]||"";return Array.isArray(l)?l.map((function(e){return a+e})):[a+l]})),d=["m","mt","mr","mb","ml","mx","my","margin","marginTop","marginRight","marginBottom","marginLeft","marginX","marginY","marginInline","marginInlineStart","marginInlineEnd","marginBlock","marginBlockStart","marginBlockEnd"],p=["p","pt","pr","pb","pl","px","py","padding","paddingTop","paddingRight","paddingBottom","paddingLeft","paddingX","paddingY","paddingInline","paddingInlineStart","paddingInlineEnd","paddingBlock","paddingBlockStart","paddingBlockEnd"],f=[].concat(d,p);function h(e,t,n,o){var r,a=null!=(r=(0,i.DW)(e,t,!1))?r:n;return"number"===typeof a?function(e){return"string"===typeof e?e:a*e}:Array.isArray(a)?function(e){return"string"===typeof e?e:a[e]}:"function"===typeof a?a:function(){}}function g(e){return h(e,"spacing",8)}function v(e,t){if("string"===typeof t||null==t)return t;var n=e(Math.abs(t));return t>=0?n:"number"===typeof n?-n:"-".concat(n)}function m(e,t,n,o){if(-1===t.indexOf(n))return null;var i=function(e,t){return function(n){return e.reduce((function(e,o){return e[o]=v(t,n),e}),{})}}(l(n),o),a=e[n];return(0,r.k9)(e,a,i)}function _(e,t){var n=g(e.theme);return Object.keys(e).map((function(o){return m(e,t,o,n)})).reduce(a.Z,{})}function y(e){return _(e,d)}function M(e){return _(e,p)}function I(e){return _(e,f)}y.propTypes={},y.filterProps=d,M.propTypes={},M.filterProps=p,I.propTypes={},I.filterProps=f},6197:function(e,t,n){"use strict";n.d(t,{DW:function(){return a},Jq:function(){return s}});var o=n(4572),r=n(8015),i=n(9380);function a(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(!t||"string"!==typeof t)return null;if(e&&e.vars&&n){var o="vars.".concat(t).split(".").reduce((function(e,t){return e&&e[t]?e[t]:null}),e);if(null!=o)return o}return t.split(".").reduce((function(e,t){return e&&null!=e[t]?e[t]:null}),e)}function s(e,t,n){var o,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:n;return o="function"===typeof e?e(n):Array.isArray(e)?e[n]||r:a(e,n)||r,t&&(o=t(o,r,e)),o}t.ZP=function(e){var t=e.prop,n=e.cssProperty,u=void 0===n?e.prop:n,c=e.themeKey,l=e.transform,d=function(e){if(null==e[t])return null;var n=e[t],d=a(e.theme,c)||{};return(0,i.k9)(e,n,(function(e){var n=s(d,l,e);return e===n&&"string"===typeof e&&(n=s(d,l,"".concat(t).concat("default"===e?"":(0,r.Z)(e)),e)),!1===u?n:(0,o.Z)({},u,n)}))};return d.propTypes={},d.filterProps=[t],d}},6615:function(e,t,n){"use strict";n.d(t,{Z:function(){return N}});var o=n(4572),r=n(8015),i=n(782),a=n(9380),s=n(6197),u=n(4669);var c=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var o=t.reduce((function(e,t){return t.filterProps.forEach((function(n){e[n]=t})),e}),{}),r=function(e){return Object.keys(e).reduce((function(t,n){return o[n]?(0,u.Z)(t,o[n](e)):t}),{})};return r.propTypes={},r.filterProps=t.reduce((function(e,t){return e.concat(t.filterProps)}),[]),r};function l(e){return"number"!==typeof e?e:"".concat(e,"px solid")}var d=(0,s.ZP)({prop:"border",themeKey:"borders",transform:l}),p=(0,s.ZP)({prop:"borderTop",themeKey:"borders",transform:l}),f=(0,s.ZP)({prop:"borderRight",themeKey:"borders",transform:l}),h=(0,s.ZP)({prop:"borderBottom",themeKey:"borders",transform:l}),g=(0,s.ZP)({prop:"borderLeft",themeKey:"borders",transform:l}),v=(0,s.ZP)({prop:"borderColor",themeKey:"palette"}),m=(0,s.ZP)({prop:"borderTopColor",themeKey:"palette"}),_=(0,s.ZP)({prop:"borderRightColor",themeKey:"palette"}),y=(0,s.ZP)({prop:"borderBottomColor",themeKey:"palette"}),M=(0,s.ZP)({prop:"borderLeftColor",themeKey:"palette"}),I=function(e){if(void 0!==e.borderRadius&&null!==e.borderRadius){var t=(0,i.eI)(e.theme,"shape.borderRadius",4,"borderRadius");return(0,a.k9)(e,e.borderRadius,(function(e){return{borderRadius:(0,i.NA)(t,e)}}))}return null};I.propTypes={},I.filterProps=["borderRadius"];c(d,p,f,h,g,v,m,_,y,M,I);var C=function(e){if(void 0!==e.gap&&null!==e.gap){var t=(0,i.eI)(e.theme,"spacing",8,"gap");return(0,a.k9)(e,e.gap,(function(e){return{gap:(0,i.NA)(t,e)}}))}return null};C.propTypes={},C.filterProps=["gap"];var k=function(e){if(void 0!==e.columnGap&&null!==e.columnGap){var t=(0,i.eI)(e.theme,"spacing",8,"columnGap");return(0,a.k9)(e,e.columnGap,(function(e){return{columnGap:(0,i.NA)(t,e)}}))}return null};k.propTypes={},k.filterProps=["columnGap"];var T=function(e){if(void 0!==e.rowGap&&null!==e.rowGap){var t=(0,i.eI)(e.theme,"spacing",8,"rowGap");return(0,a.k9)(e,e.rowGap,(function(e){return{rowGap:(0,i.NA)(t,e)}}))}return null};T.propTypes={},T.filterProps=["rowGap"];c(C,k,T,(0,s.ZP)({prop:"gridColumn"}),(0,s.ZP)({prop:"gridRow"}),(0,s.ZP)({prop:"gridAutoFlow"}),(0,s.ZP)({prop:"gridAutoColumns"}),(0,s.ZP)({prop:"gridAutoRows"}),(0,s.ZP)({prop:"gridTemplateColumns"}),(0,s.ZP)({prop:"gridTemplateRows"}),(0,s.ZP)({prop:"gridTemplateAreas"}),(0,s.ZP)({prop:"gridArea"}));function S(e,t){return"grey"===t?t:e}c((0,s.ZP)({prop:"color",themeKey:"palette",transform:S}),(0,s.ZP)({prop:"bgcolor",cssProperty:"backgroundColor",themeKey:"palette",transform:S}),(0,s.ZP)({prop:"backgroundColor",themeKey:"palette",transform:S}));function b(e){return e<=1&&0!==e?"".concat(100*e,"%"):e}var D=(0,s.ZP)({prop:"width",transform:b}),E=function(e){if(void 0!==e.maxWidth&&null!==e.maxWidth){return(0,a.k9)(e,e.maxWidth,(function(t){var n,o,r;return{maxWidth:(null==(n=e.theme)||null==(o=n.breakpoints)||null==(r=o.values)?void 0:r[t])||a.VO[t]||b(t)}}))}return null};E.filterProps=["maxWidth"];var A=(0,s.ZP)({prop:"minWidth",transform:b}),L=(0,s.ZP)({prop:"height",transform:b}),R=(0,s.ZP)({prop:"maxHeight",transform:b}),w=(0,s.ZP)({prop:"minHeight",transform:b}),O=((0,s.ZP)({prop:"size",cssProperty:"width",transform:b}),(0,s.ZP)({prop:"size",cssProperty:"height",transform:b}),c(D,E,A,L,R,w,(0,s.ZP)({prop:"boxSizing"})),function(e){return function(t){if(void 0!==t[e]&&null!==t[e]){return(0,a.k9)(t,t[e],(function(n){var i,a,s,u,c=null==(i=t.theme.typography)?void 0:i["".concat(e).concat("default"===t[e]||t[e]===e?"":(0,r.Z)(null==(a=t[e])?void 0:a.toString()))];c||(c=null==(s=t.theme.typography)||null==(u=s[n])?void 0:u[e]);return c||(c=n),(0,o.Z)({},e,c)}))}return null}}),N={border:{themeKey:"borders",transform:l},borderTop:{themeKey:"borders",transform:l},borderRight:{themeKey:"borders",transform:l},borderBottom:{themeKey:"borders",transform:l},borderLeft:{themeKey:"borders",transform:l},borderColor:{themeKey:"palette"},borderTopColor:{themeKey:"palette"},borderRightColor:{themeKey:"palette"},borderBottomColor:{themeKey:"palette"},borderLeftColor:{themeKey:"palette"},borderRadius:{themeKey:"shape.borderRadius",style:I},color:{themeKey:"palette",transform:S},bgcolor:{themeKey:"palette",cssProperty:"backgroundColor",transform:S},backgroundColor:{themeKey:"palette",transform:S},p:{style:i.o3},pt:{style:i.o3},pr:{style:i.o3},pb:{style:i.o3},pl:{style:i.o3},px:{style:i.o3},py:{style:i.o3},padding:{style:i.o3},paddingTop:{style:i.o3},paddingRight:{style:i.o3},paddingBottom:{style:i.o3},paddingLeft:{style:i.o3},paddingX:{style:i.o3},paddingY:{style:i.o3},paddingInline:{style:i.o3},paddingInlineStart:{style:i.o3},paddingInlineEnd:{style:i.o3},paddingBlock:{style:i.o3},paddingBlockStart:{style:i.o3},paddingBlockEnd:{style:i.o3},m:{style:i.e6},mt:{style:i.e6},mr:{style:i.e6},mb:{style:i.e6},ml:{style:i.e6},mx:{style:i.e6},my:{style:i.e6},margin:{style:i.e6},marginTop:{style:i.e6},marginRight:{style:i.e6},marginBottom:{style:i.e6},marginLeft:{style:i.e6},marginX:{style:i.e6},marginY:{style:i.e6},marginInline:{style:i.e6},marginInlineStart:{style:i.e6},marginInlineEnd:{style:i.e6},marginBlock:{style:i.e6},marginBlockStart:{style:i.e6},marginBlockEnd:{style:i.e6},displayPrint:{cssProperty:!1,transform:function(e){return{"@media print":{display:e}}}},display:{},overflow:{},textOverflow:{},visibility:{},whiteSpace:{},flexBasis:{},flexDirection:{},flexWrap:{},justifyContent:{},alignItems:{},alignContent:{},order:{},flex:{},flexGrow:{},flexShrink:{},alignSelf:{},justifyItems:{},justifySelf:{},gap:{style:C},rowGap:{style:T},columnGap:{style:k},gridColumn:{},gridRow:{},gridAutoFlow:{},gridAutoColumns:{},gridAutoRows:{},gridTemplateColumns:{},gridTemplateRows:{},gridTemplateAreas:{},gridArea:{},position:{},zIndex:{themeKey:"zIndex"},top:{},right:{},bottom:{},left:{},boxShadow:{themeKey:"shadows"},width:{transform:b},maxWidth:{style:E},minWidth:{transform:b},height:{transform:b},maxHeight:{transform:b},minHeight:{transform:b},boxSizing:{},fontFamily:{themeKey:"typography",style:O("fontFamily")},fontSize:{themeKey:"typography",style:O("fontSize")},fontStyle:{themeKey:"typography"},fontWeight:{themeKey:"typography",style:O("fontWeight")},letterSpacing:{},textTransform:{},lineHeight:{},textAlign:{},typography:{cssProperty:!1,themeKey:"typography"}}},2003:function(e,t,n){"use strict";var o=n(4572),r=n(8015),i=n(4669),a=n(6197),s=n(9380),u=n(6615);var c=function(){function e(e,t,n,i){var u,c=(u={},(0,o.Z)(u,e,t),(0,o.Z)(u,"theme",n),u),l=i[e];if(!l)return(0,o.Z)({},e,t);var d=l.cssProperty,p=void 0===d?e:d,f=l.themeKey,h=l.transform,g=l.style;if(null==t)return null;var v=(0,a.DW)(n,f)||{};if(g)return g(c);return(0,s.k9)(c,t,(function(t){var n=(0,a.Jq)(v,h,t);return t===n&&"string"===typeof t&&(n=(0,a.Jq)(v,h,"".concat(e).concat("default"===t?"":(0,r.Z)(t)),t)),!1===p?n:(0,o.Z)({},p,n)}))}return function t(n){var r,a=n||{},c=a.sx,l=a.theme,d=void 0===l?{}:l;if(!c)return null;var p=null!=(r=d.unstable_sxConfig)?r:u.Z;function f(n){var r=n;if("function"===typeof n)r=n(d);else if("object"!==typeof n)return n;if(!r)return null;var a=(0,s.W8)(d.breakpoints),u=Object.keys(a),c=a;return Object.keys(r).forEach((function(n){var a,u,l=(a=r[n],u=d,"function"===typeof a?a(u):a);if(null!==l&&void 0!==l)if("object"===typeof l)if(p[n])c=(0,i.Z)(c,e(n,l,d,p));else{var f=(0,s.k9)({theme:d},l,(function(e){return(0,o.Z)({},n,e)}));!function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var o=t.reduce((function(e,t){return e.concat(Object.keys(t))}),[]),r=new Set(o);return t.every((function(e){return r.size===Object.keys(e).length}))}(f,l)?c=(0,i.Z)(c,f):c[n]=t({sx:l,theme:d})}else c=(0,i.Z)(c,e(n,l,d,p))})),(0,s.L7)(u,c)}return Array.isArray(c)?c.map(f):f(c)}}();c.filterProps=["sx"],t.Z=c},2318:function(e,t,n){"use strict";n.d(t,{Z:function(){return u}});var o=n(1997),r=n(3371);var i=r.createContext(null);var a=function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=r.useContext(i);return n&&(e=n,0!==Object.keys(e).length)?n:t},s=(0,o.Z)();var u=function(){return a(arguments.length>0&&void 0!==arguments[0]?arguments[0]:s)}},27:function(e,t,n){"use strict";n.d(t,{Z:function(){return i}});var o=n(4941);var r=n(2318);function i(e){var t=e.props,n=e.name,i=e.defaultTheme,a=function(e){var t=e.theme,n=e.name,r=e.props;return t&&t.components&&t.components[n]&&t.components[n].defaultProps?(0,o.Z)(t.components[n].defaultProps,r):r}({theme:(0,r.Z)(i),name:n,props:t});return a}},1241:function(e,t){"use strict";var n=function(e){return e},o=function(){var e=n;return{configure:function(t){e=t},generate:function(t){return e(t)},reset:function(){e=n}}}();t.Z=o},8015:function(e,t,n){"use strict";n.d(t,{Z:function(){return r}});var o=n(9958);function r(e){if("string"!==typeof e)throw new Error((0,o.Z)(7));return e.charAt(0).toUpperCase()+e.slice(1)}},1119:function(e,t,n){"use strict";function o(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,o={};return Object.keys(e).forEach((function(r){o[r]=e[r].reduce((function(e,o){if(o){var r=t(o);""!==r&&e.push(r),n&&n[o]&&e.push(n[o])}return e}),[]).join(" ")})),o}n.d(t,{Z:function(){return o}})},111:function(e,t,n){"use strict";function o(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.reduce((function(e,t){return null==t?e:function(){for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];e.apply(this,o),t.apply(this,o)}}),(function(){}))}n.d(t,{Z:function(){return o}})},7586:function(e,t,n){"use strict";function o(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:166;function o(){for(var o=this,r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];clearTimeout(t),t=setTimeout((function(){e.apply(o,i)}),n)}return o.clear=function(){clearTimeout(t)},o}n.d(t,{Z:function(){return o}})},92:function(e,t,n){"use strict";n.d(t,{P:function(){return r},Z:function(){return a}});var o=n(1163);function r(e){return null!==e&&"object"===typeof e&&e.constructor===Object}function i(e){if(!r(e))return e;var t={};return Object.keys(e).forEach((function(n){t[n]=i(e[n])})),t}function a(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{clone:!0},s=n.clone?(0,o.Z)({},e):e;return r(e)&&r(t)&&Object.keys(t).forEach((function(o){"__proto__"!==o&&(r(t[o])&&o in e&&r(e[o])?s[o]=a(e[o],t[o],n):n.clone?s[o]=r(t[o])?i(t[o]):t[o]:s[o]=t[o])})),s}},9958:function(e,t,n){"use strict";function o(e){for(var t="https://mui.com/production-error/?code="+e,n=1;n<arguments.length;n+=1)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified MUI error #"+e+"; visit "+t+" for the full message."}n.d(t,{Z:function(){return o}})},4095:function(e,t,n){"use strict";n.d(t,{Z:function(){return i}});var o=n(1241),r={active:"active",checked:"checked",completed:"completed",disabled:"disabled",readOnly:"readOnly",error:"error",expanded:"expanded",focused:"focused",focusVisible:"focusVisible",required:"required",selected:"selected"};function i(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Mui",i=r[t];return i?"".concat(n,"-").concat(i):"".concat(o.Z.generate(e),"-").concat(t)}},3814:function(e,t,n){"use strict";n.d(t,{Z:function(){return r}});var o=n(4095);function r(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Mui",r={};return t.forEach((function(t){r[t]=(0,o.Z)(e,t,n)})),r}},4481:function(e,t,n){"use strict";function o(e){return e&&e.ownerDocument||document}n.d(t,{Z:function(){return o}})},4920:function(e,t,n){"use strict";n.d(t,{Z:function(){return r}});var o=n(4481);function r(e){return(0,o.Z)(e).defaultView||window}},4941:function(e,t,n){"use strict";n.d(t,{Z:function(){return r}});var o=n(1163);function r(e,t){var n=(0,o.Z)({},t);return Object.keys(e).forEach((function(i){if(i.toString().match(/^(components|slots)$/))n[i]=(0,o.Z)({},e[i],n[i]);else if(i.toString().match(/^(componentsProps|slotProps)$/)){var a=e[i]||{},s=t[i];n[i]={},s&&Object.keys(s)?a&&Object.keys(a)?(n[i]=(0,o.Z)({},s),Object.keys(a).forEach((function(e){n[i][e]=r(a[e],s[e])}))):n[i]=s:n[i]=a}else void 0===n[i]&&(n[i]=e[i])})),n}},6544:function(e,t,n){"use strict";function o(e,t){"function"===typeof e?e(t):e&&(e.current=t)}n.d(t,{Z:function(){return o}})},1663:function(e,t,n){"use strict";var o=n(3371),r="undefined"!==typeof window?o.useLayoutEffect:o.useEffect;t.Z=r},8050:function(e,t,n){"use strict";n.d(t,{Z:function(){return i}});var o=n(3371),r=n(1663);function i(e){var t=o.useRef(e);return(0,r.Z)((function(){t.current=e})),o.useCallback((function(){return t.current.apply(void 0,arguments)}),[])}},9091:function(e,t,n){"use strict";n.d(t,{Z:function(){return i}});var o=n(3371),r=n(6544);function i(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return o.useMemo((function(){return t.every((function(e){return null==e}))?null:function(e){t.forEach((function(t){(0,r.Z)(t,e)}))}}),t)}},5307:function(e,t,n){"use strict";var o;n.d(t,{Z:function(){return u}});var r=n(6377),i=n(3371),a=0;var s=(o||(o=n.t(i,2))).useId;function u(e){if(void 0!==s){var t=s();return null!=e?e:t}return function(e){var t=i.useState(e),n=(0,r.Z)(t,2),o=n[0],s=n[1],u=e||o;return i.useEffect((function(){null==o&&s("mui-".concat(a+=1))}),[o]),u}(e)}},3788:function(e,t,n){"use strict";function o(e){var t,n,r="";if("string"==typeof e||"number"==typeof e)r+=e;else if("object"==typeof e)if(Array.isArray(e))for(t=0;t<e.length;t++)e[t]&&(n=o(e[t]))&&(r&&(r+=" "),r+=n);else for(t in e)e[t]&&(r&&(r+=" "),r+=t);return r}t.Z=function(){for(var e,t,n=0,r="";n<arguments.length;)(e=arguments[n++])&&(t=o(e))&&(r&&(r+=" "),r+=t);return r}},2623:function(e,t,n){"use strict";var o=n(3307),r={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},i={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},a={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},s={};function u(e){return o.isMemo(e)?a:s[e.$$typeof]||r}s[o.ForwardRef]={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},s[o.Memo]=a;var c=Object.defineProperty,l=Object.getOwnPropertyNames,d=Object.getOwnPropertySymbols,p=Object.getOwnPropertyDescriptor,f=Object.getPrototypeOf,h=Object.prototype;e.exports=function e(t,n,o){if("string"!==typeof n){if(h){var r=f(n);r&&r!==h&&e(t,r,o)}var a=l(n);d&&(a=a.concat(d(n)));for(var s=u(t),g=u(n),v=0;v<a.length;++v){var m=a[v];if(!i[m]&&(!o||!o[m])&&(!g||!g[m])&&(!s||!s[m])){var _=p(n,m);try{c(t,m,_)}catch(y){}}}}return t}},3562:function(e,t,n){"use strict";var o=n(3371),r=n(2720);function i(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var a=new Set,s={};function u(e,t){c(e,t),c(e+"Capture",t)}function c(e,t){for(s[e]=t,e=0;e<t.length;e++)a.add(t[e])}var l=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),d=Object.prototype.hasOwnProperty,p=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,f={},h={};function g(e,t,n,o,r,i,a){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=o,this.attributeNamespace=r,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=i,this.removeEmptyString=a}var v={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(e){v[e]=new g(e,0,!1,e,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(e){var t=e[0];v[t]=new g(t,1,!1,e[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(e){v[e]=new g(e,2,!1,e.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(e){v[e]=new g(e,2,!1,e,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(e){v[e]=new g(e,3,!1,e.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(e){v[e]=new g(e,3,!0,e,null,!1,!1)})),["capture","download"].forEach((function(e){v[e]=new g(e,4,!1,e,null,!1,!1)})),["cols","rows","size","span"].forEach((function(e){v[e]=new g(e,6,!1,e,null,!1,!1)})),["rowSpan","start"].forEach((function(e){v[e]=new g(e,5,!1,e.toLowerCase(),null,!1,!1)}));var m=/[\-:]([a-z])/g;function _(e){return e[1].toUpperCase()}function y(e,t,n,o){var r=v.hasOwnProperty(t)?v[t]:null;(null!==r?0!==r.type:o||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,n,o){if(null===t||"undefined"===typeof t||function(e,t,n,o){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!o&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,n,o))return!0;if(o)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,n,r,o)&&(n=null),o||null===r?function(e){return!!d.call(h,e)||!d.call(f,e)&&(p.test(e)?h[e]=!0:(f[e]=!0,!1))}(t)&&(null===n?e.removeAttribute(t):e.setAttribute(t,""+n)):r.mustUseProperty?e[r.propertyName]=null===n?3!==r.type&&"":n:(t=r.attributeName,o=r.attributeNamespace,null===n?e.removeAttribute(t):(n=3===(r=r.type)||4===r&&!0===n?"":""+n,o?e.setAttributeNS(o,t,n):e.setAttribute(t,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(e){var t=e.replace(m,_);v[t]=new g(t,1,!1,e,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(e){var t=e.replace(m,_);v[t]=new g(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(e){var t=e.replace(m,_);v[t]=new g(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(e){v[e]=new g(e,1,!1,e.toLowerCase(),null,!1,!1)})),v.xlinkHref=new g("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(e){v[e]=new g(e,1,!1,e.toLowerCase(),null,!0,!0)}));var M=o.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,I=Symbol.for("react.element"),C=Symbol.for("react.portal"),k=Symbol.for("react.fragment"),T=Symbol.for("react.strict_mode"),S=Symbol.for("react.profiler"),b=Symbol.for("react.provider"),D=Symbol.for("react.context"),E=Symbol.for("react.forward_ref"),A=Symbol.for("react.suspense"),L=Symbol.for("react.suspense_list"),R=Symbol.for("react.memo"),w=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var O=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var N=Symbol.iterator;function P(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=N&&e[N]||e["@@iterator"])?e:null}var G,U=Object.assign;function x(e){if(void 0===G)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);G=t&&t[1]||""}return"\n"+G+e}var F=!1;function q(e,t){if(!e||F)return"";F=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var o=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){o=c}e.call(t.prototype)}else{try{throw Error()}catch(c){o=c}e()}}catch(c){if(c&&o&&"string"===typeof c.stack){for(var r=c.stack.split("\n"),i=o.stack.split("\n"),a=r.length-1,s=i.length-1;1<=a&&0<=s&&r[a]!==i[s];)s--;for(;1<=a&&0<=s;a--,s--)if(r[a]!==i[s]){if(1!==a||1!==s)do{if(a--,0>--s||r[a]!==i[s]){var u="\n"+r[a].replace(" at new "," at ");return e.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",e.displayName)),u}}while(1<=a&&0<=s);break}}}finally{F=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?x(e):""}function B(e){switch(e.tag){case 5:return x(e.type);case 16:return x("Lazy");case 13:return x("Suspense");case 19:return x("SuspenseList");case 0:case 2:case 15:return e=q(e.type,!1);case 11:return e=q(e.type.render,!1);case 1:return e=q(e.type,!0);default:return""}}function V(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case k:return"Fragment";case C:return"Portal";case S:return"Profiler";case T:return"StrictMode";case A:return"Suspense";case L:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case D:return(e.displayName||"Context")+".Consumer";case b:return(e._context.displayName||"Context")+".Provider";case E:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case R:return null!==(t=e.displayName||null)?t:V(e.type)||"Memo";case w:t=e._payload,e=e._init;try{return V(e(t))}catch(n){}}return null}function H(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return V(t);case 8:return t===T?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t}return null}function K(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function j(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function z(e){e._valueTracker||(e._valueTracker=function(e){var t=j(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),o=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var r=n.get,i=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return r.call(this)},set:function(e){o=""+e,i.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return o},setValue:function(e){o=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function Z(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),o="";return e&&(o=j(e)?e.checked?"true":"false":e.value),(e=o)!==n&&(t.setValue(e),!0)}function W(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function Y(e,t){var n=t.checked;return U({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:e._wrapperState.initialChecked})}function J(e,t){var n=null==t.defaultValue?"":t.defaultValue,o=null!=t.checked?t.checked:t.defaultChecked;n=K(null!=t.value?t.value:n),e._wrapperState={initialChecked:o,initialValue:n,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function X(e,t){null!=(t=t.checked)&&y(e,"checked",t,!1)}function $(e,t){X(e,t);var n=K(t.value),o=t.type;if(null!=n)"number"===o?(0===n&&""===e.value||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if("submit"===o||"reset"===o)return void e.removeAttribute("value");t.hasOwnProperty("value")?ee(e,t.type,n):t.hasOwnProperty("defaultValue")&&ee(e,t.type,K(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function Q(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var o=t.type;if(!("submit"!==o&&"reset"!==o||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}""!==(n=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==n&&(e.name=n)}function ee(e,t,n){"number"===t&&W(e.ownerDocument)===e||(null==n?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var te=Array.isArray;function ne(e,t,n,o){if(e=e.options,t){t={};for(var r=0;r<n.length;r++)t["$"+n[r]]=!0;for(n=0;n<e.length;n++)r=t.hasOwnProperty("$"+e[n].value),e[n].selected!==r&&(e[n].selected=r),r&&o&&(e[n].defaultSelected=!0)}else{for(n=""+K(n),t=null,r=0;r<e.length;r++){if(e[r].value===n)return e[r].selected=!0,void(o&&(e[r].defaultSelected=!0));null!==t||e[r].disabled||(t=e[r])}null!==t&&(t.selected=!0)}}function oe(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(i(91));return U({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function re(e,t){var n=t.value;if(null==n){if(n=t.children,t=t.defaultValue,null!=n){if(null!=t)throw Error(i(92));if(te(n)){if(1<n.length)throw Error(i(93));n=n[0]}t=n}null==t&&(t=""),n=t}e._wrapperState={initialValue:K(n)}}function ie(e,t){var n=K(t.value),o=K(t.defaultValue);null!=n&&((n=""+n)!==e.value&&(e.value=n),null==t.defaultValue&&e.defaultValue!==n&&(e.defaultValue=n)),null!=o&&(e.defaultValue=""+o)}function ae(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function se(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function ue(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?se(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var ce,le,de=(le=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((ce=ce||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ce.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,n,o){MSApp.execUnsafeLocalFunction((function(){return le(e,t)}))}:le);function pe(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var fe={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},he=["Webkit","ms","Moz","O"];function ge(e,t,n){return null==t||"boolean"===typeof t||""===t?"":n||"number"!==typeof t||0===t||fe.hasOwnProperty(e)&&fe[e]?(""+t).trim():t+"px"}function ve(e,t){for(var n in e=e.style,t)if(t.hasOwnProperty(n)){var o=0===n.indexOf("--"),r=ge(n,t[n],o);"float"===n&&(n="cssFloat"),o?e.setProperty(n,r):e[n]=r}}Object.keys(fe).forEach((function(e){he.forEach((function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),fe[t]=fe[e]}))}));var me=U({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function _e(e,t){if(t){if(me[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(i(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(i(60));if("object"!==typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(i(61))}if(null!=t.style&&"object"!==typeof t.style)throw Error(i(62))}}function ye(e,t){if(-1===e.indexOf("-"))return"string"===typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Me=null;function Ie(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var Ce=null,ke=null,Te=null;function Se(e){if(e=Mr(e)){if("function"!==typeof Ce)throw Error(i(280));var t=e.stateNode;t&&(t=Cr(t),Ce(e.stateNode,e.type,t))}}function be(e){ke?Te?Te.push(e):Te=[e]:ke=e}function De(){if(ke){var e=ke,t=Te;if(Te=ke=null,Se(e),t)for(e=0;e<t.length;e++)Se(t[e])}}function Ee(e,t){return e(t)}function Ae(){}var Le=!1;function Re(e,t,n){if(Le)return e(t,n);Le=!0;try{return Ee(e,t,n)}finally{Le=!1,(null!==ke||null!==Te)&&(Ae(),De())}}function we(e,t){var n=e.stateNode;if(null===n)return null;var o=Cr(n);if(null===o)return null;n=o[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(o=!o.disabled)||(o=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!o;break e;default:e=!1}if(e)return null;if(n&&"function"!==typeof n)throw Error(i(231,t,typeof n));return n}var Oe=!1;if(l)try{var Ne={};Object.defineProperty(Ne,"passive",{get:function(){Oe=!0}}),window.addEventListener("test",Ne,Ne),window.removeEventListener("test",Ne,Ne)}catch(le){Oe=!1}function Pe(e,t,n,o,r,i,a,s,u){var c=Array.prototype.slice.call(arguments,3);try{t.apply(n,c)}catch(l){this.onError(l)}}var Ge=!1,Ue=null,xe=!1,Fe=null,qe={onError:function(e){Ge=!0,Ue=e}};function Be(e,t,n,o,r,i,a,s,u){Ge=!1,Ue=null,Pe.apply(qe,arguments)}function Ve(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function He(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function Ke(e){if(Ve(e)!==e)throw Error(i(188))}function je(e){return null!==(e=function(e){var t=e.alternate;if(!t){if(null===(t=Ve(e)))throw Error(i(188));return t!==e?null:e}for(var n=e,o=t;;){var r=n.return;if(null===r)break;var a=r.alternate;if(null===a){if(null!==(o=r.return)){n=o;continue}break}if(r.child===a.child){for(a=r.child;a;){if(a===n)return Ke(r),e;if(a===o)return Ke(r),t;a=a.sibling}throw Error(i(188))}if(n.return!==o.return)n=r,o=a;else{for(var s=!1,u=r.child;u;){if(u===n){s=!0,n=r,o=a;break}if(u===o){s=!0,o=r,n=a;break}u=u.sibling}if(!s){for(u=a.child;u;){if(u===n){s=!0,n=a,o=r;break}if(u===o){s=!0,o=a,n=r;break}u=u.sibling}if(!s)throw Error(i(189))}}if(n.alternate!==o)throw Error(i(190))}if(3!==n.tag)throw Error(i(188));return n.stateNode.current===n?e:t}(e))?ze(e):null}function ze(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=ze(e);if(null!==t)return t;e=e.sibling}return null}var Ze=r.unstable_scheduleCallback,We=r.unstable_cancelCallback,Ye=r.unstable_shouldYield,Je=r.unstable_requestPaint,Xe=r.unstable_now,$e=r.unstable_getCurrentPriorityLevel,Qe=r.unstable_ImmediatePriority,et=r.unstable_UserBlockingPriority,tt=r.unstable_NormalPriority,nt=r.unstable_LowPriority,ot=r.unstable_IdlePriority,rt=null,it=null;var at=Math.clz32?Math.clz32:function(e){return e>>>=0,0===e?32:31-(st(e)/ut|0)|0},st=Math.log,ut=Math.LN2;var ct=64,lt=4194304;function dt(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function pt(e,t){var n=e.pendingLanes;if(0===n)return 0;var o=0,r=e.suspendedLanes,i=e.pingedLanes,a=268435455&n;if(0!==a){var s=a&~r;0!==s?o=dt(s):0!==(i&=a)&&(o=dt(i))}else 0!==(a=n&~r)?o=dt(a):0!==i&&(o=dt(i));if(0===o)return 0;if(0!==t&&t!==o&&0===(t&r)&&((r=o&-o)>=(i=t&-t)||16===r&&0!==(4194240&i)))return t;if(0!==(4&o)&&(o|=16&n),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=o;0<t;)r=1<<(n=31-at(t)),o|=e[n],t&=~r;return o}function ft(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function ht(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function gt(){var e=ct;return 0===(4194240&(ct<<=1))&&(ct=64),e}function vt(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function mt(e,t,n){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-at(t)]=n}function _t(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var o=31-at(n),r=1<<o;r&t|e[o]&t&&(e[o]|=t),n&=~r}}var yt=0;function Mt(e){return 1<(e&=-e)?4<e?0!==(268435455&e)?16:536870912:4:1}var It,Ct,kt,Tt,St,bt=!1,Dt=[],Et=null,At=null,Lt=null,Rt=new Map,wt=new Map,Ot=[],Nt="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Pt(e,t){switch(e){case"focusin":case"focusout":Et=null;break;case"dragenter":case"dragleave":At=null;break;case"mouseover":case"mouseout":Lt=null;break;case"pointerover":case"pointerout":Rt.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":wt.delete(t.pointerId)}}function Gt(e,t,n,o,r,i){return null===e||e.nativeEvent!==i?(e={blockedOn:t,domEventName:n,eventSystemFlags:o,nativeEvent:i,targetContainers:[r]},null!==t&&(null!==(t=Mr(t))&&Ct(t)),e):(e.eventSystemFlags|=o,t=e.targetContainers,null!==r&&-1===t.indexOf(r)&&t.push(r),e)}function Ut(e){var t=yr(e.target);if(null!==t){var n=Ve(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=He(n)))return e.blockedOn=t,void St(e.priority,(function(){kt(n)}))}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function xt(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=Yt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n)return null!==(t=Mr(n))&&Ct(t),e.blockedOn=n,!1;var o=new(n=e.nativeEvent).constructor(n.type,n);Me=o,n.target.dispatchEvent(o),Me=null,t.shift()}return!0}function Ft(e,t,n){xt(e)&&n.delete(t)}function qt(){bt=!1,null!==Et&&xt(Et)&&(Et=null),null!==At&&xt(At)&&(At=null),null!==Lt&&xt(Lt)&&(Lt=null),Rt.forEach(Ft),wt.forEach(Ft)}function Bt(e,t){e.blockedOn===t&&(e.blockedOn=null,bt||(bt=!0,r.unstable_scheduleCallback(r.unstable_NormalPriority,qt)))}function Vt(e){function t(t){return Bt(t,e)}if(0<Dt.length){Bt(Dt[0],e);for(var n=1;n<Dt.length;n++){var o=Dt[n];o.blockedOn===e&&(o.blockedOn=null)}}for(null!==Et&&Bt(Et,e),null!==At&&Bt(At,e),null!==Lt&&Bt(Lt,e),Rt.forEach(t),wt.forEach(t),n=0;n<Ot.length;n++)(o=Ot[n]).blockedOn===e&&(o.blockedOn=null);for(;0<Ot.length&&null===(n=Ot[0]).blockedOn;)Ut(n),null===n.blockedOn&&Ot.shift()}var Ht=M.ReactCurrentBatchConfig,Kt=!0;function jt(e,t,n,o){var r=yt,i=Ht.transition;Ht.transition=null;try{yt=1,Zt(e,t,n,o)}finally{yt=r,Ht.transition=i}}function zt(e,t,n,o){var r=yt,i=Ht.transition;Ht.transition=null;try{yt=4,Zt(e,t,n,o)}finally{yt=r,Ht.transition=i}}function Zt(e,t,n,o){if(Kt){var r=Yt(e,t,n,o);if(null===r)jo(e,t,o,Wt,n),Pt(e,o);else if(function(e,t,n,o,r){switch(t){case"focusin":return Et=Gt(Et,e,t,n,o,r),!0;case"dragenter":return At=Gt(At,e,t,n,o,r),!0;case"mouseover":return Lt=Gt(Lt,e,t,n,o,r),!0;case"pointerover":var i=r.pointerId;return Rt.set(i,Gt(Rt.get(i)||null,e,t,n,o,r)),!0;case"gotpointercapture":return i=r.pointerId,wt.set(i,Gt(wt.get(i)||null,e,t,n,o,r)),!0}return!1}(r,e,t,n,o))o.stopPropagation();else if(Pt(e,o),4&t&&-1<Nt.indexOf(e)){for(;null!==r;){var i=Mr(r);if(null!==i&&It(i),null===(i=Yt(e,t,n,o))&&jo(e,t,o,Wt,n),i===r)break;r=i}null!==r&&o.stopPropagation()}else jo(e,t,o,null,n)}}var Wt=null;function Yt(e,t,n,o){if(Wt=null,null!==(e=yr(e=Ie(o))))if(null===(t=Ve(e)))e=null;else if(13===(n=t.tag)){if(null!==(e=He(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Wt=e,null}function Jt(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch($e()){case Qe:return 1;case et:return 4;case tt:case nt:return 16;case ot:return 536870912;default:return 16}default:return 16}}var Xt=null,$t=null,Qt=null;function en(){if(Qt)return Qt;var e,t,n=$t,o=n.length,r="value"in Xt?Xt.value:Xt.textContent,i=r.length;for(e=0;e<o&&n[e]===r[e];e++);var a=o-e;for(t=1;t<=a&&n[o-t]===r[i-t];t++);return Qt=r.slice(e,1<t?1-t:void 0)}function tn(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function nn(){return!0}function on(){return!1}function rn(e){function t(t,n,o,r,i){for(var a in this._reactName=t,this._targetInst=o,this.type=n,this.nativeEvent=r,this.target=i,this.currentTarget=null,e)e.hasOwnProperty(a)&&(t=e[a],this[a]=t?t(r):r[a]);return this.isDefaultPrevented=(null!=r.defaultPrevented?r.defaultPrevented:!1===r.returnValue)?nn:on,this.isPropagationStopped=on,this}return U(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=nn)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=nn)},persist:function(){},isPersistent:nn}),t}var an,sn,un,cn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ln=rn(cn),dn=U({},cn,{view:0,detail:0}),pn=rn(dn),fn=U({},dn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Sn,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==un&&(un&&"mousemove"===e.type?(an=e.screenX-un.screenX,sn=e.screenY-un.screenY):sn=an=0,un=e),an)},movementY:function(e){return"movementY"in e?e.movementY:sn}}),hn=rn(fn),gn=rn(U({},fn,{dataTransfer:0})),vn=rn(U({},dn,{relatedTarget:0})),mn=rn(U({},cn,{animationName:0,elapsedTime:0,pseudoElement:0})),_n=U({},cn,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),yn=rn(_n),Mn=rn(U({},cn,{data:0})),In={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Cn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},kn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Tn(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=kn[e])&&!!t[e]}function Sn(){return Tn}var bn=U({},dn,{key:function(e){if(e.key){var t=In[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=tn(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?Cn[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Sn,charCode:function(e){return"keypress"===e.type?tn(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?tn(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),Dn=rn(bn),En=rn(U({},fn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),An=rn(U({},dn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Sn})),Ln=rn(U({},cn,{propertyName:0,elapsedTime:0,pseudoElement:0})),Rn=U({},fn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),wn=rn(Rn),On=[9,13,27,32],Nn=l&&"CompositionEvent"in window,Pn=null;l&&"documentMode"in document&&(Pn=document.documentMode);var Gn=l&&"TextEvent"in window&&!Pn,Un=l&&(!Nn||Pn&&8<Pn&&11>=Pn),xn=String.fromCharCode(32),Fn=!1;function qn(e,t){switch(e){case"keyup":return-1!==On.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Bn(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var Vn=!1;var Hn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Kn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Hn[e.type]:"textarea"===t}function jn(e,t,n,o){be(o),0<(t=Zo(t,"onChange")).length&&(n=new ln("onChange","change",null,n,o),e.push({event:n,listeners:t}))}var zn=null,Zn=null;function Wn(e){Fo(e,0)}function Yn(e){if(Z(Ir(e)))return e}function Jn(e,t){if("change"===e)return t}var Xn=!1;if(l){var $n;if(l){var Qn="oninput"in document;if(!Qn){var eo=document.createElement("div");eo.setAttribute("oninput","return;"),Qn="function"===typeof eo.oninput}$n=Qn}else $n=!1;Xn=$n&&(!document.documentMode||9<document.documentMode)}function to(){zn&&(zn.detachEvent("onpropertychange",no),Zn=zn=null)}function no(e){if("value"===e.propertyName&&Yn(Zn)){var t=[];jn(t,Zn,e,Ie(e)),Re(Wn,t)}}function oo(e,t,n){"focusin"===e?(to(),Zn=n,(zn=t).attachEvent("onpropertychange",no)):"focusout"===e&&to()}function ro(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Yn(Zn)}function io(e,t){if("click"===e)return Yn(t)}function ao(e,t){if("input"===e||"change"===e)return Yn(t)}var so="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function uo(e,t){if(so(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),o=Object.keys(t);if(n.length!==o.length)return!1;for(o=0;o<n.length;o++){var r=n[o];if(!d.call(t,r)||!so(e[r],t[r]))return!1}return!0}function co(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function lo(e,t){var n,o=co(e);for(e=0;o;){if(3===o.nodeType){if(n=e+o.textContent.length,e<=t&&n>=t)return{node:o,offset:t-e};e=n}e:{for(;o;){if(o.nextSibling){o=o.nextSibling;break e}o=o.parentNode}o=void 0}o=co(o)}}function po(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?po(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function fo(){for(var e=window,t=W();t instanceof e.HTMLIFrameElement;){try{var n="string"===typeof t.contentWindow.location.href}catch(o){n=!1}if(!n)break;t=W((e=t.contentWindow).document)}return t}function ho(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function go(e){var t=fo(),n=e.focusedElem,o=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&po(n.ownerDocument.documentElement,n)){if(null!==o&&ho(n))if(t=o.start,void 0===(e=o.end)&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if((e=(t=n.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var r=n.textContent.length,i=Math.min(o.start,r);o=void 0===o.end?i:Math.min(o.end,r),!e.extend&&i>o&&(r=o,o=i,i=r),r=lo(n,i);var a=lo(n,o);r&&a&&(1!==e.rangeCount||e.anchorNode!==r.node||e.anchorOffset!==r.offset||e.focusNode!==a.node||e.focusOffset!==a.offset)&&((t=t.createRange()).setStart(r.node,r.offset),e.removeAllRanges(),i>o?(e.addRange(t),e.extend(a.node,a.offset)):(t.setEnd(a.node,a.offset),e.addRange(t)))}for(t=[],e=n;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"===typeof n.focus&&n.focus(),n=0;n<t.length;n++)(e=t[n]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var vo=l&&"documentMode"in document&&11>=document.documentMode,mo=null,_o=null,yo=null,Mo=!1;function Io(e,t,n){var o=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;Mo||null==mo||mo!==W(o)||("selectionStart"in(o=mo)&&ho(o)?o={start:o.selectionStart,end:o.selectionEnd}:o={anchorNode:(o=(o.ownerDocument&&o.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:o.anchorOffset,focusNode:o.focusNode,focusOffset:o.focusOffset},yo&&uo(yo,o)||(yo=o,0<(o=Zo(_o,"onSelect")).length&&(t=new ln("onSelect","select",null,t,n),e.push({event:t,listeners:o}),t.target=mo)))}function Co(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var ko={animationend:Co("Animation","AnimationEnd"),animationiteration:Co("Animation","AnimationIteration"),animationstart:Co("Animation","AnimationStart"),transitionend:Co("Transition","TransitionEnd")},To={},So={};function bo(e){if(To[e])return To[e];if(!ko[e])return e;var t,n=ko[e];for(t in n)if(n.hasOwnProperty(t)&&t in So)return To[e]=n[t];return e}l&&(So=document.createElement("div").style,"AnimationEvent"in window||(delete ko.animationend.animation,delete ko.animationiteration.animation,delete ko.animationstart.animation),"TransitionEvent"in window||delete ko.transitionend.transition);var Do=bo("animationend"),Eo=bo("animationiteration"),Ao=bo("animationstart"),Lo=bo("transitionend"),Ro=new Map,wo="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Oo(e,t){Ro.set(e,t),u(t,[e])}for(var No=0;No<wo.length;No++){var Po=wo[No];Oo(Po.toLowerCase(),"on"+(Po[0].toUpperCase()+Po.slice(1)))}Oo(Do,"onAnimationEnd"),Oo(Eo,"onAnimationIteration"),Oo(Ao,"onAnimationStart"),Oo("dblclick","onDoubleClick"),Oo("focusin","onFocus"),Oo("focusout","onBlur"),Oo(Lo,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),u("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),u("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),u("onBeforeInput",["compositionend","keypress","textInput","paste"]),u("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),u("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),u("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Go="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Uo=new Set("cancel close invalid load scroll toggle".split(" ").concat(Go));function xo(e,t,n){var o=e.type||"unknown-event";e.currentTarget=n,function(e,t,n,o,r,a,s,u,c){if(Be.apply(this,arguments),Ge){if(!Ge)throw Error(i(198));var l=Ue;Ge=!1,Ue=null,xe||(xe=!0,Fe=l)}}(o,t,void 0,e),e.currentTarget=null}function Fo(e,t){t=0!==(4&t);for(var n=0;n<e.length;n++){var o=e[n],r=o.event;o=o.listeners;e:{var i=void 0;if(t)for(var a=o.length-1;0<=a;a--){var s=o[a],u=s.instance,c=s.currentTarget;if(s=s.listener,u!==i&&r.isPropagationStopped())break e;xo(r,s,c),i=u}else for(a=0;a<o.length;a++){if(u=(s=o[a]).instance,c=s.currentTarget,s=s.listener,u!==i&&r.isPropagationStopped())break e;xo(r,s,c),i=u}}}if(xe)throw e=Fe,xe=!1,Fe=null,e}function qo(e,t){var n=t[vr];void 0===n&&(n=t[vr]=new Set);var o=e+"__bubble";n.has(o)||(Ko(t,e,2,!1),n.add(o))}function Bo(e,t,n){var o=0;t&&(o|=4),Ko(n,e,o,t)}var Vo="_reactListening"+Math.random().toString(36).slice(2);function Ho(e){if(!e[Vo]){e[Vo]=!0,a.forEach((function(t){"selectionchange"!==t&&(Uo.has(t)||Bo(t,!1,e),Bo(t,!0,e))}));var t=9===e.nodeType?e:e.ownerDocument;null===t||t[Vo]||(t[Vo]=!0,Bo("selectionchange",!1,t))}}function Ko(e,t,n,o){switch(Jt(t)){case 1:var r=jt;break;case 4:r=zt;break;default:r=Zt}n=r.bind(null,t,n,e),r=void 0,!Oe||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(r=!0),o?void 0!==r?e.addEventListener(t,n,{capture:!0,passive:r}):e.addEventListener(t,n,!0):void 0!==r?e.addEventListener(t,n,{passive:r}):e.addEventListener(t,n,!1)}function jo(e,t,n,o,r){var i=o;if(0===(1&t)&&0===(2&t)&&null!==o)e:for(;;){if(null===o)return;var a=o.tag;if(3===a||4===a){var s=o.stateNode.containerInfo;if(s===r||8===s.nodeType&&s.parentNode===r)break;if(4===a)for(a=o.return;null!==a;){var u=a.tag;if((3===u||4===u)&&((u=a.stateNode.containerInfo)===r||8===u.nodeType&&u.parentNode===r))return;a=a.return}for(;null!==s;){if(null===(a=yr(s)))return;if(5===(u=a.tag)||6===u){o=i=a;continue e}s=s.parentNode}}o=o.return}Re((function(){var o=i,r=Ie(n),a=[];e:{var s=Ro.get(e);if(void 0!==s){var u=ln,c=e;switch(e){case"keypress":if(0===tn(n))break e;case"keydown":case"keyup":u=Dn;break;case"focusin":c="focus",u=vn;break;case"focusout":c="blur",u=vn;break;case"beforeblur":case"afterblur":u=vn;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":u=hn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":u=gn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":u=An;break;case Do:case Eo:case Ao:u=mn;break;case Lo:u=Ln;break;case"scroll":u=pn;break;case"wheel":u=wn;break;case"copy":case"cut":case"paste":u=yn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":u=En}var l=0!==(4&t),d=!l&&"scroll"===e,p=l?null!==s?s+"Capture":null:s;l=[];for(var f,h=o;null!==h;){var g=(f=h).stateNode;if(5===f.tag&&null!==g&&(f=g,null!==p&&(null!=(g=we(h,p))&&l.push(zo(h,g,f)))),d)break;h=h.return}0<l.length&&(s=new u(s,c,null,n,r),a.push({event:s,listeners:l}))}}if(0===(7&t)){if(u="mouseout"===e||"pointerout"===e,(!(s="mouseover"===e||"pointerover"===e)||n===Me||!(c=n.relatedTarget||n.fromElement)||!yr(c)&&!c[gr])&&(u||s)&&(s=r.window===r?r:(s=r.ownerDocument)?s.defaultView||s.parentWindow:window,u?(u=o,null!==(c=(c=n.relatedTarget||n.toElement)?yr(c):null)&&(c!==(d=Ve(c))||5!==c.tag&&6!==c.tag)&&(c=null)):(u=null,c=o),u!==c)){if(l=hn,g="onMouseLeave",p="onMouseEnter",h="mouse","pointerout"!==e&&"pointerover"!==e||(l=En,g="onPointerLeave",p="onPointerEnter",h="pointer"),d=null==u?s:Ir(u),f=null==c?s:Ir(c),(s=new l(g,h+"leave",u,n,r)).target=d,s.relatedTarget=f,g=null,yr(r)===o&&((l=new l(p,h+"enter",c,n,r)).target=f,l.relatedTarget=d,g=l),d=g,u&&c)e:{for(p=c,h=0,f=l=u;f;f=Wo(f))h++;for(f=0,g=p;g;g=Wo(g))f++;for(;0<h-f;)l=Wo(l),h--;for(;0<f-h;)p=Wo(p),f--;for(;h--;){if(l===p||null!==p&&l===p.alternate)break e;l=Wo(l),p=Wo(p)}l=null}else l=null;null!==u&&Yo(a,s,u,l,!1),null!==c&&null!==d&&Yo(a,d,c,l,!0)}if("select"===(u=(s=o?Ir(o):window).nodeName&&s.nodeName.toLowerCase())||"input"===u&&"file"===s.type)var v=Jn;else if(Kn(s))if(Xn)v=ao;else{v=ro;var m=oo}else(u=s.nodeName)&&"input"===u.toLowerCase()&&("checkbox"===s.type||"radio"===s.type)&&(v=io);switch(v&&(v=v(e,o))?jn(a,v,n,r):(m&&m(e,s,o),"focusout"===e&&(m=s._wrapperState)&&m.controlled&&"number"===s.type&&ee(s,"number",s.value)),m=o?Ir(o):window,e){case"focusin":(Kn(m)||"true"===m.contentEditable)&&(mo=m,_o=o,yo=null);break;case"focusout":yo=_o=mo=null;break;case"mousedown":Mo=!0;break;case"contextmenu":case"mouseup":case"dragend":Mo=!1,Io(a,n,r);break;case"selectionchange":if(vo)break;case"keydown":case"keyup":Io(a,n,r)}var _;if(Nn)e:{switch(e){case"compositionstart":var y="onCompositionStart";break e;case"compositionend":y="onCompositionEnd";break e;case"compositionupdate":y="onCompositionUpdate";break e}y=void 0}else Vn?qn(e,n)&&(y="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(y="onCompositionStart");y&&(Un&&"ko"!==n.locale&&(Vn||"onCompositionStart"!==y?"onCompositionEnd"===y&&Vn&&(_=en()):($t="value"in(Xt=r)?Xt.value:Xt.textContent,Vn=!0)),0<(m=Zo(o,y)).length&&(y=new Mn(y,e,null,n,r),a.push({event:y,listeners:m}),_?y.data=_:null!==(_=Bn(n))&&(y.data=_))),(_=Gn?function(e,t){switch(e){case"compositionend":return Bn(t);case"keypress":return 32!==t.which?null:(Fn=!0,xn);case"textInput":return(e=t.data)===xn&&Fn?null:e;default:return null}}(e,n):function(e,t){if(Vn)return"compositionend"===e||!Nn&&qn(e,t)?(e=en(),Qt=$t=Xt=null,Vn=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Un&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(o=Zo(o,"onBeforeInput")).length&&(r=new Mn("onBeforeInput","beforeinput",null,n,r),a.push({event:r,listeners:o}),r.data=_))}Fo(a,t)}))}function zo(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Zo(e,t){for(var n=t+"Capture",o=[];null!==e;){var r=e,i=r.stateNode;5===r.tag&&null!==i&&(r=i,null!=(i=we(e,n))&&o.unshift(zo(e,i,r)),null!=(i=we(e,t))&&o.push(zo(e,i,r))),e=e.return}return o}function Wo(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Yo(e,t,n,o,r){for(var i=t._reactName,a=[];null!==n&&n!==o;){var s=n,u=s.alternate,c=s.stateNode;if(null!==u&&u===o)break;5===s.tag&&null!==c&&(s=c,r?null!=(u=we(n,i))&&a.unshift(zo(n,u,s)):r||null!=(u=we(n,i))&&a.push(zo(n,u,s))),n=n.return}0!==a.length&&e.push({event:t,listeners:a})}var Jo=/\r\n?/g,Xo=/\u0000|\uFFFD/g;function $o(e){return("string"===typeof e?e:""+e).replace(Jo,"\n").replace(Xo,"")}function Qo(e,t,n){if(t=$o(t),$o(e)!==t&&n)throw Error(i(425))}function er(){}var tr=null,nr=null;function or(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var rr="function"===typeof setTimeout?setTimeout:void 0,ir="function"===typeof clearTimeout?clearTimeout:void 0,ar="function"===typeof Promise?Promise:void 0,sr="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof ar?function(e){return ar.resolve(null).then(e).catch(ur)}:rr;function ur(e){setTimeout((function(){throw e}))}function cr(e,t){var n=t,o=0;do{var r=n.nextSibling;if(e.removeChild(n),r&&8===r.nodeType)if("/$"===(n=r.data)){if(0===o)return e.removeChild(r),void Vt(t);o--}else"$"!==n&&"$?"!==n&&"$!"!==n||o++;n=r}while(n);Vt(t)}function lr(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function dr(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}var pr=Math.random().toString(36).slice(2),fr="__reactFiber$"+pr,hr="__reactProps$"+pr,gr="__reactContainer$"+pr,vr="__reactEvents$"+pr,mr="__reactListeners$"+pr,_r="__reactHandles$"+pr;function yr(e){var t=e[fr];if(t)return t;for(var n=e.parentNode;n;){if(t=n[gr]||n[fr]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=dr(e);null!==e;){if(n=e[fr])return n;e=dr(e)}return t}n=(e=n).parentNode}return null}function Mr(e){return!(e=e[fr]||e[gr])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function Ir(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(i(33))}function Cr(e){return e[hr]||null}var kr=[],Tr=-1;function Sr(e){return{current:e}}function br(e){0>Tr||(e.current=kr[Tr],kr[Tr]=null,Tr--)}function Dr(e,t){Tr++,kr[Tr]=e.current,e.current=t}var Er={},Ar=Sr(Er),Lr=Sr(!1),Rr=Er;function wr(e,t){var n=e.type.contextTypes;if(!n)return Er;var o=e.stateNode;if(o&&o.__reactInternalMemoizedUnmaskedChildContext===t)return o.__reactInternalMemoizedMaskedChildContext;var r,i={};for(r in n)i[r]=t[r];return o&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=i),i}function Or(e){return null!==(e=e.childContextTypes)&&void 0!==e}function Nr(){br(Lr),br(Ar)}function Pr(e,t,n){if(Ar.current!==Er)throw Error(i(168));Dr(Ar,t),Dr(Lr,n)}function Gr(e,t,n){var o=e.stateNode;if(t=t.childContextTypes,"function"!==typeof o.getChildContext)return n;for(var r in o=o.getChildContext())if(!(r in t))throw Error(i(108,H(e)||"Unknown",r));return U({},n,o)}function Ur(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Er,Rr=Ar.current,Dr(Ar,e),Dr(Lr,Lr.current),!0}function xr(e,t,n){var o=e.stateNode;if(!o)throw Error(i(169));n?(e=Gr(e,t,Rr),o.__reactInternalMemoizedMergedChildContext=e,br(Lr),br(Ar),Dr(Ar,e)):br(Lr),Dr(Lr,n)}var Fr=null,qr=!1,Br=!1;function Vr(e){null===Fr?Fr=[e]:Fr.push(e)}function Hr(){if(!Br&&null!==Fr){Br=!0;var e=0,t=yt;try{var n=Fr;for(yt=1;e<n.length;e++){var o=n[e];do{o=o(!0)}while(null!==o)}Fr=null,qr=!1}catch(r){throw null!==Fr&&(Fr=Fr.slice(e+1)),Ze(Qe,Hr),r}finally{yt=t,Br=!1}}return null}var Kr=[],jr=0,zr=null,Zr=0,Wr=[],Yr=0,Jr=null,Xr=1,$r="";function Qr(e,t){Kr[jr++]=Zr,Kr[jr++]=zr,zr=e,Zr=t}function ei(e,t,n){Wr[Yr++]=Xr,Wr[Yr++]=$r,Wr[Yr++]=Jr,Jr=e;var o=Xr;e=$r;var r=32-at(o)-1;o&=~(1<<r),n+=1;var i=32-at(t)+r;if(30<i){var a=r-r%5;i=(o&(1<<a)-1).toString(32),o>>=a,r-=a,Xr=1<<32-at(t)+r|n<<r|o,$r=i+e}else Xr=1<<i|n<<r|o,$r=e}function ti(e){null!==e.return&&(Qr(e,1),ei(e,1,0))}function ni(e){for(;e===zr;)zr=Kr[--jr],Kr[jr]=null,Zr=Kr[--jr],Kr[jr]=null;for(;e===Jr;)Jr=Wr[--Yr],Wr[Yr]=null,$r=Wr[--Yr],Wr[Yr]=null,Xr=Wr[--Yr],Wr[Yr]=null}var oi=null,ri=null,ii=!1,ai=null;function si(e,t){var n=wc(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,null===(t=e.deletions)?(e.deletions=[n],e.flags|=16):t.push(n)}function ui(e,t){switch(e.tag){case 5:var n=e.type;return null!==(t=1!==t.nodeType||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,oi=e,ri=lr(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,oi=e,ri=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(n=null!==Jr?{id:Xr,overflow:$r}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},(n=wc(18,null,null,0)).stateNode=t,n.return=e,e.child=n,oi=e,ri=null,!0);default:return!1}}function ci(e){return 0!==(1&e.mode)&&0===(128&e.flags)}function li(e){if(ii){var t=ri;if(t){var n=t;if(!ui(e,t)){if(ci(e))throw Error(i(418));t=lr(n.nextSibling);var o=oi;t&&ui(e,t)?si(o,n):(e.flags=-4097&e.flags|2,ii=!1,oi=e)}}else{if(ci(e))throw Error(i(418));e.flags=-4097&e.flags|2,ii=!1,oi=e}}}function di(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;oi=e}function pi(e){if(e!==oi)return!1;if(!ii)return di(e),ii=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!or(e.type,e.memoizedProps)),t&&(t=ri)){if(ci(e))throw fi(),Error(i(418));for(;t;)si(e,t),t=lr(t.nextSibling)}if(di(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(i(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n){if(0===t){ri=lr(e.nextSibling);break e}t--}else"$"!==n&&"$!"!==n&&"$?"!==n||t++}e=e.nextSibling}ri=null}}else ri=oi?lr(e.stateNode.nextSibling):null;return!0}function fi(){for(var e=ri;e;)e=lr(e.nextSibling)}function hi(){ri=oi=null,ii=!1}function gi(e){null===ai?ai=[e]:ai.push(e)}var vi=M.ReactCurrentBatchConfig;function mi(e,t){if(e&&e.defaultProps){for(var n in t=U({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}var _i=Sr(null),yi=null,Mi=null,Ii=null;function Ci(){Ii=Mi=yi=null}function ki(e){var t=_i.current;br(_i),e._currentValue=t}function Ti(e,t,n){for(;null!==e;){var o=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==o&&(o.childLanes|=t)):null!==o&&(o.childLanes&t)!==t&&(o.childLanes|=t),e===n)break;e=e.return}}function Si(e,t){yi=e,Ii=Mi=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(Ms=!0),e.firstContext=null)}function bi(e){var t=e._currentValue;if(Ii!==e)if(e={context:e,memoizedValue:t,next:null},null===Mi){if(null===yi)throw Error(i(308));Mi=e,yi.dependencies={lanes:0,firstContext:e}}else Mi=Mi.next=e;return t}var Di=null;function Ei(e){null===Di?Di=[e]:Di.push(e)}function Ai(e,t,n,o){var r=t.interleaved;return null===r?(n.next=n,Ei(t)):(n.next=r.next,r.next=n),t.interleaved=n,Li(e,o)}function Li(e,t){e.lanes|=t;var n=e.alternate;for(null!==n&&(n.lanes|=t),n=e,e=e.return;null!==e;)e.childLanes|=t,null!==(n=e.alternate)&&(n.childLanes|=t),n=e,e=e.return;return 3===n.tag?n.stateNode:null}var Ri=!1;function wi(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Oi(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Ni(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Pi(e,t,n){var o=e.updateQueue;if(null===o)return null;if(o=o.shared,0!==(2&Au)){var r=o.pending;return null===r?t.next=t:(t.next=r.next,r.next=t),o.pending=t,Li(e,n)}return null===(r=o.interleaved)?(t.next=t,Ei(o)):(t.next=r.next,r.next=t),o.interleaved=t,Li(e,n)}function Gi(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194240&n))){var o=t.lanes;n|=o&=e.pendingLanes,t.lanes=n,_t(e,n)}}function Ui(e,t){var n=e.updateQueue,o=e.alternate;if(null!==o&&n===(o=o.updateQueue)){var r=null,i=null;if(null!==(n=n.firstBaseUpdate)){do{var a={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===i?r=i=a:i=i.next=a,n=n.next}while(null!==n);null===i?r=i=t:i=i.next=t}else r=i=t;return n={baseState:o.baseState,firstBaseUpdate:r,lastBaseUpdate:i,shared:o.shared,effects:o.effects},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function xi(e,t,n,o){var r=e.updateQueue;Ri=!1;var i=r.firstBaseUpdate,a=r.lastBaseUpdate,s=r.shared.pending;if(null!==s){r.shared.pending=null;var u=s,c=u.next;u.next=null,null===a?i=c:a.next=c,a=u;var l=e.alternate;null!==l&&((s=(l=l.updateQueue).lastBaseUpdate)!==a&&(null===s?l.firstBaseUpdate=c:s.next=c,l.lastBaseUpdate=u))}if(null!==i){var d=r.baseState;for(a=0,l=c=u=null,s=i;;){var p=s.lane,f=s.eventTime;if((o&p)===p){null!==l&&(l=l.next={eventTime:f,lane:0,tag:s.tag,payload:s.payload,callback:s.callback,next:null});e:{var h=e,g=s;switch(p=t,f=n,g.tag){case 1:if("function"===typeof(h=g.payload)){d=h.call(f,d,p);break e}d=h;break e;case 3:h.flags=-65537&h.flags|128;case 0:if(null===(p="function"===typeof(h=g.payload)?h.call(f,d,p):h)||void 0===p)break e;d=U({},d,p);break e;case 2:Ri=!0}}null!==s.callback&&0!==s.lane&&(e.flags|=64,null===(p=r.effects)?r.effects=[s]:p.push(s))}else f={eventTime:f,lane:p,tag:s.tag,payload:s.payload,callback:s.callback,next:null},null===l?(c=l=f,u=d):l=l.next=f,a|=p;if(null===(s=s.next)){if(null===(s=r.shared.pending))break;s=(p=s).next,p.next=null,r.lastBaseUpdate=p,r.shared.pending=null}}if(null===l&&(u=d),r.baseState=u,r.firstBaseUpdate=c,r.lastBaseUpdate=l,null!==(t=r.shared.interleaved)){r=t;do{a|=r.lane,r=r.next}while(r!==t)}else null===i&&(r.shared.lanes=0);Uu|=a,e.lanes=a,e.memoizedState=d}}function Fi(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var o=e[t],r=o.callback;if(null!==r){if(o.callback=null,o=n,"function"!==typeof r)throw Error(i(191,r));r.call(o)}}}var qi=(new o.Component).refs;function Bi(e,t,n,o){n=null===(n=n(o,t=e.memoizedState))||void 0===n?t:U({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var Vi={isMounted:function(e){return!!(e=e._reactInternals)&&Ve(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var o=tc(),r=nc(e),i=Ni(o,r);i.payload=t,void 0!==n&&null!==n&&(i.callback=n),null!==(t=Pi(e,i,r))&&(oc(t,e,r,o),Gi(t,e,r))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var o=tc(),r=nc(e),i=Ni(o,r);i.tag=1,i.payload=t,void 0!==n&&null!==n&&(i.callback=n),null!==(t=Pi(e,i,r))&&(oc(t,e,r,o),Gi(t,e,r))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=tc(),o=nc(e),r=Ni(n,o);r.tag=2,void 0!==t&&null!==t&&(r.callback=t),null!==(t=Pi(e,r,o))&&(oc(t,e,o,n),Gi(t,e,o))}};function Hi(e,t,n,o,r,i,a){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(o,i,a):!t.prototype||!t.prototype.isPureReactComponent||(!uo(n,o)||!uo(r,i))}function Ki(e,t,n){var o=!1,r=Er,i=t.contextType;return"object"===typeof i&&null!==i?i=bi(i):(r=Or(t)?Rr:Ar.current,i=(o=null!==(o=t.contextTypes)&&void 0!==o)?wr(e,r):Er),t=new t(n,i),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=Vi,e.stateNode=t,t._reactInternals=e,o&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=r,e.__reactInternalMemoizedMaskedChildContext=i),t}function ji(e,t,n,o){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,o),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,o),t.state!==e&&Vi.enqueueReplaceState(t,t.state,null)}function zi(e,t,n,o){var r=e.stateNode;r.props=n,r.state=e.memoizedState,r.refs=qi,wi(e);var i=t.contextType;"object"===typeof i&&null!==i?r.context=bi(i):(i=Or(t)?Rr:Ar.current,r.context=wr(e,i)),r.state=e.memoizedState,"function"===typeof(i=t.getDerivedStateFromProps)&&(Bi(e,t,i,n),r.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof r.getSnapshotBeforeUpdate||"function"!==typeof r.UNSAFE_componentWillMount&&"function"!==typeof r.componentWillMount||(t=r.state,"function"===typeof r.componentWillMount&&r.componentWillMount(),"function"===typeof r.UNSAFE_componentWillMount&&r.UNSAFE_componentWillMount(),t!==r.state&&Vi.enqueueReplaceState(r,r.state,null),xi(e,n,r,o),r.state=e.memoizedState),"function"===typeof r.componentDidMount&&(e.flags|=4194308)}function Zi(e,t,n){if(null!==(e=n.ref)&&"function"!==typeof e&&"object"!==typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(i(309));var o=n.stateNode}if(!o)throw Error(i(147,e));var r=o,a=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===a?t.ref:(t=function(e){var t=r.refs;t===qi&&(t=r.refs={}),null===e?delete t[a]:t[a]=e},t._stringRef=a,t)}if("string"!==typeof e)throw Error(i(284));if(!n._owner)throw Error(i(290,e))}return e}function Wi(e,t){throw e=Object.prototype.toString.call(t),Error(i(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Yi(e){return(0,e._init)(e._payload)}function Ji(e){function t(t,n){if(e){var o=t.deletions;null===o?(t.deletions=[n],t.flags|=16):o.push(n)}}function n(n,o){if(!e)return null;for(;null!==o;)t(n,o),o=o.sibling;return null}function o(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function r(e,t){return(e=Nc(e,t)).index=0,e.sibling=null,e}function a(t,n,o){return t.index=o,e?null!==(o=t.alternate)?(o=o.index)<n?(t.flags|=2,n):o:(t.flags|=2,n):(t.flags|=1048576,n)}function s(t){return e&&null===t.alternate&&(t.flags|=2),t}function u(e,t,n,o){return null===t||6!==t.tag?((t=xc(n,e.mode,o)).return=e,t):((t=r(t,n)).return=e,t)}function c(e,t,n,o){var i=n.type;return i===k?d(e,t,n.props.children,o,n.key):null!==t&&(t.elementType===i||"object"===typeof i&&null!==i&&i.$$typeof===w&&Yi(i)===t.type)?((o=r(t,n.props)).ref=Zi(e,t,n),o.return=e,o):((o=Pc(n.type,n.key,n.props,null,e.mode,o)).ref=Zi(e,t,n),o.return=e,o)}function l(e,t,n,o){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Fc(n,e.mode,o)).return=e,t):((t=r(t,n.children||[])).return=e,t)}function d(e,t,n,o,i){return null===t||7!==t.tag?((t=Gc(n,e.mode,o,i)).return=e,t):((t=r(t,n)).return=e,t)}function p(e,t,n){if("string"===typeof t&&""!==t||"number"===typeof t)return(t=xc(""+t,e.mode,n)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case I:return(n=Pc(t.type,t.key,t.props,null,e.mode,n)).ref=Zi(e,null,t),n.return=e,n;case C:return(t=Fc(t,e.mode,n)).return=e,t;case w:return p(e,(0,t._init)(t._payload),n)}if(te(t)||P(t))return(t=Gc(t,e.mode,n,null)).return=e,t;Wi(e,t)}return null}function f(e,t,n,o){var r=null!==t?t.key:null;if("string"===typeof n&&""!==n||"number"===typeof n)return null!==r?null:u(e,t,""+n,o);if("object"===typeof n&&null!==n){switch(n.$$typeof){case I:return n.key===r?c(e,t,n,o):null;case C:return n.key===r?l(e,t,n,o):null;case w:return f(e,t,(r=n._init)(n._payload),o)}if(te(n)||P(n))return null!==r?null:d(e,t,n,o,null);Wi(e,n)}return null}function h(e,t,n,o,r){if("string"===typeof o&&""!==o||"number"===typeof o)return u(t,e=e.get(n)||null,""+o,r);if("object"===typeof o&&null!==o){switch(o.$$typeof){case I:return c(t,e=e.get(null===o.key?n:o.key)||null,o,r);case C:return l(t,e=e.get(null===o.key?n:o.key)||null,o,r);case w:return h(e,t,n,(0,o._init)(o._payload),r)}if(te(o)||P(o))return d(t,e=e.get(n)||null,o,r,null);Wi(t,o)}return null}function g(r,i,s,u){for(var c=null,l=null,d=i,g=i=0,v=null;null!==d&&g<s.length;g++){d.index>g?(v=d,d=null):v=d.sibling;var m=f(r,d,s[g],u);if(null===m){null===d&&(d=v);break}e&&d&&null===m.alternate&&t(r,d),i=a(m,i,g),null===l?c=m:l.sibling=m,l=m,d=v}if(g===s.length)return n(r,d),ii&&Qr(r,g),c;if(null===d){for(;g<s.length;g++)null!==(d=p(r,s[g],u))&&(i=a(d,i,g),null===l?c=d:l.sibling=d,l=d);return ii&&Qr(r,g),c}for(d=o(r,d);g<s.length;g++)null!==(v=h(d,r,g,s[g],u))&&(e&&null!==v.alternate&&d.delete(null===v.key?g:v.key),i=a(v,i,g),null===l?c=v:l.sibling=v,l=v);return e&&d.forEach((function(e){return t(r,e)})),ii&&Qr(r,g),c}function v(r,s,u,c){var l=P(u);if("function"!==typeof l)throw Error(i(150));if(null==(u=l.call(u)))throw Error(i(151));for(var d=l=null,g=s,v=s=0,m=null,_=u.next();null!==g&&!_.done;v++,_=u.next()){g.index>v?(m=g,g=null):m=g.sibling;var y=f(r,g,_.value,c);if(null===y){null===g&&(g=m);break}e&&g&&null===y.alternate&&t(r,g),s=a(y,s,v),null===d?l=y:d.sibling=y,d=y,g=m}if(_.done)return n(r,g),ii&&Qr(r,v),l;if(null===g){for(;!_.done;v++,_=u.next())null!==(_=p(r,_.value,c))&&(s=a(_,s,v),null===d?l=_:d.sibling=_,d=_);return ii&&Qr(r,v),l}for(g=o(r,g);!_.done;v++,_=u.next())null!==(_=h(g,r,v,_.value,c))&&(e&&null!==_.alternate&&g.delete(null===_.key?v:_.key),s=a(_,s,v),null===d?l=_:d.sibling=_,d=_);return e&&g.forEach((function(e){return t(r,e)})),ii&&Qr(r,v),l}return function e(o,i,a,u){if("object"===typeof a&&null!==a&&a.type===k&&null===a.key&&(a=a.props.children),"object"===typeof a&&null!==a){switch(a.$$typeof){case I:e:{for(var c=a.key,l=i;null!==l;){if(l.key===c){if((c=a.type)===k){if(7===l.tag){n(o,l.sibling),(i=r(l,a.props.children)).return=o,o=i;break e}}else if(l.elementType===c||"object"===typeof c&&null!==c&&c.$$typeof===w&&Yi(c)===l.type){n(o,l.sibling),(i=r(l,a.props)).ref=Zi(o,l,a),i.return=o,o=i;break e}n(o,l);break}t(o,l),l=l.sibling}a.type===k?((i=Gc(a.props.children,o.mode,u,a.key)).return=o,o=i):((u=Pc(a.type,a.key,a.props,null,o.mode,u)).ref=Zi(o,i,a),u.return=o,o=u)}return s(o);case C:e:{for(l=a.key;null!==i;){if(i.key===l){if(4===i.tag&&i.stateNode.containerInfo===a.containerInfo&&i.stateNode.implementation===a.implementation){n(o,i.sibling),(i=r(i,a.children||[])).return=o,o=i;break e}n(o,i);break}t(o,i),i=i.sibling}(i=Fc(a,o.mode,u)).return=o,o=i}return s(o);case w:return e(o,i,(l=a._init)(a._payload),u)}if(te(a))return g(o,i,a,u);if(P(a))return v(o,i,a,u);Wi(o,a)}return"string"===typeof a&&""!==a||"number"===typeof a?(a=""+a,null!==i&&6===i.tag?(n(o,i.sibling),(i=r(i,a)).return=o,o=i):(n(o,i),(i=xc(a,o.mode,u)).return=o,o=i),s(o)):n(o,i)}}var Xi=Ji(!0),$i=Ji(!1),Qi={},ea=Sr(Qi),ta=Sr(Qi),na=Sr(Qi);function oa(e){if(e===Qi)throw Error(i(174));return e}function ra(e,t){switch(Dr(na,t),Dr(ta,e),Dr(ea,Qi),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:ue(null,"");break;default:t=ue(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}br(ea),Dr(ea,t)}function ia(){br(ea),br(ta),br(na)}function aa(e){oa(na.current);var t=oa(ea.current),n=ue(t,e.type);t!==n&&(Dr(ta,e),Dr(ea,n))}function sa(e){ta.current===e&&(br(ea),br(ta))}var ua=Sr(0);function ca(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var la=[];function da(){for(var e=0;e<la.length;e++)la[e]._workInProgressVersionPrimary=null;la.length=0}var pa=M.ReactCurrentDispatcher,fa=M.ReactCurrentBatchConfig,ha=0,ga=null,va=null,ma=null,_a=!1,ya=!1,Ma=0,Ia=0;function Ca(){throw Error(i(321))}function ka(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!so(e[n],t[n]))return!1;return!0}function Ta(e,t,n,o,r,a){if(ha=a,ga=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,pa.current=null===e||null===e.memoizedState?ss:us,e=n(o,r),ya){a=0;do{if(ya=!1,Ma=0,25<=a)throw Error(i(301));a+=1,ma=va=null,t.updateQueue=null,pa.current=cs,e=n(o,r)}while(ya)}if(pa.current=as,t=null!==va&&null!==va.next,ha=0,ma=va=ga=null,_a=!1,t)throw Error(i(300));return e}function Sa(){var e=0!==Ma;return Ma=0,e}function ba(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===ma?ga.memoizedState=ma=e:ma=ma.next=e,ma}function Da(){if(null===va){var e=ga.alternate;e=null!==e?e.memoizedState:null}else e=va.next;var t=null===ma?ga.memoizedState:ma.next;if(null!==t)ma=t,va=e;else{if(null===e)throw Error(i(310));e={memoizedState:(va=e).memoizedState,baseState:va.baseState,baseQueue:va.baseQueue,queue:va.queue,next:null},null===ma?ga.memoizedState=ma=e:ma=ma.next=e}return ma}function Ea(e,t){return"function"===typeof t?t(e):t}function Aa(e){var t=Da(),n=t.queue;if(null===n)throw Error(i(311));n.lastRenderedReducer=e;var o=va,r=o.baseQueue,a=n.pending;if(null!==a){if(null!==r){var s=r.next;r.next=a.next,a.next=s}o.baseQueue=r=a,n.pending=null}if(null!==r){a=r.next,o=o.baseState;var u=s=null,c=null,l=a;do{var d=l.lane;if((ha&d)===d)null!==c&&(c=c.next={lane:0,action:l.action,hasEagerState:l.hasEagerState,eagerState:l.eagerState,next:null}),o=l.hasEagerState?l.eagerState:e(o,l.action);else{var p={lane:d,action:l.action,hasEagerState:l.hasEagerState,eagerState:l.eagerState,next:null};null===c?(u=c=p,s=o):c=c.next=p,ga.lanes|=d,Uu|=d}l=l.next}while(null!==l&&l!==a);null===c?s=o:c.next=u,so(o,t.memoizedState)||(Ms=!0),t.memoizedState=o,t.baseState=s,t.baseQueue=c,n.lastRenderedState=o}if(null!==(e=n.interleaved)){r=e;do{a=r.lane,ga.lanes|=a,Uu|=a,r=r.next}while(r!==e)}else null===r&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function La(e){var t=Da(),n=t.queue;if(null===n)throw Error(i(311));n.lastRenderedReducer=e;var o=n.dispatch,r=n.pending,a=t.memoizedState;if(null!==r){n.pending=null;var s=r=r.next;do{a=e(a,s.action),s=s.next}while(s!==r);so(a,t.memoizedState)||(Ms=!0),t.memoizedState=a,null===t.baseQueue&&(t.baseState=a),n.lastRenderedState=a}return[a,o]}function Ra(){}function wa(e,t){var n=ga,o=Da(),r=t(),a=!so(o.memoizedState,r);if(a&&(o.memoizedState=r,Ms=!0),o=o.queue,Ka(Pa.bind(null,n,o,e),[e]),o.getSnapshot!==t||a||null!==ma&&1&ma.memoizedState.tag){if(n.flags|=2048,Fa(9,Na.bind(null,n,o,r,t),void 0,null),null===Lu)throw Error(i(349));0!==(30&ha)||Oa(n,t,r)}return r}function Oa(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=ga.updateQueue)?(t={lastEffect:null,stores:null},ga.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function Na(e,t,n,o){t.value=n,t.getSnapshot=o,Ga(t)&&Ua(e)}function Pa(e,t,n){return n((function(){Ga(t)&&Ua(e)}))}function Ga(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!so(e,n)}catch(o){return!0}}function Ua(e){var t=Li(e,1);null!==t&&oc(t,e,1,-1)}function xa(e){var t=ba();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Ea,lastRenderedState:e},t.queue=e,e=e.dispatch=ns.bind(null,ga,e),[t.memoizedState,e]}function Fa(e,t,n,o){return e={tag:e,create:t,destroy:n,deps:o,next:null},null===(t=ga.updateQueue)?(t={lastEffect:null,stores:null},ga.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(o=n.next,n.next=e,e.next=o,t.lastEffect=e),e}function qa(){return Da().memoizedState}function Ba(e,t,n,o){var r=ba();ga.flags|=e,r.memoizedState=Fa(1|t,n,void 0,void 0===o?null:o)}function Va(e,t,n,o){var r=Da();o=void 0===o?null:o;var i=void 0;if(null!==va){var a=va.memoizedState;if(i=a.destroy,null!==o&&ka(o,a.deps))return void(r.memoizedState=Fa(t,n,i,o))}ga.flags|=e,r.memoizedState=Fa(1|t,n,i,o)}function Ha(e,t){return Ba(8390656,8,e,t)}function Ka(e,t){return Va(2048,8,e,t)}function ja(e,t){return Va(4,2,e,t)}function za(e,t){return Va(4,4,e,t)}function Za(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function Wa(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Va(4,4,Za.bind(null,t,e),n)}function Ya(){}function Ja(e,t){var n=Da();t=void 0===t?null:t;var o=n.memoizedState;return null!==o&&null!==t&&ka(t,o[1])?o[0]:(n.memoizedState=[e,t],e)}function Xa(e,t){var n=Da();t=void 0===t?null:t;var o=n.memoizedState;return null!==o&&null!==t&&ka(t,o[1])?o[0]:(e=e(),n.memoizedState=[e,t],e)}function $a(e,t,n){return 0===(21&ha)?(e.baseState&&(e.baseState=!1,Ms=!0),e.memoizedState=n):(so(n,t)||(n=gt(),ga.lanes|=n,Uu|=n,e.baseState=!0),t)}function Qa(e,t){var n=yt;yt=0!==n&&4>n?n:4,e(!0);var o=fa.transition;fa.transition={};try{e(!1),t()}finally{yt=n,fa.transition=o}}function es(){return Da().memoizedState}function ts(e,t,n){var o=nc(e);if(n={lane:o,action:n,hasEagerState:!1,eagerState:null,next:null},os(e))rs(t,n);else if(null!==(n=Ai(e,t,n,o))){oc(n,e,o,tc()),is(n,t,o)}}function ns(e,t,n){var o=nc(e),r={lane:o,action:n,hasEagerState:!1,eagerState:null,next:null};if(os(e))rs(t,r);else{var i=e.alternate;if(0===e.lanes&&(null===i||0===i.lanes)&&null!==(i=t.lastRenderedReducer))try{var a=t.lastRenderedState,s=i(a,n);if(r.hasEagerState=!0,r.eagerState=s,so(s,a)){var u=t.interleaved;return null===u?(r.next=r,Ei(t)):(r.next=u.next,u.next=r),void(t.interleaved=r)}}catch(c){}null!==(n=Ai(e,t,r,o))&&(oc(n,e,o,r=tc()),is(n,t,o))}}function os(e){var t=e.alternate;return e===ga||null!==t&&t===ga}function rs(e,t){ya=_a=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function is(e,t,n){if(0!==(4194240&n)){var o=t.lanes;n|=o&=e.pendingLanes,t.lanes=n,_t(e,n)}}var as={readContext:bi,useCallback:Ca,useContext:Ca,useEffect:Ca,useImperativeHandle:Ca,useInsertionEffect:Ca,useLayoutEffect:Ca,useMemo:Ca,useReducer:Ca,useRef:Ca,useState:Ca,useDebugValue:Ca,useDeferredValue:Ca,useTransition:Ca,useMutableSource:Ca,useSyncExternalStore:Ca,useId:Ca,unstable_isNewReconciler:!1},ss={readContext:bi,useCallback:function(e,t){return ba().memoizedState=[e,void 0===t?null:t],e},useContext:bi,useEffect:Ha,useImperativeHandle:function(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Ba(4194308,4,Za.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Ba(4194308,4,e,t)},useInsertionEffect:function(e,t){return Ba(4,2,e,t)},useMemo:function(e,t){var n=ba();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var o=ba();return t=void 0!==n?n(t):t,o.memoizedState=o.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},o.queue=e,e=e.dispatch=ts.bind(null,ga,e),[o.memoizedState,e]},useRef:function(e){return e={current:e},ba().memoizedState=e},useState:xa,useDebugValue:Ya,useDeferredValue:function(e){return ba().memoizedState=e},useTransition:function(){var e=xa(!1),t=e[0];return e=Qa.bind(null,e[1]),ba().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var o=ga,r=ba();if(ii){if(void 0===n)throw Error(i(407));n=n()}else{if(n=t(),null===Lu)throw Error(i(349));0!==(30&ha)||Oa(o,t,n)}r.memoizedState=n;var a={value:n,getSnapshot:t};return r.queue=a,Ha(Pa.bind(null,o,a,e),[e]),o.flags|=2048,Fa(9,Na.bind(null,o,a,n,t),void 0,null),n},useId:function(){var e=ba(),t=Lu.identifierPrefix;if(ii){var n=$r;t=":"+t+"R"+(n=(Xr&~(1<<32-at(Xr)-1)).toString(32)+n),0<(n=Ma++)&&(t+="H"+n.toString(32)),t+=":"}else t=":"+t+"r"+(n=Ia++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},us={readContext:bi,useCallback:Ja,useContext:bi,useEffect:Ka,useImperativeHandle:Wa,useInsertionEffect:ja,useLayoutEffect:za,useMemo:Xa,useReducer:Aa,useRef:qa,useState:function(){return Aa(Ea)},useDebugValue:Ya,useDeferredValue:function(e){return $a(Da(),va.memoizedState,e)},useTransition:function(){return[Aa(Ea)[0],Da().memoizedState]},useMutableSource:Ra,useSyncExternalStore:wa,useId:es,unstable_isNewReconciler:!1},cs={readContext:bi,useCallback:Ja,useContext:bi,useEffect:Ka,useImperativeHandle:Wa,useInsertionEffect:ja,useLayoutEffect:za,useMemo:Xa,useReducer:La,useRef:qa,useState:function(){return La(Ea)},useDebugValue:Ya,useDeferredValue:function(e){var t=Da();return null===va?t.memoizedState=e:$a(t,va.memoizedState,e)},useTransition:function(){return[La(Ea)[0],Da().memoizedState]},useMutableSource:Ra,useSyncExternalStore:wa,useId:es,unstable_isNewReconciler:!1};function ls(e,t){try{var n="",o=t;do{n+=B(o),o=o.return}while(o);var r=n}catch(i){r="\nError generating stack: "+i.message+"\n"+i.stack}return{value:e,source:t,stack:r,digest:null}}function ds(e,t,n){return{value:e,source:null,stack:null!=n?n:null,digest:null!=t?t:null}}function ps(e,t){try{console.error(t.value)}catch(n){setTimeout((function(){throw n}))}}var fs="function"===typeof WeakMap?WeakMap:Map;function hs(e,t,n){(n=Ni(-1,n)).tag=3,n.payload={element:null};var o=t.value;return n.callback=function(){ju||(ju=!0,zu=o),ps(0,t)},n}function gs(e,t,n){(n=Ni(-1,n)).tag=3;var o=e.type.getDerivedStateFromError;if("function"===typeof o){var r=t.value;n.payload=function(){return o(r)},n.callback=function(){ps(0,t)}}var i=e.stateNode;return null!==i&&"function"===typeof i.componentDidCatch&&(n.callback=function(){ps(0,t),"function"!==typeof o&&(null===Zu?Zu=new Set([this]):Zu.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),n}function vs(e,t,n){var o=e.pingCache;if(null===o){o=e.pingCache=new fs;var r=new Set;o.set(t,r)}else void 0===(r=o.get(t))&&(r=new Set,o.set(t,r));r.has(n)||(r.add(n),e=bc.bind(null,e,t,n),t.then(e,e))}function ms(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function _s(e,t,n,o,r){return 0===(1&e.mode)?(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,1===n.tag&&(null===n.alternate?n.tag=17:((t=Ni(-1,1)).tag=2,Pi(n,t,1))),n.lanes|=1),e):(e.flags|=65536,e.lanes=r,e)}var ys=M.ReactCurrentOwner,Ms=!1;function Is(e,t,n,o){t.child=null===e?$i(t,null,n,o):Xi(t,e.child,n,o)}function Cs(e,t,n,o,r){n=n.render;var i=t.ref;return Si(t,r),o=Ta(e,t,n,o,i,r),n=Sa(),null===e||Ms?(ii&&n&&ti(t),t.flags|=1,Is(e,t,o,r),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~r,js(e,t,r))}function ks(e,t,n,o,r){if(null===e){var i=n.type;return"function"!==typeof i||Oc(i)||void 0!==i.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=Pc(n.type,null,o,t,t.mode,r)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=i,Ts(e,t,i,o,r))}if(i=e.child,0===(e.lanes&r)){var a=i.memoizedProps;if((n=null!==(n=n.compare)?n:uo)(a,o)&&e.ref===t.ref)return js(e,t,r)}return t.flags|=1,(e=Nc(i,o)).ref=t.ref,e.return=t,t.child=e}function Ts(e,t,n,o,r){if(null!==e){var i=e.memoizedProps;if(uo(i,o)&&e.ref===t.ref){if(Ms=!1,t.pendingProps=o=i,0===(e.lanes&r))return t.lanes=e.lanes,js(e,t,r);0!==(131072&e.flags)&&(Ms=!0)}}return Ds(e,t,n,o,r)}function Ss(e,t,n){var o=t.pendingProps,r=o.children,i=null!==e?e.memoizedState:null;if("hidden"===o.mode)if(0===(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Dr(Nu,Ou),Ou|=n;else{if(0===(1073741824&n))return e=null!==i?i.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Dr(Nu,Ou),Ou|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},o=null!==i?i.baseLanes:n,Dr(Nu,Ou),Ou|=o}else null!==i?(o=i.baseLanes|n,t.memoizedState=null):o=n,Dr(Nu,Ou),Ou|=o;return Is(e,t,r,n),t.child}function bs(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function Ds(e,t,n,o,r){var i=Or(n)?Rr:Ar.current;return i=wr(t,i),Si(t,r),n=Ta(e,t,n,o,i,r),o=Sa(),null===e||Ms?(ii&&o&&ti(t),t.flags|=1,Is(e,t,n,r),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~r,js(e,t,r))}function Es(e,t,n,o,r){if(Or(n)){var i=!0;Ur(t)}else i=!1;if(Si(t,r),null===t.stateNode)Ks(e,t),Ki(t,n,o),zi(t,n,o,r),o=!0;else if(null===e){var a=t.stateNode,s=t.memoizedProps;a.props=s;var u=a.context,c=n.contextType;"object"===typeof c&&null!==c?c=bi(c):c=wr(t,c=Or(n)?Rr:Ar.current);var l=n.getDerivedStateFromProps,d="function"===typeof l||"function"===typeof a.getSnapshotBeforeUpdate;d||"function"!==typeof a.UNSAFE_componentWillReceiveProps&&"function"!==typeof a.componentWillReceiveProps||(s!==o||u!==c)&&ji(t,a,o,c),Ri=!1;var p=t.memoizedState;a.state=p,xi(t,o,a,r),u=t.memoizedState,s!==o||p!==u||Lr.current||Ri?("function"===typeof l&&(Bi(t,n,l,o),u=t.memoizedState),(s=Ri||Hi(t,n,s,o,p,u,c))?(d||"function"!==typeof a.UNSAFE_componentWillMount&&"function"!==typeof a.componentWillMount||("function"===typeof a.componentWillMount&&a.componentWillMount(),"function"===typeof a.UNSAFE_componentWillMount&&a.UNSAFE_componentWillMount()),"function"===typeof a.componentDidMount&&(t.flags|=4194308)):("function"===typeof a.componentDidMount&&(t.flags|=4194308),t.memoizedProps=o,t.memoizedState=u),a.props=o,a.state=u,a.context=c,o=s):("function"===typeof a.componentDidMount&&(t.flags|=4194308),o=!1)}else{a=t.stateNode,Oi(e,t),s=t.memoizedProps,c=t.type===t.elementType?s:mi(t.type,s),a.props=c,d=t.pendingProps,p=a.context,"object"===typeof(u=n.contextType)&&null!==u?u=bi(u):u=wr(t,u=Or(n)?Rr:Ar.current);var f=n.getDerivedStateFromProps;(l="function"===typeof f||"function"===typeof a.getSnapshotBeforeUpdate)||"function"!==typeof a.UNSAFE_componentWillReceiveProps&&"function"!==typeof a.componentWillReceiveProps||(s!==d||p!==u)&&ji(t,a,o,u),Ri=!1,p=t.memoizedState,a.state=p,xi(t,o,a,r);var h=t.memoizedState;s!==d||p!==h||Lr.current||Ri?("function"===typeof f&&(Bi(t,n,f,o),h=t.memoizedState),(c=Ri||Hi(t,n,c,o,p,h,u)||!1)?(l||"function"!==typeof a.UNSAFE_componentWillUpdate&&"function"!==typeof a.componentWillUpdate||("function"===typeof a.componentWillUpdate&&a.componentWillUpdate(o,h,u),"function"===typeof a.UNSAFE_componentWillUpdate&&a.UNSAFE_componentWillUpdate(o,h,u)),"function"===typeof a.componentDidUpdate&&(t.flags|=4),"function"===typeof a.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof a.componentDidUpdate||s===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),"function"!==typeof a.getSnapshotBeforeUpdate||s===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),t.memoizedProps=o,t.memoizedState=h),a.props=o,a.state=h,a.context=u,o=c):("function"!==typeof a.componentDidUpdate||s===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),"function"!==typeof a.getSnapshotBeforeUpdate||s===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),o=!1)}return As(e,t,n,o,i,r)}function As(e,t,n,o,r,i){bs(e,t);var a=0!==(128&t.flags);if(!o&&!a)return r&&xr(t,n,!1),js(e,t,i);o=t.stateNode,ys.current=t;var s=a&&"function"!==typeof n.getDerivedStateFromError?null:o.render();return t.flags|=1,null!==e&&a?(t.child=Xi(t,e.child,null,i),t.child=Xi(t,null,s,i)):Is(e,t,s,i),t.memoizedState=o.state,r&&xr(t,n,!0),t.child}function Ls(e){var t=e.stateNode;t.pendingContext?Pr(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Pr(0,t.context,!1),ra(e,t.containerInfo)}function Rs(e,t,n,o,r){return hi(),gi(r),t.flags|=256,Is(e,t,n,o),t.child}var ws,Os,Ns,Ps,Gs={dehydrated:null,treeContext:null,retryLane:0};function Us(e){return{baseLanes:e,cachePool:null,transitions:null}}function xs(e,t,n){var o,r=t.pendingProps,a=ua.current,s=!1,u=0!==(128&t.flags);if((o=u)||(o=(null===e||null!==e.memoizedState)&&0!==(2&a)),o?(s=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(a|=1),Dr(ua,1&a),null===e)return li(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0===(1&t.mode)?t.lanes=1:"$!"===e.data?t.lanes=8:t.lanes=1073741824,null):(u=r.children,e=r.fallback,s?(r=t.mode,s=t.child,u={mode:"hidden",children:u},0===(1&r)&&null!==s?(s.childLanes=0,s.pendingProps=u):s=Uc(u,r,0,null),e=Gc(e,r,n,null),s.return=t,e.return=t,s.sibling=e,t.child=s,t.child.memoizedState=Us(n),t.memoizedState=Gs,e):Fs(t,u));if(null!==(a=e.memoizedState)&&null!==(o=a.dehydrated))return function(e,t,n,o,r,a,s){if(n)return 256&t.flags?(t.flags&=-257,qs(e,t,s,o=ds(Error(i(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(a=o.fallback,r=t.mode,o=Uc({mode:"visible",children:o.children},r,0,null),(a=Gc(a,r,s,null)).flags|=2,o.return=t,a.return=t,o.sibling=a,t.child=o,0!==(1&t.mode)&&Xi(t,e.child,null,s),t.child.memoizedState=Us(s),t.memoizedState=Gs,a);if(0===(1&t.mode))return qs(e,t,s,null);if("$!"===r.data){if(o=r.nextSibling&&r.nextSibling.dataset)var u=o.dgst;return o=u,qs(e,t,s,o=ds(a=Error(i(419)),o,void 0))}if(u=0!==(s&e.childLanes),Ms||u){if(null!==(o=Lu)){switch(s&-s){case 4:r=2;break;case 16:r=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:r=32;break;case 536870912:r=268435456;break;default:r=0}0!==(r=0!==(r&(o.suspendedLanes|s))?0:r)&&r!==a.retryLane&&(a.retryLane=r,Li(e,r),oc(o,e,r,-1))}return vc(),qs(e,t,s,o=ds(Error(i(421))))}return"$?"===r.data?(t.flags|=128,t.child=e.child,t=Ec.bind(null,e),r._reactRetry=t,null):(e=a.treeContext,ri=lr(r.nextSibling),oi=t,ii=!0,ai=null,null!==e&&(Wr[Yr++]=Xr,Wr[Yr++]=$r,Wr[Yr++]=Jr,Xr=e.id,$r=e.overflow,Jr=t),t=Fs(t,o.children),t.flags|=4096,t)}(e,t,u,r,o,a,n);if(s){s=r.fallback,u=t.mode,o=(a=e.child).sibling;var c={mode:"hidden",children:r.children};return 0===(1&u)&&t.child!==a?((r=t.child).childLanes=0,r.pendingProps=c,t.deletions=null):(r=Nc(a,c)).subtreeFlags=14680064&a.subtreeFlags,null!==o?s=Nc(o,s):(s=Gc(s,u,n,null)).flags|=2,s.return=t,r.return=t,r.sibling=s,t.child=r,r=s,s=t.child,u=null===(u=e.child.memoizedState)?Us(n):{baseLanes:u.baseLanes|n,cachePool:null,transitions:u.transitions},s.memoizedState=u,s.childLanes=e.childLanes&~n,t.memoizedState=Gs,r}return e=(s=e.child).sibling,r=Nc(s,{mode:"visible",children:r.children}),0===(1&t.mode)&&(r.lanes=n),r.return=t,r.sibling=null,null!==e&&(null===(n=t.deletions)?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=r,t.memoizedState=null,r}function Fs(e,t){return(t=Uc({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function qs(e,t,n,o){return null!==o&&gi(o),Xi(t,e.child,null,n),(e=Fs(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function Bs(e,t,n){e.lanes|=t;var o=e.alternate;null!==o&&(o.lanes|=t),Ti(e.return,t,n)}function Vs(e,t,n,o,r){var i=e.memoizedState;null===i?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:o,tail:n,tailMode:r}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=o,i.tail=n,i.tailMode=r)}function Hs(e,t,n){var o=t.pendingProps,r=o.revealOrder,i=o.tail;if(Is(e,t,o.children,n),0!==(2&(o=ua.current)))o=1&o|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&Bs(e,n,t);else if(19===e.tag)Bs(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}o&=1}if(Dr(ua,o),0===(1&t.mode))t.memoizedState=null;else switch(r){case"forwards":for(n=t.child,r=null;null!==n;)null!==(e=n.alternate)&&null===ca(e)&&(r=n),n=n.sibling;null===(n=r)?(r=t.child,t.child=null):(r=n.sibling,n.sibling=null),Vs(t,!1,r,n,i);break;case"backwards":for(n=null,r=t.child,t.child=null;null!==r;){if(null!==(e=r.alternate)&&null===ca(e)){t.child=r;break}e=r.sibling,r.sibling=n,n=r,r=e}Vs(t,!0,n,null,i);break;case"together":Vs(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Ks(e,t){0===(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function js(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),Uu|=t.lanes,0===(n&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(i(153));if(null!==t.child){for(n=Nc(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Nc(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function zs(e,t){if(!ii)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var o=null;null!==n;)null!==n.alternate&&(o=n),n=n.sibling;null===o?t||null===e.tail?e.tail=null:e.tail.sibling=null:o.sibling=null}}function Zs(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,o=0;if(t)for(var r=e.child;null!==r;)n|=r.lanes|r.childLanes,o|=14680064&r.subtreeFlags,o|=14680064&r.flags,r.return=e,r=r.sibling;else for(r=e.child;null!==r;)n|=r.lanes|r.childLanes,o|=r.subtreeFlags,o|=r.flags,r.return=e,r=r.sibling;return e.subtreeFlags|=o,e.childLanes=n,t}function Ws(e,t,n){var o=t.pendingProps;switch(ni(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Zs(t),null;case 1:case 17:return Or(t.type)&&Nr(),Zs(t),null;case 3:return o=t.stateNode,ia(),br(Lr),br(Ar),da(),o.pendingContext&&(o.context=o.pendingContext,o.pendingContext=null),null!==e&&null!==e.child||(pi(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,null!==ai&&(sc(ai),ai=null))),Os(e,t),Zs(t),null;case 5:sa(t);var r=oa(na.current);if(n=t.type,null!==e&&null!=t.stateNode)Ns(e,t,n,o,r),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!o){if(null===t.stateNode)throw Error(i(166));return Zs(t),null}if(e=oa(ea.current),pi(t)){o=t.stateNode,n=t.type;var a=t.memoizedProps;switch(o[fr]=t,o[hr]=a,e=0!==(1&t.mode),n){case"dialog":qo("cancel",o),qo("close",o);break;case"iframe":case"object":case"embed":qo("load",o);break;case"video":case"audio":for(r=0;r<Go.length;r++)qo(Go[r],o);break;case"source":qo("error",o);break;case"img":case"image":case"link":qo("error",o),qo("load",o);break;case"details":qo("toggle",o);break;case"input":J(o,a),qo("invalid",o);break;case"select":o._wrapperState={wasMultiple:!!a.multiple},qo("invalid",o);break;case"textarea":re(o,a),qo("invalid",o)}for(var u in _e(n,a),r=null,a)if(a.hasOwnProperty(u)){var c=a[u];"children"===u?"string"===typeof c?o.textContent!==c&&(!0!==a.suppressHydrationWarning&&Qo(o.textContent,c,e),r=["children",c]):"number"===typeof c&&o.textContent!==""+c&&(!0!==a.suppressHydrationWarning&&Qo(o.textContent,c,e),r=["children",""+c]):s.hasOwnProperty(u)&&null!=c&&"onScroll"===u&&qo("scroll",o)}switch(n){case"input":z(o),Q(o,a,!0);break;case"textarea":z(o),ae(o);break;case"select":case"option":break;default:"function"===typeof a.onClick&&(o.onclick=er)}o=r,t.updateQueue=o,null!==o&&(t.flags|=4)}else{u=9===r.nodeType?r:r.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=se(n)),"http://www.w3.org/1999/xhtml"===e?"script"===n?((e=u.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"===typeof o.is?e=u.createElement(n,{is:o.is}):(e=u.createElement(n),"select"===n&&(u=e,o.multiple?u.multiple=!0:o.size&&(u.size=o.size))):e=u.createElementNS(e,n),e[fr]=t,e[hr]=o,ws(e,t,!1,!1),t.stateNode=e;e:{switch(u=ye(n,o),n){case"dialog":qo("cancel",e),qo("close",e),r=o;break;case"iframe":case"object":case"embed":qo("load",e),r=o;break;case"video":case"audio":for(r=0;r<Go.length;r++)qo(Go[r],e);r=o;break;case"source":qo("error",e),r=o;break;case"img":case"image":case"link":qo("error",e),qo("load",e),r=o;break;case"details":qo("toggle",e),r=o;break;case"input":J(e,o),r=Y(e,o),qo("invalid",e);break;case"option":default:r=o;break;case"select":e._wrapperState={wasMultiple:!!o.multiple},r=U({},o,{value:void 0}),qo("invalid",e);break;case"textarea":re(e,o),r=oe(e,o),qo("invalid",e)}for(a in _e(n,r),c=r)if(c.hasOwnProperty(a)){var l=c[a];"style"===a?ve(e,l):"dangerouslySetInnerHTML"===a?null!=(l=l?l.__html:void 0)&&de(e,l):"children"===a?"string"===typeof l?("textarea"!==n||""!==l)&&pe(e,l):"number"===typeof l&&pe(e,""+l):"suppressContentEditableWarning"!==a&&"suppressHydrationWarning"!==a&&"autoFocus"!==a&&(s.hasOwnProperty(a)?null!=l&&"onScroll"===a&&qo("scroll",e):null!=l&&y(e,a,l,u))}switch(n){case"input":z(e),Q(e,o,!1);break;case"textarea":z(e),ae(e);break;case"option":null!=o.value&&e.setAttribute("value",""+K(o.value));break;case"select":e.multiple=!!o.multiple,null!=(a=o.value)?ne(e,!!o.multiple,a,!1):null!=o.defaultValue&&ne(e,!!o.multiple,o.defaultValue,!0);break;default:"function"===typeof r.onClick&&(e.onclick=er)}switch(n){case"button":case"input":case"select":case"textarea":o=!!o.autoFocus;break e;case"img":o=!0;break e;default:o=!1}}o&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return Zs(t),null;case 6:if(e&&null!=t.stateNode)Ps(e,t,e.memoizedProps,o);else{if("string"!==typeof o&&null===t.stateNode)throw Error(i(166));if(n=oa(na.current),oa(ea.current),pi(t)){if(o=t.stateNode,n=t.memoizedProps,o[fr]=t,(a=o.nodeValue!==n)&&null!==(e=oi))switch(e.tag){case 3:Qo(o.nodeValue,n,0!==(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&Qo(o.nodeValue,n,0!==(1&e.mode))}a&&(t.flags|=4)}else(o=(9===n.nodeType?n:n.ownerDocument).createTextNode(o))[fr]=t,t.stateNode=o}return Zs(t),null;case 13:if(br(ua),o=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(ii&&null!==ri&&0!==(1&t.mode)&&0===(128&t.flags))fi(),hi(),t.flags|=98560,a=!1;else if(a=pi(t),null!==o&&null!==o.dehydrated){if(null===e){if(!a)throw Error(i(318));if(!(a=null!==(a=t.memoizedState)?a.dehydrated:null))throw Error(i(317));a[fr]=t}else hi(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;Zs(t),a=!1}else null!==ai&&(sc(ai),ai=null),a=!0;if(!a)return 65536&t.flags?t:null}return 0!==(128&t.flags)?(t.lanes=n,t):((o=null!==o)!==(null!==e&&null!==e.memoizedState)&&o&&(t.child.flags|=8192,0!==(1&t.mode)&&(null===e||0!==(1&ua.current)?0===Pu&&(Pu=3):vc())),null!==t.updateQueue&&(t.flags|=4),Zs(t),null);case 4:return ia(),Os(e,t),null===e&&Ho(t.stateNode.containerInfo),Zs(t),null;case 10:return ki(t.type._context),Zs(t),null;case 19:if(br(ua),null===(a=t.memoizedState))return Zs(t),null;if(o=0!==(128&t.flags),null===(u=a.rendering))if(o)zs(a,!1);else{if(0!==Pu||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(u=ca(e))){for(t.flags|=128,zs(a,!1),null!==(o=u.updateQueue)&&(t.updateQueue=o,t.flags|=4),t.subtreeFlags=0,o=n,n=t.child;null!==n;)e=o,(a=n).flags&=14680066,null===(u=a.alternate)?(a.childLanes=0,a.lanes=e,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=u.childLanes,a.lanes=u.lanes,a.child=u.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=u.memoizedProps,a.memoizedState=u.memoizedState,a.updateQueue=u.updateQueue,a.type=u.type,e=u.dependencies,a.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Dr(ua,1&ua.current|2),t.child}e=e.sibling}null!==a.tail&&Xe()>Hu&&(t.flags|=128,o=!0,zs(a,!1),t.lanes=4194304)}else{if(!o)if(null!==(e=ca(u))){if(t.flags|=128,o=!0,null!==(n=e.updateQueue)&&(t.updateQueue=n,t.flags|=4),zs(a,!0),null===a.tail&&"hidden"===a.tailMode&&!u.alternate&&!ii)return Zs(t),null}else 2*Xe()-a.renderingStartTime>Hu&&1073741824!==n&&(t.flags|=128,o=!0,zs(a,!1),t.lanes=4194304);a.isBackwards?(u.sibling=t.child,t.child=u):(null!==(n=a.last)?n.sibling=u:t.child=u,a.last=u)}return null!==a.tail?(t=a.tail,a.rendering=t,a.tail=t.sibling,a.renderingStartTime=Xe(),t.sibling=null,n=ua.current,Dr(ua,o?1&n|2:1&n),t):(Zs(t),null);case 22:case 23:return pc(),o=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==o&&(t.flags|=8192),o&&0!==(1&t.mode)?0!==(1073741824&Ou)&&(Zs(t),6&t.subtreeFlags&&(t.flags|=8192)):Zs(t),null;case 24:case 25:return null}throw Error(i(156,t.tag))}function Ys(e,t){switch(ni(t),t.tag){case 1:return Or(t.type)&&Nr(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return ia(),br(Lr),br(Ar),da(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 5:return sa(t),null;case 13:if(br(ua),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(i(340));hi()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return br(ua),null;case 4:return ia(),null;case 10:return ki(t.type._context),null;case 22:case 23:return pc(),null;default:return null}}ws=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)e.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},Os=function(){},Ns=function(e,t,n,o){var r=e.memoizedProps;if(r!==o){e=t.stateNode,oa(ea.current);var i,a=null;switch(n){case"input":r=Y(e,r),o=Y(e,o),a=[];break;case"select":r=U({},r,{value:void 0}),o=U({},o,{value:void 0}),a=[];break;case"textarea":r=oe(e,r),o=oe(e,o),a=[];break;default:"function"!==typeof r.onClick&&"function"===typeof o.onClick&&(e.onclick=er)}for(l in _e(n,o),n=null,r)if(!o.hasOwnProperty(l)&&r.hasOwnProperty(l)&&null!=r[l])if("style"===l){var u=r[l];for(i in u)u.hasOwnProperty(i)&&(n||(n={}),n[i]="")}else"dangerouslySetInnerHTML"!==l&&"children"!==l&&"suppressContentEditableWarning"!==l&&"suppressHydrationWarning"!==l&&"autoFocus"!==l&&(s.hasOwnProperty(l)?a||(a=[]):(a=a||[]).push(l,null));for(l in o){var c=o[l];if(u=null!=r?r[l]:void 0,o.hasOwnProperty(l)&&c!==u&&(null!=c||null!=u))if("style"===l)if(u){for(i in u)!u.hasOwnProperty(i)||c&&c.hasOwnProperty(i)||(n||(n={}),n[i]="");for(i in c)c.hasOwnProperty(i)&&u[i]!==c[i]&&(n||(n={}),n[i]=c[i])}else n||(a||(a=[]),a.push(l,n)),n=c;else"dangerouslySetInnerHTML"===l?(c=c?c.__html:void 0,u=u?u.__html:void 0,null!=c&&u!==c&&(a=a||[]).push(l,c)):"children"===l?"string"!==typeof c&&"number"!==typeof c||(a=a||[]).push(l,""+c):"suppressContentEditableWarning"!==l&&"suppressHydrationWarning"!==l&&(s.hasOwnProperty(l)?(null!=c&&"onScroll"===l&&qo("scroll",e),a||u===c||(a=[])):(a=a||[]).push(l,c))}n&&(a=a||[]).push("style",n);var l=a;(t.updateQueue=l)&&(t.flags|=4)}},Ps=function(e,t,n,o){n!==o&&(t.flags|=4)};var Js=!1,Xs=!1,$s="function"===typeof WeakSet?WeakSet:Set,Qs=null;function eu(e,t){var n=e.ref;if(null!==n)if("function"===typeof n)try{n(null)}catch(o){Sc(e,t,o)}else n.current=null}function tu(e,t,n){try{n()}catch(o){Sc(e,t,o)}}var nu=!1;function ou(e,t,n){var o=t.updateQueue;if(null!==(o=null!==o?o.lastEffect:null)){var r=o=o.next;do{if((r.tag&e)===e){var i=r.destroy;r.destroy=void 0,void 0!==i&&tu(t,n,i)}r=r.next}while(r!==o)}}function ru(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var n=t=t.next;do{if((n.tag&e)===e){var o=n.create;n.destroy=o()}n=n.next}while(n!==t)}}function iu(e){var t=e.ref;if(null!==t){var n=e.stateNode;e.tag,e=n,"function"===typeof t?t(e):t.current=e}}function au(e){var t=e.alternate;null!==t&&(e.alternate=null,au(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&(delete t[fr],delete t[hr],delete t[vr],delete t[mr],delete t[_r])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function su(e){return 5===e.tag||3===e.tag||4===e.tag}function uu(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||su(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function cu(e,t,n){var o=e.tag;if(5===o||6===o)e=e.stateNode,t?8===n.nodeType?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(8===n.nodeType?(t=n.parentNode).insertBefore(e,n):(t=n).appendChild(e),null!==(n=n._reactRootContainer)&&void 0!==n||null!==t.onclick||(t.onclick=er));else if(4!==o&&null!==(e=e.child))for(cu(e,t,n),e=e.sibling;null!==e;)cu(e,t,n),e=e.sibling}function lu(e,t,n){var o=e.tag;if(5===o||6===o)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==o&&null!==(e=e.child))for(lu(e,t,n),e=e.sibling;null!==e;)lu(e,t,n),e=e.sibling}var du=null,pu=!1;function fu(e,t,n){for(n=n.child;null!==n;)hu(e,t,n),n=n.sibling}function hu(e,t,n){if(it&&"function"===typeof it.onCommitFiberUnmount)try{it.onCommitFiberUnmount(rt,n)}catch(s){}switch(n.tag){case 5:Xs||eu(n,t);case 6:var o=du,r=pu;du=null,fu(e,t,n),pu=r,null!==(du=o)&&(pu?(e=du,n=n.stateNode,8===e.nodeType?e.parentNode.removeChild(n):e.removeChild(n)):du.removeChild(n.stateNode));break;case 18:null!==du&&(pu?(e=du,n=n.stateNode,8===e.nodeType?cr(e.parentNode,n):1===e.nodeType&&cr(e,n),Vt(e)):cr(du,n.stateNode));break;case 4:o=du,r=pu,du=n.stateNode.containerInfo,pu=!0,fu(e,t,n),du=o,pu=r;break;case 0:case 11:case 14:case 15:if(!Xs&&(null!==(o=n.updateQueue)&&null!==(o=o.lastEffect))){r=o=o.next;do{var i=r,a=i.destroy;i=i.tag,void 0!==a&&(0!==(2&i)||0!==(4&i))&&tu(n,t,a),r=r.next}while(r!==o)}fu(e,t,n);break;case 1:if(!Xs&&(eu(n,t),"function"===typeof(o=n.stateNode).componentWillUnmount))try{o.props=n.memoizedProps,o.state=n.memoizedState,o.componentWillUnmount()}catch(s){Sc(n,t,s)}fu(e,t,n);break;case 21:fu(e,t,n);break;case 22:1&n.mode?(Xs=(o=Xs)||null!==n.memoizedState,fu(e,t,n),Xs=o):fu(e,t,n);break;default:fu(e,t,n)}}function gu(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new $s),t.forEach((function(t){var o=Ac.bind(null,e,t);n.has(t)||(n.add(t),t.then(o,o))}))}}function vu(e,t){var n=t.deletions;if(null!==n)for(var o=0;o<n.length;o++){var r=n[o];try{var a=e,s=t,u=s;e:for(;null!==u;){switch(u.tag){case 5:du=u.stateNode,pu=!1;break e;case 3:case 4:du=u.stateNode.containerInfo,pu=!0;break e}u=u.return}if(null===du)throw Error(i(160));hu(a,s,r),du=null,pu=!1;var c=r.alternate;null!==c&&(c.return=null),r.return=null}catch(l){Sc(r,t,l)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)mu(t,e),t=t.sibling}function mu(e,t){var n=e.alternate,o=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(vu(t,e),_u(e),4&o){try{ou(3,e,e.return),ru(3,e)}catch(v){Sc(e,e.return,v)}try{ou(5,e,e.return)}catch(v){Sc(e,e.return,v)}}break;case 1:vu(t,e),_u(e),512&o&&null!==n&&eu(n,n.return);break;case 5:if(vu(t,e),_u(e),512&o&&null!==n&&eu(n,n.return),32&e.flags){var r=e.stateNode;try{pe(r,"")}catch(v){Sc(e,e.return,v)}}if(4&o&&null!=(r=e.stateNode)){var a=e.memoizedProps,s=null!==n?n.memoizedProps:a,u=e.type,c=e.updateQueue;if(e.updateQueue=null,null!==c)try{"input"===u&&"radio"===a.type&&null!=a.name&&X(r,a),ye(u,s);var l=ye(u,a);for(s=0;s<c.length;s+=2){var d=c[s],p=c[s+1];"style"===d?ve(r,p):"dangerouslySetInnerHTML"===d?de(r,p):"children"===d?pe(r,p):y(r,d,p,l)}switch(u){case"input":$(r,a);break;case"textarea":ie(r,a);break;case"select":var f=r._wrapperState.wasMultiple;r._wrapperState.wasMultiple=!!a.multiple;var h=a.value;null!=h?ne(r,!!a.multiple,h,!1):f!==!!a.multiple&&(null!=a.defaultValue?ne(r,!!a.multiple,a.defaultValue,!0):ne(r,!!a.multiple,a.multiple?[]:"",!1))}r[hr]=a}catch(v){Sc(e,e.return,v)}}break;case 6:if(vu(t,e),_u(e),4&o){if(null===e.stateNode)throw Error(i(162));r=e.stateNode,a=e.memoizedProps;try{r.nodeValue=a}catch(v){Sc(e,e.return,v)}}break;case 3:if(vu(t,e),_u(e),4&o&&null!==n&&n.memoizedState.isDehydrated)try{Vt(t.containerInfo)}catch(v){Sc(e,e.return,v)}break;case 4:default:vu(t,e),_u(e);break;case 13:vu(t,e),_u(e),8192&(r=e.child).flags&&(a=null!==r.memoizedState,r.stateNode.isHidden=a,!a||null!==r.alternate&&null!==r.alternate.memoizedState||(Vu=Xe())),4&o&&gu(e);break;case 22:if(d=null!==n&&null!==n.memoizedState,1&e.mode?(Xs=(l=Xs)||d,vu(t,e),Xs=l):vu(t,e),_u(e),8192&o){if(l=null!==e.memoizedState,(e.stateNode.isHidden=l)&&!d&&0!==(1&e.mode))for(Qs=e,d=e.child;null!==d;){for(p=Qs=d;null!==Qs;){switch(h=(f=Qs).child,f.tag){case 0:case 11:case 14:case 15:ou(4,f,f.return);break;case 1:eu(f,f.return);var g=f.stateNode;if("function"===typeof g.componentWillUnmount){o=f,n=f.return;try{t=o,g.props=t.memoizedProps,g.state=t.memoizedState,g.componentWillUnmount()}catch(v){Sc(o,n,v)}}break;case 5:eu(f,f.return);break;case 22:if(null!==f.memoizedState){Cu(p);continue}}null!==h?(h.return=f,Qs=h):Cu(p)}d=d.sibling}e:for(d=null,p=e;;){if(5===p.tag){if(null===d){d=p;try{r=p.stateNode,l?"function"===typeof(a=r.style).setProperty?a.setProperty("display","none","important"):a.display="none":(u=p.stateNode,s=void 0!==(c=p.memoizedProps.style)&&null!==c&&c.hasOwnProperty("display")?c.display:null,u.style.display=ge("display",s))}catch(v){Sc(e,e.return,v)}}}else if(6===p.tag){if(null===d)try{p.stateNode.nodeValue=l?"":p.memoizedProps}catch(v){Sc(e,e.return,v)}}else if((22!==p.tag&&23!==p.tag||null===p.memoizedState||p===e)&&null!==p.child){p.child.return=p,p=p.child;continue}if(p===e)break e;for(;null===p.sibling;){if(null===p.return||p.return===e)break e;d===p&&(d=null),p=p.return}d===p&&(d=null),p.sibling.return=p.return,p=p.sibling}}break;case 19:vu(t,e),_u(e),4&o&&gu(e);case 21:}}function _u(e){var t=e.flags;if(2&t){try{e:{for(var n=e.return;null!==n;){if(su(n)){var o=n;break e}n=n.return}throw Error(i(160))}switch(o.tag){case 5:var r=o.stateNode;32&o.flags&&(pe(r,""),o.flags&=-33),lu(e,uu(e),r);break;case 3:case 4:var a=o.stateNode.containerInfo;cu(e,uu(e),a);break;default:throw Error(i(161))}}catch(s){Sc(e,e.return,s)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function yu(e,t,n){Qs=e,Mu(e,t,n)}function Mu(e,t,n){for(var o=0!==(1&e.mode);null!==Qs;){var r=Qs,i=r.child;if(22===r.tag&&o){var a=null!==r.memoizedState||Js;if(!a){var s=r.alternate,u=null!==s&&null!==s.memoizedState||Xs;s=Js;var c=Xs;if(Js=a,(Xs=u)&&!c)for(Qs=r;null!==Qs;)u=(a=Qs).child,22===a.tag&&null!==a.memoizedState?ku(r):null!==u?(u.return=a,Qs=u):ku(r);for(;null!==i;)Qs=i,Mu(i,t,n),i=i.sibling;Qs=r,Js=s,Xs=c}Iu(e)}else 0!==(8772&r.subtreeFlags)&&null!==i?(i.return=r,Qs=i):Iu(e)}}function Iu(e){for(;null!==Qs;){var t=Qs;if(0!==(8772&t.flags)){var n=t.alternate;try{if(0!==(8772&t.flags))switch(t.tag){case 0:case 11:case 15:Xs||ru(5,t);break;case 1:var o=t.stateNode;if(4&t.flags&&!Xs)if(null===n)o.componentDidMount();else{var r=t.elementType===t.type?n.memoizedProps:mi(t.type,n.memoizedProps);o.componentDidUpdate(r,n.memoizedState,o.__reactInternalSnapshotBeforeUpdate)}var a=t.updateQueue;null!==a&&Fi(t,a,o);break;case 3:var s=t.updateQueue;if(null!==s){if(n=null,null!==t.child)switch(t.child.tag){case 5:case 1:n=t.child.stateNode}Fi(t,s,n)}break;case 5:var u=t.stateNode;if(null===n&&4&t.flags){n=u;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var l=t.alternate;if(null!==l){var d=l.memoizedState;if(null!==d){var p=d.dehydrated;null!==p&&Vt(p)}}}break;default:throw Error(i(163))}Xs||512&t.flags&&iu(t)}catch(f){Sc(t,t.return,f)}}if(t===e){Qs=null;break}if(null!==(n=t.sibling)){n.return=t.return,Qs=n;break}Qs=t.return}}function Cu(e){for(;null!==Qs;){var t=Qs;if(t===e){Qs=null;break}var n=t.sibling;if(null!==n){n.return=t.return,Qs=n;break}Qs=t.return}}function ku(e){for(;null!==Qs;){var t=Qs;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{ru(4,t)}catch(u){Sc(t,n,u)}break;case 1:var o=t.stateNode;if("function"===typeof o.componentDidMount){var r=t.return;try{o.componentDidMount()}catch(u){Sc(t,r,u)}}var i=t.return;try{iu(t)}catch(u){Sc(t,i,u)}break;case 5:var a=t.return;try{iu(t)}catch(u){Sc(t,a,u)}}}catch(u){Sc(t,t.return,u)}if(t===e){Qs=null;break}var s=t.sibling;if(null!==s){s.return=t.return,Qs=s;break}Qs=t.return}}var Tu,Su=Math.ceil,bu=M.ReactCurrentDispatcher,Du=M.ReactCurrentOwner,Eu=M.ReactCurrentBatchConfig,Au=0,Lu=null,Ru=null,wu=0,Ou=0,Nu=Sr(0),Pu=0,Gu=null,Uu=0,xu=0,Fu=0,qu=null,Bu=null,Vu=0,Hu=1/0,Ku=null,ju=!1,zu=null,Zu=null,Wu=!1,Yu=null,Ju=0,Xu=0,$u=null,Qu=-1,ec=0;function tc(){return 0!==(6&Au)?Xe():-1!==Qu?Qu:Qu=Xe()}function nc(e){return 0===(1&e.mode)?1:0!==(2&Au)&&0!==wu?wu&-wu:null!==vi.transition?(0===ec&&(ec=gt()),ec):0!==(e=yt)?e:e=void 0===(e=window.event)?16:Jt(e.type)}function oc(e,t,n,o){if(50<Xu)throw Xu=0,$u=null,Error(i(185));mt(e,n,o),0!==(2&Au)&&e===Lu||(e===Lu&&(0===(2&Au)&&(xu|=n),4===Pu&&uc(e,wu)),rc(e,o),1===n&&0===Au&&0===(1&t.mode)&&(Hu=Xe()+500,qr&&Hr()))}function rc(e,t){var n=e.callbackNode;!function(e,t){for(var n=e.suspendedLanes,o=e.pingedLanes,r=e.expirationTimes,i=e.pendingLanes;0<i;){var a=31-at(i),s=1<<a,u=r[a];-1===u?0!==(s&n)&&0===(s&o)||(r[a]=ft(s,t)):u<=t&&(e.expiredLanes|=s),i&=~s}}(e,t);var o=pt(e,e===Lu?wu:0);if(0===o)null!==n&&We(n),e.callbackNode=null,e.callbackPriority=0;else if(t=o&-o,e.callbackPriority!==t){if(null!=n&&We(n),1===t)0===e.tag?function(e){qr=!0,Vr(e)}(cc.bind(null,e)):Vr(cc.bind(null,e)),sr((function(){0===(6&Au)&&Hr()})),n=null;else{switch(Mt(o)){case 1:n=Qe;break;case 4:n=et;break;case 16:default:n=tt;break;case 536870912:n=ot}n=Lc(n,ic.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function ic(e,t){if(Qu=-1,ec=0,0!==(6&Au))throw Error(i(327));var n=e.callbackNode;if(kc()&&e.callbackNode!==n)return null;var o=pt(e,e===Lu?wu:0);if(0===o)return null;if(0!==(30&o)||0!==(o&e.expiredLanes)||t)t=mc(e,o);else{t=o;var r=Au;Au|=2;var a=gc();for(Lu===e&&wu===t||(Ku=null,Hu=Xe()+500,fc(e,t));;)try{yc();break}catch(u){hc(e,u)}Ci(),bu.current=a,Au=r,null!==Ru?t=0:(Lu=null,wu=0,t=Pu)}if(0!==t){if(2===t&&(0!==(r=ht(e))&&(o=r,t=ac(e,r))),1===t)throw n=Gu,fc(e,0),uc(e,o),rc(e,Xe()),n;if(6===t)uc(e,o);else{if(r=e.current.alternate,0===(30&o)&&!function(e){for(var t=e;;){if(16384&t.flags){var n=t.updateQueue;if(null!==n&&null!==(n=n.stores))for(var o=0;o<n.length;o++){var r=n[o],i=r.getSnapshot;r=r.value;try{if(!so(i(),r))return!1}catch(s){return!1}}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(r)&&(2===(t=mc(e,o))&&(0!==(a=ht(e))&&(o=a,t=ac(e,a))),1===t))throw n=Gu,fc(e,0),uc(e,o),rc(e,Xe()),n;switch(e.finishedWork=r,e.finishedLanes=o,t){case 0:case 1:throw Error(i(345));case 2:case 5:Cc(e,Bu,Ku);break;case 3:if(uc(e,o),(130023424&o)===o&&10<(t=Vu+500-Xe())){if(0!==pt(e,0))break;if(((r=e.suspendedLanes)&o)!==o){tc(),e.pingedLanes|=e.suspendedLanes&r;break}e.timeoutHandle=rr(Cc.bind(null,e,Bu,Ku),t);break}Cc(e,Bu,Ku);break;case 4:if(uc(e,o),(4194240&o)===o)break;for(t=e.eventTimes,r=-1;0<o;){var s=31-at(o);a=1<<s,(s=t[s])>r&&(r=s),o&=~a}if(o=r,10<(o=(120>(o=Xe()-o)?120:480>o?480:1080>o?1080:1920>o?1920:3e3>o?3e3:4320>o?4320:1960*Su(o/1960))-o)){e.timeoutHandle=rr(Cc.bind(null,e,Bu,Ku),o);break}Cc(e,Bu,Ku);break;default:throw Error(i(329))}}}return rc(e,Xe()),e.callbackNode===n?ic.bind(null,e):null}function ac(e,t){var n=qu;return e.current.memoizedState.isDehydrated&&(fc(e,t).flags|=256),2!==(e=mc(e,t))&&(t=Bu,Bu=n,null!==t&&sc(t)),e}function sc(e){null===Bu?Bu=e:Bu.push.apply(Bu,e)}function uc(e,t){for(t&=~Fu,t&=~xu,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-at(t),o=1<<n;e[n]=-1,t&=~o}}function cc(e){if(0!==(6&Au))throw Error(i(327));kc();var t=pt(e,0);if(0===(1&t))return rc(e,Xe()),null;var n=mc(e,t);if(0!==e.tag&&2===n){var o=ht(e);0!==o&&(t=o,n=ac(e,o))}if(1===n)throw n=Gu,fc(e,0),uc(e,t),rc(e,Xe()),n;if(6===n)throw Error(i(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Cc(e,Bu,Ku),rc(e,Xe()),null}function lc(e,t){var n=Au;Au|=1;try{return e(t)}finally{0===(Au=n)&&(Hu=Xe()+500,qr&&Hr())}}function dc(e){null!==Yu&&0===Yu.tag&&0===(6&Au)&&kc();var t=Au;Au|=1;var n=Eu.transition,o=yt;try{if(Eu.transition=null,yt=1,e)return e()}finally{yt=o,Eu.transition=n,0===(6&(Au=t))&&Hr()}}function pc(){Ou=Nu.current,br(Nu)}function fc(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(-1!==n&&(e.timeoutHandle=-1,ir(n)),null!==Ru)for(n=Ru.return;null!==n;){var o=n;switch(ni(o),o.tag){case 1:null!==(o=o.type.childContextTypes)&&void 0!==o&&Nr();break;case 3:ia(),br(Lr),br(Ar),da();break;case 5:sa(o);break;case 4:ia();break;case 13:case 19:br(ua);break;case 10:ki(o.type._context);break;case 22:case 23:pc()}n=n.return}if(Lu=e,Ru=e=Nc(e.current,null),wu=Ou=t,Pu=0,Gu=null,Fu=xu=Uu=0,Bu=qu=null,null!==Di){for(t=0;t<Di.length;t++)if(null!==(o=(n=Di[t]).interleaved)){n.interleaved=null;var r=o.next,i=n.pending;if(null!==i){var a=i.next;i.next=r,o.next=a}n.pending=o}Di=null}return e}function hc(e,t){for(;;){var n=Ru;try{if(Ci(),pa.current=as,_a){for(var o=ga.memoizedState;null!==o;){var r=o.queue;null!==r&&(r.pending=null),o=o.next}_a=!1}if(ha=0,ma=va=ga=null,ya=!1,Ma=0,Du.current=null,null===n||null===n.return){Pu=1,Gu=t,Ru=null;break}e:{var a=e,s=n.return,u=n,c=t;if(t=wu,u.flags|=32768,null!==c&&"object"===typeof c&&"function"===typeof c.then){var l=c,d=u,p=d.tag;if(0===(1&d.mode)&&(0===p||11===p||15===p)){var f=d.alternate;f?(d.updateQueue=f.updateQueue,d.memoizedState=f.memoizedState,d.lanes=f.lanes):(d.updateQueue=null,d.memoizedState=null)}var h=ms(s);if(null!==h){h.flags&=-257,_s(h,s,u,0,t),1&h.mode&&vs(a,l,t),c=l;var g=(t=h).updateQueue;if(null===g){var v=new Set;v.add(c),t.updateQueue=v}else g.add(c);break e}if(0===(1&t)){vs(a,l,t),vc();break e}c=Error(i(426))}else if(ii&&1&u.mode){var m=ms(s);if(null!==m){0===(65536&m.flags)&&(m.flags|=256),_s(m,s,u,0,t),gi(ls(c,u));break e}}a=c=ls(c,u),4!==Pu&&(Pu=2),null===qu?qu=[a]:qu.push(a),a=s;do{switch(a.tag){case 3:a.flags|=65536,t&=-t,a.lanes|=t,Ui(a,hs(0,c,t));break e;case 1:u=c;var _=a.type,y=a.stateNode;if(0===(128&a.flags)&&("function"===typeof _.getDerivedStateFromError||null!==y&&"function"===typeof y.componentDidCatch&&(null===Zu||!Zu.has(y)))){a.flags|=65536,t&=-t,a.lanes|=t,Ui(a,gs(a,u,t));break e}}a=a.return}while(null!==a)}Ic(n)}catch(M){t=M,Ru===n&&null!==n&&(Ru=n=n.return);continue}break}}function gc(){var e=bu.current;return bu.current=as,null===e?as:e}function vc(){0!==Pu&&3!==Pu&&2!==Pu||(Pu=4),null===Lu||0===(268435455&Uu)&&0===(268435455&xu)||uc(Lu,wu)}function mc(e,t){var n=Au;Au|=2;var o=gc();for(Lu===e&&wu===t||(Ku=null,fc(e,t));;)try{_c();break}catch(r){hc(e,r)}if(Ci(),Au=n,bu.current=o,null!==Ru)throw Error(i(261));return Lu=null,wu=0,Pu}function _c(){for(;null!==Ru;)Mc(Ru)}function yc(){for(;null!==Ru&&!Ye();)Mc(Ru)}function Mc(e){var t=Tu(e.alternate,e,Ou);e.memoizedProps=e.pendingProps,null===t?Ic(e):Ru=t,Du.current=null}function Ic(e){var t=e;do{var n=t.alternate;if(e=t.return,0===(32768&t.flags)){if(null!==(n=Ws(n,t,Ou)))return void(Ru=n)}else{if(null!==(n=Ys(n,t)))return n.flags&=32767,void(Ru=n);if(null===e)return Pu=6,void(Ru=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void(Ru=t);Ru=t=e}while(null!==t);0===Pu&&(Pu=5)}function Cc(e,t,n){var o=yt,r=Eu.transition;try{Eu.transition=null,yt=1,function(e,t,n,o){do{kc()}while(null!==Yu);if(0!==(6&Au))throw Error(i(327));n=e.finishedWork;var r=e.finishedLanes;if(null===n)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(i(177));e.callbackNode=null,e.callbackPriority=0;var a=n.lanes|n.childLanes;if(function(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var o=e.eventTimes;for(e=e.expirationTimes;0<n;){var r=31-at(n),i=1<<r;t[r]=0,o[r]=-1,e[r]=-1,n&=~i}}(e,a),e===Lu&&(Ru=Lu=null,wu=0),0===(2064&n.subtreeFlags)&&0===(2064&n.flags)||Wu||(Wu=!0,Lc(tt,(function(){return kc(),null}))),a=0!==(15990&n.flags),0!==(15990&n.subtreeFlags)||a){a=Eu.transition,Eu.transition=null;var s=yt;yt=1;var u=Au;Au|=4,Du.current=null,function(e,t){if(tr=Kt,ho(e=fo())){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var o=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(o&&0!==o.rangeCount){n=o.anchorNode;var r=o.anchorOffset,a=o.focusNode;o=o.focusOffset;try{n.nodeType,a.nodeType}catch(I){n=null;break e}var s=0,u=-1,c=-1,l=0,d=0,p=e,f=null;t:for(;;){for(var h;p!==n||0!==r&&3!==p.nodeType||(u=s+r),p!==a||0!==o&&3!==p.nodeType||(c=s+o),3===p.nodeType&&(s+=p.nodeValue.length),null!==(h=p.firstChild);)f=p,p=h;for(;;){if(p===e)break t;if(f===n&&++l===r&&(u=s),f===a&&++d===o&&(c=s),null!==(h=p.nextSibling))break;f=(p=f).parentNode}p=h}n=-1===u||-1===c?null:{start:u,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(nr={focusedElem:e,selectionRange:n},Kt=!1,Qs=t;null!==Qs;)if(e=(t=Qs).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,Qs=e;else for(;null!==Qs;){t=Qs;try{var g=t.alternate;if(0!==(1024&t.flags))switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==g){var v=g.memoizedProps,m=g.memoizedState,_=t.stateNode,y=_.getSnapshotBeforeUpdate(t.elementType===t.type?v:mi(t.type,v),m);_.__reactInternalSnapshotBeforeUpdate=y}break;case 3:var M=t.stateNode.containerInfo;1===M.nodeType?M.textContent="":9===M.nodeType&&M.documentElement&&M.removeChild(M.documentElement);break;default:throw Error(i(163))}}catch(I){Sc(t,t.return,I)}if(null!==(e=t.sibling)){e.return=t.return,Qs=e;break}Qs=t.return}g=nu,nu=!1}(e,n),mu(n,e),go(nr),Kt=!!tr,nr=tr=null,e.current=n,yu(n,e,r),Je(),Au=u,yt=s,Eu.transition=a}else e.current=n;if(Wu&&(Wu=!1,Yu=e,Ju=r),a=e.pendingLanes,0===a&&(Zu=null),function(e){if(it&&"function"===typeof it.onCommitFiberRoot)try{it.onCommitFiberRoot(rt,e,void 0,128===(128&e.current.flags))}catch(t){}}(n.stateNode),rc(e,Xe()),null!==t)for(o=e.onRecoverableError,n=0;n<t.length;n++)r=t[n],o(r.value,{componentStack:r.stack,digest:r.digest});if(ju)throw ju=!1,e=zu,zu=null,e;0!==(1&Ju)&&0!==e.tag&&kc(),a=e.pendingLanes,0!==(1&a)?e===$u?Xu++:(Xu=0,$u=e):Xu=0,Hr()}(e,t,n,o)}finally{Eu.transition=r,yt=o}return null}function kc(){if(null!==Yu){var e=Mt(Ju),t=Eu.transition,n=yt;try{if(Eu.transition=null,yt=16>e?16:e,null===Yu)var o=!1;else{if(e=Yu,Yu=null,Ju=0,0!==(6&Au))throw Error(i(331));var r=Au;for(Au|=4,Qs=e.current;null!==Qs;){var a=Qs,s=a.child;if(0!==(16&Qs.flags)){var u=a.deletions;if(null!==u){for(var c=0;c<u.length;c++){var l=u[c];for(Qs=l;null!==Qs;){var d=Qs;switch(d.tag){case 0:case 11:case 15:ou(8,d,a)}var p=d.child;if(null!==p)p.return=d,Qs=p;else for(;null!==Qs;){var f=(d=Qs).sibling,h=d.return;if(au(d),d===l){Qs=null;break}if(null!==f){f.return=h,Qs=f;break}Qs=h}}}var g=a.alternate;if(null!==g){var v=g.child;if(null!==v){g.child=null;do{var m=v.sibling;v.sibling=null,v=m}while(null!==v)}}Qs=a}}if(0!==(2064&a.subtreeFlags)&&null!==s)s.return=a,Qs=s;else e:for(;null!==Qs;){if(0!==(2048&(a=Qs).flags))switch(a.tag){case 0:case 11:case 15:ou(9,a,a.return)}var _=a.sibling;if(null!==_){_.return=a.return,Qs=_;break e}Qs=a.return}}var y=e.current;for(Qs=y;null!==Qs;){var M=(s=Qs).child;if(0!==(2064&s.subtreeFlags)&&null!==M)M.return=s,Qs=M;else e:for(s=y;null!==Qs;){if(0!==(2048&(u=Qs).flags))try{switch(u.tag){case 0:case 11:case 15:ru(9,u)}}catch(C){Sc(u,u.return,C)}if(u===s){Qs=null;break e}var I=u.sibling;if(null!==I){I.return=u.return,Qs=I;break e}Qs=u.return}}if(Au=r,Hr(),it&&"function"===typeof it.onPostCommitFiberRoot)try{it.onPostCommitFiberRoot(rt,e)}catch(C){}o=!0}return o}finally{yt=n,Eu.transition=t}}return!1}function Tc(e,t,n){e=Pi(e,t=hs(0,t=ls(n,t),1),1),t=tc(),null!==e&&(mt(e,1,t),rc(e,t))}function Sc(e,t,n){if(3===e.tag)Tc(e,e,n);else for(;null!==t;){if(3===t.tag){Tc(t,e,n);break}if(1===t.tag){var o=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof o.componentDidCatch&&(null===Zu||!Zu.has(o))){t=Pi(t,e=gs(t,e=ls(n,e),1),1),e=tc(),null!==t&&(mt(t,1,e),rc(t,e));break}}t=t.return}}function bc(e,t,n){var o=e.pingCache;null!==o&&o.delete(t),t=tc(),e.pingedLanes|=e.suspendedLanes&n,Lu===e&&(wu&n)===n&&(4===Pu||3===Pu&&(130023424&wu)===wu&&500>Xe()-Vu?fc(e,0):Fu|=n),rc(e,t)}function Dc(e,t){0===t&&(0===(1&e.mode)?t=1:(t=lt,0===(130023424&(lt<<=1))&&(lt=4194304)));var n=tc();null!==(e=Li(e,t))&&(mt(e,t,n),rc(e,n))}function Ec(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),Dc(e,n)}function Ac(e,t){var n=0;switch(e.tag){case 13:var o=e.stateNode,r=e.memoizedState;null!==r&&(n=r.retryLane);break;case 19:o=e.stateNode;break;default:throw Error(i(314))}null!==o&&o.delete(t),Dc(e,n)}function Lc(e,t){return Ze(e,t)}function Rc(e,t,n,o){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=o,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function wc(e,t,n,o){return new Rc(e,t,n,o)}function Oc(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Nc(e,t){var n=e.alternate;return null===n?((n=wc(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=14680064&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Pc(e,t,n,o,r,a){var s=2;if(o=e,"function"===typeof e)Oc(e)&&(s=1);else if("string"===typeof e)s=5;else e:switch(e){case k:return Gc(n.children,r,a,t);case T:s=8,r|=8;break;case S:return(e=wc(12,n,t,2|r)).elementType=S,e.lanes=a,e;case A:return(e=wc(13,n,t,r)).elementType=A,e.lanes=a,e;case L:return(e=wc(19,n,t,r)).elementType=L,e.lanes=a,e;case O:return Uc(n,r,a,t);default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case b:s=10;break e;case D:s=9;break e;case E:s=11;break e;case R:s=14;break e;case w:s=16,o=null;break e}throw Error(i(130,null==e?e:typeof e,""))}return(t=wc(s,n,t,r)).elementType=e,t.type=o,t.lanes=a,t}function Gc(e,t,n,o){return(e=wc(7,e,o,t)).lanes=n,e}function Uc(e,t,n,o){return(e=wc(22,e,o,t)).elementType=O,e.lanes=n,e.stateNode={isHidden:!1},e}function xc(e,t,n){return(e=wc(6,e,null,t)).lanes=n,e}function Fc(e,t,n){return(t=wc(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function qc(e,t,n,o,r){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=vt(0),this.expirationTimes=vt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=vt(0),this.identifierPrefix=o,this.onRecoverableError=r,this.mutableSourceEagerHydrationData=null}function Bc(e,t,n,o,r,i,a,s,u){return e=new qc(e,t,n,s,u),1===t?(t=1,!0===i&&(t|=8)):t=0,i=wc(3,null,null,t),e.current=i,i.stateNode=e,i.memoizedState={element:o,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},wi(i),e}function Vc(e){if(!e)return Er;e:{if(Ve(e=e._reactInternals)!==e||1!==e.tag)throw Error(i(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Or(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(i(171))}if(1===e.tag){var n=e.type;if(Or(n))return Gr(e,n,t)}return t}function Hc(e,t,n,o,r,i,a,s,u){return(e=Bc(n,o,!0,e,0,i,0,s,u)).context=Vc(null),n=e.current,(i=Ni(o=tc(),r=nc(n))).callback=void 0!==t&&null!==t?t:null,Pi(n,i,r),e.current.lanes=r,mt(e,r,o),rc(e,o),e}function Kc(e,t,n,o){var r=t.current,i=tc(),a=nc(r);return n=Vc(n),null===t.context?t.context=n:t.pendingContext=n,(t=Ni(i,a)).payload={element:e},null!==(o=void 0===o?null:o)&&(t.callback=o),null!==(e=Pi(r,t,a))&&(oc(e,r,a,i),Gi(e,r,a)),a}function jc(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function zc(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function Zc(e,t){zc(e,t),(e=e.alternate)&&zc(e,t)}Tu=function(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps||Lr.current)Ms=!0;else{if(0===(e.lanes&n)&&0===(128&t.flags))return Ms=!1,function(e,t,n){switch(t.tag){case 3:Ls(t),hi();break;case 5:aa(t);break;case 1:Or(t.type)&&Ur(t);break;case 4:ra(t,t.stateNode.containerInfo);break;case 10:var o=t.type._context,r=t.memoizedProps.value;Dr(_i,o._currentValue),o._currentValue=r;break;case 13:if(null!==(o=t.memoizedState))return null!==o.dehydrated?(Dr(ua,1&ua.current),t.flags|=128,null):0!==(n&t.child.childLanes)?xs(e,t,n):(Dr(ua,1&ua.current),null!==(e=js(e,t,n))?e.sibling:null);Dr(ua,1&ua.current);break;case 19:if(o=0!==(n&t.childLanes),0!==(128&e.flags)){if(o)return Hs(e,t,n);t.flags|=128}if(null!==(r=t.memoizedState)&&(r.rendering=null,r.tail=null,r.lastEffect=null),Dr(ua,ua.current),o)break;return null;case 22:case 23:return t.lanes=0,Ss(e,t,n)}return js(e,t,n)}(e,t,n);Ms=0!==(131072&e.flags)}else Ms=!1,ii&&0!==(1048576&t.flags)&&ei(t,Zr,t.index);switch(t.lanes=0,t.tag){case 2:var o=t.type;Ks(e,t),e=t.pendingProps;var r=wr(t,Ar.current);Si(t,n),r=Ta(null,t,o,e,r,n);var a=Sa();return t.flags|=1,"object"===typeof r&&null!==r&&"function"===typeof r.render&&void 0===r.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Or(o)?(a=!0,Ur(t)):a=!1,t.memoizedState=null!==r.state&&void 0!==r.state?r.state:null,wi(t),r.updater=Vi,t.stateNode=r,r._reactInternals=t,zi(t,o,e,n),t=As(null,t,o,!0,a,n)):(t.tag=0,ii&&a&&ti(t),Is(null,t,r,n),t=t.child),t;case 16:o=t.elementType;e:{switch(Ks(e,t),e=t.pendingProps,o=(r=o._init)(o._payload),t.type=o,r=t.tag=function(e){if("function"===typeof e)return Oc(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===E)return 11;if(e===R)return 14}return 2}(o),e=mi(o,e),r){case 0:t=Ds(null,t,o,e,n);break e;case 1:t=Es(null,t,o,e,n);break e;case 11:t=Cs(null,t,o,e,n);break e;case 14:t=ks(null,t,o,mi(o.type,e),n);break e}throw Error(i(306,o,""))}return t;case 0:return o=t.type,r=t.pendingProps,Ds(e,t,o,r=t.elementType===o?r:mi(o,r),n);case 1:return o=t.type,r=t.pendingProps,Es(e,t,o,r=t.elementType===o?r:mi(o,r),n);case 3:e:{if(Ls(t),null===e)throw Error(i(387));o=t.pendingProps,r=(a=t.memoizedState).element,Oi(e,t),xi(t,o,null,n);var s=t.memoizedState;if(o=s.element,a.isDehydrated){if(a={element:o,isDehydrated:!1,cache:s.cache,pendingSuspenseBoundaries:s.pendingSuspenseBoundaries,transitions:s.transitions},t.updateQueue.baseState=a,t.memoizedState=a,256&t.flags){t=Rs(e,t,o,n,r=ls(Error(i(423)),t));break e}if(o!==r){t=Rs(e,t,o,n,r=ls(Error(i(424)),t));break e}for(ri=lr(t.stateNode.containerInfo.firstChild),oi=t,ii=!0,ai=null,n=$i(t,null,o,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(hi(),o===r){t=js(e,t,n);break e}Is(e,t,o,n)}t=t.child}return t;case 5:return aa(t),null===e&&li(t),o=t.type,r=t.pendingProps,a=null!==e?e.memoizedProps:null,s=r.children,or(o,r)?s=null:null!==a&&or(o,a)&&(t.flags|=32),bs(e,t),Is(e,t,s,n),t.child;case 6:return null===e&&li(t),null;case 13:return xs(e,t,n);case 4:return ra(t,t.stateNode.containerInfo),o=t.pendingProps,null===e?t.child=Xi(t,null,o,n):Is(e,t,o,n),t.child;case 11:return o=t.type,r=t.pendingProps,Cs(e,t,o,r=t.elementType===o?r:mi(o,r),n);case 7:return Is(e,t,t.pendingProps,n),t.child;case 8:case 12:return Is(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(o=t.type._context,r=t.pendingProps,a=t.memoizedProps,s=r.value,Dr(_i,o._currentValue),o._currentValue=s,null!==a)if(so(a.value,s)){if(a.children===r.children&&!Lr.current){t=js(e,t,n);break e}}else for(null!==(a=t.child)&&(a.return=t);null!==a;){var u=a.dependencies;if(null!==u){s=a.child;for(var c=u.firstContext;null!==c;){if(c.context===o){if(1===a.tag){(c=Ni(-1,n&-n)).tag=2;var l=a.updateQueue;if(null!==l){var d=(l=l.shared).pending;null===d?c.next=c:(c.next=d.next,d.next=c),l.pending=c}}a.lanes|=n,null!==(c=a.alternate)&&(c.lanes|=n),Ti(a.return,n,t),u.lanes|=n;break}c=c.next}}else if(10===a.tag)s=a.type===t.type?null:a.child;else if(18===a.tag){if(null===(s=a.return))throw Error(i(341));s.lanes|=n,null!==(u=s.alternate)&&(u.lanes|=n),Ti(s,n,t),s=a.sibling}else s=a.child;if(null!==s)s.return=a;else for(s=a;null!==s;){if(s===t){s=null;break}if(null!==(a=s.sibling)){a.return=s.return,s=a;break}s=s.return}a=s}Is(e,t,r.children,n),t=t.child}return t;case 9:return r=t.type,o=t.pendingProps.children,Si(t,n),o=o(r=bi(r)),t.flags|=1,Is(e,t,o,n),t.child;case 14:return r=mi(o=t.type,t.pendingProps),ks(e,t,o,r=mi(o.type,r),n);case 15:return Ts(e,t,t.type,t.pendingProps,n);case 17:return o=t.type,r=t.pendingProps,r=t.elementType===o?r:mi(o,r),Ks(e,t),t.tag=1,Or(o)?(e=!0,Ur(t)):e=!1,Si(t,n),Ki(t,o,r),zi(t,o,r,n),As(null,t,o,!0,e,n);case 19:return Hs(e,t,n);case 22:return Ss(e,t,n)}throw Error(i(156,t.tag))};var Wc="function"===typeof reportError?reportError:function(e){console.error(e)};function Yc(e){this._internalRoot=e}function Jc(e){this._internalRoot=e}function Xc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function $c(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function Qc(){}function el(e,t,n,o,r){var i=n._reactRootContainer;if(i){var a=i;if("function"===typeof r){var s=r;r=function(){var e=jc(a);s.call(e)}}Kc(t,a,e,r)}else a=function(e,t,n,o,r){if(r){if("function"===typeof o){var i=o;o=function(){var e=jc(a);i.call(e)}}var a=Hc(t,o,e,0,null,!1,0,"",Qc);return e._reactRootContainer=a,e[gr]=a.current,Ho(8===e.nodeType?e.parentNode:e),dc(),a}for(;r=e.lastChild;)e.removeChild(r);if("function"===typeof o){var s=o;o=function(){var e=jc(u);s.call(e)}}var u=Bc(e,0,!1,null,0,!1,0,"",Qc);return e._reactRootContainer=u,e[gr]=u.current,Ho(8===e.nodeType?e.parentNode:e),dc((function(){Kc(t,u,n,o)})),u}(n,t,e,r,o);return jc(a)}Jc.prototype.render=Yc.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(i(409));Kc(e,t,null,null)},Jc.prototype.unmount=Yc.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;dc((function(){Kc(null,e,null,null)})),t[gr]=null}},Jc.prototype.unstable_scheduleHydration=function(e){if(e){var t=Tt();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Ot.length&&0!==t&&t<Ot[n].priority;n++);Ot.splice(n,0,e),0===n&&Ut(e)}},It=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=dt(t.pendingLanes);0!==n&&(_t(t,1|n),rc(t,Xe()),0===(6&Au)&&(Hu=Xe()+500,Hr()))}break;case 13:dc((function(){var t=Li(e,1);if(null!==t){var n=tc();oc(t,e,1,n)}})),Zc(e,1)}},Ct=function(e){if(13===e.tag){var t=Li(e,134217728);if(null!==t)oc(t,e,134217728,tc());Zc(e,134217728)}},kt=function(e){if(13===e.tag){var t=nc(e),n=Li(e,t);if(null!==n)oc(n,e,t,tc());Zc(e,t)}},Tt=function(){return yt},St=function(e,t){var n=yt;try{return yt=e,t()}finally{yt=n}},Ce=function(e,t,n){switch(t){case"input":if($(e,n),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var o=n[t];if(o!==e&&o.form===e.form){var r=Cr(o);if(!r)throw Error(i(90));Z(o),$(o,r)}}}break;case"textarea":ie(e,n);break;case"select":null!=(t=n.value)&&ne(e,!!n.multiple,t,!1)}},Ee=lc,Ae=dc;var tl={usingClientEntryPoint:!1,Events:[Mr,Ir,Cr,be,De,lc]},nl={findFiberByHostInstance:yr,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},ol={bundleType:nl.bundleType,version:nl.version,rendererPackageName:nl.rendererPackageName,rendererConfig:nl.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:M.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=je(e))?null:e.stateNode},findFiberByHostInstance:nl.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var rl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!rl.isDisabled&&rl.supportsFiber)try{rt=rl.inject(ol),it=rl}catch(le){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=tl,t.createPortal=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Xc(t))throw Error(i(200));return function(e,t,n){var o=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:C,key:null==o?null:""+o,children:e,containerInfo:t,implementation:n}}(e,t,null,n)},t.createRoot=function(e,t){if(!Xc(e))throw Error(i(299));var n=!1,o="",r=Wc;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(o=t.identifierPrefix),void 0!==t.onRecoverableError&&(r=t.onRecoverableError)),t=Bc(e,1,!1,null,0,n,0,o,r),e[gr]=t.current,Ho(8===e.nodeType?e.parentNode:e),new Yc(t)},t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(i(188));throw e=Object.keys(e).join(","),Error(i(268,e))}return e=null===(e=je(t))?null:e.stateNode},t.flushSync=function(e){return dc(e)},t.hydrate=function(e,t,n){if(!$c(t))throw Error(i(200));return el(null,e,t,!0,n)},t.hydrateRoot=function(e,t,n){if(!Xc(e))throw Error(i(405));var o=null!=n&&n.hydratedSources||null,r=!1,a="",s=Wc;if(null!==n&&void 0!==n&&(!0===n.unstable_strictMode&&(r=!0),void 0!==n.identifierPrefix&&(a=n.identifierPrefix),void 0!==n.onRecoverableError&&(s=n.onRecoverableError)),t=Hc(t,null,e,1,null!=n?n:null,r,0,a,s),e[gr]=t.current,Ho(e),o)for(e=0;e<o.length;e++)r=(r=(n=o[e])._getVersion)(n._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[n,r]:t.mutableSourceEagerHydrationData.push(n,r);return new Jc(t)},t.render=function(e,t,n){if(!$c(t))throw Error(i(200));return el(null,e,t,!1,n)},t.unmountComponentAtNode=function(e){if(!$c(e))throw Error(i(40));return!!e._reactRootContainer&&(dc((function(){el(null,null,e,!1,(function(){e._reactRootContainer=null,e[gr]=null}))})),!0)},t.unstable_batchedUpdates=lc,t.unstable_renderSubtreeIntoContainer=function(e,t,n,o){if(!$c(n))throw Error(i(200));if(null==e||void 0===e._reactInternals)throw Error(i(38));return el(e,t,n,!1,o)},t.version="18.2.0-next-9e3b772b8-20220608"},2379:function(e,t,n){"use strict";var o=n(2495);t.createRoot=o.createRoot,t.hydrateRoot=o.hydrateRoot},2495:function(e,t,n){"use strict";!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(3562)},7225:function(e,t){"use strict";var n="function"===typeof Symbol&&Symbol.for,o=n?Symbol.for("react.element"):60103,r=n?Symbol.for("react.portal"):60106,i=n?Symbol.for("react.fragment"):60107,a=n?Symbol.for("react.strict_mode"):60108,s=n?Symbol.for("react.profiler"):60114,u=n?Symbol.for("react.provider"):60109,c=n?Symbol.for("react.context"):60110,l=n?Symbol.for("react.async_mode"):60111,d=n?Symbol.for("react.concurrent_mode"):60111,p=n?Symbol.for("react.forward_ref"):60112,f=n?Symbol.for("react.suspense"):60113,h=n?Symbol.for("react.suspense_list"):60120,g=n?Symbol.for("react.memo"):60115,v=n?Symbol.for("react.lazy"):60116,m=n?Symbol.for("react.block"):60121,_=n?Symbol.for("react.fundamental"):60117,y=n?Symbol.for("react.responder"):60118,M=n?Symbol.for("react.scope"):60119;function I(e){if("object"===typeof e&&null!==e){var t=e.$$typeof;switch(t){case o:switch(e=e.type){case l:case d:case i:case s:case a:case f:return e;default:switch(e=e&&e.$$typeof){case c:case p:case v:case g:case u:return e;default:return t}}case r:return t}}}function C(e){return I(e)===d}t.AsyncMode=l,t.ConcurrentMode=d,t.ContextConsumer=c,t.ContextProvider=u,t.Element=o,t.ForwardRef=p,t.Fragment=i,t.Lazy=v,t.Memo=g,t.Portal=r,t.Profiler=s,t.StrictMode=a,t.Suspense=f,t.isAsyncMode=function(e){return C(e)||I(e)===l},t.isConcurrentMode=C,t.isContextConsumer=function(e){return I(e)===c},t.isContextProvider=function(e){return I(e)===u},t.isElement=function(e){return"object"===typeof e&&null!==e&&e.$$typeof===o},t.isForwardRef=function(e){return I(e)===p},t.isFragment=function(e){return I(e)===i},t.isLazy=function(e){return I(e)===v},t.isMemo=function(e){return I(e)===g},t.isPortal=function(e){return I(e)===r},t.isProfiler=function(e){return I(e)===s},t.isStrictMode=function(e){return I(e)===a},t.isSuspense=function(e){return I(e)===f},t.isValidElementType=function(e){return"string"===typeof e||"function"===typeof e||e===i||e===d||e===s||e===a||e===f||e===h||"object"===typeof e&&null!==e&&(e.$$typeof===v||e.$$typeof===g||e.$$typeof===u||e.$$typeof===c||e.$$typeof===p||e.$$typeof===_||e.$$typeof===y||e.$$typeof===M||e.$$typeof===m)},t.typeOf=I},3307:function(e,t,n){"use strict";e.exports=n(7225)},4919:function(e,t){"use strict";var n,o=Symbol.for("react.element"),r=Symbol.for("react.portal"),i=Symbol.for("react.fragment"),a=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),u=Symbol.for("react.provider"),c=Symbol.for("react.context"),l=Symbol.for("react.server_context"),d=Symbol.for("react.forward_ref"),p=Symbol.for("react.suspense"),f=Symbol.for("react.suspense_list"),h=Symbol.for("react.memo"),g=Symbol.for("react.lazy"),v=Symbol.for("react.offscreen");function m(e){if("object"===typeof e&&null!==e){var t=e.$$typeof;switch(t){case o:switch(e=e.type){case i:case s:case a:case p:case f:return e;default:switch(e=e&&e.$$typeof){case l:case c:case d:case g:case h:case u:return e;default:return t}}case r:return t}}}n=Symbol.for("react.module.reference")},6727:function(e,t,n){"use strict";n(4919)},768:function(e,t,n){"use strict";var o=n(3371),r=Symbol.for("react.element"),i=Symbol.for("react.fragment"),a=Object.prototype.hasOwnProperty,s=o.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,u={key:!0,ref:!0,__self:!0,__source:!0};function c(e,t,n){var o,i={},c=null,l=null;for(o in void 0!==n&&(c=""+n),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(l=t.ref),t)a.call(t,o)&&!u.hasOwnProperty(o)&&(i[o]=t[o]);if(e&&e.defaultProps)for(o in t=e.defaultProps)void 0===i[o]&&(i[o]=t[o]);return{$$typeof:r,type:e,key:c,ref:l,props:i,_owner:s.current}}t.Fragment=i,t.jsx=c,t.jsxs=c},2394:function(e,t){"use strict";var n=Symbol.for("react.element"),o=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),s=Symbol.for("react.provider"),u=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),l=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),f=Symbol.iterator;var h={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},g=Object.assign,v={};function m(e,t,n){this.props=e,this.context=t,this.refs=v,this.updater=n||h}function _(){}function y(e,t,n){this.props=e,this.context=t,this.refs=v,this.updater=n||h}m.prototype.isReactComponent={},m.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},m.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},_.prototype=m.prototype;var M=y.prototype=new _;M.constructor=y,g(M,m.prototype),M.isPureReactComponent=!0;var I=Array.isArray,C=Object.prototype.hasOwnProperty,k={current:null},T={key:!0,ref:!0,__self:!0,__source:!0};function S(e,t,o){var r,i={},a=null,s=null;if(null!=t)for(r in void 0!==t.ref&&(s=t.ref),void 0!==t.key&&(a=""+t.key),t)C.call(t,r)&&!T.hasOwnProperty(r)&&(i[r]=t[r]);var u=arguments.length-2;if(1===u)i.children=o;else if(1<u){for(var c=Array(u),l=0;l<u;l++)c[l]=arguments[l+2];i.children=c}if(e&&e.defaultProps)for(r in u=e.defaultProps)void 0===i[r]&&(i[r]=u[r]);return{$$typeof:n,type:e,key:a,ref:s,props:i,_owner:k.current}}function b(e){return"object"===typeof e&&null!==e&&e.$$typeof===n}var D=/\/+/g;function E(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,(function(e){return t[e]}))}(""+e.key):t.toString(36)}function A(e,t,r,i,a){var s=typeof e;"undefined"!==s&&"boolean"!==s||(e=null);var u=!1;if(null===e)u=!0;else switch(s){case"string":case"number":u=!0;break;case"object":switch(e.$$typeof){case n:case o:u=!0}}if(u)return a=a(u=e),e=""===i?"."+E(u,0):i,I(a)?(r="",null!=e&&(r=e.replace(D,"$&/")+"/"),A(a,t,r,"",(function(e){return e}))):null!=a&&(b(a)&&(a=function(e,t){return{$$typeof:n,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(a,r+(!a.key||u&&u.key===a.key?"":(""+a.key).replace(D,"$&/")+"/")+e)),t.push(a)),1;if(u=0,i=""===i?".":i+":",I(e))for(var c=0;c<e.length;c++){var l=i+E(s=e[c],c);u+=A(s,t,r,l,a)}else if(l=function(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=f&&e[f]||e["@@iterator"])?e:null}(e),"function"===typeof l)for(e=l.call(e),c=0;!(s=e.next()).done;)u+=A(s=s.value,t,r,l=i+E(s,c++),a);else if("object"===s)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return u}function L(e,t,n){if(null==e)return e;var o=[],r=0;return A(e,o,"","",(function(e){return t.call(n,e,r++)})),o}function R(e){if(-1===e._status){var t=e._result;(t=t()).then((function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)}),(function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)})),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var w={current:null},O={transition:null},N={ReactCurrentDispatcher:w,ReactCurrentBatchConfig:O,ReactCurrentOwner:k};t.Children={map:L,forEach:function(e,t,n){L(e,(function(){t.apply(this,arguments)}),n)},count:function(e){var t=0;return L(e,(function(){t++})),t},toArray:function(e){return L(e,(function(e){return e}))||[]},only:function(e){if(!b(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=m,t.Fragment=r,t.Profiler=a,t.PureComponent=y,t.StrictMode=i,t.Suspense=l,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=N,t.cloneElement=function(e,t,o){if(null===e||void 0===e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var r=g({},e.props),i=e.key,a=e.ref,s=e._owner;if(null!=t){if(void 0!==t.ref&&(a=t.ref,s=k.current),void 0!==t.key&&(i=""+t.key),e.type&&e.type.defaultProps)var u=e.type.defaultProps;for(c in t)C.call(t,c)&&!T.hasOwnProperty(c)&&(r[c]=void 0===t[c]&&void 0!==u?u[c]:t[c])}var c=arguments.length-2;if(1===c)r.children=o;else if(1<c){u=Array(c);for(var l=0;l<c;l++)u[l]=arguments[l+2];r.children=u}return{$$typeof:n,type:e.type,key:i,ref:a,props:r,_owner:s}},t.createContext=function(e){return(e={$$typeof:u,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:s,_context:e},e.Consumer=e},t.createElement=S,t.createFactory=function(e){var t=S.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=b,t.lazy=function(e){return{$$typeof:p,_payload:{_status:-1,_result:e},_init:R}},t.memo=function(e,t){return{$$typeof:d,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=O.transition;O.transition={};try{e()}finally{O.transition=t}},t.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")},t.useCallback=function(e,t){return w.current.useCallback(e,t)},t.useContext=function(e){return w.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return w.current.useDeferredValue(e)},t.useEffect=function(e,t){return w.current.useEffect(e,t)},t.useId=function(){return w.current.useId()},t.useImperativeHandle=function(e,t,n){return w.current.useImperativeHandle(e,t,n)},t.useInsertionEffect=function(e,t){return w.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return w.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return w.current.useMemo(e,t)},t.useReducer=function(e,t,n){return w.current.useReducer(e,t,n)},t.useRef=function(e){return w.current.useRef(e)},t.useState=function(e){return w.current.useState(e)},t.useSyncExternalStore=function(e,t,n){return w.current.useSyncExternalStore(e,t,n)},t.useTransition=function(){return w.current.useTransition()},t.version="18.2.0"},3371:function(e,t,n){"use strict";e.exports=n(2394)},3241:function(e,t,n){"use strict";e.exports=n(768)},9287:function(e,t){"use strict";function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var o=n-1>>>1,r=e[o];if(!(0<i(r,t)))break e;e[o]=t,e[n]=r,n=o}}function o(e){return 0===e.length?null:e[0]}function r(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var o=0,r=e.length,a=r>>>1;o<a;){var s=2*(o+1)-1,u=e[s],c=s+1,l=e[c];if(0>i(u,n))c<r&&0>i(l,u)?(e[o]=l,e[c]=n,o=c):(e[o]=u,e[s]=n,o=s);else{if(!(c<r&&0>i(l,n)))break e;e[o]=l,e[c]=n,o=c}}}return t}function i(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if("object"===typeof performance&&"function"===typeof performance.now){var a=performance;t.unstable_now=function(){return a.now()}}else{var s=Date,u=s.now();t.unstable_now=function(){return s.now()-u}}var c=[],l=[],d=1,p=null,f=3,h=!1,g=!1,v=!1,m="function"===typeof setTimeout?setTimeout:null,_="function"===typeof clearTimeout?clearTimeout:null,y="undefined"!==typeof setImmediate?setImmediate:null;function M(e){for(var t=o(l);null!==t;){if(null===t.callback)r(l);else{if(!(t.startTime<=e))break;r(l),t.sortIndex=t.expirationTime,n(c,t)}t=o(l)}}function I(e){if(v=!1,M(e),!g)if(null!==o(c))g=!0,O(C);else{var t=o(l);null!==t&&N(I,t.startTime-e)}}function C(e,n){g=!1,v&&(v=!1,_(b),b=-1),h=!0;var i=f;try{for(M(n),p=o(c);null!==p&&(!(p.expirationTime>n)||e&&!A());){var a=p.callback;if("function"===typeof a){p.callback=null,f=p.priorityLevel;var s=a(p.expirationTime<=n);n=t.unstable_now(),"function"===typeof s?p.callback=s:p===o(c)&&r(c),M(n)}else r(c);p=o(c)}if(null!==p)var u=!0;else{var d=o(l);null!==d&&N(I,d.startTime-n),u=!1}return u}finally{p=null,f=i,h=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var k,T=!1,S=null,b=-1,D=5,E=-1;function A(){return!(t.unstable_now()-E<D)}function L(){if(null!==S){var e=t.unstable_now();E=e;var n=!0;try{n=S(!0,e)}finally{n?k():(T=!1,S=null)}}else T=!1}if("function"===typeof y)k=function(){y(L)};else if("undefined"!==typeof MessageChannel){var R=new MessageChannel,w=R.port2;R.port1.onmessage=L,k=function(){w.postMessage(null)}}else k=function(){m(L,0)};function O(e){S=e,T||(T=!0,k())}function N(e,n){b=m((function(){e(t.unstable_now())}),n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){g||h||(g=!0,O(C))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):D=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_getFirstCallbackNode=function(){return o(c)},t.unstable_next=function(e){switch(f){case 1:case 2:case 3:var t=3;break;default:t=f}var n=f;f=t;try{return e()}finally{f=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=f;f=e;try{return t()}finally{f=n}},t.unstable_scheduleCallback=function(e,r,i){var a=t.unstable_now();switch("object"===typeof i&&null!==i?i="number"===typeof(i=i.delay)&&0<i?a+i:a:i=a,e){case 1:var s=-1;break;case 2:s=250;break;case 5:s=1073741823;break;case 4:s=1e4;break;default:s=5e3}return e={id:d++,callback:r,priorityLevel:e,startTime:i,expirationTime:s=i+s,sortIndex:-1},i>a?(e.sortIndex=i,n(l,e),null===o(c)&&e===o(l)&&(v?(_(b),b=-1):v=!0,N(I,i-a))):(e.sortIndex=s,n(c,e),g||h||(g=!0,O(C))),e},t.unstable_shouldYield=A,t.unstable_wrapCallback=function(e){var t=f;return function(){var n=f;f=t;try{return e.apply(this,arguments)}finally{f=n}}}},2720:function(e,t,n){"use strict";e.exports=n(9287)},5296:function(e,t,n){"use strict";e.exports=function(){function e(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function t(t){for(var n=1;n<arguments.length;n++){var o=null!=arguments[n]?arguments[n]:{};n%2?e(Object(o),!0).forEach((function(e){s(t,e,o[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):e(Object(o)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(o,e))}))}return t}function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function a(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&l(e,t)}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function l(e,t){return(l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function d(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function p(e,t,n){return(p=d()?Reflect.construct:function(e,t,n){var o=[null];o.push.apply(o,t);var r=new(Function.bind.apply(e,o));return n&&l(r,n.prototype),r}).apply(null,arguments)}function f(e){var t="function"==typeof Map?new Map:void 0;return(f=function(e){if(null===e||(n=e,-1===Function.toString.call(n).indexOf("[native code]")))return e;var n;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,o)}function o(){return p(e,arguments,c(this).constructor)}return o.prototype=Object.create(e.prototype,{constructor:{value:o,enumerable:!1,writable:!0,configurable:!0}}),l(o,e)})(e)}function h(e,t){if(null==e)return{};var n,o,r=function(e,t){if(null==e)return{};var n,o,r={},i=Object.keys(e);for(o=0;o<i.length;o++)n=i[o],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function g(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function v(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return g(e)}function m(e){var t=d();return function(){var n,o=c(e);if(t){var r=c(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return v(this,n)}}function _(e,t){return M(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var o,r,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(o=n.next()).done)&&(i.push(o.value),!t||i.length!==t);a=!0);}catch(c){s=!0,r=c}finally{try{a||null==n.return||n.return()}finally{if(s)throw r}}return i}}(e,t)||C(e,t)||T()}function y(e){return function(e){if(Array.isArray(e))return k(e)}(e)||I(e)||C(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function M(e){if(Array.isArray(e))return e}function I(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function C(e,t){if(e){if("string"==typeof e)return k(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?k(e,t):void 0}}function k(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}function T(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function S(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=C(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var o=0,r=function(){};return{s:r,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}var b="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof n.g?n.g:"undefined"!=typeof self?self:{};function D(e,t){return e(t={exports:{}},t.exports),t.exports}var E,A,L=function(e){return e&&e.Math==Math&&e},R=L("object"==typeof globalThis&&globalThis)||L("object"==typeof window&&window)||L("object"==typeof self&&self)||L("object"==typeof b&&b)||function(){return this}()||Function("return this")(),w=function(e){try{return!!e()}catch(t){return!0}},O=!w((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]})),N=!w((function(){var e=function(){}.bind();return"function"!=typeof e||e.hasOwnProperty("prototype")})),P=Function.prototype.call,G=N?P.bind(P):function(){return P.apply(P,arguments)},U={}.propertyIsEnumerable,x=Object.getOwnPropertyDescriptor,F={f:x&&!U.call({1:2},1)?function(e){var t=x(this,e);return!!t&&t.enumerable}:U},q=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}},B=Function.prototype,V=B.bind,H=B.call,K=N&&V.bind(H,H),j=N?function(e){return e&&K(e)}:function(e){return e&&function(){return H.apply(e,arguments)}},z=j({}.toString),Z=j("".slice),W=function(e){return Z(z(e),8,-1)},Y=R.Object,J=j("".split),X=w((function(){return!Y("z").propertyIsEnumerable(0)}))?function(e){return"String"==W(e)?J(e,""):Y(e)}:Y,$=R.TypeError,Q=function(e){if(null==e)throw $("Can't call method on "+e);return e},ee=function(e){return X(Q(e))},te=function(e){return"function"==typeof e},ne=function(e){return"object"==typeof e?null!==e:te(e)},oe=function(e){return te(e)?e:void 0},re=function(e,t){return arguments.length<2?oe(R[e]):R[e]&&R[e][t]},ie=j({}.isPrototypeOf),ae=re("navigator","userAgent")||"",se=R.process,ue=R.Deno,ce=se&&se.versions||ue&&ue.version,le=ce&&ce.v8;le&&(A=(E=le.split("."))[0]>0&&E[0]<4?1:+(E[0]+E[1])),!A&&ae&&(!(E=ae.match(/Edge\/(\d+)/))||E[1]>=74)&&(E=ae.match(/Chrome\/(\d+)/))&&(A=+E[1]);var de=A,pe=!!Object.getOwnPropertySymbols&&!w((function(){var e=Symbol();return!String(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&de&&de<41})),fe=pe&&!Symbol.sham&&"symbol"==typeof Symbol.iterator,he=R.Object,ge=fe?function(e){return"symbol"==typeof e}:function(e){var t=re("Symbol");return te(t)&&ie(t.prototype,he(e))},ve=R.String,me=function(e){try{return ve(e)}catch(t){return"Object"}},_e=R.TypeError,ye=function(e){if(te(e))return e;throw _e(me(e)+" is not a function")},Me=function(e,t){var n=e[t];return null==n?void 0:ye(n)},Ie=R.TypeError,Ce=Object.defineProperty,ke=function(e,t){try{Ce(R,e,{value:t,configurable:!0,writable:!0})}catch(o){R[e]=t}return t},Te=R["__core-js_shared__"]||ke("__core-js_shared__",{}),Se=D((function(e){(e.exports=function(e,t){return Te[e]||(Te[e]=void 0!==t?t:{})})("versions",[]).push({version:"3.21.0",mode:"global",copyright:"\xa9 2014-2022 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.21.0/LICENSE",source:"https://github.com/zloirock/core-js"})})),be=R.Object,De=function(e){return be(Q(e))},Ee=j({}.hasOwnProperty),Ae=Object.hasOwn||function(e,t){return Ee(De(e),t)},Le=0,Re=Math.random(),we=j(1..toString),Oe=function(e){return"Symbol("+(void 0===e?"":e)+")_"+we(++Le+Re,36)},Ne=Se("wks"),Pe=R.Symbol,Ge=Pe&&Pe.for,Ue=fe?Pe:Pe&&Pe.withoutSetter||Oe,xe=function(e){if(!Ae(Ne,e)||!pe&&"string"!=typeof Ne[e]){var t="Symbol."+e;pe&&Ae(Pe,e)?Ne[e]=Pe[e]:Ne[e]=fe&&Ge?Ge(t):Ue(t)}return Ne[e]},Fe=R.TypeError,qe=xe("toPrimitive"),Be=function(e,t){if(!ne(e)||ge(e))return e;var n,o=Me(e,qe);if(o){if(void 0===t&&(t="default"),n=G(o,e,t),!ne(n)||ge(n))return n;throw Fe("Can't convert object to primitive value")}return void 0===t&&(t="number"),function(e,t){var n,o;if("string"===t&&te(n=e.toString)&&!ne(o=G(n,e)))return o;if(te(n=e.valueOf)&&!ne(o=G(n,e)))return o;if("string"!==t&&te(n=e.toString)&&!ne(o=G(n,e)))return o;throw Ie("Can't convert object to primitive value")}(e,t)},Ve=function(e){var t=Be(e,"string");return ge(t)?t:t+""},He=R.document,Ke=ne(He)&&ne(He.createElement),je=function(e){return Ke?He.createElement(e):{}},ze=!O&&!w((function(){return 7!=Object.defineProperty(je("div"),"a",{get:function(){return 7}}).a})),Ze=Object.getOwnPropertyDescriptor,We={f:O?Ze:function(e,t){if(e=ee(e),t=Ve(t),ze)try{return Ze(e,t)}catch(o){}if(Ae(e,t))return q(!G(F.f,e,t),e[t])}},Ye=O&&w((function(){return 42!=Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype})),Je=R.String,Xe=R.TypeError,$e=function(e){if(ne(e))return e;throw Xe(Je(e)+" is not an object")},Qe=R.TypeError,et=Object.defineProperty,nt=Object.getOwnPropertyDescriptor,ot={f:O?Ye?function(e,t,n){if($e(e),t=Ve(t),$e(n),"function"==typeof e&&"prototype"===t&&"value"in n&&"writable"in n&&!n.writable){var o=nt(e,t);o&&o.writable&&(e[t]=n.value,n={configurable:"configurable"in n?n.configurable:o.configurable,enumerable:"enumerable"in n?n.enumerable:o.enumerable,writable:!1})}return et(e,t,n)}:et:function(e,t,n){if($e(e),t=Ve(t),$e(n),ze)try{return et(e,t,n)}catch(r){}if("get"in n||"set"in n)throw Qe("Accessors not supported");return"value"in n&&(e[t]=n.value),e}},rt=O?function(e,t,n){return ot.f(e,t,q(1,n))}:function(e,t,n){return e[t]=n,e},it=j(Function.toString);te(Te.inspectSource)||(Te.inspectSource=function(e){return it(e)});var at,st,ut,ct=Te.inspectSource,lt=R.WeakMap,dt=te(lt)&&/native code/.test(ct(lt)),pt=Se("keys"),ft=function(e){return pt[e]||(pt[e]=Oe(e))},ht={},gt=R.TypeError,vt=R.WeakMap;if(dt||Te.state){var mt=Te.state||(Te.state=new vt),_t=j(mt.get),yt=j(mt.has),Mt=j(mt.set);at=function(e,t){if(yt(mt,e))throw new gt("Object already initialized");return t.facade=e,Mt(mt,e,t),t},st=function(e){return _t(mt,e)||{}},ut=function(e){return yt(mt,e)}}else{var It=ft("state");ht[It]=!0,at=function(e,t){if(Ae(e,It))throw new gt("Object already initialized");return t.facade=e,rt(e,It,t),t},st=function(e){return Ae(e,It)?e[It]:{}},ut=function(e){return Ae(e,It)}}var Ct={set:at,get:st,has:ut,enforce:function(e){return ut(e)?st(e):at(e,{})},getterFor:function(e){return function(t){var n;if(!ne(t)||(n=st(t)).type!==e)throw gt("Incompatible receiver, "+e+" required");return n}}},kt=Function.prototype,Tt=O&&Object.getOwnPropertyDescriptor,St=Ae(kt,"name"),bt={EXISTS:St,PROPER:St&&"something"===function(){}.name,CONFIGURABLE:St&&(!O||O&&Tt(kt,"name").configurable)},Dt=D((function(e){var t=bt.CONFIGURABLE,n=Ct.get,o=Ct.enforce,r=String(String).split("String");(e.exports=function(e,n,i,a){var s,u=!!a&&!!a.unsafe,c=!!a&&!!a.enumerable,l=!!a&&!!a.noTargetGet,d=a&&void 0!==a.name?a.name:n;te(i)&&("Symbol("===String(d).slice(0,7)&&(d="["+String(d).replace(/^Symbol\(([^)]*)\)/,"$1")+"]"),(!Ae(i,"name")||t&&i.name!==d)&&rt(i,"name",d),(s=o(i)).source||(s.source=r.join("string"==typeof d?d:""))),e!==R?(u?!l&&e[n]&&(c=!0):delete e[n],c?e[n]=i:rt(e,n,i)):c?e[n]=i:ke(n,i)})(Function.prototype,"toString",(function(){return te(this)&&n(this).source||ct(this)}))})),Et=Math.ceil,At=Math.floor,Lt=function(e){var t=+e;return t!=t||0===t?0:(t>0?At:Et)(t)},Rt=Math.max,wt=Math.min,Ot=function(e,t){var n=Lt(e);return n<0?Rt(n+t,0):wt(n,t)},Nt=Math.min,Pt=function(e){return e>0?Nt(Lt(e),9007199254740991):0},Gt=function(e){return Pt(e.length)},Ut=function(e){return function(t,n,o){var r,i=ee(t),a=Gt(i),s=Ot(o,a);if(e&&n!=n){for(;a>s;)if((r=i[s++])!=r)return!0}else for(;a>s;s++)if((e||s in i)&&i[s]===n)return e||s||0;return!e&&-1}},xt={includes:Ut(!0),indexOf:Ut(!1)},Ft=xt.indexOf,qt=j([].push),Bt=function(e,t){var n,o=ee(e),r=0,i=[];for(n in o)!Ae(ht,n)&&Ae(o,n)&&qt(i,n);for(;t.length>r;)Ae(o,n=t[r++])&&(~Ft(i,n)||qt(i,n));return i},Vt=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],Ht=Vt.concat("length","prototype"),Kt={f:Object.getOwnPropertyNames||function(e){return Bt(e,Ht)}},jt={f:Object.getOwnPropertySymbols},zt=j([].concat),Zt=re("Reflect","ownKeys")||function(e){var t=Kt.f($e(e)),n=jt.f;return n?zt(t,n(e)):t},Wt=function(e,t,n){for(var o=Zt(t),r=ot.f,i=We.f,a=0;a<o.length;a++){var s=o[a];Ae(e,s)||n&&Ae(n,s)||r(e,s,i(t,s))}},Yt=/#|\.prototype\./,Jt=function(e,t){var n=$t[Xt(e)];return n==en||n!=Qt&&(te(t)?w(t):!!t)},Xt=Jt.normalize=function(e){return String(e).replace(Yt,".").toLowerCase()},$t=Jt.data={},Qt=Jt.NATIVE="N",en=Jt.POLYFILL="P",tn=Jt,nn=We.f,on=function(e,t){var n,o,r,i,a,s=e.target,u=e.global,c=e.stat;if(n=u?R:c?R[s]||ke(s,{}):(R[s]||{}).prototype)for(o in t){if(i=t[o],r=e.noTargetGet?(a=nn(n,o))&&a.value:n[o],!tn(u?o:s+(c?".":"#")+o,e.forced)&&void 0!==r){if(typeof i==typeof r)continue;Wt(i,r)}(e.sham||r&&r.sham)&&rt(i,"sham",!0),Dt(n,o,i,e)}},rn={};rn[xe("toStringTag")]="z";var an="[object z]"===String(rn),sn=xe("toStringTag"),un=R.Object,cn="Arguments"==W(function(){return arguments}()),ln=an?W:function(e){var t,n,o;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(n=function(e,t){try{return e[t]}catch(n){}}(t=un(e),sn))?n:cn?W(t):"Object"==(o=W(t))&&te(t.callee)?"Arguments":o},dn=R.String,pn=function(e){if("Symbol"===ln(e))throw TypeError("Cannot convert a Symbol value to a string");return dn(e)},fn="\t\n\v\f\r \xa0\u1680\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029\ufeff",hn=j("".replace),gn="["+fn+"]",vn=RegExp("^"+gn+gn+"*"),mn=RegExp(gn+gn+"*$"),_n=function(e){return function(t){var n=pn(Q(t));return 1&e&&(n=hn(n,vn,"")),2&e&&(n=hn(n,mn,"")),n}},yn={start:_n(1),end:_n(2),trim:_n(3)},Mn=yn.trim,In=R.parseInt,Cn=R.Symbol,kn=Cn&&Cn.iterator,Tn=/^[+-]?0x/i,Sn=j(Tn.exec),bn=8!==In(fn+"08")||22!==In(fn+"0x16")||kn&&!w((function(){In(Object(kn))}))?function(e,t){var n=Mn(pn(e));return In(n,t>>>0||(Sn(Tn,n)?16:10))}:In;on({global:!0,forced:parseInt!=bn},{parseInt:bn});var Dn=j([].slice),En=R.Function,An=j([].concat),Ln=j([].join),Rn={},wn=function(e,t,n){if(!Ae(Rn,t)){for(var o=[],r=0;r<t;r++)o[r]="a["+r+"]";Rn[t]=En("C,a","return new C("+Ln(o,",")+")")}return Rn[t](e,n)},On=N?En.bind:function(e){var t=ye(this),n=t.prototype,o=Dn(arguments,1),r=function n(){var r=An(o,Dn(arguments));return this instanceof n?wn(t,r.length,r):t.apply(e,r)};return ne(n)&&(r.prototype=n),r};on({target:"Function",proto:!0,forced:Function.bind!==On},{bind:On});var Nn,Pn=Object.keys||function(e){return Bt(e,Vt)},Gn={f:O&&!Ye?Object.defineProperties:function(e,t){$e(e);for(var n,o=ee(t),r=Pn(t),i=r.length,a=0;i>a;)ot.f(e,n=r[a++],o[n]);return e}},Un=re("document","documentElement"),xn=ft("IE_PROTO"),Fn=function(){},qn=function(e){return"<script>"+e+"<\/script>"},Bn=function(e){e.write(qn("")),e.close();var t=e.parentWindow.Object;return e=null,t},Vn=function(){try{Nn=new ActiveXObject("htmlfile")}catch(r){}var e,t;Vn="undefined"!=typeof document?document.domain&&Nn?Bn(Nn):((t=je("iframe")).style.display="none",Un.appendChild(t),t.src=String("javascript:"),(e=t.contentWindow.document).open(),e.write(qn("document.F=Object")),e.close(),e.F):Bn(Nn);for(var n=Vt.length;n--;)delete Vn.prototype[Vt[n]];return Vn()};ht[xn]=!0;var Hn=Object.create||function(e,t){var n;return null!==e?(Fn.prototype=$e(e),n=new Fn,Fn.prototype=null,n[xn]=e):n=Vn(),void 0===t?n:Gn.f(n,t)};on({target:"Object",stat:!0,sham:!O},{create:Hn});var Kn=j(j.bind),jn=function(e,t){return ye(e),void 0===t?e:N?Kn(e,t):function(){return e.apply(t,arguments)}},zn=Array.isArray||function(e){return"Array"==W(e)},Zn=function(){},Wn=[],Yn=re("Reflect","construct"),Jn=/^\s*(?:class|function)\b/,Xn=j(Jn.exec),$n=!Jn.exec(Zn),Qn=function(e){if(!te(e))return!1;try{return Yn(Zn,Wn,e),!0}catch(t){return!1}},eo=function(e){if(!te(e))return!1;switch(ln(e)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return $n||!!Xn(Jn,ct(e))}catch(t){return!0}};eo.sham=!0;var to=!Yn||w((function(){var e;return Qn(Qn.call)||!Qn(Object)||!Qn((function(){e=!0}))||e}))?eo:Qn,no=xe("species"),oo=R.Array,ro=function(e,t){return new(function(e){var t;return zn(e)&&(t=e.constructor,(to(t)&&(t===oo||zn(t.prototype))||ne(t)&&null===(t=t[no]))&&(t=void 0)),void 0===t?oo:t}(e))(0===t?0:t)},io=j([].push),ao=function(e){var t=1==e,n=2==e,o=3==e,r=4==e,i=6==e,a=7==e,s=5==e||i;return function(u,c,l,d){for(var p,f,h=De(u),g=X(h),v=jn(c,l),m=Gt(g),_=0,y=d||ro,M=t?y(u,m):n||a?y(u,0):void 0;m>_;_++)if((s||_ in g)&&(f=v(p=g[_],_,h),e))if(t)M[_]=f;else if(f)switch(e){case 3:return!0;case 5:return p;case 6:return _;case 2:io(M,p)}else switch(e){case 4:return!1;case 7:io(M,p)}return i?-1:o||r?r:M}},so={forEach:ao(0),map:ao(1),filter:ao(2),some:ao(3),every:ao(4),find:ao(5),findIndex:ao(6),filterReject:ao(7)},uo=function(e,t){var n=[][e];return!!n&&w((function(){n.call(null,t||function(){throw 1},1)}))},co=so.forEach,lo=uo("forEach")?[].forEach:function(e){return co(this,e,arguments.length>1?arguments[1]:void 0)};on({target:"Array",proto:!0,forced:[].forEach!=lo},{forEach:lo});var po=an?{}.toString:function(){return"[object "+ln(this)+"]"};an||Dt(Object.prototype,"toString",po,{unsafe:!0});var fo={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},ho=je("span").classList,go=ho&&ho.constructor&&ho.constructor.prototype,vo=go===Object.prototype?void 0:go,mo=function(e){if(e&&e.forEach!==lo)try{rt(e,"forEach",lo)}catch(t){e.forEach=lo}};for(var _o in fo)fo[_o]&&mo(R[_o]&&R[_o].prototype);mo(vo);var yo=w((function(){Pn(1)}));on({target:"Object",stat:!0,forced:yo},{keys:function(e){return Pn(De(e))}});var Mo=function(e,t,n){var o,r;$e(e);try{if(!(o=Me(e,"return"))){if("throw"===t)throw n;return n}o=G(o,e)}catch(a){r=!0,o=a}if("throw"===t)throw n;if(r)throw o;return $e(o),n},Io=function(e,t,n,o){try{return o?t($e(n)[0],n[1]):t(n)}catch(i){Mo(e,"throw",i)}},Co={},ko=xe("iterator"),To=Array.prototype,So=function(e){return void 0!==e&&(Co.Array===e||To[ko]===e)},bo=function(e,t,n){var o=Ve(t);o in e?ot.f(e,o,q(0,n)):e[o]=n},Do=xe("iterator"),Eo=function(e){if(null!=e)return Me(e,Do)||Me(e,"@@iterator")||Co[ln(e)]},Ao=R.TypeError,Lo=function(e,t){var n=arguments.length<2?Eo(e):t;if(ye(n))return $e(G(n,e));throw Ao(me(e)+" is not iterable")},Ro=R.Array,wo=function(e){var t=De(e),n=to(this),o=arguments.length,r=o>1?arguments[1]:void 0,i=void 0!==r;i&&(r=jn(r,o>2?arguments[2]:void 0));var a,s,u,c,l,d,p=Eo(t),f=0;if(!p||this==Ro&&So(p))for(a=Gt(t),s=n?new this(a):Ro(a);a>f;f++)d=i?r(t[f],f):t[f],bo(s,f,d);else for(l=(c=Lo(t,p)).next,s=n?new this:[];!(u=G(l,c)).done;f++)d=i?Io(c,r,[u.value,f],!0):u.value,bo(s,f,d);return s.length=f,s},Oo=xe("iterator"),No=!1;try{var Po=0,Go={next:function(){return{done:!!Po++}},return:function(){No=!0}};Go[Oo]=function(){return this},Array.from(Go,(function(){throw 2}))}catch(XD){}var Uo=function(e,t){if(!t&&!No)return!1;var n=!1;try{var o={};o[Oo]=function(){return{next:function(){return{done:n=!0}}}},e(o)}catch(XD){}return n},xo=!Uo((function(e){Array.from(e)}));on({target:"Array",stat:!0,forced:xo},{from:wo});var Fo,qo,Bo,Vo=j("".charAt),Ho=j("".charCodeAt),Ko=j("".slice),jo=function(e){return function(t,n){var o,r,i=pn(Q(t)),a=Lt(n),s=i.length;return a<0||a>=s?e?"":void 0:(o=Ho(i,a))<55296||o>56319||a+1===s||(r=Ho(i,a+1))<56320||r>57343?e?Vo(i,a):o:e?Ko(i,a,a+2):r-56320+(o-55296<<10)+65536}},zo={codeAt:jo(!1),charAt:jo(!0)},Zo=!w((function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype})),Wo=ft("IE_PROTO"),Yo=R.Object,Jo=Yo.prototype,Xo=Zo?Yo.getPrototypeOf:function(e){var t=De(e);if(Ae(t,Wo))return t[Wo];var n=t.constructor;return te(n)&&t instanceof n?n.prototype:t instanceof Yo?Jo:null},$o=xe("iterator"),Qo=!1;[].keys&&("next"in(Bo=[].keys())?(qo=Xo(Xo(Bo)))!==Object.prototype&&(Fo=qo):Qo=!0),(null==Fo||w((function(){var e={};return Fo[$o].call(e)!==e})))&&(Fo={}),te(Fo[$o])||Dt(Fo,$o,(function(){return this}));var er={IteratorPrototype:Fo,BUGGY_SAFARI_ITERATORS:Qo},tr=ot.f,nr=xe("toStringTag"),or=function(e,t,n){e&&!n&&(e=e.prototype),e&&!Ae(e,nr)&&tr(e,nr,{configurable:!0,value:t})},rr=er.IteratorPrototype,ir=function(){return this},ar=function(e,t,n,o){var r=t+" Iterator";return e.prototype=Hn(rr,{next:q(+!o,n)}),or(e,r,!1),Co[r]=ir,e},sr=R.String,ur=R.TypeError,cr=Object.setPrototypeOf||("__proto__"in{}?function(){var e,t=!1,n={};try{(e=j(Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set))(n,[]),t=n instanceof Array}catch(XD){}return function(n,o){return $e(n),function(e){if("object"==typeof e||te(e))return e;throw ur("Can't set "+sr(e)+" as a prototype")}(o),t?e(n,o):n.__proto__=o,n}}():void 0),lr=bt.PROPER,dr=bt.CONFIGURABLE,pr=er.IteratorPrototype,fr=er.BUGGY_SAFARI_ITERATORS,hr=xe("iterator"),gr=function(){return this},vr=function(e,t,n,o,r,i,a){ar(n,t,o);var s,u,c,l=function(e){if(e===r&&g)return g;if(!fr&&e in f)return f[e];switch(e){case"keys":case"values":case"entries":return function(){return new n(this,e)}}return function(){return new n(this)}},d=t+" Iterator",p=!1,f=e.prototype,h=f[hr]||f["@@iterator"]||r&&f[r],g=!fr&&h||l(r),v="Array"==t&&f.entries||h;if(v&&(s=Xo(v.call(new e)))!==Object.prototype&&s.next&&(Xo(s)!==pr&&(cr?cr(s,pr):te(s[hr])||Dt(s,hr,gr)),or(s,d,!0)),lr&&"values"==r&&h&&"values"!==h.name&&(dr?rt(f,"name","values"):(p=!0,g=function(){return G(h,this)})),r)if(u={values:l("values"),keys:i?g:l("keys"),entries:l("entries")},a)for(c in u)(fr||p||!(c in f))&&Dt(f,c,u[c]);else on({target:t,proto:!0,forced:fr||p},u);return f[hr]!==g&&Dt(f,hr,g,{name:r}),Co[t]=g,u},mr=zo.charAt,_r=Ct.set,yr=Ct.getterFor("String Iterator");vr(String,"String",(function(e){_r(this,{type:"String Iterator",string:pn(e),index:0})}),(function(){var e,t=yr(this),n=t.string,o=t.index;return o>=n.length?{value:void 0,done:!0}:(e=mr(n,o),t.index+=e.length,{value:e,done:!1})}));var Mr={SDK_READY:"sdkStateReady",SDK_NOT_READY:"sdkStateNotReady",SDK_DESTROY:"sdkDestroy",MESSAGE_RECEIVED:"onMessageReceived",MESSAGE_MODIFIED:"onMessageModified",MESSAGE_REVOKED:"onMessageRevoked",MESSAGE_READ_BY_PEER:"onMessageReadByPeer",MESSAGE_READ_RECEIPT_RECEIVED:"onMessageReadReceiptReceived",MESSAGE_EXTENSIONS_UPDATED:"onMessageExtensionsUpdated",MESSAGE_EXTENSIONS_DELETED:"onMessageExtensionsDeleted",CONVERSATION_LIST_UPDATED:"onConversationListUpdated",TOTAL_UNREAD_MESSAGE_COUNT_UPDATED:"onTotalUnreadMessageCountUpdated",CONVERSATION_GROUP_LIST_UPDATED:"onConversationGroupListUpdated",CONVERSATION_IN_GROUP_UPDATED:"onConversationInGroupUpdated",GROUP_LIST_UPDATED:"onGroupListUpdated",GROUP_SYSTEM_NOTICE_RECEIVED:"receiveGroupSystemNotice",GROUP_ATTRIBUTES_UPDATED:"groupAttributesUpdated",GROUP_COUNTER_UPDATED:"onGroupCounterUpdated",TOPIC_CREATED:"onTopicCreated",TOPIC_DELETED:"onTopicDeleted",TOPIC_UPDATED:"onTopicUpdated",PROFILE_UPDATED:"onProfileUpdated",USER_STATUS_UPDATED:"onUserStatusUpdated",BLACKLIST_UPDATED:"blacklistUpdated",FRIEND_LIST_UPDATED:"onFriendListUpdated",FRIEND_GROUP_LIST_UPDATED:"onFriendGroupListUpdated",FRIEND_APPLICATION_LIST_UPDATED:"onFriendApplicationListUpdated",KICKED_OUT:"kickedOut",ERROR:"error",NET_STATE_CHANGE:"netStateChange",SDK_RELOAD:"sdkReload"},Ir={MSG_TEXT:"TIMTextElem",MSG_IMAGE:"TIMImageElem",MSG_SOUND:"TIMSoundElem",MSG_AUDIO:"TIMSoundElem",MSG_FILE:"TIMFileElem",MSG_FACE:"TIMFaceElem",MSG_VIDEO:"TIMVideoFileElem",MSG_GEO:"TIMLocationElem",MSG_LOCATION:"TIMLocationElem",MSG_GRP_TIP:"TIMGroupTipElem",MSG_GRP_SYS_NOTICE:"TIMGroupSystemNoticeElem",MSG_CUSTOM:"TIMCustomElem",MSG_MERGER:"TIMRelayElem",MSG_PRIORITY_HIGH:"High",MSG_PRIORITY_NORMAL:"Normal",MSG_PRIORITY_LOW:"Low",MSG_PRIORITY_LOWEST:"Lowest",CONV_C2C:"C2C",CONV_GROUP:"GROUP",CONV_TOPIC:"TOPIC",CONV_SYSTEM:"@TIM#SYSTEM",CONV_AT_ME:1,CONV_AT_ALL:2,CONV_AT_ALL_AT_ME:3,CONV_MARK_TYPE_STAR:1,CONV_MARK_TYPE_UNREAD:2,CONV_MARK_TYPE_FOLD:4,CONV_MARK_TYPE_HIDE:8,GRP_PRIVATE:"Private",GRP_WORK:"Private",GRP_PUBLIC:"Public",GRP_CHATROOM:"ChatRoom",GRP_MEETING:"ChatRoom",GRP_AVCHATROOM:"AVChatRoom",GRP_COMMUNITY:"Community",GRP_MBR_ROLE_OWNER:"Owner",GRP_MBR_ROLE_ADMIN:"Admin",GRP_MBR_ROLE_MEMBER:"Member",GRP_MBR_ROLE_CUSTOM:"Custom",GRP_TIP_MBR_JOIN:1,GRP_TIP_MBR_QUIT:2,GRP_TIP_MBR_KICKED_OUT:3,GRP_TIP_MBR_SET_ADMIN:4,GRP_TIP_MBR_CANCELED_ADMIN:5,GRP_TIP_GRP_PROFILE_UPDATED:6,GRP_TIP_MBR_PROFILE_UPDATED:7,GRP_TIP_BAN_AVCHATROOM_MEMBER:10,GRP_TIP_UNBAN_AVCHATROOM_MEMBER:11,MSG_REMIND_ACPT_AND_NOTE:"AcceptAndNotify",MSG_REMIND_ACPT_NOT_NOTE:"AcceptNotNotify",MSG_REMIND_DISCARD:"Discard",GENDER_UNKNOWN:"Gender_Type_Unknown",GENDER_FEMALE:"Gender_Type_Female",GENDER_MALE:"Gender_Type_Male",KICKED_OUT_MULT_ACCOUNT:"multipleAccount",KICKED_OUT_MULT_DEVICE:"multipleDevice",KICKED_OUT_USERSIG_EXPIRED:"userSigExpired",KICKED_OUT_REST_API:"REST_API_Kick",ALLOW_TYPE_ALLOW_ANY:"AllowType_Type_AllowAny",ALLOW_TYPE_NEED_CONFIRM:"AllowType_Type_NeedConfirm",ALLOW_TYPE_DENY_ANY:"AllowType_Type_DenyAny",FORBID_TYPE_NONE:"AdminForbid_Type_None",FORBID_TYPE_SEND_OUT:"AdminForbid_Type_SendOut",JOIN_OPTIONS_FREE_ACCESS:"FreeAccess",JOIN_OPTIONS_NEED_PERMISSION:"NeedPermission",JOIN_OPTIONS_DISABLE_APPLY:"DisableApply",JOIN_STATUS_SUCCESS:"JoinedSuccess",JOIN_STATUS_ALREADY_IN_GROUP:"AlreadyInGroup",JOIN_STATUS_WAIT_APPROVAL:"WaitAdminApproval",GRP_PROFILE_OWNER_ID:"ownerID",GRP_PROFILE_CREATE_TIME:"createTime",GRP_PROFILE_LAST_INFO_TIME:"lastInfoTime",GRP_PROFILE_MEMBER_NUM:"memberNum",GRP_PROFILE_MAX_MEMBER_NUM:"maxMemberNum",GRP_PROFILE_JOIN_OPTION:"joinOption",GRP_PROFILE_INTRODUCTION:"introduction",GRP_PROFILE_NOTIFICATION:"notification",GRP_PROFILE_MUTE_ALL_MBRS:"muteAllMembers",SNS_ADD_TYPE_SINGLE:"Add_Type_Single",SNS_ADD_TYPE_BOTH:"Add_Type_Both",SNS_DELETE_TYPE_SINGLE:"Delete_Type_Single",SNS_DELETE_TYPE_BOTH:"Delete_Type_Both",SNS_APPLICATION_TYPE_BOTH:"Pendency_Type_Both",SNS_APPLICATION_SENT_TO_ME:"Pendency_Type_ComeIn",SNS_APPLICATION_SENT_BY_ME:"Pendency_Type_SendOut",SNS_APPLICATION_AGREE:"Response_Action_Agree",SNS_APPLICATION_AGREE_AND_ADD:"Response_Action_AgreeAndAdd",SNS_CHECK_TYPE_BOTH:"CheckResult_Type_Both",SNS_CHECK_TYPE_SINGLE:"CheckResult_Type_Single",SNS_TYPE_NO_RELATION:"CheckResult_Type_NoRelation",SNS_TYPE_A_WITH_B:"CheckResult_Type_AWithB",SNS_TYPE_B_WITH_A:"CheckResult_Type_BWithA",SNS_TYPE_BOTH_WAY:"CheckResult_Type_BothWay",NET_STATE_CONNECTED:"connected",NET_STATE_CONNECTING:"connecting",NET_STATE_DISCONNECTED:"disconnected",MSG_AT_ALL:"__kImSDK_MesssageAtALL__",READ_ALL_C2C_MSG:"readAllC2CMessage",READ_ALL_GROUP_MSG:"readAllGroupMessage",READ_ALL_MSG:"readAllMessage",USER_STATUS_UNKNOWN:0,USER_STATUS_ONLINE:1,USER_STATUS_OFFLINE:2,USER_STATUS_UNLOGINED:3},Cr=xe("species"),kr=function(e){return de>=51||!w((function(){var t=[];return(t.constructor={})[Cr]=function(){return{foo:1}},1!==t[e](Boolean).foo}))},Tr=so.map,Sr=kr("map");on({target:"Array",proto:!0,forced:!Sr},{map:function(e){return Tr(this,e,arguments.length>1?arguments[1]:void 0)}});var br=function(){function e(){r(this,e),this.cache=[],this.options=null}return a(e,[{key:"use",value:function(e){if("function"!=typeof e)throw"middleware must be a function";return this.cache.push(e),this}},{key:"next",value:function(e){if(this.middlewares&&this.middlewares.length>0)return this.middlewares.shift().call(this,this.options,this.next.bind(this))}},{key:"run",value:function(e){return this.middlewares=this.cache.map((function(e){return e})),this.options=e,this.next()}}]),e}(),Dr=bt.EXISTS,Er=ot.f,Ar=Function.prototype,Lr=j(Ar.toString),Rr=/function\b(?:\s|\/\*[\S\s]*?\*\/|\/\/[^\n\r]*[\n\r]+)*([^\s(/]*)/,wr=j(Rr.exec);O&&!Dr&&Er(Ar,"name",{configurable:!0,get:function(){try{return wr(Rr,Lr(this))[1]}catch(XD){return""}}});var Or=xe("isConcatSpreadable"),Nr=R.TypeError,Pr=de>=51||!w((function(){var e=[];return e[Or]=!1,e.concat()[0]!==e})),Gr=kr("concat"),Ur=function(e){if(!ne(e))return!1;var t=e[Or];return void 0!==t?!!t:zn(e)};on({target:"Array",proto:!0,forced:!Pr||!Gr},{concat:function(e){var t,n,o,r,i,a=De(this),s=ro(a,0),u=0;for(t=-1,o=arguments.length;t<o;t++)if(Ur(i=-1===t?a:arguments[t])){if(u+(r=Gt(i))>9007199254740991)throw Nr("Maximum allowed index exceeded");for(n=0;n<r;n++,u++)n in i&&bo(s,u,i[n])}else{if(u>=9007199254740991)throw Nr("Maximum allowed index exceeded");bo(s,u++,i)}return s.length=u,s}});var xr=function(e,t,n){var o,r;return cr&&te(o=t.constructor)&&o!==n&&ne(r=o.prototype)&&r!==n.prototype&&cr(e,r),e},Fr=j(1..valueOf),qr=Kt.f,Br=We.f,Vr=ot.f,Hr=yn.trim,Kr=R.Number,jr=Kr.prototype,zr=R.TypeError,Zr=j("".slice),Wr=j("".charCodeAt),Yr=function(e){var t=Be(e,"number");return"bigint"==typeof t?t:Jr(t)},Jr=function(e){var t,n,o,r,i,a,s,u,c=Be(e,"number");if(ge(c))throw zr("Cannot convert a Symbol value to a number");if("string"==typeof c&&c.length>2)if(c=Hr(c),43===(t=Wr(c,0))||45===t){if(88===(n=Wr(c,2))||120===n)return NaN}else if(48===t){switch(Wr(c,1)){case 66:case 98:o=2,r=49;break;case 79:case 111:o=8,r=55;break;default:return+c}for(a=(i=Zr(c,2)).length,s=0;s<a;s++)if((u=Wr(i,s))<48||u>r)return NaN;return parseInt(i,o)}return+c};if(tn("Number",!Kr(" 0o1")||!Kr("0b1")||Kr("+0x1"))){for(var Xr,$r=function e(t){var n=arguments.length<1?0:Kr(Yr(t)),o=this;return ie(jr,o)&&w((function(){Fr(o)}))?xr(Object(n),o,e):n},Qr=O?qr(Kr):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,isFinite,isInteger,isNaN,isSafeInteger,parseFloat,parseInt,fromString,range".split(","),ei=0;Qr.length>ei;ei++)Ae(Kr,Xr=Qr[ei])&&!Ae($r,Xr)&&Vr($r,Xr,Br(Kr,Xr));$r.prototype=jr,jr.constructor=$r,Dt(R,"Number",$r)}var ti=w((function(){Xo(1)}));on({target:"Object",stat:!0,forced:ti,sham:!Zo},{getPrototypeOf:function(e){return Xo(De(e))}}),on({target:"Array",stat:!0},{isArray:zn});var ni,oi,ri=function(){var e=$e(this),t="";return e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.dotAll&&(t+="s"),e.unicode&&(t+="u"),e.sticky&&(t+="y"),t},ii=R.RegExp,ai=w((function(){var e=ii("a","y");return e.lastIndex=2,null!=e.exec("abcd")})),si=ai||w((function(){return!ii("a","y").sticky})),ui={BROKEN_CARET:ai||w((function(){var e=ii("^r","gy");return e.lastIndex=2,null!=e.exec("str")})),MISSED_STICKY:si,UNSUPPORTED_Y:ai},ci=R.RegExp,li=w((function(){var e=ci(".","s");return!(e.dotAll&&e.exec("\n")&&"s"===e.flags)})),di=R.RegExp,pi=w((function(){var e=di("(?<a>b)","g");return"b"!==e.exec("b").groups.a||"bc"!=="b".replace(e,"$<a>c")})),fi=Ct.get,hi=Se("native-string-replace",String.prototype.replace),gi=RegExp.prototype.exec,vi=gi,mi=j("".charAt),_i=j("".indexOf),yi=j("".replace),Mi=j("".slice),Ii=(oi=/b*/g,G(gi,ni=/a/,"a"),G(gi,oi,"a"),0!==ni.lastIndex||0!==oi.lastIndex),Ci=ui.BROKEN_CARET,ki=void 0!==/()??/.exec("")[1];(Ii||ki||Ci||li||pi)&&(vi=function(e){var t,n,o,r,i,a,s,u=this,c=fi(u),l=pn(e),d=c.raw;if(d)return d.lastIndex=u.lastIndex,t=G(vi,d,l),u.lastIndex=d.lastIndex,t;var p=c.groups,f=Ci&&u.sticky,h=G(ri,u),g=u.source,v=0,m=l;if(f&&(h=yi(h,"y",""),-1===_i(h,"g")&&(h+="g"),m=Mi(l,u.lastIndex),u.lastIndex>0&&(!u.multiline||u.multiline&&"\n"!==mi(l,u.lastIndex-1))&&(g="(?: "+g+")",m=" "+m,v++),n=new RegExp("^(?:"+g+")",h)),ki&&(n=new RegExp("^"+g+"$(?!\\s)",h)),Ii&&(o=u.lastIndex),r=G(gi,f?n:u,m),f?r?(r.input=Mi(r.input,v),r[0]=Mi(r[0],v),r.index=u.lastIndex,u.lastIndex+=r[0].length):u.lastIndex=0:Ii&&r&&(u.lastIndex=u.global?r.index+r[0].length:o),ki&&r&&r.length>1&&G(hi,r[0],n,(function(){for(i=1;i<arguments.length-2;i++)void 0===arguments[i]&&(r[i]=void 0)})),r&&p)for(r.groups=a=Hn(null),i=0;i<p.length;i++)a[(s=p[i])[0]]=r[s[1]];return r});var Ti=vi;on({target:"RegExp",proto:!0,forced:/./.exec!==Ti},{exec:Ti});var Si=Date.prototype,bi=j(Si.toString),Di=j(Si.getTime);"Invalid Date"!=String(new Date(NaN))&&Dt(Si,"toString",(function(){var e=Di(this);return e==e?bi(this):"Invalid Date"}));var Ei=bt.PROPER,Ai=RegExp.prototype,Li=Ai.toString,Ri=j(ri),wi=w((function(){return"/a/b"!=Li.call({source:"a",flags:"b"})})),Oi=Ei&&"toString"!=Li.name;(wi||Oi)&&Dt(RegExp.prototype,"toString",(function(){var e=$e(this),t=pn(e.source),n=e.flags;return"/"+t+"/"+pn(void 0===n&&ie(Ai,e)&&!("flags"in Ai)?Ri(e):n)}),{unsafe:!0});var Ni=xe("species"),Pi=RegExp.prototype,Gi=function(e,t,n,o){var r=xe(e),i=!w((function(){var t={};return t[r]=function(){return 7},7!=""[e](t)})),a=i&&!w((function(){var t=!1,n=/a/;return"split"===e&&((n={}).constructor={},n.constructor[Ni]=function(){return n},n.flags="",n[r]=/./[r]),n.exec=function(){return t=!0,null},n[r](""),!t}));if(!i||!a||n){var s=j(/./[r]),u=t(r,""[e],(function(e,t,n,o,r){var a=j(e),u=t.exec;return u===Ti||u===Pi.exec?i&&!r?{done:!0,value:s(t,n,o)}:{done:!0,value:a(n,t,o)}:{done:!1}}));Dt(String.prototype,e,u[0]),Dt(Pi,r,u[1])}o&&rt(Pi[r],"sham",!0)},Ui=zo.charAt,xi=function(e,t,n){return t+(n?Ui(e,t).length:1)},Fi=R.TypeError,qi=function(e,t){var n=e.exec;if(te(n)){var o=G(n,e,t);return null!==o&&$e(o),o}if("RegExp"===W(e))return G(Ti,e,t);throw Fi("RegExp#exec called on incompatible receiver")};Gi("match",(function(e,t,n){return[function(t){var n=Q(this),o=null==t?void 0:Me(t,e);return o?G(o,t,n):new RegExp(t)[e](pn(n))},function(e){var o=$e(this),r=pn(e),i=n(t,o,r);if(i.done)return i.value;if(!o.global)return qi(o,r);var a=o.unicode;o.lastIndex=0;for(var s,u=[],c=0;null!==(s=qi(o,r));){var l=pn(s[0]);u[c]=l,""===l&&(o.lastIndex=xi(r,Pt(o.lastIndex),a)),c++}return 0===c?null:u}]}));var Bi=R.Date,Vi=j(Bi.prototype.getTime);on({target:"Date",stat:!0},{now:function(){return Vi(new Bi)}});var Hi=xe("unscopables"),Ki=Array.prototype;null==Ki[Hi]&&ot.f(Ki,Hi,{configurable:!0,value:Hn(null)});var ji=function(e){Ki[Hi][e]=!0},zi=xt.includes;on({target:"Array",proto:!0},{includes:function(e){return zi(this,e,arguments.length>1?arguments[1]:void 0)}}),ji("includes");var Zi=xe("match"),Wi=function(e){var t;return ne(e)&&(void 0!==(t=e[Zi])?!!t:"RegExp"==W(e))},Yi=R.TypeError,Ji=function(e){if(Wi(e))throw Yi("The method doesn't accept regular expressions");return e},Xi=xe("match"),$i=function(e){var t=/./;try{"/./"[e](t)}catch(o){try{return t[Xi]=!1,"/./"[e](t)}catch(r){}}return!1},Qi=j("".indexOf);on({target:"String",proto:!0,forced:!$i("includes")},{includes:function(e){return!!~Qi(pn(Q(this)),pn(Ji(e)),arguments.length>1?arguments[1]:void 0)}});var ea=R.RangeError,ta=j((function(e){var t=pn(Q(this)),n="",o=Lt(e);if(o<0||1/0==o)throw ea("Wrong number of repetitions");for(;o>0;(o>>>=1)&&(t+=t))1&o&&(n+=t);return n})),na=j("".slice),oa=Math.ceil,ra=function(e){return function(t,n,o){var r,i,a=pn(Q(t)),s=Pt(n),u=a.length,c=void 0===o?" ":pn(o);return s<=u||""==c?a:((i=ta(c,oa((r=s-u)/c.length))).length>r&&(i=na(i,0,r)),e?a+i:i+a)}},ia=[ra(!1),ra(!0)][0],aa=R.RangeError,sa=Math.abs,ua=Date.prototype,ca=ua.toISOString,la=j(ua.getTime),da=j(ua.getUTCDate),pa=j(ua.getUTCFullYear),fa=j(ua.getUTCHours),ha=j(ua.getUTCMilliseconds),ga=j(ua.getUTCMinutes),va=j(ua.getUTCMonth),ma=j(ua.getUTCSeconds),_a=w((function(){return"0385-07-25T07:06:39.999Z"!=ca.call(new Date(-50000000000001))}))||!w((function(){ca.call(new Date(NaN))}))?function(){if(!isFinite(la(this)))throw aa("Invalid time value");var e=pa(this),t=ha(this),n=e<0?"-":e>9999?"+":"";return n+ia(sa(e),n?6:4,0)+"-"+ia(va(this)+1,2,0)+"-"+ia(da(this),2,0)+"T"+ia(fa(this),2,0)+":"+ia(ga(this),2,0)+":"+ia(ma(this),2,0)+"."+ia(t,3,0)+"Z"}:ca;on({target:"Date",proto:!0,forced:Date.prototype.toISOString!==_a},{toISOString:_a});var ya=Function.prototype,Ma=ya.apply,Ia=ya.call,Ca="object"==typeof Reflect&&Reflect.apply||(N?Ia.bind(Ma):function(){return Ia.apply(Ma,arguments)}),ka=Math.floor,Ta=j("".charAt),Sa=j("".replace),ba=j("".slice),Da=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,Ea=/\$([$&'`]|\d{1,2})/g,Aa=function(e,t,n,o,r,i){var a=n+e.length,s=o.length,u=Ea;return void 0!==r&&(r=De(r),u=Da),Sa(i,u,(function(i,u){var c;switch(Ta(u,0)){case"$":return"$";case"&":return e;case"`":return ba(t,0,n);case"'":return ba(t,a);case"<":c=r[ba(u,1,-1)];break;default:var l=+u;if(0===l)return i;if(l>s){var d=ka(l/10);return 0===d?i:d<=s?void 0===o[d-1]?Ta(u,1):o[d-1]+Ta(u,1):i}c=o[l-1]}return void 0===c?"":c}))},La=xe("replace"),Ra=Math.max,wa=Math.min,Oa=j([].concat),Na=j([].push),Pa=j("".indexOf),Ga=j("".slice),Ua="$0"==="a".replace(/./,"$0"),xa=!!/./[La]&&""===/./[La]("a","$0");Gi("replace",(function(e,t,n){var o=xa?"$":"$0";return[function(e,n){var o=Q(this),r=null==e?void 0:Me(e,La);return r?G(r,e,o,n):G(t,pn(o),e,n)},function(e,r){var i=$e(this),a=pn(e);if("string"==typeof r&&-1===Pa(r,o)&&-1===Pa(r,"$<")){var s=n(t,i,a,r);if(s.done)return s.value}var u=te(r);u||(r=pn(r));var c=i.global;if(c){var l=i.unicode;i.lastIndex=0}for(var d=[];;){var p=qi(i,a);if(null===p)break;if(Na(d,p),!c)break;""===pn(p[0])&&(i.lastIndex=xi(a,Pt(i.lastIndex),l))}for(var f,h="",g=0,v=0;v<d.length;v++){for(var m=pn((p=d[v])[0]),_=Ra(wa(Lt(p.index),a.length),0),y=[],M=1;M<p.length;M++)Na(y,void 0===(f=p[M])?f:String(f));var I=p.groups;if(u){var C=Oa([m],y,_,a);void 0!==I&&Na(C,I);var k=pn(Ca(r,void 0,C))}else k=Aa(m,a,_,y,I,r);_>=g&&(h+=Ga(a,g,_)+k,g=_+m.length)}return h+Ga(a,g)}]}),!!w((function(){var e=/./;return e.exec=function(){var e=[];return e.groups={a:"7"},e},"7"!=="".replace(e,"$<a>")}))||!Ua||xa);var Fa=ot.f,qa=Ct.set,Ba=Ct.getterFor("Array Iterator"),Va=vr(Array,"Array",(function(e,t){qa(this,{type:"Array Iterator",target:ee(e),index:0,kind:t})}),(function(){var e=Ba(this),t=e.target,n=e.kind,o=e.index++;return!t||o>=t.length?(e.target=void 0,{value:void 0,done:!0}):"keys"==n?{value:o,done:!1}:"values"==n?{value:t[o],done:!1}:{value:[o,t[o]],done:!1}}),"values"),Ha=Co.Arguments=Co.Array;if(ji("keys"),ji("values"),ji("entries"),O&&"values"!==Ha.name)try{Fa(Ha,"name",{value:"values"})}catch(XD){}var Ka=xe("iterator"),ja=xe("toStringTag"),za=Va.values,Za=function(e,t){if(e){if(e[Ka]!==za)try{rt(e,Ka,za)}catch(XD){e[Ka]=za}if(e[ja]||rt(e,ja,t),fo[t])for(var n in Va)if(e[n]!==Va[n])try{rt(e,n,Va[n])}catch(XD){e[n]=Va[n]}}};for(var Wa in fo)Za(R[Wa]&&R[Wa].prototype,Wa);Za(vo,"DOMTokenList");var Ya=kr("slice"),Ja=xe("species"),Xa=R.Array,$a=Math.max;on({target:"Array",proto:!0,forced:!Ya},{slice:function(e,t){var n,o,r,i=ee(this),a=Gt(i),s=Ot(e,a),u=Ot(void 0===t?a:t,a);if(zn(i)&&(n=i.constructor,(to(n)&&(n===Xa||zn(n.prototype))||ne(n)&&null===(n=n[Ja]))&&(n=void 0),n===Xa||void 0===n))return Dn(i,s,u);for(o=new(void 0===n?Xa:n)($a(u-s,0)),r=0;s<u;s++,r++)s in i&&bo(o,r,i[s]);return o.length=r,o}});var Qa=j([].join),es=X!=Object,ts=uo("join",",");on({target:"Array",proto:!0,forced:es||!ts},{join:function(e){return Qa(ee(this),void 0===e?",":e)}});var ns=xt.indexOf,os=j([].indexOf),rs=!!os&&1/os([1],1,-0)<0,is=uo("indexOf");on({target:"Array",proto:!0,forced:rs||!is},{indexOf:function(e){var t=arguments.length>1?arguments[1]:void 0;return rs?os(this,e,t)||0:ns(this,e,t)}});var as=R.Array,ss=Math.max,us=function(e,t,n){for(var o=Gt(e),r=Ot(t,o),i=Ot(void 0===n?o:n,o),a=as(ss(i-r,0)),s=0;r<i;r++,s++)bo(a,s,e[r]);return a.length=s,a},cs=Kt.f,ls="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],ds={f:function(e){return ls&&"Window"==W(e)?function(e){try{return cs(e)}catch(XD){return us(ls)}}(e):cs(ee(e))}},ps=ds.f,fs=w((function(){return!Object.getOwnPropertyNames(1)}));on({target:"Object",stat:!0,forced:fs},{getOwnPropertyNames:ps});var hs=so.find,gs=!0;"find"in[]&&Array(1).find((function(){gs=!1})),on({target:"Array",proto:!0,forced:gs},{find:function(e){return hs(this,e,arguments.length>1?arguments[1]:void 0)}}),ji("find");var vs,ms=We.f,_s=j("".startsWith),ys=j("".slice),Ms=Math.min,Is=$i("startsWith"),Cs=!(Is||(vs=ms(String.prototype,"startsWith"),!vs||vs.writable));on({target:"String",proto:!0,forced:!Cs&&!Is},{startsWith:function(e){var t=pn(Q(this));Ji(e);var n=Pt(Ms(arguments.length>1?arguments[1]:void 0,t.length)),o=pn(e);return _s?_s(t,o,n):ys(t,n,n+o.length)===o}});var ks,Ts,Ss,bs,Ds=R.Promise,Es=function(e,t,n){for(var o in t)Dt(e,o,t[o],n);return e},As=xe("species"),Ls=function(e){var t=re(e),n=ot.f;O&&t&&!t[As]&&n(t,As,{configurable:!0,get:function(){return this}})},Rs=R.TypeError,ws=function(e,t){if(ie(t,e))return e;throw Rs("Incorrect invocation")},Os=R.TypeError,Ns=function(e,t){this.stopped=e,this.result=t},Ps=Ns.prototype,Gs=function(e,t,n){var o,r,i,a,s,u,c,l=n&&n.that,d=!(!n||!n.AS_ENTRIES),p=!(!n||!n.IS_ITERATOR),f=!(!n||!n.INTERRUPTED),h=jn(t,l),g=function(e){return o&&Mo(o,"normal",e),new Ns(!0,e)},v=function(e){return d?($e(e),f?h(e[0],e[1],g):h(e[0],e[1])):f?h(e,g):h(e)};if(p)o=e;else{if(!(r=Eo(e)))throw Os(me(e)+" is not iterable");if(So(r)){for(i=0,a=Gt(e);a>i;i++)if((s=v(e[i]))&&ie(Ps,s))return s;return new Ns(!1)}o=Lo(e,r)}for(u=o.next;!(c=G(u,o)).done;){try{s=v(c.value)}catch(XD){Mo(o,"throw",XD)}if("object"==typeof s&&s&&ie(Ps,s))return s}return new Ns(!1)},Us=R.TypeError,xs=function(e){if(to(e))return e;throw Us(me(e)+" is not a constructor")},Fs=xe("species"),qs=function(e,t){var n,o=$e(e).constructor;return void 0===o||null==(n=$e(o)[Fs])?t:xs(n)},Bs=R.TypeError,Vs=function(e,t){if(e<t)throw Bs("Not enough arguments");return e},Hs=/(?:ipad|iphone|ipod).*applewebkit/i.test(ae),Ks="process"==W(R.process),js=R.setImmediate,zs=R.clearImmediate,Zs=R.process,Ws=R.Dispatch,Ys=R.Function,Js=R.MessageChannel,Xs=R.String,$s=0,Qs={};try{ks=R.location}catch(XD){}var eu=function(e){if(Ae(Qs,e)){var t=Qs[e];delete Qs[e],t()}},tu=function(e){return function(){eu(e)}},nu=function(e){eu(e.data)},ou=function(e){R.postMessage(Xs(e),ks.protocol+"//"+ks.host)};js&&zs||(js=function(e){Vs(arguments.length,1);var t=te(e)?e:Ys(e),n=Dn(arguments,1);return Qs[++$s]=function(){Ca(t,void 0,n)},Ts($s),$s},zs=function(e){delete Qs[e]},Ks?Ts=function(e){Zs.nextTick(tu(e))}:Ws&&Ws.now?Ts=function(e){Ws.now(tu(e))}:Js&&!Hs?(bs=(Ss=new Js).port2,Ss.port1.onmessage=nu,Ts=jn(bs.postMessage,bs)):R.addEventListener&&te(R.postMessage)&&!R.importScripts&&ks&&"file:"!==ks.protocol&&!w(ou)?(Ts=ou,R.addEventListener("message",nu,!1)):Ts="onreadystatechange"in je("script")?function(e){Un.appendChild(je("script")).onreadystatechange=function(){Un.removeChild(this),eu(e)}}:function(e){setTimeout(tu(e),0)});var ru,iu,au,su,uu,cu,lu,du,pu={set:js,clear:zs},fu=/ipad|iphone|ipod/i.test(ae)&&void 0!==R.Pebble,hu=/web0s(?!.*chrome)/i.test(ae),gu=We.f,vu=pu.set,mu=R.MutationObserver||R.WebKitMutationObserver,_u=R.document,yu=R.process,Mu=R.Promise,Iu=gu(R,"queueMicrotask"),Cu=Iu&&Iu.value;Cu||(ru=function(){var e,t;for(Ks&&(e=yu.domain)&&e.exit();iu;){t=iu.fn,iu=iu.next;try{t()}catch(XD){throw iu?su():au=void 0,XD}}au=void 0,e&&e.enter()},Hs||Ks||hu||!mu||!_u?!fu&&Mu&&Mu.resolve?((lu=Mu.resolve(void 0)).constructor=Mu,du=jn(lu.then,lu),su=function(){du(ru)}):Ks?su=function(){yu.nextTick(ru)}:(vu=jn(vu,R),su=function(){vu(ru)}):(uu=!0,cu=_u.createTextNode(""),new mu(ru).observe(cu,{characterData:!0}),su=function(){cu.data=uu=!uu}));var ku=Cu||function(e){var t={fn:e,next:void 0};au&&(au.next=t),iu||(iu=t,su()),au=t},Tu=function(e){var t,n;this.promise=new e((function(e,o){if(void 0!==t||void 0!==n)throw TypeError("Bad Promise constructor");t=e,n=o})),this.resolve=ye(t),this.reject=ye(n)},Su={f:function(e){return new Tu(e)}},bu=function(e,t){if($e(e),ne(t)&&t.constructor===e)return t;var n=Su.f(e);return(0,n.resolve)(t),n.promise},Du=function(e){try{return{error:!1,value:e()}}catch(XD){return{error:!0,value:XD}}},Eu=function(){this.head=null,this.tail=null};Eu.prototype={add:function(e){var t={item:e,next:null};this.head?this.tail.next=t:this.head=t,this.tail=t},get:function(){var e=this.head;if(e)return this.head=e.next,this.tail===e&&(this.tail=null),e.item}};var Au,Lu,Ru,wu,Ou=Eu,Nu="object"==typeof window,Pu=pu.set,Gu=xe("species"),Uu="Promise",xu=Ct.getterFor(Uu),Fu=Ct.set,qu=Ct.getterFor(Uu),Bu=Ds&&Ds.prototype,Vu=Ds,Hu=Bu,Ku=R.TypeError,ju=R.document,zu=R.process,Zu=Su.f,Wu=Zu,Yu=!!(ju&&ju.createEvent&&R.dispatchEvent),Ju=te(R.PromiseRejectionEvent),Xu=!1,$u=tn(Uu,(function(){var e=ct(Vu),t=e!==String(Vu);if(!t&&66===de)return!0;if(de>=51&&/native code/.test(e))return!1;var n=new Vu((function(e){e(1)})),o=function(e){e((function(){}),(function(){}))};return(n.constructor={})[Gu]=o,!(Xu=n.then((function(){}))instanceof o)||!t&&Nu&&!Ju})),Qu=$u||!Uo((function(e){Vu.all(e).catch((function(){}))})),ec=function(e){var t;return!(!ne(e)||!te(t=e.then))&&t},tc=function(e,t){var n,o,r,i=t.value,a=1==t.state,s=a?e.ok:e.fail,u=e.resolve,c=e.reject,l=e.domain;try{s?(a||(2===t.rejection&&ac(t),t.rejection=1),!0===s?n=i:(l&&l.enter(),n=s(i),l&&(l.exit(),r=!0)),n===e.promise?c(Ku("Promise-chain cycle")):(o=ec(n))?G(o,n,u,c):u(n)):c(i)}catch(XD){l&&!r&&l.exit(),c(XD)}},nc=function(e,t){e.notified||(e.notified=!0,ku((function(){for(var n,o=e.reactions;n=o.get();)tc(n,e);e.notified=!1,t&&!e.rejection&&rc(e)})))},oc=function(e,t,n){var o,r;Yu?((o=ju.createEvent("Event")).promise=t,o.reason=n,o.initEvent(e,!1,!0),R.dispatchEvent(o)):o={promise:t,reason:n},!Ju&&(r=R["on"+e])?r(o):"unhandledrejection"===e&&function(e,t){var n=R.console;n&&n.error&&(1==arguments.length?n.error(e):n.error(e,t))}("Unhandled promise rejection",n)},rc=function(e){G(Pu,R,(function(){var t,n=e.facade,o=e.value;if(ic(e)&&(t=Du((function(){Ks?zu.emit("unhandledRejection",o,n):oc("unhandledrejection",n,o)})),e.rejection=Ks||ic(e)?2:1,t.error))throw t.value}))},ic=function(e){return 1!==e.rejection&&!e.parent},ac=function(e){G(Pu,R,(function(){var t=e.facade;Ks?zu.emit("rejectionHandled",t):oc("rejectionhandled",t,e.value)}))},sc=function(e,t,n){return function(o){e(t,o,n)}},uc=function(e,t,n){e.done||(e.done=!0,n&&(e=n),e.value=t,e.state=2,nc(e,!0))},cc=function e(t,n,o){if(!t.done){t.done=!0,o&&(t=o);try{if(t.facade===n)throw Ku("Promise can't be resolved itself");var r=ec(n);r?ku((function(){var o={done:!1};try{G(r,n,sc(e,o,t),sc(uc,o,t))}catch(XD){uc(o,XD,t)}})):(t.value=n,t.state=1,nc(t,!1))}catch(XD){uc({done:!1},XD,t)}}};if($u&&(Hu=(Vu=function(e){ws(this,Hu),ye(e),G(Au,this);var t=xu(this);try{e(sc(cc,t),sc(uc,t))}catch(XD){uc(t,XD)}}).prototype,(Au=function(e){Fu(this,{type:Uu,done:!1,notified:!1,parent:!1,reactions:new Ou,rejection:!1,state:0,value:void 0})}).prototype=Es(Hu,{then:function(e,t){var n=qu(this),o=Zu(qs(this,Vu));return n.parent=!0,o.ok=!te(e)||e,o.fail=te(t)&&t,o.domain=Ks?zu.domain:void 0,0==n.state?n.reactions.add(o):ku((function(){tc(o,n)})),o.promise},catch:function(e){return this.then(void 0,e)}}),Lu=function(){var e=new Au,t=xu(e);this.promise=e,this.resolve=sc(cc,t),this.reject=sc(uc,t)},Su.f=Zu=function(e){return e===Vu||e===Ru?new Lu(e):Wu(e)},te(Ds)&&Bu!==Object.prototype)){wu=Bu.then,Xu||(Dt(Bu,"then",(function(e,t){var n=this;return new Vu((function(e,t){G(wu,n,e,t)})).then(e,t)}),{unsafe:!0}),Dt(Bu,"catch",Hu.catch,{unsafe:!0}));try{delete Bu.constructor}catch(XD){}cr&&cr(Bu,Hu)}on({global:!0,wrap:!0,forced:$u},{Promise:Vu}),or(Vu,Uu,!1),Ls(Uu),Ru=re(Uu),on({target:Uu,stat:!0,forced:$u},{reject:function(e){var t=Zu(this);return G(t.reject,void 0,e),t.promise}}),on({target:Uu,stat:!0,forced:$u},{resolve:function(e){return bu(this,e)}}),on({target:Uu,stat:!0,forced:Qu},{all:function(e){var t=this,n=Zu(t),o=n.resolve,r=n.reject,i=Du((function(){var n=ye(t.resolve),i=[],a=0,s=1;Gs(e,(function(e){var u=a++,c=!1;s++,G(n,t,e).then((function(e){c||(c=!0,i[u]=e,--s||o(i))}),r)})),--s||o(i)}));return i.error&&r(i.value),n.promise},race:function(e){var t=this,n=Zu(t),o=n.reject,r=Du((function(){var r=ye(t.resolve);Gs(e,(function(e){G(r,t,e).then(n.resolve,o)}))}));return r.error&&o(r.value),n.promise}});var lc=ui.UNSUPPORTED_Y,dc=Math.min,pc=[].push,fc=j(/./.exec),hc=j(pc),gc=j("".slice);Gi("split",(function(e,t,n){var o;return o="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||".".split(/()()/).length>1||"".split(/.?/).length?function(e,n){var o=pn(Q(this)),r=void 0===n?4294967295:n>>>0;if(0===r)return[];if(void 0===e)return[o];if(!Wi(e))return G(t,o,e,r);for(var i,a,s,u=[],c=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":""),l=0,d=new RegExp(e.source,c+"g");(i=G(Ti,d,o))&&!((a=d.lastIndex)>l&&(hc(u,gc(o,l,i.index)),i.length>1&&i.index<o.length&&Ca(pc,u,us(i,1)),s=i[0].length,l=a,u.length>=r));)d.lastIndex===i.index&&d.lastIndex++;return l===o.length?!s&&fc(d,"")||hc(u,""):hc(u,gc(o,l)),u.length>r?us(u,0,r):u}:"0".split(void 0,0).length?function(e,n){return void 0===e&&0===n?[]:G(t,this,e,n)}:t,[function(t,n){var r=Q(this),i=null==t?void 0:Me(t,e);return i?G(i,t,r,n):G(o,pn(r),t,n)},function(e,r){var i=$e(this),a=pn(e),s=n(o,i,a,r,o!==t);if(s.done)return s.value;var u=qs(i,RegExp),c=i.unicode,l=(i.ignoreCase?"i":"")+(i.multiline?"m":"")+(i.unicode?"u":"")+(lc?"g":"y"),d=new u(lc?"^(?:"+i.source+")":i,l),p=void 0===r?4294967295:r>>>0;if(0===p)return[];if(0===a.length)return null===qi(d,a)?[a]:[];for(var f=0,h=0,g=[];h<a.length;){d.lastIndex=lc?0:h;var v,m=qi(d,lc?gc(a,h):a);if(null===m||(v=dc(Pt(d.lastIndex+(lc?h:0)),a.length))===f)h=xi(a,h,c);else{if(hc(g,gc(a,f,h)),g.length===p)return g;for(var _=1;_<=m.length-1;_++)if(hc(g,m[_]),g.length===p)return g;h=f=v}}return hc(g,gc(a,f)),g}]}),!!w((function(){var e=/(?:)/,t=e.exec;e.exec=function(){return t.apply(this,arguments)};var n="ab".split(e);return 2!==n.length||"a"!==n[0]||"b"!==n[1]})),lc);var vc=zo.codeAt;on({target:"String",proto:!0},{codePointAt:function(e){return vc(this,e)}});var mc=yn.trim,_c=j("".charAt),yc=R.parseFloat,Mc=R.Symbol,Ic=Mc&&Mc.iterator,Cc=1/yc(fn+"-0")!=-1/0||Ic&&!w((function(){yc(Object(Ic))}))?function(e){var t=mc(pn(e)),n=yc(t);return 0===n&&"-"==_c(t,0)?-0:n}:yc;on({global:!0,forced:parseFloat!=Cc},{parseFloat:Cc});var kc=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;r(this,e),this.high=t,this.low=n}return a(e,[{key:"equal",value:function(e){return null!==e&&this.low===e.low&&this.high===e.high}},{key:"toString",value:function(){var e=Number(this.high).toString(16),t=Number(this.low).toString(16);if(t.length<8)for(var n=8-t.length;n;)t="0"+t,n--;return e+t}}]),e}(),Tc={TEST:{CHINA:{DEFAULT:"wss://wss-dev.tim.qq.com"},OVERSEA:{DEFAULT:"wss://wss-dev.tim.qq.com"},SINGAPORE:{DEFAULT:"wss://wsssgp-dev.im.qcloud.com"},KOREA:{DEFAULT:"wss://wsskr-dev.im.qcloud.com"},GERMANY:{DEFAULT:"wss://wssger-dev.im.qcloud.com"},IND:{DEFAULT:"wss://wssind-dev.im.qcloud.com"},JPN:{DEFAULT:"wss://wssjpn-dev.im.qcloud.com"},USA:{DEFAULT:"wss://wssusa-dev.im.qcloud.com"}},PRODUCTION:{CHINA:{DEFAULT:"wss://wss.im.qcloud.com",BACKUP:"wss://wss.tim.qq.com",STAT:"https://events.im.qcloud.com"},OVERSEA:{DEFAULT:"wss://wss.im.qcloud.com",BACKUP:"wss://wss.my-imcloud.com",STAT:"https://api.my-imcloud.com"},SINGAPORE:{DEFAULT:"wss://wsssgp.im.qcloud.com",BACKUP:"wss://wsssgp.my-imcloud.com",STAT:"https://apisgp.my-imcloud.com"},KOREA:{DEFAULT:"wss://wsskr.im.qcloud.com",BACKUP:"wss://wsskr.my-imcloud.com",STAT:"https://apikr.my-imcloud.com"},GERMANY:{DEFAULT:"wss://wssger.im.qcloud.com",BACKUP:"wss://wssger.my-imcloud.com",STAT:"https://apiger.my-imcloud.com"},IND:{DEFAULT:"wss://wssind.my-imcloud.com",BACKUP:"wss://wssind.im.qcloud.com",STAT:"https://apiind.my-imcloud.com"},JPN:{DEFAULT:"wss://wssjpn.im.qcloud.com",BACKUP:"wss://wssjpn.my-imcloud.com",STAT:"https://apijpn.my-imcloud.com"},USA:{DEFAULT:"wss://wssusa.im.qcloud.com",BACKUP:"wss://wssusa.my-imcloud.com",STAT:"https://apiusa.my-imcloud.com"}}},Sc={ANDROID:2,IOS:3,MAC:4,WEB:7,WX_MP:8,QQ_MP:9,TT_MP:10,BAIDU_MP:11,ALI_MP:12,IPAD:13,UNI_NATIVE_APP:15},bc="1.7.3",Dc=537048168,Ec="CHINA",Ac="OVERSEA",Lc="SINGAPORE",Rc="KOREA",wc="GERMANY",Oc="IND",Nc="JPN",Pc="USA",Gc={HOST:{CURRENT:{DEFAULT:"wss://wss.im.qcloud.com",STAT:"https://events.im.qcloud.com"},setCurrent:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ec;this.CURRENT=Tc.PRODUCTION[e]}},NAME:{OPEN_IM:"openim",OPEN_IM_MSG_EXT:"openim_msg_ext_http_svc",GROUP:"group_open_http_svc",GROUP_AVCHATROOM:"group_open_avchatroom_http_svc",GROUP_COMMUNITY:"million_group_open_http_svc",GROUP_ATTR:"group_open_attr_http_svc",FRIEND:"sns",PROFILE:"profile",RECENT_CONTACT:"recentcontact",PIC:"openpic",BIG_GROUP_NO_AUTH:"group_open_http_noauth_svc",BIG_GROUP_LONG_POLLING:"group_open_long_polling_http_svc",BIG_GROUP_LONG_POLLING_NO_AUTH:"group_open_long_polling_http_noauth_svc",IM_OPEN_STAT:"imopenstat",WEB_IM:"webim",IM_COS_SIGN:"im_cos_sign_svr",CUSTOM_UPLOAD:"im_cos_msg",HEARTBEAT:"heartbeat",IM_OPEN_PUSH:"im_open_push",IM_OPEN_STATUS:"im_open_status",IM_LONG_MESSAGE:"im_long_msg",IM_CONFIG_MANAGER:"im_sdk_config_mgr",STAT_SERVICE:"StatSvc",OVERLOAD_PUSH:"OverLoadPush",IM_MSG_AUDIT_MGR:"im_msg_audit_mgr",TUIROOM_SVR:"tui_room_svr",IM_OPEN_TRANSLATE:"im_open_translate"},CMD:{LOGIN:"wslogin",LOGOUT_LONG_POLL:"longpollinglogout",LOGOUT:"wslogout",HELLO:"wshello",STAT_BACKGROUND:"ws_stat_background",STAT_FOREGROUND:"ws_stat_foreground",SET_TOKEN:"ws_stat_settoken",PORTRAIT_GET:"portrait_get_all",PORTRAIT_SET:"portrait_set",GET_LONG_POLL_ID:"getlongpollingid",LONG_POLL:"longpolling",AVCHATROOM_LONG_POLL:"get_msg",ADD_FRIEND:"friend_add",UPDATE_FRIEND:"friend_update",GET_FRIEND_LIST:"friend_get",GET_FRIEND_PROFILE:"friend_get_specified",DELETE_FRIEND:"friend_delete",CHECK_FRIEND:"friend_check",GET_FRIEND_GROUP_LIST:"group_get",RESPOND_FRIEND_APPLICATION:"friend_response",GET_FRIEND_APPLICATION_LIST:"pendency_get",DELETE_FRIEND_APPLICATION:"pendency_delete",REPORT_FRIEND_APPLICATION:"pendency_report",GET_GROUP_APPLICATION:"get_pendency",CREATE_FRIEND_GROUP:"group_add",DELETE_FRIEND_GROUP:"group_delete",UPDATE_FRIEND_GROUP:"group_update",GET_BLACKLIST:"black_list_get",ADD_BLACKLIST:"black_list_add",DELETE_BLACKLIST:"black_list_delete",CREATE_GROUP:"create_group",GET_JOINED_GROUPS:"get_joined_group_list",SET_GROUP_ATTRIBUTES:"set_group_attr",MODIFY_GROUP_ATTRIBUTES:"modify_group_attr",DELETE_GROUP_ATTRIBUTES:"delete_group_attr",CLEAR_GROUP_ATTRIBUTES:"clear_group_attr",GET_GROUP_ATTRIBUTES:"get_group_attr",SEND_MESSAGE:"sendmsg",REVOKE_C2C_MESSAGE:"msgwithdraw",DELETE_C2C_MESSAGE:"delete_c2c_msg_ramble",MODIFY_C2C_MESSAGE:"modify_c2c_msg",MODIFY_C2C_MESSAGE_EXTENSIONS:"set_key_values",GET_C2C_MESSAGE_EXTENSIONS:"get_key_values",SEND_GROUP_MESSAGE:"send_group_msg",REVOKE_GROUP_MESSAGE:"group_msg_recall",DELETE_GROUP_MESSAGE:"delete_group_ramble_msg_by_seq",MODIFY_GROUP_MESSAGE:"modify_group_msg",MODIFY_GROUP_MESSAGE_EXTENSIONS:"group_set_key_values",GET_GROUP_MESSAGE_EXTENSIONS:"group_get_key_values",GET_GROUP_INFO:"get_group_self_member_info",GET_GROUP_MEMBER_INFO:"get_specified_group_member_info",GET_GROUP_MEMBER_LIST:"get_group_member_info",GET_AVCHATROOM_MEMBER_LIST:"get_members",MARK_AVCHATROOM_MEMBER_INFO:"modify_user_info",QUIT_GROUP:"quit_group",CHANGE_GROUP_OWNER:"change_group_owner",DESTROY_GROUP:"destroy_group",ADD_GROUP_MEMBER:"add_group_member",DELETE_GROUP_MEMBER:"delete_group_member",BAN_AVCHATROOM_MEMBER:"ban_group_member",SEARCH_GROUP_BY_ID:"get_group_public_info",APPLY_JOIN_GROUP:"apply_join_group",HANDLE_APPLY_JOIN_GROUP:"handle_apply_join_group",HANDLE_GROUP_INVITATION:"handle_invite_join_group",MODIFY_GROUP_INFO:"modify_group_base_info",MODIFY_GROUP_MEMBER_INFO:"modify_group_member_info",DELETE_GROUP_SYSTEM_MESSAGE:"deletemsg",DELETE_GROUP_AT_TIPS:"deletemsg",GET_GROUP_NOTIFY:"get_group_notify",GET_CONVERSATION_LIST:"get",PAGING_GET_CONVERSATION_LIST:"page_get",DELETE_CONVERSATION:"delete",CLEAR_HISTORY_MESSAGE:"clear_msg",PIN_CONVERSATION:"top",SET_CONVERSATION_CUSTOM_DATA:"mark_contact",MARK_CONVERSATION:"mark_contact",CREATE_CONVERSATION_GROUP:"create_contact_group",DELETE_CONVERSATION_GROUP:"del_contact_group",UPDATE_CONVERSATION_GROUP:"update_contact_group",GET_CONVERSATION_GROUP_LIST:"get_contact_group",GET_MESSAGES:"getmsg",GET_C2C_ROAM_MESSAGES:"getroammsg",SET_C2C_PEER_MUTE_NOTIFICATIONS:"set_c2c_peer_mute_notifications",GET_C2C_PEER_MUTE_NOTIFICATIONS:"get_c2c_peer_mute_notifications",GET_GROUP_ROAM_MESSAGES:"group_msg_get",GET_READ_RECEIPT:"get_group_msg_receipt",GET_READ_RECEIPT_DETAIL:"get_group_msg_receipt_detail",SEND_READ_RECEIPT:"group_msg_receipt",SEND_C2C_READ_RECEIPT:"c2c_msg_read_receipt",SET_C2C_MESSAGE_READ:"msgreaded",GET_PEER_READ_TIME:"get_peer_read_time",SET_GROUP_MESSAGE_READ:"msg_read_report",FILE_READ_AND_WRITE_AUTHKEY:"authkey",FILE_UPLOAD:"pic_up",COS_SIGN:"cos",COS_PRE_SIG:"pre_sig",VIDEO_COVER:"video_cover",TIM_WEB_REPORT_V2:"tim_web_report_v2",BIG_DATA_HALLWAY_AUTH_KEY:"authkey",GET_ONLINE_MEMBER_NUM:"get_online_member_num",ALIVE:"alive",MESSAGE_PUSH:"msg_push",MULTI_MESSAGE_PUSH:"multi_msg_push_ws",MESSAGE_PUSH_ACK:"ws_msg_push_ack",STATUS_FORCE_OFFLINE:"stat_forceoffline",DOWNLOAD_MERGER_MESSAGE:"get_relay_json_msg",UPLOAD_MERGER_MESSAGE:"save_relay_json_msg",FETCH_CLOUD_CONTROL_CONFIG:"fetch_config",PUSHED_CLOUD_CONTROL_CONFIG:"push_configv2",FETCH_COMMERCIAL_CONFIG:"fetch_imsdk_purchase_bitsv2",PUSHED_COMMERCIAL_CONFIG:"push_imsdk_purchase_bitsv2",KICK_OTHER:"KickOther",OVERLOAD_NOTIFY:"notify2",SET_ALL_MESSAGE_READ:"read_all_unread_msg",CREATE_TOPIC:"create_topic",DELETE_TOPIC:"destroy_topic",UPDATE_TOPIC_PROFILE:"modify_topic",GET_TOPIC_LIST:"get_topic",SET_SELF_STATUS:"ws_set_custom_status",GET_USER_STATUS:"ws_get_user_status",SUBSCRIBE_USER_STATUS:"ws_status_subscribe",UNSUBSCRIBE_USER_STATUS:"ws_status_unsubscribe",GET_RPOFANITY_LIST:"get_local_words",TRANSLATE_TEXT:"ws_batch_trans_text",UPDATE_GROUP_COUNTER:"update_group_counter",GET_GROUP_COUNTER:"get_group_counter"},CHANNEL:{SOCKET:1,XHR:2,AUTO:0},NAME_VERSION:{openim:"v4",group_open_http_svc:"v4",sns:"v4",profile:"v4",recentcontact:"v4",openpic:"v4",group_open_http_noauth_svc:"v4",group_open_long_polling_http_svc:"v4",group_open_long_polling_http_noauth_svc:"v4",imopenstat:"v4",im_cos_sign_svr:"v4",im_cos_msg:"v4",webim:"v4",im_open_push:"v4",im_open_status:"v4"}},Uc={SEARCH_MSG:new kc(0,Math.pow(2,0)).toString(),SEARCH_GRP_SNS:new kc(0,Math.pow(2,1)).toString(),AVCHATROOM_HISTORY_MSG:new kc(0,Math.pow(2,2)).toString(),GRP_COMMUNITY:new kc(0,Math.pow(2,3)).toString(),MSG_TO_SPECIFIED_GRP_MBR:new kc(0,Math.pow(2,4)).toString(),AVCHATROOM_MBR_LIST:new kc(0,Math.pow(2,6)).toString(),USER_STATUS:new kc(0,Math.pow(2,7)).toString(),CONV_MARK:new kc(0,Math.pow(2,9)).toString(),CONV_GROUP:new kc(0,Math.pow(2,10)).toString(),AVCHATROOM_BAN_MBR:new kc(0,Math.pow(2,11)).toString(),MSG_EXT:new kc(0,Math.pow(2,13)).toString(),GRP_COUNTER:new kc(0,Math.pow(2,15)).toString()},xc="c2c_text_message",Fc="c2c_custom_message",qc="group_text_message",Bc="group_custom_message",Vc="user_profile",Hc="sns",Kc="group_profile",jc="group_member_profile";Gc.HOST.setCurrent(Ec);var zc,Zc,Wc,Yc="undefined"!=typeof wx&&"function"==typeof wx.getSystemInfoSync&&Boolean(wx.getSystemInfoSync().fontSizeSetting),Jc="undefined"!=typeof qq&&"function"==typeof qq.getSystemInfoSync&&Boolean(qq.getSystemInfoSync().fontSizeSetting),Xc="undefined"!=typeof tt&&"function"==typeof tt.getSystemInfoSync&&Boolean(tt.getSystemInfoSync().fontSizeSetting),$c="undefined"!=typeof swan&&"function"==typeof swan.getSystemInfoSync&&Boolean(swan.getSystemInfoSync().fontSizeSetting),Qc="undefined"!=typeof my&&"function"==typeof my.getSystemInfoSync&&Boolean(my.getSystemInfoSync().fontSizeSetting),el="undefined"!=typeof uni&&"undefined"==typeof window,tl="undefined"!=typeof uni,nl=Yc||Jc||Xc||$c||Qc||el,ol=("undefined"!=typeof uni||"undefined"!=typeof window)&&!nl,rl=Jc?qq:Xc?tt:$c?swan:Qc?my:Yc?wx:el?uni:{},il=(zc="WEB",_l?zc="WEB":Jc?zc="QQ_MP":Xc?zc="TT_MP":$c?zc="BAIDU_MP":Qc?zc="ALI_MP":Yc?zc="WX_MP":el&&(zc="UNI_NATIVE_APP"),Sc[zc]),al=ol&&window&&window.navigator&&window.navigator.userAgent||"",sl=/AppleWebKit\/([\d.]+)/i.exec(al),ul=(sl&&parseFloat(sl.pop()),/iPad/i.test(al)),cl=/iPhone/i.test(al)&&!ul,ll=/iPod/i.test(al),dl=cl||ul||ll,pl=function(){var e=al.match(/OS (\d+)_/i);return e&&e[1]?e[1]:null}(),fl=/Android/i.test(al),hl=function(){var e=al.match(/Android (\d+)(?:\.(\d+))?(?:\.(\d+))*/i);if(!e)return null;var t=e[1]&&parseFloat(e[1]),n=e[2]&&parseFloat(e[2]);return t&&n?parseFloat(e[1]+"."+e[2]):t||null}(),gl=(fl&&/webkit/i.test(al),/Firefox/i.test(al),!/Edge/i.test(al)&&/Chrome/i.test(al),function(){var e=al.match(/Chrome\/(\d+)/);e&&e[1]&&parseFloat(e[1])}(),/MSIE/.test(al)||al.indexOf("Trident")>-1&&al.indexOf("rv:11.0")>-1),vl=(/MSIE\s8\.0/.test(al),function(){var e=/MSIE\s(\d+)\.\d/.exec(al),t=e&&parseFloat(e[1]);return!t&&/Trident\/7.0/i.test(al)&&/rv:11.0/.test(al)&&(t=11),t}()),ml=(/Safari/i.test(al),/TBS\/\d+/i.test(al)),_l=(function(){var e=al.match(/TBS\/(\d+)/i);e&&e[1]&&e[1]}(),!ml&&/MQQBrowser\/\d+/i.test(al),!ml&&/ QQBrowser\/\d+/i.test(al),/(micromessenger|webbrowser)/i.test(al)),yl=/Windows/i.test(al),Ml=/MAC OS X/i.test(al),Il=(/MicroMessenger/i.test(al),ol&&"undefined"!=typeof Worker&&!gl),Cl=fl||dl,kl=ol&&void 0!==window.tencent_cloud_im_csig_flutter_for_web_25F_cy,Tl="undefined"!=typeof n.g?n.g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{};Zc="undefined"!=typeof console?console:void 0!==Tl&&Tl.console?Tl.console:"undefined"!=typeof window&&window.console?window.console:{};for(var Sl=function(){},bl=["assert","clear","count","debug","dir","dirxml","error","group","groupCollapsed","groupEnd","info","log","profile","profileEnd","table","time","timeEnd","timeStamp","trace","warn"],Dl=bl.length;Dl--;)Wc=bl[Dl],console[Wc]||(Zc[Wc]=Sl);var El=Zc,Al=0,Ll=function(){return(new Date).getTime()+Al},Rl=function(){Al=0},wl=function(){return Math.floor(Ll()/1e3)},Ol=0;function Nl(){return zd()?"%c TIM %c":"TIM"}function Pl(){var e,t=((e=new Date).setTime(Ll()),e);return t.toLocaleTimeString("en-US",{hour12:!1})+"."+function(e){var t;switch(e.toString().length){case 1:t="00"+e;break;case 2:t="0"+e;break;default:t=e}return t}(t.getMilliseconds())}var Gl={arguments2String:function(e){var t="";if(1===e.length)t=e[0];else for(var n=0,o=e.length;n<o;n++)ad(e[n])?ud(e[n])?t+=hd(e[n]):t+=JSON.stringify(e[n]):t+=e[n],t+=" ";return t},_exec:function(e,t){zd()?El[e](Nl(),"background:#0abf5b; padding:1px; border-radius:3px; color: #fff","background:transparent",Pl(),t):El[e]("".concat(Nl()," ").concat(Pl()," ").concat(t))},d:function(){if(Ol<=-1){var e=this.arguments2String(arguments);this._exec("debug",e)}},l:function(){if(Ol<=0){var e=this.arguments2String(arguments);this._exec("log",e)}},log:function(){if(Ol<=0){var e=this.arguments2String(arguments);this._exec("log",e)}},i:function(){if(Ol<=1){var e=this.arguments2String(arguments);this._exec("info",e)}},w:function(){if(Ol<=2){var e=this.arguments2String(arguments);this._exec("warn",e)}},e:function(){if(Ol<=3){var e=this.arguments2String(arguments);this._exec("error",e)}},setLevel:function(e){e<4&&this._exec("log","set level from "+Ol+" to "+e),Ol=e},getLevel:function(){return Ol}},Ul={JPG:1,JPEG:1,GIF:2,PNG:3,BMP:4,UNKNOWN:255},xl={NICK:"Tag_Profile_IM_Nick",GENDER:"Tag_Profile_IM_Gender",BIRTHDAY:"Tag_Profile_IM_BirthDay",LOCATION:"Tag_Profile_IM_Location",SELFSIGNATURE:"Tag_Profile_IM_SelfSignature",ALLOWTYPE:"Tag_Profile_IM_AllowType",LANGUAGE:"Tag_Profile_IM_Language",AVATAR:"Tag_Profile_IM_Image",MESSAGESETTINGS:"Tag_Profile_IM_MsgSettings",ADMINFORBIDTYPE:"Tag_Profile_IM_AdminForbidType",LEVEL:"Tag_Profile_IM_Level",ROLE:"Tag_Profile_IM_Role"},Fl="Tag_SNS_IM_Group",ql="Tag_SNS_IM_Remark",Bl="Tag_SNS_IM_AddSource",Vl="Tag_SNS_IM_AddWording",Hl="Tag_SNS_IM_AddTime",Kl={UNKNOWN:"Gender_Type_Unknown",FEMALE:"Gender_Type_Female",MALE:"Gender_Type_Male"},jl={NONE:"AdminForbid_Type_None",SEND_OUT:"AdminForbid_Type_SendOut"},zl={NEED_CONFIRM:"AllowType_Type_NeedConfirm",ALLOW_ANY:"AllowType_Type_AllowAny",DENY_ANY:"AllowType_Type_DenyAny"},Zl="JoinedSuccess",Wl="WaitAdminApproval",Yl="@TGS#_",Jl="@TOPIC#_",Xl=["url"],$l=function(e){return"map"===cd(e)},Ql=function(e){return"file"===cd(e)},ed=function(e){return null!==e&&("number"==typeof e&&!isNaN(e-0)||"object"===o(e)&&e.constructor===Number)},td=function(e){return"string"==typeof e},nd=function(e){return null!==e&&"object"===o(e)},od=function(e){if("object"!==o(e)||null===e)return!1;var t=Object.getPrototypeOf(e);if(null===t)return!0;for(var n=t;null!==Object.getPrototypeOf(n);)n=Object.getPrototypeOf(n);return t===n},rd=function(e){return"function"==typeof Array.isArray?Array.isArray(e):"array"===cd(e)},id=function(e){return void 0===e},ad=function(e){return rd(e)||nd(e)},sd=function(e){return"function"==typeof e},ud=function(e){return e instanceof Error},cd=function(e){return Object.prototype.toString.call(e).match(/^\[object (.*)\]$/)[1].toLowerCase()},ld=function(e){if("string"!=typeof e)return!1;var t=e[0];return!/[^a-zA-Z0-9]/.test(t)},dd=0;Date.now||(Date.now=function(){return(new Date).getTime()});var pd=function(){0===dd&&(dd=Date.now()-1);var e=Date.now()-dd;return e>4294967295?(dd+=4294967295,Date.now()-dd):e},fd=function e(t,n,o,r){if(!ad(t)||!ad(n))return 0;for(var i,a=0,s=Object.keys(n),u=0,c=s.length;u<c;u++)if(i=s[u],!(id(n[i])||o&&o.includes(i)))if(ad(t[i])&&ad(n[i]))a+=e(t[i],n[i],o,r);else{if(r&&r.includes(n[i]))continue;t[i]!==n[i]&&(t[i]=n[i],a+=1)}return a},hd=function(e){return JSON.stringify(e,["message","code"])},gd=function(e){if(0===e.length)return 0;for(var t=0,n=0,o="undefined"!=typeof document&&void 0!==document.characterSet?document.characterSet:"UTF-8";void 0!==e[t];)n+=e[t++].charCodeAt[t]<=255?1:!1===o?3:2;return n},vd=function(e){var t=e||99999999;return Math.round(Math.random()*t)},md="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ",_d=md.length,yd=function(e,t){for(var n in e)if(e[n]===t)return!0;return!1},Md={},Id=function(e){return-1===e.indexOf("http://")||-1===e.indexOf("https://")?"https://"+e:e.replace(/https|http/,"https")},Cd=function e(t){if(0===Object.getOwnPropertyNames(t).length)return Object.create(null);var n=Array.isArray(t)?[]:Object.create(null),r="";for(var i in t)null!==t[i]?void 0!==t[i]?(r=o(t[i]),["string","number","function","boolean"].indexOf(r)>=0?n[i]=t[i]:n[i]=e(t[i])):n[i]=void 0:n[i]=null;return n};function kd(e,t){rd(e)&&rd(t)&&t.forEach((function(t){var n=t.key,o=t.value,r=e.find((function(e){return e.key===n}));r?r.value=o:e.push({key:n,value:o})}))}var Td=function(e){return e===Ir.GRP_PUBLIC},Sd=function(e){return e===Ir.GRP_AVCHATROOM},bd=function(e){var t=e.type,n=e.groupID;return t===Ir.GRP_COMMUNITY||"".concat(n).startsWith(Yl)&&!"".concat(n).includes(Jl)},Dd=function(e){return"".concat(e).startsWith(Yl)&&"".concat(e).includes(Jl)},Ed=function(e){return td(e)&&e.slice(0,3)===Ir.CONV_C2C},Ad=function(e){return td(e)&&e.slice(0,5)===Ir.CONV_GROUP},Ld=function(e){return td(e)&&e===Ir.CONV_SYSTEM};function Rd(e,t){var n={};return Object.keys(e).forEach((function(o){n[o]=t(e[o],o)})),n}function wd(e){return nl?new Promise((function(t,n){rl.getImageInfo({src:e,success:function(e){t({width:e.width,height:e.height})},fail:function(){t({width:0,height:0})}})})):gl&&9===vl?Promise.resolve({width:0,height:0}):new Promise((function(t,n){var o=new Image;o.onload=function(){t({width:this.width,height:this.height}),o=null},o.onerror=function(){t({width:0,height:0}),o=null},o.src=e}))}function Od(){function e(){return(65536*(1+Math.random())|0).toString(16).substring(1)}return"".concat(e()+e()).concat(e()).concat(e()).concat(e()).concat(e()).concat(e()).concat(e())}function Nd(){var e="unknown";if(Ml&&(e="mac"),yl&&(e="windows"),dl&&(e="ios"),fl&&(e="android"),nl)try{var t=rl.getSystemInfoSync().platform;void 0!==t&&(e=t)}catch(XD){}return e}function Pd(e,t){e=e.split("."),t=t.split(".");for(var n=Math.max(e.length,t.length);e.length<n;)e.push("0");for(;t.length<n;)t.push("0");for(var o=0;o<n;o++){var r=parseInt(e[o]),i=parseInt(t[o]);if(r>i)return 1;if(r<i)return-1}return 0}function Gd(e){var t=e.originUrl,n=void 0===t?void 0:t,o=e.originWidth,r=e.originHeight,i=e.min,a=void 0===i?198:i,s=parseInt(o),u=parseInt(r),c={url:void 0,width:0,height:0};if((s<=u?s:u)<=a)c.url=n,c.width=s,c.height=u;else{u<=s?(c.width=Math.ceil(s*a/u),c.height=a):(c.width=a,c.height=Math.ceil(u*a/s));var l=n&&n.indexOf("?")>-1?"".concat(n,"&"):"".concat(n,"?");c.url="".concat(l,198===a?"imageView2/3/w/198/h/198":"imageView2/3/w/720/h/720")}return id(n)?h(c,Xl):c}function Ud(e){var t=e[2];e[2]=e[1],e[1]=t;for(var n=0;n<e.length;n++)e[n].setType(n)}function xd(e){var t=e.servcmd;return t.slice(t.indexOf(".")+1)}function Fd(e,t){return Math.round(Number(e)*Math.pow(10,t))/Math.pow(10,t)}function qd(e,t){return e.includes(t)}function Bd(e,t){return e.includes(t)}function Vd(e){return e.split(Jl)[0]}var Hd=function(e,t,n){if(id(t))return"";switch(e){case Ir.MSG_TEXT:return t.text;case Ir.MSG_IMAGE:return n?"[Image]":"[\u56fe\u7247]";case Ir.MSG_LOCATION:return n?"[Location]":"[\u4f4d\u7f6e]";case Ir.MSG_AUDIO:return n?"[Voice]":"[\u8bed\u97f3]";case Ir.MSG_VIDEO:return n?"[Video]":"[\u89c6\u9891]";case Ir.MSG_FILE:return n?"[File]":"[\u6587\u4ef6]";case Ir.MSG_CUSTOM:return n?"[Custom Messages]":"[\u81ea\u5b9a\u4e49\u6d88\u606f]";case Ir.MSG_GRP_TIP:return n?"[Group Notification]":"[\u7fa4\u63d0\u793a\u6d88\u606f]";case Ir.MSG_GRP_SYS_NOTICE:return n?"[Group System Message]":"[\u7fa4\u7cfb\u7edf\u901a\u77e5]";case Ir.MSG_FACE:return n?"[Animated Sticker]":"[\u52a8\u753b\u8868\u60c5]";case Ir.MSG_MERGER:return n?"[Chat Record]":"[\u804a\u5929\u8bb0\u5f55]";default:return""}};function Kd(e){return e===Ir.MSG_TEXT||e===Ir.MSG_CUSTOM||e===Ir.MSG_LOCATION||e===Ir.MSG_FACE}function jd(e){var t=[];if(!td(e))return t;var n=e.length;if(0===n)return t;for(var o=n-1;o>=0;o--)"1"===e[o]&&t.push(Math.pow(2,n-o-1));return t}function zd(){return!gl&&!nl}function Zd(e){return"the length of userIDList cannot exceed ".concat(e)}var Wd=Object.prototype.hasOwnProperty;function Yd(e){if(null==e)return!0;if("boolean"==typeof e)return!1;if("number"==typeof e)return 0===e;if("string"==typeof e)return 0===e.length;if("function"==typeof e)return 0===e.length;if(Array.isArray(e))return 0===e.length;if(e instanceof Error)return""===e.message;if(od(e)){for(var t in e)if(Wd.call(e,t))return!1;return!0}return!(!$l(e)&&(n=e,"set"!==cd(n))&&!Ql(e))&&0===e.size;var n}function Jd(e,t,n){if(void 0===t)return!0;var o=!0;if(od(t))Object.keys(t).forEach((function(r){var i=1===e.length?e[0][r]:void 0;o=!!Xd(i,t[r],n,r)&&o}));else if(rd(t))for(var r=0;r<t.length;r++)o=!!Xd(e[r],t[r],n,t[r].name)&&o;if(o)return o;throw new Error("Params validate failed.")}function Xd(e,t,n,o){if(void 0===t)return!0;var r=!0;return t.required&&Yd(e)&&(Gl.e("[".concat(n,'] Missing required params: "').concat(o,'".')),r=!1),Yd(e)||cd(e).toLowerCase()===t.type.toLowerCase()||(Gl.e("[".concat(n,'] Invalid params: type check failed for "').concat(o,'".Expected ').concat(t.type,".")),r=!1),t.validator&&!t.validator(e)&&(Gl.e("[".concat(n,"] Invalid params: custom validator check failed for params.")),r=!1),r}var $d={f:xe},Qd=R,ep=ot.f,tp=so.forEach,np=ft("hidden"),op=xe("toPrimitive"),rp=Ct.set,ip=Ct.getterFor("Symbol"),ap=Object.prototype,sp=R.Symbol,up=sp&&sp.prototype,cp=R.TypeError,lp=R.QObject,dp=re("JSON","stringify"),pp=We.f,fp=ot.f,hp=ds.f,gp=F.f,vp=j([].push),mp=Se("symbols"),_p=Se("op-symbols"),yp=Se("string-to-symbol-registry"),Mp=Se("symbol-to-string-registry"),Ip=Se("wks"),Cp=!lp||!lp.prototype||!lp.prototype.findChild,kp=O&&w((function(){return 7!=Hn(fp({},"a",{get:function(){return fp(this,"a",{value:7}).a}})).a}))?function(e,t,n){var o=pp(ap,t);o&&delete ap[t],fp(e,t,n),o&&e!==ap&&fp(ap,t,o)}:fp,Tp=function(e,t){var n=mp[e]=Hn(up);return rp(n,{type:"Symbol",tag:e,description:t}),O||(n.description=t),n},Sp=function e(t,n,o){t===ap&&e(_p,n,o),$e(t);var r=Ve(n);return $e(o),Ae(mp,r)?(o.enumerable?(Ae(t,np)&&t[np][r]&&(t[np][r]=!1),o=Hn(o,{enumerable:q(0,!1)})):(Ae(t,np)||fp(t,np,q(1,{})),t[np][r]=!0),kp(t,r,o)):fp(t,r,o)},bp=function(e,t){$e(e);var n=ee(t),o=Pn(n).concat(Lp(n));return tp(o,(function(t){O&&!G(Dp,n,t)||Sp(e,t,n[t])})),e},Dp=function(e){var t=Ve(e),n=G(gp,this,t);return!(this===ap&&Ae(mp,t)&&!Ae(_p,t))&&(!(n||!Ae(this,t)||!Ae(mp,t)||Ae(this,np)&&this[np][t])||n)},Ep=function(e,t){var n=ee(e),o=Ve(t);if(n!==ap||!Ae(mp,o)||Ae(_p,o)){var r=pp(n,o);return!r||!Ae(mp,o)||Ae(n,np)&&n[np][o]||(r.enumerable=!0),r}},Ap=function(e){var t=hp(ee(e)),n=[];return tp(t,(function(e){Ae(mp,e)||Ae(ht,e)||vp(n,e)})),n},Lp=function(e){var t=e===ap,n=hp(t?_p:ee(e)),o=[];return tp(n,(function(e){!Ae(mp,e)||t&&!Ae(ap,e)||vp(o,mp[e])})),o};if(pe||(up=(sp=function(){if(ie(up,this))throw cp("Symbol is not a constructor");var e=arguments.length&&void 0!==arguments[0]?pn(arguments[0]):void 0,t=Oe(e),n=function e(n){this===ap&&G(e,_p,n),Ae(this,np)&&Ae(this[np],t)&&(this[np][t]=!1),kp(this,t,q(1,n))};return O&&Cp&&kp(ap,t,{configurable:!0,set:n}),Tp(t,e)}).prototype,Dt(up,"toString",(function(){return ip(this).tag})),Dt(sp,"withoutSetter",(function(e){return Tp(Oe(e),e)})),F.f=Dp,ot.f=Sp,Gn.f=bp,We.f=Ep,Kt.f=ds.f=Ap,jt.f=Lp,$d.f=function(e){return Tp(xe(e),e)},O&&(fp(up,"description",{configurable:!0,get:function(){return ip(this).description}}),Dt(ap,"propertyIsEnumerable",Dp,{unsafe:!0}))),on({global:!0,wrap:!0,forced:!pe,sham:!pe},{Symbol:sp}),tp(Pn(Ip),(function(e){!function(e){var t=Qd.Symbol||(Qd.Symbol={});Ae(t,e)||ep(t,e,{value:$d.f(e)})}(e)})),on({target:"Symbol",stat:!0,forced:!pe},{for:function(e){var t=pn(e);if(Ae(yp,t))return yp[t];var n=sp(t);return yp[t]=n,Mp[n]=t,n},keyFor:function(e){if(!ge(e))throw cp(e+" is not a symbol");if(Ae(Mp,e))return Mp[e]},useSetter:function(){Cp=!0},useSimple:function(){Cp=!1}}),on({target:"Object",stat:!0,forced:!pe,sham:!O},{create:function(e,t){return void 0===t?Hn(e):bp(Hn(e),t)},defineProperty:Sp,defineProperties:bp,getOwnPropertyDescriptor:Ep}),on({target:"Object",stat:!0,forced:!pe},{getOwnPropertyNames:Ap,getOwnPropertySymbols:Lp}),on({target:"Object",stat:!0,forced:w((function(){jt.f(1)}))},{getOwnPropertySymbols:function(e){return jt.f(De(e))}}),dp){var Rp=!pe||w((function(){var e=sp();return"[null]"!=dp([e])||"{}"!=dp({a:e})||"{}"!=dp(Object(e))}));on({target:"JSON",stat:!0,forced:Rp},{stringify:function(e,t,n){var o=Dn(arguments),r=t;if((ne(t)||void 0!==e)&&!ge(e))return zn(t)||(t=function(e,t){if(te(r)&&(t=G(r,this,e,t)),!ge(t))return t}),o[1]=t,Ca(dp,null,o)}})}if(!up[op]){var wp=up.valueOf;Dt(up,op,(function(e){return G(wp,this)}))}or(sp,"Symbol"),ht[np]=!0;var Op=ot.f,Np=R.Symbol,Pp=Np&&Np.prototype;if(O&&te(Np)&&(!("description"in Pp)||void 0!==Np().description)){var Gp={},Up=function(){var e=arguments.length<1||void 0===arguments[0]?void 0:pn(arguments[0]),t=ie(Pp,this)?new Np(e):void 0===e?Np():Np(e);return""===e&&(Gp[t]=!0),t};Wt(Up,Np),Up.prototype=Pp,Pp.constructor=Up;var xp="Symbol(test)"==String(Np("test")),Fp=j(Pp.toString),qp=j(Pp.valueOf),Bp=/^Symbol\((.*)\)[^)]+$/,Vp=j("".replace),Hp=j("".slice);Op(Pp,"description",{configurable:!0,get:function(){var e=qp(this),t=Fp(e);if(Ae(Gp,e))return"";var n=xp?Hp(t,7,-1):Vp(t,Bp,"$1");return""===n?void 0:n}}),on({global:!0,forced:!0},{Symbol:Up})}var Kp={UNSEND:"unSend",SUCCESS:"success",FAIL:"fail"},jp={NOT_START:"notStart",PENDING:"pending",RESOLVED:"resolved",REJECTED:"rejected"},zp=function(e){if(!e)return!1;if(Ed(e)||Ad(e)||Ld(e))return!0;var t=yf("InvalidConversationID",e);return t&&Gl.w(t),!1},Zp=function(e){""!==e.desc&&""!==yf("API_REFER")&&Gl.w("[".concat(e.api,"] | ").concat(e.param," | ").concat(e.desc,", ").concat(yf("API_REFER")).concat(e.api))},Wp=function(){return yf("StringRequiredLog")},Yp=function(e){return yf("NonEmptyStringRequiredLog",e)},Jp=function(){return yf("NumberRequiredLog")},Xp=function(){return yf("UndefinedNotAllowedLog")},$p=function(){return yf("FileRequiredLog")},Qp=function(){return yf("FunctionRequiredLog")},ef=function(){return yf("ArrayRequiredLog")},tf=function(){return yf("NonEmptyArrayLog")},nf=function(){return yf("CallbackMissingLog")},of=function(){return yf("PositiveIntegerRequiredLog")},rf=function(e,t){return yf("StringNotLongerThanLog",e,t)},af=function(e,t){return yf("NumberLessThanLog",e,t)},sf=function(e){return yf("KeyValueStringRequiredLog",e)},uf=function(){return yf("PlainObjectRequiredLog")},cf=function(){return yf("NonEmptyContentRequiredLog")},lf=function(){return yf("FileNotSelectedLog")},df=function(){return yf("MessageInstanceRequiredLog")},pf=function(){return yf("NonAnonymousFunctionLog")},ff=function(){return yf("MessageExtensionNotAvailableLog")},hf={type:"String",required:!0},gf={type:"Array",required:!0},vf={type:"Object",required:!0},mf={type:"Boolean",required:!0},_f={type:"number",required:!0},yf=null,Mf={hookGetAPITips:function(e){yf=e},login:{userID:hf,userSig:hf},addToBlacklist:{userIDList:gf},removeFromBlacklist:{userIDList:gf},on:[{name:"eventName",type:"String",validator:function(e){return"string"==typeof e&&0!==e.length||(Zp({api:"on",param:"eventName",desc:Yp("eventName")}),!1)}},{name:"handler",type:"Function",validator:function(e){return"function"!=typeof e?(Zp({api:"on",param:"handler",desc:Qp()}),!1):(""===e.name&&Zp({api:"on",param:"handler",desc:pf()}),!0)}}],once:[{name:"eventName",type:"String",validator:function(e){return"string"==typeof e&&0!==e.length||(Zp({api:"once",param:"eventName",desc:Yp("eventName")}),!1)}},{name:"handler",type:"Function",validator:function(e){return"function"!=typeof e?(Zp({api:"once",param:"handler",desc:Qp()}),!1):(""===e.name&&Zp({api:"once",param:"handler",desc:pf()}),!0)}}],off:[{name:"eventName",type:"String",validator:function(e){return"string"==typeof e&&0!==e.length||(Zp({api:"off",param:"eventName",desc:Yp("eventName")}),!1)}},{name:"handler",type:"Function",validator:function(e){return"function"!=typeof e?(Zp({api:"off",param:"handler",desc:Qp()}),!1):(""===e.name&&Zp({api:"off",param:"handler",desc:pf()}),!0)}}],sendMessage:[t({name:"message"},vf)],setMessageExtensions:[t(t({name:"message"},vf),{},{validator:function(e){return e.status===Kp.SUCCESS&&!0===e.isSupportExtension||(Zp({api:"setMessageExtensions",param:"message",desc:ff()}),!1)}}),t({name:"extensions"},gf)],getMessageExtensions:[t(t({name:"message"},vf),{},{validator:function(e){return e.status===Kp.SUCCESS&&!0===e.isSupportExtension||(Zp({api:"getMessageExtensions",param:"message",desc:ff()}),!1)}})],deleteMessageExtensions:[t(t({name:"message"},vf),{},{validator:function(e){return e.status===Kp.SUCCESS&&!0===e.isSupportExtension||(Zp({api:"deleteMessageExtensions",param:"message",desc:ff()}),!1)}})],getMessageList:{conversationID:t(t({},hf),{},{validator:function(e){return zp(e)}}),nextReqMessageID:{type:"String"},count:{type:"Number",validator:function(e){return!(!id(e)&&!/^[1-9][0-9]*$/.test(e))||(Zp({api:"getMessageList",param:"count",desc:of()}),!1)}}},getMessageListHopping:{conversationID:t(t({},hf),{},{validator:function(e){return zp(e)}}),sequence:{type:"Number"},time:{type:"Number"},direction:{type:"Number",validator:function(e){return!(!id(e)&&0!==e&&1!==e)||(Zp({api:"getMessageListHopping",param:"direction",desc:yf("0Or1RequiredLog")}),!1)}},count:{type:"Number",validator:function(e){return!(!id(e)&&!/^[1-9][0-9]*$/.test(e))||(Zp({api:"getMessageListHopping",param:"count",desc:of}),!1)}}},setMessageRead:{conversationID:t(t({},hf),{},{validator:function(e){return zp(e)}})},setAllMessageRead:{scope:{type:"String",required:!1,validator:function(e){return!e||-1!==[Ir.READ_ALL_C2C_MSG,Ir.READ_ALL_GROUP_MSG,Ir.READ_ALL_MSG].indexOf(e)||(Zp({api:"setAllMessageRead",param:"scope",desc:"TIM.TYPES.READ_ALL_C2C_MSG or TIM.TYPES.READ_ALL_GROUP_MSG or TIM.TYPES.READ_ALL_MSG required"}),!1)}}},getConversationProfile:[t(t({name:"conversationID"},hf),{},{validator:function(e){return zp(e)}})],deleteConversation:[t(t({name:"conversationID"},hf),{},{validator:function(e){return zp(e)}})],clearHistoryMessage:[t(t({name:"conversationID"},hf),{},{validator:function(e){return zp(e)}})],pinConversation:{conversationID:t(t({},hf),{},{validator:function(e){return zp(e)}}),isPinned:t({},mf)},setConversationCustomData:{conversationIDList:t({},gf),customData:{type:"String",validator:function(e){return td(e)?!(e.length>256)||(Zp({api:"setConversationCustomData",param:"customData",desc:rf("customData",256)}),!1):(Zp({api:"setConversationCustomData",param:"customData",desc:Wp()}),!1)}}},markConversation:{conversationIDList:t({},gf),markType:{type:"number",validator:function(e){return ed(e)?e<=0?(Zp({api:"markConversation",param:"markType",desc:(t="markType",n=0,yf("NumberGreaterThanLog",t,n))}),!1):!(e>=Math.pow(2,64))||(Zp({api:"markConversation",param:"markType",desc:af("markType","Math.pow(2,64)")}),!1):(Zp({api:"markConversation",param:"markType",desc:Jp()}),!1);var t,n}},enableMark:t({},mf)},createConversationGroup:{conversationIDList:t({},gf),groupName:t(t({},hf),{},{validator:function(e){return!!e&&(!(e.length>32)||(Zp({api:"createConversationGroup",param:"groupName",desc:rf("groupName",32)}),!1))}})},deleteConversationGroup:[t({name:"groupName"},hf)],renameConversationGroup:{oldName:t({},hf),newName:t(t({},hf),{},{validator:function(e){return!!e&&(!(e.length>32)||(Zp({api:"renameConversationGroup",param:"newName",desc:rf("newName",32)}),!1))}})},addConversationsToGroup:{conversationIDList:t({},gf),groupName:t({},hf)},deleteConversationsFromGroup:{conversationIDList:t({},gf),groupName:t({},hf)},getGroupList:{groupProfileFilter:{type:"Array"}},getGroupProfile:{groupID:hf,groupCustomFieldFilter:{type:"Array"},memberCustomFieldFilter:{type:"Array"}},getGroupProfileAdvance:{groupIDList:gf},createGroup:{name:hf},joinGroup:{groupID:hf,type:{type:"String"},applyMessage:{type:"String"}},quitGroup:[t({name:"groupID"},hf)],handleApplication:{message:vf,handleAction:hf,handleMessage:{type:"String"}},changeGroupOwner:{groupID:hf,newOwnerID:hf},updateGroupProfile:{groupID:hf,muteAllMembers:{type:"Boolean"}},dismissGroup:[t({name:"groupID"},hf)],searchGroupByID:[t({name:"groupID"},hf)],initGroupAttributes:{groupID:hf,groupAttributes:t(t({},vf),{},{validator:function(e){var t=!0;return Object.keys(e).forEach((function(n){if(!td(e[n]))return Zp({api:"initGroupAttributes",param:"groupAttributes",desc:sf("value")}),t=!1})),t}})},setGroupAttributes:{groupID:hf,groupAttributes:t(t({},vf),{},{validator:function(e){var t=!0;return Object.keys(e).forEach((function(n){if(!td(e[n]))return Zp({api:"setGroupAttributes",param:"groupAttributes",desc:sf("value")}),t=!1})),t}})},deleteGroupAttributes:{groupID:hf,keyList:{type:"Array",validator:function(e){if(id(e)||!rd(e))return Zp({api:"deleteGroupAttributes",param:"keyList",desc:ef()}),!1;if(!Yd(e)){var t=!0;return e.forEach((function(e){if(!td(e))return Zp({api:"deleteGroupAttributes",param:"keyList",desc:yf("StringArrayRequiredLog")}),t=!1})),t}return!0}}},getGroupAttributes:{groupID:hf,keyList:{type:"Array",validator:function(e){if(id(e)||!rd(e))return Zp({api:"getGroupAttributes",param:"keyList",desc:ef()}),!1;if(!Yd(e)){var t=!0;return e.forEach((function(e){if(!td(e))return Zp({api:"getGroupAttributes",param:"keyList",desc:sf("key")}),t=!1})),t}return!0}}},setGroupCounters:{groupID:hf,counters:vf},increaseGroupCounter:{groupID:hf,key:hf,value:_f},decreaseGroupCounter:{groupID:hf,key:hf,value:_f},getGroupCounters:{groupID:hf},getGroupMemberList:{groupID:hf,count:{type:"Number"}},getGroupMemberProfile:{groupID:hf,userIDList:gf,memberCustomFieldFilter:{type:"Array"}},addGroupMember:{groupID:hf,userIDList:gf},setGroupMemberRole:{groupID:hf,userID:hf,role:hf},setGroupMemberMuteTime:{groupID:hf,userID:hf,muteTime:{type:"Number",validator:function(e){return e>=0}}},setGroupMemberNameCard:{groupID:hf,userID:{type:"String"},nameCard:{type:"String",validator:function(e){return td(e)?(e.length,!0):(Zp({api:"setGroupMemberNameCard",param:"nameCard",desc:Wp()}),!1)}}},setGroupMemberCustomField:{groupID:hf,userID:{type:"String"},memberCustomField:gf},deleteGroupMember:{groupID:hf},markGroupMemberList:{groupID:hf,markType:{type:"number",validator:function(e){return ed(e)?!(e<1e3)||(Zp({api:"markGroupMemberList",param:"markType",desc:(t="markType",n=1e3,yf("NumberGreaterOrEqualLog",t,n))}),!1):(Zp({api:"markGroupMemberList",param:"markType",desc:Jp()}),!1);var t,n}},userIDList:t({},gf),enableMark:t({},mf)},createTextMessage:{to:hf,conversationType:hf,payload:t(t({},vf),{},{validator:function(e){return od(e)?td(e.text)?0!==e.text.length||(Zp({api:"createTextMessage",param:"payload.text",desc:cf()}),!1):(Zp({api:"createTextMessage",param:"payload.text",desc:Wp()}),!1):(Zp({api:"createTextMessage",param:"payload",desc:uf()}),!1)}})},createTextAtMessage:{to:hf,conversationType:hf,payload:t(t({},vf),{},{validator:function(e){return od(e)?td(e.text)?0===e.text.length?(Zp({api:"createTextAtMessage",param:"payload.text",desc:cf()}),!1):!(e.atUserList&&!rd(e.atUserList))||(Zp({api:"createTextAtMessage",param:"payload.atUserList",desc:ef()}),!1):(Zp({api:"createTextAtMessage",param:"payload.text",desc:Wp()}),!1):(Zp({api:"createTextAtMessage",param:"payload",desc:uf()}),!1)}})},createCustomMessage:{to:hf,conversationType:hf,payload:t(t({},vf),{},{validator:function(e){return od(e)?e.data&&!td(e.data)?(Zp({api:"createCustomMessage",param:"payload.data",desc:Wp()}),!1):e.description&&!td(e.description)?(Zp({api:"createCustomMessage",param:"payload.description",desc:Wp()}),!1):!(e.extension&&!td(e.extension))||(Zp({api:"createCustomMessage",param:"payload.extension",desc:Wp()}),!1):(Zp({api:"createCustomMessage",param:"payload",desc:uf()}),!1)}})},createImageMessage:{to:hf,conversationType:hf,payload:t(t({},vf),{},{validator:function(e){if(!od(e))return Zp({api:"createImageMessage",param:"payload",desc:uf()}),!1;if(id(e.file))return Zp({api:"createImageMessage",param:"payload.file",desc:Xp()}),!1;if(ol){if(!(e.file instanceof HTMLInputElement||Ql(e.file)))return od(e.file)&&"undefined"!=typeof uni?0!==e.file.tempFilePaths.length&&0!==e.file.tempFiles.length||(Zp({api:"createImageMessage",param:"payload.file",desc:lf()}),!1):(Zp({api:"createImageMessage",param:"payload.file",desc:$p()}),!1);if(e.file instanceof HTMLInputElement&&0===e.file.files.length)return Zp({api:"createImageMessage",param:"payload.file",desc:lf()}),!1}return!0},onProgress:{type:"Function",required:!1,validator:function(e){return id(e)&&Zp({api:"createImageMessage",param:"onProgress",desc:nf()}),!0}}})},createAudioMessage:{to:hf,conversationType:hf,payload:t(t({},vf),{},{validator:function(e){return!!od(e)||(Zp({api:"createAudioMessage",param:"payload",desc:uf()}),!1)}}),onProgress:{type:"Function",required:!1,validator:function(e){return id(e)&&Zp({api:"createAudioMessage",param:"onProgress",desc:nf()}),!0}}},createVideoMessage:{to:hf,conversationType:hf,payload:t(t({},vf),{},{validator:function(e){if(!od(e))return Zp({api:"createVideoMessage",param:"payload",desc:uf()}),!1;if(id(e.file))return Zp({api:"createVideoMessage",param:"payload.file",desc:Xp()}),!1;if(ol){if(!(e.file instanceof HTMLInputElement||Ql(e.file)))return od(e.file)&&"undefined"!=typeof uni?!!Ql(e.file.tempFile)||(Zp({api:"createVideoMessage",param:"payload.file",desc:lf()}),!1):(Zp({api:"createVideoMessage",param:"payload.file",desc:$p()}),!1);if(e.file instanceof HTMLInputElement&&0===e.file.files.length)return Zp({api:"createVideoMessage",param:"payload.file",desc:lf()}),!1}return!0}}),onProgress:{type:"Function",required:!1,validator:function(e){return id(e)&&Zp({api:"createVideoMessage",param:"onProgress",desc:nf()}),!0}}},createFaceMessage:{to:hf,conversationType:hf,payload:t(t({},vf),{},{validator:function(e){return od(e)?ed(e.index)?!!td(e.data)||(Zp({api:"createFaceMessage",param:"payload.data",desc:Wp()}),!1):(Zp({api:"createFaceMessage",param:"payload.index",desc:Jp()}),!1):(Zp({api:"createFaceMessage",param:"payload",desc:uf()}),!1)}})},createFileMessage:{to:hf,conversationType:hf,payload:t(t({},vf),{},{validator:function(e){if(!od(e))return Zp({api:"createFileMessage",param:"payload",desc:uf()}),!1;if(id(e.file))return Zp({api:"createFileMessage",param:"payload.file",desc:Xp()}),!1;if(ol){if(!(e.file instanceof HTMLInputElement||Ql(e.file)))return od(e.file)&&"undefined"!=typeof uni?0!==e.file.tempFilePaths.length&&0!==e.file.tempFiles.length||(Zp({api:"createFileMessage",param:"payload.file",desc:lf()}),!1):(Zp({api:"createFileMessage",param:"payload.file",desc:$p()}),!1);if(e.file instanceof HTMLInputElement&&0===e.file.files.length)return Zp({api:"createFileMessage",param:"payload.file",desc:lf()}),!1}return!0}}),onProgress:{type:"Function",required:!1,validator:function(e){return id(e)&&Zp({api:"createFileMessage",param:"onProgress",desc:nf()}),!0}}},createLocationMessage:{to:hf,conversationType:hf,payload:t(t({},vf),{},{validator:function(e){return od(e)?td(e.description)?ed(e.longitude)?!!ed(e.latitude)||(Zp({api:"createLocationMessage",param:"payload.latitude",desc:Jp()}),!1):(Zp({api:"createLocationMessage",param:"payload.longitude",desc:Jp()}),!1):(Zp({api:"createLocationMessage",param:"payload.description",desc:Wp()}),!1):(Zp({api:"createLocationMessage",param:"payload",desc:uf()}),!1)}})},createMergerMessage:{to:hf,conversationType:hf,payload:t(t({},vf),{},{validator:function(e){if(Yd(e.messageList))return Zp({api:"createMergerMessage",param:"payload.messageList",desc:tf()}),!1;if(Yd(e.compatibleText))return Zp({api:"createMergerMessage",param:"payload.compatibleText",desc:Yp("compatibleText")}),!1;var t=!1;return e.messageList.forEach((function(e){e.status===Kp.FAIL&&(t=!0)})),!t||(Zp({api:"createMergerMessage",param:"payload.messageList",desc:yf("MergeFailedMessageLog")}),!1)}})},revokeMessage:[t(t({name:"message"},vf),{},{validator:function(e){return Yd(e)?(Zp({api:"revokeMessage",param:"message",desc:df()}),!1):e.conversationType===Ir.CONV_SYSTEM?(Zp({api:"revokeMessage",param:"message",desc:yf("MessageCanBeRevokedDesc")}),!1):!0!==e.isRevoked||(Zp({api:"revokeMessage",param:"message",desc:yf("MessageRevokedLog")}),!1)}})],deleteMessage:[t(t({name:"messageList"},gf),{},{validator:function(e){return!Yd(e)||(Zp({api:"deleteMessage",param:"messageList",desc:tf()}),!1)}})],translateText:{sourceTextList:gf,sourceLanguage:hf,targetLanguage:hf},modifyMessage:[t(t({name:"message"},vf),{},{validator:function(e){return Yd(e)?(Zp({api:"modifyMessage",param:"message",desc:df()}),!1):e.conversationType===Ir.CONV_SYSTEM?(Zp({api:"modifyMessage",param:"message",desc:yf("MessageCanBeModifiedLog")}),!1):!0!==e._onlineOnlyFlag||(Zp({api:"modifyMessage",param:"message",desc:yf("OnlineMessageNotSupportLog")}),!1)}})],getUserProfile:{userIDList:{type:"Array",validator:function(e){return rd(e)?(0===e.length&&Zp({api:"getUserProfile",param:"userIDList",desc:tf()}),!0):(Zp({api:"getUserProfile",param:"userIDList",desc:ef()}),!1)}}},updateMyProfile:{profileCustomField:{type:"Array",validator:function(e){return!!id(e)||!!rd(e)||(Zp({api:"updateMyProfile",param:"profileCustomField",desc:ef()}),!1)}}},setSelfStatus:{customStatus:{type:"String",validator:function(e){return!!td(e)||(Zp({api:"setSelfStatus",param:"customStatus",desc:Wp()}),!1)}}},getUserStatus:{userIDList:{type:"Array",validator:function(e){return rd(e)?0!==e.length||(Zp({api:"getUserStatus",param:"userIDList",desc:tf()}),!1):(Zp({api:"getUserStatus",param:"userIDList",desc:ef()}),!1)}}},subscribeUserStatus:{userIDList:{type:"Array",validator:function(e){return rd(e)?0!==e.length||(Zp({api:"subscribeUserStatus",param:"userIDList",desc:tf()}),!1):(Zp({api:"subscribeUserStatus",param:"userIDList",desc:ef()}),!1)}}},unsubscribeUserStatus:{userIDList:{type:"Array",validator:function(e){return!e||!!rd(e)||(Zp({api:"subscribeUserStatus",param:"userIDList",desc:ef()}),!1)}}},addFriend:{to:hf,source:{type:"String",required:!0,validator:function(e){return!!e&&(e.startsWith("AddSource_Type_")?!(e.replace("AddSource_Type_","").length>8)||(Zp({api:"addFriend",param:"source",desc:rf("keyword",8)}),!1):(Zp({api:"addFriend",param:"source",desc:yf("SourcePrefixLog")}),!1))}},remark:{type:"String",required:!1,validator:function(e){return!(td(e)&&e.length>96)||(Zp({api:"addFriend",param:"remark",desc:rf("remark",96)}),!1)}}},deleteFriend:{userIDList:gf},checkFriend:{userIDList:gf},getFriendProfile:{userIDList:gf},updateFriend:{userID:hf,remark:{type:"String",required:!1,validator:function(e){return!(td(e)&&e.length>96)||(Zp({api:"updateFriend",param:"remark",desc:rf("remark",96)}),!1)}},friendCustomField:{type:"Array",required:!1,validator:function(e){if(e){if(!rd(e))return Zp({api:"updateFriend",param:"friendCustomField",desc:ef()}),!1;var t=!0;return e.forEach((function(e){return td(e.key)&&-1!==e.key.indexOf("Tag_SNS_Custom")?td(e.value)?e.key.replace("Tag_SNS_Custom_","").length>8?(Zp({api:"updateFriend",param:"friendCustomField",desc:rf("keyword",8)}),t=!1):void 0:(Zp({api:"updateFriend",param:"friendCustomField",desc:sf("value")}),t=!1):(Zp({api:"updateFriend",param:"friendCustomField",desc:yf("FriendCustomFieldPrefixLog")}),t=!1)})),t}return!0}}},acceptFriendApplication:{userID:hf},refuseFriendApplication:{userID:hf},deleteFriendApplication:{userID:hf},createFriendGroup:{name:hf},deleteFriendGroup:{name:hf},addToFriendGroup:{name:hf,userIDList:gf},removeFromFriendGroup:{name:hf,userIDList:gf},renameFriendGroup:{oldName:hf,newName:hf},sendMessageReadReceipt:[{name:"messageList",type:"Array",validator:function(e){return rd(e)?0!==e.length||(Zp({api:"sendMessageReadReceipt",param:"messageList",desc:tf()}),!1):(Zp({api:"sendMessageReadReceipt",param:"messageList",desc:ef()}),!1)}}],getMessageReadReceiptList:[{name:"messageList",type:"Array",validator:function(e){return rd(e)?0!==e.length||(Zp({api:"getMessageReadReceiptList",param:"messageList",desc:tf()}),!1):(Zp({api:"getMessageReadReceiptList",param:"messageList",desc:ef()}),!1)}}],createTopicInCommunity:{groupID:hf,topicName:hf},deleteTopicFromCommunity:{groupID:hf,topicIDList:{type:"Array",validator:function(e){return!e||!!rd(e)||(Zp({api:"deleteTopicFromCommunity",param:"topicIDList",desc:ef()}),!1)}}},updateTopicProfile:{groupID:hf,topicID:hf},getTopicList:{groupID:hf,topicIDList:{type:"Array",validator:function(e){return!e||!!rd(e)||(Zp({api:"getTopicList",param:"topicIDList",desc:ef()}),!1)}}}},If={login:1,logout:1,on:1,once:1,off:1,setLogLevel:1,registerPlugin:1,destroy:1,createTextMessage:1,createTextAtMessage:1,createImageMessage:1,createAudioMessage:1,createVideoMessage:1,createCustomMessage:1,createFaceMessage:1,createFileMessage:1,createLocationMessage:1,createMergerMessage:1,downloadMergerMessage:1,createForwardMessage:1,sendMessage:1,resendMessage:1,revokeMessage:1,deleteMessage:1,translateText:1,modifyMessage:1,sendMessageReadReceipt:1,getGroupMessageReadMemberList:1,getMessageReadReceiptList:1,setMessageExtensions:1,getMessageExtensions:1,deleteMessageExtensions:1,getMessageList:1,findMessage:1,getMessageListHopping:1,setMessageRead:1,setAllMessageRead:1,getConversationList:1,getConversationProfile:1,deleteConversation:1,pinConversation:1,getTotalUnreadMessageCount:1,setConversationCustomData:1,markConversation:1,createConversationGroup:1,getConversationGroupList:1,deleteConversationGroup:1,renameConversationGroup:1,addConversationsToGroup:1,deleteConversationsFromGroup:1,clearHistoryMessage:1,getGroupList:1,getGroupProfile:1,createGroup:1,joinGroup:1,updateGroupProfile:1,quitGroup:1,dismissGroup:1,changeGroupOwner:1,searchGroupByID:1,setMessageRemindType:1,getGroupApplicationList:1,handleGroupApplication:1,initGroupAttributes:1,setGroupAttributes:1,deleteGroupAttributes:1,getGroupAttributes:1,setGroupCounters:1,increaseGroupCounter:1,decreaseGroupCounter:1,getGroupCounters:1,getJoinedCommunityList:1,createTopicInCommunity:1,deleteTopicFromCommunity:1,updateTopicProfile:1,getTopicList:1,getGroupMemberProfile:1,getGroupMemberList:1,addGroupMember:1,deleteGroupMember:1,setGroupMemberNameCard:1,setGroupMemberMuteTime:1,setGroupMemberRole:1,setGroupMemberCustomField:1,getGroupOnlineMemberCount:1,markGroupMemberList:1,getMyProfile:1,getUserProfile:1,updateMyProfile:1,setSelfStatus:1,getUserStatus:1,subscribeUserStatus:1,unsubscribeUserStatus:1,getBlacklist:1,addToBlacklist:1,removeFromBlacklist:1,getFriendList:1,addFriend:1,deleteFriend:1,checkFriend:1,updateFriend:1,getFriendProfile:1,getFriendApplicationList:1,refuseFriendApplication:1,deleteFriendApplication:1,acceptFriendApplication:1,setFriendApplicationRead:1,getFriendGroupList:1,createFriendGroup:1,renameFriendGroup:1,deleteFriendGroup:1,addToFriendGroup:1,removeFromFriendGroup:1,callExperimentalAPI:1},Cf=!!Ds&&w((function(){Ds.prototype.finally.call({then:function(){}},(function(){}))}));if(on({target:"Promise",proto:!0,real:!0,forced:Cf},{finally:function(e){var t=qs(this,re("Promise")),n=te(e);return this.then(n?function(n){return bu(t,e()).then((function(){return n}))}:e,n?function(n){return bu(t,e()).then((function(){throw n}))}:e)}}),te(Ds)){var kf=re("Promise").prototype.finally;Ds.prototype.finally!==kf&&Dt(Ds.prototype,"finally",kf,{unsafe:!0})}var Tf=w((function(){if("function"==typeof ArrayBuffer){var e=new ArrayBuffer(8);Object.isExtensible(e)&&Object.defineProperty(e,"a",{value:8})}})),Sf=Object.isExtensible,bf=w((function(){Sf(1)}))||Tf?function(e){return!!ne(e)&&(!Tf||"ArrayBuffer"!=W(e))&&(!Sf||Sf(e))}:Sf,Df=!w((function(){return Object.isExtensible(Object.preventExtensions({}))})),Ef=D((function(e){var t=ot.f,n=!1,o=Oe("meta"),r=0,i=function(e){t(e,o,{value:{objectID:"O"+r++,weakData:{}}})},a=e.exports={enable:function(){a.enable=function(){},n=!0;var e=Kt.f,t=j([].splice),r={};r[o]=1,e(r).length&&(Kt.f=function(n){for(var r=e(n),i=0,a=r.length;i<a;i++)if(r[i]===o){t(r,i,1);break}return r},on({target:"Object",stat:!0,forced:!0},{getOwnPropertyNames:ds.f}))},fastKey:function(e,t){if(!ne(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!Ae(e,o)){if(!bf(e))return"F";if(!t)return"E";i(e)}return e[o].objectID},getWeakData:function(e,t){if(!Ae(e,o)){if(!bf(e))return!0;if(!t)return!1;i(e)}return e[o].weakData},onFreeze:function(e){return Df&&n&&bf(e)&&!Ae(e,o)&&i(e),e}};ht[o]=!0})),Af=(Ef.enable,Ef.fastKey,Ef.getWeakData,Ef.onFreeze,ot.f),Lf=Ef.fastKey,Rf=Ct.set,wf=Ct.getterFor;!function(e,t,n){var o=-1!==e.indexOf("Map"),r=-1!==e.indexOf("Weak"),i=o?"set":"add",a=R[e],s=a&&a.prototype,u=a,c={},l=function(e){var t=j(s[e]);Dt(s,e,"add"==e?function(e){return t(this,0===e?0:e),this}:"delete"==e?function(e){return!(r&&!ne(e))&&t(this,0===e?0:e)}:"get"==e?function(e){return r&&!ne(e)?void 0:t(this,0===e?0:e)}:"has"==e?function(e){return!(r&&!ne(e))&&t(this,0===e?0:e)}:function(e,n){return t(this,0===e?0:e,n),this})};if(tn(e,!te(a)||!(r||s.forEach&&!w((function(){(new a).entries().next()})))))u=n.getConstructor(t,e,o,i),Ef.enable();else if(tn(e,!0)){var d=new u,p=d[i](r?{}:-0,1)!=d,f=w((function(){d.has(1)})),h=Uo((function(e){new a(e)})),g=!r&&w((function(){for(var e=new a,t=5;t--;)e[i](t,t);return!e.has(-0)}));h||((u=t((function(e,t){ws(e,s);var n=xr(new a,e,u);return null!=t&&Gs(t,n[i],{that:n,AS_ENTRIES:o}),n}))).prototype=s,s.constructor=u),(f||g)&&(l("delete"),l("has"),o&&l("get")),(g||p)&&l(i),r&&s.clear&&delete s.clear}c[e]=u,on({global:!0,forced:u!=a},c),or(u,e),r||n.setStrong(u,e,o)}("Map",(function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}}),{getConstructor:function(e,t,n,o){var r=e((function(e,r){ws(e,i),Rf(e,{type:t,index:Hn(null),first:void 0,last:void 0,size:0}),O||(e.size=0),null!=r&&Gs(r,e[o],{that:e,AS_ENTRIES:n})})),i=r.prototype,a=wf(t),s=function(e,t,n){var o,r,i=a(e),s=u(e,t);return s?s.value=n:(i.last=s={index:r=Lf(t,!0),key:t,value:n,previous:o=i.last,next:void 0,removed:!1},i.first||(i.first=s),o&&(o.next=s),O?i.size++:e.size++,"F"!==r&&(i.index[r]=s)),e},u=function(e,t){var n,o=a(e),r=Lf(t);if("F"!==r)return o.index[r];for(n=o.first;n;n=n.next)if(n.key==t)return n};return Es(i,{clear:function(){for(var e=a(this),t=e.index,n=e.first;n;)n.removed=!0,n.previous&&(n.previous=n.previous.next=void 0),delete t[n.index],n=n.next;e.first=e.last=void 0,O?e.size=0:this.size=0},delete:function(e){var t=a(this),n=u(this,e);if(n){var o=n.next,r=n.previous;delete t.index[n.index],n.removed=!0,r&&(r.next=o),o&&(o.previous=r),t.first==n&&(t.first=o),t.last==n&&(t.last=r),O?t.size--:this.size--}return!!n},forEach:function(e){for(var t,n=a(this),o=jn(e,arguments.length>1?arguments[1]:void 0);t=t?t.next:n.first;)for(o(t.value,t.key,this);t&&t.removed;)t=t.previous},has:function(e){return!!u(this,e)}}),Es(i,n?{get:function(e){var t=u(this,e);return t&&t.value},set:function(e,t){return s(this,0===e?0:e,t)}}:{add:function(e){return s(this,e=0===e?0:e,e)}}),O&&Af(i,"size",{get:function(){return a(this).size}}),r},setStrong:function(e,t,n){var o=t+" Iterator",r=wf(t),i=wf(o);vr(e,t,(function(e,t){Rf(this,{type:o,target:e,state:r(e),kind:t,last:void 0})}),(function(){for(var e=i(this),t=e.kind,n=e.last;n&&n.removed;)n=n.previous;return e.target&&(e.last=n=n?n.next:e.state.first)?"keys"==t?{value:n.key,done:!1}:"values"==t?{value:n.value,done:!1}:{value:[n.key,n.value],done:!1}:(e.target=void 0,{value:void 0,done:!0})}),n?"entries":"values",!n,!0),Ls(t)}});var Of=/MSIE .\./.test(ae),Nf=R.Function,Pf=function(e){return function(t,n){var o=Vs(arguments.length,1)>2,r=te(t)?t:Nf(t),i=o?Dn(arguments,2):void 0;return e(o?function(){Ca(r,this,i)}:r,n)}};on({global:!0,bind:!0,forced:Of},{setTimeout:Pf(R.setTimeout),setInterval:Pf(R.setInterval)});var Gf=so.filter,Uf=kr("filter");on({target:"Array",proto:!0,forced:!Uf},{filter:function(e){return Gf(this,e,arguments.length>1?arguments[1]:void 0)}});var xf,Ff=1,qf=2,Bf=3,Vf=4,Hf=6,Kf=7,jf=8,zf=9,Zf=10,Wf=11,Yf=12,Jf=13,Xf=14,$f=15,Qf=16,eh=17,th=18,nh=19,oh=20,rh=21,ih=22,ah=23,sh=24,uh=25,ch=26,lh=27,dh=28,ph=29,fh=30,hh=31,gh=32,vh=function(){function e(t){r(this,e),this._m=t,this._n=""}return a(e,[{key:"isLoggedIn",value:function(){return this._m.getModule(Yf).isLoggedIn()}},{key:"isOversea",value:function(){return this._m.getModule(Yf).isOversea()}},{key:"isPrivateNetWork",value:function(){return this._m.getModule(Yf).isPrivateNetWork()}},{key:"getMyUserID",value:function(){return this._m.getModule(Yf).getUserID()}},{key:"getMyTinyID",value:function(){return this._m.getModule(Yf).getTinyID()}},{key:"getSDKAppID",value:function(){return this._m.getModule(Yf).getSDKAppID()}},{key:"isIntl",value:function(){return this._m.getModule(Yf).isIntl()}},{key:"isDevMode",value:function(){return this._m.getModule(Yf).isDevMode()}},{key:"getModule",value:function(e){return this._m.getModule(e)}},{key:"getPlatform",value:function(){return il}},{key:"getNetworkType",value:function(){return this._m.getModule($f).getNetworkType()}},{key:"probeNetwork",value:function(e){return this._m.getModule($f).probe(e)}},{key:"getCloudConfig",value:function(e){return this._m.getModule(ah).getCloudConfig(e)}},{key:"emitOuterEvent",value:function(e,t){this._m.getOuterEmitterInstance().emit(e,t)}},{key:"emitInnerEvent",value:function(e,t){this._m.getInnerEmitterInstance().emit(e,t)}},{key:"getInnerEmitterInstance",value:function(){return this._m.getInnerEmitterInstance()}},{key:"generateTjgID",value:function(e){return this._m.getModule(Yf).getTinyID()+"-"+e.random}},{key:"filterModifiedMessage",value:function(e){if(!Yd(e)){var t=e.filter((function(e){return!0===e.isModified}));t.length>0&&this.emitOuterEvent(Mr.MESSAGE_MODIFIED,t)}}},{key:"filterUnmodifiedMessage",value:function(e){return Yd(e)?[]:e.filter((function(e){return!1===e.isModified}))}},{key:"request",value:function(e){return this._m.getModule(oh).request(e)}},{key:"canIUse",value:function(e){return this._m.getModule(lh).canIUse(e)}},{key:"getErrorMessage",value:function(e,t,n){return this._m.getErrorMessage(e,t,n)}},{key:"outputWarning",value:function(e,t,n){var o=this.getErrorMessage(e,t,n);o&&Gl.w(o)}}]),e}(),mh="wslogin",_h="wslogout",yh="wshello",Mh="KickOther",Ih="getmsg",Ch="authkey",kh="sendmsg",Th="send_group_msg",Sh="portrait_get_all",bh="portrait_set",Dh="black_list_get",Eh="black_list_add",Ah="black_list_delete",Lh="friend_get",Rh="friend_get_specified",wh="friend_check",Oh="friend_delete",Nh="friend_add",Ph="friend_update",Gh="friend_response",Uh="pendency_get",xh="pendency_delete",Fh="pendency_report",qh="group_get",Bh="group_add",Vh="group_delete",Hh="group_update",Kh="msgwithdraw",jh="msgreaded",zh="set_c2c_peer_mute_notifications",Zh="get_c2c_peer_mute_notifications",Wh="getroammsg",Yh="get_peer_read_time",Jh="delete_c2c_msg_ramble",Xh="modify_c2c_msg",$h="set_key_values",Qh="get_key_values",eg="page_get",tg="get",ng="delete",og="clear_msg",rg="top",ig="deletemsg",ag="set_conv_custom_data",sg="mark_contact",ug="create_contact_group",cg="del_contact_group",lg="update_contact_group",dg="add_conv_to_group",pg="del_conv_from_group",fg="get_contact_group",hg="get_joined_group_list",gg="get_group_self_member_info",vg="create_group",mg="destroy_group",_g="modify_group_base_info",yg="apply_join_group",Mg="apply_join_group_noauth",Ig="quit_group",Cg="get_group_public_info",kg="change_group_owner",Tg="handle_apply_join_group",Sg="handle_invite_join_group",bg="group_msg_recall",Dg="msg_read_report",Eg="read_all_unread_msg",Ag="group_msg_get",Lg="get_group_msg_receipt",Rg="group_msg_receipt",wg="c2c_msg_read_receipt",Og="get_group_msg_receipt_detail",Ng="get_pendency",Pg="deletemsg",Gg="get_msg",Ug="get_msg_noauth",xg="get_online_member_num",Fg="delete_group_ramble_msg_by_seq",qg="modify_group_msg",Bg="set_group_attr",Vg="modify_group_attr",Hg="delete_group_attr",Kg="clear_group_attr",jg="get_group_attr",zg="group_set_key_values",Zg="group_get_key_values",Wg="get_group_notify",Yg="update_group_counter",Jg="get_group_counter",Xg="get_group_member_info",$g="get_members",Qg="get_specified_group_member_info",ev="add_group_member",tv="delete_group_member",nv="ban_group_member",ov="modify_group_member_info",rv="modify_user_info",iv="cos",av="pre_sig",sv="video_cover",uv="tim_web_report_v2",cv="alive",lv="msg_push",dv="multi_msg_push_ws",pv="ws_msg_push_ack",fv="stat_forceoffline",hv="save_relay_json_msg",gv="get_relay_json_msg",vv="fetch_config",mv="push_configv2",_v="fetch_imsdk_purchase_bitsv2",yv="push_imsdk_purchase_bitsv2",Mv="notify2",Iv="create_topic",Cv="destroy_topic",kv="modify_topic",Tv="get_topic",Sv="ws_set_custom_status",bv="ws_get_user_status",Dv="ws_status_subscribe",Ev="ws_status_unsubscribe",Av="ws_stat_background",Lv="ws_stat_foreground",Rv="ws_stat_settoken",wv="get_local_words",Ov="ws_batch_trans_text",Nv=2e3,Pv=2002,Gv=2003,Uv=2022,xv=2023,Fv=2024,qv=2025,Bv=2040,Vv=2041,Hv=2100,Kv=2101,jv=2105,zv=2106,Zv=2108,Wv=2109,Yv=2110,Jv=2111,Xv=2112,$v=2114,Qv=2115,em=2116,tm=2117,nm=2251,om=2252,rm=2253,im=2300,am=2301,sm=2350,um=2351,cm=2352,lm=2400,dm=2401,pm=2402,fm=2403,hm=2450,gm=2451,vm=2452,mm=2453,_m=2480,ym=2481,Mm=2500,Im=2501,Cm=2502,km=2503,Tm=2600,Sm=2601,bm=2602,Dm=2603,Em=2620,Am=2621,Lm=2622,Rm=2623,wm=2660,Om=2661,Nm=2662,Pm=2681,Gm=2682,Um=2683,xm=2684,Fm=2685,qm=2686,Bm=2700,Vm=2701,Hm=2710,Km=2711,jm=2716,zm=2721,Zm=2722,Wm=2742,Ym=2800,Jm=2801,Xm=2805,$m=2903,Qm=2905,e_=2996,t_=2997,n_=2998,o_=2999,r_=3e3,i_=3001,a_=3002,s_=3003,u_=3004,c_=3005,l_=3006,d_=3021,p_=3122,f_=3123,h_=20002,g_=70001,v_=1002,m_=60022,__="networkRTT",y_="messageE2EDelay",M_="sendMessageC2C",I_="sendMessageGroup",C_="sendMessageGroupAV",k_="sendMessageRichMedia",T_="cosUpload",S_="messageReceivedGroup",b_="messageReceivedGroupAVPush",D_="messageReceivedGroupAVPull",E_=(s(xf={},__,2),s(xf,y_,3),s(xf,M_,4),s(xf,I_,5),s(xf,C_,6),s(xf,k_,7),s(xf,S_,8),s(xf,b_,9),s(xf,D_,10),s(xf,T_,11),xf),A_={info:4,warning:5,error:6},L_={wifi:1,"2g":2,"3g":3,"4g":4,"5g":5,unknown:6,none:7,online:8},R_={login:4},w_=function(){function e(t){r(this,e),this._n="SSOLogData",this.eventType=R_[t]||0,this.timestamp=0,this.networkType=8,this.code=0,this.message="",this.moreMessage="",this.extension=t,this.costTime=0,this.duplicate=!1,this.level=4,this.uiPlatform=void 0,this._sentFlag=!1,this._startts=Ll()}return a(e,[{key:"updateTimeStamp",value:function(){this.timestamp=Ll()}},{key:"start",value:function(e){return this._startts=e,this}},{key:"end",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this._sentFlag){var n=Ll();0===this.costTime&&(this.costTime=n-this._startts),this.setMoreMessage("startts:".concat(this._startts," endts:").concat(n)),t?(this._sentFlag=!0,this._eventStatModule&&this._eventStatModule.pushIn(this)):setTimeout((function(){e._sentFlag=!0,e._eventStatModule&&e._eventStatModule.pushIn(e)}),0)}}},{key:"setError",value:function(e,t,n){if(!(e instanceof Error))return Gl.w("".concat(this._n,".setError value not instanceof Error, please check!")),this;if(this._sentFlag)return this;if(this.setNetworkType(n),t)e.code&&this.setCode(e.code),e.message&&this.setMoreMessage(e.message);else{var o=Xm;this.setCode(o)}return this.setLevel("error"),this}},{key:"setCode",value:function(e){return id(e)||this._sentFlag||("ECONNABORTED"===e&&(this.code=103),ed(e)?this.code=e:Gl.w("".concat(this._n,".setCode value not a number, please check!"),e,o(e))),this}},{key:"setMessage",value:function(e){return id(e)||this._sentFlag||(ed(e)&&(this.message=e.toString()),td(e)&&(this.message=e)),this}},{key:"setCostTime",value:function(e){return this.costTime=e,this}},{key:"setLevel",value:function(e){return id(e)||this._sentFlag||(this.level=A_[e]),this}},{key:"setMoreMessage",value:function(e){return Yd(this.moreMessage)?this.moreMessage="".concat(e):this.moreMessage+=" ".concat(e),this}},{key:"setNetworkType",value:function(e){if(id(e))Gl.w("".concat(this._n,".setNetworkType value is undefined, please check!"));else{var t=L_[e.toLowerCase()];id(t)||(this.networkType=t)}return this}},{key:"getStartTs",value:function(){return this._startts}},{key:"setUIPlatform",value:function(e){this.uiPlatform=e}}],[{key:"bindEventStatModule",value:function(t){e.prototype._eventStatModule=t}}]),e}(),O_=F.f,N_=j(O_),P_=j([].push),G_=function(e){return function(t){for(var n,o=ee(t),r=Pn(o),i=r.length,a=0,s=[];i>a;)n=r[a++],O&&!N_(o,n)||P_(s,e?[n,o[n]]:o[n]);return s}},U_=(G_(!0),G_(!1));on({target:"Object",stat:!0},{values:function(e){return U_(e)}});var x_=function(){function e(t){r(this,e),this.type=Ir.MSG_TEXT,this.content={text:t.text||""}}return a(e,[{key:"setText",value:function(e){this.content.text=e}},{key:"sendable",value:function(){return 0!==this.content.text.length}}]),e}(),F_=xe("iterator"),q_=!w((function(){var e=new URL("b?a=1&b=2&c=3","http://a"),t=e.searchParams,n="";return e.pathname="c%20d",t.forEach((function(e,o){t.delete("b"),n+=o+e})),!t.sort||"http://a/c%20d?a=1&c=3"!==e.href||"3"!==t.get("c")||"a=1"!==String(new URLSearchParams("?a=1"))||!t[F_]||"a"!==new URL("https://a@b").username||"b"!==new URLSearchParams(new URLSearchParams("a=b")).get("a")||"xn--e1aybc"!==new URL("http://\u0442\u0435\u0441\u0442").host||"#%D0%B1"!==new URL("http://a#\u0431").hash||"a1c3"!==n||"x"!==new URL("http://x",void 0).host})),B_=Object.assign,V_=Object.defineProperty,H_=j([].concat),K_=!B_||w((function(){if(O&&1!==B_({b:1},B_(V_({},"a",{enumerable:!0,get:function(){V_(this,"b",{value:3,enumerable:!1})}}),{b:2})).b)return!0;var e={},t={},n=Symbol();return e[n]=7,"abcdefghijklmnopqrst".split("").forEach((function(e){t[e]=e})),7!=B_({},e)[n]||"abcdefghijklmnopqrst"!=Pn(B_({},t)).join("")}))?function(e,t){for(var n=De(e),o=arguments.length,r=1,i=jt.f,a=F.f;o>r;)for(var s,u=X(arguments[r++]),c=i?H_(Pn(u),i(u)):Pn(u),l=c.length,d=0;l>d;)s=c[d++],O&&!G(a,u,s)||(n[s]=u[s]);return n}:B_,j_=/[^\0-\u007E]/,z_=/[.\u3002\uFF0E\uFF61]/g,Z_="Overflow: input needs wider integers to process",W_=R.RangeError,Y_=j(z_.exec),J_=Math.floor,X_=String.fromCharCode,$_=j("".charCodeAt),Q_=j([].join),ey=j([].push),ty=j("".replace),ny=j("".split),oy=j("".toLowerCase),ry=function(e){return e+22+75*(e<26)},iy=function(e,t,n){var o=0;for(e=n?J_(e/700):e>>1,e+=J_(e/t);e>455;)e=J_(e/35),o+=36;return J_(o+36*e/(e+38))},ay=function(e){var t,n,o=[],r=(e=function(e){for(var t=[],n=0,o=e.length;n<o;){var r=$_(e,n++);if(r>=55296&&r<=56319&&n<o){var i=$_(e,n++);56320==(64512&i)?ey(t,((1023&r)<<10)+(1023&i)+65536):(ey(t,r),n--)}else ey(t,r)}return t}(e)).length,i=128,a=0,s=72;for(t=0;t<e.length;t++)(n=e[t])<128&&ey(o,X_(n));var u=o.length,c=u;for(u&&ey(o,"-");c<r;){var l=2147483647;for(t=0;t<e.length;t++)(n=e[t])>=i&&n<l&&(l=n);var d=c+1;if(l-i>J_((2147483647-a)/d))throw W_(Z_);for(a+=(l-i)*d,i=l,t=0;t<e.length;t++){if((n=e[t])<i&&++a>2147483647)throw W_(Z_);if(n==i){for(var p=a,f=36;;){var h=f<=s?1:f>=s+26?26:f-s;if(p<h)break;var g=p-h,v=36-h;ey(o,X_(ry(h+g%v))),p=J_(g/v),f+=36}ey(o,X_(ry(p))),s=iy(a,d,c==u),a=0,c++}}a++,i++}return Q_(o,"")},sy=Math.floor,uy=function e(t,n){var o=t.length,r=sy(o/2);return o<8?cy(t,n):ly(t,e(us(t,0,r),n),e(us(t,r),n),n)},cy=function(e,t){for(var n,o,r=e.length,i=1;i<r;){for(o=i,n=e[i];o&&t(e[o-1],n)>0;)e[o]=e[--o];o!==i++&&(e[o]=n)}return e},ly=function(e,t,n,o){for(var r=t.length,i=n.length,a=0,s=0;a<r||s<i;)e[a+s]=a<r&&s<i?o(t[a],n[s])<=0?t[a++]:n[s++]:a<r?t[a++]:n[s++];return e},dy=uy,py=xe("iterator"),fy=Ct.set,hy=Ct.getterFor("URLSearchParams"),gy=Ct.getterFor("URLSearchParamsIterator"),vy=re("fetch"),_y=re("Request"),yy=re("Headers"),My=_y&&_y.prototype,Iy=yy&&yy.prototype,Cy=R.RegExp,ky=R.TypeError,Ty=R.decodeURIComponent,Sy=R.encodeURIComponent,by=j("".charAt),Dy=j([].join),Ey=j([].push),Ay=j("".replace),Ly=j([].shift),Ry=j([].splice),wy=j("".split),Oy=j("".slice),Ny=/\+/g,Py=Array(4),Gy=function(e){return Py[e-1]||(Py[e-1]=Cy("((?:%[\\da-f]{2}){"+e+"})","gi"))},Uy=function(e){try{return Ty(e)}catch(XD){return e}},xy=function(e){var t=Ay(e,Ny," "),n=4;try{return Ty(t)}catch(XD){for(;n;)t=Ay(t,Gy(n--),Uy);return t}},Fy=/[!'()~]|%20/g,qy={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+"},By=function(e){return qy[e]},Vy=function(e){return Ay(Sy(e),Fy,By)},Hy=ar((function(e,t){fy(this,{type:"URLSearchParamsIterator",iterator:Lo(hy(e).entries),kind:t})}),"Iterator",(function(){var e=gy(this),t=e.kind,n=e.iterator.next(),o=n.value;return n.done||(n.value="keys"===t?o.key:"values"===t?o.value:[o.key,o.value]),n}),!0),Ky=function(e){this.entries=[],this.url=null,void 0!==e&&(ne(e)?this.parseObject(e):this.parseQuery("string"==typeof e?"?"===by(e,0)?Oy(e,1):e:pn(e)))};Ky.prototype={type:"URLSearchParams",bindURL:function(e){this.url=e,this.update()},parseObject:function(e){var t,n,o,r,i,a,s,u=Eo(e);if(u)for(n=(t=Lo(e,u)).next;!(o=G(n,t)).done;){if(i=(r=Lo($e(o.value))).next,(a=G(i,r)).done||(s=G(i,r)).done||!G(i,r).done)throw ky("Expected sequence with length 2");Ey(this.entries,{key:pn(a.value),value:pn(s.value)})}else for(var c in e)Ae(e,c)&&Ey(this.entries,{key:c,value:pn(e[c])})},parseQuery:function(e){if(e)for(var t,n,o=wy(e,"&"),r=0;r<o.length;)(t=o[r++]).length&&(n=wy(t,"="),Ey(this.entries,{key:xy(Ly(n)),value:xy(Dy(n,"="))}))},serialize:function(){for(var e,t=this.entries,n=[],o=0;o<t.length;)e=t[o++],Ey(n,Vy(e.key)+"="+Vy(e.value));return Dy(n,"&")},update:function(){this.entries.length=0,this.parseQuery(this.url.query)},updateURL:function(){this.url&&this.url.update()}};var jy=function(){ws(this,zy),fy(this,new Ky(arguments.length>0?arguments[0]:void 0))},zy=jy.prototype;if(Es(zy,{append:function(e,t){Vs(arguments.length,2);var n=hy(this);Ey(n.entries,{key:pn(e),value:pn(t)}),n.updateURL()},delete:function(e){Vs(arguments.length,1);for(var t=hy(this),n=t.entries,o=pn(e),r=0;r<n.length;)n[r].key===o?Ry(n,r,1):r++;t.updateURL()},get:function(e){Vs(arguments.length,1);for(var t=hy(this).entries,n=pn(e),o=0;o<t.length;o++)if(t[o].key===n)return t[o].value;return null},getAll:function(e){Vs(arguments.length,1);for(var t=hy(this).entries,n=pn(e),o=[],r=0;r<t.length;r++)t[r].key===n&&Ey(o,t[r].value);return o},has:function(e){Vs(arguments.length,1);for(var t=hy(this).entries,n=pn(e),o=0;o<t.length;)if(t[o++].key===n)return!0;return!1},set:function(e,t){Vs(arguments.length,1);for(var n,o=hy(this),r=o.entries,i=!1,a=pn(e),s=pn(t),u=0;u<r.length;u++)(n=r[u]).key===a&&(i?Ry(r,u--,1):(i=!0,n.value=s));i||Ey(r,{key:a,value:s}),o.updateURL()},sort:function(){var e=hy(this);dy(e.entries,(function(e,t){return e.key>t.key?1:-1})),e.updateURL()},forEach:function(e){for(var t,n=hy(this).entries,o=jn(e,arguments.length>1?arguments[1]:void 0),r=0;r<n.length;)o((t=n[r++]).value,t.key,this)},keys:function(){return new Hy(this,"keys")},values:function(){return new Hy(this,"values")},entries:function(){return new Hy(this,"entries")}},{enumerable:!0}),Dt(zy,py,zy.entries,{name:"entries"}),Dt(zy,"toString",(function(){return hy(this).serialize()}),{enumerable:!0}),or(jy,"URLSearchParams"),on({global:!0,forced:!q_},{URLSearchParams:jy}),!q_&&te(yy)){var Zy=j(Iy.has),Wy=j(Iy.set),Yy=function(e){if(ne(e)){var t,n=e.body;if("URLSearchParams"===ln(n))return t=e.headers?new yy(e.headers):new yy,Zy(t,"content-type")||Wy(t,"content-type","application/x-www-form-urlencoded;charset=UTF-8"),Hn(e,{body:q(0,pn(n)),headers:q(0,t)})}return e};if(te(vy)&&on({global:!0,enumerable:!0,forced:!0},{fetch:function(e){return vy(e,arguments.length>1?Yy(arguments[1]):{})}}),te(_y)){var Jy=function(e){return ws(this,My),new _y(e,arguments.length>1?Yy(arguments[1]):{})};My.constructor=Jy,Jy.prototype=My,on({global:!0,forced:!0},{Request:Jy})}}var Xy,$y={URLSearchParams:jy,getState:hy},Qy=Gn.f,eM=zo.codeAt,tM=Ct.set,nM=Ct.getterFor("URL"),oM=$y.URLSearchParams,rM=$y.getState,iM=R.URL,aM=R.TypeError,sM=R.parseInt,uM=Math.floor,cM=Math.pow,lM=j("".charAt),dM=j(/./.exec),pM=j([].join),fM=j(1..toString),hM=j([].pop),gM=j([].push),vM=j("".replace),mM=j([].shift),_M=j("".split),yM=j("".slice),MM=j("".toLowerCase),IM=j([].unshift),CM=/[a-z]/i,kM=/[\d+-.a-z]/i,TM=/\d/,SM=/^0x/i,bM=/^[0-7]+$/,DM=/^\d+$/,EM=/^[\da-f]+$/i,AM=/[\0\t\n\r #%/:<>?@[\\\]^|]/,LM=/[\0\t\n\r #/:<>?@[\\\]^|]/,RM=/^[\u0000-\u0020]+|[\u0000-\u0020]+$/g,wM=/[\t\n\r]/g,OM=function(e){var t,n,o,r;if("number"==typeof e){for(t=[],n=0;n<4;n++)IM(t,e%256),e=uM(e/256);return pM(t,".")}if("object"==typeof e){for(t="",o=function(e){for(var t=null,n=1,o=null,r=0,i=0;i<8;i++)0!==e[i]?(r>n&&(t=o,n=r),o=null,r=0):(null===o&&(o=i),++r);return r>n&&(t=o,n=r),t}(e),n=0;n<8;n++)r&&0===e[n]||(r&&(r=!1),o===n?(t+=n?":":"::",r=!0):(t+=fM(e[n],16),n<7&&(t+=":")));return"["+t+"]"}return e},NM={},PM=K_({},NM,{" ":1,'"':1,"<":1,">":1,"`":1}),GM=K_({},PM,{"#":1,"?":1,"{":1,"}":1}),UM=K_({},GM,{"/":1,":":1,";":1,"=":1,"@":1,"[":1,"\\":1,"]":1,"^":1,"|":1}),xM=function(e,t){var n=eM(e,0);return n>32&&n<127&&!Ae(t,e)?e:encodeURIComponent(e)},FM={ftp:21,file:null,http:80,https:443,ws:80,wss:443},qM=function(e,t){var n;return 2==e.length&&dM(CM,lM(e,0))&&(":"==(n=lM(e,1))||!t&&"|"==n)},BM=function(e){var t;return e.length>1&&qM(yM(e,0,2))&&(2==e.length||"/"===(t=lM(e,2))||"\\"===t||"?"===t||"#"===t)},VM=function(e){return"."===e||"%2e"===MM(e)},HM={},KM={},jM={},zM={},ZM={},WM={},YM={},JM={},XM={},$M={},QM={},eI={},tI={},nI={},oI={},rI={},iI={},aI={},sI={},uI={},cI={},lI=function e(t,n,o){var r,i,a,s=pn(t);if(n){if(i=this.parse(s))throw aM(i);this.searchParams=null}else{if(void 0!==o&&(r=new e(o,!0)),i=this.parse(s,null,r))throw aM(i);(a=rM(new oM)).bindURL(this),this.searchParams=a}};lI.prototype={type:"URL",parse:function(e,t,n){var o,r,i,a,s,u=this,c=t||HM,l=0,d="",p=!1,f=!1,h=!1;for(e=pn(e),t||(u.scheme="",u.username="",u.password="",u.host=null,u.port=null,u.path=[],u.query=null,u.fragment=null,u.cannotBeABaseURL=!1,e=vM(e,RM,"")),e=vM(e,wM,""),o=wo(e);l<=o.length;){switch(r=o[l],c){case HM:if(!r||!dM(CM,r)){if(t)return"Invalid scheme";c=jM;continue}d+=MM(r),c=KM;break;case KM:if(r&&(dM(kM,r)||"+"==r||"-"==r||"."==r))d+=MM(r);else{if(":"!=r){if(t)return"Invalid scheme";d="",c=jM,l=0;continue}if(t&&(u.isSpecial()!=Ae(FM,d)||"file"==d&&(u.includesCredentials()||null!==u.port)||"file"==u.scheme&&!u.host))return;if(u.scheme=d,t)return void(u.isSpecial()&&FM[u.scheme]==u.port&&(u.port=null));d="","file"==u.scheme?c=nI:u.isSpecial()&&n&&n.scheme==u.scheme?c=zM:u.isSpecial()?c=JM:"/"==o[l+1]?(c=ZM,l++):(u.cannotBeABaseURL=!0,gM(u.path,""),c=sI)}break;case jM:if(!n||n.cannotBeABaseURL&&"#"!=r)return"Invalid scheme";if(n.cannotBeABaseURL&&"#"==r){u.scheme=n.scheme,u.path=us(n.path),u.query=n.query,u.fragment="",u.cannotBeABaseURL=!0,c=cI;break}c="file"==n.scheme?nI:WM;continue;case zM:if("/"!=r||"/"!=o[l+1]){c=WM;continue}c=XM,l++;break;case ZM:if("/"==r){c=$M;break}c=aI;continue;case WM:if(u.scheme=n.scheme,r==Xy)u.username=n.username,u.password=n.password,u.host=n.host,u.port=n.port,u.path=us(n.path),u.query=n.query;else if("/"==r||"\\"==r&&u.isSpecial())c=YM;else if("?"==r)u.username=n.username,u.password=n.password,u.host=n.host,u.port=n.port,u.path=us(n.path),u.query="",c=uI;else{if("#"!=r){u.username=n.username,u.password=n.password,u.host=n.host,u.port=n.port,u.path=us(n.path),u.path.length--,c=aI;continue}u.username=n.username,u.password=n.password,u.host=n.host,u.port=n.port,u.path=us(n.path),u.query=n.query,u.fragment="",c=cI}break;case YM:if(!u.isSpecial()||"/"!=r&&"\\"!=r){if("/"!=r){u.username=n.username,u.password=n.password,u.host=n.host,u.port=n.port,c=aI;continue}c=$M}else c=XM;break;case JM:if(c=XM,"/"!=r||"/"!=lM(d,l+1))continue;l++;break;case XM:if("/"!=r&&"\\"!=r){c=$M;continue}break;case $M:if("@"==r){p&&(d="%40"+d),p=!0,i=wo(d);for(var g=0;g<i.length;g++){var v=i[g];if(":"!=v||h){var m=xM(v,UM);h?u.password+=m:u.username+=m}else h=!0}d=""}else if(r==Xy||"/"==r||"?"==r||"#"==r||"\\"==r&&u.isSpecial()){if(p&&""==d)return"Invalid authority";l-=wo(d).length+1,d="",c=QM}else d+=r;break;case QM:case eI:if(t&&"file"==u.scheme){c=rI;continue}if(":"!=r||f){if(r==Xy||"/"==r||"?"==r||"#"==r||"\\"==r&&u.isSpecial()){if(u.isSpecial()&&""==d)return"Invalid host";if(t&&""==d&&(u.includesCredentials()||null!==u.port))return;if(a=u.parseHost(d))return a;if(d="",c=iI,t)return;continue}"["==r?f=!0:"]"==r&&(f=!1),d+=r}else{if(""==d)return"Invalid host";if(a=u.parseHost(d))return a;if(d="",c=tI,t==eI)return}break;case tI:if(!dM(TM,r)){if(r==Xy||"/"==r||"?"==r||"#"==r||"\\"==r&&u.isSpecial()||t){if(""!=d){var _=sM(d,10);if(_>65535)return"Invalid port";u.port=u.isSpecial()&&_===FM[u.scheme]?null:_,d=""}if(t)return;c=iI;continue}return"Invalid port"}d+=r;break;case nI:if(u.scheme="file","/"==r||"\\"==r)c=oI;else{if(!n||"file"!=n.scheme){c=aI;continue}if(r==Xy)u.host=n.host,u.path=us(n.path),u.query=n.query;else if("?"==r)u.host=n.host,u.path=us(n.path),u.query="",c=uI;else{if("#"!=r){BM(pM(us(o,l),""))||(u.host=n.host,u.path=us(n.path),u.shortenPath()),c=aI;continue}u.host=n.host,u.path=us(n.path),u.query=n.query,u.fragment="",c=cI}}break;case oI:if("/"==r||"\\"==r){c=rI;break}n&&"file"==n.scheme&&!BM(pM(us(o,l),""))&&(qM(n.path[0],!0)?gM(u.path,n.path[0]):u.host=n.host),c=aI;continue;case rI:if(r==Xy||"/"==r||"\\"==r||"?"==r||"#"==r){if(!t&&qM(d))c=aI;else if(""==d){if(u.host="",t)return;c=iI}else{if(a=u.parseHost(d))return a;if("localhost"==u.host&&(u.host=""),t)return;d="",c=iI}continue}d+=r;break;case iI:if(u.isSpecial()){if(c=aI,"/"!=r&&"\\"!=r)continue}else if(t||"?"!=r)if(t||"#"!=r){if(r!=Xy&&(c=aI,"/"!=r))continue}else u.fragment="",c=cI;else u.query="",c=uI;break;case aI:if(r==Xy||"/"==r||"\\"==r&&u.isSpecial()||!t&&("?"==r||"#"==r)){if(".."===(s=MM(s=d))||"%2e."===s||".%2e"===s||"%2e%2e"===s?(u.shortenPath(),"/"==r||"\\"==r&&u.isSpecial()||gM(u.path,"")):VM(d)?"/"==r||"\\"==r&&u.isSpecial()||gM(u.path,""):("file"==u.scheme&&!u.path.length&&qM(d)&&(u.host&&(u.host=""),d=lM(d,0)+":"),gM(u.path,d)),d="","file"==u.scheme&&(r==Xy||"?"==r||"#"==r))for(;u.path.length>1&&""===u.path[0];)mM(u.path);"?"==r?(u.query="",c=uI):"#"==r&&(u.fragment="",c=cI)}else d+=xM(r,GM);break;case sI:"?"==r?(u.query="",c=uI):"#"==r?(u.fragment="",c=cI):r!=Xy&&(u.path[0]+=xM(r,NM));break;case uI:t||"#"!=r?r!=Xy&&("'"==r&&u.isSpecial()?u.query+="%27":u.query+="#"==r?"%23":xM(r,NM)):(u.fragment="",c=cI);break;case cI:r!=Xy&&(u.fragment+=xM(r,PM))}l++}},parseHost:function(e){var t,n,o;if("["==lM(e,0)){if("]"!=lM(e,e.length-1))return"Invalid host";if(!(t=function(e){var t,n,o,r,i,a,s,u=[0,0,0,0,0,0,0,0],c=0,l=null,d=0,p=function(){return lM(e,d)};if(":"==p()){if(":"!=lM(e,1))return;d+=2,l=++c}for(;p();){if(8==c)return;if(":"!=p()){for(t=n=0;n<4&&dM(EM,p());)t=16*t+sM(p(),16),d++,n++;if("."==p()){if(0==n)return;if(d-=n,c>6)return;for(o=0;p();){if(r=null,o>0){if(!("."==p()&&o<4))return;d++}if(!dM(TM,p()))return;for(;dM(TM,p());){if(i=sM(p(),10),null===r)r=i;else{if(0==r)return;r=10*r+i}if(r>255)return;d++}u[c]=256*u[c]+r,2!=++o&&4!=o||c++}if(4!=o)return;break}if(":"==p()){if(d++,!p())return}else if(p())return;u[c++]=t}else{if(null!==l)return;d++,l=++c}}if(null!==l)for(a=c-l,c=7;0!=c&&a>0;)s=u[c],u[c--]=u[l+a-1],u[l+--a]=s;else if(8!=c)return;return u}(yM(e,1,-1))))return"Invalid host";this.host=t}else if(this.isSpecial()){if(e=function(e){var t,n,o=[],r=ny(ty(oy(e),z_,"."),".");for(t=0;t<r.length;t++)n=r[t],ey(o,Y_(j_,n)?"xn--"+ay(n):n);return Q_(o,".")}(e),dM(AM,e))return"Invalid host";if(null===(t=function(e){var t,n,o,r,i,a,s,u=_M(e,".");if(u.length&&""==u[u.length-1]&&u.length--,(t=u.length)>4)return e;for(n=[],o=0;o<t;o++){if(""==(r=u[o]))return e;if(i=10,r.length>1&&"0"==lM(r,0)&&(i=dM(SM,r)?16:8,r=yM(r,8==i?1:2)),""===r)a=0;else{if(!dM(10==i?DM:8==i?bM:EM,r))return e;a=sM(r,i)}gM(n,a)}for(o=0;o<t;o++)if(a=n[o],o==t-1){if(a>=cM(256,5-t))return null}else if(a>255)return null;for(s=hM(n),o=0;o<n.length;o++)s+=n[o]*cM(256,3-o);return s}(e)))return"Invalid host";this.host=t}else{if(dM(LM,e))return"Invalid host";for(t="",n=wo(e),o=0;o<n.length;o++)t+=xM(n[o],NM);this.host=t}},cannotHaveUsernamePasswordPort:function(){return!this.host||this.cannotBeABaseURL||"file"==this.scheme},includesCredentials:function(){return""!=this.username||""!=this.password},isSpecial:function(){return Ae(FM,this.scheme)},shortenPath:function(){var e=this.path,t=e.length;!t||"file"==this.scheme&&1==t&&qM(e[0],!0)||e.length--},serialize:function(){var e=this,t=e.scheme,n=e.username,o=e.password,r=e.host,i=e.port,a=e.path,s=e.query,u=e.fragment,c=t+":";return null!==r?(c+="//",e.includesCredentials()&&(c+=n+(o?":"+o:"")+"@"),c+=OM(r),null!==i&&(c+=":"+i)):"file"==t&&(c+="//"),c+=e.cannotBeABaseURL?a[0]:a.length?"/"+pM(a,"/"):"",null!==s&&(c+="?"+s),null!==u&&(c+="#"+u),c},setHref:function(e){var t=this.parse(e);if(t)throw aM(t);this.searchParams.update()},getOrigin:function(){var e=this.scheme,t=this.port;if("blob"==e)try{return new dI(e.path[0]).origin}catch(XD){return"null"}return"file"!=e&&this.isSpecial()?e+"://"+OM(this.host)+(null!==t?":"+t:""):"null"},getProtocol:function(){return this.scheme+":"},setProtocol:function(e){this.parse(pn(e)+":",HM)},getUsername:function(){return this.username},setUsername:function(e){var t=wo(pn(e));if(!this.cannotHaveUsernamePasswordPort()){this.username="";for(var n=0;n<t.length;n++)this.username+=xM(t[n],UM)}},getPassword:function(){return this.password},setPassword:function(e){var t=wo(pn(e));if(!this.cannotHaveUsernamePasswordPort()){this.password="";for(var n=0;n<t.length;n++)this.password+=xM(t[n],UM)}},getHost:function(){var e=this.host,t=this.port;return null===e?"":null===t?OM(e):OM(e)+":"+t},setHost:function(e){this.cannotBeABaseURL||this.parse(e,QM)},getHostname:function(){var e=this.host;return null===e?"":OM(e)},setHostname:function(e){this.cannotBeABaseURL||this.parse(e,eI)},getPort:function(){var e=this.port;return null===e?"":pn(e)},setPort:function(e){this.cannotHaveUsernamePasswordPort()||(""==(e=pn(e))?this.port=null:this.parse(e,tI))},getPathname:function(){var e=this.path;return this.cannotBeABaseURL?e[0]:e.length?"/"+pM(e,"/"):""},setPathname:function(e){this.cannotBeABaseURL||(this.path=[],this.parse(e,iI))},getSearch:function(){var e=this.query;return e?"?"+e:""},setSearch:function(e){""==(e=pn(e))?this.query=null:("?"==lM(e,0)&&(e=yM(e,1)),this.query="",this.parse(e,uI)),this.searchParams.update()},getSearchParams:function(){return this.searchParams.facade},getHash:function(){var e=this.fragment;return e?"#"+e:""},setHash:function(e){""!=(e=pn(e))?("#"==lM(e,0)&&(e=yM(e,1)),this.fragment="",this.parse(e,cI)):this.fragment=null},update:function(){this.query=this.searchParams.serialize()||null}};var dI=function(e){var t=ws(this,pI),n=Vs(arguments.length,1)>1?arguments[1]:void 0,o=tM(t,new lI(e,!1,n));O||(t.href=o.serialize(),t.origin=o.getOrigin(),t.protocol=o.getProtocol(),t.username=o.getUsername(),t.password=o.getPassword(),t.host=o.getHost(),t.hostname=o.getHostname(),t.port=o.getPort(),t.pathname=o.getPathname(),t.search=o.getSearch(),t.searchParams=o.getSearchParams(),t.hash=o.getHash())},pI=dI.prototype,fI=function(e,t){return{get:function(){return nM(this)[e]()},set:t&&function(e){return nM(this)[t](e)},configurable:!0,enumerable:!0}};if(O&&Qy(pI,{href:fI("serialize","setHref"),origin:fI("getOrigin"),protocol:fI("getProtocol","setProtocol"),username:fI("getUsername","setUsername"),password:fI("getPassword","setPassword"),host:fI("getHost","setHost"),hostname:fI("getHostname","setHostname"),port:fI("getPort","setPort"),pathname:fI("getPathname","setPathname"),search:fI("getSearch","setSearch"),searchParams:fI("getSearchParams"),hash:fI("getHash","setHash")}),Dt(pI,"toJSON",(function(){return nM(this).serialize()}),{enumerable:!0}),Dt(pI,"toString",(function(){return nM(this).serialize()}),{enumerable:!0}),iM){var hI=iM.createObjectURL,gI=iM.revokeObjectURL;hI&&Dt(dI,"createObjectURL",jn(hI,iM)),gI&&Dt(dI,"revokeObjectURL",jn(gI,iM))}or(dI,"URL"),on({global:!0,forced:!q_,sham:!O},{URL:dI}),on({target:"Object",stat:!0,forced:Object.assign!==K_},{assign:K_});var vI=function(){function e(t){r(this,e),this._imageMemoryURL="",nl?this.createImageDataASURLInWXMiniApp(t.file):this.createImageDataASURLInWeb(t.file),this._initImageInfoModel(),this.type=Ir.MSG_IMAGE,this._percent=0,this.content={imageFormat:t.imageFormat||Ul.UNKNOWN,uuid:t.uuid,imageInfoArray:[]},this.initImageInfoArray(t.imageInfoArray),this._autoFixUrl()}return a(e,[{key:"_initImageInfoModel",value:function(){var e=this;this._ImageInfoModel=function(t){this.instanceID=vd(9999999),this.sizeType=t.type||0,this.type=0,this.size=t.size||0,this.width=t.width||0,this.height=t.height||0,this.imageUrl=t.url||"",this.url=t.url||e._imageMemoryURL||e._defaultImage},this._ImageInfoModel.prototype={setSizeType:function(e){this.sizeType=e},setType:function(e){this.type=e},setImageUrl:function(e){e&&(this.imageUrl=e)},getImageUrl:function(){return this.imageUrl}}}},{key:"initImageInfoArray",value:function(e){for(var t=0,n=null,o=null;t<=2;)o=id(e)||id(e[t])?{type:0,size:0,width:0,height:0,url:""}:e[t],(n=new this._ImageInfoModel(o)).setSizeType(t+1),n.setType(t),this.addImageInfo(n),t++;this.updateAccessSideImageInfoArray()}},{key:"updateImageInfoArray",value:function(e){for(var t,n=this.content.imageInfoArray.length,o=0;o<n;o++)t=this.content.imageInfoArray[o],e[o].size&&(t.size=e[o].size),e[o].url&&t.setImageUrl(e[o].url),e[o].width&&(t.width=e[o].width),e[o].height&&(t.height=e[o].height)}},{key:"_autoFixUrl",value:function(){for(var e=this.content.imageInfoArray.length,t="",n="",o=["http","https"],r=null,i=0;i<e;i++)this.content.imageInfoArray[i].url&&""!==(r=this.content.imageInfoArray[i]).imageUrl&&(n=r.imageUrl.slice(0,r.imageUrl.indexOf("://")+1),t=r.imageUrl.slice(r.imageUrl.indexOf("://")+1),o.indexOf(n)<0&&(n="https:"),this.content.imageInfoArray[i].setImageUrl([n,t].join("")))}},{key:"updatePercent",value:function(e){this._percent=e,this._percent>1&&(this._percent=1)}},{key:"updateImageFormat",value:function(e){this.content.imageFormat=Ul[e.toUpperCase()]||Ul.UNKNOWN}},{key:"createImageDataASURLInWeb",value:function(e){void 0!==e&&e.files.length>0&&(this._imageMemoryURL=window.URL.createObjectURL(e.files[0]))}},{key:"createImageDataASURLInWXMiniApp",value:function(e){e&&e.url&&(this._imageMemoryURL=e.url)}},{key:"replaceImageInfo",value:function(e,t){this.content.imageInfoArray[t]instanceof this._ImageInfoModel||(this.content.imageInfoArray[t]=e)}},{key:"addImageInfo",value:function(e){this.content.imageInfoArray.length>=3||this.content.imageInfoArray.push(e)}},{key:"updateAccessSideImageInfoArray",value:function(){var e=this.content.imageInfoArray,t=e[0],n=t.width,o=void 0===n?0:n,r=t.height,i=void 0===r?0:r;0!==o&&0!==i&&(Ud(e),Object.assign(e[2],Gd({originWidth:o,originHeight:i,min:720})))}},{key:"sendable",value:function(){return 0!==this.content.imageInfoArray.length&&""!==this.content.imageInfoArray[0].imageUrl&&0!==this.content.imageInfoArray[0].size}}]),e}(),mI=function(){function e(t){r(this,e),this.type=Ir.MSG_FACE,this.content=t||null}return a(e,[{key:"sendable",value:function(){return null!==this.content}}]),e}(),_I=function(){function e(t){r(this,e),this.type=Ir.MSG_AUDIO,this._percent=0,this.content={downloadFlag:2,second:t.second,size:t.size,url:t.url,remoteAudioUrl:t.url||"",uuid:t.uuid}}return a(e,[{key:"updatePercent",value:function(e){this._percent=e,this._percent>1&&(this._percent=1)}},{key:"updateAudioUrl",value:function(e){this.content.remoteAudioUrl=e}},{key:"sendable",value:function(){return""!==this.content.remoteAudioUrl}}]),e}(),yI={from:!0,groupID:!0,groupName:!0,to:!0},MI=function(){function e(t){r(this,e),this.type=Ir.MSG_GRP_TIP,this.content={},this._initContent(t)}return a(e,[{key:"_initContent",value:function(e){var t=this;Object.keys(e).forEach((function(n){switch(n){case"remarkInfo":case"operatorInfo":case"memberExtraInfo":case"onlineMemberInfo":break;case"groupProfile":t.content.groupProfile={},t._initGroupProfile(e[n]);break;case"memberInfoList":case"msgMemberInfo":t._updateMemberList(e[n]);break;case"memberNum":t.content[n]=e[n],t.content.memberCount=e[n];break;case"newGroupProfile":t.content.newGroupProfile={},t._initNewGroupProfile(e[n]);break;default:t.content[n]=e[n]}})),this.content.userIDList||(this.content.userIDList=[this.content.operatorID])}},{key:"_initGroupProfile",value:function(e){for(var t=Object.keys(e),n=0;n<t.length;n++){var o=t[n];yI[o]&&(this.content.groupProfile[o]=e[o])}}},{key:"_updateMemberList",value:function(e){Yd(this.content.memberList)?this.content.memberList=e:this.content.memberList.forEach((function(t){e.forEach((function(e){t.userID===e.userID&&Object.assign(t,e)}))}))}},{key:"_initNewGroupProfile",value:function(e){for(var t=Object.keys(e),n=0;n<t.length;n++){var o=t[n];this.content.newGroupProfile[o]="muteAllMembers"!==o?e[o]:1===e[o]}}}]),e}(),II={from:!0,groupID:!0,groupName:!0,to:!0},CI=function(){function e(t){r(this,e),this.type=Ir.MSG_GRP_SYS_NOTICE,this.content={},this._initContent(t)}return a(e,[{key:"_initContent",value:function(e){var t=this;Object.keys(e).forEach((function(n){switch(n){case"memberInfoList":break;case"remarkInfo":t.content.handleMessage=e[n];break;case"groupProfile":t.content.groupProfile={},t._initGroupProfile(e[n]);break;default:t.content[n]=e[n]}}))}},{key:"_initGroupProfile",value:function(e){for(var t=Object.keys(e),n=0;n<t.length;n++){var o=t[n];II[o]&&("groupName"===o?this.content.groupProfile.name=e[o]:this.content.groupProfile[o]=e[o])}}}]),e}(),kI=Math.min,TI=[].lastIndexOf,SI=!!TI&&1/[1].lastIndexOf(1,-0)<0,bI=uo("lastIndexOf"),DI=SI||!bI?function(e){if(SI)return Ca(TI,this,arguments)||0;var t=ee(this),n=Gt(t),o=n-1;for(arguments.length>1&&(o=kI(o,Lt(arguments[1]))),o<0&&(o=n+o);o>=0;o--)if(o in t&&t[o]===e)return o||0;return-1}:TI;on({target:"Array",proto:!0,forced:DI!==[].lastIndexOf},{lastIndexOf:DI});var EI=function(){function e(t){r(this,e),this.type=Ir.MSG_FILE,this._percent=0;var n=this._getFileInfo(t);this.content={downloadFlag:2,fileUrl:t.url||"",uuid:t.uuid,fileName:n.name||"",fileSize:n.size||0}}return a(e,[{key:"_getFileInfo",value:function(e){if(!id(e.fileName)&&!id(e.fileSize))return{size:e.fileSize,name:e.fileName};var t=e.file.files[0];if(el){if(t.path&&-1!==t.path.indexOf(".")){var n=t.path.slice(t.path.lastIndexOf(".")+1).toLowerCase();t.type=n,t.name||(t.name="".concat(vd(999999),".").concat(n))}t.name||(t.type="",t.name=t.path.slice(t.path.lastIndexOf("/")+1).toLowerCase()),t.suffix&&(t.type=t.suffix),t.url||(t.url=t.path)}return{size:t.size,name:t.name}}},{key:"updatePercent",value:function(e){this._percent=e,this._percent>1&&(this._percent=1)}},{key:"updateFileUrl",value:function(e){this.content.fileUrl=e}},{key:"sendable",value:function(){return""!==this.content.fileUrl&&""!==this.content.fileName&&0!==this.content.fileSize}}]),e}(),AI=function(){function e(t){r(this,e),this.type=Ir.MSG_CUSTOM,this.content={data:t.data||"",description:t.description||"",extension:t.extension||""}}return a(e,[{key:"setData",value:function(e){return this.content.data=e,this}},{key:"setDescription",value:function(e){return this.content.description=e,this}},{key:"setExtension",value:function(e){return this.content.extension=e,this}},{key:"sendable",value:function(){return 0!==this.content.data.length||0!==this.content.description.length||0!==this.content.extension.length}}]),e}(),LI=function(){function e(t){r(this,e),this.type=Ir.MSG_VIDEO,this._percent=0,this.content={remoteVideoUrl:t.remoteVideoUrl||t.videoUrl||"",videoFormat:t.videoFormat,videoSecond:parseInt(t.videoSecond,10),videoSize:t.videoSize,videoUrl:t.videoUrl,videoDownloadFlag:2,videoUUID:t.videoUUID,thumbUUID:t.thumbUUID,thumbFormat:t.thumbFormat,thumbWidth:t.thumbWidth,snapshotWidth:t.thumbWidth,thumbHeight:t.thumbHeight,snapshotHeight:t.thumbHeight,thumbSize:t.thumbSize,snapshotSize:t.thumbSize,thumbDownloadFlag:2,thumbUrl:t.thumbUrl,snapshotUrl:t.thumbUrl}}return a(e,[{key:"updatePercent",value:function(e){this._percent=e,this._percent>1&&(this._percent=1)}},{key:"updateVideoUrl",value:function(e){e&&(this.content.remoteVideoUrl=e)}},{key:"updateSnapshotInfo",value:function(e){var t=e.snapshotUrl,n=e.snapshotWidth,o=e.snapshotHeight;Yd(t)||(this.content.thumbUrl=this.content.snapshotUrl=t),Yd(n)||(this.content.thumbWidth=this.content.snapshotWidth=Number(n)),Yd(o)||(this.content.thumbHeight=this.content.snapshotHeight=Number(o))}},{key:"sendable",value:function(){return""!==this.content.remoteVideoUrl}}]),e}(),RI=function(){function e(t){r(this,e),this.type=Ir.MSG_LOCATION;var n=t.description,o=t.longitude,i=t.latitude;this.content={description:n,longitude:o,latitude:i}}return a(e,[{key:"sendable",value:function(){return!0}}]),e}(),wI=function(){function e(t){if(r(this,e),this.from=t.from,this.messageSender=t.from,this.time=t.time,this.messageSequence=t.sequence,this.clientSequence=t.clientSequence||t.sequence,this.messageRandom=t.random,this.cloudCustomData=t.cloudCustomData||"",this.clientTime=t.clientTime||void 0,t.ID)this.ID=t.ID||"",this.nick=t.nick||"",this.avatar=t.avatar||"",this.messageBody=[{type:t.type,payload:t.payload}],t.conversationType.startsWith(Ir.CONV_C2C)?this.receiverUserID=t.to:t.conversationType.startsWith(Ir.CONV_GROUP)&&(this.receiverGroupID=t.to),this.messageReceiver=t.to;else{this.nick=t.nick||"",this.avatar=t.avatar||"",this.messageBody=[];var n=t.elements[0].type,o=t.elements[0].content;this._patchRichMediaPayload(n,o),n===Ir.MSG_MERGER?this.messageBody.push({type:n,payload:new OI(o).content}):this.messageBody.push({type:n,payload:o}),t.groupID&&(this.receiverGroupID=t.groupID,this.messageReceiver=t.groupID),t.to&&(this.receiverUserID=t.to,this.messageReceiver=t.to),this.ID="".concat(t.tinyID,"-").concat(t.clientTime,"-").concat(t.random)}}return a(e,[{key:"_patchRichMediaPayload",value:function(e,t){e===Ir.MSG_IMAGE?t.imageInfoArray.forEach((function(e){!e.imageUrl&&e.url&&(e.imageUrl=e.url,e.sizeType=e.type,1===e.type?e.type=0:3===e.type&&(e.type=1))})):e===Ir.MSG_VIDEO?!t.remoteVideoUrl&&t.videoUrl&&(t.remoteVideoUrl=t.videoUrl):e===Ir.MSG_AUDIO?!t.remoteAudioUrl&&t.url&&(t.remoteAudioUrl=t.url):e===Ir.MSG_FILE&&!t.fileUrl&&t.url&&(t.fileUrl=t.url,t.url=void 0)}}]),e}(),OI=function(){function e(t){if(r(this,e),this.type=Ir.MSG_MERGER,this.content={downloadKey:"",pbDownloadKey:"",messageList:[],title:"",abstractList:[],compatibleText:"",version:0,layersOverLimit:!1},t.downloadKey){var n=t.downloadKey,o=t.pbDownloadKey,i=t.title,a=t.abstractList,s=t.compatibleText,u=t.version;this.content.downloadKey=n,this.content.pbDownloadKey=o,this.content.title=i,this.content.abstractList=a,this.content.compatibleText=s,this.content.version=u||0}else if(Yd(t.messageList))1===t.layersOverLimit&&(this.content.layersOverLimit=!0);else{var c=t.messageList,l=t.title,d=t.abstractList,p=t.compatibleText,f=t.version,h=[];c.forEach((function(e){if(!Yd(e)){var t=new wI(e);h.push(t)}})),this.content.messageList=h,this.content.title=l,this.content.abstractList=d,this.content.compatibleText=p,this.content.version=f||0}}return a(e,[{key:"sendable",value:function(){return!Yd(this.content.messageList)||!Yd(this.content.downloadKey)}}]),e}(),NI={1:Ir.MSG_PRIORITY_HIGH,2:Ir.MSG_PRIORITY_NORMAL,3:Ir.MSG_PRIORITY_LOW,4:Ir.MSG_PRIORITY_LOWEST},PI=function(){function e(t){r(this,e),this.ID="",this.conversationID=t.conversationID||null,this.conversationType=t.conversationType||Ir.CONV_C2C,this.conversationSubType=t.conversationSubType,this.time=t.time||Math.ceil(Date.now()/1e3),this.sequence=t.sequence||0,this.clientSequence=t.clientSequence||t.sequence||0,this.random=t.random||0===t.random?t.random:vd(),this.priority=this._computePriority(t.priority),this.nick=t.nick||"",this.avatar=t.avatar||"",this.isPeerRead=!1,this.nameCard="",this._elements=[],this.isPlaceMessage=t.isPlaceMessage||0,this.isRevoked=2===t.isPlaceMessage||8===t.msgFlagBits,this.from=t.from||null,this.to=t.to||null,this.flow="",this.isSystemMessage=t.isSystemMessage||!1,this.protocol=t.protocol||"JSON",this.isResend=!1,this.isRead=!1,this.status=t.status||Kp.SUCCESS,this._onlineOnlyFlag=!1,this._groupAtInfoList=[],this._relayFlag=!1,this.atUserList=[],this.cloudCustomData=t.cloudCustomData||"",this.isDeleted=!1,this.isModified=!1,this._isExcludedFromUnreadCount=!(!t.messageControlInfo||1!==t.messageControlInfo.excludedFromUnreadCount),this._isExcludedFromLastMessage=!(!t.messageControlInfo||1!==t.messageControlInfo.excludedFromLastMessage),this.clientTime=t.clientTime||wl()||0,this.senderTinyID=t.senderTinyID||t.tinyID||"",this.readReceiptInfo=t.readReceiptInfo||{readCount:void 0,unreadCount:void 0,isPeerRead:void 0},this.needReadReceipt=!0===t.needReadReceipt||1===t.needReadReceipt,this.version=t.messageVersion||0,this.isBroadcastMessage=t.isBroadcastMessage||!1,this._receiverList=t.receiverList||void 0,this.isSupportExtension=!0===t.isSupportExtension||1===t.isSupportExtension,this.revoker=t.revokerInfo&&t.revokerInfo.revoker||null,this.reInitialize(t.currentUser),this.extractGroupInfo(t.groupProfile||null),this.handleGroupAtInfo(t),this.initC2CReadReceiptInfo(t.readReceiptSentByPeer)}return a(e,[{key:"elements",get:function(){return this._elements}},{key:"getElements",value:function(){return this._elements}},{key:"extractGroupInfo",value:function(e){if(null!==e){td(e.nick)&&(this.nick=e.nick),td(e.avatar)&&(this.avatar=e.avatar);var t=e.messageFromAccountExtraInformation;od(t)&&td(t.nameCard)&&(this.nameCard=t.nameCard)}}},{key:"handleGroupAtInfo",value:function(e){var t=this;e.payload&&e.payload.atUserList&&e.payload.atUserList.forEach((function(e){e!==Ir.MSG_AT_ALL?(t._groupAtInfoList.push({groupAtAllFlag:0,groupAtUserID:e}),t.atUserList.push(e)):(t._groupAtInfoList.push({groupAtAllFlag:1}),t.atUserList.push(Ir.MSG_AT_ALL))})),rd(e.groupAtInfo)&&e.groupAtInfo.forEach((function(e){0===e.groupAtAllFlag?t.atUserList.push(e.groupAtUserID):1===e.groupAtAllFlag&&t.atUserList.push(Ir.MSG_AT_ALL)}))}},{key:"getGroupAtInfoList",value:function(){return this._groupAtInfoList}},{key:"_initProxy",value:function(){this._elements[0]&&(this.payload=this._elements[0].content,this.type=this._elements[0].type)}},{key:"reInitialize",value:function(e){e&&(this.status=this.from?Kp.SUCCESS:Kp.UNSEND,!this.from&&(this.from=e)),this._initFlow(e),this._initSequence(e),this._concatConversationID(e),this.generateMessageID()}},{key:"isSendable",value:function(){return 0!==this._elements.length&&"function"==typeof this._elements[0].sendable&&this._elements[0].sendable()}},{key:"_initTo",value:function(e){this.conversationType===Ir.CONV_GROUP&&(this.to=e.groupID)}},{key:"_initSequence",value:function(e){0===this.clientSequence&&e&&(this.clientSequence=function(e){if(!e)return!1;if(void 0===Md[e]){var t=new Date,n="3".concat(t.getHours()).slice(-2),o="0".concat(t.getMinutes()).slice(-2),r="0".concat(t.getSeconds()).slice(-2);Md[e]=parseInt([n,o,r,"0001"].join("")),n=null,o=null,r=null,Gl.l("autoIncrementIndex start index:".concat(Md[e]))}return Md[e]++}(e)),0===this.sequence&&this.conversationType===Ir.CONV_C2C&&(this.sequence=this.clientSequence)}},{key:"generateMessageID",value:function(){this.from===Ir.CONV_SYSTEM&&(this.senderTinyID="144115198244471703"),this.ID="".concat(this.senderTinyID,"-").concat(this.clientTime,"-").concat(this.random)}},{key:"_initFlow",value:function(e){""!==e&&(e===this.from?(this.flow="out",this.isRead=!0):this.flow="in")}},{key:"_concatConversationID",value:function(e){var t=this.to,n="",o=this.conversationType;o!==Ir.CONV_SYSTEM?(n=o===Ir.CONV_C2C?e===this.from?t:this.from:this.to,this.conversationID="".concat(o).concat(n)):this.conversationID=Ir.CONV_SYSTEM}},{key:"isElement",value:function(e){return e instanceof x_||e instanceof vI||e instanceof mI||e instanceof _I||e instanceof EI||e instanceof LI||e instanceof MI||e instanceof CI||e instanceof AI||e instanceof RI||e instanceof OI}},{key:"setElement",value:function(e){var t=this;if(this.isElement(e))return this._elements=[e],void this._initProxy();var n=function(e){if(e.type&&e.content)switch(e.type){case Ir.MSG_TEXT:t.setTextElement(e.content);break;case Ir.MSG_IMAGE:t.setImageElement(e.content);break;case Ir.MSG_AUDIO:t.setAudioElement(e.content);break;case Ir.MSG_FILE:t.setFileElement(e.content);break;case Ir.MSG_VIDEO:t.setVideoElement(e.content);break;case Ir.MSG_CUSTOM:t.setCustomElement(e.content);break;case Ir.MSG_LOCATION:t.setLocationElement(e.content);break;case Ir.MSG_GRP_TIP:t.setGroupTipElement(e.content);break;case Ir.MSG_GRP_SYS_NOTICE:t.setGroupSystemNoticeElement(e.content);break;case Ir.MSG_FACE:t.setFaceElement(e.content);break;case Ir.MSG_MERGER:t.setMergerElement(e.content)}};if(rd(e))for(var o=0;o<e.length;o++)n(e[o]);else n(e);this._initProxy()}},{key:"clearElement",value:function(){this._elements.length=0}},{key:"setTextElement",value:function(e){var t="string"==typeof e?e:e.text,n=new x_({text:t});this._elements.push(n)}},{key:"setImageElement",value:function(e){var t=new vI(e);this._elements.push(t)}},{key:"setAudioElement",value:function(e){var t=new _I(e);this._elements.push(t)}},{key:"setFileElement",value:function(e){var t=new EI(e);this._elements.push(t)}},{key:"setVideoElement",value:function(e){var t=new LI(e);this._elements.push(t)}},{key:"setLocationElement",value:function(e){var t=new RI(e);this._elements.push(t)}},{key:"setCustomElement",value:function(e){var t=new AI(e);this._elements.push(t)}},{key:"setGroupTipElement",value:function(e){var t={},n=e.operationType;if(Yd(e.memberInfoList)?e.operatorInfo&&(t=e.operatorInfo):n!==Ir.GRP_TIP_MBR_JOIN&&n!==Ir.GRP_TIP_MBR_KICKED_OUT&&n!==Ir.GRP_TIP_MBR_SET_ADMIN&&n!==Ir.GRP_TIP_MBR_CANCELED_ADMIN||(t=e.memberInfoList[0]),!Yd(e.memberExtraInfo)){var o=e.memberExtraInfo.reason;e.msgMemberInfo.forEach((function(e){e.reason=o}))}var r=t,i=r.nick,a=r.avatar;td(i)&&(this.nick=i),td(a)&&(this.avatar=a);var s=new MI(e);this._elements.push(s)}},{key:"setGroupSystemNoticeElement",value:function(e){var t=new CI(e);this._elements.push(t)}},{key:"setFaceElement",value:function(e){var t=new mI(e);this._elements.push(t)}},{key:"setMergerElement",value:function(e){var t=new OI(e);this._elements.push(t)}},{key:"setIsRead",value:function(e){this.isRead=e}},{key:"setRelayFlag",value:function(e){this._relayFlag=e}},{key:"getRelayFlag",value:function(){return this._relayFlag}},{key:"_computePriority",value:function(e){if(id(e))return Ir.MSG_PRIORITY_NORMAL;if(td(e)&&-1!==Object.values(NI).indexOf(e))return e;if(ed(e)){var t=""+e;if(-1!==Object.keys(NI).indexOf(t))return NI[t]}return Ir.MSG_PRIORITY_NORMAL}},{key:"setNickAndAvatar",value:function(e){var t=e.nick,n=e.avatar;td(t)&&(this.nick=t),td(n)&&(this.avatar=n)}},{key:"setNameCard",value:function(e){td(e)&&(this.nameCard=e)}},{key:"initC2CReadReceiptInfo",value:function(e){this.conversationType===Ir.CONV_C2C&&!0===this.needReadReceipt&&(this.readReceiptInfo.isPeerRead=1===e)}}]),e}(),GI=function(e){return{code:0,data:e||{}}},UI=function(e){u(n,e);var t=m(n);function n(e){var o;r(this,n),o=t.call(this);var i=e.code,a=e.message,s=e.data;return o.code=i,o.message=a||o._getErrorMessage(o.code),o.data=s||{},o}return a(n)}(f(Error)),xI=null,FI=function(e){xI=e},qI=function(e){return Promise.resolve(GI(e))},BI=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e instanceof UI)return t&&null!==xI&&xI.emit(Mr.ERROR,e),Promise.reject(e);if(e instanceof Error){var n=new UI({code:$m});return t&&null!==xI&&xI.emit(Mr.ERROR,n),Promise.reject(n)}if(!id(e)&&!id(e.code)){var o=new UI(e);return t&&null!==xI&&xI.emit(Mr.ERROR,o),Promise.reject(o)}},VI=function(e){u(o,e);var n=m(o);function o(e){var t;return r(this,o),(t=n.call(this,e))._n="C2CModule",t._messageFromUnreadDBMap=new Map,t._signalingFromUnreadDBList=[],t}return a(o,[{key:"onNewC2CMessage",value:function(e){var t=e.dataList,n=e.isInstantMessage,o=e.C2CRemainingUnreadList,r=e.C2CPairUnreadList;Gl.d("".concat(this._n,".onNewC2CMessage count:").concat(t.length," isInstantMessage:").concat(n));var i=this._newC2CMessageStoredAndSummary({dataList:t,C2CRemainingUnreadList:o,C2CPairUnreadList:r,isInstantMessage:n}),a=i.conversationOptionsList,s=i.messageList,u=i.isUnreadC2CMessage;this.filterModifiedMessage(s),a.length>0&&this.getModule(Wf).onNewMessage({conversationOptionsList:a,isInstantMessage:n,isUnreadC2CMessage:u});var c=this.filterUnmodifiedMessage(s);n&&c.length>0&&this.emitOuterEvent(Mr.MESSAGE_RECEIVED,c),s.length=0}},{key:"_newC2CMessageStoredAndSummary",value:function(e){for(var t=e.dataList,n=e.C2CRemainingUnreadList,o=e.C2CPairUnreadList,r=e.isInstantMessage,i=null,a=[],s=[],u={},c=this.getModule(Qf),l=this.getModule(ch),d=!1,p=this.getModule(Wf),f=0,h=t.length;f<h;f++)if(this._isSignaling(t[f]))this._signalingFromUnreadDBList.push(t[f].eventArray[0].c2CNotifyMsgArray[0]);else{var g=t[f];g.currentUser=this.getMyUserID(),g.conversationType=Ir.CONV_C2C,g.isSystemMessage=!!g.isSystemMessage,(id(g.nick)||id(g.avatar))&&(d=!0,Gl.d("".concat(this._n,"._newC2CMessageStoredAndSummary nick or avatar missing!"))),i=new PI(g),g.elements=c.parseElements(g.elements,g.from),i.setElement(g.elements),i.setNickAndAvatar({nick:g.nick,avatar:g.avatar});var v=i.conversationID;if(r){if(1===this._messageFromUnreadDBMap.get(i.ID))continue;var m=!1;if(i.from!==this.getMyUserID()){var _=p.getLatestMessageSentByPeer(v);if(_){var y=_.nick,M=_.avatar;d?i.setNickAndAvatar({nick:y,avatar:M}):y===i.nick&&M===i.avatar||(m=!0)}}else{var I=p.getLatestMessageSentByMe(v);if(I){var C=I.nick,k=I.avatar;C===i.nick&&k===i.avatar||p.modifyMessageSentByMe({conversationID:v,latestNick:i.nick,latestAvatar:i.avatar})}}var T=1===t[f].isModified;if(p.isMessageSentByCurrentInstance(i)?i.isModified=T:T=!1,0===g.msgLifeTime)i._onlineOnlyFlag=!0,p.isMessageSentByCurrentInstance(i)||s.push(i);else{if(!p.pushIntoMessageList(s,i,T))continue;m&&(p.modifyMessageSentByPeer({conversationID:v,latestNick:i.nick,latestAvatar:i.avatar}),p.updateUserProfileSpecifiedKey({conversationID:v,nick:i.nick,avatar:i.avatar}))}r&&i.clientTime>0&&l.addMessageDelay(i.clientTime)}else this._messageFromUnreadDBMap.set(i.ID,1);if(0!==g.msgLifeTime){if(!1===i._onlineOnlyFlag){var S=p.getLastMessageTime(v);if(ed(S)&&i.time<S)continue;if(id(u[v])){var b=0;"in"===i.flow&&(i._isExcludedFromUnreadCount||(b=1)),u[v]=a.push({conversationID:v,unreadCount:b,type:i.conversationType,subType:i.conversationSubType,lastMessage:i._isExcludedFromLastMessage?"":i})-1}else{var D=u[v];a[D].type=i.conversationType,a[D].subType=i.conversationSubType,a[D].lastMessage=i._isExcludedFromLastMessage?"":i,"in"===i.flow&&(i._isExcludedFromUnreadCount||a[D].unreadCount++)}}}else i._onlineOnlyFlag=!0}this._handleSignalingFromUnreadDB();var E=!1;if(rd(o))for(var A=function(e,t){if(o[e].unreadCount>0){E=!0;var n=a.find((function(t){return t.conversationID==="C2C".concat(o[e].from)}));n?n.unreadCount=o[e].unreadCount:a.push({conversationID:"C2C".concat(o[e].from),unreadCount:o[e].unreadCount,type:Ir.CONV_C2C})}},L=0,R=o.length;L<R;L++)A(L);if(rd(n))for(var w=function(e,t){a.find((function(t){return t.conversationID==="C2C".concat(n[e].from)}))||a.push({conversationID:"C2C".concat(n[e].from),type:Ir.CONV_C2C,lastMsgTime:n[e].lastMsgTime})},O=0,N=n.length;O<N;O++)w(O);return{conversationOptionsList:a,messageList:s,isUnreadC2CMessage:E}}},{key:"_isSignaling",value:function(e){var t=e.eventArray;return!(!rd(t)||10!==t[0].event)}},{key:"_handleSignalingFromUnreadDB",value:function(){var e=this._signalingFromUnreadDBList.length;if(Gl.l("".concat(this._n,"._handleSignalingFromUnreadDB signalingCount:").concat(e)),0!==e){var t=[];this._signalingFromUnreadDBList.forEach((function(e){e.hasOwnProperty("c2cMessageRevokedNotify")&&t.push(e)})),this.onC2CMessageRevoked({dataList:t}),this._signalingFromUnreadDBList.length=0,t.length=0}}},{key:"onC2CMessageRevoked",value:function(e){var t=this,n=this.getModule(Wf),o=[],r=null,i=!0;e.dataList.forEach((function(e){if(e.c2cMessageRevokedNotify){var a=e.c2cMessageRevokedNotify.revokedInfos;id(a)||a.forEach((function(e){var a=t.getMyUserID()===e.from?"".concat(Ir.CONV_C2C).concat(e.to):"".concat(Ir.CONV_C2C).concat(e.from);r=n.revoke(a,e.sequence,e.random);var s=e.revokerInfo&&e.revokerInfo.revoker;if(r)r.revoker=s,o.push(r);else{var u={conversationID:a,sequence:e.sequence,time:e.time,revoker:s};n.isLastMessageRevoked(u)&&(o.push(u),i=!1)}}))}})),0!==o.length&&(n.onMessageRevoked(o),!0===i&&(Gl.l("".concat(this._n,".onC2CMessageRevoked count:").concat(o.length)),this.emitOuterEvent(Mr.MESSAGE_REVOKED,o)))}},{key:"onC2CMessageReadReceipt",value:function(e){var t=this;e.dataList.forEach((function(e){if(!Yd(e.c2cMessageReadReceipt)){var n=e.c2cMessageReadReceipt.to;e.c2cMessageReadReceipt.uinPairReadArray.forEach((function(e){var o=e.peerReadTime;Gl.d("".concat(t._n,"._onC2CMessageReadReceipt to:").concat(n," peerReadTime:").concat(o));var r="".concat(Ir.CONV_C2C).concat(n),i=t.getModule(Wf);i.recordPeerReadTime(r,o),i.updateMessageIsPeerReadProperty(r,o)}))}}))}},{key:"onC2CMessageReadNotice",value:function(e){var t=this;e.dataList.forEach((function(e){if(!Yd(e.c2cMessageReadNotice)){var n=t.getModule(Wf);e.c2cMessageReadNotice.uinPairReadArray.forEach((function(e){var o=e.from,r=e.peerReadTime;Gl.d("".concat(t._n,".onC2CMessageReadNotice from:").concat(o," lastReadTime:").concat(r));var i="".concat(Ir.CONV_C2C).concat(o);n.updateIsReadAfterReadReport({conversationID:i,lastMessageTime:r}),n.updateUnreadCount(i)}))}}))}},{key:"onC2CMessageModified",value:function(e){Gl.d("".concat(this._n,".onC2CMessageModified options:"),JSON.stringify(e));var n=this.getModule(Wf);e.dataList.forEach((function(e){n.onMessageModified(t(t({},e),{},{conversationType:Ir.CONV_C2C}))}))}},{key:"onReadReceiptList",value:function(e){Gl.d("".concat(this._n,".onReadReceiptList options:"),JSON.stringify(e));var t=e.dataList,n=t.userID,o=t.readReceiptList;this.getModule(Wf).updateReadReceiptInfo({userID:n,readReceiptList:o})}},{key:"sendMessage",value:function(e,t){var n=this._createC2CMessagePack(e,t);return this.request(n)}},{key:"_createC2CMessagePack",value:function(e,t){var n=null;t&&(t.offlinePushInfo&&(n=t.offlinePushInfo),!0===t.onlineUserOnly&&(n?n.disablePush=!0:n={disablePush:!0}));var o="";td(e.cloudCustomData)&&e.cloudCustomData.length>0&&(o=e.cloudCustomData);var r=[];if(od(t)&&od(t.messageControlInfo)){var i=t.messageControlInfo,a=i.excludedFromUnreadCount,s=i.excludedFromLastMessage,u=i.excludedFromContentModeration;!0===a&&r.push("NoUnread"),!0===s&&r.push("NoLastMsg"),!0===u&&r.push("NoMsgCheck")}var c=this.isOnlineMessage(e,t)?0:void 0;return{protocolName:kh,tjgID:this.generateTjgID(e),requestData:{fromAccount:this.getMyUserID(),toAccount:e.to,msgBody:e.getElements(),cloudCustomData:o,msgSeq:e.sequence,msgRandom:e.random,msgLifeTime:c,nick:e.nick,avatar:e.avatar,offlinePushInfo:n?{pushFlag:!0===n.disablePush?1:0,title:n.title||"",desc:n.description||"",ext:n.extension||"",apnsInfo:{badgeMode:!0===n.ignoreIOSBadge?1:0,isVoipPush:this._isVoipPush(n)},androidInfo:{OPPOChannelID:n.androidOPPOChannelID||""}}:void 0,messageControlInfo:0!==c?r:void 0,clientTime:e.clientTime,needReadReceipt:!0===e.needReadReceipt?1:0,isSupportExtension:!0===e.isSupportExtension?1:0}}}},{key:"_isVoipPush",value:function(e){var t=void 0;return id(e.disableVoipPush)||(t=!1===e.disableVoipPush?1:0),t}},{key:"isOnlineMessage",value:function(e,t){return!(!t||!0!==t.onlineUserOnly)}},{key:"revokeMessage",value:function(e){return this.request({protocolName:Kh,requestData:{msgInfo:{fromAccount:e.from,toAccount:e.to,msgSeq:e.sequence,msgRandom:e.random,msgTimeStamp:e.time}}})}},{key:"deleteMessage",value:function(e){var t=e.to,n=e.keyList;return Gl.l("".concat(this._n,".deleteMessage toAccount:").concat(t," count:").concat(n.length)),this.request({protocolName:Jh,requestData:{fromAccount:this.getMyUserID(),to:t,keyList:n}})}},{key:"modifyRemoteMessage",value:function(e){var t=e.from,n=e.to,o=e.version,r=void 0===o?0:o,i=e.sequence,a=e.random,s=e.time,u=e.payload,c=e.type,l=e.cloudCustomData,d=void 0;return Kd(c)&&(d=[]).push({type:c,content:u}),this.request({protocolName:Xh,requestData:{from:t,to:n,version:r,sequence:i,random:a,time:s,elements:d,cloudCustomData:l}})}},{key:"setMessageRead",value:function(e){var t=this,n=e.conversationID,o=e.lastMessageTime,r="".concat(this._n,".setMessageRead");Gl.l("".concat(r," conversationID:").concat(n," lastMessageTime:").concat(o)),ed(o)||this.outputWarning("DoNotModifyLastTime");var i=new w_("setC2CMessageRead");return i.setMessage("conversationID:".concat(n," lastMessageTime:").concat(o)),this.request({protocolName:jh,requestData:{C2CMsgReaded:{cookie:"",C2CMsgReadedItem:[{toAccount:n.replace("C2C",""),lastMessageTime:o,receipt:1}]}}}).then((function(){i.setNetworkType(t.getNetworkType()).end(),Gl.l("".concat(r," ok"));var e=t.getModule(Wf);return e.updateIsReadAfterReadReport({conversationID:n,lastMessageTime:o}),e.updateUnreadCount(n),GI()})).catch((function(e){return t.probeNetwork().then((function(t){var n=_(t,2),o=n[0],r=n[1];i.setError(e,o,r).end()})),Gl.l("".concat(r," failed. error:"),e),BI(e)}))}},{key:"getRoamingMessage",value:function(e){var t=this,n="".concat(this._n,".getRoamingMessage"),o=e.peerAccount,r=e.conversationID,i=e.count,a=e.lastMessageTime,s=e.messageKey,u="peerAccount:".concat(o," count:").concat(i||15," lastMessageTime:").concat(a||0," messageKey:").concat(s);Gl.l("".concat(n," ").concat(u));var c=new w_("getC2CRoamingMessages");return this.request({protocolName:Wh,requestData:{peerAccount:o,count:i||15,lastMessageTime:a||0,messageKey:s}}).then((function(e){var o=e.data,i=o.complete,a=o.messageList,s=o.messageKey,l=o.lastMessageTime;id(a)?Gl.l("".concat(n," ok. complete:").concat(i," but messageList is undefined!")):Gl.l("".concat(n," ok. complete:").concat(i," count:").concat(a.length)),c.setNetworkType(t.getNetworkType()).setMessage("".concat(u," complete:").concat(i," length:").concat(a.length)).end();var d=t.getModule(Wf);1===i&&d.setCompleted(r);var p=d.onRoamingMessage(a,r);d.modifyMessageList(r),d.updateIsRead(r),d.updateRoamingMessageKeyAndTime(r,s,l);var f=d.getPeerReadTime(r);if(Gl.l("".concat(n," update isPeerRead property. conversationID:").concat(r," peerReadTime:").concat(f)),f)d.updateMessageIsPeerReadProperty(r,f);else{var h=r.replace(Ir.CONV_C2C,"");t.getRemotePeerReadTime([h]).then((function(){d.updateMessageIsPeerReadProperty(r,d.getPeerReadTime(r))}))}var g="";if(p.length>0)g=p[0].ID;else{var v=d.getLocalOldestMessage(r);v&&(g=v.ID)}return Gl.l("".concat(n," nextReqID:").concat(g," stored message count:").concat(p.length)),{nextReqID:g,storedMessageList:p}})).catch((function(e){return t.probeNetwork().then((function(t){var n=_(t,2),o=n[0],r=n[1];c.setMessage(u).setError(e,o,r).end()})),Gl.w("".concat(n," failed. error:"),e),BI(e)}))}},{key:"getRoamingMessagesHopping",value:function(e){var t=this,n="".concat(this._n,".getRoamingMessagesHopping"),o=e.peerAccount,r=e.time,i=void 0===r?0:r,a=e.count,s=e.direction,u="".concat(Ir.CONV_C2C).concat(o),c="peerAccount:".concat(o," count:").concat(a," time:").concat(i," direction:").concat(s);Gl.l("".concat(n," ").concat(c));var l=new w_("getC2CRoamingMessagesHopping");return this.request({protocolName:Wh,requestData:{peerAccount:o,count:a+1,lastMessageTime:i,direction:s}}).then((function(e){var o=e.data,r=o.complete,i=o.messageList,a=void 0===i?[]:i,d=o.lastMessageTime;Gl.l("".concat(n," ok. complete:").concat(r," count:").concat(a.length)),l.setNetworkType(t.getNetworkType()).setMessage("".concat(c," complete:").concat(r," length:").concat(a.length)).end(),1!==r&&(1===s?a.pop():a.shift());var p=t.getModule(Wf).onRoamingMessage(a,u,!1);t._modifyMessageList(u,p);var f=t._computeResult({complete:r,lastMessageTime:d,resultList:p});return GI(f)})).catch((function(e){return t.probeNetwork().then((function(t){var n=_(t,2),o=n[0],r=n[1];l.setMessage(c).setError(e,o,r).end()})),Gl.w("".concat(n," failed. error:"),e),BI(e)}))}},{key:"_computeResult",value:function(e){var t=e.complete,n=void 0===t?0:t,o=e.lastMessageTime,r=e.resultList,i={messageList:y(void 0===r?[]:r),isCompleted:!1,nextMessageTime:""};return 1===n?(i.isCompleted=!0,i):(i.nextMessageTime=o,i)}},{key:"_modifyMessageList",value:function(e,t){var n=this.getModule(Wf).getLocalConversation(e);if(n)for(var o=n.userProfile.nick,r=n.userProfile.avatar,i=this.getModule(Vf).getNickAndAvatarByUserID(this.getMyUserID()),a=i.nick,s=i.avatar,u=t.length-1;u>=0;u--){var c=t[u];"in"===c.flow&&(c.nick!==o&&c.setNickAndAvatar({nick:o}),c.avatar!==r&&c.setNickAndAvatar({avatar:r})),"out"===c.flow&&(c.nick!==a&&c.setNickAndAvatar({nick:a}),c.avatar!==s&&c.setNickAndAvatar({avatar:s}))}}},{key:"getRemotePeerReadTime",value:function(e){var t=this,n="".concat(this._n,".getRemotePeerReadTime");if(Yd(e))return Gl.w("".concat(n," userIDList is empty!")),Promise.resolve();var o=new w_("getPeerReadTime");return Gl.l("".concat(n," userIDList:").concat(e)),this.request({protocolName:Yh,requestData:{userIDList:e}}).then((function(r){var i=r.data.peerReadTimeList;Gl.l("".concat(n," ok. peerReadTimeList:").concat(i));for(var a="",s=t.getModule(Wf),u=0;u<e.length;u++)a+="".concat(e[u],"-").concat(i[u]," "),i[u]>0&&s.recordPeerReadTime("C2C".concat(e[u]),i[u]);o.setNetworkType(t.getNetworkType()).setMessage(a).end()})).catch((function(e){t.probeNetwork().then((function(t){var n=_(t,2),r=n[0],i=n[1];o.setError(e,r,i).end()})),Gl.w("".concat(n," failed. error:"),e)}))}},{key:"sendReadReceipt",value:function(e){var t=this,n=e[0].conversationID.replace(Ir.CONV_C2C,""),o=new w_("sendC2CReadReceipt");o.setMessage("peerAccount:".concat(n));var r=this.getMyUserID(),i=e.filter((function(e){return e.from!==r&&!0===e.needReadReceipt})).map((function(e){return{fromAccount:e.from,toAccount:e.to,sequence:e.sequence,random:e.random,time:e.time,clientTime:e.clientTime}}));if(0===i.length)return BI({code:$v});var a="".concat(this._n,".sendReadReceipt");return Gl.l("".concat(a,". peerAccount:").concat(n," messageInfoList length:").concat(i.length)),this.request({protocolName:wg,requestData:{peerAccount:n,messageInfoList:i}}).then((function(e){return o.end(),Gl.l("".concat(a," ok")),GI()})).catch((function(e){return t.probeNetwork().then((function(t){var n=_(t,2),r=n[0],i=n[1];o.setError(e,r,i).end()})),Gl.w("".concat(a," failed. error:"),e),BI(e)}))}},{key:"getReadReceiptList",value:function(e){var t="".concat(this._n,".getReadReceiptList"),n=this.getMyUserID(),o=e.filter((function(e){return e.from===n&&!0===e.needReadReceipt}));return Gl.l("".concat(t," userID:").concat(n," messageList length:").concat(o.length)),qI({messageList:o})}},{key:"getMessageExtensions",value:function(e,t){return Gl.l("".concat(this._n,".getMessageExtensions startSequence:").concat(t)),this.request({protocolName:Qh,requestData:{from:e.from,to:e.to,messageKey:this._getMessageKey(e),startSequence:t}})}},{key:"modifyMessageExtensions",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return Gl.l("".concat(this._n,".modifyMessageExtensions operateType:").concat(n)),this.request({protocolName:$h,requestData:{from:e.from,to:e.to,messageKey:this._getMessageKey(e),extensionList:t,operateType:n}})}},{key:"_getMessageKey",value:function(e){var t=e.clientSequence,n=e.random,o=e.time;return"".concat(t,"_").concat(n,"_").concat(o)}},{key:"reset",value:function(){Gl.l("".concat(this._n,".reset")),this._messageFromUnreadDBMap.clear(),this._signalingFromUnreadDBList.length=0}}]),o}(vh),HI=ae.match(/firefox\/(\d+)/i),KI=!!HI&&+HI[1],jI=/MSIE|Trident/.test(ae),zI=ae.match(/AppleWebKit\/(\d+)\./),ZI=!!zI&&+zI[1],WI=[],YI=j(WI.sort),JI=j(WI.push),XI=w((function(){WI.sort(void 0)})),$I=w((function(){WI.sort(null)})),QI=uo("sort"),eC=!w((function(){if(de)return de<70;if(!(KI&&KI>3)){if(jI)return!0;if(ZI)return ZI<603;var e,t,n,o,r="";for(e=65;e<76;e++){switch(t=String.fromCharCode(e),e){case 66:case 69:case 70:case 72:n=3;break;case 68:case 71:n=4;break;default:n=2}for(o=0;o<47;o++)WI.push({k:t+o,v:n})}for(WI.sort((function(e,t){return t.v-e.v})),o=0;o<WI.length;o++)t=WI[o].k.charAt(0),r.charAt(r.length-1)!==t&&(r+=t);return"DGBEFHACIJK"!==r}}));on({target:"Array",proto:!0,forced:XI||!$I||!QI||!eC},{sort:function(e){void 0!==e&&ye(e);var t=De(this);if(eC)return void 0===e?YI(t):YI(t,e);var n,o,r=[],i=Gt(t);for(o=0;o<i;o++)o in t&&JI(r,t[o]);for(dy(r,function(e){return function(t,n){return void 0===n?-1:void 0===t?1:void 0!==e?+e(t,n)||0:pn(t)>pn(n)?1:-1}}(e)),n=r.length,o=0;o<n;)t[o]=r[o++];for(;o<i;)delete t[o++];return t}});var tC=so.findIndex,nC=!0;"findIndex"in[]&&Array(1).findIndex((function(){nC=!1})),on({target:"Array",proto:!0,forced:nC},{findIndex:function(e){return tC(this,e,arguments.length>1?arguments[1]:void 0)}}),ji("findIndex");var oC=function(){function e(){r(this,e),this.list=new Map,this._n="MessageListHandler",this._latestMessageSentByPeerMap=new Map,this._latestMessageSentByMeMap=new Map}return a(e,[{key:"getLocalOldestMessageByConversationID",value:function(e){if(!e)return null;if(!this.list.has(e))return null;var t=this.list.get(e).values();return t?t.next().value:null}},{key:"pushIn",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=e.conversationID,o=!0;this.list.has(n)||this.list.set(n,new Map);var r=this._getUniqueIDOfMessage(e);if(this.list.get(n).has(r)){var i=this.list.get(n).get(r);if(!t||!0===i.isModified)return!1}return this.list.get(n).set(r,e),this._setLatestMessageSentByPeer(n,e),this._setLatestMessageSentByMe(n,e),o}},{key:"unshift",value:function(e,t){var n;if(rd(e)?e.length>0&&(n=e[0].conversationID,this._unshiftMultipleMessages(e,t)):(n=e.conversationID,this._unshiftSingleMessage(e,t)),n&&n.startsWith(Ir.CONV_C2C)){var o=Array.from(this.list.get(n).values()),r=o.length;if(0===r)return;for(var i=r-1;i>=0;i--)if("out"===o[i].flow){this._setLatestMessageSentByMe(n,o[i]);break}for(var a=r-1;a>=0;a--)if("in"===o[a].flow){this._setLatestMessageSentByPeer(n,o[a]);break}}}},{key:"_unshiftSingleMessage",value:function(e,t){var n=e.conversationID,o=this._getUniqueIDOfMessage(e);if(!this.list.has(n))return this.list.set(n,new Map),this.list.get(n).set(o,e),void t.push(e);var r=this.list.get(n),i=Array.from(r);r.has(o)||(i.unshift([o,e]),this.list.set(n,new Map(i)),t.push(e))}},{key:"_unshiftMultipleMessages",value:function(e,t){for(var n=e.length,o=[],r=e[0].conversationID,i=this.list.get(r),a=this.list.has(r)?Array.from(i):[],s=0;s<n;s++){var u=this._getUniqueIDOfMessage(e[s]);i&&i.has(u)||(o.push([u,e[s]]),t.push(e[s]))}this.list.set(r,new Map(o.concat(a)))}},{key:"remove",value:function(e){var t=e.conversationID,n=this._getUniqueIDOfMessage(e);this.list.has(t)&&this.list.get(t).delete(n)}},{key:"revoke",value:function(e,t,n){if(Gl.d("revoke message",e,t,n),this.list.has(e)){var o,r=S(this.list.get(e));try{for(r.s();!(o=r.n()).done;){var i=_(o.value,2)[1];if(i.sequence===t&&(id(n)||i.random===n))return i.isRevoked=!0,i}}catch(s){r.e(s)}finally{r.f()}}return null}},{key:"removeByConversationID",value:function(e){this.list.has(e)&&(this.list.delete(e),this._latestMessageSentByPeerMap.delete(e),this._latestMessageSentByMeMap.delete(e))}},{key:"findMessage",value:function(e){var t,n=null,o=S(this.list);try{for(o.s();!(t=o.n()).done;)for(var r=y(_(t.value,2)[1].values()),i=r.length,a=0;a<i;a++)if(r[a].ID===e){n=r[a];break}}catch(u){o.e(u)}finally{o.f()}return n}},{key:"updateMessageIsPeerReadProperty",value:function(e,t){var n=[];if(this.list.has(e)){var o,r=S(this.list.get(e));try{for(r.s();!(o=r.n()).done;){var i=_(o.value,2)[1];i.time<=t&&!i.isPeerRead&&"out"===i.flow&&(i.isPeerRead=!0,n.push(i))}}catch(s){r.e(s)}finally{r.f()}Gl.l("".concat(this._n,".updateMessageIsPeerReadProperty conversationID:").concat(e," peerReadTime:").concat(t," count:").concat(n.length))}return n}},{key:"updateMessageIsModifiedProperty",value:function(e){var t=e.conversationID;if(this.list.has(t)){var n=this._getUniqueIDOfMessage(e),o=this.list.get(t).get(n);o&&(o.isModified=!0)}}},{key:"hasLocalMessageList",value:function(e){return this.list.has(e)}},{key:"getLocalMessageList",value:function(e){return this.hasLocalMessageList(e)?y(this.list.get(e).values()):[]}},{key:"hasLocalMessage",value:function(e,t){for(var n=!1,o=this.getLocalMessageList(e),r=o.length,i=0;i<r;i++)o[i].ID===t&&(n=!0);return n}},{key:"getLocalMessage",value:function(e,t){for(var n=null,o=this.getLocalMessageList(e),r=o.length,i=0;i<r;i++)if(o[i].ID===t){n=o[i];break}return n}},{key:"getLocalLastMessage",value:function(e){var t=this.getLocalMessageList(e);return t[t.length-1]}},{key:"getLocalOldestMessage",value:function(e){return this.getLocalMessageList(e)[0]}},{key:"_setLatestMessageSentByPeer",value:function(e,t){e.startsWith(Ir.CONV_C2C)&&"in"===t.flow&&this._latestMessageSentByPeerMap.set(e,t)}},{key:"_setLatestMessageSentByMe",value:function(e,t){e.startsWith(Ir.CONV_C2C)&&"out"===t.flow&&this._latestMessageSentByMeMap.set(e,t)}},{key:"getLatestMessageSentByPeer",value:function(e){return this._latestMessageSentByPeerMap.get(e)}},{key:"getLatestMessageSentByMe",value:function(e){return this._latestMessageSentByMeMap.get(e)}},{key:"modifyMessageSentByPeer",value:function(e){var t=e.conversationID,n=e.latestNick,o=e.latestAvatar,r=this.list.get(t);if(!Yd(r)){var i=Array.from(r.values()),a=i.length;if(0!==a){for(var s=null,u=0,c=!1,l=a-1;l>=0;l--)"in"===i[l].flow&&((s=i[l]).nick!==n&&(s.setNickAndAvatar({nick:n}),c=!0),s.avatar!==o&&(s.setNickAndAvatar({avatar:o}),c=!0),c&&(u+=1));Gl.l("".concat(this._n,".modifyMessageSentByPeer conversationID:").concat(t," count:").concat(u))}}}},{key:"modifyMessageSentByMe",value:function(e){var t=e.conversationID,n=e.latestNick,o=e.latestAvatar,r=this.list.get(t);if(!Yd(r)){var i=Array.from(r.values()),a=i.length;if(0!==a){for(var s=null,u=0,c=!1,l=a-1;l>=0;l--)"out"===i[l].flow&&((s=i[l]).nick!==n&&(s.setNickAndAvatar({nick:n}),c=!0),s.avatar!==o&&(s.setNickAndAvatar({avatar:o}),c=!0),c&&(u+=1));Gl.l("".concat(this._n,".modifyMessageSentByMe conversationID:").concat(t," count:").concat(u))}}}},{key:"getTopicConversationIDList",value:function(e){return y(this.list.keys()).filter((function(t){return t.startsWith("".concat(Ir.CONV_GROUP).concat(e))}))}},{key:"traversal",value:function(){if(0!==this.list.size&&-1===Gl.getLevel()){console.group("conversationID-messageCount");var e,t=S(this.list);try{for(t.s();!(e=t.n()).done;){var n=_(e.value,2),o=n[0],r=n[1];console.log("".concat(o,"-").concat(r.size))}}catch(a){t.e(a)}finally{t.f()}console.groupEnd()}}},{key:"onMessageModified",value:function(e,t){if(!this.list.has(e))return{isUpdated:!1,message:null};var n=this._getUniqueIDOfMessage(t),o=this.list.get(e).has(n);if(Gl.d("".concat(this._n,".onMessageModified conversationID:").concat(e," uniqueID:").concat(n," has:").concat(o)),o){var r=this.list.get(e).get(n),i=t.messageVersion,a=t.elements,s=t.cloudCustomData;return r.version<i?(r.version=i,r._elements=JSON.parse(JSON.stringify(a)),r.payload=JSON.parse(JSON.stringify(a[0].content)),r.type=a[0].type,r.cloudCustomData=s,r.isModified=!0,{isUpdated:!0,message:r}):{isUpdated:!1,message:r}}return{isUpdated:!1,message:null}}},{key:"_getUniqueIDOfMessage",value:function(e){var t=e.from,n=e.to,o=e.random,r=e.sequence,i=e.time;return"".concat(t,"-").concat(n,"-").concat(o,"-").concat(r,"-").concat(i)}},{key:"reset",value:function(){this.list.clear(),this._latestMessageSentByPeerMap.clear(),this._latestMessageSentByMeMap.clear()}}]),e}(),rC="_a2KeyAndTinyIDUpdated",iC="_cloudConfigUpdated",aC="_profileUpdated";function sC(e){this.mixin(e)}sC.mixin=function(e){var t=e.prototype||e;t._isReady=!1,t.ready=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e)return this._isReady?void(t?e.call(this):setTimeout(e,1)):(this._readyQueue=this._readyQueue||[],void this._readyQueue.push(e))},t.triggerReady=function(){var e=this;this._isReady=!0,setTimeout((function(){var t=e._readyQueue;e._readyQueue=[],t&&t.length>0&&t.forEach((function(e){e.call(this)}),e)}),1)},t.resetReady=function(){this._isReady=!1,this._readyQueue=[]},t.isReady=function(){return this._isReady}};var uC=["jpg","jpeg","gif","png","bmp","image","webp"],cC=["mp4","quicktime","mov"],lC=1,dC=2,pC=3,fC=255,hC=function(){function e(t){var n=this;r(this,e),Yd(t)||(this.userID=t.userID||"",this.nick=t.nick||"",this.gender=t.gender||"",this.birthday=t.birthday||0,this.location=t.location||"",this.selfSignature=t.selfSignature||"",this.allowType=t.allowType||Ir.ALLOW_TYPE_ALLOW_ANY,this.language=t.language||0,this.avatar=t.avatar||"",this.messageSettings=t.messageSettings||0,this.adminForbidType=t.adminForbidType||Ir.FORBID_TYPE_NONE,this.level=t.level||0,this.role=t.role||0,this.lastUpdatedTime=0,this.profileCustomField=[],Yd(t.profileCustomField)||t.profileCustomField.forEach((function(e){n.profileCustomField.push({key:e.key,value:e.value})})))}return a(e,[{key:"validate",value:function(e){var t=!0,n="";if(Yd(e))return{valid:!1,tips:"empty options"};if(e.profileCustomField)for(var o=e.profileCustomField.length,r=null,i=0;i<o;i++){if(r=e.profileCustomField[i],!td(r.key)||-1===r.key.indexOf("Tag_Profile_Custom"))return{valid:!1,tips:"The prefix of keys of the custom profile key-value pairs (which is profileCustomField) must be Tag_Profile_Custom"};if(!td(r.value))return{valid:!1,tips:"The type of values of the custom profile key-value pairs (which is profileCustomField) must be String"}}for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){if("profileCustomField"===a)continue;if(Yd(e[a])&&!td(e[a])&&!ed(e[a])){n="key:"+a+", invalid value:"+e[a],t=!1;continue}switch(a){case"nick":td(e[a])||(n="nick must be a string",t=!1),gd(e[a])>500&&(n="nick name limited: must less than or equal to ".concat(500," bytes, current size: ").concat(gd(e[a])," bytes"),t=!1);break;case"gender":yd(Kl,e.gender)||(n="key:gender, invalid value:"+e.gender,t=!1);break;case"birthday":ed(e.birthday)||(n="birthday must be a number",t=!1);break;case"location":td(e.location)||(n="location must be a string",t=!1);break;case"selfSignature":td(e.selfSignature)||(n="selfSignature must be a string",t=!1);break;case"allowType":yd(zl,e.allowType)||(n="key:allowType, invalid value:"+e.allowType,t=!1);break;case"language":ed(e.language)||(n="language must be a number",t=!1);break;case"avatar":td(e.avatar)||(n="avatar must be a string",t=!1);break;case"messageSettings":0!==e.messageSettings&&1!==e.messageSettings&&(n="messageSettings must be 0 or 1",t=!1);break;case"adminForbidType":yd(jl,e.adminForbidType)||(n="key:adminForbidType, invalid value:"+e.adminForbidType,t=!1);break;case"level":ed(e.level)||(n="level must be a number",t=!1);break;case"role":ed(e.role)||(n="role must be a number",t=!1);break;default:n="unknown key:"+a+"  "+e[a],t=!1}}return{valid:t,tips:n}}}]),e}(),gC=a((function e(t){r(this,e),this.value=t,this.next=null})),vC=function(){function e(t){r(this,e),this.MAX_LENGTH=t,this.pTail=null,this.pNodeToDel=null,this.map=new Map}return a(e,[{key:"set",value:function(e){var t=new gC(e);if(this.map.size<this.MAX_LENGTH)null===this.pTail?(this.pTail=t,this.pNodeToDel=t):(this.pTail.next=t,this.pTail=t),this.map.set(e,1);else{var n=this.pNodeToDel;this.pNodeToDel=this.pNodeToDel.next,this.map.delete(n.value),n.next=null,n=null,this.pTail.next=t,this.pTail=t,this.map.set(e,1)}}},{key:"has",value:function(e){return this.map.has(e)}},{key:"delete",value:function(e){this.has(e)&&this.map.delete(e)}},{key:"tail",value:function(){return this.pTail}},{key:"size",value:function(){return this.map.size}},{key:"data",value:function(){return Array.from(this.map.keys())}},{key:"reset",value:function(){for(var e;null!==this.pNodeToDel;)e=this.pNodeToDel,this.pNodeToDel=this.pNodeToDel.next,e.next=null,e=null;this.pTail=null,this.map.clear()}}]),e}(),mC=["groupID","name","avatar","type","introduction","notification","ownerID","selfInfo","createTime","infoSequence","lastInfoTime","lastMessage","nextMessageSeq","memberNum","maxMemberNum","memberList","joinOption","groupCustomField","muteAllMembers","isSupportTopic","_lastRevokedTime"],_C=function(){function e(t){r(this,e),this.groupID="",this.name="",this.avatar="",this.type="",this.introduction="",this.notification="",this.ownerID="",this.createTime="",this.infoSequence="",this.lastInfoTime="",this.selfInfo={messageRemindType:"",joinTime:"",nameCard:"",role:"",userID:"",memberCustomField:void 0,readedSequence:0,excludedUnreadSequenceList:void 0},this.lastMessage={lastTime:"",lastSequence:"",fromAccount:"",messageForShow:""},this.nextMessageSeq="",this.memberNum="",this.memberCount="",this.maxMemberNum="",this.maxMemberCount="",this.joinOption="",this.groupCustomField=[],this.muteAllMembers=!1,this.isSupportTopic=!1,this._lastRevokedTime=0,this._initGroup(t)}return a(e,[{key:"memberNum",get:function(){return this.memberCount},set:function(e){}},{key:"maxMemberNum",get:function(){return this.maxMemberCount},set:function(e){}},{key:"_initGroup",value:function(e){for(var t in e)mC.indexOf(t)<0||("selfInfo"!==t?("memberNum"===t&&(this.memberCount=e[t]),"maxMemberNum"===t&&(this.maxMemberCount=e[t]),"isSupportTopic"!==t?this[t]=e[t]:this.isSupportTopic=1===e[t]):this.updateSelfInfo(e[t]))}},{key:"updateGroup",value:function(e){var t=this;e.appid=void 0,e.grossTopicNextMsgSeq=void 0,e.selfInfo&&(e.selfInfo.grossTopicReadSeq=void 0);var n=JSON.parse(JSON.stringify(e));n.lastMsgTime&&(this.lastMessage.lastTime=n.lastMsgTime),id(n.muteAllMembers)||("On"===n.muteAllMembers?n.muteAllMembers=!0:n.muteAllMembers=!1),n.groupCustomField&&kd(this.groupCustomField,n.groupCustomField),id(n.memberNum)||(this.memberCount=n.memberNum),id(n.maxMemberNum)||(this.maxMemberCount=n.maxMemberNum),id(n.isSupportTopic)||(this.isSupportTopic=ed(n.isSupportTopic)?1===n.isSupportTopic:n.isSupportTopic),fd(this,n,["members","errorCode","lastMsgTime","groupCustomField","memberNum","maxMemberNum","isSupportTopic"]),rd(n.members)&&n.members.length>0&&n.members.forEach((function(e){e.userID===t.selfInfo.userID&&fd(t.selfInfo,e,["sequence"])}))}},{key:"updateSelfInfo",value:function(e){var n={nameCard:e.nameCard,joinTime:e.joinTime,role:e.role,messageRemindType:e.messageRemindType,readedSequence:e.readedSequence,excludedUnreadSequenceList:e.excludedUnreadSequenceList};fd(this.selfInfo,t({},n),[],["",null,void 0,0,NaN])}},{key:"setSelfNameCard",value:function(e){this.selfInfo.nameCard=e}}]),e}(),yC=function(e,n){return id(e)?{lastTime:0,lastSequence:0,fromAccount:0,messageForShow:"",payload:null,type:"",isRevoked:!1,cloudCustomData:"",onlineOnlyFlag:!1,nick:"",nameCard:"",version:0,isPeerRead:!1,revoker:null}:e instanceof PI?{lastTime:e.time||0,lastSequence:e.sequence||0,fromAccount:e.from||"",messageForShow:Hd(e.type,e.payload,n),payload:e.payload||null,type:e.type||null,isRevoked:e.isRevoked||!1,cloudCustomData:e.cloudCustomData||"",onlineOnlyFlag:e._onlineOnlyFlag||!1,nick:e.nick||"",nameCard:e.nameCard||"",version:e.version||0,isPeerRead:e.isPeerRead||!1,revoker:e.revoker||null}:t(t({},e),{},{messageForShow:Hd(e.type,e.payload,n)})},MC=function(){function e(t,n){r(this,e),this.conversationID=t.conversationID||"",this.unreadCount=t.unreadCount||0,this.type=t.type||"",this.lastMessage=yC(t.lastMessage,n),t.lastMsgTime&&(this.lastMessage.lastTime=t.lastMsgTime),this._isInfoCompleted=!1,this.peerReadTime=t.peerReadTime||0,this.groupAtInfoList=[],this.remark="",this.isPinned=t.isPinned||!1,this.messageRemindType="",this.markList=t.markList||[],this.customData=t.customData||"",this.conversationGroupList=t.conversationGroupList||[],this._initProfile(t)}return a(e,[{key:"toAccount",get:function(){return this.conversationID.startsWith(Ir.CONV_C2C)?this.conversationID.replace(Ir.CONV_C2C,""):this.conversationID.startsWith(Ir.CONV_GROUP)?this.conversationID.replace(Ir.CONV_GROUP,""):""}},{key:"subType",get:function(){return this.groupProfile?this.groupProfile.type:""}},{key:"_initProfile",value:function(e){var t=this;Object.keys(e).forEach((function(n){switch(n){case"userProfile":t.userProfile=e.userProfile;break;case"groupProfile":t.groupProfile=e.groupProfile}})),id(this.userProfile)&&this.type===Ir.CONV_C2C?this.userProfile=new hC({userID:e.conversationID.replace("C2C","")}):id(this.groupProfile)&&this.type===Ir.CONV_GROUP&&(this.groupProfile=new _C({groupID:e.conversationID.replace("GROUP","")}))}},{key:"updateUnreadCount",value:function(e){var t=e.nextUnreadCount,n=e.isFromGetConversations,o=e.isUnreadC2CMessage;id(t)||(Sd(this.subType)?this.unreadCount=0:n&&this.type===Ir.CONV_GROUP||n&&this.type===Ir.CONV_TOPIC||o&&this.type===Ir.CONV_C2C?this.unreadCount=t:this.unreadCount=this.unreadCount+t)}},{key:"updateLastMessage",value:function(e){this.lastMessage=yC(e)}},{key:"updateGroupAtInfoList",value:function(e){if(!this._isNeedMergeGroupAtInfo(e)){var t,n=(M(t=e.groupAtType)||I(t)||C(t)||T()).slice(0);-1!==n.indexOf(Ir.CONV_AT_ME)&&-1!==n.indexOf(Ir.CONV_AT_ALL)&&(n=[Ir.CONV_AT_ALL_AT_ME]);var o={from:e.from,groupID:e.groupID,topicID:e.topicID,messageSequence:e.sequence,atTypeArray:n,__random:e.__random,__sequence:e.__sequence};this.groupAtInfoList.push(o)}}},{key:"_isNeedMergeGroupAtInfo",value:function(e){var t=e.groupID,n=e.sequence;if(!bd({groupID:t}))return!1;var o=!1;return this.groupAtInfoList.forEach((function(t){t.messageSequence===n&&(t.atTypeArray.indexOf(Ir.CONV_AT_ME)>-1&&e.groupAtType.indexOf(Ir.CONV_AT_ALL)>-1&&(t.atTypeArray=[Ir.CONV_AT_ALL_AT_ME]),t.atTypeArray.indexOf(Ir.CONV_AT_ALL)>-1&&e.groupAtType.indexOf(Ir.CONV_AT_ME)>-1&&(t.atTypeArray=[Ir.CONV_AT_ALL_AT_ME],t.__random=e.__random,t.__sequence=e.__sequence),o=!0)})),o}},{key:"clearGroupAtInfoList",value:function(){this.groupAtInfoList.length=0}},{key:"reduceUnreadCount",value:function(){return this.unreadCount>=1&&(this.unreadCount-=1,!0)}},{key:"isLastMessageRevoked",value:function(e){var t=e.sequence,n=e.time;return this.type===Ir.CONV_C2C&&t===this.lastMessage.lastSequence&&n===this.lastMessage.lastTime||this.type===Ir.CONV_GROUP&&t===this.lastMessage.lastSequence}},{key:"setLastMessageRevoked",value:function(e){this.lastMessage.isRevoked=e}},{key:"setLastMessageRevoker",value:function(e){this.lastMessage.revoker=e}}]),e}(),IC=function(){function e(t){r(this,e),this._conversationModule=t,this._n="MessageRemindHandler",this._updateSequence=0}return a(e,[{key:"getC2CMessageRemindType",value:function(){var e=this,t="".concat(this._n,".getC2CMessageRemindType");return this._conversationModule.request({protocolName:Zh,updateSequence:this._updateSequence}).then((function(n){Gl.l("".concat(t," ok"));var o=n.data,r=o.updateSequence,i=o.muteFlagList;e._updateSequence=r,e._patchC2CMessageRemindType(i)})).catch((function(e){Gl.e("".concat(t," failed. error:"),e)}))}},{key:"_patchC2CMessageRemindType",value:function(e){var t=this,n=0,o="";rd(e)&&e.length>0&&e.forEach((function(e){var r=e.userID,i=e.muteFlag;0===i?o=Ir.MSG_REMIND_ACPT_AND_NOTE:1===i?o=Ir.MSG_REMIND_DISCARD:2===i&&(o=Ir.MSG_REMIND_ACPT_NOT_NOTE),!0===t._conversationModule.patchMessageRemindType({ID:r,isC2CConversation:!0,messageRemindType:o})&&(n+=1)})),Gl.l("".concat(this._n,"._patchC2CMessageRemindType count:").concat(n))}},{key:"set",value:function(e){return e.groupID?this._setGroupMessageRemindType(e):rd(e.userIDList)?this._setC2CMessageRemindType(e):void 0}},{key:"_setGroupMessageRemindType",value:function(e){var t=this,n="".concat(this._n,"._setGroupMessageRemindType"),o=e.groupID,r=e.messageRemindType,i="groupID:".concat(o," messageRemindType:").concat(r),a=new w_("setMessageRemindType");return a.setMessage(i),this._getModule(zf).modifyGroupMemberInfo({groupID:o,messageRemindType:r,userID:this._conversationModule.getMyUserID()}).then((function(){a.setNetworkType(t._conversationModule.getNetworkType()).end(),Gl.l("".concat(n," ok. ").concat(i));var o=t.onGroupMessageRemindTypeUpdated(e);return t._conversationModule.emitTotalUnreadMessageCountUpdate(),GI(o)})).catch((function(e){return t._conversationModule.probeNetwork().then((function(t){var n=_(t,2),o=n[0],r=n[1];a.setError(e,o,r).end()})),Gl.e("".concat(n," failed. error:"),e),BI(e)}))}},{key:"onGroupMessageRemindTypeUpdated",value:function(e){var t=e.groupID,n=e.messageRemindType,o=this._getModule(Kf).getLocalGroupProfile(t);if(o&&(o.selfInfo.messageRemindType=n),Dd(t)){var r=t,i=Vd(r),a=this._getModule(Zf).getLocalTopic(i,r);return a&&(a.updateSelfInfo({messageRemindType:n}),this._conversationModule.emitOuterEvent(Mr.TOPIC_UPDATED,{groupID:i,topic:a})),{topic:a}}return this._conversationModule.patchMessageRemindType({ID:t,isC2CConversation:!1,messageRemindType:n})&&this._emitConversationUpdate(),{group:o}}},{key:"_setC2CMessageRemindType",value:function(e){var t=this,n="".concat(this._n,"._setC2CMessageRemindType"),o=e.userIDList,r=e.messageRemindType,i=o.slice(0,30),a=0;r===Ir.MSG_REMIND_DISCARD?a=1:r===Ir.MSG_REMIND_ACPT_NOT_NOTE&&(a=2);var s="userIDList:".concat(i," messageRemindType:").concat(r),u=new w_("setMessageRemindType");return u.setMessage(s),this._conversationModule.request({protocolName:zh,requestData:{userIDList:i,muteFlag:a}}).then((function(e){u.setNetworkType(t._conversationModule.getNetworkType()).end();var o=e.data,a=o.updateSequence,s=o.errorList;t._updateSequence=a;var c=[],l=[];rd(s)&&s.forEach((function(e){c.push(e.userID),l.push({userID:e.userID,code:e.errorCode})}));var d=i.filter((function(e){return-1===c.indexOf(e)}));Gl.l("".concat(n," ok. successUserIDList:").concat(d," failureUserIDList:").concat(JSON.stringify(l)));var p=0;return d.forEach((function(e){t._conversationModule.patchMessageRemindType({ID:e,isC2CConversation:!0,messageRemindType:r})&&(p+=1)})),p>=1&&t._emitConversationUpdate(),i.length=c.length=0,t._conversationModule.emitTotalUnreadMessageCountUpdate(),qI({successUserIDList:d.map((function(e){return{userID:e}})),failureUserIDList:l})})).catch((function(e){return t._conversationModule.probeNetwork().then((function(t){var n=_(t,2),o=n[0],r=n[1];u.setError(e,o,r).end()})),Gl.e("".concat(n," failed. error:"),e),BI(e)}))}},{key:"_getModule",value:function(e){return this._conversationModule.getModule(e)}},{key:"_emitConversationUpdate",value:function(){this._conversationModule.emitConversationUpdate(!0,!1)}},{key:"setUpdateSequence",value:function(e){this._updateSequence=e}},{key:"reset",value:function(){Gl.l("".concat(this._n,".reset")),this._updateSequence=0}}]),e}(),CC=kr("splice"),kC=R.TypeError,TC=Math.max,SC=Math.min;on({target:"Array",proto:!0,forced:!CC},{splice:function(e,t){var n,o,r,i,a,s,u=De(this),c=Gt(u),l=Ot(e,c),d=arguments.length;if(0===d?n=o=0:1===d?(n=0,o=c-l):(n=d-2,o=SC(TC(Lt(t),0),c-l)),c+n-o>9007199254740991)throw kC("Maximum allowed length exceeded");for(r=ro(u,o),i=0;i<o;i++)(a=l+i)in u&&bo(r,i,u[a]);if(r.length=o,n<o){for(i=l;i<c-o;i++)s=i+n,(a=i+o)in u?u[s]=u[a]:delete u[s];for(i=c;i>c-o+n;i--)delete u[i-1]}else if(n>o)for(i=c-o;i>l;i--)s=i+n-1,(a=i+o-1)in u?u[s]=u[a]:delete u[s];for(i=0;i<n;i++)u[i+l]=arguments[i+2];return u.length=c-o+n,r}});var bC=function(){function e(t){r(this,e),this._conversationModule=t,this._n="ConvGroupHandler",this._convGroupMap=new Map,this._startIndex=0,this._pagingStatus=jp.NOT_START}return a(e,[{key:"setConvCustomData",value:function(e){var t=this,n="".concat(this._n,".").concat("setConvCustomData"),o=e.conversationIDList,r=e.customData;Gl.l("".concat(n," options:"),e);var i=new w_("setConvCustomData");i.setMessage(JSON.stringify(e));var a={fromAccount:this._getMyUserID(),itemList:[]},s=[],u=[];return o.forEach((function(e){if(!t._hasLocalConversation(e))return t._onConversationNotFound(u,e),!0;if(!Ed(e)&&!Ad(e))return t._onConversationIDInvalid(u,e),!0;var n={operationType:2,contactItem:void 0,customMark:r};Ed(e)?n.contactItem={type:1,toAccount:e.replace(Ir.CONV_C2C,"")}:Ad(e)&&(n.contactItem={type:2,groupID:e.replace(Ir.CONV_GROUP,"")}),a.itemList.push(n)})),u.length===o.length?qI({successConversationIDList:s,failureConversationIDList:u}):this._conversationModule.request({protocolName:ag,requestData:a}).then((function(e){i.setNetworkType(t._conversationModule.getNetworkType()).end(),Gl.l("".concat(n," ok"));var o=e.data.resultItem;if(rd(o)){var a,c,l=!1;o.forEach((function(e){a=t._concatConversationID(e.contactItem),0===e.resultCode?(s.push(a),(c=t._getLocalConversation(a))&&c.customData!==r&&(c.customData=r,l=!0)):u.push({conversationID:a,code:e.resultCode,message:e.resultInfo})})),!0===l&&t._emitConversationUpdate()}return GI({successConversationIDList:s,failureConversationIDList:u})})).catch((function(e){return t._conversationModule.probeNetwork().then((function(t){var n=_(t,2),o=n[0],r=n[1];i.setError(e,o,r).end()})),Gl.e("".concat(n," failed. error:"),e),BI(e)}))}},{key:"markConversation",value:function(e){var t=this;if(!this._conversationModule.canIUse(Uc.CONV_MARK))return BI({code:p_});var n="".concat(this._n,".").concat("markConversation"),o=e.conversationIDList,r=e.markType,i=e.enableMark;Gl.l("".concat(n," options:"),e);var a=new w_("markConversation");a.setMessage(JSON.stringify(e));var s=void 0,u=void 0,c=this._getFlagBit(r);!0===i?u=[c]:s=[c];var l={fromAccount:this._getMyUserID(),itemList:[]},d=[],p=[];return o.forEach((function(e){if(!t._hasLocalConversation(e))return t._onConversationNotFound(p,e),!0;if(!Ed(e)&&!Ad(e))return t._onConversationIDInvalid(p,e),!0;var n={operationType:1,contactItem:void 0,clearMark:s,setMark:u};Ed(e)?n.contactItem={type:1,toAccount:e.replace(Ir.CONV_C2C,"")}:Ad(e)&&(n.contactItem={type:2,groupID:e.replace(Ir.CONV_GROUP,"")}),l.itemList.push(n)})),p.length===o.length?qI({successConversationIDList:d,failureConversationIDList:p}):this._conversationModule.request({protocolName:sg,requestData:l}).then((function(e){a.setNetworkType(t._conversationModule.getNetworkType()).end(),Gl.l("".concat(n," ok"));var o=e.data.resultItem;if(rd(o)){var s,u,c=!1;o.forEach((function(e){if(s=t._concatConversationID(e.contactItem),0===e.resultCode){if(d.push(s),u=t._getLocalConversation(s)){var n=u.markList.indexOf(r);!0===i?-1===n&&(u.markList.push(r),c=!0):-1!==n&&(u.markList.splice(n,1),c=!0)}}else p.push({conversationID:s,code:e.resultCode,message:e.resultInfo})})),!0===c&&t._emitConversationUpdate()}return GI({successConversationIDList:d,failureConversationIDList:p})})).catch((function(e){return t._conversationModule.probeNetwork().then((function(t){var n=_(t,2),o=n[0],r=n[1];a.setError(e,o,r).end()})),Gl.e("".concat(n," failed. error:"),e),BI(e)}))}},{key:"getLocalConvGroupList",value:function(){var e=this;return Gl.l("".concat(this._n,".getLocalConvGroupList pagingStatus:").concat(this._pagingStatus)),this._pagingStatus===jp.REJECTED?this.getRemoteConvGroupList().then((function(){return GI(y(e._convGroupMap.values()))})):qI(y(this._convGroupMap.values()))}},{key:"getRemoteConvGroupList",value:function(){var e=this,t="".concat(this._n,".getRemoteConvGroupList");return this._pagingStatus=jp.PENDING,this._conversationModule.request({protocolName:fg,requestData:{fromAccount:this._getMyUserID(),startIndex:this._startIndex,startTime:wl()}}).then((function(n){var o,r,i=n.data,a=i.completeFlag,s=i.contactItem,u=i.nextStartIndex,c=void 0===u?0:u,l=i.groupItem;if(e._startIndex=c,Gl.l("".concat(t," completeFlag:").concat(a," nextStartIndex:").concat(c)),rd(l)&&l.forEach((function(t){var n=t.convGroupID,o=t.groupName;e._convGroupMap.set(n,o)})),rd(s)&&s.forEach((function(t){var n=t.standardMark,i=t.customData,a=t.convGroupIDList;if(o=e._concatConversationID(t),(r=e._getLocalConversation(o))&&(r.markList=jd(n),r.customData=i||"",rd(a))){var s=[];a.forEach((function(t){e._convGroupMap.has(t)&&s.push(e._convGroupMap.get(t))})),r.conversationGroupList=[].concat(s),s.length=0}})),0===a)return e.getRemoteConvGroupList();1===a&&(e._pagingStatus=jp.RESOLVED,e._emitConversationUpdate(),e._emitConvGroupListUpdate())})).catch((function(n){e._pagingStatus=jp.REJECTED,Gl.w("".concat(t," failed. error:"),n)}))}},{key:"createConvGroup",value:function(e){var t=this;if(!this._conversationModule.canIUse(Uc.CONV_GROUP))return BI({code:p_});var n="".concat(this._n,".").concat("createConvGroup");Gl.l("".concat(n," options:"),e);var o=new w_("createConvGroup");o.setMessage(JSON.stringify(e));var r=e.groupName,i=e.conversationIDList,a={fromAccount:this._getMyUserID(),itemList:[{groupName:r,contactItem:[]}]},s=[],u=[];return i.forEach((function(e){return t._hasLocalConversation(e)?Ed(e)||Ad(e)?void(Ed(e)?a.itemList[0].contactItem.push({type:1,toAccount:e.replace(Ir.CONV_C2C,"")}):Ad(e)&&a.itemList[0].contactItem.push({type:2,groupID:e.replace(Ir.CONV_GROUP,"")})):(t._onConversationIDInvalid(u,e),!0):(t._onConversationNotFound(u,e),!0)})),u.length===i.length?qI({successConversationIDList:s,failureConversationIDList:u}):this._conversationModule.request({protocolName:ug,requestData:a}).then((function(e){o.setNetworkType(t._conversationModule.getNetworkType()).end(),Gl.l("".concat(n," ok"));var i=e.data.groupResultItem[0],a=i.groupItem,c=i.resultItem;if(od(a)&&(t._convGroupMap.set(a.convGroupID,a.groupName),t._emitConvGroupListUpdate()),rd(c)){var l,d,p=!1;c.forEach((function(e){l=t._concatConversationID(e.contactItem),0===e.resultCode?(s.push(l),(d=t._getLocalConversation(l))&&-1===d.conversationGroupList.indexOf(r)&&(d.conversationGroupList.push(r),p=!0)):u.push({conversationID:l,code:e.resultCode,message:e.resultInfo})})),!0===p&&(t._emitConversationUpdate(),t._emitConvGroupListUpdate())}return GI({successConversationIDList:s,failureConversationIDList:u})})).catch((function(e){return t._conversationModule.probeNetwork().then((function(t){var n=_(t,2),r=n[0],i=n[1];o.setError(e,r,i).end()})),Gl.e("".concat(n," failed. error:"),e),BI(e)}))}},{key:"deleteConvGroup",value:function(e){var t=this;if(!this._conversationModule.canIUse(Uc.CONV_GROUP))return BI({code:p_});var n="".concat(this._n,".").concat("deleteConvGroup");Gl.l("".concat(n," groupName:").concat(e));var o=new w_("deleteConvGroup");return o.setMessage(e),this._conversationModule.request({protocolName:cg,requestData:{fromAccount:this._getMyUserID(),groupName:[e]}}).then((function(r){o.setNetworkType(t._conversationModule.getNetworkType()).end(),Gl.l("".concat(n," ok"));var i=r.data.groupItem;if(rd(i)){var a=!1;i.forEach((function(e){t._convGroupMap.has(e.convGroupID)&&(t._convGroupMap.delete(e.convGroupID),a=!0)})),!0===a&&t._emitConvGroupListUpdate()}t._eraseFromConversationGroupList([e])})).catch((function(e){return t._conversationModule.probeNetwork().then((function(t){var n=_(t,2),r=n[0],i=n[1];o.setError(e,r,i).end()})),Gl.e("".concat(n," failed. error:"),e),BI(e)}))}},{key:"renameConvGroup",value:function(e){var t=this;if(!this._conversationModule.canIUse(Uc.CONV_GROUP))return BI({code:p_});var n="".concat(this._n,".").concat("renameConvGroup");Gl.l("".concat(n," options:"),e);var o=new w_("renameConvGroup");o.setMessage(JSON.stringify(e));var r=e.oldName,i=e.newName;return this._conversationModule.request({protocolName:lg,requestData:{fromAccount:this._getMyUserID(),updateType:1,updateGroup:{updateGroupType:1,oldName:r,newName:i}}}).then((function(e){o.setNetworkType(t._conversationModule.getNetworkType()).end(),Gl.l("".concat(n," ok"));var a=e.data.updateGroupResult.convGroupID;t._convGroupMap.set(a,i),t._emitConvGroupListUpdate();var s,u,c=t._conversationModule.getLocalConversationList(),l=!1;c.forEach((function(e){s=e.conversationGroupList,-1!==(u=s.indexOf(r))&&(s.splice(u,1,i),l=!0)})),!0===l&&t._emitConversationUpdate()})).catch((function(e){return t._conversationModule.probeNetwork().then((function(t){var n=_(t,2),r=n[0],i=n[1];o.setError(e,r,i).end()})),Gl.e("".concat(n," failed. error:"),e),BI(e)}))}},{key:"addConvsToGroup",value:function(e){var t=this;if(!this._conversationModule.canIUse(Uc.CONV_GROUP))return BI({code:p_});var n="".concat(this._n,".").concat("addConvsToGroup");Gl.l("".concat(n," options:"),e);var o=new w_("addConvsToGroup");o.setMessage(JSON.stringify(e));var r=e.conversationIDList,i=e.groupName,a={fromAccount:this._getMyUserID(),updateType:1,updateGroup:{updateGroupType:2,groupName:i,updateItem:[]}},s=[],u=[];return r.forEach((function(e){return t._hasLocalConversation(e)?Ed(e)||Ad(e)?void(Ed(e)?a.updateGroup.updateItem.push({operationType:1,contactItem:{type:1,toAccount:e.replace(Ir.CONV_C2C,"")}}):Ad(e)&&a.updateGroup.updateItem.push({operationType:1,contactItem:{type:2,groupID:e.replace(Ir.CONV_GROUP,"")}})):(t._onConversationIDInvalid(u,e),!0):(t._onConversationNotFound(u,e),!0)})),u.length===r.length?qI({successConversationIDList:s,failureConversationIDList:u}):this._conversationModule.request({protocolName:dg,requestData:a}).then((function(e){o.setNetworkType(t._conversationModule.getNetworkType()).end(),Gl.l("".concat(n," ok"));var r=e.data.updateGroupResult.contactResultItem;if(rd(r)){var a,c,l=!1;r.forEach((function(e){a=t._concatConversationID(e.contactItem),0===e.resultCode?(c=t._getLocalConversation(a))&&-1===c.conversationGroupList.indexOf(i)&&(c.conversationGroupList.push(i),s.push(a),l=!0):u.push({conversationID:a,code:e.resultCode,message:e.resultInfo})})),!0===l&&(t._emitConversationUpdate(),t._emitConvInGroupUpdate(i))}return GI({successConversationIDList:s,failureConversationIDList:u})})).catch((function(e){return t._conversationModule.probeNetwork().then((function(t){var n=_(t,2),r=n[0],i=n[1];o.setError(e,r,i).end()})),Gl.e("".concat(n," failed. error:"),e),BI(e)}))}},{key:"deleteConvsFromGroup",value:function(e){var t=this;if(!this._conversationModule.canIUse(Uc.CONV_GROUP))return BI({code:p_});var n="".concat(this._n,".").concat("deleteConvsFromGroup");Gl.l("".concat(n," options:"),e);var o=new w_("deleteConvsFromGroup");o.setMessage(JSON.stringify(e));var r=e.conversationIDList,i=e.groupName,a={fromAccount:this._getMyUserID(),updateType:1,updateGroup:{updateGroupType:2,groupName:i,updateItem:[]}},s=[],u=[];return r.forEach((function(e){return t._hasLocalConversation(e)?Ed(e)||Ad(e)?void(Ed(e)?a.updateGroup.updateItem.push({operationType:2,contactItem:{type:1,toAccount:e.replace(Ir.CONV_C2C,"")}}):Ad(e)&&a.updateGroup.updateItem.push({operationType:2,contactItem:{type:2,groupID:e.replace(Ir.CONV_GROUP,"")}})):(t._onConversationIDInvalid(u,e),!0):(t._onConversationNotFound(u,e),!0)})),u.length===r.length?qI({successConversationIDList:s,failureConversationIDList:u}):this._conversationModule.request({protocolName:pg,requestData:a}).then((function(e){o.setNetworkType(t._conversationModule.getNetworkType()).end(),Gl.l("".concat(n," ok"));var r=e.data.updateGroupResult.contactResultItem;if(rd(r)){var a,c,l=!1;r.forEach((function(e){if(a=t._concatConversationID(e.contactItem),0===e.resultCode){if(c=t._getLocalConversation(a)){var n=c.conversationGroupList.indexOf(i);-1!==n&&(c.conversationGroupList.splice(n,1),s.push(a),l=!0)}}else u.push({conversationID:a,code:e.resultCode,message:e.resultInfo})})),!0===l&&(t._emitConversationUpdate(),t._emitConvInGroupUpdate(i))}return GI({successConversationIDList:s,failureConversationIDList:u})})).catch((function(e){return t._conversationModule.probeNetwork().then((function(t){var n=_(t,2),r=n[0],i=n[1];o.setError(e,r,i).end()})),Gl.e("".concat(n," failed. error:"),e),BI(e)}))}},{key:"onConvMarkUpdated",value:function(e){var t=this;if(!Yd(e)){var n,o;Gl.d("".concat(this._n,".onConvMarkUpdated markItemList:"),e);var r=!1;e.forEach((function(e){var i=e.recentContactItem,a=e.optType,s=e.standardMark,u=e.customMark;if(n=t._concatConversationID(i),o=t._getLocalConversation(n))if(1===a){var c=jd(s);!0!==function(e,t){if(e===t)return!0;if(!e||!t)return!1;if(e.length!==t.length)return!1;for(var n=0,o=e.length;n<o;n++)if(e[n]!==t[n])return!1;return!0}(o.markList,c)&&(o.markList=c,r=!0)}else 2===a&&o.customData!==u&&void 0!==u&&(o.customData=u,r=!0)})),!0===r&&this._emitConversationUpdate()}}},{key:"onConvGroupCreated",value:function(e){var t=this;Gl.d("".concat(this._n,".onConvGroupCreated resultList:"),e);var n=!1,o=!1;rd(e)&&(e.forEach((function(e){var r=e.msgGroupItem,i=r.groupID,a=r.groupName;t._convGroupMap.get(i)!==a&&(t._convGroupMap.set(i,a),o=!0);var s,u,c=e.msgRecentContactItem;rd(c)&&c.forEach((function(e){s=t._concatConversationID(e),(u=t._getLocalConversation(s))&&-1===u.conversationGroupList.indexOf(a)&&(u.conversationGroupList.push(a),n=!0)}))})),!0===n&&this._emitConversationUpdate(),!0===o&&this._emitConvGroupListUpdate())}},{key:"onConvGroupDeleted",value:function(e){var t=this;Gl.d("".concat(this._n,".onConvGroupDeleted groupItemList:"),e);var n=[];if(rd(e)){var o=!1;e.forEach((function(e){var r=e.groupID,i=e.groupName;t._convGroupMap.has(r)&&(t._convGroupMap.delete(r),o=!0,n.push(i))})),!0===o&&this._emitConvGroupListUpdate()}this._eraseFromConversationGroupList(n)}},{key:"_eraseFromConversationGroupList",value:function(e){Yd(e)||(this._conversationModule.getLocalConversationList().forEach((function(t){t.conversationGroupList=t.conversationGroupList.filter((function(t){return!e.includes(t)}))})),this._emitConversationUpdate())}},{key:"onConvGroupNameUpdated",value:function(e){Gl.d("".concat(this._n,".onConvGroupNameUpdated options:"),e);var t=e.groupID,n=e.groupName,o=e.oldGroupName;if(this._convGroupMap.get(t)!==n){this._convGroupMap.set(t,n),this._emitConvGroupListUpdate();var r,i,a=this._conversationModule.getLocalConversationList(),s=!1;a.forEach((function(e){r=e.conversationGroupList,-1!==(i=r.indexOf(o))&&(r.splice(i,1,n),s=!0)})),!0===s&&this._emitConversationUpdate()}}},{key:"onConvInGroupUpdated",value:function(e){var t=this;Gl.d("".concat(this._n,".onConvInGroupUpdated options:"),e);var n=e.oldGroupName,o=e.recentContactUpdateGroupItem;if(rd(o)){var r,i,a,s=!1;o.forEach((function(e){var o=e.contactOptType,u=e.recentContactItem;r=t._concatConversationID(u),(i=t._getLocalConversation(r))&&(a=i.conversationGroupList.indexOf(n),1===o?-1===a&&(i.conversationGroupList.push(n),s=!0):2===o&&-1!==a&&(i.conversationGroupList.splice(a,1),s=!0))})),!0===s&&(this._emitConversationUpdate(),this._emitConvInGroupUpdate(n))}}},{key:"onConvAddedToOrDeletedFromGroup",value:function(e){var t=this;Gl.d("".concat(this._n,".onConvAddedToOrDeletedFromGroup options:"),e);var n=e.msgRecentContactItem,o=e.msgRecentContactUpdateContactItem,r=this._concatConversationID(n),i=this._getLocalConversation(r);if(i&&rd(o)){var a,s=!1;o.forEach((function(e){var n=e.groupOptType,o=e.recentContactGroupItem.groupName;a=i.conversationGroupList.indexOf(o),1===n?-1===a&&(i.conversationGroupList.push(o),s=!0):2===n&&-1!==a&&(i.conversationGroupList.splice(a,1),s=!0),!0===s&&t._emitConvInGroupUpdate(o)})),!0===s&&this._emitConversationUpdate()}}},{key:"onConvGroupListSynced",value:function(e){var t=this;rd(e)&&0!==e.length&&(Gl.l("".concat(this._n,".onConvGroupListSynced groupItemList:"),e),e.forEach((function(e){t._convGroupMap.set(e.convGroupID,e.groupName)})))}},{key:"getConvGroupListByID",value:function(e){var t=this;if(!Yd(e)){var n=[];return e.forEach((function(e){t._convGroupMap.has(e)&&n.push(t._convGroupMap.get(e))})),n}}},{key:"_onConversationNotFound",value:function(e,t){e.push({conversationID:t,code:Mm,message:this._conversationModule.getErrorMessage(Mm)})}},{key:"_onConversationIDInvalid",value:function(e,t){e.push({conversationID:t,code:km,message:this._conversationModule.getErrorMessage(km)})}},{key:"_getFlagBit",value:function(e){for(var t=e.toString(2),n=t.length,o=n-1;o>=0;o--)if("1"===t[o])return n-o-1}},{key:"_concatConversationID",value:function(e){var t,n=e.type,o=e.to,r=e.groupID,i=e.userID;return 1===n?id(i)?id(o)||(t="".concat(Ir.CONV_C2C).concat(o)):t="".concat(Ir.CONV_C2C).concat(i):2===n&&(t="".concat(Ir.CONV_GROUP).concat(r)),t}},{key:"_getMyUserID",value:function(){return this._conversationModule.getMyUserID()}},{key:"_insertConversationGroup",value:function(e,t){var n=this._getLocalConversation(e);if(n){var o=n.conversationGroupList;-1===o.indexOf(t)&&o.push(t)}}},{key:"_getLocalConversation",value:function(e){return this._conversationModule.getLocalConversation(e)}},{key:"_hasLocalConversation",value:function(e){return this._conversationModule.hasLocalConversation(e)}},{key:"_emitConversationUpdate",value:function(){this._conversationModule.emitConversationUpdate(!0,!1)}},{key:"_emitConvGroupListUpdate",value:function(){this._conversationModule.emitOuterEvent(Mr.CONVERSATION_GROUP_LIST_UPDATED,y(this._convGroupMap.values()))}},{key:"_emitConvInGroupUpdate",value:function(e){var t={groupName:e,conversationList:[]},n=this._conversationModule.getLocalConversationList();t.conversationList=n.filter((function(t){return t.conversationGroupList.includes(e)})),this._conversationModule.emitOuterEvent(Mr.CONVERSATION_IN_GROUP_UPDATED,t)}},{key:"reset",value:function(){Gl.l("".concat(this._n,".reset")),this._convGroupMap.clear(),this._startIndex=0,this._pagingStatus=jp.NOT_START}}]),e}(),DC=function(e){u(o,e);var n=m(o);function o(e){var t;return r(this,o),(t=n.call(this,e))._n="ConversationModule",sC.mixin(g(t)),t._messageListHandler=new oC,t._messageRemindHandler=new IC(g(t)),t._convGroupHandler=new bC(g(t)),t.singlyLinkedList=new vC(100),t._pagingStatus=jp.NOT_START,t._pagingTimeStamp=0,t._pagingStartIndex=0,t._pagingPinnedTimeStamp=0,t._pagingPinnedStartIndex=0,t._pagingConvIDMap=new Map,t._convIDFromUnreadDBMap=new Map,t._conversationMap=new Map,t._tmpGroupList=[],t._tmpGroupAtTipsList=[],t._peerReadTimeMap=new Map,t._completedMap=new Map,t._roamingMessageKeyAndTimeMap=new Map,t._roamingMessageSequenceMap=new Map,t._remoteGroupReadSequenceMap=new Map,t._convTotalUnreadCount=0,t._initListeners(),t}return a(o,[{key:"_initListeners",value:function(){var e=this.getInnerEmitterInstance();e.on(rC,this._initLocalConversationList,this),e.on(aC,this._onProfileUpdated,this)}},{key:"onCheckTimer",value:function(e){e%60==0&&this._messageListHandler.traversal()}},{key:"_initLocalConversationList",value:function(){var e=this,t=new w_("_initLocalConversationList");Gl.l("".concat(this._n,".").concat("_initLocalConversationList"));var n="",o=this._getStorageConversationList(),r=this.isIntl();if(o){for(var i=o.length,a=0;a<i;a++){var s=o[a];if(s){if(s.conversationID==="".concat(Ir.CONV_C2C,"@TLS#ERROR")||s.conversationID==="".concat(Ir.CONV_C2C,"@TLS#NOT_FOUND"))continue;if(s.groupProfile){var u=s.groupProfile.type;if(Sd(u))continue}}this._conversationMap.set(o[a].conversationID,new MC(o[a],r))}this.emitConversationUpdate(!0,!1),n="count:".concat(i)}else n="count:0";t.setNetworkType(this.getNetworkType()).setMessage(n).end(),this.getModule(Hf)||this.triggerReady(),this.ready((function(){e._tmpGroupList.length>0&&(e.updateConversationGroupProfile(e._tmpGroupList),e._tmpGroupList.length=0)})),this.syncConversationList()}},{key:"onMessageSent",value:function(e){this._onSendOrReceiveMessage({conversationOptionsList:e.conversationOptionsList,isInstantMessage:!0})}},{key:"onNewMessage",value:function(e){this._onSendOrReceiveMessage(e)}},{key:"_onSendOrReceiveMessage",value:function(e){var t=this,n=e.conversationOptionsList,o=e.isInstantMessage,r=void 0===o||o,i=e.isUnreadC2CMessage,a=void 0!==i&&i,s=e.updateUnreadCount,u=void 0===s||s;this._isReady?0!==n.length&&(this._getC2CPeerReadTime(n),this._updateLocalConversationList({conversationOptionsList:n,isInstantMessage:r,isUnreadC2CMessage:a,isFromGetConversations:!1,updateUnreadCount:u}),r||(this._convIDFromUnreadDBMap=new Map([].concat(y(this._convIDFromUnreadDBMap),y(n.map((function(e){return[e.conversationID,1]}))))),this.deleteEmptyConvFromUndread()),this._setStorageConversationList(),n.filter((function(e){return e.type===Ir.CONV_TOPIC})).length>0||this.emitConversationUpdate()):this.ready((function(){t._onSendOrReceiveMessage(e)}))}},{key:"updateConversationGroupProfile",value:function(e){var t=this;if(!rd(e)||0!==e.length)if(0!==this._conversationMap.size){var n=!1;e.forEach((function(e){var o="GROUP".concat(e.groupID);if(t._conversationMap.has(o)){n=!0;var r=t._conversationMap.get(o);r.groupProfile=JSON.parse(JSON.stringify(e)),r.lastMessage.lastSequence<e.nextMessageSeq&&(r.lastMessage.lastSequence=e.nextMessageSeq-1),r.subType||(r.subType=e.type)}})),n&&this.emitConversationUpdate(!0,!1)}else this._tmpGroupList=e}},{key:"_updateConversationUserProfile",value:function(e){var t=this;e.data.forEach((function(e){var n="C2C".concat(e.userID);t._conversationMap.has(n)&&(t._conversationMap.get(n).userProfile=e)})),this.emitConversationUpdate(!0,!1)}},{key:"onMessageRevoked",value:function(e){var t=this;if(0!==e.length){var n=null,o=!1,r=[];e.forEach((function(e){(n=t._conversationMap.get(e.conversationID))&&(n.type===Ir.CONV_TOPIC?r.push(e):(n.reduceUnreadCount()&&(o=!0),n.isLastMessageRevoked({sequence:e.sequence,time:e.time})&&(n.setLastMessageRevoked(!0),n.setLastMessageRevoker(e.revoker),o=!0)))})),this.getModule(Zf).onMessageRevoked(r),o&&(this.emitConversationUpdate(!0,!1),this.emitTotalUnreadMessageCountUpdate())}}},{key:"isLastMessageRevoked",value:function(e){var t=!1,n=e.conversationID,o=e.sequence,r=e.time,i=this._conversationMap.get(n);return i&&(t=i.type===Ir.CONV_TOPIC?this.getModule(Zf).isLastMessageRevoked({topicID:n.replace(Ir.CONV_GROUP,""),sequence:o}):i.isLastMessageRevoked({sequence:o,time:r})),Gl.l("".concat(this._n,".isLastMessageRevoked options:").concat(JSON.stringify(e)," ret:").concat(t)),t}},{key:"onMessageDeleted",value:function(e){var t=this;if(0!==e.length){var n=null;e.forEach((function(e){(n=t._messageListHandler.getLocalMessage(e.conversationID,e.ID))&&(n.isDeleted=!0),e!==n&&(e.isDeleted=!0)}));for(var o=e[0].conversationID,r=this._messageListHandler.getLocalMessageList(o),i={},a=r.length-1;a>=0;a--)if(!r[a].isDeleted){i=r[a];break}var s=this._conversationMap.get(o);if(s){var u=!1;s.lastMessage.lastSequence===i.sequence&&s.lastMessage.lastTime===i.time||(Yd(i)&&(i=void 0),s.updateLastMessage(i),s.type!==Ir.CONV_TOPIC&&(u=!0),Gl.l("".concat(this._n,".onMessageDeleted. update conversationID:").concat(o," with lastMessage:"),s.lastMessage)),o.startsWith(Ir.CONV_C2C)&&this.updateUnreadCount(o),u&&this.emitConversationUpdate(!0,!1)}}}},{key:"onMessageModified",value:function(e){var t=e.conversationType,n=e.from,o=e.to,r=e.time,i=e.sequence,a=e.elements,s=e.cloudCustomData,u=e.messageVersion,c=this.getMyUserID(),l="".concat(t).concat(o);o===c&&t===Ir.CONV_C2C&&(l="".concat(t).concat(n));var d=this._messageListHandler.onMessageModified(l,e),p=d.isUpdated,f=d.message;!0===p&&this.emitOuterEvent(Mr.MESSAGE_MODIFIED,[f]);var h=this._isTopicConversation(l);if(Gl.l("".concat(this._n,".onMessageModified isUpdated:").concat(p," isTopicMessage:").concat(h," from:").concat(n," to:").concat(o)),h)this.getModule(Zf).onMessageModified(e);else{var g=this._conversationMap.get(l);if(g){var v=g.lastMessage;Gl.d("".concat(this._n.onMessageModified," lastMessage:"),JSON.stringify(v),"options:",JSON.stringify(e)),v&&v.lastTime===r&&v.lastSequence===i&&v.version!==u&&(v.type=a[0].type,v.payload=a[0].content,v.messageForShow=Hd(v.type,v.payload,this.isIntl()),v.cloudCustomData=s,v.version=u,this.emitConversationUpdate(!0,!1))}}return f}},{key:"onNewGroupAtTips",value:function(e){var n=this,o=e.dataList,r=null;o.forEach((function(e){e.groupAtTips?r=e.groupAtTips:e.elements?r=t(t({},e.elements),{},{sync:!0}):e.groupAtType&&(r=t(t({},e),{},{sync:!0})),r.__random=e.random,r.__sequence=e.clientSequence,n._tmpGroupAtTipsList.push(r)})),Gl.d("".concat(this._n,".onNewGroupAtTips isReady:").concat(this._isReady),this._tmpGroupAtTipsList),this._isReady&&this._handleGroupAtTipsList()}},{key:"_handleGroupAtTipsList",value:function(){var e=this;if(0!==this._tmpGroupAtTipsList.length){var t=!1;this._tmpGroupAtTipsList.forEach((function(n){var o=n.groupID,r=n.from,i=n.topicID,a=void 0===i?void 0:i,s=n.sync,u=void 0!==s&&s;if(r!==e.getMyUserID())if(id(a)){var c=e._conversationMap.get("".concat(Ir.CONV_GROUP).concat(o));c&&(c.updateGroupAtInfoList(n),t=!0)}else{var l=e._conversationMap.get("".concat(Ir.CONV_GROUP).concat(a));if(l){l.updateGroupAtInfoList(n);var d=e.getModule(Zf),p=l.groupAtInfoList;d.onConversationProxy({topicID:a,groupAtInfoList:p})}Yd(l)&&u&&(e.updateTopicConversation([{conversationID:"".concat(Ir.CONV_GROUP).concat(a),type:Ir.CONV_TOPIC}]),e._conversationMap.get("".concat(Ir.CONV_GROUP).concat(a)).updateGroupAtInfoList(n))}})),t&&this.emitConversationUpdate(!0,!1),this._tmpGroupAtTipsList.length=0}}},{key:"_getC2CPeerReadTime",value:function(e){var t=this,n=[];if(e.forEach((function(e){t._conversationMap.has(e.conversationID)||e.type!==Ir.CONV_C2C||n.push(e.conversationID.replace(Ir.CONV_C2C,""))})),n.length>0){Gl.d("".concat(this._n,"._getC2CPeerReadTime userIDList:").concat(n));var o=this.getModule(Hf);o&&o.getRemotePeerReadTime(n)}}},{key:"_getStorageConversationList",value:function(){return this.getModule(Jf).getItem("conversationMap")}},{key:"_setStorageConversationList",value:function(){var e=this.getLocalConversationList().filter((function(e){return e.type===Ir.CONV_C2C||e.type===Ir.CONV_GROUP&&e.lastMessage.type!==Ir.MSG_GRP_TIP})).slice(0,20).map((function(e){return{conversationID:e.conversationID,type:e.type,subType:e.subType,lastMessage:e.lastMessage,groupProfile:e.groupProfile,userProfile:e.userProfile}}));this.getModule(Jf).setItem("conversationMap",e)}},{key:"emitConversationUpdate",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this.getLocalConversationList();if(t){var o=this.getModule(Kf);o&&o.updateGroupLastMessage(n)}e&&this.emitOuterEvent(Mr.CONVERSATION_LIST_UPDATED)}},{key:"getLocalConversationList",value:function(){return y(this._conversationMap.values()).filter((function(e){return e.type!==Ir.CONV_TOPIC}))}},{key:"getLocalConversation",value:function(e){return this._conversationMap.get(e)}},{key:"hasLocalConversation",value:function(e){return this._conversationMap.has(e)}},{key:"getLocalOldestMessage",value:function(e){return this._messageListHandler.getLocalOldestMessage(e)}},{key:"syncConversationList",value:function(){var e=this,t=new w_("syncConversationList");return this._pagingStatus===jp.NOT_START&&this._conversationMap.clear(),this._pagingGetConversationList().then((function(n){return e._pagingStatus=jp.RESOLVED,e.deleteEmptyConvFromUndread(),e.emitConversationUpdate(!0,!1),e._setStorageConversationList(),e._handleC2CPeerReadTime(),e._patchConversationProperties(),t.setMessage(e._conversationMap.size).setNetworkType(e.getNetworkType()).end(),n})).catch((function(n){return e._pagingStatus=jp.REJECTED,t.setMessage(e._pagingTimeStamp),e.probeNetwork().then((function(e){var o=_(e,2),r=o[0],i=o[1];t.setError(n,r,i).end()})),BI(n)}))}},{key:"deleteEmptyConvFromUndread",value:function(){var e=this;this._isSyncCompleted()&&this._conversationMap.forEach((function(t,n){!e._pagingConvIDMap.has(n)&&e._convIDFromUnreadDBMap.has(n)&&e._conversationMap.delete(n)}))}},{key:"_patchConversationProperties",value:function(){var e=this,t=Date.now(),n=this.checkAndPatchRemark(),o=this._messageRemindHandler.getC2CMessageRemindType(),r=this.getModule(Kf).getGroupList();Promise.all([n,o,r]).then((function(){var n=Date.now()-t;Gl.l("".concat(e._n,"._patchConversationProperties ok. cost ").concat(n," ms")),e.emitConversationUpdate(!0,!1),e.emitTotalUnreadMessageCountUpdate()}))}},{key:"_pagingGetConversationList",value:function(){var e=this,t="".concat(this._n,"._pagingGetConversationList");return Gl.l("".concat(t," timeStamp:").concat(this._pagingTimeStamp," startIndex:").concat(this._pagingStartIndex)+" pinnedTimeStamp:".concat(this._pagingPinnedTimeStamp," pinnedStartIndex:").concat(this._pagingPinnedStartIndex)),this._pagingStatus=jp.PENDING,this.request({protocolName:eg,requestData:{fromAccount:this.getMyUserID(),timeStamp:this._pagingTimeStamp,startIndex:this._pagingStartIndex,pinnedTimeStamp:this._pagingPinnedTimeStamp,pinnedStartIndex:this._pagingPinnedStartIndex,orderType:1}}).then((function(n){var o=n.data,r=o.completeFlag,i=o.conversations,a=void 0===i?[]:i,s=o.timeStamp,u=o.startIndex,c=o.pinnedTimeStamp,l=o.pinnedStartIndex,d=o.groupItem;if(Gl.l("".concat(t," ok. completeFlag:").concat(r," count:").concat(a.length," isReady:").concat(e._isReady)),e._convGroupHandler.onConvGroupListSynced(d),a.length>0){var p=e._getConversationOptions(a);e._pagingConvIDMap=new Map([].concat(y(e._pagingConvIDMap),y(p.map((function(e){return[e.conversationID,1]}))))),e._updateLocalConversationList({conversationOptionsList:p,isFromGetConversations:!0}),e.isLoggedIn()&&e.emitConversationUpdate()}if(!e._isReady){if(!e.isLoggedIn())return qI();e.triggerReady()}return e._pagingTimeStamp=s,e._pagingStartIndex=u,e._pagingPinnedTimeStamp=c,e._pagingPinnedStartIndex=l,1!==r?e._pagingGetConversationList():(e._handleGroupAtTipsList(),e._convGroupHandler.getRemoteConvGroupList(),qI())})).catch((function(n){throw e.isLoggedIn()&&(e._isReady||(Gl.w("".concat(t," failed. error:"),n),e.triggerReady())),n}))}},{key:"_updateLocalConversationList",value:function(e){var t,n=e.isFromGetConversations,o=e.isInstantMessage,r=Date.now();t=this._getTmpConversationListMapping(e),this._conversationMap=new Map(this._sortConversationList([].concat(y(t.toBeUpdatedConversationList),y(this._conversationMap)))),n||(this._updateUserOrGroupProfile(t.newConversationList),o&&this.emitTotalUnreadMessageCountUpdate()),Gl.d("".concat(this._n,"._updateLocalConversationList cost ").concat(Date.now()-r," ms"))}},{key:"_getTmpConversationListMapping",value:function(e){for(var t=e.conversationOptionsList,n=e.isFromGetConversations,o=e.isInstantMessage,r=e.isUnreadC2CMessage,i=void 0!==r&&r,a=e.updateUnreadCount,s=[],u=[],c=this.getModule(Kf),l=this.getModule(jf),d=this.isIntl(),p=0,f=t.length;p<f;p++){var h=new MC(t[p],d),g=h.conversationID;if(g!=="".concat(Ir.CONV_C2C,"@TLS#ERROR")&&g!=="".concat(Ir.CONV_C2C,"@TLS#NOT_FOUND"))if(this._conversationMap.has(g)){var v=this._conversationMap.get(g),m=["unreadCount","allowType","adminForbidType","payload","isPinned"];!1===o&&m.push("lastMessage");var _=t[p].lastMessage,y=!id(_);y||t[p].type===Ir.CONV_TOPIC||this._onLastMessageNotExist(t[p]),id(o)&&y&&null===v.lastMessage.payload&&(v.lastMessage.payload=_.payload),Yd(v.lastMessage.revoker)||(v.lastMessage.revoker=null),fd(v,h,m,[null,void 0,"",0,NaN]),!0===a&&v.updateUnreadCount({nextUnreadCount:h.unreadCount,isFromGetConversations:n,isUnreadC2CMessage:i}),o&&y&&(_.payload&&(v.lastMessage.payload=_.payload),v.type===Ir.CONV_GROUP&&(v.lastMessage.nameCard=_.nameCard,v.lastMessage.nick=_.nick)),y&&v.lastMessage.cloudCustomData!==_.cloudCustomData&&(v.lastMessage.cloudCustomData=_.cloudCustomData||""),this._conversationMap.delete(g),s.push([g,v])}else{if(h.type===Ir.CONV_GROUP&&c){var M=h.groupProfile.groupID,I=c.getLocalGroupProfile(M);I&&(h.groupProfile=I,!0===a&&h.updateUnreadCount({nextUnreadCount:0}))}else if(h.type===Ir.CONV_C2C){var C=g.replace(Ir.CONV_C2C,"");l&&l.isMyFriend(C)&&(h.remark=l.getFriendRemark(C))}u.push(h),s.push([g,h])}}var k=this.getModule(Zf);return s.forEach((function(e){if(e[1].type===Ir.CONV_TOPIC){var t=e[1],n=t.conversationID,o=t.unreadCount,r=t.groupAtInfoList;k.onConversationProxy({topicID:n.replace(Ir.CONV_GROUP,""),unreadCount:o,groupAtInfoList:Yd(r)?void 0:r})}})),{toBeUpdatedConversationList:s,newConversationList:u}}},{key:"_onLastMessageNotExist",value:function(e){new w_("lastMessageNotExist").setMessage("".concat(JSON.stringify(e))).setNetworkType(this.getNetworkType()).end()}},{key:"_sortConversationList",value:function(e){var t=[],n=[],o=[],r=[];return e.forEach((function(e){!0===e[1].isPinned?Yd(e[1].lastMessage.lastTime)?n.push(e):t.push(e):Yd(e[1].lastMessage.lastTime)?r.push(e):o.push(e)})),t.sort((function(e,t){return t[1].lastMessage.lastTime-e[1].lastMessage.lastTime})).concat(n).concat(o.sort((function(e,t){return t[1].lastMessage.lastTime-e[1].lastMessage.lastTime}))).concat(r)}},{key:"_sortConversationListAndEmitEvent",value:function(){this._conversationMap=new Map(this._sortConversationList(y(this._conversationMap))),this.emitConversationUpdate(!0,!1)}},{key:"_updateUserOrGroupProfile",value:function(e){var t=this;if(0!==e.length){var n=[],o=[],r=this.getModule(Vf),i=this.getModule(Kf);e.forEach((function(e){if(e.type===Ir.CONV_C2C)n.push(e.toAccount);else if(e.type===Ir.CONV_GROUP){var t=e.toAccount;i.hasLocalGroup(t)?e.groupProfile=i.getLocalGroupProfile(t):o.push(t)}})),Gl.l("".concat(this._n,"._updateUserOrGroupProfile c2cUserIDList:").concat(n," groupIDList:").concat(o)),n.length>0&&r.getUserProfile({userIDList:n}).then((function(e){var n=e.data;rd(n)?n.forEach((function(e){t._conversationMap.get("C2C".concat(e.userID)).userProfile=e})):t._conversationMap.get("C2C".concat(n.userID)).userProfile=n})),o.length>0&&i.getGroupProfileAdvance({groupIDList:o,responseFilter:{groupBaseInfoFilter:["Type","Name","FaceUrl"]}}).then((function(e){e.data.successGroupList.forEach((function(e){var n="GROUP".concat(e.groupID);if(t._conversationMap.has(n)){var o=t._conversationMap.get(n);fd(o.groupProfile,e,[],[null,void 0,"",0,NaN]),!o.subType&&e.type&&(o.subType=e.type)}}))}))}}},{key:"_getConversationOptions",value:function(e){var n=this,o=[],r=e.filter((function(e){var t=e.type,n=e.userID;return 1===t&&"@TLS#NOT_FOUND"!==n&&"@TLS#ERROR"!==n||2===t})),i=this.getMyUserID(),a=r.map((function(e){if(id(e.lastMsg)&&(e.lastMsg={elements:[]}),1===e.type){var r={userID:e.userID,nick:e.peerNick,avatar:e.peerAvatar};return o.push(r),{conversationID:"C2C".concat(e.userID),type:"C2C",lastMessage:{lastTime:e.time,lastSequence:e.sequence,fromAccount:e.lastC2CMsgFromAccount,messageForShow:e.messageShow,type:e.lastMsg.elements[0]?e.lastMsg.elements[0].type:null,payload:e.lastMsg.elements[0]?n._amendLayersOverLimitProperty(e.lastMsg.elements[0].content):null,cloudCustomData:e.lastMsg.cloudCustomData||"",isRevoked:8===e.lastMessageFlag,onlineOnlyFlag:!1,nick:"",nameCard:"",version:0,isPeerRead:e.lastC2CMsgFromAccount===i&&e.time<=e.c2cPeerReadTime,revoker:e.lastMsg.revokerInfo?e.lastMsg.revokerInfo.revoker:null},userProfile:new hC(r),peerReadTime:e.c2cPeerReadTime,isPinned:1===e.isPinned,messageRemindType:"",customData:e.customMark||"",markList:jd(e.standardMark),conversationGroupList:n._convGroupHandler.getConvGroupListByID(e.contactGroupId)}}return{conversationID:"GROUP".concat(e.groupID),type:"GROUP",lastMessage:t(t({lastTime:e.time,lastSequence:e.messageReadSeq+e.unreadCount,fromAccount:e.msgGroupFromAccount,messageForShow:e.messageShow},n._patchTypeAndPayload(e)),{},{cloudCustomData:e.lastMsg.cloudCustomData||"",isRevoked:2===e.lastMessageFlag,onlineOnlyFlag:!1,nick:e.senderNick||"",nameCard:e.senderNameCard||"",revoker:e.lastMsg.revokerInfo?e.lastMsg.revokerInfo.revoker:null}),groupProfile:new _C({groupID:e.groupID,name:e.groupNick,avatar:e.groupImage}),unreadCount:e.unreadCount,peerReadTime:0,isPinned:1===e.isPinned,messageRemindType:"",version:0,customData:e.customMark||"",markList:jd(e.standardMark),conversationGroupList:n._convGroupHandler.getConvGroupListByID(e.contactGroupId)}}));return o.length>0&&this.getModule(Vf).onConversationsProfileUpdated(o),a}},{key:"_patchTypeAndPayload",value:function(e){var n=e.lastMsg,o=n.event,r=void 0===o?void 0:o,i=n.elements,a=void 0===i?[]:i,s=n.groupTips,u=void 0===s?{}:s;if(!id(r)&&!Yd(u)){var c=new PI(u);c.setElement({type:Ir.MSG_GRP_TIP,content:t(t({},u.elements),{},{groupProfile:u.groupProfile})});var l=JSON.parse(JSON.stringify(c.payload));return c=null,{type:Ir.MSG_GRP_TIP,payload:l}}return{type:a[0]?a[0].type:null,payload:a[0]?this._amendLayersOverLimitProperty(a[0].content):null}}},{key:"_amendLayersOverLimitProperty",value:function(e){var t=e.layersOverLimit;return 0===t?e.layersOverLimit=!1:1===t&&(e.layersOverLimit=!0),e}},{key:"getLocalMessageList",value:function(e){return this._messageListHandler.getLocalMessageList(e)}},{key:"deleteLocalMessage",value:function(e){e instanceof PI&&this._messageListHandler.remove(e)}},{key:"onConversationDeleted",value:function(e){var t=this;Gl.l("".concat(this._n,".onConversationDeleted")),rd(e)&&e.forEach((function(e){var n=e.type,o=e.userID,r=e.groupID,i="";1===n?i="".concat(Ir.CONV_C2C).concat(o):2===n&&(i="".concat(Ir.CONV_GROUP).concat(r)),t.deleteLocalConversation(i)}))}},{key:"onConversationPinned",value:function(e){var t=this;if(rd(e)){var n=!1;e.forEach((function(e){var o,r=e.type,i=e.userID,a=e.groupID;1===r?o=t.getLocalConversation("".concat(Ir.CONV_C2C).concat(i)):2===r&&(o=t.getLocalConversation("".concat(Ir.CONV_GROUP).concat(a))),o&&(Gl.l("".concat(t._n,".onConversationPinned conversationID:").concat(o.conversationID," isPinned:").concat(o.isPinned)),o.isPinned||(o.isPinned=!0,n=!0))})),n&&this._sortConversationListAndEmitEvent()}}},{key:"onConversationUnpinned",value:function(e){var t=this;if(rd(e)){var n=!1;e.forEach((function(e){var o,r=e.type,i=e.userID,a=e.groupID;1===r?o=t.getLocalConversation("".concat(Ir.CONV_C2C).concat(i)):2===r&&(o=t.getLocalConversation("".concat(Ir.CONV_GROUP).concat(a))),o&&(Gl.l("".concat(t._n,".onConversationUnpinned conversationID:").concat(o.conversationID," isPinned:").concat(o.isPinned)),o.isPinned&&(o.isPinned=!1,n=!0))})),n&&this._sortConversationListAndEmitEvent()}}},{key:"getMessageList",value:function(e){var t=this,n=e.conversationID,o=e.nextReqMessageID,r=e.count,i="".concat(this._n,".getMessageList"),a=this.getLocalConversation(n),s="";if(a&&a.groupProfile&&(s=a.groupProfile.type),Sd(s))return Gl.l("".concat(i," not available in avchatroom. conversationID:").concat(n)),qI({messageList:[],nextReqMessageID:"",isCompleted:!0});(id(r)||r>15)&&(r=15),!o&&this._isNotInCommunity(n)&&(this._messageListHandler.removeByConversationID(n),this._completedMap.delete(n),this._roamingMessageSequenceMap.delete(n));var u=this._computeRemainingCount({conversationID:n,nextReqMessageID:o}),c=this._completedMap.has(n);if(Gl.l("".concat(i," conversationID:").concat(n," nextReqMessageID:").concat(o)+" remainingCount:".concat(u," count:").concat(r," isCompleted:").concat(c)),this._needGetHistory({conversationID:n,remainingCount:u,count:r}))return this.getHistoryMessages({conversationID:n,nextReqMessageID:o,count:20}).then((function(e){var o=e.nextReqID,r=e.storedMessageList,a=t._completedMap.has(n),s=r;u>0&&(s=t._messageListHandler.getLocalMessageList(n).slice(0,r.length+u));var c={nextReqMessageID:a?"":o,messageList:s,isCompleted:a};return Gl.l("".concat(i," ret.nextReqMessageID:").concat(c.nextReqMessageID," ret.isCompleted:").concat(c.isCompleted," ret.length:").concat(s.length)),GI(c)}));this.modifyMessageList(n);var l=this._getMessageListFromMemory({conversationID:n,nextReqMessageID:o,count:r});return qI(l)}},{key:"_getMessageListFromMemory",value:function(e){var t=e.conversationID,n=e.nextReqMessageID,o=e.count,r="".concat(this._n,"._getMessageListFromMemory"),i=this._messageListHandler.getLocalMessageList(t),a=i.length,s=0,u={isCompleted:!1,nextReqMessageID:"",messageList:[]};return n?(s=i.findIndex((function(e){return e.ID===n})))>o?(u.messageList=i.slice(s-o,s),u.nextReqMessageID=i[s-o].ID):(u.messageList=i.slice(0,s),u.isCompleted=!0):a>o?(s=a-o,u.messageList=i.slice(s,a),u.nextReqMessageID=i[s].ID):(u.messageList=i.slice(0,a),u.isCompleted=!0),Gl.l("".concat(r," conversationID:").concat(t)+" ret.nextReqMessageID:".concat(u.nextReqMessageID," ret.isCompleted:").concat(u.isCompleted," ret.length:").concat(u.messageList.length)),u}},{key:"getMessageListHopping",value:function(e){var t=e.conversationID,n=e.sequence,o=e.time,r=e.count,i=e.direction,a=void 0===i?0:i;if((id(r)||r>15)&&(r=15),t.startsWith(Ir.CONV_C2C)){var s=this.getModule(Hf),u=t.replace(Ir.CONV_C2C,"");return s.getRoamingMessagesHopping({peerAccount:u,time:o,count:r,direction:a})}if(t.startsWith(Ir.CONV_GROUP)){var c=this.getModule(Kf),l=t.replace(Ir.CONV_GROUP,"");return c.getRoamingMessagesHopping({groupID:l,sequence:n,count:r,direction:a})}}},{key:"_computeRemainingCount",value:function(e){var t=e.conversationID,n=e.nextReqMessageID,o=this._messageListHandler.getLocalMessageList(t),r=o.length;if(!n)return r;var i=0;return Ed(t)?i=o.findIndex((function(e){return e.ID===n})):Ad(t)&&(i=-1!==n.indexOf("-")?o.findIndex((function(e){return e.ID===n})):o.findIndex((function(e){return e.sequence===n}))),-1===i&&(i=0),i}},{key:"_getMessageListSize",value:function(e){return this._messageListHandler.getLocalMessageList(e).length}},{key:"_needGetHistory",value:function(e){var t=e.conversationID,n=e.remainingCount,o=e.count,r=this.getLocalConversation(t),i="";return r&&r.groupProfile&&(i=r.groupProfile.type),!Ld(t)&&!Sd(i)&&!(Ad(t)&&this._isPagingGetGroupListCompleted()&&this._getLocalGroupCount()<=4e3&&!this._hasLocalGroup(t)&&!this._isTopicConversation(t))&&n<=o&&!this._completedMap.has(t)}},{key:"_isTopicConversation",value:function(e){var t=e.replace(Ir.CONV_GROUP,"");return Dd(t)}},{key:"getHistoryMessages",value:function(e){var t=e.conversationID,n=e.count;if(t===Ir.CONV_SYSTEM)return qI();var o=15;n>20&&(o=20);var r=null;if(Ed(t)){var i=this._roamingMessageKeyAndTimeMap.has(t);return(r=this.getModule(Hf))?r.getRoamingMessage({conversationID:t,peerAccount:t.replace(Ir.CONV_C2C,""),count:o,lastMessageTime:i?this._roamingMessageKeyAndTimeMap.get(t).lastMessageTime:0,messageKey:i?this._roamingMessageKeyAndTimeMap.get(t).messageKey:""}):BI({code:n_})}if(Ad(t)){if(!(r=this.getModule(Kf)))return BI({code:n_});var a=null;this._conversationMap.has(t)&&(a=this._conversationMap.get(t).lastMessage);var s=0;a&&(s=a.lastSequence);var u=this._roamingMessageSequenceMap.get(t);return r.getRoamingMessage({conversationID:t,groupID:t.replace(Ir.CONV_GROUP,""),count:o,sequence:u||s})}return qI()}},{key:"patchConversationLastMessage",value:function(e){var t=this.getLocalConversation(e);if(t){var n=t.lastMessage,o=n.messageForShow,r=n.payload;if(Yd(o)||Yd(r)){var i=this._messageListHandler.getLocalMessageList(e);if(0===i.length)return;var a=i[i.length-1];Gl.l("".concat(this._n,".patchConversationLastMessage conversationID:").concat(e," payload:"),a.payload),t.updateLastMessage(a)}}}},{key:"onRoamingMessage",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1?arguments[1]:void 0,o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=n.startsWith(Ir.CONV_C2C)?Ir.CONV_C2C:Ir.CONV_GROUP,i=null,a=[],s=[],u=0,c=e.length,l=null,d=r===Ir.CONV_GROUP,p=this.getModule(Qf),f=function(){u=d?e.length-1:0,c=d?0:e.length},h=function(){d?--u:++u},g=function(){return d?u>=c:u<c};for(f();g();h())if(d&&1===e[u].sequence&&o&&this.setCompleted(n),1!==e[u].isPlaceMessage)if((i=new PI(e[u])).to=e[u].to,r!==Ir.CONV_GROUP||id(e[u].topicID)||(i.to=e[u].topicID),i.isSystemMessage=!!e[u].isSystemMessage,i.conversationType=r,4===e[u].event?l={type:Ir.MSG_GRP_TIP,content:t(t({},e[u].elements),{},{groupProfile:e[u].groupProfile})}:(e[u].elements=p.parseElements(e[u].elements,e[u].from),l=e[u].elements),d||i.setNickAndAvatar({nick:e[u].nick,avatar:e[u].avatar}),Yd(l)){var v=new w_("emptyMessageBody");v.setMessage("from:".concat(i.from," to:").concat(i.to," sequence:").concat(i.sequence," event:").concat(e[u].event)),v.setNetworkType(this.getNetworkType()).setLevel("warning").end()}else i.setElement(l),i.reInitialize(this.getMyUserID()),a.push(i);return f=h=g=null,o?(this._messageListHandler.unshift(a,s),a=null,s):(s=null,a)}},{key:"findMessage",value:function(e){return this._messageListHandler.findMessage(e)}},{key:"_isNotInCommunity",value:function(e){var t=!1;if(e.startsWith(Ir.CONV_GROUP)&&this._isTopicConversation(e)){var n=Vd(e.replace(Ir.CONV_GROUP,""));this.getModule(Kf).hasLocalGroup(n)||(t=!0)}return t}},{key:"deleteTopicRoamingMessageInfo",value:function(e){var t=this;bd({groupID:e})&&this._messageListHandler.getTopicConversationIDList(e).forEach((function(e){t._messageListHandler.removeByConversationID(e),t._completedMap.delete(e),t._roamingMessageSequenceMap.delete(e)}))}},{key:"deleteGroupRomaingMessageInfo",value:function(e){var t="".concat(Ir.CONV_GROUP).concat(e);this._messageListHandler.removeByConversationID(t),this._completedMap.delete(t),this._roamingMessageSequenceMap.delete(t)}},{key:"setMessageRead",value:function(e){var t=e.conversationID,n=this.getLocalConversation(t);if(Gl.l("".concat(this._n,".setMessageRead conversationID:").concat(t," unreadCount:").concat(n?n.unreadCount:0)),!n)return qI();if(n.type!==Ir.CONV_GROUP&&n.type!==Ir.CONV_TOPIC||Yd(n.groupAtInfoList)||this.deleteGroupAtTips(t),0===n.unreadCount)return qI();if(n.type===Ir.CONV_GROUP&&!this._hasLocalGroup(t))return 0!==n.unreadCount&&(n.unreadCount=0,this.emitConversationUpdate(!0,!1)),qI();var o=this._messageListHandler.getLocalLastMessage(t),r=n.lastMessage.lastTime;o&&r<o.time&&(r=o.time);var i=n.lastMessage.lastSequence;if(o&&i<o.sequence&&(i=o.sequence),n.type===Ir.CONV_TOPIC&&id(o)){var a=this.getModule(Zf),s=t.replace(Ir.CONV_GROUP,""),u=Vd(s),c=a.getLocalTopic(u,s);c&&(i=c.nextMessageSeq-1)}var l=null;switch(n.type){case Ir.CONV_C2C:return(l=this.getModule(Hf))?l.setMessageRead({conversationID:t,lastMessageTime:r}):BI({code:n_});case Ir.CONV_GROUP:case Ir.CONV_TOPIC:return(l=this.getModule(Kf))?l.setMessageRead({conversationID:t,lastMessageSeq:i}):BI({code:n_});case Ir.CONV_SYSTEM:return n.unreadCount=0,this.emitConversationUpdate(!0,!1),qI();default:return qI()}}},{key:"setAllMessageRead",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n="setAllMessageRead",o="".concat(this._n,".").concat(n);t.scope||(t.scope=Ir.READ_ALL_MSG),Gl.l("".concat(o," options:"),t);var r=this._createSetAllMessageReadPack(t);if(0===r.readAllC2CMessage&&0===r.groupMessageReadInfoList.length)return qI();var i=new w_(n);return this.request({protocolName:Eg,requestData:r}).then((function(n){var o=n.data,r=e._handleAllMessageRead(o);return i.setMessage("scope:".concat(t.scope," failureGroups:").concat(JSON.stringify(r))).setNetworkType(e.getNetworkType()).end(),qI()})).catch((function(t){return e.probeNetwork().then((function(e){var n=_(e,2),o=n[0],r=n[1];i.setError(t,o,r).end()})),Gl.w("".concat(o," failed. error:"),t),BI({code:t&&t.code?t.code:Xv,message:t&&t.message?t.message:void 0})}))}},{key:"setConversationCustomData",value:function(e){return this._convGroupHandler.setConvCustomData(e)}},{key:"markConversation",value:function(e){return this._convGroupHandler.markConversation(e)}},{key:"getConversationGroupList",value:function(){return this._convGroupHandler.getLocalConvGroupList()}},{key:"createConversationGroup",value:function(e){return this._convGroupHandler.createConvGroup(e)}},{key:"deleteConversationGroup",value:function(e){return this._convGroupHandler.deleteConvGroup(e)}},{key:"renameConversationGroup",value:function(e){return this._convGroupHandler.renameConvGroup(e)}},{key:"addConversationsToGroup",value:function(e){return this._convGroupHandler.addConvsToGroup(e)}},{key:"deleteConversationsFromGroup",value:function(e){return this._convGroupHandler.deleteConvsFromGroup(e)}},{key:"onConversationMarkUpdated",value:function(e){this._convGroupHandler.onConvMarkUpdated(e)}},{key:"onConversationGroupCreated",value:function(e){this._convGroupHandler.onConvGroupCreated(e)}},{key:"onConversationGroupDeleted",value:function(e){this._convGroupHandler.onConvGroupDeleted(e)}},{key:"onConversationGroupNameUpdated",value:function(e){this._convGroupHandler.onConvGroupNameUpdated(e)}},{key:"onConversationInGroupUpdated",value:function(e){this._convGroupHandler.onConvInGroupUpdated(e)}},{key:"onConversationAddedToOrDeletedFromGroup",value:function(e){this._convGroupHandler.onConvAddedToOrDeletedFromGroup(e)}},{key:"_getConversationLastMessageSequence",value:function(e){var t=this._messageListHandler.getLocalLastMessage(e.conversationID),n=e.lastMessage.lastSequence;return t&&n<t.sequence&&(n=t.sequence),n}},{key:"_getConversationLastMessageTime",value:function(e){var t=this._messageListHandler.getLocalLastMessage(e.conversationID),n=e.lastMessage.lastTime;return t&&n<t.time&&(n=t.time),n}},{key:"_createSetAllMessageReadPack",value:function(e){var t,n={readAllC2CMessage:0,groupMessageReadInfoList:[]},o=e.scope,r=S(this._conversationMap);try{for(r.s();!(t=r.n()).done;){var i=_(t.value,2)[1];if(i.unreadCount>0)if(i.type===Ir.CONV_C2C&&0===n.readAllC2CMessage){if(o===Ir.READ_ALL_MSG)n.readAllC2CMessage=1;else if(o===Ir.READ_ALL_C2C_MSG){n.readAllC2CMessage=1;break}}else if(i.type===Ir.CONV_GROUP&&(o===Ir.READ_ALL_GROUP_MSG||o===Ir.READ_ALL_MSG)){var a=this._getConversationLastMessageSequence(i);n.groupMessageReadInfoList.push({groupID:i.groupProfile.groupID,messageSequence:a})}}}catch(u){r.e(u)}finally{r.f()}return n}},{key:"onPushedAllMessageRead",value:function(e){this._handleAllMessageRead(e)}},{key:"_handleAllMessageRead",value:function(e){var t=e.groupMessageReadInfoList,n=e.readAllC2CMessage,o=this._parseGroupReadInfo(t);return this._updateAllConversationUnreadCount({readAllC2CMessage:n})>=1&&(this.emitConversationUpdate(!0,!1),this.emitTotalUnreadMessageCountUpdate()),o}},{key:"_parseGroupReadInfo",value:function(e){var t=[];if(e&&e.length)for(var n=0,o=e.length;n<o;n++){var r=e[n],i=r.groupID,a=r.sequence,s=r.retCode,u=r.lastMessageSeq;id(s)?this._remoteGroupReadSequenceMap.set(i,u):(this._remoteGroupReadSequenceMap.set(i,a),0!==s&&t.push("".concat(i,"-").concat(a,"-").concat(s)))}return t}},{key:"_updateAllConversationUnreadCount",value:function(e){var t,n=e.readAllC2CMessage,o=0,r=S(this._conversationMap);try{for(r.s();!(t=r.n()).done;){var i=_(t.value,2),a=i[0],s=i[1];if(s.unreadCount>=1){if(1===n&&s.type===Ir.CONV_C2C){var u=this._getConversationLastMessageTime(s);this.updateIsReadAfterReadReport({conversationID:a,lastMessageTime:u})}else if(s.type===Ir.CONV_GROUP){var c=a.replace(Ir.CONV_GROUP,"");if(this._remoteGroupReadSequenceMap.has(c)){var l=this._remoteGroupReadSequenceMap.get(c),d=this._getConversationLastMessageSequence(s);this.updateIsReadAfterReadReport({conversationID:a,remoteReadSequence:l}),d>=l&&this._remoteGroupReadSequenceMap.delete(c)}}this.updateUnreadCount(a,!1)&&(o+=1)}}}catch(f){r.e(f)}finally{r.f()}return o}},{key:"isRemoteRead",value:function(e){var t=e.conversationID,n=e.sequence,o=t.replace(Ir.CONV_GROUP,""),r=!1;if(this._remoteGroupReadSequenceMap.has(o)){var i=this._remoteGroupReadSequenceMap.get(o);n<=i&&(r=!0,Gl.l("".concat(this._n,".isRemoteRead conversationID:").concat(t," messageSequence:").concat(n," remoteReadSequence:").concat(i))),n>=i+10&&this._remoteGroupReadSequenceMap.delete(o)}return r}},{key:"updateIsReadAfterReadReport",value:function(e){var t=e.conversationID,n=e.lastMessageSeq,o=e.lastMessageTime,r=this._messageListHandler.getLocalMessageList(t);if(0!==r.length)for(var i,a=r.length-1;a>=0;a--)if(i=r[a],!(o&&i.time>o||n&&i.sequence>n)){if("in"===i.flow&&i.isRead)break;i.setIsRead(!0)}}},{key:"updateUnreadCount",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=!1,o=this.getLocalConversation(e),r=this._messageListHandler.getLocalMessageList(e);if(o){var i=o.unreadCount,a=r.filter((function(e){return!e.isRead&&!e._onlineOnlyFlag&&!e.isDeleted})).length;if(i!==a&&(o.unreadCount=a,n=!0,Gl.l("".concat(this._n,".updateUnreadCount from ").concat(i," to ").concat(a,", conversationID:").concat(e)),!0===t&&(this.emitConversationUpdate(!0,!1),this.emitTotalUnreadMessageCountUpdate())),n&&o.type===Ir.CONV_TOPIC){var s=o.unreadCount,u=this.getModule(Zf),c=e.replace(Ir.CONV_GROUP,"");u.onConversationProxy({topicID:c,unreadCount:s})}return n}}},{key:"clearGroupAtInfoList",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this.getLocalConversation(e);if(n&&n.groupAtInfoList.length>0){if(n.clearGroupAtInfoList(),Gl.l("".concat(this._n,".clearGroupAtInfoList conversationID:").concat(e)),n.type===Ir.CONV_TOPIC){var o=n.groupAtInfoList,r=this.getModule(Zf),i=e.replace(Ir.CONV_GROUP,"");r.onConversationProxy({topicID:i,groupAtInfoList:o})}!0===t&&this.emitConversationUpdate(!0,!1)}}},{key:"updateReadReceiptInfo",value:function(e){var t=this,n=e.userID,o=void 0===n?void 0:n,r=e.groupID,i=void 0===r?void 0:r,a=e.readReceiptList;if(!Yd(a)){var s=[];if(id(o)){if(!id(i)){var u="".concat(Ir.CONV_GROUP).concat(i);a.forEach((function(e){var n=e.tinyID,o=e.clientTime,r=e.random,a=e.readCount,c=e.unreadCount,l="".concat(n,"-").concat(o,"-").concat(r),d=t._messageListHandler.getLocalMessage(u,l),p={groupID:i,messageID:l,readCount:0,unreadCount:0};d&&(ed(a)&&(d.readReceiptInfo.readCount=a,p.readCount=a),ed(c)&&(d.readReceiptInfo.unreadCount=c,p.unreadCount=c),s.push(p))}))}}else{var c="".concat(Ir.CONV_C2C).concat(o);a.forEach((function(e){var n=e.tinyID,r=e.clientTime,i=e.random,a="".concat(n,"-").concat(r,"-").concat(i),u=t._messageListHandler.getLocalMessage(c,a);if(u){u.readReceiptInfo.isPeerRead=!0;var l={userID:o,messageID:a,isPeerRead:!0};s.push(l)}}))}s.length>0&&this.emitOuterEvent(Mr.MESSAGE_READ_RECEIPT_RECEIVED,s)}}},{key:"recomputeGroupUnreadCount",value:function(e){var t=e.conversationID,n=e.count,o=this.getLocalConversation(t);if(o){var r=o.unreadCount,i=r-n;i<0&&(i=0),o.unreadCount=i,Gl.l("".concat(this._n,".recomputeGroupUnreadCount from ").concat(r," to ").concat(i,", conversationID:").concat(t))}}},{key:"updateIsRead",value:function(e){var t=this.getLocalConversation(e),n=this.getLocalMessageList(e);if(t&&0!==n.length&&!Ld(t.type)){for(var o=[],r=0,i=n.length;r<i;r++)"in"!==n[r].flow?"out"!==n[r].flow||n[r].isRead||n[r].setIsRead(!0):o.push(n[r]);var a=0;if(t.type===Ir.CONV_C2C){var s=o.slice(-t.unreadCount).filter((function(e){return e.isRevoked})).length;a=o.length-t.unreadCount-s}else a=o.length-t.unreadCount;for(var u=0;u<a&&!o[u].isRead;u++)o[u].setIsRead(!0)}}},{key:"deleteGroupAtTips",value:function(e){var t=this,n="".concat(this._n,".deleteGroupAtTips");Gl.l("".concat(n));var o=this._conversationMap.get(e);if(!o)return Promise.resolve();var r=o.groupAtInfoList;if(0===r.length)return Promise.resolve();var i=void 0;e.startsWith(Ir.CONV_GROUP)&&(i=e.replace(Ir.CONV_GROUP,""));var a=y(r);if((bd({groupID:i})||Dd(i))&&0===(a=r.filter((function(e){return!e.atTypeArray.includes(Ir.CONV_AT_ALL)}))).length)return this.clearGroupAtInfoList(e,!1),Promise.resolve();var s=this.getMyUserID();return this.request({protocolName:ig,requestData:{messageListToDelete:a.map((function(e){return{from:e.from,to:s,messageSeq:e.__sequence,messageRandom:e.__random,groupID:id(e.topicID)?e.groupID:e.topicID}}))}}).then((function(){return Gl.l("".concat(n," ok. count:").concat(r.length)),t.clearGroupAtInfoList(e,!1),Promise.resolve()})).catch((function(e){return Gl.e("".concat(n," failed. error:"),e),BI(e)}))}},{key:"appendToMessageList",value:function(e){this._messageListHandler.pushIn(e)}},{key:"setMessageRandom",value:function(e){this.singlyLinkedList.set(e.random)}},{key:"deleteMessageRandom",value:function(e){this.singlyLinkedList.delete(e.random)}},{key:"pushIntoMessageList",value:function(e,t,n){return!(!this._messageListHandler.pushIn(t,n)||this._isMessageFromCurrentInstance(t)&&!n)&&(e.push(t),!0)}},{key:"_isMessageFromCurrentInstance",value:function(e){return this.singlyLinkedList.has(e.random)}},{key:"revoke",value:function(e,t,n){return this._messageListHandler.revoke(e,t,n)}},{key:"getPeerReadTime",value:function(e){return this._peerReadTimeMap.get(e)}},{key:"recordPeerReadTime",value:function(e,t){this._peerReadTimeMap.has(e)?this._peerReadTimeMap.get(e)<t&&this._peerReadTimeMap.set(e,t):this._peerReadTimeMap.set(e,t)}},{key:"updateMessageIsPeerReadProperty",value:function(e,t){if(e.startsWith(Ir.CONV_C2C)&&t>0){var n=this._messageListHandler.updateMessageIsPeerReadProperty(e,t);if(n.length>0&&this.emitOuterEvent(Mr.MESSAGE_READ_BY_PEER,n),this._conversationMap.has(e)){var o=this._conversationMap.get(e).lastMessage;Yd(o)||o.fromAccount===this.getMyUserID()&&o.lastTime<=t&&!o.isPeerRead&&(o.isPeerRead=!0,this.emitConversationUpdate(!0,!1))}}}},{key:"updateMessageIsModifiedProperty",value:function(e){this._messageListHandler.updateMessageIsModifiedProperty(e)}},{key:"setCompleted",value:function(e){Gl.l("".concat(this._n,".setCompleted. conversationID:").concat(e)),this._completedMap.set(e,!0)}},{key:"updateRoamingMessageKeyAndTime",value:function(e,t,n){this._roamingMessageKeyAndTimeMap.set(e,{messageKey:t,lastMessageTime:n})}},{key:"updateRoamingMessageSequence",value:function(e,t){this._roamingMessageSequenceMap.set(e,t)}},{key:"getConversationList",value:function(e){var t=this,n="getConversationList",o="".concat(this._n,".").concat(n),r="pagingStatus:".concat(this._pagingStatus,", local conversation count:").concat(this._conversationMap.size,", options:").concat(e);if(Gl.l("".concat(o,". ").concat(r)),this._pagingStatus===jp.REJECTED){var i=new w_(n);return i.setMessage(r),this.syncConversationList().then((function(){i.setNetworkType(t.getNetworkType()).end();var n=t._getConversationList(e);return GI({conversationList:n,isSyncCompleted:t._isSyncCompleted()})})).catch((function(e){return t.probeNetwork().then((function(t){var n=_(t,2),o=n[0],r=n[1];i.setError(e,o,r).end()})),Gl.e("".concat(o," failed. error:"),e),BI(e)}))}if(0===this._conversationMap.size){var a=new w_(n);return a.setMessage(r),this.syncConversationList().then((function(){a.setNetworkType(t.getNetworkType()).end();var n=t._getConversationList(e);return GI({conversationList:n,isSyncCompleted:t._isSyncCompleted()})})).catch((function(e){return t.probeNetwork().then((function(t){var n=_(t,2),o=n[0],r=n[1];a.setError(e,o,r).end()})),Gl.e("".concat(o," failed. error:"),e),BI(e)}))}var s=this._getConversationList(e);return Gl.l("".concat(o,". returned conversation count:").concat(s.length)),qI({conversationList:s,isSyncCompleted:this._isSyncCompleted()})}},{key:"_getConversationList",value:function(e){if(id(e))return this.getLocalConversationList();if(rd(e))return 0===e.length?[]:this.getLocalConversationList().filter((function(t){return e.includes(t.conversationID)}));if(od(e)){var t=e.type,n=e.markType,o=e.groupName;return this.getLocalConversationList().filter((function(e){return(t!==Ir.CONV_C2C&&t!==Ir.CONV_GROUP||e.type===t)&&(!td(o)||e.conversationGroupList.includes(o))&&(!ed(n)||e.markList.includes(n))}))}return[]}},{key:"_handleC2CPeerReadTime",value:function(){var e,t=S(this._conversationMap);try{for(t.s();!(e=t.n()).done;){var n=_(e.value,2),o=n[0],r=n[1];r.type===Ir.CONV_C2C&&(Gl.d("".concat(this._n,"._handleC2CPeerReadTime conversationID:").concat(o," peerReadTime:").concat(r.peerReadTime)),this.recordPeerReadTime(o,r.peerReadTime))}}catch(a){t.e(a)}finally{t.f()}}},{key:"_isPagingGetGroupListCompleted",value:function(){return this.getModule(Kf).isPagingGetCompleted()}},{key:"_getLocalGroupCount",value:function(){return this.getModule(Kf).getLocalGroupList().length}},{key:"_hasLocalGroup",value:function(e){return this.getModule(Kf).hasLocalGroup(e.replace(Ir.CONV_GROUP,""))}},{key:"getConversationProfile",value:function(e){var t,n=this;if((t=this._conversationMap.has(e)?this._conversationMap.get(e):new MC({conversationID:e,type:e.slice(0,3)===Ir.CONV_C2C?Ir.CONV_C2C:Ir.CONV_GROUP},this.isIntl()))._isInfoCompleted||t.type===Ir.CONV_SYSTEM)return qI({conversation:t});if(Ad(e)&&!this._hasLocalGroup(e))return qI({conversation:t});var o="".concat(this._n,".").concat("getConversationProfile"),r=new w_("getConversationProfile");return Gl.l("".concat(o,". conversationID:").concat(e," remark:").concat(t.remark," lastMessage:"),t.lastMessage),this._updateUserOrGroupProfileCompletely(t).then((function(i){r.setNetworkType(n.getNetworkType()).setMessage("conversationID:".concat(e," unreadCount:").concat(i.data.conversation.unreadCount)).end();var a=n.getModule(jf);if(a&&t.type===Ir.CONV_C2C){var s=e.replace(Ir.CONV_C2C,"");if(a.isMyFriend(s)){var u=a.getFriendRemark(s);t.remark!==u&&(t.remark=u,Gl.l("".concat(o,". conversationID:").concat(e," patch remark:").concat(t.remark)))}}return Gl.l("".concat(o," ok. conversationID:").concat(e)),i})).catch((function(t){return n.probeNetwork().then((function(n){var o=_(n,2),i=o[0],a=o[1];r.setError(t,i,a).setMessage("conversationID:".concat(e)).end()})),Gl.e("".concat(o," failed. error:"),t),BI(t)}))}},{key:"_updateUserOrGroupProfileCompletely",value:function(e){var t=this;return e.type===Ir.CONV_C2C?this.getModule(Vf).getUserProfile({userIDList:[e.toAccount]}).then((function(n){var o=n.data;return 0===o.length?BI(new UI({code:Im})):(e.userProfile=o[0],e._isInfoCompleted=!0,t._unshiftConversation(e),qI({conversation:e}))})):this.getModule(Kf).getGroupProfile({groupID:e.toAccount}).then((function(n){return e.groupProfile=n.data.group,e._isInfoCompleted=!0,t._unshiftConversation(e),qI({conversation:e})}))}},{key:"_unshiftConversation",value:function(e){e instanceof MC&&!this._conversationMap.has(e.conversationID)&&(this._conversationMap=new Map([[e.conversationID,e]].concat(y(this._conversationMap))),this._setStorageConversationList(),this.emitConversationUpdate(!0,!1))}},{key:"_onProfileUpdated",value:function(e){var t=this;e.data.forEach((function(e){var n=e.userID;if(n===t.getMyUserID())t._onMyProfileModified({latestNick:e.nick,latestAvatar:e.avatar});else{var o=t._conversationMap.get("".concat(Ir.CONV_C2C).concat(n));o&&(o.userProfile=e)}}))}},{key:"_isSyncCompleted",value:function(){return this._pagingStatus===jp.RESOLVED}},{key:"deleteConversation",value:function(e){var t=this,n={fromAccount:this.getMyUserID(),toAccount:void 0,type:void 0,toGroupID:void 0};if(!this._conversationMap.has(e))return BI({code:Mm});var o=this._conversationMap.get(e).type;if(o===Ir.CONV_C2C)n.type=1,n.toAccount=e.replace(Ir.CONV_C2C,"");else{if(o!==Ir.CONV_GROUP)return o===Ir.CONV_SYSTEM?(this.getModule(Kf).deleteGroupSystemNotice({messageList:this._messageListHandler.getLocalMessageList(e)}),this.deleteLocalConversation(e),qI({conversationID:e})):BI({code:Cm});if(!this._hasLocalGroup(e))return this.deleteLocalConversation(e),qI({conversationID:e});n.type=2,n.toGroupID=e.replace(Ir.CONV_GROUP,"")}var r="".concat(this._n,".").concat("deleteConversation"),i=new w_("deleteConversation");return i.setMessage("conversationID:".concat(e)),Gl.l("".concat(r,". conversationID:").concat(e)),this.setMessageRead({conversationID:e}).then((function(){return t.request({protocolName:ng,requestData:n})})).then((function(){return i.setNetworkType(t.getNetworkType()).end(),Gl.l("".concat(r," ok")),t.deleteLocalConversation(e),qI({conversationID:e})})).catch((function(e){return t.probeNetwork().then((function(t){var n=_(t,2),o=n[0],r=n[1];i.setError(e,o,r).end()})),Gl.e("".concat(r," failed. error:"),e),BI(e)}))}},{key:"clearHistoryMessage",value:function(e){var t=this,n={fromAccount:this.getMyUserID(),toAccount:void 0,type:void 0,toGroupID:void 0};if(!this._conversationMap.has(e))return BI({code:Mm});var o=this._conversationMap.get(e).type;if(o===Ir.CONV_C2C)n.type=1,n.toAccount=e.replace(Ir.CONV_C2C,"");else{if(o!==Ir.CONV_GROUP)return o===Ir.CONV_SYSTEM?(this.getModule(Kf).deleteGroupSystemNotice({messageList:this._messageListHandler.getLocalMessageList(e)}),qI({conversationID:e})):BI({code:Cm});n.type=2,n.toGroupID=e.replace(Ir.CONV_GROUP,"")}var r="".concat(this._n,".").concat("clearHistoryMessage"),i=new w_("clearHistoryMessage");return i.setMessage("conversationID:".concat(e)),Gl.l("".concat(r,". conversationID:").concat(e)),this.setMessageRead({conversationID:e}).then((function(){return t.request({protocolName:og,requestData:n})})).then((function(){i.setNetworkType(t.getNetworkType()).end(),Gl.l("".concat(r," ok")),t._messageListHandler.removeByConversationID(e),t.setCompleted(e);var n=t.getLocalConversation(e);return n&&(n.updateLastMessage(),t._sortConversationListAndEmitEvent()),qI({conversationID:e})})).catch((function(e){return t.probeNetwork().then((function(t){var n=_(t,2),o=n[0],r=n[1];i.setError(e,o,r).end()})),Gl.e("".concat(r," failed. error:"),e),BI(e)}))}},{key:"pinConversation",value:function(e){var t=this,n=e.conversationID,o=e.isPinned;if(!this._conversationMap.has(n))return BI({code:Mm});var r=this.getLocalConversation(n);if(r.isPinned===o)return qI({conversationID:n});var i="".concat(this._n,".").concat("pinConversation"),a=new w_("pinConversation");a.setMessage("conversationID:".concat(n," isPinned:").concat(o)),Gl.l("".concat(i,". conversationID:").concat(n," isPinned:").concat(o));var s=null;return Ed(n)?s={type:1,toAccount:n.replace(Ir.CONV_C2C,"")}:Ad(n)&&(s={type:2,groupID:n.replace(Ir.CONV_GROUP,"")}),this.request({protocolName:rg,requestData:{fromAccount:this.getMyUserID(),operationType:!0===o?1:2,itemList:[s]}}).then((function(){return a.setNetworkType(t.getNetworkType()).end(),Gl.l("".concat(i," ok")),r.isPinned!==o&&(r.isPinned=o,t._sortConversationListAndEmitEvent()),GI({conversationID:n})})).catch((function(e){return t.probeNetwork().then((function(t){var n=_(t,2),o=n[0],r=n[1];a.setError(e,o,r).end()})),Gl.e("".concat(i," failed. error:"),e),BI(e)}))}},{key:"setMessageRemindType",value:function(e){return this._messageRemindHandler.set(e)}},{key:"patchMessageRemindType",value:function(e){var t=e.ID,n=e.isC2CConversation,o=e.messageRemindType,r=!1,i=this.getLocalConversation(n?"".concat(Ir.CONV_C2C).concat(t):"".concat(Ir.CONV_GROUP).concat(t));return i&&i.messageRemindType!==o&&(i.messageRemindType=o,r=!0),Gl.d("".concat(this._n,".patchMessageRemindType options:"),e,"ret:".concat(r)),r}},{key:"onC2CMessageRemindTypeSynced",value:function(e){var t=this,n="".concat(this._n,".onC2CMessageRemindTypeSynced");Gl.d(n,e),e.dataList.forEach((function(e){if(!Yd(e.muteNotificationsSync)){var o,r=e.muteNotificationsSync,i=r.to,a=r.updateSequence,s=r.muteFlag;t._messageRemindHandler.setUpdateSequence(a),0===s?o=Ir.MSG_REMIND_ACPT_AND_NOTE:1===s?o=Ir.MSG_REMIND_DISCARD:2===s&&(o=Ir.MSG_REMIND_ACPT_NOT_NOTE);var u=0;t.patchMessageRemindType({ID:i,isC2CConversation:!0,messageRemindType:o})&&(u+=1),Gl.l("".concat(n," updateCount:").concat(u)),u>=1&&t.emitConversationUpdate(!0,!1)}}))}},{key:"onGroupMessageRemindTypeSynced",value:function(e){Gl.d("".concat(this._n,".onGroupMessageRemindTypeSynced options:"),e),this._messageRemindHandler.onGroupMessageRemindTypeUpdated(e)}},{key:"deleteLocalConversation",value:function(e){var t=this._conversationMap.has(e);if(Gl.l("".concat(this._n,".deleteLocalConversation conversationID:").concat(e," has:").concat(t)),t){this._conversationMap.delete(e),this._roamingMessageKeyAndTimeMap.has(e)&&this._roamingMessageKeyAndTimeMap.delete(e),this._roamingMessageSequenceMap.has(e)&&this._roamingMessageSequenceMap.delete(e),this._setStorageConversationList(),this._messageListHandler.removeByConversationID(e),this._completedMap.delete(e);var n=!this._isTopicConversation(e);this.emitConversationUpdate(n,!1)}}},{key:"isMessageSentByCurrentInstance",value:function(e){return!(!this._messageListHandler.hasLocalMessage(e.conversationID,e.ID)&&!this.singlyLinkedList.has(e.random))}},{key:"modifyMessageList",value:function(e){if(e.startsWith(Ir.CONV_C2C)&&this._conversationMap.has(e)){var t=this._conversationMap.get(e),n=Date.now();this._messageListHandler.modifyMessageSentByPeer({conversationID:e,latestNick:t.userProfile.nick,latestAvatar:t.userProfile.avatar});var o=this.getModule(Vf).getNickAndAvatarByUserID(this.getMyUserID());this._messageListHandler.modifyMessageSentByMe({conversationID:e,latestNick:o.nick,latestAvatar:o.avatar}),Gl.l("".concat(this._n,".modifyMessageList conversationID:").concat(e," cost ").concat(Date.now()-n," ms"))}}},{key:"updateUserProfileSpecifiedKey",value:function(e){Gl.l("".concat(this._n,".updateUserProfileSpecifiedKey options:"),e);var t=e.conversationID,n=e.nick,o=e.avatar;if(this._conversationMap.has(t)){var r=this._conversationMap.get(t).userProfile;td(n)&&r.nick!==n&&(r.nick=n),td(o)&&r.avatar!==o&&(r.avatar=o),this.emitConversationUpdate(!0,!1)}}},{key:"_onMyProfileModified",value:function(e){var n=this,o=this.getLocalConversationList(),r=Date.now();o.forEach((function(o){n.modifyMessageSentByMe(t({conversationID:o.conversationID},e))})),Gl.l("".concat(this._n,"._onMyProfileModified. modify all messages sent by me, cost ").concat(Date.now()-r," ms"))}},{key:"modifyMessageSentByMe",value:function(e){this._messageListHandler.modifyMessageSentByMe(e)}},{key:"getLatestMessageSentByMe",value:function(e){return this._messageListHandler.getLatestMessageSentByMe(e)}},{key:"modifyMessageSentByPeer",value:function(e){this._messageListHandler.modifyMessageSentByPeer(e)}},{key:"getLatestMessageSentByPeer",value:function(e){return this._messageListHandler.getLatestMessageSentByPeer(e)}},{key:"pushIntoNoticeResult",value:function(e,t){return!(!this._messageListHandler.pushIn(t)||this.singlyLinkedList.has(t.random))&&(e.push(t),!0)}},{key:"getLocalLastMessage",value:function(e){return this._messageListHandler.getLocalLastMessage(e)}},{key:"checkAndPatchRemark",value:function(){var e=Promise.resolve();if(0===this._conversationMap.size)return e;var t=this.getModule(jf);if(!t)return e;var n=y(this._conversationMap.values()).filter((function(e){return e.type===Ir.CONV_C2C}));if(0===n.length)return e;var o=0;return n.forEach((function(e){var n=e.conversationID.replace(Ir.CONV_C2C,"");if(t.isMyFriend(n)){var r=t.getFriendRemark(n);e.remark!==r&&(e.remark=r,o+=1)}})),Gl.l("".concat(this._n,".checkAndPatchRemark. c2c conversation count:").concat(n.length,", patched count:").concat(o)),e}},{key:"updateTopicConversation",value:function(e){this._updateLocalConversationList({conversationOptionsList:e,isFromGetConversations:!0})}},{key:"sendReadReceipt",value:function(e){var t=e[0],n=null;return t.conversationType===Ir.CONV_C2C?n=this._m.getModule(Hf):t.conversationType===Ir.CONV_GROUP&&(n=this._m.getModule(Kf)),n?n.sendReadReceipt(e):BI({code:n_})}},{key:"getReadReceiptList",value:function(e){var t=e[0],n=null;return t.conversationType===Ir.CONV_C2C?n=this._m.getModule(Hf):t.conversationType===Ir.CONV_GROUP&&(n=this._m.getModule(Kf)),n?n.getReadReceiptList(e):BI({code:n_})}},{key:"getLastMessageTime",value:function(e){var t=this.getLocalConversation(e);return t?t.lastMessage.lastTime:0}},{key:"getTotalUnreadMessageCount",value:function(){var e=this.getLocalConversationList(),t=0;return e.forEach((function(e){e.type!==Ir.CONV_SYSTEM&&(""!==e.messageRemindType&&e.messageRemindType!==Ir.MSG_REMIND_ACPT_AND_NOTE||(t+=e.unreadCount))})),t}},{key:"emitTotalUnreadMessageCountUpdate",value:function(){var e=this.getTotalUnreadMessageCount();this._convTotalUnreadCount!==e&&(Gl.l("".concat(this._n,".emitTotalUnreadMessageCountUpdate from ").concat(this._convTotalUnreadCount," to ").concat(e)),this._convTotalUnreadCount=e,this.emitOuterEvent(Mr.TOTAL_UNREAD_MESSAGE_COUNT_UPDATED))}},{key:"reset",value:function(){Gl.l("".concat(this._n,".reset")),this._pagingStatus=jp.NOT_START,this._messageListHandler.reset(),this._messageRemindHandler.reset(),this._roamingMessageKeyAndTimeMap.clear(),this._roamingMessageSequenceMap.clear(),this.singlyLinkedList.reset(),this._peerReadTimeMap.clear(),this._completedMap.clear(),this._conversationMap.clear(),this._pagingTimeStamp=0,this._pagingStartIndex=0,this._pagingPinnedTimeStamp=0,this._pagingPinnedStartIndex=0,this._remoteGroupReadSequenceMap.clear(),this._convTotalUnreadCount=0,this.resetReady()}}]),o}(vh),EC=function(){function e(t){r(this,e),this._groupModule=t,this._n="GroupTipsHandler",this._cachedGroupTipsMap=new Map,this._checkCountMap=new Map,this.MAX_CHECK_COUNT=4,this._getTopicPendingMap=new Map}return a(e,[{key:"onCheckTimer",value:function(e){e%1==0&&this._cachedGroupTipsMap.size>0&&this._checkCachedGroupTips()}},{key:"_checkCachedGroupTips",value:function(){var e=this;this._cachedGroupTipsMap.forEach((function(t,n){var o=e._checkCountMap.get(n),r=e._groupModule.hasLocalGroup(n);Gl.l("".concat(e._n,"._checkCachedGroupTips groupID:").concat(n," hasLocalGroup:").concat(r," checkCount:").concat(o)),r?(e._notifyCachedGroupTips(n),e._checkCountMap.delete(n),e._groupModule.deleteUnjoinedAVChatRoom(n)):o>=e.MAX_CHECK_COUNT?(e._deleteCachedGroupTips(n),e._checkCountMap.delete(n)):(o++,e._checkCountMap.set(n,o))}))}},{key:"onNewGroupTips",value:function(e){Gl.d("".concat(this._n,".onReceiveGroupTips count:").concat(e.dataList.length));var t=this.newGroupTipsStoredAndSummary(e),n=t.eventDataList,o=t.result,r=t.AVChatRoomMessageList;r.length>0&&this._groupModule.onAVChatRoomMessage(r),n.length>0&&(this._groupModule.updateNextMessageSeq(n),this._groupModule.getModule(Wf).onNewMessage({conversationOptionsList:n,isInstantMessage:!0})),o.length>0&&(this._groupModule.emitOuterEvent(Mr.MESSAGE_RECEIVED,o),this.handleMessageList(o))}},{key:"newGroupTipsStoredAndSummary",value:function(e){for(var n=this,o=e.event,r=e.dataList,i=null,a=[],s=[],u={},c=[],l=function(e,l){var d=Cd(r[e]);if(6===o){if(n._groupModule.isGroupAttributesUpdatedNotice(d))return"continue";if(n._groupModule.isGroupCountersNotice(d))return"continue"}var p=d.groupProfile,f=p.groupID,h=p.communityType,g=void 0===h?0:h,v=p.topicID,m=void 0===v?void 0:v,_=p.invisible,y=void 0,M=n._groupModule.isMessageFromTopic(g,m);if(M){y=Ir.CONV_TOPIC,d.to=m;var I=n._groupModule.getModule(Zf);I.hasLocalTopic(f,m)||n._getTopicPendingMap.has(m)||(n._getTopicPendingMap.set(m,1),I.getTopicList({groupID:f,topicIDList:[m]}).finally((function(){n._getTopicPendingMap.delete(m)})))}var C=n._groupModule.hasLocalGroup(f);if(!C&&n._groupModule.isUnjoinedAVChatRoom(f))return"continue";if(!C&&!M)return n._cacheGroupTipsAndProbe({groupID:f,event:o,item:d}),"continue";if(n._groupModule.isMessageFromOrToAVChatroom(f))return d.event=o,c.push(d),"continue";if(d.currentUser=n._groupModule.getMyUserID(),d.conversationType=Ir.CONV_GROUP,(i=new PI(d)).setElement({type:Ir.MSG_GRP_TIP,content:t(t({},d.elements),{},{groupProfile:d.groupProfile})}),i.isSystemMessage=!1,1===_)return n._qualityStat(i),"continue";var k=n._groupModule.getModule(Wf),T=i,S=T.conversationID,b=T.sequence;if(6===o)i._onlineOnlyFlag=!0,s.push(i);else if(!k.pushIntoNoticeResult(s,i))return"continue";if(n._groupModule.isMessageFromCommunityOfTopic(g,m))return"continue";if(6===o&&k.getLocalConversation(S))return"continue";6!==o&&n._qualityStat(i);var D=k.isRemoteRead({conversationID:S,sequence:b});if(id(u[S])){var E=0;"in"===i.flow&&(i._isExcludedFromUnreadCount||i._onlineOnlyFlag||D||(E=1)),u[S]=a.push({conversationID:S,unreadCount:E,type:id(y)?i.conversationType:y,subType:i.conversationSubType,lastMessage:i._isExcludedFromLastMessage?"":i})-1}else{var A=u[S];a[A].type=i.conversationType,a[A].subType=i.conversationSubType,a[A].lastMessage=i._isExcludedFromLastMessage?"":i,"in"===i.flow&&(i._isExcludedFromUnreadCount||i._onlineOnlyFlag||D||a[A].unreadCount++)}},d=0,p=r.length;d<p;d++)l(d);return{eventDataList:a,result:s,AVChatRoomMessageList:c}}},{key:"_qualityStat",value:function(e){this._groupModule.getModule(ch).addMessageSequence({key:S_,message:e})}},{key:"handleMessageList",value:function(e){var t=this;e.forEach((function(e){switch(e.payload.operationType){case 1:t._onNewMemberComeIn(e);break;case 2:t._onMemberQuit(e);break;case 3:t._onMemberKickedOut(e);break;case 4:t._onMemberSetAdmin(e);break;case 5:t._onMemberCancelledAdmin(e);break;case 6:t._onGroupProfileModified(e);break;case 7:t._onMemberInfoModified(e);break;case 8:t._onTopicProfileUpdated(e);break;default:Gl.w("".concat(t._n,".handleMessageList unknown operationType:").concat(e.payload.operationType))}}))}},{key:"_onNewMemberComeIn",value:function(e){var t=e.payload,n=t.memberNum,o=t.groupProfile.groupID,r=this._groupModule.getLocalGroupProfile(o);r&&ed(n)&&r.memberCount!==n&&(r.memberCount=n,this._updateConversationGroupProfile(r))}},{key:"_onMemberQuit",value:function(e){var t=e.payload,n=t.memberNum,o=t.groupProfile.groupID,r=this._groupModule.getLocalGroupProfile(o);r&&ed(n)&&r.memberCount!==n&&(r.memberCount=n,this._updateConversationGroupProfile(r)),this._groupModule.getModule(zf).deleteLocalGroupMembers(o,e.payload.userIDList)}},{key:"_onMemberKickedOut",value:function(e){var t=e.payload,n=t.memberNum,o=t.groupProfile.groupID,r=this._groupModule.getLocalGroupProfile(o);r&&ed(n)&&r.memberCount!==n&&(r.memberCount=n,this._updateConversationGroupProfile(r)),this._groupModule.getModule(zf).deleteLocalGroupMembers(o,e.payload.userIDList)}},{key:"_updateConversationGroupProfile",value:function(e){this._groupModule.getModule(Wf).updateConversationGroupProfile([e])}},{key:"_onMemberSetAdmin",value:function(e){var t=e.payload.groupProfile.groupID,n=e.payload.userIDList,o=this._groupModule.getModule(zf);n.forEach((function(e){var n=o.getLocalGroupMemberInfo(t,e);n&&n.updateRole(Ir.GRP_MBR_ROLE_ADMIN)}))}},{key:"_onMemberCancelledAdmin",value:function(e){var t=e.payload.groupProfile.groupID,n=e.payload.userIDList,o=this._groupModule.getModule(zf);n.forEach((function(e){var n=o.getLocalGroupMemberInfo(t,e);n&&n.updateRole(Ir.GRP_MBR_ROLE_MEMBER)}))}},{key:"_onGroupProfileModified",value:function(e){var t=this,n=e.payload,o=n.newGroupProfile,r=n.groupProfile.groupID,i=this._groupModule.getLocalGroupProfile(r);Object.keys(o).forEach((function(e){switch(e){case"ownerID":t._ownerChanged(i,o);break;case"muteAllMembers":i.muteAllMembers=o.muteAllMembers;break;case"joinOption":i.joinOption=o.joinOption;break;default:i[e]=o[e]}}));var a=!i.isSupportTopic;this._groupModule.emitGroupListUpdate(!0,a)}},{key:"_ownerChanged",value:function(e,t){var n=e.groupID,o=this._groupModule.getLocalGroupProfile(n),r=this._groupModule.getMyUserID();if(r===t.ownerID){o.updateGroup({selfInfo:{role:Ir.GRP_MBR_ROLE_OWNER}});var i=this._groupModule.getModule(zf),a=i.getLocalGroupMemberInfo(n,r),s=this._groupModule.getLocalGroupProfile(n).ownerID,u=i.getLocalGroupMemberInfo(n,s);a&&a.updateRole(Ir.GRP_MBR_ROLE_OWNER),u&&u.updateRole(Ir.GRP_MBR_ROLE_MEMBER)}}},{key:"_onMemberInfoModified",value:function(e){var t=e.to,n=e.payload,o=n.groupProfile,r=n.memberList,i=o.groupID;Dd(t)&&this._updateTopicMuteTime(e);var a=this._groupModule.getModule(zf);r.forEach((function(e){var t=a.getLocalGroupMemberInfo(i,e.userID);t&&ed(e.muteTime)&&t.updateMuteUntil(e.muteTime)}))}},{key:"_updateTopicMuteTime",value:function(e){var t=e.to,n=e.payload,o=n.groupProfile,r=n.memberList,i=void 0===r?[]:r,a=this._groupModule.getModule(Zf),s=o.groupID,u=a.getLocalTopic(s,t);if(u){for(var c=!1,l=0;l<i.length;l++){var d=i[l];if(d.userID===this._groupModule.getMyUserID()&&d.muteTime>=0){u.updateSelfInfo({muteTime:d.muteTime}),c=!0;break}}c&&this._groupModule.emitOuterEvent(Mr.TOPIC_UPDATED,{groupID:s,topic:u})}}},{key:"_onTopicProfileUpdated",value:function(e){var n=e.payload,o=n.groupProfile.groupID,r=n.newTopicInfo;this._groupModule.getModule(Zf).onTopicProfileUpdated(t({groupID:o,topicID:e.to},r))}},{key:"_cacheGroupTips",value:function(e,t){this._cachedGroupTipsMap.has(e)||this._cachedGroupTipsMap.set(e,[]),this._cachedGroupTipsMap.get(e).push(t)}},{key:"_deleteCachedGroupTips",value:function(e){this._cachedGroupTipsMap.has(e)&&this._cachedGroupTipsMap.delete(e)}},{key:"_notifyCachedGroupTips",value:function(e){var t=this,n=this._cachedGroupTipsMap.get(e)||[];n.forEach((function(e){t.onNewGroupTips(e)})),this._deleteCachedGroupTips(e),Gl.l("".concat(this._n,"._notifyCachedGroupTips groupID:").concat(e," count:").concat(n.length))}},{key:"_cacheGroupTipsAndProbe",value:function(e){var t=this,n=e.groupID,o=e.event,r=e.item;this._cacheGroupTips(n,{event:o,dataList:[r]}),this._groupModule.getGroupSimplifiedInfo(n).then((function(e){e.type===Ir.GRP_AVCHATROOM?t._groupModule.hasLocalGroup(n)?t._notifyCachedGroupTips(n):t._groupModule.setUnjoinedAVChatRoom(n):(t._groupModule.updateGroupMap([e]),t._notifyCachedGroupTips(n))})),this._checkCountMap.has(n)||this._checkCountMap.set(n,0),Gl.l("".concat(this._n,"._cacheGroupTipsAndProbe groupID:").concat(n))}},{key:"reset",value:function(){this._cachedGroupTipsMap.clear(),this._checkCountMap.clear(),this._getTopicPendingMap.clear()}}]),e}(),AC=function(){function e(t){r(this,e),this._groupModule=t,this._n="CommonGroupHandler",this.tempConversationList=null,this._cachedGroupMessageMap=new Map,this._checkCountMap=new Map,this.MAX_CHECK_COUNT=4,this._getTopicPendingMap=new Map,this._isPagingGetCompleted=!1,t.getInnerEmitterInstance().once(rC,this._initGroupList,this)}return a(e,[{key:"onCheckTimer",value:function(e){e%1==0&&this._cachedGroupMessageMap.size>0&&this._checkCachedGroupMessage()}},{key:"_checkCachedGroupMessage",value:function(){var e=this;this._cachedGroupMessageMap.forEach((function(t,n){var o=e._checkCountMap.get(n),r=e._groupModule.hasLocalGroup(n);Gl.l("".concat(e._n,"._checkCachedGroupMessage groupID:").concat(n," hasLocalGroup:").concat(r," checkCount:").concat(o)),r?(e._notifyCachedGroupMessage(n),e._checkCountMap.delete(n),e._groupModule.deleteUnjoinedAVChatRoom(n)):o>=e.MAX_CHECK_COUNT?(e._deleteCachedGroupMessage(n),e._checkCountMap.delete(n)):(o++,e._checkCountMap.set(n,o))}))}},{key:"_initGroupList",value:function(){var e=this;Gl.l("".concat(this._n,"._initGroupList"));var t=new w_("getGroupListInStorage"),n=this._groupModule.getStorageGroupList();if(rd(n)&&n.length>0){n.forEach((function(t){e._groupModule.initGroupMap(t)})),this._groupModule.emitGroupListUpdate(!0,!1);var o=this._groupModule.getLocalGroupList().length;t.setNetworkType(this._groupModule.getNetworkType()).setMessage("group count:".concat(o)).end()}else t.setNetworkType(this._groupModule.getNetworkType()).setMessage("group count:0").end();Gl.l("".concat(this._n,"._initGroupList ok"))}},{key:"handleUpdateGroupLastMessage",value:function(e){var n="".concat(this._n,".handleUpdateGroupLastMessage");if(Gl.l("".concat(n," conversation count:").concat(e.length,", local group count:").concat(this._groupModule.getLocalGroupList().length)),0!==this._groupModule.getGroupMap().size){for(var o,r,i,a=!1,s=0,u=e.length;s<u;s++)(o=e[s]).type===Ir.CONV_GROUP&&(r=o.conversationID.split(/^GROUP/)[1],(i=this._groupModule.getLocalGroupProfile(r))&&(i.lastMessage=t({},o.lastMessage),a=!0));a&&(this._groupModule.sortLocalGroupList(),this._groupModule.emitGroupListUpdate(!0,!1))}else this.tempConversationList=e}},{key:"onNewGroupMessage",value:function(e){Gl.d("".concat(this._n,".onNewGroupMessage count:").concat(e.dataList.length));var t=this._newGroupMessageStoredAndSummary(e),n=t.conversationOptionsList,o=t.messageList,r=t.AVChatRoomMessageList;r.length>0&&this._groupModule.onAVChatRoomMessage(r),this._groupModule.filterModifiedMessage(o),n.length>0&&(this._groupModule.updateNextMessageSeq(n),this._groupModule.getModule(Wf).onNewMessage({conversationOptionsList:n,isInstantMessage:e.isInstantMessage||!0,updateUnreadCount:e.updateUnreadCount||!0}));var i=this._groupModule.filterUnmodifiedMessage(o);i.length>0&&this._groupModule.emitOuterEvent(Mr.MESSAGE_RECEIVED,i),o.length=0}},{key:"_newGroupMessageStoredAndSummary",value:function(e){var t=this,n=e.dataList,o=e.event,r=e.isInstantMessage,i=null,a=[],s=[],u=[],c={},l=this._groupModule.getModule(Qf),d=n.length;d>1&&n.sort((function(e,t){return e.sequence-t.sequence}));for(var p=function(e){var d=Cd(n[e]),p=d.groupProfile,f=p.groupID,h=p.communityType,g=void 0===h?0:h,v=p.topicID,m=void 0===v?void 0:v,_=p.invisible,y=void 0,M=t._groupModule.isMessageFromTopic(g,m);if(M){y=Ir.CONV_TOPIC,d.to=m;var I=t._groupModule.getModule(Zf);I.hasLocalTopic(f,m)||t._getTopicPendingMap.has(m)||(t._getTopicPendingMap.set(m,1),I.getTopicList({groupID:f,topicIDList:[m]}).finally((function(){t._getTopicPendingMap.delete(m)})))}var C=t._groupModule.hasLocalGroup(f);if(!C&&t._groupModule.isUnjoinedAVChatRoom(f))return"continue";if(!C&&!M)return t._cacheGroupMessageAndProbe({groupID:f,event:o,item:d}),"continue";if(t._groupModule.isMessageFromOrToAVChatroom(f))return d.event=o,u.push(d),"continue";if(d.currentUser=t._groupModule.getMyUserID(),d.conversationType=Ir.CONV_GROUP,d.isSystemMessage=!!d.isSystemMessage,i=new PI(d),d.elements=l.parseElements(d.elements,d.from),i.setElement(d.elements),1===_)return t._qualityStat(r,i),"continue";var k=1===n[e].isModified,T=t._groupModule.getModule(Wf);if(T.isMessageSentByCurrentInstance(i)?i.isModified=k:k=!1,1===d.onlineOnlyFlag)i._onlineOnlyFlag=!0,T.isMessageSentByCurrentInstance(i)||s.push(i);else{if(t._groupModule.isMessageFromCommunityOfTopic(g,m))return s.push(i),"continue";if(!T.pushIntoMessageList(s,i,k))return"continue";t._qualityStat(r,i);var S=i,b=S.conversationID,D=S.sequence,E=T.isRemoteRead({conversationID:b,sequence:D});if(id(c[b])){var A=0;"in"===i.flow&&(i._isExcludedFromUnreadCount||E||(A=1)),c[b]=a.push({conversationID:b,unreadCount:A,type:id(y)?i.conversationType:y,subType:i.conversationSubType,lastMessage:i._isExcludedFromLastMessage?"":i})-1}else{var L=c[b];a[L].type=id(y)?i.conversationType:y,a[L].subType=i.conversationSubType,a[L].lastMessage=i._isExcludedFromLastMessage?"":i,"in"===i.flow&&(i._isExcludedFromUnreadCount||E||a[L].unreadCount++)}}},f=0;f<d;f++)p(f);return{conversationOptionsList:a,messageList:s,AVChatRoomMessageList:u}}},{key:"_qualityStat",value:function(e,t){var n=this._groupModule.getModule(ch);n.addMessageSequence({key:S_,message:t}),e&&t.clientTime>0&&n.addMessageDelay(t.clientTime)}},{key:"onGroupMessageRevoked",value:function(e){var t=this._groupModule.getModule(Wf),n=[],o=null,r=!0;e.dataList.forEach((function(e){var i=e.elements.revokedInfos;id(i)||i.forEach((function(e){var i=Yd(e.topicID)?"GROUP".concat(e.groupID):"GROUP".concat(e.topicID);o=t.revoke(i,e.sequence,e.random);var a=e.revokerInfo&&e.revokerInfo.revoker;if(o)o.revoker=a,n.push(o);else{var s={conversationID:i,to:e.topicID||"",sequence:e.sequence,time:e.time,revoker:a};t.isLastMessageRevoked(s)&&(n.push(s),r=!1)}}))})),0!==n.length&&(t.onMessageRevoked(n),!0===r&&(Gl.l("".concat(this._n,".onGroupMessageRevoked count:").concat(n.length)),this._groupModule.emitOuterEvent(Mr.MESSAGE_REVOKED,n)))}},{key:"_groupListTreeShaking",value:function(e){for(var t=new Map(y(this._groupModule.getGroupMap())),n=0,o=e.length;n<o;n++)t.delete(e[n].groupID);this._groupModule.hasJoinedAVChatRoom()&&this._groupModule.getJoinedAVChatRoom().forEach((function(e){t.delete(e)})),this._groupModule.getGroupMap().forEach((function(e,n){e.isSupportTopic&&t.delete(n)}));for(var r=y(t.keys()),i=0,a=r.length;i<a;i++)this._groupModule.deleteGroup(r[i])}},{key:"getGroupList",value:function(e){var t=this,n="".concat(this._n,".").concat("getGroupList"),o=new w_("getGroupList");Gl.l("".concat(n));var r={introduction:"Introduction",notification:"Notification",createTime:"CreateTime",ownerID:"Owner_Account",lastInfoTime:"LastInfoTime",memberNum:"MemberNum",maxMemberNum:"MaxMemberNum",joinOption:"ApplyJoinOption",muteAllMembers:"ShutUpAllMember"},i=["Type","Name","FaceUrl","NextMsgSeq","LastMsgTime","AtInfoList","LastRecallTime"],a=[];e&&e.groupProfileFilter&&e.groupProfileFilter.forEach((function(e){r[e]&&i.push(r[e])}));var s=(e||{}).isGroupWithTopicOnly,u=void 0!==s&&s;return this._pagingGetGroupList({limit:50,offset:0,groupBaseInfoFilter:i,groupList:a,isGroupWithTopicOnly:u}).then((function(){Gl.l("".concat(n," ok. count:").concat(a.length," isGroupWithTopicOnly:").concat(u)),u||t._groupListTreeShaking(a),t._groupModule.updateGroupMap(a);var e=t._groupModule.getLocalGroupList().length;o.setNetworkType(t._groupModule.getNetworkType()).setMessage("remote count:".concat(a.length,", after tree shaking, local count:").concat(e,", isGroupWithTopicOnly:").concat(u)).end(),t.tempConversationList&&(t.handleUpdateGroupLastMessage(t.tempConversationList),t.tempConversationList=null),t._groupModule.patchGroupMessageRemindType(),t._groupModule.recomputeUnreadCount(),t._groupModule.emitGroupListUpdate(!0,!u);var r=t._groupModule.getLocalGroupList();if(u){var i=r.filter((function(e){return!0===e.isSupportTopic}));return GI({groupList:i})}return t._isPagingGetCompleted=!0,GI({groupList:r})})).catch((function(e){return t._groupModule.probeNetwork().then((function(t){var n=_(t,2),r=n[0],i=n[1];o.setError(e,r,i).end()})),Gl.e("".concat(n," failed. error:"),e),BI(e)}))}},{key:"isPagingGetCompleted",value:function(){return this._isPagingGetCompleted}},{key:"_pagingGetGroupList",value:function(e){var t=this,n="".concat(this._n,".").concat("_pagingGetGroupList"),o=e.isCommunityRelay,r=void 0!==o&&o,i=e.isGroupWithTopicOnly,a=void 0!==i&&i,s=e.limit,u=e.offset,c=e.groupBaseInfoFilter,l=e.groupList;if(a)return this._pagingGetGroupListWithTopic({limit:s,offset:u,groupBaseInfoFilter:c,groupList:l});var d=new w_("_pagingGetGroupList");return this._groupModule.request({protocolName:hg,requestData:{type:r?Ir.GRP_COMMUNITY:void 0,memberAccount:this._groupModule.getMyUserID(),limit:s,offset:u,responseFilter:{groupBaseInfoFilter:c,selfInfoFilter:["Role","JoinTime","MsgFlag","MsgSeq"]}}}).then((function(e){var o=e.data,i=o.groups,a=void 0===i?[]:i,p=o.totalCount;l.push.apply(l,y(a)),t._handleGroupAtInfoWithoutTopic(r,a);var f=u+s,h=!(p>f),g="offset:".concat(u," totalCount:").concat(p," isCompleted:").concat(h," ")+"currentCount:".concat(l.length," isCommunityRelay:").concat(r);return d.setNetworkType(t._groupModule.getNetworkType()).setMessage("".concat(g)).end(),r||h?!r&&h?(Gl.l("".concat(n," start to get community list")),u=0,t._pagingGetGroupList({limit:s,offset:u,groupBaseInfoFilter:c,groupList:l,isCommunityRelay:!0})):r&&!h?(u=f,t._pagingGetGroupList({limit:s,offset:u,groupBaseInfoFilter:c,groupList:l,isCommunityRelay:!0})):(Gl.l("".concat(n," ok. totalCount:").concat(l.length)),GI({groupList:l})):(u=f,t._pagingGetGroupList({limit:s,offset:u,groupBaseInfoFilter:c,groupList:l}))})).catch((function(e){return 11e3!==e.code&&t._groupModule.probeNetwork().then((function(t){var n=_(t,2),o=n[0],i=n[1];d.setMessage("isCommunityRelay:".concat(r)).setError(e,o,i).end()})),r?(11e3===e.code&&(d=null,Gl.l("".concat(n," ok. community unavailable"))),qI({groupList:l})):BI(e)}))}},{key:"_pagingGetGroupListWithTopic",value:function(e){var t=this,n="".concat(this._n,"._pagingGetGroupListWithTopic"),o=e.limit,r=e.offset,i=e.groupBaseInfoFilter,a=e.groupList,s=new w_("pagingGetGroupListWithTopic");return this._groupModule.request({protocolName:hg,requestData:{type:Ir.GRP_COMMUNITY,memberAccount:this._groupModule.getMyUserID(),limit:o,offset:r,responseFilter:{groupBaseInfoFilter:i,selfInfoFilter:["Role","JoinTime","MsgFlag","MsgSeq"]},isSupportTopic:1}}).then((function(e){var u=e.data,c=u.groups,l=void 0===c?[]:c,d=u.totalCount;a.push.apply(a,y(l));var p=r+o,f=!(d>p),h="offset:".concat(r," totalCount:").concat(d," isCompleted:").concat(f," ")+"currentCount:".concat(a.length);return s.setNetworkType(t._groupModule.getNetworkType()).setMessage("".concat(h)).end(),f?(Gl.l("".concat(n," ok. totalCount:").concat(a.length)),GI({groupList:a})):(r=p,t._pagingGetGroupListWithTopic({limit:o,offset:r,groupBaseInfoFilter:i,groupList:a}))})).catch((function(e){return t._groupModule.probeNetwork().then((function(t){var n=_(t,2),o=n[0],r=n[1];s.setError(e,o,r).end()})),BI(e)}))}},{key:"_cacheGroupMessage",value:function(e,t){this._cachedGroupMessageMap.has(e)||this._cachedGroupMessageMap.set(e,[]),this._cachedGroupMessageMap.get(e).push(t)}},{key:"_deleteCachedGroupMessage",value:function(e){this._cachedGroupMessageMap.has(e)&&this._cachedGroupMessageMap.delete(e)}},{key:"_notifyCachedGroupMessage",value:function(e){var t=this,n=this._cachedGroupMessageMap.get(e)||[];n.forEach((function(e){t.onNewGroupMessage(e)})),this._deleteCachedGroupMessage(e),Gl.l("".concat(this._n,"._notifyCachedGroupMessage groupID:").concat(e," count:").concat(n.length))}},{key:"_cacheGroupMessageAndProbe",value:function(e){var t=this,n=e.groupID,o=e.event,r=e.item;this._cacheGroupMessage(n,{event:o,dataList:[r]}),this._groupModule.getGroupSimplifiedInfo(n).then((function(e){e.type===Ir.GRP_AVCHATROOM?t._groupModule.hasLocalGroup(n)?t._notifyCachedGroupMessage(n):t._groupModule.setUnjoinedAVChatRoom(n):(t._groupModule.updateGroupMap([e]),t._notifyCachedGroupMessage(n))})),this._checkCountMap.has(n)||this._checkCountMap.set(n,0),Gl.l("".concat(this._n,"._cacheGroupMessageAndProbe groupID:").concat(n))}},{key:"_handleGroupAtInfoWithoutTopic",value:function(e,n){var o=this;e&&0!==n.length&&n.forEach((function(e){var n=e.groupID,r=e.groupAtInfoList,i=[];id(r)||(r.forEach((function(e){i.push(t(t({},e),{},{groupID:n}))})),o._groupModule.getModule(Wf).onNewGroupAtTips({dataList:i}))}))}},{key:"reset",value:function(){this._cachedGroupMessageMap.clear(),this._checkCountMap.clear(),this._getTopicPendingMap.clear(),this._isPagingGetCompleted=!1,this._groupModule.getInnerEmitterInstance().once(rC,this._initGroupList,this)}}]),e}(),LC=1,RC=2,wC=3,OC=4,NC=5,PC=function(){function e(t){r(this,e),this._groupModule=t,this._n="GroupAttributesHandler",this._groupAttributesMap=new Map,this.CACHE_EXPIRE_TIME=3e4,this._groupModule.getInnerEmitterInstance().on(iC,this._onCloudConfigUpdated,this)}return a(e,[{key:"_onCloudConfigUpdated",value:function(){var e=this._groupModule.getCloudConfig("grp_attr_cache_time");id(e)||(this.CACHE_EXPIRE_TIME=Number(e))}},{key:"updateLocalMainSequenceOnReconnected",value:function(){this._groupAttributesMap.forEach((function(e){e.localMainSequence=0}))}},{key:"isGroupAttributesUpdatedNotice",value:function(e){var t=e.to,n=e.elements.newGroupProfile,o=!id(n)&&!Yd(n.groupAttributeOption);return o&&this._onGroupAttributesUpdated({groupID:t,groupAttributeOption:n.groupAttributeOption}),o}},{key:"_onGroupAttributesUpdated",value:function(e){var t=this,n=e.groupID,o=e.groupAttributeOption,r=o.mainSequence,i=o.isWithChangedAttributeInfo,a=o.groupAttributeList,s=void 0===a?[]:a,u=o.operationType;if(Gl.l("".concat(this._n,".onGroupAttributesUpdated. ")+"groupID:".concat(n," isWithChangedAttributeInfo:").concat(i," operationType:").concat(u)),!id(u)){if(1===i)return this._refreshCachedGroupAttributes({groupID:n,remoteMainSequence:r,groupAttributeList:s,operationType:u}),void this._emitGroupAttributesUpdated(n);if(this._hasLocalGroupAttributes(n)){var c=this._getLocalGroupAttributes(n).avChatRoomKey;this._getGroupAttributes({groupID:n,avChatRoomKey:c}).then((function(){t._emitGroupAttributesUpdated(n)}))}}}},{key:"initGroupAttributesCache",value:function(e){var t=e.groupID,n=e.avChatRoomKey,o=void 0===n?void 0:n;this._groupAttributesMap.set(t,{lastUpdateTime:0,localMainSequence:0,remoteMainSequence:0,attributes:new Map,avChatRoomKey:o}),Gl.l("".concat(this._n,".initGroupAttributesCache groupID:").concat(t," avChatRoomKey:").concat(o))}},{key:"initGroupAttributes",value:function(e){var t=this,n=e.groupID,o=e.groupAttributes,r=this._getLocalGroupAttributes(n),i=r.remoteMainSequence,a=r.avChatRoomKey,s=new w_("initGroupAttributes");return s.setMessage("groupID:".concat(n," avChatRoomKey:").concat(a," mainSequence:").concat(i)),this._groupModule.request({protocolName:Bg,requestData:{groupID:n,avChatRoomKey:a,mainSequence:i,groupAttributeList:this._transformGroupAttributes(o)}}).then((function(e){var r=e.data,i=r.mainSequence,a=y(r.groupAttributeList);return a.forEach((function(e){e.value=o[e.key]})),t._refreshCachedGroupAttributes({groupID:n,remoteMainSequence:i,groupAttributeList:a,operationType:LC}),s.setNetworkType(t._groupModule.getNetworkType()).end(),Gl.l("".concat(t._n,".").concat("initGroupAttributes"," ok. groupID:").concat(n)),GI({groupAttributes:o})})).catch((function(e){return t._groupModule.probeNetwork().then((function(t){var n=_(t,2),o=n[0],r=n[1];s.setError(e,o,r).end()})),BI(e)}))}},{key:"setGroupAttributes",value:function(e){var t=this,n="".concat(this._n,".").concat("setGroupAttributes"),o=e.groupID,r=e.groupAttributes,i=this._getLocalGroupAttributes(o),a=i.remoteMainSequence,s=i.avChatRoomKey,u=i.attributes,c=this._transformGroupAttributes(r);c.forEach((function(e){var t=e.key;e.sequence=0,u.has(t)&&(e.sequence=u.get(t).sequence)}));var l=new w_("setGroupAttributes");return l.setMessage("groupID:".concat(o," groupAttributes:").concat(JSON.stringify(r))),Gl.l("".concat(n,". groupID:").concat(o," mainSequence:").concat(a)),this._groupModule.request({protocolName:Vg,requestData:{groupID:o,avChatRoomKey:s,mainSequence:a,groupAttributeList:c}}).then((function(e){var i=e.data,a=i.mainSequence,s=y(i.groupAttributeList);return s.forEach((function(e){e.value=r[e.key]})),t._refreshCachedGroupAttributes({groupID:o,remoteMainSequence:a,groupAttributeList:s,operationType:RC}),l.setNetworkType(t._groupModule.getNetworkType()).end(),Gl.l("".concat(n," ok.")),GI({groupAttributes:r})})).catch((function(e){return t._groupModule.probeNetwork().then((function(t){var n=_(t,2),o=n[0],r=n[1];l.setError(e,o,r).end()})),BI(e)}))}},{key:"deleteGroupAttributes",value:function(e){var t=this,n=e.groupID,o=e.keyList,r=void 0===o?[]:o,i=this._getLocalGroupAttributes(n),a=i.remoteMainSequence,s=i.avChatRoomKey,u=i.attributes,c=y(u.keys()),l=Kg,d=wC,p={groupID:n,avChatRoomKey:s,mainSequence:a},f=[];r.length>0&&(c=[],l=Hg,d=OC,r.forEach((function(e){var t=0;u.has(e)&&(t=u.get(e).sequence,c.push(e)),f.push({key:e,sequence:t})})),p.groupAttributeList=f);var h=new w_("deleteGroupAttributes");return h.setMessage("groupID:".concat(n," mainSequence:").concat(a," keyList:").concat(r," protocolName:").concat(l)),this._groupModule.request({protocolName:l,requestData:p}).then((function(e){var o=e.data.mainSequence;return t._refreshCachedGroupAttributes({groupID:n,remoteMainSequence:o,groupAttributeList:f,operationType:d}),h.setNetworkType(t._groupModule.getNetworkType()).end(),Gl.l("".concat(t._n,".").concat("deleteGroupAttributes"," ok. groupID:").concat(n)),GI({keyList:c})})).catch((function(e){return t._groupModule.probeNetwork().then((function(t){var n=_(t,2),o=n[0],r=n[1];h.setError(e,o,r).end()})),BI(e)}))}},{key:"getGroupAttributes",value:function(e){var t=this,n="".concat(this._n,".").concat("getGroupAttributes"),o=e.groupID,r=this._getLocalGroupAttributes(o),i=r.avChatRoomKey,a=r.lastUpdateTime,s=r.localMainSequence,u=r.remoteMainSequence,c=new w_("getGroupAttributes");if(c.setMessage("groupID:".concat(o," localMainSequence:").concat(s," remoteMainSequence:").concat(u," keyList:").concat(e.keyList)),Date.now()-a>=this.CACHE_EXPIRE_TIME||s<u)return this._getGroupAttributes({groupID:o,avChatRoomKey:i}).then((function(r){c.setMoreMessage("get attributes from remote. count:".concat(r.length)).setNetworkType(t._groupModule.getNetworkType()).end(),Gl.l("".concat(n," from remote. groupID:").concat(o));var i=t._getCachedAttributes(e);return GI({groupAttributes:i})})).catch((function(e){return t._groupModule.probeNetwork().then((function(t){var n=_(t,2),o=n[0],r=n[1];c.setError(e,o,r).end()})),BI(e)}));c.setMoreMessage("get attributes from cache").setNetworkType(this._groupModule.getNetworkType()).end(),Gl.l("".concat(n," from cache. groupID:").concat(o));var l=this._getCachedAttributes(e);return qI({groupAttributes:l})}},{key:"_getGroupAttributes",value:function(e){var n=this,o=0;return id(e.avChatRoomKey)||(o=1),this._groupModule.request({protocolName:jg,requestData:t(t({},e),{},{groupType:o})}).then((function(t){var o=t.data,r=o.mainSequence,i=o.groupAttributeList,a=y(i);return id(r)||n._refreshCachedGroupAttributes({groupID:e.groupID,remoteMainSequence:r,groupAttributeList:a,operationType:NC}),Gl.l("".concat(n._n,"._getGroupAttributes ok. groupID:").concat(e.groupID)),i})).catch((function(e){return BI(e)}))}},{key:"_refreshCachedGroupAttributes",value:function(e){var t=e.groupID,n=e.remoteMainSequence,o=e.groupAttributeList,r=e.operationType;if(this._hasLocalGroupAttributes(t)){var i=this._getLocalGroupAttributes(t),a=i.localMainSequence;if(r===NC||n-a==1)i.remoteMainSequence=n,i.localMainSequence=n,i.lastUpdateTime=Date.now(),this._updateCachedAttributes({groupAttributes:i,groupAttributeList:o,operationType:r});else{if(a===n)return;i.remoteMainSequence=n}this._groupAttributesMap.set(t,i);var s="operationType:".concat(r," localMainSequence:").concat(a," remoteMainSequence:").concat(n);Gl.l("".concat(this._n,"._refreshCachedGroupAttributes. ").concat(s))}}},{key:"_getCachedAttributes",value:function(e){var t=e.groupID,n=e.keyList,o=void 0===n?[]:n,r={};if(this._hasLocalGroupAttributes(t)){var i=this._getLocalGroupAttributes(t).attributes;if(o.length>0)o.forEach((function(e){i.has(e)&&(r[e]=i.get(e).value)}));else{var a,s=S(i.keys());try{for(s.s();!(a=s.n()).done;){var u=a.value;r[u]=i.get(u).value}}catch(l){s.e(l)}finally{s.f()}}}return r}},{key:"_updateCachedAttributes",value:function(e){var t=e.groupAttributes,n=e.groupAttributeList,o=e.operationType;o!==wC?o!==OC?(o===LC&&t.attributes.clear(),n.forEach((function(e){var n=e.key,o=e.value,r=e.sequence;t.attributes.set(n,{value:o,sequence:r})}))):n.forEach((function(e){t.attributes.delete(e.key)})):t.attributes.clear()}},{key:"_hasLocalGroupAttributes",value:function(e){return this._groupAttributesMap.has(e)}},{key:"_getLocalGroupAttributes",value:function(e){return this._hasLocalGroupAttributes(e)||this.initGroupAttributesCache({groupID:e}),this._groupAttributesMap.get(e)}},{key:"_transformGroupAttributes",value:function(e){var t=[];return Object.keys(e).forEach((function(n){t.push({key:n,value:e[n]})})),t}},{key:"_emitGroupAttributesUpdated",value:function(e){var t=this._getCachedAttributes({groupID:e});this._groupModule.emitOuterEvent(Mr.GROUP_ATTRIBUTES_UPDATED,{groupID:e,groupAttributes:t})}},{key:"deleteLocalGroupAttributes",value:function(e){this._hasLocalGroupAttributes(e)&&this._groupAttributesMap.delete(e)}},{key:"reset",value:function(){this._groupAttributesMap.clear(),this.CACHE_EXPIRE_TIME=3e4}}]),e}(),GC="Set",UC="Increase",xC="Decrease",FC=function(){function e(t){r(this,e),this._groupModule=t,this._n="GroupCountersHandler",this._groupCountersMap=new Map,this.EXPIRE_TIME=3e4,this._groupModule.getInnerEmitterInstance().on(iC,this._onCloudConfigUpdated,this)}return a(e,[{key:"_onCloudConfigUpdated",value:function(){var e=this._groupModule.getCloudConfig("grp_counter_expire_time");id(e)||(this.EXPIRE_TIME=Number(e))}},{key:"isGroupCountersNotice",value:function(e){var t=e.to,n=e.elements.groupCounterInfo,o=!1;return Yd(n)||(this._onGroupCountersUpdated({groupID:t,groupCounterInfo:n}),o=!0),o}},{key:"_onGroupCountersUpdated",value:function(e){var t=this,n=e.groupID;e.groupCounterInfo.forEach((function(e){var o=e.type,r=e.groupCounterSeq,i=e.counterList,a=void 0===i?[]:i;0!==o&&2!==o||(t._updateLocalGroupCounters({groupID:n,groupCounterSeq:r,counterList:a}),a.forEach((function(e){t._groupModule.emitOuterEvent(Mr.GROUP_COUNTER_UPDATED,{groupID:n,key:e.key,value:e.value})}))),1===o&&t._deleteLocalGroupCounters({groupID:n,groupCounterSeq:r,counterList:a})})),Gl.l("".concat(this._n,"._onGroupCountersUpdated groupID:").concat(n))}},{key:"initGroupCountersCache",value:function(e){var t=e.groupID,n=e.avChatRoomKey;this._groupCountersMap.set(t,{lastUpdateTime:0,groupCounterSeq:0,counters:new Map,avChatRoomKey:n}),Gl.l("".concat(this._n,".initGroupCountersCache groupID:").concat(t," avChatRoomKey:").concat(n))}},{key:"setGroupCounters",value:function(e){var t=this;if(!this._groupModule.canIUse(Uc.GRP_COUNTER))return BI({code:p_});var n="".concat(this._n,".setGroupCounters"),o=e.groupID,r=e.counters,i=this._convertObjectToList(r),a=this._getLocalGroupCounters(o).avChatRoomKey,s="groupID:".concat(o," count:").concat(i.length),u=new w_("setGroupCounters");return u.setMessage("".concat(s)),Gl.l("".concat(n,". ").concat(s)),this._updateGroupCounters({groupID:o,counterList:i,avChatRoomKey:a,mode:GC}).then((function(e){return u.end(),Gl.l("".concat(n," ok.")),GI({counters:e})})).catch((function(e){return t._groupModule.probeNetwork().then((function(t){var n=_(t,2),o=n[0],r=n[1];u.setError(e,o,r).end()})),Gl.e("".concat(n," failed. error:"),e),BI(e)}))}},{key:"increaseGroupCounter",value:function(e){var t=this;if(!this._groupModule.canIUse(Uc.GRP_COUNTER))return BI({code:p_});var n="".concat(this._n,".increaseGroupCounters"),o=e.groupID,r=e.key,i=e.value,a=this._getLocalGroupCounters(o).avChatRoomKey,s="groupID:".concat(o," key:").concat(r," value:").concat(i),u=new w_("increaseGroupCounter");u.setMessage("".concat(s)),Gl.l("".concat(n,". ").concat(s));var c=[{key:r,value:i}];return this._updateGroupCounters({groupID:o,counterList:c,avChatRoomKey:a,mode:UC}).then((function(e){return u.end(),Gl.l("".concat(n," ok.")),GI({counters:e})})).catch((function(e){return t._groupModule.probeNetwork().then((function(t){var n=_(t,2),o=n[0],r=n[1];u.setError(e,o,r).end()})),Gl.e("".concat(n," failed. error:"),e),BI(e)}))}},{key:"decreaseGroupCounter",value:function(e){var t=this;if(!this._groupModule.canIUse(Uc.GRP_COUNTER))return BI({code:p_});var n="".concat(this._n,".decreaseGroupCounter"),o=e.groupID,r=e.key,i=e.value,a=this._getLocalGroupCounters(o).avChatRoomKey,s="groupID:".concat(o," key:").concat(r," value:").concat(i),u=new w_("decreaseGroupCounter");u.setMessage("".concat(s)),Gl.l("".concat(n,". ").concat(s));var c=[{key:r,value:i}];return this._updateGroupCounters({groupID:o,counterList:c,avChatRoomKey:a,mode:xC}).then((function(e){return u.end(),Gl.l("".concat(n," ok.")),GI({counters:e})})).catch((function(e){return t._groupModule.probeNetwork().then((function(t){var n=_(t,2),o=n[0],r=n[1];u.setError(e,o,r).end()})),Gl.e("".concat(n," failed. error:"),e),BI(e)}))}},{key:"getGroupCounters",value:function(e){var t=this;if(!this._groupModule.canIUse(Uc.GRP_COUNTER))return BI({code:p_});var n="".concat(this._n,".getGroupCounters"),o=e.groupID,r=e.keyList,i=void 0===r?[]:r,a=this._getLocalGroupCounters(o),s=a.avChatRoomKey,u=a.lastUpdateTime,c=new w_("getGroupCounters");if(c.setMessage("groupID:".concat(o)),Date.now()-u>=this.EXPIRE_TIME)return this._getRemoteGroupCounters({groupID:o,avChatRoomKey:s}).then((function(e){c.setMoreMessage("from remote. count:".concat(e.length)).end(),Gl.l("".concat(n," from remote. groupID:").concat(o));var r=t._getLocalCounters(o,i);return GI({counters:r})})).catch((function(e){return t._groupModule.probeNetwork().then((function(t){var n=_(t,2),o=n[0],r=n[1];c.setError(e,o,r).end()})),BI(e)}));c.setMoreMessage("from cache").end(),Gl.l("".concat(n," from cache. groupID:").concat(o));var l=this._getLocalCounters(o,i);return qI({counters:l})}},{key:"_getRemoteGroupCounters",value:function(e){var n=this;return this._groupModule.request({protocolName:Jg,requestData:t({},e)}).then((function(t){var o=t.data,r=o.counterList,i=void 0===r?[]:r,a=o.groupCounterSeq;return n._updateLocalGroupCounters({groupID:e.groupID,counterList:i,groupCounterSeq:a}),Gl.l("".concat(n._n,"._getRemoteGroupCounters ok. groupID:").concat(e.groupID)),i})).catch((function(e){return BI(e)}))}},{key:"_convertObjectToList",value:function(e){var t=[];return Object.keys(e).forEach((function(n){t.push({key:n,value:e[n]})})),t}},{key:"_updateGroupCounters",value:function(e){var n="".concat(this._n,"._updateGroupCounters"),o=e.groupID,r=e.avChatRoomKey,i=e.mode;return Gl.l("".concat(n,". groupID:").concat(o," avChatRoomKey:").concat(r," mode:").concat(i)),this._groupModule.request({protocolName:Yg,requestData:t({},e)}).then((function(e){Gl.l("".concat(n," ok."));var t=e.data.counterList,o={};return(void 0===t?[]:t).forEach((function(e){var t=e.key,n=e.value;o[t]=n})),o})).catch((function(e){return BI(e)}))}},{key:"_hasLocalGroupCounters",value:function(e){return this._groupCountersMap.has(e)}},{key:"_getLocalGroupCounters",value:function(e){return this._hasLocalGroupCounters(e)||this.initGroupCountersCache({groupID:e}),this._groupCountersMap.get(e)}},{key:"_updateLocalGroupCounters",value:function(e){var t=e.groupID,n=e.counterList,o=void 0===n?[]:n,r=e.groupCounterSeq;if(this._hasLocalGroupCounters(t)){var i=this._getLocalGroupCounters(t),a=i.counters,s=i.avChatRoomKey,u=i.groupCounterSeq;if(r>0&&r<u)return;o.forEach((function(e){var t=e.key,n=e.value;a.set(t,n)})),this._groupCountersMap.set(t,{lastUpdateTime:Date.now(),groupCounterSeq:r,counters:a,avChatRoomKey:s})}}},{key:"_deleteLocalGroupCounters",value:function(e){var t=e.groupID,n=e.counterList,o=void 0===n?[]:n,r=e.groupCounterSeq;if(this._hasLocalGroupCounters(t)){var i=this._getLocalGroupCounters(t),a=i.counters,s=i.avChatRoomKey;o.forEach((function(e){a.delete(e.key)})),this._groupCountersMap.set(t,{lastUpdateTime:Date.now(),groupCounterSeq:r,counters:a,avChatRoomKey:s})}}},{key:"_getLocalCounters",value:function(e,t){var n={};if(!this._hasLocalGroupCounters(e))return n;var o=this._getLocalGroupCounters(e).counters;if(t.length>0)t.forEach((function(e){o.has(e)&&(n[e]=o.get(e))}));else{var r,i=S(o.keys());try{for(i.s();!(r=i.n()).done;){var a=r.value;n[a]=o.get(a)}}catch(u){i.e(u)}finally{i.f()}}return n}},{key:"reset",value:function(){this._groupCountersMap.clear(),this.EXPIRE_TIME=3e4}}]),e}(),qC=function(){function e(t){r(this,e);var n=t.manager,o=t.groupID,i=t.onInit,a=t.onSuccess,s=t.onFail;this._n="Polling",this._manager=n,this._groupModule=n._groupModule,this._onInit=i,this._onSuccess=a,this._onFail=s,this._groupID=o,this._timeoutID=-1,this._isRunning=!1,this._protocolName=Gg}return a(e,[{key:"start",value:function(){var e=this._groupModule.isLoggedIn();e||(this._protocolName=Ug),Gl.l("".concat(this._n,".start pollingInterval:").concat(this._manager.getPollingInterval()," isLoggedIn:").concat(e)),this._isRunning=!0,this._request()}},{key:"isRunning",value:function(){return this._isRunning}},{key:"_request",value:function(){var e=this,t=this._onInit(this._groupID);this._groupModule.request({protocolName:this._protocolName,requestData:t}).then((function(t){e._onSuccess(e._groupID,t),e.isRunning()&&(clearTimeout(e._timeoutID),e._timeoutID=setTimeout(e._request.bind(e),e._manager.getPollingInterval()))})).catch((function(t){e._onFail(e._groupID,t),e.isRunning()&&(clearTimeout(e._timeoutID),e._timeoutID=setTimeout(e._request.bind(e),e._manager.MAX_POLLING_INTERVAL))}))}},{key:"stop",value:function(){Gl.l("".concat(this._n,".stop")),this._timeoutID>0&&(clearTimeout(this._timeoutID),this._timeoutID=-1),this._isRunning=!1}}]),e}(),BC={3:!0,4:!0,5:!0,6:!0,17:!0},VC=function(){function e(t){r(this,e),this._groupModule=t,this._n="AVChatRoomHandler",this._joinedGroupMap=new Map,this._pollingRequestInfoMap=new Map,this._pollingInstanceMap=new Map,this.sequencesLinkedList=new vC(200),this.messageIDLinkedList=new vC(100),this.receivedMessageCount=0,this._reportMessageStackedCount=0,this._onlineMemberCountMap=new Map,this.DEFAULT_EXPIRE_TIME=60,this.DEFAULT_POLLING_INTERVAL=300,this.MAX_POLLING_INTERVAL=2e3,this._pollingInterval=this.DEFAULT_POLLING_INTERVAL,this.DEFAULT_POLLING_NO_MESSAGE_COUNT=20,this.DEFAULT_POLLING_INTERVAL_PLUS=2e3,this._pollingNoMessageCount=0,this._startBroadcastSeq=1,this._broadcastMessageIDMap=new Map}return a(e,[{key:"hasJoinedAVChatRoom",value:function(){return this._joinedGroupMap.size>0}},{key:"checkJoinedAVChatRoomByID",value:function(e){return this._joinedGroupMap.has(e)}},{key:"getJoinedAVChatRoom",value:function(){return this._joinedGroupMap.size>0?y(this._joinedGroupMap.keys()):null}},{key:"_updateRequestData",value:function(e){var n=this._pollingRequestInfoMap.get(e);return e===y(this._pollingInstanceMap.keys())[0]?t(t({},n),{},{startBroadcastSeq:this._startBroadcastSeq}):t({},n)}},{key:"_handleSuccess",value:function(e,t){var n=t.data,o=n.key,r=n.nextSeq,i=n.rspMsgList,a=n.errorCode,s=n.nextBroadcastSeq,u=n.broadcastMessageList;if(0!==a){var c=this._pollingRequestInfoMap.get(e),l=new w_("longPollingAVError"),d=c?"".concat(c.key,"-").concat(c.startSeq):"requestInfo is undefined";l.setMessage("".concat(e,"-").concat(d,"-").concat(t.errorInfo)).setCode(t.errorCode).setNetworkType(this._groupModule.getNetworkType()).end(!0)}else{if(!this.checkJoinedAVChatRoomByID(e))return;td(o)&&ed(r)&&this._pollingRequestInfoMap.set(e,{key:o,startSeq:r}),ed(s)&&s>this._startBroadcastSeq&&(this._startBroadcastSeq=s),rd(i)&&i.length>0?(i.forEach((function(e){e.to=e.groupID})),this.onMessage(i)):(this._pollingNoMessageCount+=1,this._pollingNoMessageCount===this.DEFAULT_POLLING_NO_MESSAGE_COUNT&&(this._pollingInterval=this.DEFAULT_POLLING_INTERVAL+this.DEFAULT_POLLING_INTERVAL_PLUS)),this._onBroadcastMessage(u)}}},{key:"_handleFailure",value:function(e,t){}},{key:"onMessage",value:function(e){if(rd(e)&&0!==e.length){0!==this._pollingNoMessageCount&&(this._pollingNoMessageCount=0,this._pollingInterval=this.DEFAULT_POLLING_INTERVAL);var t=null,n=[],o=this._getModule(Wf),r=this._getModule(ch),i=e.length;i>1&&e.sort((function(e,t){return e.sequence-t.sequence}));for(var a=this._getModule(Yf),s=0;s<i;s++)if(BC[e[s].event]){if(6===e[s].event){if(this._groupModule.isGroupAttributesUpdatedNotice(e[s]))continue;if(this._groupModule.isGroupCountersNotice(e[s]))continue}this.receivedMessageCount+=1,t=this.packMessage(e[s],e[s].event);var u=1===e[s].isModified,c=1===e[s].isHistoryMessage;if((a.isUnlimitedAVChatRoom()||!this.sequencesLinkedList.has(t.sequence))&&!this.messageIDLinkedList.has(t.ID)){var l=t.conversationID;if(this.receivedMessageCount%50==0?this._getModule(ih).detectFirstRound(l,this.sequencesLinkedList.data()):this.receivedMessageCount%80==0&&this._getModule(ih).detectSecondRound(l,this.sequencesLinkedList.data()),null!==this.sequencesLinkedList.tail()){var d=this.sequencesLinkedList.tail().value,p=t.sequence-d;p>1&&p<=20?this._getModule(ih).onMessageMaybeLost(l,d+1,p-1):p<-1&&p>=-20&&this._getModule(ih).onMessageMaybeLost(l,t.sequence+1,Math.abs(p)-1)}this.sequencesLinkedList.set(t.sequence),this.messageIDLinkedList.set(t.ID);var f=!1;if(this._isMessageSentByCurrentInstance(t)?u&&(f=!0,t.isModified=u,o.updateMessageIsModifiedProperty(t)):f=!0,f){if(t.conversationType===Ir.CONV_SYSTEM&&5===t.payload.operationType&&this._onGroupDismissed(t.payload.groupProfile.groupID),!c&&t.conversationType!==Ir.CONV_SYSTEM){var h=t.conversationID.replace(Ir.CONV_GROUP,"");this._pollingInstanceMap.has(h)?this._groupModule.isLoggedIn()&&r.addMessageSequence({key:D_,message:t}):(t.type!==Ir.MSG_GRP_TIP&&t.clientTime>0&&r.addMessageDelay(t.clientTime),r.addMessageSequence({key:b_,message:t}))}n.push(t)}}}else Gl.w("".concat(this._n,".onMessage unknown event:").concat(e[s].event));if(0!==n.length){this._groupModule.filterModifiedMessage(n);var g=this.packConversationOption(n);g.length>0&&this._getModule(Wf).onNewMessage({conversationOptionsList:g,isInstantMessage:!0}),Gl.d("".concat(this._n,".onMessage count:").concat(n.length)),this._checkMessageStacked(n);var v=this._groupModule.filterUnmodifiedMessage(n);v.length>0&&this._groupModule.emitOuterEvent(Mr.MESSAGE_RECEIVED,v),n.length=0}}}},{key:"_onGroupDismissed",value:function(e){Gl.l("".concat(this._n,"._onGroupDismissed groupID:").concat(e)),this._groupModule.deleteLocalGroupAndConversation(e),this.reset(e)}},{key:"_checkMessageStacked",value:function(e){var t="MessageStacked",n=e.length;n>=100&&(this._groupModule.outputWarning(t),this._reportMessageStackedCount<5&&(new w_(t).setNetworkType(this._groupModule.getNetworkType()).setMessage("count:".concat(n," groupID:").concat(y(this._joinedGroupMap.keys()))).setLevel("warning").end(),this._reportMessageStackedCount+=1))}},{key:"_isMessageSentByCurrentInstance",value:function(e){return!!this._getModule(Wf).isMessageSentByCurrentInstance(e)}},{key:"packMessage",value:function(e,t){e.currentUser=this._groupModule.getMyUserID(),e.conversationType=5===t?Ir.CONV_SYSTEM:Ir.CONV_GROUP,e.isSystemMessage=!!e.isSystemMessage;var n=new PI(e),o=this.packElements(e,t);return n.setElement(o),n}},{key:"packElements",value:function(e,n){return 4===n||6===n?(this._updateMemberCountByGroupTips(e),{type:Ir.MSG_GRP_TIP,content:t(t({},e.elements),{},{groupProfile:e.groupProfile})}):5===n?{type:Ir.MSG_GRP_SYS_NOTICE,content:t(t({},e.elements),{},{groupProfile:t(t({},e.groupProfile),{},{groupID:e.groupID})})}:this._getModule(Qf).parseElements(e.elements,e.from)}},{key:"packConversationOption",value:function(e){for(var t=new Map,n=0;n<e.length;n++){var o=e[n],r=o.conversationID;if(t.has(r)){var i=t.get(r);i.lastMessage=o,"in"===o.flow&&i.unreadCount++}else t.set(r,{conversationID:o.conversationID,unreadCount:"out"===o.flow?0:1,type:o.conversationType,subType:o.conversationSubType,lastMessage:o})}return y(t.values())}},{key:"_updateMemberCountByGroupTips",value:function(e){var t=e.groupProfile.groupID,n=e.elements.onlineMemberInfo,o=void 0===n?void 0:n;if(!Yd(o)){var r=o.onlineMemberNum,i=void 0===r?0:r,a=o.expireTime,s=void 0===a?this.DEFAULT_EXPIRE_TIME:a,u=this._onlineMemberCountMap.get(t)||{},c=Date.now();Yd(u)?Object.assign(u,{lastReqTime:0,lastSyncTime:0,latestUpdateTime:c,memberCount:i,expireTime:s}):(u.latestUpdateTime=c,u.memberCount=i),Gl.d("".concat(this._n,"._updateMemberCountByGroupTips info:"),u),this._onlineMemberCountMap.set(t,u)}}},{key:"_onBroadcastMessage",value:function(e){if(!Yd(e)){for(var t=[],n=e.length,o=null,r=0;r<n;r++)BC[e[r].event]?((o=this.packMessage(e[r],e[r].event)).isBroadcastMessage=!0,this._broadcastMessageIDMap.has(o.ID)||(t.push(o),this._broadcastMessageIDMap.set(o.ID,1))):Gl.w("".concat(this._n,"._onBroadcastMessage unknown event:").concat(e[r].event));t.length>0&&this._groupModule.emitOuterEvent(Mr.MESSAGE_RECEIVED,t)}}},{key:"start",value:function(e){if(this._pollingInstanceMap.has(e)){var t=this._pollingInstanceMap.get(e);t.isRunning()||t.start()}else{var n=new qC({manager:this,groupID:e,onInit:this._updateRequestData.bind(this),onSuccess:this._handleSuccess.bind(this),onFail:this._handleFailure.bind(this)});n.start(),this._pollingInstanceMap.set(e,n),Gl.l("".concat(this._n,".start groupID:").concat(e))}}},{key:"handleJoinResult",value:function(e){var t=this;return this._preCheck().then((function(){var n=e.longPollingKey,o=e.group,r=o.groupID;return t._joinedGroupMap.set(r,o),t._groupModule.updateGroupMap([o]),t._groupModule.deleteUnjoinedAVChatRoom(r),t._groupModule.emitGroupListUpdate(!0,!1),id(n)?qI({status:Zl,group:o}):Promise.resolve()}))}},{key:"startRunLoop",value:function(e){var t=this;return this.handleJoinResult(e).then((function(){var n=e.longPollingKey,o=e.group,r=e.startSeq,i=void 0===r?0:r,a=o.groupID;return t._pollingRequestInfoMap.set(a,{key:n,startSeq:i}),t.start(a),t._groupModule.isLoggedIn()?qI({status:Zl,group:o}):qI({status:Zl})}))}},{key:"_preCheck",value:function(){if(this._getModule(Yf).isUnlimitedAVChatRoom())return Promise.resolve();if(!this.hasJoinedAVChatRoom())return Promise.resolve();var e=_(this._joinedGroupMap.entries().next().value,2),t=e[0],n=e[1];if(this._groupModule.isLoggedIn()){if(n.selfInfo.role!==Ir.GRP_MBR_ROLE_OWNER&&n.ownerID!==this._groupModule.getMyUserID())return this._groupModule.quitGroup(t);this._groupModule.deleteLocalGroupAndConversation(t)}else this._groupModule.deleteLocalGroupAndConversation(t);return this.reset(t),Promise.resolve()}},{key:"joinWithoutAuth",value:function(e){var t=this,n=e.groupID,o="".concat(this._n,".").concat("joinWithoutAuth"),r=new w_("joinWithoutAuth");return this._groupModule.request({protocolName:Mg,requestData:e}).then((function(e){var i=e.data.longPollingKey;if(t._groupModule.probeNetwork().then((function(e){var t=_(e,2),o=(t[0],t[1]);r.setNetworkType(o).setMessage("groupID:".concat(n," longPollingKey:").concat(i)).end(!0)})),id(i))return BI({code:Nm});Gl.l("".concat(o," ok. groupID:").concat(n)),t._getModule(Wf).setCompleted("".concat(Ir.CONV_GROUP).concat(n));var a=new _C({groupID:n});return t.startRunLoop({group:a,longPollingKey:i}),GI({status:Zl})})).catch((function(e){return Gl.e("".concat(o," failed. groupID:").concat(n," error:"),e),t._groupModule.probeNetwork().then((function(t){var o=_(t,2),i=o[0],a=o[1];r.setError(e,i,a).setMessage("groupID:".concat(n)).end(!0)})),BI(e)})).finally((function(){t._groupModule.getModule(Xf).reportAtOnce()}))}},{key:"getGroupOnlineMemberCount",value:function(e){var t=this._onlineMemberCountMap.get(e)||{},n=Date.now();return Yd(t)||n-t.lastSyncTime>1e3*t.expireTime&&n-t.latestUpdateTime>1e4&&n-t.lastReqTime>3e3?(t.lastReqTime=n,this._onlineMemberCountMap.set(e,t),this._getGroupOnlineMemberCount(e).then((function(e){return GI({memberCount:e.memberCount})})).catch((function(e){return BI(e)}))):qI({memberCount:t.memberCount})}},{key:"_getGroupOnlineMemberCount",value:function(e){var t=this,n="".concat(this._n,".").concat("_getGroupOnlineMemberCount");return this._groupModule.request({protocolName:xg,requestData:{groupID:e}}).then((function(o){var r=t._onlineMemberCountMap.get(e)||{},i=o.data,a=i.onlineMemberNum,s=void 0===a?0:a,u=i.expireTime,c=void 0===u?t.DEFAULT_EXPIRE_TIME:u;Gl.l("".concat(n," ok. groupID:").concat(e," memberCount:").concat(s," expireTime:").concat(c));var l=Date.now();return Yd(r)&&(r.lastReqTime=l),t._onlineMemberCountMap.set(e,Object.assign(r,{lastSyncTime:l,latestUpdateTime:l,memberCount:s,expireTime:c})),{memberCount:s}})).catch((function(o){return Gl.w("".concat(n," failed. error:"),o),new w_("_getGroupOnlineMemberCount").setCode(o.code).setMessage("groupID:".concat(e," error:").concat(JSON.stringify(o))).setNetworkType(t._groupModule.getNetworkType()).end(),Promise.reject(o)}))}},{key:"_getModule",value:function(e){return this._groupModule.getModule(e)}},{key:"setPollingInterval",value:function(e){id(e)||(ed(e)?this._pollingInterval=this.DEFAULT_POLLING_INTERVAL=e:this._pollingInterval=this.DEFAULT_POLLING_INTERVAL=parseInt(e,10))}},{key:"setPollingIntervalPlus",value:function(e){id(e)||(ed(e)?this.DEFAULT_POLLING_INTERVAL_PLUS=e:this.DEFAULT_POLLING_INTERVAL_PLUS=parseInt(e,10))}},{key:"setPollingNoMessageCount",value:function(e){id(e)||(ed(e)?this.DEFAULT_POLLING_NO_MESSAGE_COUNT=e:this.DEFAULT_POLLING_NO_MESSAGE_COUNT=parseInt(e,10))}},{key:"getPollingInterval",value:function(){return this._pollingInterval}},{key:"onAVChatRoomMemberBanned",value:function(e){var t=e.payload.groupProfile.groupID;Gl.l("".concat(this._n,".onAVChatRoomMemberBanned groupID:").concat(t)),this._groupModule.deleteLocalGroupAndConversation(t),this.reset(t)}},{key:"restartPolling",value:function(){Gl.l("".concat(this._n,".restartPolling count:").concat(this._pollingInstanceMap.size));var e,t=S(this._pollingInstanceMap.values());try{for(t.s();!(e=t.n()).done;){var n=e.value;n.stop(),n.start()}}catch(r){t.e(r)}finally{t.f()}}},{key:"reset",value:function(e){if(e){Gl.l("".concat(this._n,".reset groupID:").concat(e));var t=this._pollingInstanceMap.get(e);t&&t.stop(),this._pollingInstanceMap.delete(e),this._joinedGroupMap.delete(e),this._pollingRequestInfoMap.delete(e),this._onlineMemberCountMap.delete(e)}else{Gl.l("".concat(this._n,".reset all"));var n,o=S(this._pollingInstanceMap.values());try{for(o.s();!(n=o.n()).done;)n.value.stop()}catch(i){o.e(i)}finally{o.f()}this._pollingInstanceMap.clear(),this._joinedGroupMap.clear(),this._pollingRequestInfoMap.clear(),this._onlineMemberCountMap.clear(),this._broadcastMessageIDMap.clear()}this.sequencesLinkedList.reset(),this.messageIDLinkedList.reset(),this.receivedMessageCount=0,this._reportMessageStackedCount=0,this._pollingInterval=this.DEFAULT_POLLING_INTERVAL=300,this.DEFAULT_POLLING_NO_MESSAGE_COUNT=20,this.DEFAULT_POLLING_INTERVAL_PLUS=2e3,this._pollingNoMessageCount=0}}]),e}(),HC=1,KC=15,jC=function(){function e(t){r(this,e),this._groupModule=t,this._n="GroupSystemNoticeHandler",this.pendencyMap=new Map}return a(e,[{key:"onNewGroupSystemNotice",value:function(e){var t=e.dataList,n=e.isSyncingEnded,o=e.isInstantMessage;Gl.d("".concat(this._n,".onReceiveSystemNotice count:").concat(t.length));var r=this.newSystemNoticeStoredAndSummary({notifiesList:t,isInstantMessage:o}),i=r.eventDataList,a=r.result;i.length>0&&(this._groupModule.getModule(Wf).onNewMessage({conversationOptionsList:i,isInstantMessage:o}),this._onReceivedGroupSystemNotice({result:a,isInstantMessage:o})),o?a.length>0&&this._groupModule.emitOuterEvent(Mr.MESSAGE_RECEIVED,a):!0===n&&this._clearGroupSystemNotice()}},{key:"newSystemNoticeStoredAndSummary",value:function(e){var n=e.notifiesList,o=e.isInstantMessage,r=null,i=n.length,a=0,s=[],u={conversationID:Ir.CONV_SYSTEM,unreadCount:0,type:Ir.CONV_SYSTEM,subType:null,lastMessage:null};for(a=0;a<i;a++){var c=n[a],l=c.groupProfile,d=l.communityType,p=void 0===d?0:d,f=l.topicID,h=void 0===f?void 0:f,g=c.elements,v=g.topicIDList,m=void 0===v?void 0:v,_=g.operationType;if(!(2!==p||Yd(h)&&Yd(m))){if([17,18,20].includes(_)){this._handleTopicSystemNotice(c);continue}Yd(h)||(c.to=h)}c.elements.operationType!==KC&&(c.currentUser=this._groupModule.getMyUserID(),c.conversationType=Ir.CONV_SYSTEM,c.conversationID=Ir.CONV_SYSTEM,(r=new PI(c)).setElement({type:Ir.MSG_GRP_SYS_NOTICE,content:t(t({},c.elements),{},{groupProfile:t({},c.groupProfile)})}),r.isSystemMessage=!0,(1===r.sequence&&1===r.random||2===r.sequence&&2===r.random)&&(r.sequence=vd(),r.random=vd(),r.generateMessageID(),Gl.l("".concat(this._n,".newSystemNoticeStoredAndSummary sequence and random maybe duplicated, regenerate. ID:").concat(r.ID))),this._groupModule.getModule(Wf).pushIntoNoticeResult(s,r)&&(o?u.unreadCount++:r.setIsRead(!0),u.subType=r.conversationSubType))}return u.lastMessage=s[s.length-1],{eventDataList:s.length>0?[u]:[],result:s}}},{key:"_clearGroupSystemNotice",value:function(){var e=this;this._getPendencyList().then((function(t){t.forEach((function(t){e.pendencyMap.set("".concat(t.from,"_").concat(t.groupID,"_").concat(t.to),t)}));var n=e._groupModule.getModule(Wf).getLocalMessageList(Ir.CONV_SYSTEM),o=[];n.forEach((function(t){var n=t.payload,r=n.operatorID,i=n.operationType,a=n.groupProfile;if(i===HC){var s="".concat(r,"_").concat(a.groupID,"_").concat(a.to),u=e.pendencyMap.get(s);u&&ed(u.handled)&&0!==u.handled&&o.push(t)}})),e.deleteGroupSystemNotice({messageList:o})}))}},{key:"deleteGroupSystemNotice",value:function(e){var t=this,n="".concat(this._n,".deleteGroupSystemNotice");return rd(e.messageList)&&0!==e.messageList.length?(Gl.l("".concat(n," ")+e.messageList.map((function(e){return e.ID}))),this._groupModule.request({protocolName:Pg,requestData:{messageListToDelete:e.messageList.map((function(e){return{from:Ir.CONV_SYSTEM,messageSeq:e.clientSequence,messageRandom:e.random}}))}}).then((function(){Gl.l("".concat(n," ok"));var o=t._groupModule.getModule(Wf);return e.messageList.forEach((function(e){o.deleteLocalMessage(e)})),GI()})).catch((function(e){return Gl.e("".concat(n," error:"),e),BI(e)}))):qI()}},{key:"_getPendencyList",value:function(e){var t=this;return this._groupModule.request({protocolName:Ng,requestData:{startTime:e&&e.startTime?e.startTime:0,limit:e&&e.limit?e.limit:10,handleAccount:this._groupModule.getMyUserID()}}).then((function(e){var n=e.data.pendencyList;return 0!==e.data.nextStartTime?t._getPendencyList({startTime:e.data.nextStartTime}).then((function(e){return[].concat(y(n),y(e))})):n}))}},{key:"getGroupApplicationList",value:function(){var e=this;return this._getPendencyList().then((function(t){var n=[];return t.forEach((function(t){e.pendencyMap.set("".concat(t.from,"_").concat(t.groupID,"_").concat(t.to),t),0===t.handled&&n.push({applicant:t.from,applicantNick:t.fromUserNickName,groupName:t.groupName,groupID:t.groupID,authentication:t.authentication,messageKey:t.time})})),qI({applicationList:n})}))}},{key:"_onReceivedGroupSystemNotice",value:function(e){var t=this,n=e.result;e.isInstantMessage&&n.forEach((function(e){switch(e.payload.operationType){case 1:case 3:case 6:case 11:case 12:case 15:break;case 2:t._onApplyGroupRequestAgreed(e);break;case 4:t._onMemberKicked(e);break;case 5:t._onGroupDismissed(e);break;case 7:t._onInviteGroup(e);break;case 8:t._onQuitGroup(e);break;case 9:t._onSetManager(e);break;case 10:t._onDeleteManager(e);break;case 20:t._onMessageRemindTypeSynced(e);break;case 21:t._groupModule.onAVChatRoomMemberBanned(e)}}))}},{key:"_onApplyGroupRequestAgreed",value:function(e){var t=this,n=e.payload.groupProfile.groupID;this._groupModule.hasLocalGroup(n)||this._groupModule.getGroupProfile({groupID:n}).then((function(e){var n=e.data.group;if(n){t._groupModule.updateGroupMap([n]);var o=!n.isSupportTopic;t._groupModule.emitGroupListUpdate(!0,o)}}))}},{key:"_onMemberKicked",value:function(e){var t=e.payload.groupProfile.groupID;this._groupModule.hasLocalGroup(t)&&this._groupModule.deleteLocalGroupAndConversation(t)}},{key:"_onGroupDismissed",value:function(e){var t=e.payload.groupProfile.groupID;this._groupModule.hasLocalGroup(t)&&this._groupModule.deleteLocalGroupAndConversation(t);var n=this._groupModule._AVChatRoomHandler;n&&n.checkJoinedAVChatRoomByID(t)&&n.reset(t)}},{key:"_onInviteGroup",value:function(e){var t=this,n=e.payload.groupProfile.groupID;this._groupModule.hasLocalGroup(n)||this._groupModule.getGroupProfile({groupID:n}).then((function(e){var n=e.data.group;n&&(t._groupModule.updateGroupMap([n]),t._groupModule.emitGroupListUpdate())}))}},{key:"_onQuitGroup",value:function(e){var t=e.payload.groupProfile.groupID;this._groupModule.hasLocalGroup(t)&&this._groupModule.deleteLocalGroupAndConversation(t)}},{key:"_onSetManager",value:function(e){var t=e.payload.groupProfile,n=t.to,o=t.groupID,r=this._groupModule.getModule(zf).getLocalGroupMemberInfo(o,n);r&&r.updateRole(Ir.GRP_MBR_ROLE_ADMIN)}},{key:"_onDeleteManager",value:function(e){var t=e.payload.groupProfile,n=t.to,o=t.groupID,r=this._groupModule.getModule(zf).getLocalGroupMemberInfo(o,n);r&&r.updateRole(Ir.GRP_MBR_ROLE_MEMBER)}},{key:"_onMessageRemindTypeSynced",value:function(e){var t=e.payload.groupProfile.groupID,n=e.payload.messageRemindType;this._groupModule.getModule(Wf).onGroupMessageRemindTypeSynced({groupID:t,messageRemindType:n})}},{key:"_handleTopicSystemNotice",value:function(e){var t=e.groupProfile,n=t.groupID,o=t.topicID,r=e.elements,i=r.operationType,a=r.topicIDList,s=r.messageRemindType,u=this._groupModule.getModule(Zf);17===i?u.onTopicCreated({groupID:n,topicID:o}):18===i?u.onTopicDeleted({groupID:n,topicIDList:a}):20===i&&u.onTopicMessageRemindTypeUpdated({groupID:n,topicID:o,messageRemindType:s})}},{key:"reset",value:function(){this.pendencyMap.clear()}}]),e}(),zC=["relayFlag"],ZC=function(e){u(o,e);var n=m(o);function o(e){var t;return r(this,o),(t=n.call(this,e))._n="GroupModule",t._commonGroupHandler=null,t._AVChatRoomHandler=null,t._groupSystemNoticeHandler=null,t._commonGroupHandler=new AC(g(t)),t._groupAttributesHandler=new PC(g(t)),t._groupCountersHandler=new FC(g(t)),t._AVChatRoomHandler=new VC(g(t)),t._groupTipsHandler=new EC(g(t)),t._groupSystemNoticeHandler=new jC(g(t)),t.groupMap=new Map,t._unjoinedAVChatRoomList=new Map,t._receiptDetailCompleteMap=new Map,t.getInnerEmitterInstance().on(iC,t._onCloudConfigUpdated,g(t)),t}return a(o,[{key:"_onCloudConfigUpdated",value:function(){var e=this.getCloudConfig("polling_interval"),t=this.getCloudConfig("polling_interval_plus"),n=this.getCloudConfig("polling_no_msg_count");this._AVChatRoomHandler&&(Gl.l("".concat(this._n,"._onCloudConfigUpdated pollingInterval:").concat(e)+" pollingIntervalPlus:".concat(t," pollingNoMessageCount:").concat(n)),this._AVChatRoomHandler.setPollingInterval(e),this._AVChatRoomHandler.setPollingIntervalPlus(t),this._AVChatRoomHandler.setPollingNoMessageCount(n))}},{key:"onCheckTimer",value:function(e){this.isLoggedIn()&&(this._commonGroupHandler.onCheckTimer(e),this._groupTipsHandler.onCheckTimer(e))}},{key:"guardForAVChatRoom",value:function(e){var t=this;if(e.conversationType===Ir.CONV_GROUP){var n=Dd(e.to)?Vd(e.to):e.to;return this.hasLocalGroup(n)?qI():this.getGroupProfile({groupID:n}).then((function(o){var r=o.data.group.type;if(Gl.l("".concat(t._n,".guardForAVChatRoom. groupID:").concat(n," type:").concat(r)),r===Ir.GRP_AVCHATROOM){var i=Kv;return BI(new UI({code:i,message:t.getErrorMessage(i,e.from,n),data:{message:e}}))}return qI()}))}return qI()}},{key:"checkJoinedAVChatRoomByID",value:function(e){return!!this._AVChatRoomHandler&&this._AVChatRoomHandler.checkJoinedAVChatRoomByID(e)}},{key:"onNewGroupMessage",value:function(e){this._commonGroupHandler&&this._commonGroupHandler.onNewGroupMessage(e)}},{key:"updateNextMessageSeq",value:function(e){var t=this;if(rd(e)){var n=this.getModule(Zf);e.forEach((function(e){var o=e.conversationID.replace(Ir.CONV_GROUP,"");Dd(o)&&n.updateLastMessage(o,e.lastMessage),t.groupMap.has(o)&&(t.groupMap.get(o).nextMessageSeq=e.lastMessage.sequence+1)}))}}},{key:"onNewGroupTips",value:function(e){this._groupTipsHandler&&this._groupTipsHandler.onNewGroupTips(e)}},{key:"onGroupMessageRevoked",value:function(e){this._commonGroupHandler&&this._commonGroupHandler.onGroupMessageRevoked(e)}},{key:"onNewGroupSystemNotice",value:function(e){this._groupSystemNoticeHandler&&this._groupSystemNoticeHandler.onNewGroupSystemNotice(e)}},{key:"onGroupMessageReadNotice",value:function(e){var t=this;e.dataList.forEach((function(e){var n=e.elements.groupMessageReadNotice;if(!id(n)){var o=t.getModule(Wf);n.forEach((function(e){var n=e.groupID,r=e.topicID,i=void 0===r?void 0:r,a=e.lastMessageSeq;Gl.d("".concat(t._n,".onGroupMessageReadNotice groupID:").concat(n," lastMessageSeq:").concat(a));var s="".concat(Ir.CONV_GROUP).concat(n),u=!0;Yd(i)||(s="".concat(Ir.CONV_GROUP).concat(i),u=!1),o.updateIsReadAfterReadReport({conversationID:s,lastMessageSeq:a}),o.updateUnreadCount(s,u),o.clearGroupAtInfoList(s,u)}))}}))}},{key:"onReadReceiptList",value:function(e){var t=this;Gl.d("".concat(this._n,".onReadReceiptList options:"),JSON.stringify(e)),e.dataList.forEach((function(e){var n=e.groupProfile,o=e.elements,r=n.groupID,i=t.getModule(Wf),a=o.readReceiptList;i.updateReadReceiptInfo({groupID:r,readReceiptList:a})}))}},{key:"onGroupMessageModified",value:function(e){Gl.d("".concat(this._n,".onGroupMessageModified options:"),JSON.stringify(e));var n=this.getModule(Wf);e.dataList.forEach((function(e){n.onMessageModified(t(t({},e),{},{conversationType:Ir.CONV_GROUP,to:e.topicID?e.topicID:e.groupID}))}))}},{key:"deleteGroupSystemNotice",value:function(e){this._groupSystemNoticeHandler&&this._groupSystemNoticeHandler.deleteGroupSystemNotice(e)}},{key:"initGroupMap",value:function(e){this.groupMap.set(e.groupID,new _C(e))}},{key:"deleteGroup",value:function(e){this.groupMap.delete(e)}},{key:"updateGroupMap",value:function(e){var t,n=this,o=this.getModule(Wf);e.forEach((function(e){t=e.groupID,n.groupMap.has(t)?n.groupMap.get(t).updateGroup(e):(n.groupMap.set(t,new _C(e)),o.deleteGroupRomaingMessageInfo(t))}));var r,i=this.getMyUserID(),a=S(this.groupMap);try{for(a.s();!(r=a.n()).done;){var s=_(r.value,2)[1];s.selfInfo.userID=i,"Owner"===s.selfInfo.role&&(s.ownerID=i)}}catch(c){a.e(c)}finally{a.f()}this._setStorageGroupList()}},{key:"getStorageGroupList",value:function(){return this.getModule(Jf).getItem("groupMap")}},{key:"_setStorageGroupList",value:function(){var e=this.getLocalGroupList().filter((function(e){var t=e.type;return!Sd(t)})).filter((function(e){return!e.isSupportTopic})).slice(0,20).map((function(e){return{groupID:e.groupID,name:e.name,avatar:e.avatar,type:e.type}}));this.getModule(Jf).setItem("groupMap",e)}},{key:"getGroupMap",value:function(){return this.groupMap}},{key:"getLocalGroupList",value:function(){return y(this.groupMap.values())}},{key:"getLocalGroupProfile",value:function(e){return this.groupMap.get(e)}},{key:"sortLocalGroupList",value:function(){var e=y(this.groupMap).filter((function(e){var t=_(e,2);return t[0],!Yd(t[1].lastMessage)}));e.sort((function(e,t){return t[1].lastMessage.lastTime-e[1].lastMessage.lastTime})),this.groupMap=new Map(y(e))}},{key:"updateGroupLastMessage",value:function(e){this._commonGroupHandler&&this._commonGroupHandler.handleUpdateGroupLastMessage(e)}},{key:"emitGroupListUpdate",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this.getLocalGroupList();if(e&&this.emitOuterEvent(Mr.GROUP_LIST_UPDATED),t){var o=JSON.parse(JSON.stringify(n));this.getModule(Wf).updateConversationGroupProfile(o)}}},{key:"patchGroupMessageRemindType",value:function(){var e=this.getLocalGroupList(),t=this.getModule(Wf),n=0;e.forEach((function(e){!0===t.patchMessageRemindType({ID:e.groupID,isC2CConversation:!1,messageRemindType:e.selfInfo.messageRemindType})&&(n+=1)})),Gl.l("".concat(this._n,".patchGroupMessageRemindType count:").concat(n))}},{key:"recomputeUnreadCount",value:function(){var e=this.getLocalGroupList(),t=this.getModule(Wf);e.forEach((function(e){var n=e.groupID,o=e.selfInfo,r=o.excludedUnreadSequenceList,i=o.readedSequence;if(rd(r)){var a=0;r.forEach((function(t){t>=i&&t<=e.nextMessageSeq-1&&(a+=1)})),a>=1&&t.recomputeGroupUnreadCount({conversationID:"".concat(Ir.CONV_GROUP).concat(n),count:a})}}))}},{key:"getMyNameCardByGroupID",value:function(e){var t=this.getLocalGroupProfile(e);return t?t.selfInfo.nameCard:""}},{key:"isPagingGetCompleted",value:function(){return!!this._commonGroupHandler&&this._commonGroupHandler.isPagingGetCompleted()}},{key:"getGroupList",value:function(e){return this._commonGroupHandler?this._commonGroupHandler.getGroupList(e):qI()}},{key:"getGroupProfile",value:function(e){var t=this,n="".concat(this._n,".").concat("getGroupProfile"),o=new w_("getGroupProfile"),r=e.groupID,i=e.groupCustomFieldFilter;Gl.l("".concat(n," groupID:").concat(r));var a={groupIDList:[r],responseFilter:{groupBaseInfoFilter:["Type","Name","Introduction","Notification","FaceUrl","Owner_Account","CreateTime","InfoSeq","LastInfoTime","LastMsgTime","MemberNum","MaxMemberNum","ApplyJoinOption","NextMsgSeq","ShutUpAllMember"],groupCustomFieldFilter:i,memberInfoFilter:["Role","JoinTime","MsgSeq","MsgFlag","NameCard"]}};return this.getGroupProfileAdvance(a).then((function(e){var i,a=e.data,s=a.successGroupList,u=a.failureGroupList;return Gl.l("".concat(n," ok")),u.length>0?BI(u[0]):(Sd(s[0].type)&&!t.hasLocalGroup(r)?i=new _C(s[0]):(t.updateGroupMap(s),i=t.getLocalGroupProfile(r)),i.isSupportTopic||t.getModule(Wf).updateConversationGroupProfile([i]),o.setNetworkType(t.getNetworkType()).setMessage("groupID:".concat(r," type:").concat(i.type," muteAllMembers:").concat(i.muteAllMembers," ownerID:").concat(i.ownerID)).end(),GI({group:i}))})).catch((function(r){return t.probeNetwork().then((function(t){var n=_(t,2),i=n[0],a=n[1];o.setError(r,i,a).setMessage("groupID:".concat(e.groupID)).end()})),Gl.e("".concat(n," failed. error:"),r),BI(r)}))}},{key:"getGroupProfileAdvance",value:function(e){var n="".concat(this._n,".getGroupProfileAdvance"),o=e.groupIDList;rd(o)&&o.length>50&&(this.outputWarning("GetGroupProfileLimit"),o.length=50);var r=[],i=[];o.forEach((function(e){bd({groupID:e})?i.push(e):r.push(e)}));var a=[];if(r.length>0){var s=this._getGroupProfileAdvance(t(t({},e),{},{groupIDList:r}));a.push(s)}if(i.length>0){var u=this._getGroupProfileAdvance(t(t({},e),{},{groupIDList:i,relayFlag:r.length>0}));a.push(u)}return Promise.all(a).then((function(e){var t=[],n=[];return e.forEach((function(e){t.push.apply(t,y(e.successGroupList)),n.push.apply(n,y(e.failureGroupList))})),GI({successGroupList:t,failureGroupList:n})})).catch((function(e){return Gl.e("".concat(n," failed. error:"),e),BI(e)}))}},{key:"_getGroupProfileAdvance",value:function(e){var t=this,n=e.relayFlag,o=void 0!==n&&n,r=h(e,zC);return this.request({protocolName:gg,requestData:r}).then((function(e){Gl.l("".concat(t._n,"._getGroupProfileAdvance ok."));var n=e.data.groups;return{successGroupList:n.filter((function(e){return id(e.errorCode)||0===e.errorCode})),failureGroupList:n.filter((function(e){return e.errorCode&&0!==e.errorCode})).map((function(e){return new UI({code:e.errorCode,message:e.errorInfo,data:{groupID:e.groupID}})}))}})).catch((function(t){return o&&bd({groupID:e.groupIDList[0]})?{successGroupList:[],failureGroupList:[]}:BI(t)}))}},{key:"createGroup",value:function(e){var n=this,o="".concat(this._n,".").concat("createGroup"),r=e.type,i=e.groupID;if(e.name&&!1===this._filterProfanity("name",e))return BI({code:f_});if(e.introduction&&!1===this._filterProfanity("introduction",e))return BI({code:f_});if(e.notification&&!1===this._filterProfanity("notification",e))return BI({code:f_});if(!["Public","Private","ChatRoom","AVChatRoom","Community"].includes(r))return BI({code:Tm});if(!bd({type:r})){if(!Yd(i)&&bd({groupID:i}))return BI({code:bm});e.isSupportTopic=void 0}if(Sd(r)&&!id(e.memberList)&&e.memberList.length>0&&(e.memberList=void 0),Td(r)||id(e.joinOption)||(e.joinOption=void 0),bd({type:r})){if(!Yd(i)&&!bd({groupID:i}))return BI({code:bm});e.isSupportTopic=!0===e.isSupportTopic?1:0}var a=new w_("createGroup");Gl.l("".concat(o," options:"),e);var s=null,u=[];return this.request({protocolName:vg,requestData:t(t({},e),{},{ownerID:this.getMyUserID(),webPushFlag:1})}).then((function(r){var i=r.data,c=i.groupID,l=i.overLimitUserIDList,d=void 0===l?[]:l;if(s=c,u=d,a.setNetworkType(n.getNetworkType()).setMessage("groupType:".concat(e.type," groupID:").concat(c," overLimitUserIDList=").concat(d)).end(),Gl.l("".concat(o," ok groupID:").concat(c," overLimitUserIDList:"),d),e.type===Ir.GRP_AVCHATROOM)return n.getGroupProfile({groupID:c});if(e.type===Ir.GRP_COMMUNITY&&1===e.isSupportTopic)return n.getGroupProfile({groupID:c});Yd(e.memberList)||Yd(d)||(e.memberList=e.memberList.filter((function(e){return-1===d.indexOf(e.userID)}))),n.updateGroupMap([t(t({},e),{},{groupID:c})]);var p=n.getModule(qf),f=p.createCustomMessage({to:c,conversationType:Ir.CONV_GROUP,payload:{data:"group_create",extension:n.isIntl()?"".concat(n.getMyUserID()," created a group"):"".concat(n.getMyUserID(),"\u521b\u5efa\u7fa4\u7ec4")}});return p.sendMessageInstance(f),n.emitGroupListUpdate(),n.getGroupProfile({groupID:c})})).then((function(e){var t=e.data.group,n=t.selfInfo,o=n.nameCard,r=n.joinTime;return t.updateSelfInfo({nameCard:o,joinTime:r,messageRemindType:Ir.MSG_REMIND_ACPT_AND_NOTE,role:Ir.GRP_MBR_ROLE_OWNER}),GI({group:t,overLimitUserIDList:u})})).catch((function(r){if(a.setMessage("groupType:".concat(e.type)),n.probeNetwork().then((function(e){var t=_(e,2),n=t[0],o=t[1];a.setError(r,n,o).end()})),10010===r.code||10007===r.code){n.updateGroupMap([t(t({},e),{},{groupID:s})]);var i=n.getLocalGroupProfile(s);return Gl.l("".concat(o," success, but failed to get group profile.")),GI({group:i,overLimitUserIDList:u})}return Gl.e("".concat(o," failed. error:"),r),BI(r)}))}},{key:"dismissGroup",value:function(e){var t=this,n="".concat(this._n,".").concat("dismissGroup");if(this.hasLocalGroup(e)&&this.getLocalGroupProfile(e).type===Ir.GRP_WORK)return BI(new UI({code:Lm}));var o=new w_("dismissGroup");return o.setMessage("groupID:".concat(e)),Gl.l("".concat(n," groupID:").concat(e)),this.request({protocolName:mg,requestData:{groupID:e}}).then((function(){return o.setNetworkType(t.getNetworkType()).end(),Gl.l("".concat(n," ok")),t.deleteLocalGroupAndConversation(e),t.checkJoinedAVChatRoomByID(e)&&t._AVChatRoomHandler.reset(e),GI({groupID:e})})).catch((function(e){return t.probeNetwork().then((function(t){var n=_(t,2),r=n[0],i=n[1];o.setError(e,r,i).end()})),Gl.e("".concat(n," failed. error:"),e),BI(e)}))}},{key:"updateGroupProfile",value:function(e){var t=this,n="".concat(this._n,".").concat("updateGroupProfile");if(!this.hasLocalGroup(e.groupID)||Td(this.getLocalGroupProfile(e.groupID).type)||id(e.joinOption)||(Gl.w("".concat(n," joinOption is unavailable for Work/Meeting/AVChatRoom/Community")),e.joinOption=void 0),id(e.muteAllMembers)||(e.muteAllMembers?e.muteAllMembers="On":e.muteAllMembers="Off"),e.name&&!1===this._filterProfanity("name",e))return BI({code:f_});if(e.introduction&&!1===this._filterProfanity("introduction",e))return BI({code:f_});if(e.notification&&!1===this._filterProfanity("notification",e))return BI({code:f_});var o=new w_("updateGroupProfile");return o.setMessage(JSON.stringify(e)),Gl.l("".concat(n," groupID:").concat(e.groupID)),this.request({protocolName:_g,requestData:e}).then((function(){return o.setNetworkType(t.getNetworkType()).end(),Gl.l("".concat(n," ok")),t.hasLocalGroup(e.groupID)&&(t.groupMap.get(e.groupID).updateGroup(e),t._setStorageGroupList()),GI({group:t.groupMap.get(e.groupID)})})).catch((function(e){return t.probeNetwork().then((function(t){var n=_(t,2),r=n[0],i=n[1];o.setError(e,r,i).end()})),Gl.l("".concat(n," failed. error:"),e),BI(e)}))}},{key:"_filterProfanity",value:function(e,t){var n=this.getModule(ph);if(!n)return!0;var o=n.filterText(t[e],Kc),r=o.isAllowedToSend,i=o.modifiedText;return!0===r&&(t[e]=i,!0)}},{key:"joinGroup",value:function(e){var t=this,n=e.groupID,o=e.type,r="".concat(this._n,".joinGroup");if(o===Ir.GRP_WORK)return BI({code:Sm});if(this.deleteUnjoinedAVChatRoom(n),this.hasLocalGroup(n)){if(!this.isLoggedIn())return qI({status:Ir.JOIN_STATUS_ALREADY_IN_GROUP});var i=new w_("applyJoinGroup");return this.getGroupProfile({groupID:n}).then((function(){return i.setNetworkType(t.getNetworkType()).setMessage("groupID:".concat(n," joinedStatus:").concat(Ir.JOIN_STATUS_ALREADY_IN_GROUP)).end(),qI({status:Ir.JOIN_STATUS_ALREADY_IN_GROUP})})).catch((function(o){return i.setNetworkType(t.getNetworkType()).setMessage("groupID:".concat(n," unjoined")).end(),Gl.w("".concat(r," ").concat(n," was unjoined, now join!")),t.groupMap.delete(n),t.applyJoinGroup(e)}))}return Gl.l("".concat(r," groupID:").concat(n)),this.isLoggedIn()?this.applyJoinGroup(e):this._AVChatRoomHandler.joinWithoutAuth(e)}},{key:"applyJoinGroup",value:function(e){var n=this,o="".concat(this._n,".").concat("applyJoinGroup"),r=e.groupID;if(!Yd(e.applyMessage)&&!1===this._filterProfanity("applyMessage",e))return BI({code:f_});var i=new w_("applyJoinGroup"),a=t({},e),s=this.canIUse(Uc.AVCHATROOM_HISTORY_MSG);return s&&(a.historyMessageFlag=1),this.getModule(Wf).deleteTopicRoamingMessageInfo(r),this.request({protocolName:yg,requestData:a}).then((function(e){var t=e.data,a=t.joinedStatus,u=t.longPollingKey,c=t.startSeq,l=t.avChatRoomFlag,d=t.avChatRoomKey,p=t.messageList,f="groupID:".concat(r," joinedStatus:").concat(a," longPollingKey:").concat(u," startSeq:").concat(c)+" avChatRoomFlag:".concat(l," canGetAVChatRoomHistoryMessage:").concat(s,",")+" history message count:".concat(Yd(p)?0:p.length);switch(i.setNetworkType(n.getNetworkType()).setMessage("".concat(f)).end(),Gl.l("".concat(o," ok. ").concat(f)),a){case Wl:return GI({status:Wl});case Zl:return n.getGroupProfile({groupID:r}).then((function(e){var t=e.data.group;return n._handleJoinResult({group:t,avChatRoomFlag:l,longPollingKey:u,startSeq:c,avChatRoomKey:d,messageList:p})})).catch((function(){var e=new _C({groupID:r});return n._handleJoinResult({group:e,avChatRoomFlag:l,longPollingKey:u,startSeq:c,avChatRoomKey:d,messageList:p})}));default:var h=new UI({code:wm});return Gl.e("".concat(o," failed. error:"),h),BI(h)}})).catch((function(e){return i.setMessage("groupID:".concat(r)),n.probeNetwork().then((function(t){var n=_(t,2),o=n[0],r=n[1];i.setError(e,o,r).end()})),Gl.e("".concat(o," failed. error:"),e),BI(e)}))}},{key:"_handleJoinResult",value:function(e){var t,n=this,o=e.group,r=e.avChatRoomFlag,i=e.longPollingKey,a=e.startSeq,s=e.avChatRoomKey,u=e.messageList,c=o.groupID;return 1===r?(this.getModule(Wf).setCompleted("".concat(Ir.CONV_GROUP).concat(c)),this._groupAttributesHandler.initGroupAttributesCache({groupID:c,avChatRoomKey:s}),this._groupCountersHandler.initGroupCountersCache({groupID:c,avChatRoomKey:s}),(t=id(i)?this._AVChatRoomHandler.handleJoinResult({group:o}):this._AVChatRoomHandler.startRunLoop({group:o,longPollingKey:i,startSeq:a})).then((function(){n._onAVChatRoomHistoryMessage(u)})),t):(this.emitGroupListUpdate(!0,!1),GI({status:Zl,group:o}))}},{key:"quitGroup",value:function(e){var t=this,n="".concat(this._n,".").concat("quitGroup");Gl.l("".concat(n," groupID:").concat(e));var o=this.checkJoinedAVChatRoomByID(e);if(!o&&!this.hasLocalGroup(e))return BI({code:Rm});if(o&&!this.isLoggedIn())return Gl.l("".concat(n," anonymously ok. groupID:").concat(e)),this.deleteLocalGroupAndConversation(e),this._AVChatRoomHandler.reset(e),qI({groupID:e});var r=new w_("quitGroup");return r.setMessage("groupID:".concat(e)),this.request({protocolName:Ig,requestData:{groupID:e}}).then((function(){return r.setNetworkType(t.getNetworkType()).end(),Gl.l("".concat(n," ok")),t.deleteLocalGroupAndConversation(e),o&&t._AVChatRoomHandler.reset(e),t._groupAttributesHandler.deleteLocalGroupAttributes(e),GI({groupID:e})})).catch((function(e){return t.probeNetwork().then((function(t){var n=_(t,2),o=n[0],i=n[1];r.setError(e,o,i).end()})),Gl.e("".concat(n," failed. error:"),e),BI(e)}))}},{key:"searchGroupByID",value:function(e){var t=this,n="".concat(this._n,".").concat("searchGroupByID"),o={groupIDList:[e]},r=new w_("searchGroupByID");return r.setMessage("groupID:".concat(e)),Gl.l("".concat(n," groupID:").concat(e)),this.request({protocolName:Cg,requestData:o}).then((function(e){var o=e.data.groupProfile;if(0!==o[0].errorCode)throw new UI({code:o[0].errorCode,message:o[0].errorInfo});return r.setNetworkType(t.getNetworkType()).end(),Gl.l("".concat(n," ok")),GI({group:new _C(o[0])})})).catch((function(e){return t.probeNetwork().then((function(t){var n=_(t,2),o=n[0],i=n[1];r.setError(e,o,i).end()})),Gl.w("".concat(n," failed. error:"),e),BI(e)}))}},{key:"changeGroupOwner",value:function(e){var t=this,n="".concat(this._n,".").concat("changeGroupOwner");if(this.hasLocalGroup(e.groupID)&&this.getLocalGroupProfile(e.groupID).type===Ir.GRP_AVCHATROOM)return BI({code:Em});if(e.newOwnerID===this.getMyUserID())return BI({code:Am});var o=new w_("changeGroupOwner");return o.setMessage("groupID:".concat(e.groupID," newOwnerID:").concat(e.newOwnerID)),Gl.l("".concat(n," groupID:").concat(e.groupID)),this.request({protocolName:kg,requestData:e}).then((function(){o.setNetworkType(t.getNetworkType()).end(),Gl.l("".concat(n," ok"));var r=e.groupID,i=e.newOwnerID;t.groupMap.get(r).ownerID=i;var a=t.getModule(zf).getLocalGroupMemberList(r);if(a instanceof Map){var s=a.get(t.getMyUserID());id(s)||(s.updateRole("Member"),t.groupMap.get(r).selfInfo.role="Member");var u=a.get(i);id(u)||u.updateRole("Owner")}return t.emitGroupListUpdate(!0,!1),GI({group:t.groupMap.get(r)})})).catch((function(e){return t.probeNetwork().then((function(t){var n=_(t,2),r=n[0],i=n[1];o.setError(e,r,i).end()})),Gl.e("".concat(n," failed. error:"),e),BI(e)}))}},{key:"getGroupApplicationList",value:function(){return this._groupSystemNoticeHandler.getGroupApplicationList()}},{key:"handleGroupApplication",value:function(e){var t,n,o,r,i=this,a="".concat(this._n,".").concat("handleGroupApplication"),s=e.handleAction,u=e.handleMessage,c=e.message,l=e.application;c?(t=c.payload.operatorID,n=c.payload.groupProfile.groupID,o=c.payload.authentication,r=c.payload.messageKey):l&&(t=l.applicant,n=l.groupID,o=l.authentication,r=l.messageKey);var d=new w_("handleGroupApplication");return d.setMessage("groupID:".concat(n)),Gl.l("".concat(a," groupID:").concat(n)),this.request({protocolName:Tg,requestData:{handleAction:s,handleMessage:u,applicant:t,groupID:n,authentication:o,messageKey:r}}).then((function(){return d.setNetworkType(i.getNetworkType()).end(),Gl.l("".concat(a," ok")),c&&i._groupSystemNoticeHandler.deleteGroupSystemNotice({messageList:[e.message]}),GI({group:i.getLocalGroupProfile(n)})})).catch((function(e){return i.probeNetwork().then((function(t){var n=_(t,2),o=n[0],r=n[1];d.setError(e,o,r).end()})),Gl.e("".concat(a," failed. error"),e),BI(e)}))}},{key:"handleGroupInvitation",value:function(e){var n=this,o="".concat(this._n,".").concat("handleGroupInvitation"),r=e.message.payload,i=r.groupProfile.groupID,a=r.authentication,s=r.messageKey,u=r.operatorID,c=e.handleAction,l=new w_("handleGroupInvitation");return l.setMessage("groupID:".concat(i," inviter:").concat(u," handleAction:").concat(c)),Gl.l("".concat(o," groupID:").concat(i," inviter:").concat(u," handleAction:").concat(c)),this.request({protocolName:Sg,requestData:t(t({},e),{},{inviter:u,groupID:i,authentication:a,messageKey:s})}).then((function(){return l.setNetworkType(n.getNetworkType()).end(),Gl.l("".concat(o," ok")),n._groupSystemNoticeHandler.deleteGroupSystemNotice({messageList:[e.message]}),GI({group:n.getLocalGroupProfile(i)})})).catch((function(e){return n.probeNetwork().then((function(t){var n=_(t,2),o=n[0],r=n[1];l.setError(e,o,r).end()})),Gl.e("".concat(o," failed. error"),e),BI(e)}))}},{key:"getGroupOnlineMemberCount",value:function(e){return this._AVChatRoomHandler?this._AVChatRoomHandler.checkJoinedAVChatRoomByID(e)?this._AVChatRoomHandler.getGroupOnlineMemberCount(e):qI({memberCount:0}):BI({code:n_})}},{key:"hasLocalGroup",value:function(e){return this.groupMap.has(e)}},{key:"deleteLocalGroupAndConversation",value:function(e){var t=this.checkJoinedAVChatRoomByID(e);if(Gl.l("".concat(this._n,".deleteLocalGroupAndConversation isJoinedAVChatRoom:").concat(t)),t&&this.getModule(Wf).deleteLocalConversation("".concat(Ir.CONV_GROUP).concat(e)),bd({groupID:e})){var n=this.getLocalGroupProfile(e);n&&!0===n.isSupportTopic&&this.getModule(Zf).deleteTopicListInCommunity(e)}this._deleteLocalGroup(e),this.emitGroupListUpdate(!0,!1)}},{key:"_deleteLocalGroup",value:function(e){this.groupMap.delete(e),this.getModule(zf).deleteGroupMemberList(e),this._setStorageGroupList()}},{key:"sendMessage",value:function(e,t){if(rd(e._receiverList)&&e._receiverList.length>0&&!this.canIUse(Uc.MSG_TO_SPECIFIED_GRP_MBR))return BI({code:p_});var n=this.createGroupMessagePack(e,t);return this.request(n)}},{key:"createGroupMessagePack",value:function(e,t){var n=null;t&&t.offlinePushInfo&&(n=t.offlinePushInfo);var o="";td(e.cloudCustomData)&&e.cloudCustomData.length>0&&(o=e.cloudCustomData);var r=[];if(od(t)&&od(t.messageControlInfo)){var i=t.messageControlInfo,a=i.excludedFromUnreadCount,s=i.excludedFromLastMessage,u=i.excludedFromContentModeration;!0===a&&r.push("NoUnread"),!0===s&&r.push("NoLastMsg"),!0===u&&r.push("NoMsgCheck")}var c=void 0;rd(e._receiverList)&&e._receiverList.length>0&&(c=e._receiverList,e._receiverList.length>50&&(c=e._receiverList.slice(0,50),this.outputWarning("ReceiverListLimit")));var l=this.isOnlineMessage(e,t)?1:0,d=e.getGroupAtInfoList(),p={fromAccount:this.getMyUserID(),groupID:e.to,msgBody:e.getElements(),cloudCustomData:o,random:e.random,priority:e.priority,clientSequence:e.clientSequence,groupAtInfo:e.type!==Ir.MSG_TEXT||Yd(d)?void 0:d,onlineOnlyFlag:l,clientTime:e.clientTime,offlinePushInfo:n?{pushFlag:!0===n.disablePush?1:0,title:n.title||"",desc:n.description||"",ext:n.extension||"",apnsInfo:{badgeMode:!0===n.ignoreIOSBadge?1:0,isVoipPush:this._isVoipPush(n)},androidInfo:{OPPOChannelID:n.androidOPPOChannelID||""}}:void 0,messageControlInfo:0===l?r:void 0,needReadReceipt:!0!==e.needReadReceipt||this.isMessageFromOrToAVChatroom(e.to)?0:1,receiverList:c,isSupportExtension:!0===e.isSupportExtension?1:0};return Dd(e.to)&&(p.groupID=Vd(e.to),p.topicID=e.to),{protocolName:Th,tjgID:this.generateTjgID(e),requestData:p}}},{key:"_isVoipPush",value:function(e){var t=void 0;return id(e.disableVoipPush)||(t=!1===e.disableVoipPush?1:0),t}},{key:"revokeMessage",value:function(e){var t={groupID:e.to,msgSeqList:[{msgSeq:e.sequence}]};return Dd(e.to)&&(t.groupID=Vd(e.to),t.topicID=e.to),this.request({protocolName:bg,requestData:t})}},{key:"deleteMessage",value:function(e){var t=e.to,n=e.keyList;Gl.l("".concat(this._n,".deleteMessage groupID:").concat(t," count:").concat(n.length));var o={groupID:t,deleter:this.getMyUserID(),keyList:n};return Dd(t)&&(o.groupID=Vd(t),o.topicID=t),this.request({protocolName:Fg,requestData:o})}},{key:"modifyRemoteMessage",value:function(e){var t=e.to,n=e.sequence,o=e.payload,r=e.type,i=e.version,a=void 0===i?0:i,s=e.cloudCustomData,u=t,c=void 0;Dd(t)&&(u=Vd(t),c=t);var l=void 0;return Kd(r)&&(l=[]).push({type:r,content:o}),this.request({protocolName:qg,requestData:{groupID:u,topicID:c,sequence:n,version:a,elements:l,cloudCustomData:s}})}},{key:"getRoamingMessage",value:function(e){var t=this,n="".concat(this._n,".getRoamingMessage"),o=e.conversationID,r=e.groupID,i=e.sequence,a=new w_("getGroupRoamingMessages"),s=0,u=void 0;return Dd(r)&&(r=Vd(u=r)),this._computeLastSequence({groupID:r,topicID:u,sequence:i}).then((function(e){return s=e,Gl.l("".concat(n," groupID:").concat(r," startSequence:").concat(s)),t.request({protocolName:Ag,requestData:{groupID:r,count:21,sequence:s,topicID:u}})})).then((function(e){var i=e.data,c=i.messageList,l=i.complete,d=i.invisibleSequenceList,p=void 0===d?[]:d;id(c)?Gl.l("".concat(n," ok. complete:").concat(l," but messageList is undefined!")):Gl.l("".concat(n," ok. complete:").concat(l," count:").concat(c.length));var f=t._getMinSequence(p,c)-1;a.setNetworkType(t.getNetworkType()).setMessage("groupID:".concat(r," topicID:").concat(u," startSequence:").concat(s," complete:").concat(l," nextSequence:").concat(f)).end();var h=t.getModule(Wf),g=[];return Yd(c)||(h.updateRoamingMessageSequence(o,f),g=h.onRoamingMessage(c,o),h.updateIsRead(o),h.patchConversationLastMessage(o)),2===l&&(h.setCompleted(o),f=""),Gl.l("".concat(n," nextReqID:").concat(f,", stored message count:").concat(g.length,", invisible sequence count:").concat(p.length)),{nextReqID:f+"",storedMessageList:g}})).catch((function(e){return t.probeNetwork().then((function(t){var n=_(t,2),o=n[0],i=n[1];a.setError(e,o,i).setMessage("groupID:".concat(r," topicID:").concat(u," startSequence:").concat(s)).end()})),Gl.w("".concat(n," failed. error:"),e),BI(e)}))}},{key:"_getGroupIDOfMessage",value:function(e){return e.conversationID.replace(Ir.CONV_GROUP,"")}},{key:"_getMinSequence",value:function(e,t){var n=0;Yd(t)||(n=t[t.length-1].sequence);var o=0;return Yd(e)||(o=e[e.length-1]),Gl.l("".concat(this._n,"._getMinSequence minVisibleSequence:").concat(n," minInvisibleSequence:").concat(o)),o>0&&o<n?o:n}},{key:"getReadReceiptList",value:function(e){var t=this,n="".concat(this._n,".").concat("getReadReceiptList"),o=this._getGroupIDOfMessage(e[0]),r=this.getMyUserID(),i=e.filter((function(e){return e.from===r&&!0===e.needReadReceipt})).map((function(e){return{sequence:e.sequence}}));if(Gl.l("".concat(n," groupID:").concat(o," sequenceList:").concat(JSON.stringify(i))),0===i.length)return qI({messageList:e});var a=new w_("getReadReceiptList");return a.setMessage("groupID:".concat(o)),this.request({protocolName:Lg,requestData:{groupID:o,sequenceList:i}}).then((function(t){a.end(),Gl.l("".concat(n," ok"));var o=t.data.readReceiptList;return rd(o)&&o.forEach((function(t){e.forEach((function(e){0===t.code&&t.sequence===e.sequence&&(e.readReceiptInfo.readCount=t.readCount,e.readReceiptInfo.unreadCount=t.unreadCount)}))})),GI({messageList:e})})).catch((function(e){return t.probeNetwork().then((function(t){var n=_(t,2),o=n[0],r=n[1];a.setError(e,o,r).end()})),Gl.w("".concat(n," failed. error:"),e),BI(e)}))}},{key:"sendReadReceipt",value:function(e){var t=this,n="".concat(this._n,".").concat("sendReadReceipt"),o=this._getGroupIDOfMessage(e[0]),r=new w_("sendReadReceipt");r.setMessage("groupID:".concat(o));var i=this.getMyUserID(),a=e.filter((function(e){return e.from!==i&&!0===e.needReadReceipt})).map((function(e){return{sequence:e.sequence}}));return 0===a.length?BI({code:$v}):(Gl.l("".concat(n,". sequenceList:").concat(JSON.stringify(a))),this.request({protocolName:Rg,requestData:{groupID:o,sequenceList:a}}).then((function(e){return r.end(),Gl.l("".concat(n," ok")),GI()})).catch((function(e){return t.probeNetwork().then((function(t){var n=_(t,2),o=n[0],i=n[1];r.setError(e,o,i).end()})),Gl.w("".concat(n," failed. error:"),e),BI(e)})))}},{key:"getReadReceiptDetail",value:function(e){var t=this,n=e.message,o=e.filter,r=e.cursor,i=e.count,a=this._getGroupIDOfMessage(n),s=n.ID,u=n.sequence,c="".concat(this._n,".").concat("getReadReceiptDetail"),l=this._receiptDetailCompleteMap.get(s)||!1,d=0!==o&&1!==o?0:o,p=td(r)?r:"",f=!ed(i)||i<=0||i>=100?100:i,h="groupID:".concat(a," sequence:").concat(u," cursor:").concat(p," filter:").concat(d," completeFlag:").concat(l);Gl.l("".concat(c," ").concat(h));var g={cursor:"",isCompleted:!1,messageID:s,unreadUserIDList:[],readUserIDList:[]},v=new w_("getReadReceiptDetail");return v.setMessage(h),this.request({protocolName:Og,requestData:{groupID:a,sequence:u,flag:d,cursor:p,count:f}}).then((function(e){v.end();var n=e.data,o=n.cursor,r=n.isCompleted,i=n.unreadUserIDList,a=n.readUserIDList;return g.cursor=o,1===r&&(g.isCompleted=!0,t._receiptDetailCompleteMap.set(s,!0)),0===d?g.readUserIDList=a.map((function(e){return e.userID})):1===d&&(g.unreadUserIDList=i.map((function(e){return e.userID}))),Gl.l("".concat(c," ok")),GI(g)})).catch((function(e){return t.probeNetwork().then((function(t){var n=_(t,2),o=n[0],r=n[1];v.setError(e,o,r).end()})),Gl.w("".concat(c," failed. error:"),e),BI(e)}))}},{key:"getRoamingMessagesHopping",value:function(e){var t=this,n="".concat(this._n,".getRoamingMessagesHopping"),o=new w_("getGroupRoamingMessagesHopping"),r=e.groupID,i=e.count,a=e.sequence,s=e.direction,u=a;1===s&&(u=a+i-1);var c=void 0;Dd(r)&&(r=Vd(c=r));var l="".concat(c?"topicID:".concat(c):"groupID:".concat(r)," sequence:").concat(a," direction:").concat(s);return Gl.l("".concat(n," ").concat(l)),this.request({protocolName:Ag,requestData:{groupID:r,topicID:c,count:i,sequence:u}}).then((function(r){var i=r.data,u=i.messageList,c=i.complete,d="complete:".concat(c," count:").concat(u?u.length:0);if(Gl.l("".concat(n," ok. ").concat(d)),o.setNetworkType(t.getNetworkType()).setMessage("".concat(l," ").concat(d)).end(),2===c||Yd(u)){var p=t._computeResult();return GI(p)}var f="".concat(Ir.CONV_GROUP).concat(e.groupID),h=t.getModule(Wf).onRoamingMessage(u,f,!1),g=t._computeResult({direction:s,sequence:a,remoteMessageList:u,processedMessageList:h});return GI(g)})).catch((function(e){return t.probeNetwork().then((function(t){var n=_(t,2),s=n[0],u=n[1];o.setError(e,s,u).setMessage("groupID:".concat(r," sequence:").concat(a," count:").concat(i)).end()})),Gl.w("".concat(n," failed. error:"),e),BI(e)}))}},{key:"_computeResult",value:function(e){var t={messageList:[],isCompleted:!1,nextMessageSeq:""};if(id(e))return t.isCompleted=!0,t;var n=e.direction,o=e.sequence,r=e.remoteMessageList,i=void 0===r?[]:r,a=e.processedMessageList,s=void 0===a?[]:a,u=i.length;return 1===n?(t.nextMessageSeq=i[0].sequence+1,s.forEach((function(e){e.sequence>=o&&t.messageList.push(e)})),0===t.messageList.length&&i[0].sequence<o&&(t.isCompleted=!0,t.nextMessageSeq=""),t):(t.nextMessageSeq=i[u-1].sequence-1,t.messageList=y(s),0===t.nextMessageSeq&&(t.isCompleted=!0,t.nextMessageSeq=""),t)}},{key:"setMessageRead",value:function(e){var t=this,n=e.conversationID,o=e.lastMessageSeq,r="".concat(this._n,".setMessageRead");Gl.l("".concat(r," conversationID:").concat(n," lastMessageSeq:").concat(o)),ed(o)||this.outputWarning("DoNotModifyLastSeq");var i=new w_("setGroupMessageRead");i.setMessage("".concat(n,"-").concat(o));var a=n.replace(Ir.CONV_GROUP,""),s=void 0;return Dd(a)&&(a=Vd(s=a)),this.request({protocolName:Dg,requestData:{groupID:a,topicID:s,messageReadSeq:o}}).then((function(){i.setNetworkType(t.getNetworkType()).end(),Gl.l("".concat(r," ok."));var e=t.getModule(Wf);e.updateIsReadAfterReadReport({conversationID:n,lastMessageSeq:o});var u=!0;if(!id(s)){u=!1;var c=t.getModule(Zf).getLocalTopic(a,s);c&&c.updateSelfInfo({readedSequence:o})}return e.updateUnreadCount(n,u),GI()})).catch((function(e){return t.probeNetwork().then((function(t){var n=_(t,2),o=n[0],r=n[1];i.setError(e,o,r).end()})),Gl.l("".concat(r," failed. error:"),e),BI(e)}))}},{key:"_computeLastSequence",value:function(e){var t=e.groupID,n=e.topicID,o=void 0===n?void 0:n,r=e.sequence;return r>0?Promise.resolve(r):id(o)||this.hasLocalGroup(t)?id(o)?this.getGroupLastSequence(t):this.getTopicLastSequence({groupID:t,topicID:o}):Promise.resolve(0)}},{key:"getGroupLastSequence",value:function(e){var t=this,n="".concat(this._n,".").concat("getGroupLastSequence"),o=new w_("getGroupLastSequence"),r=0,i="";if(this.hasLocalGroup(e)){var a=this.getLocalGroupProfile(e),s=a.lastMessage;if(s.lastSequence>0&&!1===s.onlineOnlyFlag)return r=s.lastSequence,i="got lastSequence:".concat(r," from local group profile[lastMessage.lastSequence]. groupID:").concat(e),Gl.l("".concat(n," ").concat(i)),o.setNetworkType(this.getNetworkType()).setMessage("".concat(i)).end(),Promise.resolve(r);if(a.nextMessageSeq>1)return r=a.nextMessageSeq-1,i="got lastSequence:".concat(r," from local group profile[nextMessageSeq]. groupID:").concat(e),Gl.l("".concat(n," ").concat(i)),o.setNetworkType(this.getNetworkType()).setMessage("".concat(i)).end(),Promise.resolve(r)}var u="GROUP".concat(e),c=this.getModule(Wf).getLocalConversation(u);if(c&&c.lastMessage.lastSequence&&!1===c.lastMessage.onlineOnlyFlag)return r=c.lastMessage.lastSequence,i="got lastSequence:".concat(r," from local conversation profile[lastMessage.lastSequence]. groupID:").concat(e),Gl.l("".concat(n," ").concat(i)),o.setNetworkType(this.getNetworkType()).setMessage("".concat(i)).end(),Promise.resolve(r);var l={groupIDList:[e],responseFilter:{groupBaseInfoFilter:["NextMsgSeq"]}};return this.getGroupProfileAdvance(l).then((function(a){var s=a.data.successGroupList;return Yd(s)?Gl.l("".concat(n," successGroupList is empty. groupID:").concat(e)):(r=s[0].nextMessageSeq-1,i="got lastSequence:".concat(r," from getGroupProfileAdvance. groupID:").concat(e),Gl.l("".concat(n," ").concat(i))),o.setNetworkType(t.getNetworkType()).setMessage("".concat(i)).end(),r})).catch((function(r){return t.probeNetwork().then((function(t){var n=_(t,2),i=n[0],a=n[1];o.setError(r,i,a).setMessage("get lastSequence failed from getGroupProfileAdvance. groupID:".concat(e)).end()})),Gl.w("".concat(n," failed. error:"),r),BI(r)}))}},{key:"getTopicLastSequence",value:function(e){var t=this,n=e.groupID,o=e.topicID,r="".concat(this._n,".").concat("getTopicLastSequence"),i=new w_("getTopicLastSequence"),a=0,s="",u=this.getModule(Zf);return u.hasLocalTopic(n,o)?(a=u.getLocalTopic(n,o).nextMessageSeq-1,s="get lastSequence:".concat(a," from local topic info[nextMessageSeq]. topicID:").concat(o),Gl.l("".concat(r," ").concat(s)),i.setNetworkType(this.getNetworkType()).setMessage("".concat(s)).end(),Promise.resolve(a)):u.getTopicList({groupID:n,topicIDList:[o]}).then((function(e){var n=e.data.successTopicList;return Yd(n)?Gl.l("".concat(r," successTopicList is empty. topicID:").concat(o)):(a=n[0].nextMessageSeq-1,s="get lastSequence:".concat(a," from getTopicList. topicID:").concat(o),Gl.l("".concat(r," ").concat(s))),i.setNetworkType(t.getNetworkType()).setMessage("".concat(s)).end(),a})).catch((function(e){return t.probeNetwork().then((function(t){var n=_(t,2),r=n[0],a=n[1];i.setError(e,r,a).setMessage("get lastSequence failed from getTopicList. topicID:".concat(o)).end()})),Gl.w("".concat(r," failed. error:"),e),BI(e)}))}},{key:"isMessageFromOrToAVChatroom",value:function(e){return!!this._AVChatRoomHandler&&this._AVChatRoomHandler.checkJoinedAVChatRoomByID(e)}},{key:"hasJoinedAVChatRoom",value:function(){return this._AVChatRoomHandler?this._AVChatRoomHandler.hasJoinedAVChatRoom():0}},{key:"getJoinedAVChatRoom",value:function(){return this._AVChatRoomHandler?this._AVChatRoomHandler.getJoinedAVChatRoom():[]}},{key:"isOnlineMessage",value:function(e,t){return!(!this._canIUseOnlineOnlyFlag(e)||!t||!0!==t.onlineUserOnly)}},{key:"_canIUseOnlineOnlyFlag",value:function(e){var t=this.getJoinedAVChatRoom();return!t||!t.includes(e.to)||e.conversationType!==Ir.CONV_GROUP}},{key:"_onAVChatRoomHistoryMessage",value:function(e){if(!Yd(e)){Gl.l("".concat(this._n,"._onAVChatRoomHistoryMessage count:").concat(e.length));var n=[];e.forEach((function(e){n.push(t(t({},e),{},{isHistoryMessage:1}))})),this.onAVChatRoomMessage(n)}}},{key:"onAVChatRoomMessage",value:function(e){this._AVChatRoomHandler&&this._AVChatRoomHandler.onMessage(e)}},{key:"onAVChatRoomMemberBanned",value:function(e){this._AVChatRoomHandler&&this._AVChatRoomHandler.onAVChatRoomMemberBanned(e)}},{key:"getGroupSimplifiedInfo",value:function(e){var t=this,n=new w_("getGroupSimplifiedInfo"),o={groupIDList:[e],responseFilter:{groupBaseInfoFilter:["Type","Name"]}};return this.getGroupProfileAdvance(o).then((function(o){var r=o.data.successGroupList;return n.setNetworkType(t.getNetworkType()).setMessage("groupID:".concat(e," type:").concat(r[0].type)).end(),r[0]})).catch((function(o){t.probeNetwork().then((function(t){var r=_(t,2),i=r[0],a=r[1];n.setError(o,i,a).setMessage("groupID:".concat(e)).end()}))}))}},{key:"setUnjoinedAVChatRoom",value:function(e){this._unjoinedAVChatRoomList.set(e,1)}},{key:"deleteUnjoinedAVChatRoom",value:function(e){this._unjoinedAVChatRoomList.has(e)&&this._unjoinedAVChatRoomList.delete(e)}},{key:"isUnjoinedAVChatRoom",value:function(e){return this._unjoinedAVChatRoomList.has(e)}},{key:"isGroupAttributesUpdatedNotice",value:function(e){return this._groupAttributesHandler.isGroupAttributesUpdatedNotice(e)}},{key:"updateLocalMainSequenceOnReconnected",value:function(){this._groupAttributesHandler.updateLocalMainSequenceOnReconnected()}},{key:"initGroupAttributes",value:function(e){return this._groupAttributesHandler.initGroupAttributes(e)}},{key:"setGroupAttributes",value:function(e){return this._groupAttributesHandler.setGroupAttributes(e)}},{key:"deleteGroupAttributes",value:function(e){return this._groupAttributesHandler.deleteGroupAttributes(e)}},{key:"getGroupAttributes",value:function(e){return this._groupAttributesHandler.getGroupAttributes(e)}},{key:"isMessageFromTopic",value:function(e,t){return 2===e&&!Yd(t)}},{key:"isMessageFromCommunityOfTopic",value:function(e,t){return 2===e&&Yd(t)}},{key:"getMessageExtensions",value:function(e,t){return Gl.l("".concat(this._n,".getMessageExtensions startSequence:").concat(t)),this.request({protocolName:Zg,requestData:{groupID:e.to,messageSequence:e.sequence,startSequence:t}})}},{key:"modifyMessageExtensions",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return Gl.l("".concat(this._n,".modifyMessageExtensions operateType:").concat(n)),this.request({protocolName:zg,requestData:{groupID:e.to,messageSequence:e.sequence,extensionList:t,operateType:n}})}},{key:"getGroupNotify",value:function(e){var n=this;if(this.hasLocalGroup(e)){var o=this.getLocalGroupProfile(e),r=o.type,i=o.isSupportTopic;if(!Sd(r)&&!i){var a="".concat(this._n,".getGroupNotify"),s=this._getGroupLastRevokedTime(e),u=1e3*Ll();Gl.l("".concat(a," groupID:").concat(e," type:").concat(r," beginTime:").concat(s," endTime:").concat(u)),this.request({protocolName:Wg,requestData:{type:bd({type:r,groupID:e})?Ir.GRP_COMMUNITY:void 0,groupID:e,beginTime:s,endTime:u}}).then((function(o){var r=o.data,i=r.nextRevokedTime,s=r.notifyList;Gl.l("".concat(a," ok. groupID:").concat(e," nextRevokedTime:").concat(i));var u={dataList:[{elements:{revokedInfos:[]}}]};rd(s)&&s.forEach((function(n){u.dataList[0].elements.revokedInfos.push({groupID:e,sequence:n.sequence,random:n.random,revokerInfo:t({},n.revokerInfo)})})),n.onGroupMessageRevoked(u),0!==i?(n._setGroupLastRevokedTime(e,i),n.getGroupNotify(e)):n._setGroupLastRevokedTime(e,1e3*Ll())})).catch((function(e){Gl.e("".concat(a," failed. error:"),e)}))}}}},{key:"_getGroupLastRevokedTime",value:function(e){return this.hasLocalGroup(e)?this.getLocalGroupProfile(e)._lastRevokedTime:0}},{key:"_setGroupLastRevokedTime",value:function(e,t){this.hasLocalGroup(e)&&(this.getLocalGroupProfile(e)._lastRevokedTime=t)}},{key:"isGroupCountersNotice",value:function(e){return this._groupCountersHandler.isGroupCountersNotice(e)}},{key:"setGroupCounters",value:function(e){return this._groupCountersHandler.setGroupCounters(e)}},{key:"increaseGroupCounter",value:function(e){return this._groupCountersHandler.increaseGroupCounter(e)}},{key:"decreaseGroupCounter",value:function(e){return this._groupCountersHandler.decreaseGroupCounter(e)}},{key:"getGroupCounters",value:function(e){return this._groupCountersHandler.getGroupCounters(e)}},{key:"restartPolling",value:function(){this._AVChatRoomHandler&&this._AVChatRoomHandler.restartPolling()}},{key:"reset",value:function(){this.groupMap.clear(),this._unjoinedAVChatRoomList.clear(),this._receiptDetailCompleteMap.clear(),this._commonGroupHandler.reset(),this._groupSystemNoticeHandler.reset(),this._groupTipsHandler.reset(),this._groupAttributesHandler.reset(),this._groupCountersHandler.reset(),this._AVChatRoomHandler&&this._AVChatRoomHandler.reset()}}]),o}(vh),WC=function(){function e(t){r(this,e),this.userID="",this.avatar="",this.nick="",this.role="",this.joinTime="",this.lastSendMsgTime="",this.nameCard="",this.muteUntil=0,this.memberCustomField=[],this._initMember(t)}return a(e,[{key:"_initMember",value:function(e){this.updateMember(e)}},{key:"updateMember",value:function(e){var t=[null,void 0,"",0,NaN];e.memberCustomField&&kd(this.memberCustomField,e.memberCustomField),fd(this,e,["memberCustomField","marks"],t)}},{key:"updateRole",value:function(e){["Owner","Admin","Member"].indexOf(e)<0||(this.role=e)}},{key:"updateMuteUntil",value:function(e){id(e)||(this.muteUntil=Math.floor((Date.now()+1e3*e)/1e3))}},{key:"updateNameCard",value:function(e){id(e)||(this.nameCard=e)}},{key:"updateMemberCustomField",value:function(e){e&&kd(this.memberCustomField,e)}}]),e}(),YC=function(e){u(o,e);var n=m(o);function o(e){var t;return r(this,o),(t=n.call(this,e))._n="GroupMemberModule",t.groupMemberListMap=new Map,t.getInnerEmitterInstance().on(aC,t._onProfileUpdated,g(t)),t}return a(o,[{key:"_onProfileUpdated",value:function(e){for(var t=this,n=e.data,o=function(e){var o=n[e];t.groupMemberListMap.forEach((function(e){e.has(o.userID)&&e.get(o.userID).updateMember({nick:o.nick,avatar:o.avatar})}))},r=0;r<n.length;r++)o(r)}},{key:"deleteGroupMemberList",value:function(e){this.groupMemberListMap.delete(e)}},{key:"getGroupMemberList",value:function(e){var t=this,n=e.groupID,o=e.offset,r=void 0===o?0:o,i=e.count,a=void 0===i?15:i,s=e.filter,u=void 0===s?void 0:s,c="".concat(this._n,".").concat("getGroupMemberList"),l=this.getModule(Kf),d=l.hasLocalGroup(n);if(Gl.l("".concat(c," groupID:").concat(n," offset:").concat(r," count:").concat(a," hasLocalGroup:").concat(d)),!d)return qI({memberList:[],offset:0});if(l.getLocalGroupProfile(n).type===Ir.GRP_AVCHATROOM){if(this.canIUse(Uc.AVCHATROOM_MBR_LIST))return this._getAVChatRoomMemberList({groupID:n,offset:r,filter:u});this.outputWarning("LiveOnlineMember")}var p=new w_("getGroupMemberList"),f=0,h={groupID:n,limit:a>100?100:a};bd({groupID:n})?h.next="".concat(r):(h.offset=r,f=r+a);var g=[];return this.request({protocolName:Xg,requestData:h}).then((function(e){var o=e.data,r=o.members,i=o.memberNum,a=o.next,s=void 0===a?void 0:a;if(id(s)||(f=Yd(s)?0:s),!rd(r)||0===r.length)return f=0,Promise.resolve([]);var u=t.getModule(Kf);return u.hasLocalGroup(n)&&(u.getLocalGroupProfile(n).memberNum=i),g=t._updateLocalGroupMemberMap(n,r),t.getModule(Vf).getUserProfile({userIDList:r.map((function(e){return e.userID})),tagList:[xl.NICK,xl.AVATAR]})})).then((function(e){var o=e.data;if(!rd(o)||0===o.length)return qI({memberList:[],offset:f});var i=o.map((function(e){return{userID:e.userID,nick:e.nick,avatar:e.avatar}}));return t._updateLocalGroupMemberMap(n,i),g.length<a&&(f=0),p.setNetworkType(t.getNetworkType()).setMessage("groupID:".concat(n," offset:").concat(r," count:").concat(a)).end(),Gl.l("".concat(c," ok.")),GI({memberList:g,offset:f})})).catch((function(e){return t.probeNetwork().then((function(t){var n=_(t,2),o=n[0],r=n[1];p.setError(e,o,r).end()})),Gl.e("".concat(c," failed. error:"),e),BI(e)}))}},{key:"_getAVChatRoomMemberList",value:function(e){var t=this,n=e.groupID,o=e.offset,r=e.filter,i="".concat(this._n,".").concat("_getAVChatRoomMemberList"),a=new w_("_getAVChatRoomMemberList");return a.setMessage("groupID:".concat(n," offset:").concat(o," filter:").concat(r)),this.request({protocolName:$g,requestData:{groupID:n,offset:o,filter:r}}).then((function(e){var o=e.data,r=o.memberList,s=void 0===r?[]:r,u=o.offset,c=void 0===u?0:u;a.setNetworkType(t.getNetworkType()).end(),Gl.l("".concat(i," ok. member count:").concat(s.length,", next request timestamp:").concat(c));var l=t._updateLocalGroupMemberMap(n,s);return GI({memberList:l,offset:c})})).catch((function(e){return t.probeNetwork().then((function(t){var n=_(t,2),o=n[0],r=n[1];a.setError(e,o,r).end()})),Gl.e("".concat(i," failed. error:"),e),BI(e)}))}},{key:"getGroupMemberProfile",value:function(e){var n=this,o="".concat(this._n,".").concat("getGroupMemberProfile"),r=new w_("getGroupMemberProfile");r.setMessage(e.userIDList.length>5?"userIDList.length:".concat(e.userIDList.length):"userIDList:".concat(e.userIDList)),Gl.l("".concat(o," groupID:").concat(e.groupID," userIDList:").concat(e.userIDList.join(","))),e.userIDList.length>50&&(e.userIDList=e.userIDList.slice(0,50));var i=e.groupID,a=e.userIDList;return this._getGroupMemberProfileAdvance(t(t({},e),{},{userIDList:a})).then((function(e){var t=e.data.members;return rd(t)&&0!==t.length?(n._updateLocalGroupMemberMap(i,t),n.getModule(Vf).getUserProfile({userIDList:t.map((function(e){return e.userID})),tagList:[xl.NICK,xl.AVATAR]})):qI([])})).then((function(e){var t=e.data.map((function(e){return{userID:e.userID,nick:e.nick,avatar:e.avatar}}));n._updateLocalGroupMemberMap(i,t);var o=a.filter((function(e){return n.hasLocalGroupMember(i,e)})).map((function(e){return n.getLocalGroupMemberInfo(i,e)}));return r.setNetworkType(n.getNetworkType()).end(),GI({memberList:o})}))}},{key:"addGroupMember",value:function(e){var t=this,n="".concat(this._n,".").concat("addGroupMember"),o=e.groupID,r=this.getModule(Kf).getLocalGroupProfile(o),i=r.type,a=new w_("addGroupMember");if(a.setMessage("groupID:".concat(o," groupType:").concat(i)),Sd(i)){var s=new UI({code:Om});return a.setError(s,!0,this.getNetworkType()).end(),BI(s)}return e.userIDList=e.userIDList.map((function(e){return{userID:e}})),Gl.l("".concat(n," groupID:").concat(o)),this.request({protocolName:ev,requestData:e}).then((function(o){var i=o.data.members;Gl.l("".concat(n," ok"));var s=i.filter((function(e){return 1===e.result})).map((function(e){return e.userID})),u=i.filter((function(e){return 0===e.result})).map((function(e){return e.userID})),c=i.filter((function(e){return 2===e.result})).map((function(e){return e.userID})),l=i.filter((function(e){return 4===e.result})).map((function(e){return e.userID})),d="groupID:".concat(e.groupID,", ")+"successUserIDList:".concat(s,", ")+"failureUserIDList:".concat(u,", ")+"existedUserIDList:".concat(c,", ")+"overLimitUserIDList:".concat(l);return a.setNetworkType(t.getNetworkType()).setMoreMessage(d).end(),0===s.length?GI({successUserIDList:s,failureUserIDList:u,existedUserIDList:c,overLimitUserIDList:l}):(r.memberCount+=s.length,t._updateConversationGroupProfile(r),GI({successUserIDList:s,failureUserIDList:u,existedUserIDList:c,overLimitUserIDList:l,group:r}))})).catch((function(e){return t.probeNetwork().then((function(t){var n=_(t,2),o=n[0],r=n[1];a.setError(e,o,r).end()})),Gl.e("".concat(n," failed. error:"),e),BI(e)}))}},{key:"deleteGroupMember",value:function(e){var t=this,n="".concat(this._n,".").concat("deleteGroupMember"),o=e.groupID,r=e.userIDList,i=this.getModule(Kf).getLocalGroupProfile(o);if(id(i))return BI({code:Dm});if(Sd(i.type))return this.canIUse(Uc.AVCHATROOM_BAN_MBR)?this._banAVChatRoomMember(e):BI({code:p_});var a=new w_("deleteGroupMember"),s="groupID:".concat(o," ").concat(r.length>5?"userIDList.length:".concat(r.length):"userIDList:".concat(r));return a.setMessage(s),Gl.l("".concat(n," groupID:").concat(o," userIDList:"),r),this.request({protocolName:tv,requestData:e}).then((function(){return a.setNetworkType(t.getNetworkType()).end(),Gl.l("".concat(n," ok")),i.memberCount-=1,t._updateConversationGroupProfile(i),t.deleteLocalGroupMembers(o,r),GI({group:i,userIDList:r})})).catch((function(e){return t.probeNetwork().then((function(t){var n=_(t,2),o=n[0],r=n[1];a.setError(e,o,r).end()})),Gl.e("".concat(n," failed. error:"),e),BI(e)}))}},{key:"_updateConversationGroupProfile",value:function(e){this.getModule(Wf).updateConversationGroupProfile([e])}},{key:"_banAVChatRoomMember",value:function(e){var t=this,n="".concat(this._n,".").concat("deleteGroupMember"),o=e.groupID,r=e.userIDList,i="groupID:".concat(o," ").concat(r.length>5?"userIDList.length:".concat(r.length):"userIDList:".concat(r)),a=new w_("deleteGroupMember");a.setMessage(i),Gl.l("".concat(n," groupID:").concat(o," userIDList:"),r);var s=this.getModule(Kf).getLocalGroupProfile(o);return id(e.duration)||0===e.duration?BI({code:qm}):this.request({protocolName:nv,requestData:e}).then((function(){return a.setNetworkType(t.getNetworkType()).end(),Gl.l("".concat(n," ok")),t.deleteLocalGroupMembers(o,r),GI({group:s,userIDList:r})})).catch((function(e){return t.probeNetwork().then((function(t){var n=_(t,2),o=n[0],r=n[1];a.setError(e,o,r).end()})),Gl.e("".concat(n," failed. error:"),e),BI(e)}))}},{key:"setGroupMemberMuteTime",value:function(e){var t=this,n=e.groupID,o=e.userID,r=e.muteTime,i="".concat(this._n,".").concat("setGroupMemberMuteTime");if(o===this.getMyUserID())return BI(new UI({code:Fm}));Gl.l("".concat(i," groupID:").concat(n," userID:").concat(o));var a=new w_("setGroupMemberMuteTime");return a.setMessage("groupID:".concat(n," userID:").concat(o," muteTime:").concat(r)),this.modifyGroupMemberInfo({groupID:n,userID:o,muteTime:r}).then((function(e){a.setNetworkType(t.getNetworkType()).end(),Gl.l("".concat(i," ok"));var o=t.getModule(Kf);return GI({group:o.getLocalGroupProfile(n),member:e})})).catch((function(e){return t.probeNetwork().then((function(t){var n=_(t,2),o=n[0],r=n[1];a.setError(e,o,r).end()})),Gl.e("".concat(i," failed. error:"),e),BI(e)}))}},{key:"setGroupMemberRole",value:function(e){var t=this,n="".concat(this._n,".").concat("setGroupMemberRole"),o=e.groupID,r=e.userID,i=e.role,a=this.getModule(Kf).getLocalGroupProfile(o);if(a.selfInfo.role!==Ir.GRP_MBR_ROLE_OWNER)return BI({code:Pm});if([Ir.GRP_WORK,Ir.GRP_AVCHATROOM].includes(a.type))return BI({code:Gm});var s=[Ir.GRP_MBR_ROLE_ADMIN,Ir.GRP_MBR_ROLE_MEMBER];if(bd({groupID:o})&&s.push(Ir.GRP_MBR_ROLE_CUSTOM),s.indexOf(i)<0)return BI({code:Um});if(r===this.getMyUserID())return BI({code:xm});var u=new w_("setGroupMemberRole");return u.setMessage("groupID:".concat(o," userID:").concat(r," role:").concat(i)),Gl.l("".concat(n," groupID:").concat(o," userID:").concat(r)),this.modifyGroupMemberInfo({groupID:o,userID:r,role:i}).then((function(e){return u.setNetworkType(t.getNetworkType()).end(),Gl.l("".concat(n," ok")),GI({group:a,member:e})})).catch((function(e){return t.probeNetwork().then((function(t){var n=_(t,2),o=n[0],r=n[1];u.setError(e,o,r).end()})),Gl.e("".concat(n," failed. error:"),e),BI(e)}))}},{key:"_filterProfanity",value:function(e,t){var n=this.getModule(ph);if(!n)return!0;var o=n.filterText(t[e],jc),r=o.isAllowedToSend,i=o.modifiedText;return!0===r&&(t[e]=i,!0)}},{key:"setGroupMemberNameCard",value:function(e){var t=this,n="".concat(this._n,".").concat("setGroupMemberNameCard");if(e.nameCard&&!1===this._filterProfanity("nameCard",e))return BI({code:f_});var o=e.groupID,r=e.userID,i=void 0===r?this.getMyUserID():r,a=e.nameCard;Gl.l("".concat(n," groupID:").concat(o," userID:").concat(i));var s=new w_("setGroupMemberNameCard");return s.setMessage("groupID:".concat(o," userID:").concat(i," nameCard:").concat(a)),this.modifyGroupMemberInfo({groupID:o,userID:i,nameCard:a}).then((function(e){Gl.l("".concat(n," ok")),s.setNetworkType(t.getNetworkType()).end();var r=t.getModule(Kf).getLocalGroupProfile(o);return i===t.getMyUserID()&&r&&r.setSelfNameCard(a),GI({group:r,member:e})})).catch((function(e){return t.probeNetwork().then((function(t){var n=_(t,2),o=n[0],r=n[1];s.setError(e,o,r).end()})),Gl.e("".concat(n," failed. error:"),e),BI(e)}))}},{key:"setGroupMemberCustomField",value:function(e){var t=this,n="".concat(this._n,".").concat("setGroupMemberCustomField"),o=e.groupID,r=e.userID,i=void 0===r?this.getMyUserID():r,a=e.memberCustomField;Gl.l("".concat(n," groupID:").concat(o," userID:").concat(i));var s=new w_("setGroupMemberCustomField");return s.setMessage("groupID:".concat(o," userID:").concat(i," memberCustomField:").concat(JSON.stringify(a))),this.modifyGroupMemberInfo({groupID:o,userID:i,memberCustomField:a}).then((function(e){s.setNetworkType(t.getNetworkType()).end(),Gl.l("".concat(n," ok"));var r=t.getModule(Kf).getLocalGroupProfile(o);return GI({group:r,member:e})})).catch((function(e){return t.probeNetwork().then((function(t){var n=_(t,2),o=n[0],r=n[1];s.setError(e,o,r).end()})),Gl.e("".concat(n," failed. error:"),e),BI(e)}))}},{key:"modifyGroupMemberInfo",value:function(e){var n=this,o=e.groupID,r=e.userID,i=void 0;return Dd(o)&&(o=Vd(i=o)),this.request({protocolName:ov,requestData:t(t({},e),{},{groupID:o,topicID:i})}).then((function(){if(n.hasLocalGroupMember(o,r)){var t=n.getLocalGroupMemberInfo(o,r);return id(e.muteTime)||t.updateMuteUntil(e.muteTime),id(e.role)||t.updateRole(e.role),id(e.nameCard)||t.updateNameCard(e.nameCard),id(e.memberCustomField)||t.updateMemberCustomField(e.memberCustomField),t}return n.getGroupMemberProfile({groupID:o,userIDList:[r]}).then((function(e){return _(e.data.memberList,1)[0]}))}))}},{key:"markGroupMemberList",value:function(e){var t=this,n="".concat(this._n,".").concat("markGroupMemberList"),o=e.groupID,r=e.markType,i=e.enableMark,a=e.userIDList,s=void 0===a?[]:a,u="groupID:".concat(o," markType:").concat(r," enableMark:").concat(i," userIDList count: ").concat(s.length);Gl.l("".concat(n," ").concat(u));var c=2,l=[];!0===i&&(c=1);var d=y(s);s.length>500&&(d=s.slice(0,500),Gl.w("".concat(n," ").concat(Zd(500)))),d.forEach((function(e){l.push({userID:e,markType:[r]})})),d=null;var p=new w_("markGroupMemberList");return p.setMessage("".concat(u)),this.request({protocolName:rv,requestData:{groupID:o,operationType:c,memberList:l}}).then((function(e){var o=e.data.memberList,r=void 0===o?[]:o,i=[],a=[];r.length===s.length?i.push.apply(i,y(s)):(r.forEach((function(e){i.push(e.userID)})),s.forEach((function(e){i.includes(e)||a.push(e)})));var u="success count:".concat(i.length," fail count:").concat(a.length);return p.setNetworkType(t.getNetworkType()).setMessage(u).end(),Gl.l("".concat(n," ok. ").concat(u)),GI({successUserIDList:i,failureUserIDList:a})})).catch((function(e){return t.probeNetwork().then((function(t){var n=_(t,2),o=n[0],r=n[1];p.setError(e,o,r).end()})),Gl.e("".concat(n," failed. error:"),e),BI(e)}))}},{key:"_getGroupMemberProfileAdvance",value:function(e){return this.request({protocolName:Qg,requestData:t(t({},e),{},{memberInfoFilter:e.memberInfoFilter?e.memberInfoFilter:["Role","JoinTime","NameCard","ShutUpUntil"]})})}},{key:"_updateLocalGroupMemberMap",value:function(e,t){var n=this;return rd(t)&&0!==t.length?t.map((function(t){return n.hasLocalGroupMember(e,t.userID)?n.getLocalGroupMemberInfo(e,t.userID).updateMember(t):n.setLocalGroupMember(e,new WC(t)),n.getLocalGroupMemberInfo(e,t.userID)})):[]}},{key:"deleteLocalGroupMembers",value:function(e,t){var n=this.groupMemberListMap.get(e);n&&t.forEach((function(e){n.delete(e)}))}},{key:"getLocalGroupMemberInfo",value:function(e,t){return this.groupMemberListMap.has(e)?this.groupMemberListMap.get(e).get(t):null}},{key:"setLocalGroupMember",value:function(e,t){if(this.groupMemberListMap.has(e))this.groupMemberListMap.get(e).set(t.userID,t);else{var n=(new Map).set(t.userID,t);this.groupMemberListMap.set(e,n)}}},{key:"getLocalGroupMemberList",value:function(e){return this.groupMemberListMap.get(e)}},{key:"hasLocalGroupMember",value:function(e,t){return this.groupMemberListMap.has(e)&&this.groupMemberListMap.get(e).has(t)}},{key:"hasLocalGroupMemberMap",value:function(e){return this.groupMemberListMap.has(e)}},{key:"reset",value:function(){this.groupMemberListMap.clear()}}]),o}(vh),JC=["topicID","topicName","avatar","introduction","notification","unreadCount","muteAllMembers","customData","groupAtInfoList","nextMessageSeq","selfInfo"],XC=function(e,t){return Yd(e)?{lastTime:0,lastSequence:0,fromAccount:"",payload:null,type:"",messageForShow:"",nick:"",version:0,cloudCustomData:"",isRevoked:!1,revoker:null}:{lastTime:e.time||0,lastSequence:e.sequence||0,fromAccount:e.from||"",payload:e.payload||null,type:e.type||"",messageForShow:Hd(e.type,e.payload,t),nick:e.nick||"",version:e.version||0,cloudCustomData:e.cloudCustomData||"",isRevoked:e.isRevoked||!1,revoker:e.revoker||null}},$C=function(){function e(t,n){r(this,e),this.topicID="",this.topicName="",this.avatar="",this.introduction="",this.notification="",this.unreadCount=0,this.muteAllMembers=!1,this.customData="",this.groupAtInfoList=[],this.nextMessageSeq=0,this.lastMessage=XC(t.lastMessage,n),this.selfInfo={muteTime:0,readedSequence:0,messageRemindType:"",excludedUnreadSequenceList:void 0},this._initTopic(t)}return a(e,[{key:"_initTopic",value:function(e){for(var t in e)JC.indexOf(t)<0||("selfInfo"===t?this.updateSelfInfo(e[t]):this[t]="muteAllMembers"===t?1===e[t]:e[t])}},{key:"updateUnreadCount",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.unreadCount=e}},{key:"updateNextMessageSeq",value:function(e){this.nextMessageSeq=e}},{key:"updateLastMessage",value:function(e){this.lastMessage=XC(e)}},{key:"updateGroupAtInfoList",value:function(e){this.groupAtInfoList=JSON.parse(JSON.stringify(e))}},{key:"updateTopic",value:function(e){id(e.selfInfo)||this.updateSelfInfo(e.selfInfo),id(e.muteAllMembers)||(this.muteAllMembers=1===e.muteAllMembers),fd(this,e,["groupID","lastMessageTime","selfInfo","muteAllMembers","lastMsg"])}},{key:"updateSelfInfo",value:function(e){return 0!==fd(this.selfInfo,e,[],[""])}},{key:"reduceUnreadCount",value:function(){return this.unreadCount>=1&&(this.unreadCount-=1,!0)}},{key:"isLastMessageRevoked",value:function(e){return e.sequence===this.lastMessage.lastSequence}},{key:"setLastMessageRevoked",value:function(e){this.lastMessage.isRevoked=e}},{key:"setLastMessageRevoker",value:function(e){this.lastMessage.revoker=e}}]),e}(),QC=function(e){u(o,e);var n=m(o);function o(e){var t;return r(this,o),(t=n.call(this,e))._n="TopicModule",t._topicMap=new Map,t._getTopicTimeMap=new Map,t.TOPIC_CACHE_TIME=300,t.TOPIC_LAST_ACTIVE_TIME=3600,t.getInnerEmitterInstance().on(iC,t._onCloudConfigUpdated,g(t)),t}return a(o,[{key:"_onCloudConfigUpdated",value:function(){var e=this.getCloudConfig("topic_cache_time"),t=this.getCloudConfig("topic_last_active_time");id(e)||(this.TOPIC_CACHE_TIME=Number(e)),id(t)||(this.TOPIC_LAST_ACTIVE_TIME=Number(t))}},{key:"onTopicCreated",value:function(e){var t=e.groupID;this.resetGetTopicTime(t),this.emitOuterEvent(Mr.TOPIC_CREATED,e)}},{key:"onTopicDeleted",value:function(e){var t=this,n=e.groupID,o=e.topicIDList;(void 0===o?[]:o).forEach((function(e){t._deleteLocalTopic(n,e)})),this.emitOuterEvent(Mr.TOPIC_DELETED,e)}},{key:"onTopicMessageRemindTypeUpdated",value:function(e){var t=e.groupID,n=e.topicID,o=e.messageRemindType,r=this.getLocalTopic(t,n);if(r){var i=r.updateSelfInfo({messageRemindType:o});i&&this.emitOuterEvent(Mr.TOPIC_UPDATED,{groupID:t,topic:r}),Gl.d("".concat(this._n,".onTopicMessageRemindTypeUpdated topicID:").concat(n)+" messageRemindType:".concat(o," isTopicUpdated:").concat(i))}}},{key:"onTopicProfileUpdated",value:function(e){var t=e.groupID,n=e.topicID,o=this.getLocalTopic(t,n);o&&(o.updateTopic(e),this.emitOuterEvent(Mr.TOPIC_UPDATED,{groupID:t,topic:o}))}},{key:"onConversationProxy",value:function(e){var t=e.topicID,n=e.unreadCount,o=e.groupAtInfoList,r=Vd(t),i=this.getLocalTopic(r,t),a=!1;i&&(id(n)||i.unreadCount===n||(i.updateUnreadCount(n),a=!0),id(o)||(i.updateGroupAtInfoList(o),a=!0)),a&&this.emitOuterEvent(Mr.TOPIC_UPDATED,{groupID:r,topic:i})}},{key:"onMessageSent",value:function(e){var t=e.groupID,n=e.topicID,o=e.lastMessage,r=this.getLocalTopic(t,n);r&&(r.nextMessageSeq+=1,r.updateLastMessage(o),this.emitOuterEvent(Mr.TOPIC_UPDATED,{groupID:t,topic:r}))}},{key:"onMessageModified",value:function(e){var t=e.to,n=e.time,o=e.sequence,r=e.elements,i=e.cloudCustomData,a=e.messageVersion,s=Vd(t),u=this.getLocalTopic(s,t);if(u){var c=u.lastMessage;Gl.d("".concat(this._n,".onMessageModified topicID:").concat(t," lastMessage:"),JSON.stringify(c),"options:",JSON.stringify(e)),c&&(null===c.payload||c.lastTime===n&&c.lastSequence===o&&c.version!==a)&&(c.type=r[0].type,c.payload=r[0].content,c.messageForShow=Hd(c.type,c.payload,this.isIntl()),c.cloudCustomData=i,c.version=a,c.lastSequence=o,c.lastTime=n,this.emitOuterEvent(Mr.TOPIC_UPDATED,{groupID:s,topic:u}))}}},{key:"onMessageRevoked",value:function(e){var t=this;if(0!==e.length){var n=null,o=null,r=!1;e.forEach((function(e){var i=e.to;o=Vd(i),(n=t.getLocalTopic(o,i))&&(n.reduceUnreadCount()&&(r=!0),n.isLastMessageRevoked(e)&&(n.setLastMessageRevoked(!0),n.setLastMessageRevoker(e.revoker),r=!0))})),r&&this.emitOuterEvent(Mr.TOPIC_UPDATED,{groupID:o,topic:n})}}},{key:"isLastMessageRevoked",value:function(e){var t=e.topicID,n=e.sequence,o=Vd(t),r=this.getLocalTopic(o,t),i=!1;return r&&(i=r.isLastMessageRevoked({sequence:n})),i}},{key:"getJoinedCommunityList",value:function(){return this.getModule(Kf).getGroupList({isGroupWithTopicOnly:!0}).then((function(e){var t=e.data.groupList;return GI({groupList:void 0===t?[]:t})})).catch((function(e){return BI(e)}))}},{key:"createTopicInCommunity",value:function(e){var n=this,o="".concat(this._n,".").concat("createTopicInCommunity"),r=e.topicID;if(!id(r)&&!Dd(r))return BI({code:d_});if(e.topicName&&!1===this._filterProfanity("topicName",e))return BI({code:f_});if(e.introduction&&!1===this._filterProfanity("introduction",e))return BI({code:f_});if(e.notification&&!1===this._filterProfanity("notification",e))return BI({code:f_});var i=new w_("createTopicInCommunity");return this.request({protocolName:Iv,requestData:t({},e)}).then((function(r){var a=r.data.topicID;return i.setMessage("topicID:".concat(a)).setNetworkType(n.getNetworkType()).end(),Gl.l("".concat(o," ok")),n._updateTopicMap([t(t({},e),{},{topicID:a})]),GI({topicID:a})})).catch((function(e){return n.probeNetwork().then((function(t){var n=_(t,2),o=n[0],r=n[1];i.setError(e,o,r).end()})),Gl.e("".concat(o," failed. error:"),e),BI(e)}))}},{key:"deleteTopicFromCommunity",value:function(e){var t=this,n="".concat(this._n,".").concat("deleteTopicFromCommunity"),o=e.groupID,r=e.topicIDList,i=void 0===r?[]:r,a=new w_("deleteTopicFromCommunity");return a.setMessage("groupID:".concat(o," topicIDList:").concat(i)),this.request({protocolName:Cv,requestData:{groupID:o,topicIDList:i}}).then((function(e){var n=e.data.resultList,r=[],i=[];(void 0===n?[]:n).forEach((function(e){var t=e.topicID,n=e.errorCode,o=e.errorInfo;0===n?r.push({topicID:t}):i.push({topicID:t,code:n,message:o})}));var s="success count:".concat(r.length,", fail count:").concat(i.length);return a.setMoreMessage("".concat(s)).setNetworkType(t.getNetworkType()).end(),Gl.l("".concat(s)),r.forEach((function(e){t._deleteLocalTopic(o,e.topicID)})),GI({successTopicList:r,failureTopicList:i})})).catch((function(e){return t.probeNetwork().then((function(t){var n=_(t,2),o=n[0],r=n[1];a.setError(e,o,r).end()})),Gl.e("".concat(n," failed. error:"),e),BI(e)}))}},{key:"updateTopicProfile",value:function(e){var n=this,o="".concat(this._n,".").concat("updateTopicProfile");if(Gl.l("".concat(o," options:"),e),e.topicName&&!1===this._filterProfanity("topicName",e))return BI({code:f_});if(e.introduction&&!1===this._filterProfanity("introduction",e))return BI({code:f_});if(e.notification&&!1===this._filterProfanity("notification",e))return BI({code:f_});var r=new w_("updateTopicProfile");return r.setMessage("groupID:".concat(e.groupID," topicID:").concat(e.topicID)),id(e.muteAllMembers)||(e.muteAllMembers=!0===e.muteAllMembers?"On":"Off"),this.request({protocolName:kv,requestData:t({},e)}).then((function(){return r.setNetworkType(n.getNetworkType()).end(),Gl.l("".concat(o," ok")),n._updateTopicMap([e]),GI({topic:n.getLocalTopic(e.groupID,e.topicID)})})).catch((function(e){return n.probeNetwork().then((function(t){var n=_(t,2),o=n[0],i=n[1];r.setError(e,o,i).end()})),Gl.e("".concat(o," failed. error:"),e),BI(e)}))}},{key:"getTopicList",value:function(e){var n=this,o="".concat(this._n,".").concat("getTopicList"),r=e.groupID,i=e.topicIDList,a=void 0===i?[]:i,s=0===a.length,u=new w_("getTopicList");if(u.setMessage("groupID:".concat(r)),this._getTopicTimeMap.has(r)){var c=this._getTopicTimeMap.get(r),l=c.isGetAll,d=c.time;if((l||!l&&!s)&&Date.now()-d<1e3*this.TOPIC_CACHE_TIME){var p=this._getLocalTopicList(r,a);if(s||p.length===a.length)return u.setNetworkType(this.getNetworkType()).setMoreMessage("from cache, topic count:".concat(p.length)).end(),Gl.l("".concat(o," groupID:").concat(r," from cache, topic count:").concat(p.length)),qI({successTopicList:p,failureTopicList:[]})}}return this.request({protocolName:Tv,requestData:{groupID:r,topicIDList:a}}).then((function(e){var i=e.data.topicInfoList,a=[],c=[],l=[];(void 0===i?[]:i).forEach((function(e){var n=e.topic,o=e.selfInfo,r=e.errorCode,i=e.errorInfo,s=n.topicID;0===r?(a.push(t(t({},n),{},{selfInfo:o})),c.push(s)):l.push({topicID:s,code:r,message:i})})),n._updateTopicMap(a),n._handleTopicAtInfo(a);var d="success count:".concat(c.length,", fail count:").concat(l.length);u.setNetworkType(n.getNetworkType()).setMoreMessage("".concat(d)).end(),Gl.l("".concat(o," groupID:").concat(r," from remote, ").concat(d));var p=[];return Yd(c)||(n._getTopicTimeMap.set(r,{time:Date.now(),isGetAll:s}),p=n._getLocalTopicList(r,c)),GI({successTopicList:p,failureTopicList:l})})).catch((function(e){return n.probeNetwork(e).then((function(t){var n=_(t,2),o=n[0],r=n[1];u.setError(e,o,r).end()})),Gl.e("".concat(o," failed. error:"),e),BI(e)}))}},{key:"hasLocalTopic",value:function(e,t){return!!this._topicMap.has(e)&&this._topicMap.get(e).has(t)}},{key:"getLocalTopic",value:function(e,t){var n=null;return this._topicMap.has(e)&&(n=this._topicMap.get(e).get(t)),n}},{key:"_getLocalTopicList",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=this._topicMap.get(e),o=[];return n&&(o=y(n.values())),0===t.length?o:o.filter((function(e){return t.includes(e.topicID)}))}},{key:"_deleteLocalTopic",value:function(e,t){this._topicMap.has(e)&&(this._topicMap.get(e).delete(t),Gl.l("".concat(this._n,"._deleteLocalTopic groupID:").concat(e," topicID:").concat(t)))}},{key:"_updateTopicMap",value:function(e){var t=this,n=[];e.forEach((function(e){var o=e.groupID,r=e.topicID,i=null;t._topicMap.has(o)||t._topicMap.set(o,new Map),t._topicMap.get(o).has(r)?(i=t._topicMap.get(o).get(r)).updateTopic(e):(t._getTopicLastMessage(e),i=new $C(e,t.isIntl()),t._topicMap.get(o).set(r,i));var a=t._computeUnreadCount(i);i.updateUnreadCount(a),n.push({conversationID:"".concat(Ir.CONV_GROUP).concat(r),type:Ir.CONV_TOPIC,unreadCount:a})})),n.length>0&&this.getModule(Wf).updateTopicConversation(n)}},{key:"resetGetTopicTime",value:function(e){var t=this;id(e)?y(this._getTopicTimeMap.keys()).forEach((function(e){t._getTopicTimeMap.set(e,0)})):this._getTopicTimeMap.set(e,0)}},{key:"getTopicListOnReconnected",value:function(){var e=this,t=y(this._topicMap.keys()),n=[];t.forEach((function(t){var o=[];e._getLocalTopicList(t).forEach((function(t){var n=t.lastMessage.lastTime,r=void 0===n?0:n;Date.now()-1e3*r<1e3*e.TOPIC_LAST_ACTIVE_TIME&&o.push(t.topicID)})),o.length>0&&n.push({groupID:t,topicIDList:o})})),Gl.l("".concat(this._n,".getTopicListOnReconnected. active community count:").concat(n.length)),this._relayGetTopicList(n)}},{key:"_relayGetTopicList",value:function(e){var t=this;if(0!==e.length){var n=e.shift(),o=n.topicIDList.length>5?"topicIDList.length:".concat(n.topicIDList.length):"topicIDList:".concat(n.topicIDList),r=new w_("relayGetTopicList");r.setMessage(o),Gl.l("".concat(this._n,"._relayGetTopicList. ").concat(o)),this.getTopicList(n).then((function(){r.setNetworkType(t.getNetworkType()).end(),t._relayGetTopicList(e)})).catch((function(n){t.probeNetwork().then((function(e){var t=_(e,2),o=t[0],i=t[1];r.setError(n,o,i).end()})),t._relayGetTopicList(e)}))}}},{key:"_handleTopicAtInfo",value:function(e){var n=this;0!==e.length&&e.forEach((function(e){var o=e.groupID,r=e.topicID,i=e.groupAtInfoList,a=[];id(i)||(i.forEach((function(e){a.push(t(t({},e),{},{groupID:o,topicID:r}))})),n.getModule(Wf).onNewGroupAtTips({dataList:a}))}))}},{key:"_getTopicLastMessage",value:function(e){if(!id(e.lastMsg)){var t={time:e.lastMsg.time,sequence:e.lastMsg.sequence,from:e.lastMsg.from,payload:e.lastMsg.elements[0]?e.lastMsg.elements[0].content:null,type:e.lastMsg.elements[0]?e.lastMsg.elements[0].type:"",nick:e.lastMsg.nick,version:e.lastMsg.messageVersion,cloudCustomData:e.lastMsg.cloudCustomData,isRevoked:2===e.lastMsg.isPlaceMessage,revoker:Yd(e.lastMsg.revokerInfo)?null:e.lastMsg.revokerInfo.revoker};e.lastMessage=t}}},{key:"deleteTopicListInCommunity",value:function(e){var t=this,n=this._getLocalTopicList(e),o=this.getModule(Wf);n.forEach((function(n){var r=n.topicID;t._deleteLocalTopic(e,r),t._getTopicTimeMap.delete(e),o.deleteLocalConversation("".concat(Ir.CONV_GROUP).concat(r))}))}},{key:"_computeUnreadCount",value:function(e){var t=e.selfInfo,n=t.excludedUnreadSequenceList,o=t.readedSequence,r=e.nextMessageSeq-e.selfInfo.readedSequence-1;if(rd(n)){var i=0;n.forEach((function(t){t>=o&&t<=e.nextMessageSeq-1&&(i+=1)})),i>=1&&(r-=i)}return r<0?0:r}},{key:"_filterProfanity",value:function(e,t){var n=this.getModule(ph);if(!n)return!0;var o=n.filterText(t[e],Kc),r=o.isAllowedToSend,i=o.modifiedText;return!0===r&&(t[e]=i,!0)}},{key:"updateLastMessage",value:function(e,t){var n=Vd(e),o=this.getLocalTopic(n,e);if(o){var r=t.sequence+1;o.updateNextMessageSeq(r),o.updateLastMessage(t),this.emitOuterEvent(Mr.TOPIC_UPDATED,{groupID:n,topic:o})}}},{key:"reset",value:function(){Gl.l("".concat(this._n,".reset")),this._topicMap.clear(),this._getTopicTimeMap.clear(),this.TOPIC_CACHE_TIME=300,this.TOPIC_LAST_ACTIVE_TIME=3600}}]),o}(vh),ek=function(){function e(t){r(this,e),this._userModule=t,this._n="ProfileHandler",this.TAG="profile",this.accountProfileMap=new Map,this.expirationTime=864e5}return a(e,[{key:"setExpirationTime",value:function(e){this.expirationTime=e}},{key:"getUserProfile",value:function(e){var t=this,n=e.userIDList;e.fromAccount=this._userModule.getMyAccount(),n.length>100&&(Gl.w("".concat(this._n,".getUserProfile ").concat(Zd(100))),n.length=100);for(var o,r=[],i=[],a=0,s=n.length;a<s;a++)o=n[a],this._userModule.isMyFriend(o)&&this._containsAccount(o)?i.push(this._getProfileFromMap(o)):r.push(o);if(0===r.length)return qI(i);e.toAccount=r;var u=e.bFromGetMyProfile||!1,c=[];e.toAccount.forEach((function(e){c.push({toAccount:e,standardSequence:0,customSequence:0})})),e.userItem=c;var l=new w_("getUserProfile");return l.setMessage(n.length>5?"userIDList.length:".concat(n.length):"userIDList:".concat(n)),this._userModule.request({protocolName:Sh,requestData:e}).then((function(e){l.setNetworkType(t._userModule.getNetworkType()).end(),Gl.i("".concat(t._n,".getUserProfile ok"));var n=t._handleResponse(e).concat(i);return GI(u?n[0]:n)})).catch((function(e){return t._userModule.probeNetwork().then((function(t){var n=_(t,2),o=n[0],r=n[1];l.setError(e,o,r).end()})),Gl.e("".concat(t._n,".getUserProfile failed. error:"),e),BI(e)}))}},{key:"getMyProfile",value:function(){var e=this._userModule.getMyAccount();if(Gl.l("".concat(this._n,".getMyProfile myAccount:").concat(e)),this._fillMap(),this._containsAccount(e)){var t=this._getProfileFromMap(e);return Gl.d("".concat(this._n,".getMyProfile from cache, myProfile:")+JSON.stringify(t)),qI(t)}return this.getUserProfile({fromAccount:e,userIDList:[e],bFromGetMyProfile:!0})}},{key:"_handleResponse",value:function(e){for(var t,n,o=pd(),r=e.data.userProfileItem,i=[],a=0,s=r.length;a<s;a++)"@TLS#NOT_FOUND"!==r[a].to&&""!==r[a].to&&(t=r[a].to,n=this._updateMap(t,this._getLatestProfileFromResponse(t,r[a].profileItem)),i.push(n));return Gl.l("".concat(this._n,"._handleResponse cost ").concat(pd()-o," ms")),i}},{key:"_getLatestProfileFromResponse",value:function(e,t){var n={};if(n.userID=e,n.profileCustomField=[],!Yd(t))for(var o=0,r=t.length;o<r;o++)if(t[o].tag.indexOf("Tag_Profile_Custom")>-1)n.profileCustomField.push({key:t[o].tag,value:t[o].value});else switch(t[o].tag){case xl.NICK:n.nick=t[o].value;break;case xl.GENDER:n.gender=t[o].value;break;case xl.BIRTHDAY:n.birthday=t[o].value;break;case xl.LOCATION:n.location=t[o].value;break;case xl.SELFSIGNATURE:n.selfSignature=t[o].value;break;case xl.ALLOWTYPE:n.allowType=t[o].value;break;case xl.LANGUAGE:n.language=t[o].value;break;case xl.AVATAR:n.avatar=t[o].value;break;case xl.MESSAGESETTINGS:n.messageSettings=t[o].value;break;case xl.ADMINFORBIDTYPE:n.adminForbidType=t[o].value;break;case xl.LEVEL:n.level=t[o].value;break;case xl.ROLE:n.role=t[o].value;break;default:Gl.w("".concat(this._n,"._handleResponse unknown tag:"),t[o].tag,t[o].value)}return n}},{key:"updateMyProfile",value:function(e){var t=this,n="".concat(this._n,".updateMyProfile");if(e.nick&&!1===this._userModule.filterProfanity("nick",e))return BI({code:f_});if(e.selfSignature&&!1===this._userModule.filterProfanity("selfSignature",e))return BI({code:f_});var o=new w_("updateMyProfile");o.setMessage(JSON.stringify(e));var r=(new hC).validate(e);if(!r.valid)return o.setCode(zm).setMoreMessage("updateMyProfile info:".concat(r.tips)).setNetworkType(this._userModule.getNetworkType()).end(),Gl.e("".concat(n," info:").concat(r.tips)),BI({code:zm});var i=[];for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&("profileCustomField"===a?e.profileCustomField.forEach((function(e){i.push({tag:e.key,value:e.value})})):i.push({tag:xl[a.toUpperCase()],value:e[a]}));if(0===i.length){var s=new UI({code:Zm});return o.setError(s,!0,this._userModule.getNetworkType()).end(),Gl.e("".concat(n," failed. error:"),s),BI(s)}return this._userModule.request({protocolName:bh,requestData:{fromAccount:this._userModule.getMyAccount(),profileItem:i}}).then((function(r){o.setNetworkType(t._userModule.getNetworkType()).end(),Gl.i("".concat(n," ok"));var i=t._updateMap(t._userModule.getMyAccount(),e);return t._userModule.emitOuterEvent(Mr.PROFILE_UPDATED,[i]),qI(i)})).catch((function(e){return t._userModule.probeNetwork().then((function(t){var n=_(t,2),r=n[0],i=n[1];o.setError(e,r,i).end()})),Gl.e("".concat(n," failed. error:"),e),BI(e)}))}},{key:"onProfileModified",value:function(e){var t=e.dataList;if(!Yd(t)){var n,o,r=t.length;Gl.d("".concat(this._n,".onProfileModified count:").concat(r," dataList:"),e.dataList);for(var i=[],a=0;a<r;a++)n=t[a].userID,o=this._updateMap(n,this._getLatestProfileFromResponse(n,t[a].profileList)),i.push(o);i.length>0&&(this._userModule.emitInnerEvent(aC,i),this._userModule.emitOuterEvent(Mr.PROFILE_UPDATED,i))}}},{key:"_fillMap",value:function(){if(0===this.accountProfileMap.size){for(var e=this._getCachedProfiles(),t=Date.now(),n=0,o=e.length;n<o;n++)t-e[n].lastUpdatedTime<this.expirationTime&&this.accountProfileMap.set(e[n].userID,e[n]);Gl.l("".concat(this._n,"._fillMap from cache, map.size:").concat(this.accountProfileMap.size))}}},{key:"_updateMap",value:function(e,t){var n,o=Date.now();return this._containsAccount(e)?(n=this._getProfileFromMap(e),t.profileCustomField&&kd(n.profileCustomField,t.profileCustomField),fd(n,t,["profileCustomField"]),n.lastUpdatedTime=o):(n=new hC(t),(this._userModule.isMyFriend(e)||e===this._userModule.getMyAccount())&&(n.lastUpdatedTime=o,this.accountProfileMap.set(e,n))),this._flushMap(e===this._userModule.getMyAccount()),n}},{key:"_flushMap",value:function(e){var t=y(this.accountProfileMap.values()),n=this._userModule.getStorageModule();Gl.d("".concat(this._n,"._flushMap length:").concat(t.length," flushAtOnce:").concat(e)),n.setItem(this.TAG,t,e)}},{key:"_containsAccount",value:function(e){return this.accountProfileMap.has(e)}},{key:"_getProfileFromMap",value:function(e){return this.accountProfileMap.get(e)}},{key:"_getCachedProfiles",value:function(){var e=this._userModule.getStorageModule().getItem(this.TAG);return Yd(e)?[]:e}},{key:"onConversationsProfileUpdated",value:function(e){for(var t,n,o,r=[],i=0,a=e.length;i<a;i++)n=(t=e[i]).userID,this._userModule.isMyFriend(n)||(this._containsAccount(n)?(o=this._getProfileFromMap(n),fd(o,t)>0&&r.push(n)):r.push(t.userID));0!==r.length&&(Gl.i("".concat(this._n,".onConversationsProfileUpdated toAccountList:").concat(r)),this.getUserProfile({userIDList:r}))}},{key:"getNickAndAvatarByUserID",value:function(e){if(this._containsAccount(e)){var t=this._getProfileFromMap(e);return{nick:t.nick,avatar:t.avatar}}return{nick:"",avatar:""}}},{key:"reset",value:function(){this._flushMap(!0),this.accountProfileMap.clear()}}]),e}(),tk=a((function e(t){r(this,e),Yd||(this.userID=t.userID||"",this.timeStamp=t.timeStamp||0)})),nk=function(){function e(t){r(this,e),this._userModule=t,this._n="BlacklistHandler",this._blacklistMap=new Map,this.startIndex=0,this.maxLimited=100,this.currentSequence=0}return a(e,[{key:"getLocalBlacklist",value:function(){return y(this._blacklistMap.keys())}},{key:"getBlacklist",value:function(){var e=this,t="".concat(this._n,".getBlacklist"),n={fromAccount:this._userModule.getMyAccount(),maxLimited:this.maxLimited,startIndex:0,lastSequence:this.currentSequence},o=new w_("getBlacklist");return this._userModule.request({protocolName:Dh,requestData:n}).then((function(n){var r=n.data,i=r.blackListItem,a=r.currentSequence,s=Yd(i)?0:i.length;o.setNetworkType(e._userModule.getNetworkType()).setMessage("count:".concat(s)).end(),Gl.i("".concat(t," ok")),e.currentSequence=a,e._handleResponse(i,!0),e._userModule.emitOuterEvent(Mr.BLACKLIST_UPDATED,y(e._blacklistMap.keys()))})).catch((function(n){return e._userModule.probeNetwork().then((function(e){var t=_(e,2),r=t[0],i=t[1];o.setError(n,r,i).end()})),Gl.e("".concat(t," failed. error:"),n),BI(n)}))}},{key:"addBlacklist",value:function(e){var t=this,n=new w_("addToBlacklist"),o="".concat(this._n,".addBlacklist"),r=this._userModule.getMyAccount();if(1===e.userIDList.length&&e.userIDList[0]===r){var i=Wm,a=this._userModule.getErrorMessage(i);n.setCode(i).setMessage(a).setNetworkType(this._userModule.getNetworkType()).end();var s=new UI({code:i});return Gl.e("".concat(o," failed. error:"),s),BI(s)}return e.userIDList.includes(r)&&(e.userIDList=e.userIDList.filter((function(e){return e!==r}))),e.fromAccount=this._userModule.getMyAccount(),e.toAccount=e.userIDList,this._userModule.request({protocolName:Eh,requestData:e}).then((function(r){return n.setNetworkType(t._userModule.getNetworkType()).setMessage(e.userIDList.length>5?"userIDList.length:".concat(e.userIDList.length):"userIDList:".concat(e.userIDList)).end(),Gl.i("".concat(o," ok")),t._handleResponse(r.resultItem,!0),GI(y(t._blacklistMap.keys()))})).catch((function(e){return t._userModule.probeNetwork().then((function(t){var o=_(t,2),r=o[0],i=o[1];n.setError(e,r,i).end()})),Gl.e("".concat(o," failed. error:"),e),BI(e)}))}},{key:"_handleResponse",value:function(e,t){if(!Yd(e))for(var n,o,r,i=0,a=e.length;i<a;i++)o=e[i].to,r=e[i].resultCode,(id(r)||0===r)&&(t?((n=this._blacklistMap.has(o)?this._blacklistMap.get(o):new tk).userID=o,!Yd(e[i].addBlackTimeStamp)&&(n.timeStamp=e[i].addBlackTimeStamp),this._blacklistMap.set(o,n)):this._blacklistMap.has(o)&&(n=this._blacklistMap.get(o),this._blacklistMap.delete(o)));Gl.l("".concat(this._n,"._handleResponse total:").concat(this._blacklistMap.size," bAdd:").concat(t))}},{key:"deleteBlacklist",value:function(e){var t=this,n="".concat(this._n,".deleteBlacklist"),o=new w_("removeFromBlacklist");return e.fromAccount=this._userModule.getMyAccount(),e.toAccount=e.userIDList,this._userModule.request({protocolName:Ah,requestData:e}).then((function(r){return o.setNetworkType(t._userModule.getNetworkType()).setMessage(e.userIDList.length>5?"userIDList.length:".concat(e.userIDList.length):"userIDList:".concat(e.userIDList)).end(),Gl.i("".concat(n," ok")),t._handleResponse(r.data.resultItem,!1),GI(y(t._blacklistMap.keys()))})).catch((function(e){return t._userModule.probeNetwork().then((function(t){var n=_(t,2),r=n[0],i=n[1];o.setError(e,r,i).end()})),Gl.e("".concat(n," failed. error:"),e),BI(e)}))}},{key:"onAccountDeleted",value:function(e){for(var t,n=[],o=0,r=e.length;o<r;o++)t=e[o],this._blacklistMap.has(t)&&(this._blacklistMap.delete(t),n.push(t));n.length>0&&(Gl.l("".concat(this._n,".onAccountDeleted count:").concat(n.length," userIDList:"),n),this._userModule.emitOuterEvent(Mr.BLACKLIST_UPDATED,y(this._blacklistMap.keys())))}},{key:"onAccountAdded",value:function(e){for(var t,n=[],o=0,r=e.length;o<r;o++)t=e[o],this._blacklistMap.has(t)||(this._blacklistMap.set(t,new tk({userID:t})),n.push(t));n.length>0&&(Gl.l("".concat(this._n,".onAccountAdded count:").concat(n.length," userIDList:"),n),this._userModule.emitOuterEvent(Mr.BLACKLIST_UPDATED,y(this._blacklistMap.keys())))}},{key:"reset",value:function(){this._blacklistMap.clear(),this.startIndex=0,this.maxLimited=100,this.currentSequence=0}}]),e}(),ok=function(e){var t=String(e).replace(/[=]+$/,""),n="";if(t.length%4==1)return"";for(var o,r,i=0,a=0;r=t.charAt(a++);~r&&(o=i%4?64*o+r:r,i++%4)?n+=String.fromCharCode(255&o>>(-2*i&6)):0)r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(r);try{return decodeURIComponent(escape(n))}catch(XD){return""}},rk=function(){function e(t){r(this,e),this._userModule=t,this._n="UserStatusHandler",this.MAX_QUERY_USER_COUNT=500,this.MAX_SUBSCRIBE_USER_COUNT=100,this.MAX_UNSUBSCRIBE_USER_COUNT=100,this._userModule.getInnerEmitterInstance().on(iC,this._onCloudConfigUpdated,this)}return a(e,[{key:"_onCloudConfigUpdated",value:function(){var e=this._userModule.getCloudConfig("status_query_count"),t=this._userModule.getCloudConfig("status_sub_count"),n=this._userModule.getCloudConfig("status_unsub_count");Gl.l("".concat(this._n,"._onCloudConfigUpdated statusQueryCount:").concat(e," statusSubscribeCount:").concat(t)+" statusUnsubscribeCount:".concat(n)),id(e)||(this.MAX_QUERY_USER_COUNT=parseInt(e,10)),id(e)||(this.MAX_SUBSCRIBE_USER_COUNT=parseInt(t,10)),id(e)||(this.MAX_UNSUBSCRIBE_USER_COUNT=parseInt(n,10))}},{key:"onUserStatusUpdated",value:function(e){var t=e.dataList,n=this._userModule.getMyUserID(),o=this._userModule.getModule(Yf),r=t.map((function(e){var t=e.to,r=e.statusType,i=e.customStatus,a=ok(i);return t===n&&o.setCustomStatus(a),{userID:t,statusType:r,customStatus:a}}));this._userModule.emitOuterEvent(Mr.USER_STATUS_UPDATED,r)}},{key:"setSelfStatus",value:function(e){var t=this,n="".concat(this._n,".setSelfStatus");if(!1===this._userModule.filterProfanity("customStatus",e))return BI({code:f_});var o=new w_("setSelfStatus"),r=e.customStatus;return this._userModule.request({protocolName:Sv,requestData:{customStatus:r}}).then((function(e){return o.setNetworkType(t._userModule.getNetworkType()).setMessage("customStatus:".concat(r)).end(),Gl.l("".concat(n," ok. customStatus:").concat(r)),t._userModule.getModule(Yf).setCustomStatus(r),GI({userID:t._userModule.getMyUserID(),statusType:1,customStatus:r})})).catch((function(e){return t._userModule.probeNetwork().then((function(t){var n=_(t,2),r=n[0],i=n[1];o.setError(e,r,i).end()})),Gl.e("".concat(n," failed. error:"),e),BI(e)}))}},{key:"getUserStatus",value:function(e){var t=this,n="".concat(this._n,".getUserStatus"),o=e.userIDList,r=void 0===o?[]:o,i=this._userModule.getMyUserID(),a=y(r),s=void 0,u=a.indexOf(i);if(u>-1){a.splice(u,1);var c=this._userModule.getModule(Yf).getCustomStatus();s={userID:i,statusType:1,customStatus:c}}if(0===a.length)return qI({successUserList:[s],failureUserList:[]});if(!this._userModule.canIUse(Uc.USER_STATUS))return BI({code:p_});a.length>this.MAX_QUERY_USER_COUNT&&(Gl.w("".concat(n," ").concat(Zd(this.MAX_QUERY_USER_COUNT))),a=r.slice(0,this.MAX_QUERY_USER_COUNT));var l=new w_("getUserStatus");return this._userModule.request({protocolName:bv,requestData:{userIDList:a}}).then((function(e){var o=e.data,i=o.successUserList,a=void 0===i?[]:i,u=o.failureUserList,c=void 0===u?[]:u,d=a.map((function(e){var t=e.userID,n=e.statusType,o=e.customStatus;return{userID:t,statusType:n,customStatus:ok(o)}})),p=c.map((function(e){var t=e.userID,n=e.invalidUserID,o=e.errorCode,r=e.errorInfo;return{userID:Yd(n)?t:n,code:o,message:r}}));id(s)||d.unshift(s);var f="userID count:".concat(r.length,", success count:").concat(d.length,", fail count:").concat(p.length);return l.setNetworkType(t._userModule.getNetworkType()).setMessage("".concat(f)).end(),Gl.l("".concat(n," ok. ").concat(f,".")),GI({successUserList:d,failureUserList:p})})).catch((function(e){return t._userModule.probeNetwork().then((function(t){var n=_(t,2),o=n[0],i=n[1];l.setMessage("userID count:".concat(r.length)).setError(e,o,i).end()})),Gl.e("".concat(n," failed. error:"),e),BI(e)}))}},{key:"subscribeUserStatus",value:function(e){var t=this;if(!this._userModule.canIUse(Uc.USER_STATUS))return BI({code:p_});var n="".concat(this._n,".subscribeUserStatus"),o=e.userIDList,r=void 0===o?[]:o,i=y(r);i.length>this.MAX_SUBSCRIBE_USER_COUNT&&(Gl.w("".concat(n," ").concat(Zd(this.MAX_SUBSCRIBE_USER_COUNT))),i=r.slice(0,this.MAX_SUBSCRIBE_USER_COUNT));var a=new w_("subscribeUserStatus"),s="userID count:".concat(r.length);return Gl.l("".concat(n," ").concat(s)),this._userModule.request({protocolName:Dv,requestData:{userIDList:i}}).then((function(e){var o=e.data.failureUserList,r=(void 0===o?[]:o).map((function(e){var t=e.userID,n=e.invalidUserID,o=e.errorCode,r=e.errorInfo;return{userID:Yd(n)?t:n,code:o,message:r}}));return a.setNetworkType(t._userModule.getNetworkType()).setMessage("".concat(s," fail count:").concat(r.length)).end(),Gl.l("".concat(n," ok. fail count:").concat(r.length,".")),GI({failureUserList:r})})).catch((function(e){return t._userModule.probeNetwork().then((function(t){var n=_(t,2),o=n[0],r=n[1];a.setMessage("".concat(s)).setError(e,o,r).end()})),Gl.e("".concat(n," failed. error:"),e),BI(e)}))}},{key:"unsubscribeUserStatus",value:function(e){var t=this;if(!this._userModule.canIUse(Uc.USER_STATUS))return BI({code:p_});var n="".concat(this._n,".unsubscribeUserStatus"),o=(e||{}).userIDList,r=void 0===o?[]:o,i=y(r);r.length>this.MAX_UNSUBSCRIBE_USER_COUNT&&(Gl.w("".concat(n," ").concat(Zd(this.MAX_UNSUBSCRIBE_USER_COUNT))),i=r.slice(0,this.MAX_UNSUBSCRIBE_USER_COUNT));var a=new w_("unsubscribeUserStatus"),s="userID count:".concat(r.length);Gl.l("".concat(n," ").concat(s));var u={userIDList:i};return 0===i.length&&(u.userIDList=void 0,u.unsubscribeAll=1),this._userModule.request({protocolName:Ev,requestData:u}).then((function(e){var o=e.data.failureUserList,r=(void 0===o?[]:o).map((function(e){var t=e.userID,n=e.invalidUserID,o=e.errorCode,r=e.errorInfo;return{userID:Yd(n)?t:n,code:o,message:r}}));return a.setNetworkType(t._userModule.getNetworkType()).setMessage("".concat(s," fail count:").concat(r.length)).end(),Gl.l("".concat(n," ok. fail count:").concat(r.length,".")),GI({failureUserList:r})})).catch((function(e){return t._userModule.probeNetwork().then((function(t){var n=_(t,2),o=n[0],r=n[1];a.setMessage("".concat(s)).setError(e,o,r).end()})),Gl.e("".concat(n," failed. error:"),e),BI(e)}))}},{key:"reset",value:function(){this.MAX_QUERY_USER_COUNT=500,this.MAX_SUBSCRIBE_USER_COUNT=100,this.MAX_UNSUBSCRIBE_USER_COUNT=100}}]),e}(),ik=function(e){u(n,e);var t=m(n);function n(e){var o;return r(this,n),(o=t.call(this,e))._n="UserModule",o._profileHandler=new ek(g(o)),o._blacklistHandler=new nk(g(o)),o._userStatusHandler=new rk(g(o)),o.getInnerEmitterInstance().on(rC,o.onContextUpdated,g(o)),o}return a(n,[{key:"onContextUpdated",value:function(e){this._profileHandler.getMyProfile(),this._blacklistHandler.getBlacklist()}},{key:"onProfileModified",value:function(e){this._profileHandler.onProfileModified(e)}},{key:"onRelationChainModified",value:function(e){var t=e.dataList;if(!Yd(t)){var n=[];t.forEach((function(e){e.blackListDelAccount&&n.push.apply(n,y(e.blackListDelAccount))})),n.length>0&&this._blacklistHandler.onAccountDeleted(n);var o=[];t.forEach((function(e){e.blackListAddAccount&&o.push.apply(o,y(e.blackListAddAccount))})),o.length>0&&this._blacklistHandler.onAccountAdded(o)}}},{key:"onConversationsProfileUpdated",value:function(e){this._profileHandler.onConversationsProfileUpdated(e)}},{key:"getMyAccount",value:function(){return this.getMyUserID()}},{key:"getMyProfile",value:function(){return this._profileHandler.getMyProfile()}},{key:"getStorageModule",value:function(){return this.getModule(Jf)}},{key:"filterProfanity",value:function(e,t){var n=this.getModule(ph);if(!n)return!0;var o=n.filterText(t[e],Vc),r=o.isAllowedToSend,i=o.modifiedText;return!0===r&&(t[e]=i,!0)}},{key:"isMyFriend",value:function(e){var t=this.getModule(jf);return!!t&&t.isMyFriend(e)}},{key:"getUserProfile",value:function(e){return this._profileHandler.getUserProfile(e)}},{key:"updateMyProfile",value:function(e){return this._profileHandler.updateMyProfile(e)}},{key:"getNickAndAvatarByUserID",value:function(e){return this._profileHandler.getNickAndAvatarByUserID(e)}},{key:"getLocalBlacklist",value:function(){var e=this._blacklistHandler.getLocalBlacklist();return qI(e)}},{key:"addBlacklist",value:function(e){return this._blacklistHandler.addBlacklist(e)}},{key:"deleteBlacklist",value:function(e){return this._blacklistHandler.deleteBlacklist(e)}},{key:"onUserStatusUpdated",value:function(e){this._userStatusHandler.onUserStatusUpdated(e)}},{key:"setSelfStatus",value:function(e){return this._userStatusHandler.setSelfStatus(e)}},{key:"getUserStatus",value:function(e){return this._userStatusHandler.getUserStatus(e)}},{key:"subscribeUserStatus",value:function(e){return this._userStatusHandler.subscribeUserStatus(e)}},{key:"unsubscribeUserStatus",value:function(e){return this._userStatusHandler.unsubscribeUserStatus(e)}},{key:"reset",value:function(){Gl.l("".concat(this._n,".reset")),this._profileHandler.reset(),this._blacklistHandler.reset(),this._userStatusHandler.reset()}}]),n}(vh),ak=function(){function e(t,n){r(this,e),this._m=t,this._isLoggedIn=!1,this._SDKAppID=n.SDKAppID,this._userID=n.userID||"",this._userSig=n.userSig||"",this._version="2.26.3",this._a2Key="",this._tinyID="",this._customStatus="",this._contentType="json",this._unlimitedAVChatRoom=n.unlimitedAVChatRoom,this._scene=n.scene||"",this._oversea=n.oversea,this._instanceID=n.instanceID,this._statusInstanceID=0,this._isDevMode=n.devMode,this._proxyServer=n.proxyServer}return a(e,[{key:"isLoggedIn",value:function(){return this._isLoggedIn}},{key:"isOversea",value:function(){return this._oversea}},{key:"isPrivateNetWork",value:function(){return this._proxyServer}},{key:"isDevMode",value:function(){return this._isDevMode}},{key:"isSingaporeSite",value:function(){return this._SDKAppID>=2e7&&this._SDKAppID<3e7||this._SDKAppID>=172e7&&this._SDKAppID<173e7}},{key:"isKoreaSite",value:function(){return this._SDKAppID>=3e7&&this._SDKAppID<4e7||this._SDKAppID>=173e7&&this._SDKAppID<174e7}},{key:"isGermanySite",value:function(){return this._SDKAppID>=4e7&&this._SDKAppID<5e7||this._SDKAppID>=174e7&&this._SDKAppID<175e7}},{key:"isIndiaSite",value:function(){return this._SDKAppID>=5e7&&this._SDKAppID<6e7||this._SDKAppID>=175e7&&this._SDKAppID<176e7}},{key:"isJapanSite",value:function(){return this._SDKAppID>=6e7&&this._SDKAppID<7e7||this._SDKAppID>=176e7&&this._SDKAppID<177e7}},{key:"isUSASite",value:function(){return this._SDKAppID>=7e7&&this._SDKAppID<8e7||this._SDKAppID>=177e7&&this._SDKAppID<178e7}},{key:"isIntl",value:function(){return 0===(e=this._SDKAppID)||e>=2e7&&e<8e7||e>=172e7&&e<178e7;var e}},{key:"isUnlimitedAVChatRoom",value:function(){return this._unlimitedAVChatRoom}},{key:"setUserID",value:function(e){this._userID=e}},{key:"getUserID",value:function(){return this._userID}},{key:"setUserSig",value:function(e){this._userSig=e}},{key:"getUserSig",value:function(){return this._userSig}},{key:"getSDKAppID",value:function(){return this._SDKAppID}},{key:"setTinyID",value:function(e){this._tinyID=e,this._isLoggedIn=!0}},{key:"getTinyID",value:function(){return this._tinyID}},{key:"setCustomStatus",value:function(e){this._customStatus=e}},{key:"getCustomStatus",value:function(){return this._customStatus}},{key:"getScene",value:function(){return kl?window.tencent_cloud_im_csig_flutter_for_web_25F_cy:this._isTUIKit()?"tuikit":this._scene}},{key:"getInstanceID",value:function(){return this._instanceID}},{key:"getStatusInstanceID",value:function(){return this._statusInstanceID}},{key:"setStatusInstanceID",value:function(e){this._statusInstanceID=e}},{key:"getVersion",value:function(){return this._version}},{key:"getA2Key",value:function(){return this._a2Key}},{key:"setA2Key",value:function(e){this._a2Key=e}},{key:"getContentType",value:function(){return this._contentType}},{key:"getProxyServer",value:function(){return this._proxyServer}},{key:"_isTUIKit",value:function(){var e=!1,t=!1,n=!1,o=!1,r=[];nl&&(r=Object.keys(rl)),ol&&(r=tl?Object.keys(uni):Object.keys(window));for(var i=0,a=r.length;i<a;i++)if(r[i].toLowerCase().includes("uikit")){e=!0;break}if(r=null,nl&&!sd(rl.createGamePortal)&&!id(getApp())){var s=getApp().globalData;od(s)&&!0===s.isTUIKit&&(t=!0)}!0===this._m.getModule(Jf).getStorageSync("TIM_".concat(this._SDKAppID,"_isTUIKit"))&&(n=!0);var u=null;if(Yc&&!Xc&&"undefined"==typeof uni&&__wxConfig&&(u=__wxConfig.pages),Jc&&"undefined"==typeof uni&&__qqConfig&&(u=__qqConfig.pages),rd(u)&&u.length>0){for(var c=0,l=u.length;c<l;c++)if(u[c].toLowerCase().includes("tui")){o=!0;break}u=null}return e||t||n||o}},{key:"reset",value:function(){this._isLoggedIn=!1,this._userSig="",this._a2Key="",this._tinyID="",this._customStatus="",this._statusInstanceID=0}}]),e}(),sk=function(e){u(n,e);var t=m(n);function n(e){var o;return r(this,n),(o=t.call(this,e))._n="SignModule",o._helloInterval=120,o._lastLoginTs=0,o._lastWsHelloTs=0,o._isWebUniapp=0,sC.mixin(g(o)),o}return a(n,[{key:"onCheckTimer",value:function(e){this.isLoggedIn()&&e%this._helloInterval==0&&this._hello()}},{key:"login",value:function(e){var t="";if(this.isLoggedIn()){var n=this.getMyUserID();return(t=this.getErrorMessage("RepeatLogin",n))&&Gl.w(t),qI({actionStatus:"OK",errorCode:0,errorInfo:t,repeatLogin:!0})}if(Date.now()-this._lastLoginTs<=15e3)return this.outputWarning("LoggingIn",e.userID),BI({code:qv});Gl.l("".concat(this._n,".login userID:").concat(e.userID));var o=this._checkLoginInfo(e);if(0!==o.code)return BI(o);var r=this.getModule(Yf),i=e.userID,a=e.userSig;return r.setUserID(i),r.setUserSig(a),this.getModule(oh).updateProtocolConfig(),this._login()}},{key:"_login",value:function(){var e=this,t=this.getModule(Yf),n=t.getScene(),o=0,r=new w_("login");r.setMessage("".concat(n)).setMoreMessage("identifier:".concat(this.getMyUserID())),tl?"tuikit"===n?r.setUIPlatform(4):r.setUIPlatform(3):nl?"tuikit"===n?r.setUIPlatform(12):r.setUIPlatform(11):ol&&(kl?"flutter_web_uikit"===n?r.setUIPlatform(21):r.setUIPlatform(20):this._isReactUIKit()?Cl?r.setUIPlatform(25):r.setUIPlatform(24):Cl?"tuikit"===n?r.setUIPlatform(17):r.setUIPlatform(16):"tuikit"===n?r.setUIPlatform(14):r.setUIPlatform(13));var i=this.getModule(dh);if(i.canIUseOfflinePush()){this._isWebUniapp=i.getUniAppPlatform();var a=this._getStatusInstanceID();t.setStatusInstanceID(a),this.getModule(oh).updateProtocolConfig(),o=i.getDeviceBrand()}var s="".concat(this._n,"._login");return this._lastLoginTs=Date.now(),this.request({protocolName:mh,requestData:{deviceBrand:o,isWebUniapp:this._isWebUniapp}}).then((function(o){e._lastLoginTs=0;var i=Date.now(),a=null,u=o.data,c=u.a2Key,l=u.tinyID,d=u.helloInterval,p=u.instanceID,f=u.timeStamp,h=u.customStatus,g=void 0===h?"":h;Gl.l("".concat(s," ok. scene:").concat(n," helloInterval:").concat(d," instanceID:").concat(p," timeStamp:").concat(f));var v=1e3*f,m=i-r.getStartTs(),_=v+parseInt(m/2)-i,y=r.getStartTs()+_;if(r.start(y),function(e,t){Al=t;var n=new Date;n.setTime(e),Gl.i("baseTime from server:".concat(n," offset:").concat(Al))}(v,_),!l)throw a=new UI({code:Uv}),r.setError(a,!0,e.getNetworkType()).end(),a;if(!c)throw a=new UI({code:xv}),r.setError(a,!0,e.getNetworkType()).end(),a;var M=ok(g);r.setNetworkType(e.getNetworkType()).setMoreMessage("helloInterval:".concat(d," instanceID:").concat(p," offset:").concat(_," customStatus:").concat(M)).end(),t.setA2Key(c),t.setTinyID(l),t.setStatusInstanceID(p),t.setCustomStatus(M),e.getModule(oh).updateProtocolConfig(),e.emitInnerEvent(rC),e._helloInterval=d,e.triggerReady();var I=e.getModule(dh);return I.canIUseOfflinePush()&&(uni.setStorageSync("timUniAppInstanceID",p),I.init()),e._fetchCloudControlConfig(),e.getModule(ph).init(),o})).catch((function(t){return e.probeNetwork().then((function(e){var n=_(e,2),o=n[0],i=n[1];r.setError(t,o,i).end(!0)})),e._m.setNotReadyReason(i_),Gl.e("".concat(s," failed. error:"),t),e._lastLoginTs=0,e._m.onLoginFailed(),BI(t)}))}},{key:"logout",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(!this.isLoggedIn())return BI({code:Fv});new w_("logout").setNetworkType(this.getNetworkType()).setMessage("identifier:".concat(this.getMyUserID())).end(!0);var n="".concat(this._n,".logout");return Gl.i("".concat(n," type:").concat(t)),0===t&&this._m.setNotReadyReason(c_),this.request({protocolName:_h,requestData:{type:t}}).then((function(){return e.resetReady(),qI({})})).catch((function(t){return Gl.e("".concat(n," error:"),t),e.resetReady(),qI({})}))}},{key:"_fetchCloudControlConfig",value:function(){this.getModule(ah).fetchConfig()}},{key:"_getStatusInstanceID",value:function(){return uni.getStorageSync("timUniAppInstanceID")}},{key:"_hello",value:function(){var e=this;this._lastWsHelloTs=Date.now(),this.request({protocolName:yh,requestData:{isWebUniapp:this._isWebUniapp}}).catch((function(t){Gl.w("".concat(e._n,"._hello error:"),t)}))}},{key:"getLastWsHelloTs",value:function(){return this._lastWsHelloTs}},{key:"_checkLoginInfo",value:function(e){var t=0;return Yd(this.getModule(Yf).getSDKAppID())?t=Nv:Yd(e.userID)?t=Pv:Yd(e.userSig)&&(t=Gv),{code:t}}},{key:"_isReactUIKit",value:function(){return ol&&void 0!==window.tencent_cloud_im_csig_react_uikit_23F_xa}},{key:"onMultipleAccountKickedOut",value:function(e){var t=this;new w_("kickedOut").setNetworkType(this.getNetworkType()).setMessage("type:".concat(Ir.KICKED_OUT_MULT_ACCOUNT," newInstanceInfo:").concat(JSON.stringify(e))).end(!0),Gl.w("".concat(this._n,".onMultipleAccountKickedOut userID:").concat(this.getMyUserID()," newInstanceInfo:"),e),this.logout(1).then((function(){t.emitOuterEvent(Mr.KICKED_OUT,{type:Ir.KICKED_OUT_MULT_ACCOUNT}),t._m.setNotReadyReason(s_),t._m.reset()}))}},{key:"onMultipleDeviceKickedOut",value:function(e){var t=this;new w_("kickedOut").setNetworkType(this.getNetworkType()).setMessage("type:".concat(Ir.KICKED_OUT_MULT_DEVICE," newInstanceInfo:").concat(JSON.stringify(e))).end(!0),Gl.w("".concat(this._n,".onMultipleDeviceKickedOut userID:").concat(this.getMyUserID()," newInstanceInfo:"),e),this.logout(1).then((function(){t.emitOuterEvent(Mr.KICKED_OUT,{type:Ir.KICKED_OUT_MULT_DEVICE}),t._m.setNotReadyReason(a_),t._m.reset()}))}},{key:"onUserSigExpired",value:function(){new w_("kickedOut").setNetworkType(this.getNetworkType()).setMessage(Ir.KICKED_OUT_USERSIG_EXPIRED).end(!0),Gl.w("".concat(this._n,".onUserSigExpired: userSig expired")),0!==this.getModule(Yf).getStatusInstanceID()&&(this.emitOuterEvent(Mr.KICKED_OUT,{type:Ir.KICKED_OUT_USERSIG_EXPIRED}),this._m.setNotReadyReason(u_),this._m.reset())}},{key:"onRestApiKickedOut",value:function(e){new w_("kickedOut").setNetworkType(this.getNetworkType()).setMessage("type:".concat(Ir.KICKED_OUT_REST_API," newInstanceInfo:").concat(JSON.stringify(e))).end(!0),Gl.w("".concat(this._n,".onRestApiKickedOut userID:").concat(this.getMyUserID()," newInstanceInfo:"),e),0!==this.getModule(Yf).getStatusInstanceID()&&(this.emitOuterEvent(Mr.KICKED_OUT,{type:Ir.KICKED_OUT_REST_API}),this._m.setNotReadyReason(l_),this._m.reset(),this.getModule(rh).onRestApiKickedOut())}},{key:"reset",value:function(){Gl.l("".concat(this._n,".reset")),this.resetReady(),this._helloInterval=120,this._lastLoginTs=0,this._lastWsHelloTs=0,this._isWebUniapp=0}}]),n}(vh),uk=ot.f;function ck(){return null}on({target:"Object",stat:!0,forced:Object.defineProperty!==uk,sham:!O},{defineProperty:uk});var lk=function(){function e(t){r(this,e),this._m=t,this._n="StorageModule",this._storageQueue=new Map,this._errorTolerantHandle()}return a(e,[{key:"_errorTolerantHandle",value:function(){nl||!id(window)&&this._canIUseCookies()||(this.getItem=ck,this.setItem=ck,this.removeItem=ck,this.clear=ck)}},{key:"onCheckTimer",value:function(e){if(e%20==0){if(0===this._storageQueue.size)return;this._doFlush()}}},{key:"_doFlush",value:function(){try{var e,t=S(this._storageQueue);try{for(t.s();!(e=t.n()).done;){var n=_(e.value,2),o=n[0],r=n[1];this._setStorageSync(this._getKey(o),r)}}catch(a){t.e(a)}finally{t.f()}this._storageQueue.clear()}catch(XD){Gl.w("".concat(this._n,"._doFlush error:"),XD)}}},{key:"_getPrefix",value:function(){var e=this._m.getModule(Yf);return"TIM_".concat(e.getSDKAppID(),"_").concat(e.getUserID(),"_")}},{key:"_getKey",value:function(e){return"".concat(this._getPrefix()).concat(e)}},{key:"getItem",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];try{var n=t?this._getKey(e):e;return this.getStorageSync(n)}catch(XD){return Gl.w("".concat(this._n,".getItem error:"),XD),{}}}},{key:"setItem",value:function(e,t){if(arguments.length>2&&void 0!==arguments[2]&&arguments[2]){var n=arguments.length>3&&void 0!==arguments[3]&&!arguments[3]?e:this._getKey(e);this._setStorageSync(n,t)}else this._storageQueue.set(e,t)}},{key:"clear",value:function(){try{nl?rl.clearStorageSync():this._canIUseCookies()&&localStorage.clear()}catch(XD){Gl.w("".concat(this._n,".clear error:"),XD)}}},{key:"removeItem",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];try{var n=t?this._getKey(e):e;this._removeStorageSync(n)}catch(XD){Gl.w("".concat(this._n,".removeItem error:"),XD)}}},{key:"getSize",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"b";try{var o={size:0,limitSize:5242880,unit:n};if(Object.defineProperty(o,"leftSize",{enumerable:!0,get:function(){return o.limitSize-o.size}}),nl&&(o.limitSize=1024*rl.getStorageInfoSync().limitSize),e)o.size=JSON.stringify(this.getItem(e)).length+this._getKey(e).length;else if(nl)rl.getStorageInfoSync().keys.forEach((function(e){o.size+=JSON.stringify(t.getStorageSync(e)).length+t._getKey(e).length}));else if(this._canIUseCookies())for(var r in localStorage)localStorage.hasOwnProperty(r)&&(o.size+=localStorage.getItem(r).length+r.length);return this._convertUnit(o)}catch(XD){Gl.w("".concat(this._n," error:"),XD)}}},{key:"_convertUnit",value:function(e){var t={},n=e.unit;for(var o in t.unit=n,e)"number"==typeof e[o]&&("kb"===n.toLowerCase()?t[o]=Math.round(e[o]/1024):"mb"===n.toLowerCase()?t[o]=Math.round(e[o]/1024/1024):t[o]=e[o]);return t}},{key:"_setStorageSync",value:function(e,t){nl?Qc?my.setStorageSync({key:e,data:t}):rl.setStorageSync(e,t):this._canIUseCookies()&&localStorage.setItem(e,JSON.stringify(t))}},{key:"getStorageSync",value:function(e){return nl?Qc?my.getStorageSync({key:e}).data:rl.getStorageSync(e):this._canIUseCookies()?JSON.parse(localStorage.getItem(e)):{}}},{key:"_removeStorageSync",value:function(e){nl?Qc?my.removeStorageSync({key:e}):rl.removeStorageSync(e):this._canIUseCookies()&&localStorage.removeItem(e)}},{key:"_canIUseCookies",value:function(){return navigator&&navigator.cookieEnabled&&localStorage}},{key:"reset",value:function(){Gl.l("".concat(this._n,".reset")),this._doFlush()}}]),e}(),dk=function(){function e(t){r(this,e),this._n="SSOLogBody",this._report=[]}return a(e,[{key:"pushIn",value:function(e){Gl.d("".concat(this._n,".pushIn"),this._report.length,e),this._report.push(e)}},{key:"backfill",value:function(e){var t;rd(e)&&0!==e.length&&(Gl.d("".concat(this._n,".backfill"),this._report.length,e.length),(t=this._report).unshift.apply(t,y(e)))}},{key:"getLogsNumInMemory",value:function(){return this._report.length}},{key:"isEmpty",value:function(){return 0===this._report.length}},{key:"_reset",value:function(){this._report.length=0,this._report=[]}},{key:"getLogsInMemory",value:function(){var e=this._report.slice();return this._reset(),e}}]),e}(),pk=function(e){var t=e.getModule(Yf);return{SDKType:10,SDKAppID:t.getSDKAppID(),SDKVersion:t.getVersion(),tinyID:Number(t.getTinyID()),userID:t.getUserID(),platform:e.getPlatform(),instanceID:t.getInstanceID(),traceID:Ll()}},fk=function(e){u(o,e);var n=m(o);function o(e){var t;r(this,o),(t=n.call(this,e))._n="EventStatModule",t.TAG="im-ssolog-event",t._reportBody=new dk,t.MIN_THRESHOLD=20,t.MAX_THRESHOLD=100,t.WAITING_TIME=6e4,t.REPORT_LEVEL=[4,5,6],t.REPORT_SDKAPPID_BLACKLIST=[],t.REPORT_TINYID_WHITELIST=[],t._lastReportTime=Date.now();var i=t.getInnerEmitterInstance();return i.on(rC,t._onLoginSuccess,g(t)),i.on(iC,t._onCloudConfigUpdated,g(t)),t}return a(o,[{key:"reportAtOnce",value:function(){Gl.d("".concat(this._n,".reportAtOnce")),this._report()}},{key:"_onLoginSuccess",value:function(){var e=this,t=this.getModule(Jf),n=t.getItem(this.TAG,!1);!Yd(n)&&sd(n.forEach)&&(Gl.l("".concat(this._n,"._onLoginSuccess get ssolog in storage, count:").concat(n.length)),n.forEach((function(t){e._reportBody.pushIn(t)})),t.removeItem(this.TAG,!1))}},{key:"_onCloudConfigUpdated",value:function(){var e=this.getCloudConfig("evt_rpt_threshold"),t=this.getCloudConfig("evt_rpt_waiting"),n=this.getCloudConfig("evt_rpt_level"),o=this.getCloudConfig("evt_rpt_sdkappid_bl"),r=this.getCloudConfig("evt_rpt_tinyid_wl");id(e)||(this.MIN_THRESHOLD=Number(e)),id(t)||(this.WAITING_TIME=Number(t)),id(n)||(this.REPORT_LEVEL=n.split(",").map((function(e){return Number(e)}))),id(o)||(this.REPORT_SDKAPPID_BLACKLIST=o.split(",").map((function(e){return Number(e)}))),id(r)||(this.REPORT_TINYID_WHITELIST=r.split(","))}},{key:"pushIn",value:function(e){e instanceof w_&&(e.updateTimeStamp(),this._reportBody.pushIn(e),this._reportBody.getLogsNumInMemory()>=this.MIN_THRESHOLD&&this._report())}},{key:"onCheckTimer",value:function(){Date.now()<this._lastReportTime+this.WAITING_TIME||this._reportBody.isEmpty()||this._report()}},{key:"_filterLogs",value:function(e){var t=this,n=this.getModule(Yf),o=n.getSDKAppID(),r=n.getTinyID();return qd(this.REPORT_SDKAPPID_BLACKLIST,o)&&!Bd(this.REPORT_TINYID_WHITELIST,r)?[]:e.filter((function(e){return t.REPORT_LEVEL.includes(e.level)}))}},{key:"_report",value:function(){var e=this;if(!this._reportBody.isEmpty()){var n=this._reportBody.getLogsInMemory(),o=this._filterLogs(n);if(0!==o.length){var r={header:pk(this),event:o};this.request({protocolName:uv,requestData:t({},r)}).then((function(){e._lastReportTime=Date.now()})).catch((function(t){Gl.w("".concat(e._n,".report failed. networkType:").concat(e.getNetworkType()," error:"),t),e._reportBody.backfill(n),e._reportBody.getLogsNumInMemory()>e.MAX_THRESHOLD&&e._flushAtOnce()}))}else this._lastReportTime=Date.now()}}},{key:"_flushAtOnce",value:function(){var e=this.getModule(Jf),t=e.getItem(this.TAG,!1),n=this._reportBody.getLogsInMemory(),o="".concat(this._n,"._flushAtOnce");if(Yd(t))Gl.l("".concat(o," count:").concat(n.length)),e.setItem(this.TAG,n,!0,!1);else{var r=n.concat(t);r.length>this.MAX_THRESHOLD&&(r=r.slice(0,this.MAX_THRESHOLD)),Gl.l("".concat(o," count:").concat(r.length)),e.setItem(this.TAG,r,!0,!1)}}},{key:"reset",value:function(){Gl.l("".concat(this._n,".reset")),this._lastReportTime=0,this._report(),this.REPORT_SDKAPPID_BLACKLIST=[],this.REPORT_TINYID_WHITELIST=[]}}]),o}(vh),hk="none",gk="online",vk=[e_,m_],mk=function(){function e(t){r(this,e),this._m=t,this._networkType="",this._n="NetMonitorModule",this.MAX_WAIT_TIME=3e3,this._mpNetworkStatusCallback=null,this._webOnlineCallback=null,this._webOfflineCallback=null}return a(e,[{key:"start",value:function(){var e=this;nl?(rl.getNetworkType({success:function(t){e._networkType=t.networkType,t.networkType===hk?Gl.w("".concat(e._n,".start no network, please check!")):Gl.i("".concat(e._n,".start networkType:").concat(t.networkType))}}),this._mpNetworkStatusCallback=this._onNetworkStatusChange.bind(this),rl.onNetworkStatusChange(this._mpNetworkStatusCallback)):(this._networkType=gk,this._webOnlineCallback=this._onWebOnline.bind(this),this._webOfflineCallback=this._onWebOffline.bind(this),window&&(window.addEventListener("online",this._webOnlineCallback),window.addEventListener("offline",this._webOfflineCallback)))}},{key:"_onWebOnline",value:function(){this._onNetworkStatusChange({isConnected:!0,networkType:gk})}},{key:"_onWebOffline",value:function(){this._onNetworkStatusChange({isConnected:!1,networkType:hk})}},{key:"_onNetworkStatusChange",value:function(e){var t=e.isConnected,n=e.networkType,o="".concat(this._n,"._onNetworkStatusChange"),r=!1;t?(Gl.i("".concat(o," previous:").concat(this._networkType," current:").concat(n)),this._networkType!==n&&(r=!0,this._m.getModule(rh).reConnect(!0))):this._networkType!==n&&(r=!0,Gl.w("".concat(o," no network, please check!")),this._m.getModule(rh).offline()),r&&(new w_("networkChange").setMessage("isConnected:".concat(t," previousNetworkType:").concat(this._networkType," networkType:").concat(n)).end(),this._networkType=n)}},{key:"probe",value:function(e){var t=this;if(!id(e)&&vk.includes(e.code))return Promise.resolve([!0,this._networkType]);var n="".concat(this._n,".probe");return new Promise((function(e,o){nl?rl.getNetworkType({success:function(o){t._networkType=o.networkType,o.networkType===hk?(Gl.w("".concat(n," no network, please check!")),e([!1,o.networkType])):(Gl.i("".concat(n," networkType:").concat(o.networkType)),e([!0,o.networkType]))}}):t._networkType===hk?e([!1,hk]):e([!0,gk])}))}},{key:"getNetworkType",value:function(){return this._networkType}},{key:"reset",value:function(){Gl.l("".concat(this._n,".reset")),nl?null!==this._mpNetworkStatusCallback&&(rl.offNetworkStatusChange&&(el||Xc?rl.offNetworkStatusChange(this._mpNetworkStatusCallback):rl.offNetworkStatusChange()),this._mpNetworkStatusCallback=null):window&&(null!==this._webOnlineCallback&&(window.removeEventListener("online",this._webOnlineCallback),this._webOnlineCallback=null),null!==this._onWebOffline&&(window.removeEventListener("offline",this._webOfflineCallback),this._webOfflineCallback=null))}}]),e}(),_k=D((function(e){var t=Object.prototype.hasOwnProperty,n="~";function o(){}function r(e,t,n){this.fn=e,this.context=t,this.once=n||!1}function i(e,t,o,i,a){if("function"!=typeof o)throw new TypeError("The listener must be a function");var s=new r(o,i||e,a),u=n?n+t:t;return e._events[u]?e._events[u].fn?e._events[u]=[e._events[u],s]:e._events[u].push(s):(e._events[u]=s,e._eventsCount++),e}function a(e,t){0==--e._eventsCount?e._events=new o:delete e._events[t]}function s(){this._events=new o,this._eventsCount=0}Object.create&&(o.prototype=Object.create(null),(new o).__proto__||(n=!1)),s.prototype.eventNames=function(){var e,o,r=[];if(0===this._eventsCount)return r;for(o in e=this._events)t.call(e,o)&&r.push(n?o.slice(1):o);return Object.getOwnPropertySymbols?r.concat(Object.getOwnPropertySymbols(e)):r},s.prototype.listeners=function(e){var t=n?n+e:e,o=this._events[t];if(!o)return[];if(o.fn)return[o.fn];for(var r=0,i=o.length,a=new Array(i);r<i;r++)a[r]=o[r].fn;return a},s.prototype.listenerCount=function(e){var t=n?n+e:e,o=this._events[t];return o?o.fn?1:o.length:0},s.prototype.emit=function(e,t,o,r,i,a){var s=n?n+e:e;if(!this._events[s])return!1;var u,c,l=this._events[s],d=arguments.length;if(l.fn){switch(l.once&&this.removeListener(e,l.fn,void 0,!0),d){case 1:return l.fn.call(l.context),!0;case 2:return l.fn.call(l.context,t),!0;case 3:return l.fn.call(l.context,t,o),!0;case 4:return l.fn.call(l.context,t,o,r),!0;case 5:return l.fn.call(l.context,t,o,r,i),!0;case 6:return l.fn.call(l.context,t,o,r,i,a),!0}for(c=1,u=new Array(d-1);c<d;c++)u[c-1]=arguments[c];l.fn.apply(l.context,u)}else{var p,f=l.length;for(c=0;c<f;c++)switch(l[c].once&&this.removeListener(e,l[c].fn,void 0,!0),d){case 1:l[c].fn.call(l[c].context);break;case 2:l[c].fn.call(l[c].context,t);break;case 3:l[c].fn.call(l[c].context,t,o);break;case 4:l[c].fn.call(l[c].context,t,o,r);break;default:if(!u)for(p=1,u=new Array(d-1);p<d;p++)u[p-1]=arguments[p];l[c].fn.apply(l[c].context,u)}}return!0},s.prototype.on=function(e,t,n){return i(this,e,t,n,!1)},s.prototype.once=function(e,t,n){return i(this,e,t,n,!0)},s.prototype.removeListener=function(e,t,o,r){var i=n?n+e:e;if(!this._events[i])return this;if(!t)return a(this,i),this;var s=this._events[i];if(s.fn)s.fn!==t||r&&!s.once||o&&s.context!==o||a(this,i);else{for(var u=0,c=[],l=s.length;u<l;u++)(s[u].fn!==t||r&&!s[u].once||o&&s[u].context!==o)&&c.push(s[u]);c.length?this._events[i]=1===c.length?c[0]:c:a(this,i)}return this},s.prototype.removeAllListeners=function(e){var t;return e?(t=n?n+e:e,this._events[t]&&a(this,t)):(this._events=new o,this._eventsCount=0),this},s.prototype.off=s.prototype.removeListener,s.prototype.addListener=s.prototype.on,s.prefixed=n,s.EventEmitter=s,e.exports=s})),yk=function(e){u(n,e);var t=m(n);function n(e){var o;return r(this,n),(o=t.call(this,e))._n="BigDataChannelModule",o.FILETYPE={SOUND:2106,FILE:2107,VIDEO:2113},o._bdh_download_server="grouptalk.c2c.qq.com",o._BDHBizID=10001,o._authKey="",o._expireTime=0,o.getInnerEmitterInstance().on(rC,o._getAuthKey,g(o)),o}return a(n,[{key:"_getAuthKey",value:function(){var e=this;this.isIntl()||this.request({protocolName:Ch}).then((function(t){t.data.authKey&&(e._authKey=t.data.authKey,e._expireTime=parseInt(t.data.expireTime))}))}},{key:"_isFromOlderVersion",value:function(e){return!(!e.content||2===e.content.downloadFlag)}},{key:"parseElements",value:function(e,t){if(!rd(e)||!t)return[];for(var n=[],o=null,r=0;r<e.length;r++)o=e[r],this._needParse(o)?n.push(this._parseElement(o,t)):n.push(e[r]);return n}},{key:"_needParse",value:function(e){return!e.cloudCustomData&&!(!this._isFromOlderVersion(e)||e.type!==Ir.MSG_AUDIO&&e.type!==Ir.MSG_FILE&&e.type!==Ir.MSG_VIDEO)}},{key:"_parseElement",value:function(e,t){switch(e.type){case Ir.MSG_AUDIO:return this._parseAudioElement(e,t);case Ir.MSG_FILE:return this._parseFileElement(e,t);case Ir.MSG_VIDEO:return this._parseVideoElement(e,t)}}},{key:"_parseAudioElement",value:function(e,t){return e.content.url=this._genAudioUrl(e.content.uuid,t),e}},{key:"_parseFileElement",value:function(e,t){return e.content.url=this._genFileUrl(e.content.uuid,t,e.content.fileName),e}},{key:"_parseVideoElement",value:function(e,t){return e.content.url=this._genVideoUrl(e.content.uuid,t),e}},{key:"_genAudioUrl",value:function(e,t){if(""===this._authKey)return"";var n=this.getModule(Yf).getSDKAppID();return"https://".concat(this._bdh_download_server,"/asn.com/stddownload_common_file?authkey=").concat(this._authKey,"&bid=").concat(this._BDHBizID,"&subbid=").concat(n,"&fileid=").concat(e,"&filetype=").concat(this.FILETYPE.SOUND,"&openid=").concat(t,"&ver=0")}},{key:"_genFileUrl",value:function(e,t,n){if(""===this._authKey)return"";n||(n="".concat(Math.floor(1e5*Math.random()),"-").concat(Date.now()));var o=this.getModule(Yf).getSDKAppID();return"https://".concat(this._bdh_download_server,"/asn.com/stddownload_common_file?authkey=").concat(this._authKey,"&bid=").concat(this._BDHBizID,"&subbid=").concat(o,"&fileid=").concat(e,"&filetype=").concat(this.FILETYPE.FILE,"&openid=").concat(t,"&ver=0&filename=").concat(encodeURIComponent(n))}},{key:"_genVideoUrl",value:function(e,t){if(""===this._authKey)return"";var n=this.getModule(Yf).getSDKAppID();return"https://".concat(this._bdh_download_server,"/asn.com/stddownload_common_file?authkey=").concat(this._authKey,"&bid=").concat(this._BDHBizID,"&subbid=").concat(n,"&fileid=").concat(e,"&filetype=").concat(this.FILETYPE.VIDEO,"&openid=").concat(t,"&ver=0")}},{key:"reset",value:function(){this._authKey="",this.expireTime=0}}]),n}(vh),Mk=["requestSnapshotUrl"],Ik=function(e){u(o,e);var n=m(o);function o(e){var t;return r(this,o),(t=n.call(this,e))._n="UploadModule",t.TIMUploadPlugin=null,t.timUploadPlugin=null,t.COSSDK=null,t._cosUploadMethod=null,t.expiredTimeLimit=600,t.appid=0,t.bucketName="",t.ciUrl="",t.directory="",t.downloadUrl="",t.uploadUrl="",t.region="ap-shanghai",t.cos=null,t.cosOptions={secretId:"",secretKey:"",sessionToken:"",expiredTime:0},t.uploadFileType="",t.duration=900,t.tryCount=0,t.getInnerEmitterInstance().on(rC,t._init,g(t)),t}return a(o,[{key:"_init",value:function(){var e=this.getModule(th);if(this.TIMUploadPlugin=e.getPlugin("tim-upload-plugin"),this.TIMUploadPlugin)this._initUploaderMethod();else{var t=nl?"cos-wx-sdk":"cos-js-sdk";this.COSSDK=e.getPlugin(t),this.COSSDK?(this._getAuthorizationKey(),this.outputWarning("CosReplacement",t)):this.outputWarning("PluginUndetected")}}},{key:"_getAuthorizationKey",value:function(){var e=this,t="".concat(this._n,".").concat("_getAuthorizationKey"),n=new w_("_getAuthorizationKey"),o=Math.ceil(Date.now()/1e3);this.request({protocolName:iv,requestData:{duration:this.expiredTimeLimit}}).then((function(r){var i=r.data;Gl.l("".concat(t," ok. data:"),i);var a=i.expiredTime-o;n.setMessage("requestId:".concat(i.requestId," requestTime:").concat(o," expiredTime:").concat(i.expiredTime," diff:").concat(a,"s")).setNetworkType(e.getNetworkType()).end(),!nl&&i.region&&(e.region=i.region),e.appid=i.appid,e.bucketName=i.bucketName,e.ciUrl=i.ciUrl,e.directory=i.directory,e.downloadUrl=i.downloadUrl,e.uploadUrl=i.uploadUrl,e.cosOptions={secretId:i.secretId,secretKey:i.secretKey,sessionToken:i.sessionToken,expiredTime:i.expiredTime},Gl.l("".concat(t," ok. region:").concat(e.region," bucketName:").concat(e.bucketName)),e._initUploaderMethod()})).catch((function(o){e.probeNetwork().then((function(e){var t=_(e,2),r=t[0],i=t[1];n.setError(o,r,i).end()})),Gl.w("".concat(t," failed. error:"),o)}))}},{key:"_getCosPreSigUrl",value:function(e){var t=this,n="".concat(this._n,".").concat("_getCosPreSigUrl"),o=Math.ceil(Date.now()/1e3),r=new w_("_getCosPreSigUrl");return this.request({protocolName:av,requestData:{fileType:e.fileType,fileName:e.fileName,uploadMethod:e.uploadMethod,duration:e.duration}}).then((function(e){t.tryCount=0;var i=e.data||{},a=i.expiredTime-o;return Gl.l("".concat(n," ok. data:"),i),r.setMessage("requestId:".concat(i.requestId," expiredTime:").concat(i.expiredTime," diff:").concat(a,"s")).setNetworkType(t.getNetworkType()).end(),i})).catch((function(o){return-1===o.code&&(o.code=Vv),t.probeNetwork().then((function(e){var t=_(e,2),n=t[0],i=t[1];r.setError(o,n,i).end()})),Gl.w("".concat(n," failed. error:"),o),t.tryCount<1?(t.tryCount++,t._getCosPreSigUrl(e)):(t.tryCount=0,BI({code:Vv}))}))}},{key:"_initUploaderMethod",value:function(){var e=this;if(this.TIMUploadPlugin)return this.timUploadPlugin=new this.TIMUploadPlugin,void(this._cosUploadMethod=function(t,n){e.timUploadPlugin.uploadFile(t,n)});this.appid&&(this.cos=nl?new this.COSSDK({ForcePathStyle:!0,getAuthorization:this._getAuthorization.bind(this)}):new this.COSSDK({getAuthorization:this._getAuthorization.bind(this)}),this._cosUploadMethod=nl?function(t,n){e.cos.postObject(t,n)}:function(t,n){e.cos.uploadFiles(t,n)})}},{key:"onCheckTimer",value:function(e){this.COSSDK&&(this.TIMUploadPlugin||this.isLoggedIn()&&e%60==0&&Math.ceil(Date.now()/1e3)>=this.cosOptions.expiredTime-120&&this._getAuthorizationKey())}},{key:"_getAuthorization",value:function(e,t){t({TmpSecretId:this.cosOptions.secretId,TmpSecretKey:this.cosOptions.secretKey,XCosSecurityToken:this.cosOptions.sessionToken,ExpiredTime:this.cosOptions.expiredTime})}},{key:"upload",value:function(e){if(!0===e.getRelayFlag())return Promise.resolve();var t=this.getModule(ch);switch(e.type){case Ir.MSG_IMAGE:return t.addTotalCount(T_),this._uploadImage(e);case Ir.MSG_FILE:return t.addTotalCount(T_),this._uploadFile(e);case Ir.MSG_AUDIO:return t.addTotalCount(T_),this._uploadAudio(e);case Ir.MSG_VIDEO:return t.addTotalCount(T_),this._uploadVideo(e);default:return Promise.resolve()}}},{key:"_uploadImage",value:function(e){var n=this,o=this.getModule(qf),r=e.getElements()[0],i=o.getMessageOption(e.clientSequence);return this.doUploadImage({file:i.payload.file,to:i.to,onProgress:function(e){if(r.updatePercent(e),sd(i.onProgress))try{i.onProgress(e)}catch(t){return BI({code:Wv})}}}).then((function(o){var i=o.location,a=o.fileType,s=o.fileSize,u=o.width,c=o.height,l=n.isPrivateNetWork()?i:Id(i);r.updateImageFormat(a);var d=Gd({originUrl:l,originWidth:u,originHeight:c,min:198}),p=Gd({originUrl:l,originWidth:u,originHeight:c,min:720});return r.updateImageInfoArray([{size:s,url:l,width:u,height:c},t({},p),t({},d)]),e}))}},{key:"_uploadFile",value:function(e){var t=this,n=this.getModule(qf),o=e.getElements()[0],r=n.getMessageOption(e.clientSequence);return this.doUploadFile({file:r.payload.file,to:r.to,onProgress:function(e){if(o.updatePercent(e),sd(r.onProgress))try{r.onProgress(e)}catch(t){return BI({code:Wv})}}}).then((function(n){var r=n.location,i=t.isPrivateNetWork()?r:Id(r);return o.updateFileUrl(i),e}))}},{key:"_uploadAudio",value:function(e){var t=this,n=this.getModule(qf),o=e.getElements()[0],r=n.getMessageOption(e.clientSequence);return this.doUploadAudio({file:r.payload.file,to:r.to,onProgress:function(e){if(o.updatePercent(e),sd(r.onProgress))try{r.onProgress(e)}catch(t){return BI({code:Wv})}}}).then((function(n){var r=n.location,i=t.isPrivateNetWork()?r:Id(r);return o.updateAudioUrl(i),e}))}},{key:"_uploadVideo",value:function(e){var t=this,n=this.getModule(qf),o=e.getElements()[0],r=n.getMessageOption(e.clientSequence);return this.doUploadVideo({file:r.payload.file,to:r.to,onProgress:function(e){if(o.updatePercent(e),sd(r.onProgress))try{r.onProgress(e)}catch(t){return BI({code:Wv})}}}).then((function(n){var r=n.location,i=n.snapshotInfo,a=t.isPrivateNetWork()?r:Id(r);return o.updateVideoUrl(a),Yd(i)||o.updateSnapshotInfo(i),e}))}},{key:"doUploadImage",value:function(e){var t=this;if(!e.file)return BI({code:nm});var n=this._checkImageType(e.file);if(!0!==n)return n;var o=this._checkImageSize(e.file);if(!0!==o)return o;var r=null;return this._setUploadFileType(lC),this.uploadByCOS(e).then((function(e){return r=e,t.isPrivateNetWork()?wd(e.location):wd("https://".concat(e.location))})).then((function(e){return r.width=e.width,r.height=e.height,Promise.resolve(r)}))}},{key:"_checkImageType",value:function(e){var t="";return t=nl?e.url.slice(e.url.lastIndexOf(".")+1):e.files[0].name.slice(e.files[0].name.lastIndexOf(".")+1),uC.indexOf(t.toLowerCase())>=0||BI({code:om})}},{key:"_checkImageSize",value:function(e){var t=0;return 0===(t=nl?e.size:e.files[0].size)?BI({code:Zv}):t<20971520||BI({code:rm})}},{key:"doUploadFile",value:function(e){return e.file?e.file.files[0].size>104857600?BI({code:pm}):0===e.file.files[0].size?BI({code:Zv}):(this._setUploadFileType(fC),this.uploadByCOS(e)):BI({code:dm})}},{key:"doUploadVideo",value:function(e){return e.file.videoFile.size>104857600?BI({code:um}):0===e.file.videoFile.size?BI({code:Zv}):-1===cC.indexOf(e.file.videoFile.type)?BI({code:cm}):(this._setUploadFileType(dC),nl?this.handleVideoUpload({file:e.file.videoFile,onProgress:e.onProgress}):ol?this.handleVideoUpload(e):void 0)}},{key:"handleVideoUpload",value:function(e){var t=this;return new Promise((function(n,o){t.uploadByCOS(e).then((function(e){n(e)})).catch((function(){t.uploadByCOS(e).then((function(e){n(e)})).catch((function(){o(new UI({code:sm}))}))}))}))}},{key:"doUploadAudio",value:function(e){return e.file?e.file.size>20971520?BI({code:am}):0===e.file.size?BI({code:Zv}):(this._setUploadFileType(pC),this.uploadByCOS(e)):BI({code:im})}},{key:"uploadByCOS",value:function(e){var t=this,n="".concat(this._n,".uploadByCOS");if(!sd(this._cosUploadMethod))return this.outputWarning("PluginUndetected"),BI({code:Bv});if(this.timUploadPlugin)return this._uploadWithPreSigUrl(e);var o=new w_("upload"),r=Date.now(),i=this._getFile(e);return new Promise((function(a,s){var u=nl?t._createCosOptionsWXMiniApp(e):t._createCosOptionsWeb(e),c=t;t._cosUploadMethod(u,(function(e,u){var l=Object.create(null);if(u){if(e||rd(u.files)&&u.files[0].error){var d=new UI({code:lm});return o.setError(d,!0,t.getNetworkType()).end(),Gl.l("".concat(n," failed. error:"),u.files[0].error),403===u.files[0].error.statusCode&&(Gl.w("".concat(n," failed. cos AccessKeyId was invalid, regain auth key!")),t._getAuthorizationKey()),void s(d)}l.fileName=i.name,l.fileSize=i.size,l.fileType=i.type.slice(i.type.indexOf("/")+1).toLowerCase(),l.location=nl?u.Location:u.files[0].data.Location;var p=Date.now()-r,f=c._formatFileSize(i.size),h=c._formatSpeed(1e3*i.size/p),g="size:".concat(f," time:").concat(p,"ms speed:").concat(h);Gl.l("".concat(n," success. name:").concat(i.name," ").concat(g)),a(l);var v=t.getModule(ch);return v.addCost(T_,p),v.addFileSize(T_,i.size),void o.setNetworkType(t.getNetworkType()).setMessage(g).end()}var m=new UI({code:lm});o.setError(m,!0,c.getNetworkType()).end(),Gl.w("".concat(n," failed. error:"),e),403===e.statusCode&&(Gl.w("".concat(n," failed. cos AccessKeyId was invalid, regain auth key!")),t._getAuthorizationKey()),s(m)}))}))}},{key:"_uploadWithPreSigUrl",value:function(e){var t=this,n="".concat(this._n,"._uploadWithPreSigUrl"),o=this._getFile(e);return this._createCosOptionsPreSigUrl(e).then((function(e){return new Promise((function(r,i){var a=new w_("upload"),s=e.requestSnapshotUrl,u=void 0===s?void 0:s,c=h(e,Mk),l=Date.now();t._cosUploadMethod(c,(function(e,s){var c=Object.create(null);if(e||403===s.statusCode)return a.setError(new UI(e),!0,t.getNetworkType()).end(),Gl.l("".concat(n," failed, error:"),e),void i(new UI({code:lm}));var d=s.data.location||"";t.isPrivateNetWork()||0!==d.indexOf("https://")&&0!==d.indexOf("http://")||(d=d.split("//")[1]),c.fileName=o.name,c.fileSize=o.size,c.fileType=o.type.slice(o.type.indexOf("/")+1).toLowerCase(),c.location=d;var p=Date.now()-l,f=t._formatFileSize(o.size),h=t._formatSpeed(1e3*o.size/p),g="size:".concat(f,",time:").concat(p,"ms,speed:").concat(h," res:").concat(JSON.stringify(s.data));Gl.l("".concat(n," success name:").concat(o.name,",").concat(g)),a.setNetworkType(t.getNetworkType()).setMessage(g).end();var v=t.getModule(ch);if(v.addCost(T_,p),v.addFileSize(T_,o.size),!Yd(u))return t._getSnapshotInfoByUrl(u).then((function(e){c.snapshotInfo=e,r(c)}));r(c)}))}))}))}},{key:"_getFile",value:function(e){var t;return rd(e.file.files)||(t=e.file.files,"filelist"===cd(t))?e.file.files[0]:e.file}},{key:"_formatFileSize",value:function(e){return e<1024?e+"B":e<1048576?Math.floor(e/1024)+"KB":Math.floor(e/1048576)+"MB"}},{key:"_formatSpeed",value:function(e){return e<=1048576?Fd(e/1024,1)+"KB/s":Fd(e/1048576,1)+"MB/s"}},{key:"_createCosOptionsWeb",value:function(e){var t=this._getFile(e),n=t.name,o=n.slice(n.lastIndexOf(".")),r=this._genFileName("".concat(vd(999999)).concat(o));return{files:[{Bucket:"".concat(this.bucketName,"-").concat(this.appid),Region:this.region,Key:"".concat(this.directory,"/").concat(r),Body:t}],SliceSize:1048576,onProgress:function(t){if("function"==typeof e.onProgress)try{e.onProgress(t.percent)}catch(n){Gl.w("onProgress callback error:",n)}},onFileFinish:function(e,t,n){}}}},{key:"_createCosOptionsWXMiniApp",value:function(e){var t=this._getFile(e),n=this._genFileName(t.name),o=t.url;return{Bucket:"".concat(this.bucketName,"-").concat(this.appid),Region:this.region,Key:"".concat(this.directory,"/").concat(n),FilePath:o,onProgress:function(t){if(Gl.l(JSON.stringify(t)),"function"==typeof e.onProgress)try{e.onProgress(t.percent)}catch(n){Gl.w("onProgress callback error:",n)}}}}},{key:"_createCosOptionsPreSigUrl",value:function(e){var t=this,n="",o="",r=0,i=this._getFile(e);if(nl)n=this._genFileName(i.name),o=i.url,r=1;else{var a=i.name,s=a.slice(a.lastIndexOf("."));n=this._genFileName("".concat(vd(999999)).concat(s)),o=i,r=0}return this._getCosPreSigUrl({fileType:this.uploadFileType,fileName:n,uploadMethod:r,duration:this.duration}).then((function(r){var i=r.uploadUrl,a=r.downloadUrl,s=r.requestSnapshotUrl,u=void 0===s?void 0:s;return{url:i,fileType:t.uploadFileType,fileName:n,resources:o,downloadUrl:a,requestSnapshotUrl:u,onProgress:function(t){if("function"==typeof e.onProgress)try{e.onProgress(t.percent)}catch(n){Gl.w("onProgress callback error:",n),Gl.e(n)}}}}))}},{key:"_genFileName",value:function(e){return"".concat(Od(),"-").concat(e)}},{key:"_setUploadFileType",value:function(e){this.uploadFileType=e}},{key:"_getSnapshotInfoByUrl",value:function(e){var t=this,n=new w_("getSnapshotInfo");return this.request({protocolName:sv,requestData:{platform:this.getPlatform(),coverName:this._genFileName(vd(99999)),requestSnapshotUrl:e}}).then((function(e){var t=(e.data||{}).snapshotUrl;return n.setMessage("snapshotUrl:".concat(t)).end(),Yd(t)?{}:wd(t).then((function(e){return{snapshotUrl:t,snapshotWidth:e.width,snapshotHeight:e.height}}))})).catch((function(e){return Gl.w("".concat(t._n,"._getSnapshotInfoByUrl failed. error:"),e),n.setCode(e.errorCode).setMessage(e.errorInfo).end(),{}}))}},{key:"reset",value:function(){Gl.l("".concat(this._n,".reset"))}}]),o}(vh),Ck=["downloadKey","pbDownloadKey","messageList"],kk=function(){function e(t){r(this,e),this._n="MergerMessageHandler",this._messageModule=t}return a(e,[{key:"uploadMergerMessage",value:function(e,t){var n=this,o="".concat(this._n,".").concat("uploadMergerMessage");Gl.d("".concat(o," message:"),e,"messageBytes:".concat(t));var r=e.payload.messageList,i=r.length,a=new w_("uploadMergerMessage");return this._messageModule.request({protocolName:hv,requestData:{messageList:r}}).then((function(e){Gl.d("".concat(o," ok. response:"),e.data);var r=e.data,s=r.pbDownloadKey,u=r.downloadKey,c={pbDownloadKey:s,downloadKey:u,messageNumber:i};return a.setNetworkType(n._messageModule.getNetworkType()).setMessage("".concat(i,"-").concat(t,"-").concat(u)).end(),c})).catch((function(e){throw Gl.w("".concat(o," failed. error:"),e),n._messageModule.probeNetwork().then((function(t){var n=_(t,2),o=n[0],r=n[1];a.setError(e,o,r).end()})),e}))}},{key:"downloadMergerMessage",value:function(e){var n=this,o="".concat(this._n,".").concat("downloadMergerMessage");Gl.d("".concat(o," message:"),e);var r=e.payload.downloadKey,i=new w_("downloadMergerMessage");return i.setMessage("downloadKey:".concat(r)),this._messageModule.request({protocolName:gv,requestData:{downloadKey:r}}).then((function(r){if(Gl.d("".concat(o," ok. response:"),r.data),sd(e.clearElement)){var a=e.payload,s=(a.downloadKey,a.pbDownloadKey,a.messageList,h(a,Ck));e.clearElement(),e.setElement({type:e.type,content:t({messageList:r.data.messageList},s)})}else{var u=[];r.data.messageList.forEach((function(e){if(!Yd(e)){var t=new wI(e);u.push(t)}})),e.payload.messageList=u,e.payload.downloadKey="",e.payload.pbDownloadKey=""}return i.setNetworkType(n._messageModule.getNetworkType()).end(),e})).catch((function(e){throw Gl.w("".concat(o," failed. key:").concat(r," error:"),e),n._messageModule.probeNetwork().then((function(t){var n=_(t,2),o=n[0],r=n[1];i.setError(e,o,r).end()})),e}))}},{key:"createMergerMessagePack",value:function(e,t,n){return e.conversationType===Ir.CONV_C2C?this._createC2CMergerMessagePack(e,t,n):this._createGroupMergerMessagePack(e,t,n)}},{key:"_createC2CMergerMessagePack",value:function(e,t,n){var o=null;t&&(t.offlinePushInfo&&(o=t.offlinePushInfo),!0===t.onlineUserOnly&&(o?o.disablePush=!0:o={disablePush:!0}));var r=[];if(od(t)&&od(t.messageControlInfo)){var i=t.messageControlInfo,a=i.excludedFromUnreadCount,s=i.excludedFromLastMessage,u=i.excludedFromContentModeration;!0===a&&r.push("NoUnread"),!0===s&&r.push("NoLastMsg"),!0===u&&r.push("NoMsgCheck")}var c="";td(e.cloudCustomData)&&e.cloudCustomData.length>0&&(c=e.cloudCustomData);var l=n.pbDownloadKey,d=n.downloadKey,p=n.messageNumber,f=e.payload,h=f.title,g=f.abstractList,v=f.compatibleText,m=this._messageModule.getModule(Hf),_=m&&m.isOnlineMessage(e,t)?0:void 0;return{protocolName:kh,tjgID:this._messageModule.generateTjgID(e),requestData:{fromAccount:this._messageModule.getMyUserID(),toAccount:e.to,msgBody:[{msgType:e.type,msgContent:{pbDownloadKey:l,downloadKey:d,title:h,abstractList:g,compatibleText:v,messageNumber:p}}],cloudCustomData:c,clientTime:e.clientTime,msgSeq:e.sequence,msgRandom:e.random,msgLifeTime:_,offlinePushInfo:o?{pushFlag:!0===o.disablePush?1:0,title:o.title||"",desc:o.description||"",ext:o.extension||"",apnsInfo:{badgeMode:!0===o.ignoreIOSBadge?1:0},androidInfo:{OPPOChannelID:o.androidOPPOChannelID||""}}:void 0,messageControlInfo:0!==_?r:void 0,isSupportExtension:!0===e.isSupportExtension?1:0}}}},{key:"_createGroupMergerMessagePack",value:function(e,t,n){var o=null;t&&t.offlinePushInfo&&(o=t.offlinePushInfo);var r=[];if(od(t)&&od(t.messageControlInfo)){var i=t.messageControlInfo,a=i.excludedFromUnreadCount,s=i.excludedFromLastMessage,u=i.excludedFromContentModeration;!0===a&&r.push("NoUnread"),!0===s&&r.push("NoLastMsg"),!0===u&&r.push("NoMsgCheck")}var c="";td(e.cloudCustomData)&&e.cloudCustomData.length>0&&(c=e.cloudCustomData);var l=n.pbDownloadKey,d=n.downloadKey,p=n.messageNumber,f=e.payload,h=f.title,g=f.abstractList,v=f.compatibleText,m=this._messageModule.getModule(Kf),_=m&&m.isOnlineMessage(e,t)?1:0;return{protocolName:Th,tjgID:this._messageModule.generateTjgID(e),requestData:{fromAccount:this._messageModule.getMyUserID(),groupID:e.to,msgBody:[{msgType:e.type,msgContent:{pbDownloadKey:l,downloadKey:d,title:h,abstractList:g,compatibleText:v,messageNumber:p}}],random:e.random,priority:e.priority,clientSequence:e.clientSequence,groupAtInfo:void 0,cloudCustomData:c,onlineOnlyFlag:_,offlinePushInfo:o?{pushFlag:!0===o.disablePush?1:0,title:o.title||"",desc:o.description||"",ext:o.extension||"",apnsInfo:{badgeMode:!0===o.ignoreIOSBadge?1:0},androidInfo:{OPPOChannelID:o.androidOPPOChannelID||""}}:void 0,clientTime:e.clientTime,needReadReceipt:!0!==e.needReadReceipt||m.isMessageFromOrToAVChatroom(e.to)?0:1,messageControlInfo:0===_?r:void 0,isSupportExtension:!0===e.isSupportExtension?1:0}}}}]),e}(),Tk={ERR_SVR_COMM_SENSITIVE_TEXT:80001,ERR_SVR_COMM_BODY_SIZE_LIMIT:80002,OPEN_SERVICE_OVERLOAD_ERROR:60022,ERR_SVR_MSG_PKG_PARSE_FAILED:20001,ERR_SVR_MSG_INTERNAL_AUTH_FAILED:20002,ERR_SVR_MSG_INVALID_ID:20003,ERR_SVR_MSG_PUSH_DENY:20006,ERR_SVR_MSG_IN_PEER_BLACKLIST:20007,ERR_SVR_MSG_BOTH_NOT_FRIEND:20009,ERR_SVR_MSG_NOT_PEER_FRIEND:20010,ERR_SVR_MSG_NOT_SELF_FRIEND:20011,ERR_SVR_MSG_SHUTUP_DENY:20012,ERR_SVR_GROUP_INVALID_PARAMETERS:10004,ERR_SVR_GROUP_PERMISSION_DENY:10007,ERR_SVR_GROUP_NOT_FOUND:10010,ERR_SVR_GROUP_INVALID_GROUPID:10015,ERR_SVR_GROUP_REJECT_FROM_THIRDPARTY:10016,ERR_SVR_GROUP_SHUTUP_DENY:10017,MESSAGE_SEND_FAIL:2100,OVER_FREQUENCY_LIMIT:2996},Sk=[Wv,nm,om,Zv,rm,dm,pm,um,cm,im,am,Bv];function bk(e){var t=!1;return Object.values(Tk).includes(e)&&(t=!0),(e>=120001&&e<=13e4||e>=10100&&e<=10200)&&(t=!0),t}var Dk,Ek=function(e){u(o,e);var n=m(o);function o(e){var t;return r(this,o),(t=n.call(this,e))._n="MessageModule",t._messageOptionsMap=new Map,t._mergerMessageHandler=new kk(g(t)),t}return a(o,[{key:"createTextMessage",value:function(e){var t=this.getMyUserID();e.currentUser=t,e.senderTinyID=this.getMyTinyID();var n=new PI(e),o="string"==typeof e.payload?e.payload:e.payload.text,r=new x_({text:o}),i=this._getNickAndAvatarByUserID(t);return n.setElement(r),n.setNickAndAvatar(i),n.setNameCard(this._getNameCardByGroupID(n)),n}},{key:"createImageMessage",value:function(e){var t=this.getMyUserID();e.currentUser=t,e.senderTinyID=this.getMyTinyID();var n=new PI(e);if(nl){var o=e.payload.file;if(Ql(o))return void this.outputWarning("FileUnsupportedInMP","createImageMessage");var r=o.tempFiles[0].path||o.tempFiles[0].tempFilePath,i={url:r,name:r.slice(r.lastIndexOf("/")+1),size:o.tempFiles&&o.tempFiles[0].size||1,type:r.slice(r.lastIndexOf(".")+1).toLowerCase()};e.payload.file=i}else if(ol)if(Ql(e.payload.file)){var a=e.payload.file;e.payload.file={files:[a]}}else if(od(e.payload.file)&&"undefined"!=typeof uni){var s=e.payload.file.tempFiles[0];e.payload.file={files:[s]}}var u=new vI({imageFormat:Ul.UNKNOWN,uuid:this._generateUUID(e.payload.file),file:e.payload.file}),c=this._getNickAndAvatarByUserID(t);return n.setElement(u),n.setNickAndAvatar(c),n.setNameCard(this._getNameCardByGroupID(n)),this._messageOptionsMap.set(n.clientSequence,e),n}},{key:"createAudioMessage",value:function(e){var t=e.payload.file;if(nl){var n={url:t.tempFilePath,name:t.tempFilePath.slice(t.tempFilePath.lastIndexOf("/")+1),size:t.fileSize,second:parseInt(t.duration)/1e3,type:t.tempFilePath.slice(t.tempFilePath.lastIndexOf(".")+1).toLowerCase()};e.payload.file=n}var o=this.getMyUserID();e.currentUser=o,e.senderTinyID=this.getMyTinyID();var r=new PI(e),i=new _I({second:Math.floor(t.duration/1e3),size:t.fileSize||t.size,url:t.tempFilePath,uuid:this._generateUUID(e.payload.file)}),a=this._getNickAndAvatarByUserID(o);return r.setElement(i),r.setNickAndAvatar(a),r.setNameCard(this._getNameCardByGroupID(r)),this._messageOptionsMap.set(r.clientSequence,e),r}},{key:"createVideoMessage",value:function(e){var t=this.getMyUserID();e.currentUser=t,e.senderTinyID=this.getMyTinyID(),e.payload.file.thumbUrl="",e.payload.file.thumbSize=0;var n={};if(nl){if(Qc)return void this.outputWarning("VideoUnsupportedInAlipay");if(Ql(e.payload.file))return void this.outputWarning("FileUnsupportedInMP","createVideoMessage");var o=e.payload.file;rd(o.tempFiles)&&(o=o.tempFiles[0]),n.url=o.tempFilePath,n.name=o.tempFilePath.slice(o.tempFilePath.lastIndexOf("/")+1),n.size=o.size,n.second=o.duration,n.type=o.tempFilePath.slice(o.tempFilePath.lastIndexOf(".")+1).toLowerCase()}else if(ol){if(Ql(e.payload.file)){var r=e.payload.file;e.payload.file.files=[r]}else if(od(e.payload.file)&&"undefined"!=typeof uni){var i=e.payload.file.tempFile;e.payload.file.files=[i]}var a=e.payload.file;n.url=window.URL.createObjectURL(a.files[0]),n.name=a.files[0].name,n.size=a.files[0].size,n.second=a.files[0].duration||0,n.type=a.files[0].type.split("/")[1]}e.payload.file.videoFile=n;var s=new PI(e),u=new LI({videoFormat:n.type,videoSecond:Fd(n.second,0),videoSize:n.size,remoteVideoUrl:"",videoUrl:n.url,videoUUID:this._generateUUID(e.payload.file.videoFile),thumbUUID:this._generateUUID(e.payload.file.videoFile),thumbWidth:e.payload.file.width||200,thumbHeight:e.payload.file.height||200,thumbUrl:e.payload.file.thumbUrl,thumbSize:e.payload.file.thumbSize,thumbFormat:e.payload.file.thumbUrl.slice(e.payload.file.thumbUrl.lastIndexOf(".")+1).toLowerCase()}),c=this._getNickAndAvatarByUserID(t);return s.setElement(u),s.setNickAndAvatar(c),s.setNameCard(this._getNameCardByGroupID(s)),this._messageOptionsMap.set(s.clientSequence,e),s}},{key:"createCustomMessage",value:function(e){var t=this.getMyUserID();e.currentUser=t,e.senderTinyID=this.getMyTinyID();var n=new PI(e),o=new AI({data:e.payload.data,description:e.payload.description,extension:e.payload.extension}),r=this._getNickAndAvatarByUserID(t);return n.setElement(o),n.setNickAndAvatar(r),n.setNameCard(this._getNameCardByGroupID(n)),n}},{key:"createFaceMessage",value:function(e){var t=this.getMyUserID();e.currentUser=t,e.senderTinyID=this.getMyTinyID();var n=new PI(e),o=new mI(e.payload),r=this._getNickAndAvatarByUserID(t);return n.setElement(o),n.setNickAndAvatar(r),n.setNameCard(this._getNameCardByGroupID(n)),n}},{key:"createMergerMessage",value:function(e){var t=this.getMyUserID();e.currentUser=t,e.senderTinyID=this.getMyTinyID();var n=this._getNickAndAvatarByUserID(t),o=new PI(e),r=new OI(e.payload);return o.setElement(r),o.setNickAndAvatar(n),o.setNameCard(this._getNameCardByGroupID(o)),o.setRelayFlag(!0),o}},{key:"createForwardMessage",value:function(e){var t=e.to,n=e.conversationType,o=e.priority,r=e.payload,i=e.needReadReceipt,a=e.receiverList,s=this.getMyUserID(),u=this._getNickAndAvatarByUserID(s);if(r.type===Ir.MSG_GRP_TIP)return BI({code:mm});var c={to:t,conversationType:n,conversationID:"".concat(n).concat(t),priority:o,isPlaceMessage:0,status:Kp.UNSEND,currentUser:s,senderTinyID:this.getMyTinyID(),cloudCustomData:e.cloudCustomData||r.cloudCustomData||"",needReadReceipt:i,receiverList:a,isSupportExtension:e.isSupportExtension||!1},l=new PI(c);return l.setElement(r.getElements()[0]),l.setNickAndAvatar(u),l.setNameCard(this._getNameCardByGroupID(r)),l.setRelayFlag(!0),l}},{key:"downloadMergerMessage",value:function(e){return this._mergerMessageHandler.downloadMergerMessage(e)}},{key:"createFileMessage",value:function(e){if(nl){if(!Yc&&!Jc&&!el)return;var n=rl.getSystemInfoSync().SDKVersion;if(Yc&&Pd(n,"2.5.0")<0)return void this.outputWarning("WXChooseMessageFile");if(Jc&&Pd(n,"1.18.0")<0)return void this.outputWarning("QQChooseMessageFile")}if(ol||el){if(Ql(e.payload.file)){var o=e.payload.file;e.payload.file={files:[o]}}else if(od(e.payload.file)&&"undefined"!=typeof uni){var r=e.payload.file,i=r.tempFiles,a=r.files,s=null;rd(i)?s=i[0]:rd(a)&&(s=a[0]),e.payload.file={files:[s]}}}else if(Yc||Jc){var u=e.payload.file.tempFiles,c=t(t({},u[0]),{},{url:u[0].path});e.payload.file={files:[c]}}var l=this.getMyUserID();e.currentUser=l,e.senderTinyID=this.getMyTinyID();var d=new PI(e),p=new EI({uuid:this._generateUUID(e.payload.file),file:e.payload.file}),f=this._getNickAndAvatarByUserID(l);return d.setElement(p),d.setNickAndAvatar(f),d.setNameCard(this._getNameCardByGroupID(d)),this._messageOptionsMap.set(d.clientSequence,e),d}},{key:"createLocationMessage",value:function(e){var t=this.getMyUserID();e.currentUser=t,e.senderTinyID=this.getMyTinyID();var n=new PI(e),o=new RI(e.payload),r=this._getNickAndAvatarByUserID(t);return n.setElement(o),n.setNickAndAvatar(r),n.setNameCard(this._getNameCardByGroupID(n)),n}},{key:"_onCannotFindModule",value:function(){return BI({code:n_})}},{key:"sendMessageInstance",value:function(e,t){var n=this;if(!1===this.getModule(ph).filterMessage(e,t))return this._onSendMessageFailed(e,new UI({code:f_}));var o,r=null;switch(e.conversationType){case Ir.CONV_C2C:if(!(r=this.getModule(Hf)))return this._onCannotFindModule();break;case Ir.CONV_GROUP:if(!(r=this.getModule(Kf)))return this._onCannotFindModule();if(bd({groupID:e.to})){var i=r.getLocalGroupProfile(e.to);if(i&&i.isSupportTopic)return BI({code:Qv})}break;default:return BI({code:zv})}var a=this.getModule(eh),s=this.getModule(Kf);return a.upload(e).then((function(){return n._getSendMessageSpecifiedKey(e)===k_&&n.getModule(ch).addSuccessCount(T_),s.guardForAVChatRoom(e).then((function(){if(!e.isSendable())return BI({code:fm});n._addSendMessageTotalCount(e),o=Date.now();var i=function(e){var t="utf-8";ol&&document&&(t=document.charset.toLowerCase());var n,o,r=0;if(o=e.length,"utf-8"===t||"utf8"===t)for(var i=0;i<o;i++)(n=e.codePointAt(i))<=127?r+=1:n<=2047?r+=2:n<=65535?r+=3:(r+=4,i++);else if("utf-16"===t||"utf16"===t)for(var a=0;a<o;a++)(n=e.codePointAt(a))<=65535?r+=2:(r+=4,a++);else r=e.replace(/[^\x00-\xff]/g,"aa").length;return r}(JSON.stringify(e));return e.type===Ir.MSG_MERGER&&i>11264?n._mergerMessageHandler.uploadMergerMessage(e,i).then((function(o){var r=n._mergerMessageHandler.createMergerMessagePack(e,t,o);return n.request(r)})):(n.getModule(Wf).setMessageRandom(e),e.conversationType===Ir.CONV_C2C||e.conversationType===Ir.CONV_GROUP?r.sendMessage(e,t):void 0)})).then((function(i){var a=i.data,s=a.time,u=a.sequence,c=a.readReceiptCode;ed(c)&&0!==c&&(new w_("sendMessageWithReceipt").setMessage("from:".concat(e.from," to:").concat(e.to," sequence:").concat(u," readReceiptCode:").concat(c)).end(),Gl.w("".concat(n._n,".sendMessageInstance readReceiptCode:").concat(c," message:").concat(n.getErrorMessage(c)))),n._addSendMessageSuccessCount(e,o),n._messageOptionsMap.delete(e.clientSequence);var l=n.getModule(Wf);e.status=Kp.SUCCESS,e.time=s;var d=!1;if(e.conversationType===Ir.CONV_GROUP)e.sequence=u;else if(e.conversationType===Ir.CONV_C2C){var p=l.getLatestMessageSentByMe(e.conversationID);if(p){var f=p.nick,h=p.avatar;f===e.nick&&h===e.avatar||(d=!0)}}if(d&&l.modifyMessageSentByMe({conversationID:e.conversationID,latestNick:e.nick,latestAvatar:e.avatar}),r.isOnlineMessage(e,t))e._onlineOnlyFlag=!0;else{l.appendToMessageList(e);var g=e;od(t)&&od(t.messageControlInfo)&&(!0===t.messageControlInfo.excludedFromLastMessage&&(e._isExcludedFromLastMessage=!0,g=""),!0===t.messageControlInfo.excludedFromUnreadCount&&(e._isExcludedFromUnreadCount=!0));var v=e.conversationType;Dd(e.to)&&(v=Ir.CONV_TOPIC,n.getModule(Zf).onMessageSent({groupID:Vd(e.to),topicID:e.to,lastMessage:g})),l.onMessageSent({conversationOptionsList:[{conversationID:e.conversationID,unreadCount:0,type:v,subType:e.conversationSubType,lastMessage:g}]})}return e.getRelayFlag()||"TIMImageElem"!==e.type||Ud(e.payload.imageInfoArray),GI({message:e})}))})).catch((function(t){return n._onSendMessageFailed(e,t)}))}},{key:"_onSendMessageFailed",value:function(e,t){e.status=Kp.FAIL,this.getModule(Wf).deleteMessageRandom(e),this._addSendMessageFailCountOnUser(e,t);var n=new w_("sendMessage");return n.setMessage("tjg_id:".concat(this.generateTjgID(e)," type:").concat(e.type," from:").concat(e.from," to:").concat(e.to)),this.probeNetwork().then((function(e){var o=_(e,2),r=o[0],i=o[1];n.setError(t,r,i).end()})),Gl.e("".concat(this._n,"._onSendMessageFailed error:"),t),BI(new UI({code:t&&t.code?t.code:Hv,message:t&&t.message?t.message:void 0,data:{message:e}}))}},{key:"_getSendMessageSpecifiedKey",value:function(e){if([Ir.MSG_IMAGE,Ir.MSG_AUDIO,Ir.MSG_VIDEO,Ir.MSG_FILE].includes(e.type))return k_;if(e.conversationType===Ir.CONV_C2C)return M_;if(e.conversationType===Ir.CONV_GROUP){var t=this.getModule(Kf).getLocalGroupProfile(e.to);if(!t)return;var n=t.type;return Sd(n)?C_:I_}}},{key:"_addSendMessageTotalCount",value:function(e){var t=this._getSendMessageSpecifiedKey(e);t&&this.getModule(ch).addTotalCount(t)}},{key:"_addSendMessageSuccessCount",value:function(e,t){var n=Math.abs(Date.now()-t),o=this._getSendMessageSpecifiedKey(e);if(o){var r=this.getModule(ch);r.addSuccessCount(o),r.addCost(o,n)}}},{key:"_addSendMessageFailCountOnUser",value:function(e,t){var n,o,r=t.code,i=void 0===r?-1:r,a=this.getModule(ch),s=this._getSendMessageSpecifiedKey(e);s===k_&&(n=i,o=!1,Sk.includes(n)&&(o=!0),o)?a.addFailedCountOfUserSide(T_):bk(i)&&s&&a.addFailedCountOfUserSide(s)}},{key:"resendMessage",value:function(e){return e.isResend=!0,e.status=Kp.UNSEND,this.sendMessageInstance(e)}},{key:"revokeMessage",value:function(e){var t=this,n=null;if(e.conversationType===Ir.CONV_C2C?n=this.getModule(Hf):e.conversationType===Ir.CONV_GROUP&&(n=this.getModule(Kf)),!n)return this._onCannotFindModule();var o=new w_("revokeMessage");o.setMessage("tjg_id:".concat(this.generateTjgID(e)," type:").concat(e.type," from:").concat(e.from," to:").concat(e.to));var r="".concat(this._n,".").concat("revokeMessage");return n.revokeMessage(e).then((function(n){var i=n.data.recallRetList;if(!Yd(i)&&0!==i[0].retCode){var a=new UI({code:i[0].retCode,data:{message:e}});return o.setCode(a.code).setMoreMessage(a.message).end(),BI(a)}return Gl.i("".concat(r," ok. ID:").concat(e.ID)),e.isRevoked=!0,o.end(),t.getModule(Wf).onMessageRevoked([e]),GI({message:e})})).catch((function(n){t.probeNetwork().then((function(e){var t=_(e,2),r=t[0],i=t[1];o.setError(n,r,i).end()}));var i=new UI({code:n&&n.code?n.code:Yv,message:n&&n.message?n.message:void 0,data:{message:e}});return Gl.w("".concat(r," failed. error:"),n),BI(i)}))}},{key:"deleteMessage",value:function(e){var t=this,n=null,o=e[0],r=o.conversationID,i="",a=[],s=[];if(o.conversationType===Ir.CONV_C2C)n=this.getModule(Hf),i=r.replace(Ir.CONV_C2C,""),e.forEach((function(e){e&&e.status===Kp.SUCCESS&&e.conversationID===r&&(e._onlineOnlyFlag||a.push("".concat(e.sequence,"_").concat(e.random,"_").concat(e.time)),s.push(e))}));else if(o.conversationType===Ir.CONV_GROUP)n=this.getModule(Kf),i=r.replace(Ir.CONV_GROUP,""),e.forEach((function(e){e&&e.status===Kp.SUCCESS&&e.conversationID===r&&(e._onlineOnlyFlag||a.push("".concat(e.sequence)),s.push(e))}));else if(o.conversationType===Ir.CONV_SYSTEM)return BI({code:em});if(!n)return this._onCannotFindModule();if(0===a.length)return this._onMessageDeleted(s);a.length>30&&(a=a.slice(0,30),s=s.slice(0,30));var u=new w_("deleteMessage");u.setMessage("to:".concat(i," count:").concat(a.length));var c="".concat(this._n,".").concat("deleteMessage");return n.deleteMessage({to:i,keyList:a}).then((function(e){return u.end(),Gl.i("".concat(c," ok")),t._onMessageDeleted(s)})).catch((function(e){t.probeNetwork().then((function(t){var n=_(t,2),o=n[0],r=n[1];u.setError(e,o,r).end()})),Gl.w("".concat(c," failed. error:"),e);var n=new UI({code:e&&e.code?e.code:Jv,message:e&&e.message?e.message:void 0});return BI(n)}))}},{key:"_onMessageDeleted",value:function(e){return this.getModule(Wf).onMessageDeleted(e),qI({messageList:e})}},{key:"translateText",value:function(e){var n="".concat(this._n,".").concat("translateText"),o=e.sourceTextList,r=e.sourceLanguage,i=e.targetLanguage,a=new w_("translateText");return a.setMessage("sourceLanguage:".concat(r," targetLanguage:").concat(i)),this.request({protocolName:Ov,requestData:{sourceTextList:o,source:r||"auto",target:i,from:this.getMyTinyID(),SDKAppID:this.getSDKAppID()}}).then((function(e){var o=e.data,r=o.error,i=o.requestID,s=o.translatedTextList;if(0===r.code)return a.end(),Gl.i("".concat(n," ok. requestID:").concat(i)),GI({translatedTextList:s});throw t(t({},r),{},{requestID:i})})).catch((function(e){return a.setCode(e.code).setMoreMessage(e.requestID).end(),Gl.w("".concat(n," failed. error:"),e),BI({code:tm})}))}},{key:"modifyRemoteMessage",value:function(e){var t=this,n=null,o=e.conversationType,r=e.to;if(this.getModule(Kf).isMessageFromOrToAVChatroom(r))return BI({code:ym,data:{message:e}});if(!1===this.getModule(ph).filterMessage(e))return BI({code:f_,data:{message:e}});o===Ir.CONV_C2C?n=this.getModule(Hf):o===Ir.CONV_GROUP&&(n=this.getModule(Kf));var i=new w_("modifyMessage");i.setMessage("to:".concat(r));var a="".concat(this._n,".modifyRemoteMessage");return n.modifyRemoteMessage(e).then((function(n){i.end(),Gl.i("".concat(a," ok"));var o=t._onModifyRemoteMessageResp(e,n.data);return GI({message:o})})).catch((function(n){if(i.setCode(n.code).setMoreMessage(n.message).end(),Gl.w("".concat(a," failed. error:"),n),20027===n.code){var o=t._onModifyRemoteMessageResp(e,n.data);return BI({code:_m,data:{message:o}})}return BI({code:n.code,message:n.message,data:{message:e}})}))}},{key:"_onModifyRemoteMessageResp",value:function(e,t){Gl.d("".concat(this._n,"._onModifyRemoteMessageResp options:"),t);var n=e.conversationType,o=e.from,r=e.to,i=e.random,a=e.sequence,s=e.time,u=t.elements,c=t.messageVersion,l=t.cloudCustomData,d=void 0===l?"":l;return this.getModule(Wf).onMessageModified({conversationType:n,from:o,to:r,time:s,random:i,sequence:a,elements:u,cloudCustomData:d,messageVersion:c})}},{key:"_generateUUID",value:function(e){var t=this.getModule(Yf),n="".concat(t.getSDKAppID(),"-").concat(t.getUserID(),"-").concat(function(){for(var e="",t=32;t>0;--t)e+=md[Math.floor(Math.random()*_d)];return e}()),o=e.name||e.value||e.url||e.tempFilePath,r=o&&o.slice(o.lastIndexOf(".")+1);return r&&(n="".concat(n,".").concat(r)),n}},{key:"getMessageOption",value:function(e){return this._messageOptionsMap.get(e)}},{key:"_getNickAndAvatarByUserID",value:function(e){return this.getModule(Vf).getNickAndAvatarByUserID(e)}},{key:"_getNameCardByGroupID",value:function(e){if(e.conversationType===Ir.CONV_GROUP){var t=this.getModule(Kf);if(t)return t.getMyNameCardByGroupID(e.to)}return""}},{key:"reset",value:function(){Gl.l("".concat(this._n,".reset")),this._messageOptionsMap.clear()}}]),o}(vh),Ak=function(e){u(n,e);var t=m(n);function n(e){var o;return r(this,n),(o=t.call(this,e))._n="MessageExtensionModule",o.messageExtensionMap=new Map,o.globalSeqMap=new Map,o.getMessageExtensionsMap=new Map,o}return a(n,[{key:"onMessageExtensionNotify",value:function(e){var t=this,n=e.dataList,o=n.messageInfo,r=n.operateType,i=n.operateResultList,a=n.tinyID,s=n.globalSequence,u=o.clientTime,c=o.random,l="".concat(a,"-").concat(u,"-").concat(c),d=[],p=[];Gl.l("".concat(this._n,".onMessageExtensionNotify messageID:").concat(l," operateType:").concat(r," globalSequence:").concat(s)),this._updateGlobalSequence(l,s);var f=!1,h=!1;i.forEach((function(e){var n=e.extensions,o=void 0===n?[]:n,i=e.clearSequence;1===r?(f=!0,o.forEach((function(e){d.push({key:e.key,value:e.value})})),t._updateLocalExtension(l,o)):2===r?(h=!0,o.forEach((function(e){p.push(e.key)})),t._updateLocalExtension(l,o)):3===r&&(h=!0,t._hasLocalExtension(l)&&t._getLocalExtension(l).forEach((function(e,t){e.seq<=i&&!Yd(e.value)&&p.push(t)})),t._clearLocalExtension(l,i))})),f&&this.emitOuterEvent(Mr.MESSAGE_EXTENSIONS_UPDATED,{messageID:l,extensions:d}),h&&this.emitOuterEvent(Mr.MESSAGE_EXTENSIONS_DELETED,{messageID:l,keyList:p})}},{key:"setMessageExtensions",value:function(e,t){var n=this;if(!this.canIUse(Uc.MSG_EXT))return BI({code:p_});var o="".concat(this._n,".").concat("setMessageExtensions"),r=e.ID,i=e.conversationID,a=e.sequence,s=e.time,u=y(t);t.length>20&&(u=t.slice(0,20),Gl.w("".concat(o,". the length of extensions cannot exceed 20.")));var c="conversationID:".concat(i," messageID:").concat(r," sequence:").concat(a," time:").concat(s," count:").concat(u.length),l=new w_("setMessageExtensions");return l.setMessage(c),Gl.l("".concat(o," ").concat(c)),this._modifyMessageExtensions(e,u).then((function(e){var t=e.resultList,n=e.successCount,r=e.failureCount,i="success count:".concat(n," fail count:").concat(r);return l.setMoreMessage(i).end(),Gl.l("".concat(o," ok. ").concat(i)),GI({extensions:t})})).catch((function(e){return n.probeNetwork().then((function(t){var n=_(t,2),o=n[0],r=n[1];l.setError(e,o,r).end()})),Gl.e("".concat(o," failed. error:"),e),BI(e)}))}},{key:"getMessageExtensions",value:function(e){var t=this;if(!this.canIUse(Uc.MSG_EXT))return BI({code:p_});var n="".concat(this._n,".").concat("getMessageExtensions"),o=e.ID,r=e.conversationID,i=e.sequence,a=e.time,s="conversationID:".concat(r," messageID:").concat(o," sequence:").concat(i," time:").concat(a),u=new w_("getMessageExtensions");u.setMessage(s),Gl.l("".concat(n," ").concat(s));var c=void 0;return this.getMessageExtensionsMap.has(o)&&(c=this._getGlobalSequence(o)),this._getMessageExtensions(e,c).then((function(e){return u.end(),Gl.l("".concat(n," ok. total count:").concat(e.length)),id(c)&&e.length>0&&t.getMessageExtensionsMap.set(o,1),GI({extensions:e})})).catch((function(e){return t.probeNetwork().then((function(t){var n=_(t,2),o=n[0],r=n[1];u.setError(e,o,r).end()})),Gl.e("".concat(n," failed. error:"),e),BI(e)}))}},{key:"deleteMessageExtensions",value:function(e,t){var n=this;if(!this.canIUse(Uc.MSG_EXT))return BI({code:p_});var o="".concat(this._n,".").concat("deleteMessageExtensions"),r=[],i=3;Yd(t)||(i=2,t.forEach((function(e){r.push({key:e,value:"",seq:0})})));var a=e.ID,s=e.conversationID,u=e.sequence,c=e.time,l="conversationID:".concat(s," messageID:").concat(a," sequence:").concat(u," time:").concat(c," operateType:").concat(i),d=new w_("deleteMessageExtensions");return d.setMessage(l),Gl.l("".concat(o," ").concat(l)),this._modifyMessageExtensions(e,r,i).then((function(e){var t=e.resultList,n=e.successCount,r=e.failureCount,a="";return 2===i&&(a="success count:".concat(n," fail count:").concat(r)),d.setMoreMessage("".concat(a)).end(),Gl.l("".concat(o," ok. ").concat(a)),GI({extensions:t})})).catch((function(e){return n.probeNetwork().then((function(t){var n=_(t,2),o=n[0],r=n[1];d.setError(e,o,r).end()})),Gl.e("".concat(o," failed. error:"),e),BI(e)}))}},{key:"_modifyMessageExtensions",value:function(e,t){var n=this,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=e.conversationType,i=void 0;3!==o&&(i=this._getRequestExtensions(e,t));var a=null;switch(r){case Ir.CONV_C2C:a=this.getModule(Hf);break;case Ir.CONV_GROUP:a=this.getModule(Kf);break;default:return BI({code:n_})}return a.modifyMessageExtensions(e,i,o).then((function(t){var o=t.data,r=o.extensions,i=o.seq,a=[],s=0,u=0,c=[];return(r=Yd(r)?[]:r).forEach((function(e){var t=e.errorCode,n=e.extension,o=n.key,r=n.value,i=n.seq;a.push({code:t,key:o,value:r}),0===t?s++:u++,c.push({key:o,value:r,seq:i})})),n._updateGlobalSequence(e.ID,i),c.length>0&&(n._updateLocalExtension(e.ID,c),c=null),{resultList:a,successCount:s,failureCount:u}})).catch((function(e){return BI(e)}))}},{key:"_getRequestExtensions",value:function(e,t){var n=[];if(this._hasLocalExtension(e.ID)){var o=this._getLocalExtension(e.ID);return t.forEach((function(e){var t=e.key,r=e.value,i=0;o.has(t)&&(i=o.get(t).seq),n.push({key:t,value:r,seq:i})})),n}return t.forEach((function(e){var t=e.key,o=e.value;n.push({key:t,value:o,seq:0})})),n}},{key:"_getMessageExtensions",value:function(e,t){var n=this,o="".concat(this._n,"._getMessageExtensions"),r=e.ID,i=null;switch(e.conversationType){case Ir.CONV_C2C:i=this.getModule(Hf);break;case Ir.CONV_GROUP:i=this.getModule(Kf);break;default:return BI({code:n_})}return i.getMessageExtensions(e,t).then((function(t){var i=t.data,a=i.extensions,s=i.completeFlag,u=i.globalSequence,c=i.clearSequence;if(a=Yd(a)?[]:a,Gl.l("".concat(o," ok. completeFlag:").concat(s," globalSequence:").concat(u," clearSequence:").concat(c," count:").concat(a.length)),n._updateLocalExtension(r,a),n._clearLocalExtension(r,c),n._updateGlobalSequence(r,u),1!==s){var l=a.slice(-1)[0].seq+1;return n._getMessageExtensions(e,l)}return n._getLocalExtensions(r)})).catch((function(e){return BI(e)}))}},{key:"_hasLocalExtension",value:function(e){return this.messageExtensionMap.has(e)}},{key:"_getLocalExtension",value:function(e){return this.messageExtensionMap.get(e)}},{key:"_updateLocalExtension",value:function(e,t){this._hasLocalExtension(e)||this.messageExtensionMap.set(e,new Map);var n=this._getLocalExtension(e);t.forEach((function(e){var t=e.key,o=e.value,r=void 0===o?"":o,i=e.seq;n.set(t,{value:r,seq:i})}))}},{key:"_clearLocalExtension",value:function(e,t){if(!(t<=0)&&this._hasLocalExtension(e)){var n=this._getLocalExtension(e);n.forEach((function(e,o){e.seq<=t&&n.delete(o)}))}}},{key:"_getLocalExtensions",value:function(e){var t=[];return this._hasLocalExtension(e)&&this._getLocalExtension(e).forEach((function(e,n){var o=e.value;Yd(o)||t.push({key:n,value:o})})),t}},{key:"_getGlobalSequence",value:function(e){return this.globalSeqMap.get(e)}},{key:"_updateGlobalSequence",value:function(e,t){this.globalSeqMap.set(e,t)}},{key:"reset",value:function(){Gl.l("".concat(this._n,".reset")),this.messageExtensionMap.clear(),this.globalSeqMap.clear(),this.getMessageExtensionsMap.clear()}}]),n}(vh),Lk=function(e){u(n,e);var t=m(n);function n(e){var o;return r(this,n),(o=t.call(this,e))._n="ComboMessageModule",o}return a(n,[{key:"sendMessage",value:function(e){var t=this,n=this._constructMessageInstance(e);if(null===n)return BI({code:Hv});this._addSendMessageTotalCount(n);var o=Date.now();return this.getModule(Wf).setMessageRandom(n),this._sendComboMessage(n,e).then((function(e){var r=e.data,i=r.time,a=r.sequence,s=r.readReceiptCode;ed(s)&&0!==s&&(new w_("sendMessageWithReceipt").setMessage("from:".concat(n.from," to:").concat(n.to," sequence:").concat(a," readReceiptCode:").concat(s)).end(),Gl.w("".concat(t._n,".sendMessage readReceiptCode:").concat(s," message:").concat(t.getErrorMessage(s)))),t._addSendMessageSuccessCount(n,o);var u=t.getModule(Wf);n.status=Kp.SUCCESS,n.time=i,n.conversationType===Ir.CONV_GROUP&&(n.sequence=a),u.appendToMessageList(n);var c=n;return!0===n._isExcludedFromLastMessage&&(c=""),u.onMessageSent({conversationOptionsList:[{conversationID:n.conversationID,unreadCount:0,type:n.conversationType,subType:n.conversationSubType,lastMessage:c}]}),GI({message:n})})).catch((function(e){return t._onSendMessageFailed(n,e)}))}},{key:"_sendComboMessage",value:function(e,t){var n=this._m.getModule(oh),o="";return e.conversationType===Ir.CONV_C2C&&(o="".concat(Gc.NAME.OPEN_IM,".").concat(Gc.CMD.SEND_MESSAGE)),e.conversationType===Ir.CONV_GROUP&&(o="".concat(Gc.NAME.GROUP,".").concat(Gc.CMD.SEND_GROUP_MESSAGE)),n.sendComboMessage({servcmd:o,data:t})}},{key:"_constructMessageInstance",value:function(e){var t="".concat(this._n,"._constructMessageInstance"),n=null;try{var o=this.getMyUserID(),r={};if(r.senderTinyID=this.getMyTinyID(),r.currentUser=o,r.from=e.From_Account||o,e.GroupId?(r.conversationID="".concat(Ir.CONV_GROUP).concat(e.GroupId),r.conversationType=Ir.CONV_GROUP,r.to=e.GroupId):e.To_Account&&(r.conversationID="".concat(Ir.CONV_C2C).concat(e.To_Account),r.conversationType=Ir.CONV_C2C,r.to=e.To_Account),r.time=e.MsgTimeStamp||0,r.random=e.Random||e.MsgRandom||0,r.priority=e.MsgPriority,td(e.CloudCustomData)&&e.CloudCustomData.length>0&&(r.cloudCustomData=e.CloudCustomData),rd(e.SendMsgControl)&&(r.messageControlInfo={},e.SendMsgControl.includes("NoUnread")&&(r.messageControlInfo.excludedFromUnreadCount=1),e.SendMsgControl.includes("NoLastMsg")&&(r.messageControlInfo.excludedFromLastMessage=1)),r.conversationType===Ir.CONV_GROUP&&rd(e.To_Account)&&e.To_Account.length>0){var i=e.To_Account;e.To_Account.length>50&&(i=e.To_Account.slice(0,50),Gl.w("".concat(t," To_Account must be less than or equal to 50."))),r.receiverList=y(i),e.To_Account=y(i)}1!==e.IsNeedReadReceipt&&1!==e.NeedReadReceipt||(r.needReadReceipt=!0),1===e.SupportMessageExtension&&(r.isSupportExtension=!0),(n=new PI(r)).status=Kp.UNSEND,e.MsgClientTime=n.clientTime,n.conversationType===Ir.CONV_C2C&&(e.MsgSeq=n.sequence);for(var a,s=e.MsgBody.length,u=0;u<s;u++)"TIMTextElem"===(a=e.MsgBody[u]).MsgType?n.setTextElement(a.MsgContent.Text):"TIMCustomElem"===a.MsgType?n.setCustomElement({data:a.MsgContent.Data||"",description:a.MsgContent.Desc||"",extension:a.MsgContent.Ext||""}):"TIMFaceElem"===a.MsgType&&n.setFaceElement({index:a.MsgContent.Index,data:a.MsgContent.Data});var c=n.getElements();n.payload=c[0].content,n.type=c[0].type}catch(XD){n=null,Gl.e("".concat(t," failed. error:"),XD)}return n}},{key:"_onSendMessageFailed",value:function(e,t){e.status=Kp.FAIL,this.getModule(Wf).deleteMessageRandom(e),this._addSendMessageFailCountOnUser(e,t);var n=new w_("sendMessage");return n.setMessage("tjg_id:".concat(this.generateTjgID(e)," type:").concat(e.type," from:").concat(e.from," to:").concat(e.to)),this.probeNetwork().then((function(e){var o=_(e,2),r=o[0],i=o[1];n.setError(t,r,i).end()})),Gl.e("".concat(this._n,"._onSendMessageFailed error:"),t),BI(new UI({code:t&&t.code?t.code:Hv,message:t&&t.message?t.message:void 0,data:{message:e}}))}},{key:"_getSendMessageSpecifiedKey",value:function(e){if(e.conversationType===Ir.CONV_C2C)return M_;if(e.conversationType===Ir.CONV_GROUP){var t=this.getModule(Kf).getLocalGroupProfile(e.to);if(!t)return;var n=t.type;return Sd(n)?C_:I_}}},{key:"_addSendMessageTotalCount",value:function(e){var t=this._getSendMessageSpecifiedKey(e);t&&this.getModule(ch).addTotalCount(t)}},{key:"_addSendMessageSuccessCount",value:function(e,t){var n=Math.abs(Date.now()-t),o=this._getSendMessageSpecifiedKey(e);if(o){var r=this.getModule(ch);r.addSuccessCount(o),r.addCost(o,n)}}},{key:"_addSendMessageFailCountOnUser",value:function(e,t){var n=t.code,o=void 0===n?-1:n,r=this.getModule(ch),i=this._getSendMessageSpecifiedKey(e);bk(o)&&i&&r.addFailedCountOfUserSide(i)}}]),n}(vh),Rk=function(e){u(n,e);var t=m(n);function n(e){var o;return r(this,n),(o=t.call(this,e))._n="PluginModule",o.plugins={},o}return a(n,[{key:"registerPlugin",value:function(e){var t=this;Object.keys(e).forEach((function(n){t.plugins[n]=e[n]})),new w_("registerPlugin").setMessage("".concat(Object.keys(e))).end()}},{key:"getPlugin",value:function(e){return this.plugins[e]}},{key:"reset",value:function(){}}]),n}(vh),wk=function(e){u(o,e);var n=m(o);function o(e){var t;return r(this,o),(t=n.call(this,e))._n="SyncUnreadMessageModule",t._cookie="",t._onlineSyncFlag=!1,t.getInnerEmitterInstance().on(rC,t._onLoginSuccess,g(t)),t}return a(o,[{key:"_onLoginSuccess",value:function(e){this._startSync({cookie:this._cookie,syncFlag:0,isOnlineSync:0})}},{key:"_startSync",value:function(e){var n=this,o=e.cookie,r=e.syncFlag,i=e.isOnlineSync,a="".concat(this._n,"._startSync");Gl.l("".concat(a," cookie:").concat(o," syncFlag:").concat(r," isOnlineSync:").concat(i)),this.request({protocolName:Ih,requestData:{cookie:o,syncFlag:r,isOnlineSync:i}}).then((function(e){var o=e.data,r=o.cookie,i=o.syncFlag;n._cookie=r,Yd(r)||(0===i||1===i?(n._dispatchUnreadMessage(t(t({},e.data),{},{isSyncingEnded:!1})),n._startSync({cookie:r,syncFlag:i,isOnlineSync:0})):2===i&&n._dispatchUnreadMessage(t(t({},e.data),{},{isSyncingEnded:!0})))})).catch((function(e){Gl.e("".concat(a," failed. error:"),e)}))}},{key:"_dispatchUnreadMessage",value:function(e){e.eventArray&&this.getModule(oh).onMessage({head:{},body:{eventArray:e.eventArray,isInstantMessage:this._onlineSyncFlag,isSyncingEnded:e.isSyncingEnded}}),this.getModule(Hf).onNewC2CMessage({dataList:e.messageList,isInstantMessage:!!e.isSyncingEnded&&this._onlineSyncFlag,C2CRemainingUnreadList:e.C2CRemainingUnreadList,C2CPairUnreadList:e.C2CPairUnreadList})}},{key:"startOnlineSync",value:function(){Gl.l("".concat(this._n,".startOnlineSync")),this._onlineSyncFlag=!0,this._startSync({cookie:this._cookie,syncFlag:0,isOnlineSync:1})}},{key:"startSyncOnReconnected",value:function(){Gl.l("".concat(this._n,".startSyncOnReconnected.")),this._onlineSyncFlag=!0,this._startSync({cookie:this._cookie,syncFlag:0,isOnlineSync:0})}},{key:"reset",value:function(){Gl.l("".concat(this._n,".reset")),this._onlineSyncFlag=!1,this._cookie=""}}]),o}(vh),Ok={request:{toAccount:"To_Account",fromAccount:"From_Account",to:"To_Account",from:"From_Account",groupID:"GroupId",groupAtUserID:"GroupAt_Account",extension:"Ext",data:"Data",description:"Desc",elements:"MsgBody",sizeType:"Type",downloadFlag:"Download_Flag",thumbUUID:"ThumbUUID",videoUUID:"VideoUUID",remoteAudioUrl:"Url",remoteVideoUrl:"VideoUrl",videoUrl:"",imageUrl:"URL",fileUrl:"Url",uuid:"UUID",priority:"MsgPriority",receiverUserID:"To_Account",receiverGroupID:"GroupId",messageSender:"SenderId",messageReceiver:"ReceiverId",nick:"From_AccountNick",avatar:"From_AccountHeadurl",messageNumber:"MsgNum",pbDownloadKey:"PbMsgKey",downloadKey:"JsonMsgKey",applicationType:"PendencyType",userIDList:"To_Account",groupNameList:"GroupName",userID:"To_Account",groupAttributeList:"GroupAttr",mainSequence:"AttrMainSeq",avChatRoomKey:"BytesKey",attributeControl:"AttrControl",sequence:"seq",messageControlInfo:"SendMsgControl",updateSequence:"UpdateSeq",clientTime:"MsgClientTime",sequenceList:"MsgSeqList",topicID:"TopicId",customData:"CustomString",isSupportTopic:"SupportTopic",isWebUniapp:"is_web_uniapp",isSupportExtension:"SupportMessageExtension",messageSequence:"MsgSeq",messageKey:"MsgKey",startSequence:"startSeq"},response:{MsgPriority:"priority",ThumbUUID:"thumbUUID",VideoUUID:"videoUUID",Download_Flag:"downloadFlag",GroupId:"groupID",Member_Account:"userID",MsgList:"messageList",SyncFlag:"syncFlag",To_Account:"to",From_Account:"from",MsgSeq:"sequence",MsgRandom:"random",MsgTime:"time",MsgTimeStamp:"time",MsgContent:"content",MsgBody:"elements",From_AccountNick:"nick",From_AccountHeadurl:"avatar",GroupWithdrawInfoArray:"revokedInfos",GroupReadInfoArray:"groupMessageReadNotice",LastReadMsgSeq:"lastMessageSeq",WithdrawC2cMsgNotify:"c2cMessageRevokedNotify",C2cWithdrawInfoArray:"revokedInfos",C2cReadedReceipt:"c2cMessageReadReceipt",ReadC2cMsgNotify:"c2cMessageReadNotice",LastReadTime:"peerReadTime",MsgRand:"random",MsgType:"type",MsgShow:"messageShow",NextMsgSeq:"nextMessageSeq",FaceUrl:"avatar",ProfileDataMod:"profileModify",Profile_Account:"userID",ValueBytes:"value",ValueNum:"value",NoticeSeq:"noticeSequence",NotifySeq:"notifySequence",MsgFrom_AccountExtraInfo:"messageFromAccountExtraInformation",Operator_Account:"operatorID",OpType:"operationType",ReportType:"operationType",UserId:"userID",User_Account:"userID",List_Account:"userIDList",MsgOperatorMemberExtraInfo:"operatorInfo",MsgMemberExtraInfo:"memberInfoList",ImageUrl:"avatar",NickName:"nick",MsgGroupNewInfo:"newGroupProfile",MsgAppDefinedData:"groupCustomField",Owner_Account:"ownerID",GroupFaceUrl:"avatar",GroupIntroduction:"introduction",GroupNotification:"notification",GroupApplyJoinOption:"joinOption",MsgKey:"messageKey",GroupInfo:"groupProfile",ShutupTime:"muteTime",Desc:"description",Ext:"extension",GroupAt_Account:"groupAtUserID",MsgNum:"messageNumber",PbMsgKey:"pbDownloadKey",JsonMsgKey:"downloadKey",MsgModifiedFlag:"isModified",PendencyItem:"applicationItem",PendencyType:"applicationType",AddTime:"time",AddSource:"source",AddWording:"wording",ProfileImImage:"avatar",PendencyAdd:"friendApplicationAdded",FrienPencydDel_Account:"friendApplicationDeletedUserIDList",Peer_Account:"userID",GroupAttr:"groupAttributeList",GroupAttrAry:"groupAttributeList",AttrMainSeq:"mainSequence",seq:"sequence",GroupAttrOption:"groupAttributeOption",BytesChangedKeys:"changedKeyList",GroupAttrInfo:"groupAttributeList",GroupAttrSeq:"mainSequence",PushChangedAttrValFlag:"isWithChangedAttributeInfo",SubKeySeq:"sequence",Val:"value",MsgGroupFromCardName:"senderNameCard",MsgGroupFromNickName:"senderNick",C2cNick:"peerNick",C2cImage:"peerAvatar",SendMsgControl:"messageControlInfo",NoLastMsg:"excludedFromLastMessage",NoUnread:"excludedFromUnreadCount",UpdateSeq:"updateSequence",MuteNotifications:"muteFlag",MsgClientTime:"clientTime",TinyId:"tinyID",GroupMsgReceiptList:"readReceiptList",ReadNum:"readCount",UnreadNum:"unreadCount",TopicId:"topicID",MillionGroupFlag:"communityType",SupportTopic:"isSupportTopic",MsgTopicNewInfo:"newTopicInfo",ShutupAll:"muteAllMembers",CustomString:"customData",TopicFaceUrl:"avatar",TopicIntroduction:"introduction",TopicNotification:"notification",TopicIdArray:"topicIDList",MsgVersion:"messageVersion",C2cMsgModNotifys:"c2cMessageModified",GroupMsgModNotifys:"groupMessageModified",ApplyJoinOption:"joinOption",MsgFlag:"messageRemindType",AtInfoList:"groupAtInfoList",AtFlagList:"groupAtType",AtMsgSeq:"sequence",BanDuration:"duration",BanDescription:"reason",NotVisible:"invisible",BytesTag:"tag",BytesValue:"value",RptBytesValue:"value",LatestSeq:"globalSequence",ClearSeq:"clearSequence",SupportMessageExtension:"isSupportExtension",ExtensionList:"extensions",GroupCounter:"counterList",Revoker_Account:"revoker"},ignoreKeyWord:["C2C","ID","USP"]},Nk=bt.PROPER,Pk=yn.trim;function Gk(e,t){if("string"!=typeof e&&!Array.isArray(e))throw new TypeError("Expected the input to be `string | string[]`");var n;return t=Object.assign({pascalCase:!1},t),0===(e=Array.isArray(e)?e.map((function(e){return e.trim()})).filter((function(e){return e.length})).join("-"):e.trim()).length?"":1===e.length?t.pascalCase?e.toUpperCase():e.toLowerCase():(e!==e.toLowerCase()&&(e=Uk(e)),e=e.replace(/^[_.\- ]+/,"").toLowerCase().replace(/[_.\- ]+(\w|$)/g,(function(e,t){return t.toUpperCase()})).replace(/\d+(\w|$)/g,(function(e){return e.toUpperCase()})),n=e,t.pascalCase?n.charAt(0).toUpperCase()+n.slice(1):n)}on({target:"String",proto:!0,forced:(Dk="trim",w((function(){return!!fn[Dk]()||"\u200b\x85\u180e"!=="\u200b\x85\u180e"[Dk]()||Nk&&fn[Dk].name!==Dk})))},{trim:function(){return Pk(this)}});var Uk=function(e){for(var t=!1,n=!1,o=!1,r=0;r<e.length;r++){var i=e[r];t&&/[a-zA-Z]/.test(i)&&i.toUpperCase()===i?(e=e.slice(0,r)+"-"+e.slice(r),t=!1,o=n,n=!0,r++):n&&o&&/[a-zA-Z]/.test(i)&&i.toLowerCase()===i?(e=e.slice(0,r-1)+"-"+e.slice(r-1),o=n,n=!1,t=!0):(t=i.toLowerCase()===i&&i.toUpperCase()!==i,o=n,n=i.toUpperCase()===i&&i.toLowerCase()!==i)}return e};function xk(e,t){var n=0;return function e(t,o){if(++n>100)return n--,t;if(rd(t)){var r=t.map((function(t){return nd(t)?e(t,o):t}));return n--,r}if(nd(t)){var i=(a=t,s=function(e,t){if(!ld(t))return!1;if((r=t)!==Gk(r))for(var n=0;n<Ok.ignoreKeyWord.length&&!t.includes(Ok.ignoreKeyWord[n]);n++);var r;return id(o[t])?function(e){return"OPPOChannelID"===e?e:e[0].toUpperCase()+Gk(e).slice(1)}(t):o[t]},u=Object.create(null),Object.keys(a).forEach((function(e){var t=s(a[e],e);t&&(u[t]=a[e])})),u);return i=Rd(i,(function(t,n){return rd(t)||nd(t)?e(t,o):t})),n--,i}var a,s,u}(e,t)}function Fk(e,t){if(rd(e))return e.map((function(e){return nd(e)?Fk(e,t):e}));if(nd(e)){var n=(o=e,r=function(e,n){return id(t[n])?Gk(n):t[n]},i={},Object.keys(o).forEach((function(e){i[r(o[e],e)]=o[e]})),i);return Rd(n,(function(e){return rd(e)||nd(e)?Fk(e,t):e}))}var o,r,i}var qk="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof DataView,Bk=R.RangeError,Vk=function(e){if(void 0===e)return 0;var t=Lt(e),n=Pt(t);if(t!==n)throw Bk("Wrong length or index");return n},Hk=R.Array,Kk=Math.abs,jk=Math.pow,zk=Math.floor,Zk=Math.log,Wk=Math.LN2,Yk=function(e,t,n){var o,r,i,a=Hk(n),s=8*n-t-1,u=(1<<s)-1,c=u>>1,l=23===t?jk(2,-24)-jk(2,-77):0,d=e<0||0===e&&1/e<0?1:0,p=0;for((e=Kk(e))!=e||1/0===e?(r=e!=e?1:0,o=u):(o=zk(Zk(e)/Wk),e*(i=jk(2,-o))<1&&(o--,i*=2),(e+=o+c>=1?l/i:l*jk(2,1-c))*i>=2&&(o++,i/=2),o+c>=u?(r=0,o=u):o+c>=1?(r=(e*i-1)*jk(2,t),o+=c):(r=e*jk(2,c-1)*jk(2,t),o=0));t>=8;)a[p++]=255&r,r/=256,t-=8;for(o=o<<t|r,s+=t;s>0;)a[p++]=255&o,o/=256,s-=8;return a[--p]|=128*d,a},Jk=function(e,t){var n,o=e.length,r=8*o-t-1,i=(1<<r)-1,a=i>>1,s=r-7,u=o-1,c=e[u--],l=127&c;for(c>>=7;s>0;)l=256*l+e[u--],s-=8;for(n=l&(1<<-s)-1,l>>=-s,s+=t;s>0;)n=256*n+e[u--],s-=8;if(0===l)l=1-a;else{if(l===i)return n?NaN:c?-1/0:1/0;n+=jk(2,t),l-=a}return(c?-1:1)*n*jk(2,l-t)},Xk=function(e){for(var t=De(this),n=Gt(t),o=arguments.length,r=Ot(o>1?arguments[1]:void 0,n),i=o>2?arguments[2]:void 0,a=void 0===i?n:Ot(i,n);a>r;)t[r++]=e;return t},$k=Kt.f,Qk=ot.f,eT=bt.PROPER,tT=bt.CONFIGURABLE,nT=Ct.get,oT=Ct.set,rT=R.ArrayBuffer,iT=rT,aT=iT&&iT.prototype,sT=R.DataView,uT=sT&&sT.prototype,cT=Object.prototype,lT=R.Array,dT=R.RangeError,pT=j(Xk),fT=j([].reverse),hT=Yk,gT=Jk,vT=function(e){return[255&e]},mT=function(e){return[255&e,e>>8&255]},_T=function(e){return[255&e,e>>8&255,e>>16&255,e>>24&255]},yT=function(e){return e[3]<<24|e[2]<<16|e[1]<<8|e[0]},MT=function(e){return hT(e,23,4)},IT=function(e){return hT(e,52,8)},CT=function(e,t){Qk(e.prototype,t,{get:function(){return nT(this)[t]}})},kT=function(e,t,n,o){var r=Vk(n),i=nT(e);if(r+t>i.byteLength)throw dT("Wrong index");var a=nT(i.buffer).bytes,s=r+i.byteOffset,u=us(a,s,s+t);return o?u:fT(u)},TT=function(e,t,n,o,r,i){var a=Vk(n),s=nT(e);if(a+t>s.byteLength)throw dT("Wrong index");for(var u=nT(s.buffer).bytes,c=a+s.byteOffset,l=o(+r),d=0;d<t;d++)u[c+d]=l[i?d:t-d-1]};if(qk){var ST=eT&&"ArrayBuffer"!==rT.name;if(w((function(){rT(1)}))&&w((function(){new rT(-1)}))&&!w((function(){return new rT,new rT(1.5),new rT(NaN),ST&&!tT})))ST&&tT&&rt(rT,"name","ArrayBuffer");else{(iT=function(e){return ws(this,aT),new rT(Vk(e))}).prototype=aT;for(var bT,DT=$k(rT),ET=0;DT.length>ET;)(bT=DT[ET++])in iT||rt(iT,bT,rT[bT]);aT.constructor=iT}cr&&Xo(uT)!==cT&&cr(uT,cT);var AT=new sT(new iT(2)),LT=j(uT.setInt8);AT.setInt8(0,2147483648),AT.setInt8(1,2147483649),!AT.getInt8(0)&&AT.getInt8(1)||Es(uT,{setInt8:function(e,t){LT(this,e,t<<24>>24)},setUint8:function(e,t){LT(this,e,t<<24>>24)}},{unsafe:!0})}else aT=(iT=function(e){ws(this,aT);var t=Vk(e);oT(this,{bytes:pT(lT(t),0),byteLength:t}),O||(this.byteLength=t)}).prototype,uT=(sT=function(e,t,n){ws(this,uT),ws(e,aT);var o=nT(e).byteLength,r=Lt(t);if(r<0||r>o)throw dT("Wrong offset");if(r+(n=void 0===n?o-r:Pt(n))>o)throw dT("Wrong length");oT(this,{buffer:e,byteLength:n,byteOffset:r}),O||(this.buffer=e,this.byteLength=n,this.byteOffset=r)}).prototype,O&&(CT(iT,"byteLength"),CT(sT,"buffer"),CT(sT,"byteLength"),CT(sT,"byteOffset")),Es(uT,{getInt8:function(e){return kT(this,1,e)[0]<<24>>24},getUint8:function(e){return kT(this,1,e)[0]},getInt16:function(e){var t=kT(this,2,e,arguments.length>1?arguments[1]:void 0);return(t[1]<<8|t[0])<<16>>16},getUint16:function(e){var t=kT(this,2,e,arguments.length>1?arguments[1]:void 0);return t[1]<<8|t[0]},getInt32:function(e){return yT(kT(this,4,e,arguments.length>1?arguments[1]:void 0))},getUint32:function(e){return yT(kT(this,4,e,arguments.length>1?arguments[1]:void 0))>>>0},getFloat32:function(e){return gT(kT(this,4,e,arguments.length>1?arguments[1]:void 0),23)},getFloat64:function(e){return gT(kT(this,8,e,arguments.length>1?arguments[1]:void 0),52)},setInt8:function(e,t){TT(this,1,e,vT,t)},setUint8:function(e,t){TT(this,1,e,vT,t)},setInt16:function(e,t){TT(this,2,e,mT,t,arguments.length>2?arguments[2]:void 0)},setUint16:function(e,t){TT(this,2,e,mT,t,arguments.length>2?arguments[2]:void 0)},setInt32:function(e,t){TT(this,4,e,_T,t,arguments.length>2?arguments[2]:void 0)},setUint32:function(e,t){TT(this,4,e,_T,t,arguments.length>2?arguments[2]:void 0)},setFloat32:function(e,t){TT(this,4,e,MT,t,arguments.length>2?arguments[2]:void 0)},setFloat64:function(e,t){TT(this,8,e,IT,t,arguments.length>2?arguments[2]:void 0)}});or(iT,"ArrayBuffer"),or(sT,"DataView");var RT={ArrayBuffer:iT,DataView:sT},wT=RT.ArrayBuffer,OT=RT.DataView,NT=OT.prototype,PT=j(wT.prototype.slice),GT=j(NT.getUint8),UT=j(NT.setUint8),xT=w((function(){return!new wT(2).slice(1,void 0).byteLength}));on({target:"ArrayBuffer",proto:!0,unsafe:!0,forced:xT},{slice:function(e,t){if(PT&&void 0===t)return PT($e(this),e);for(var n=$e(this).byteLength,o=Ot(e,n),r=Ot(void 0===t?n:t,n),i=new(qs(this,wT))(Pt(r-o)),a=new OT(this),s=new OT(i),u=0;o<r;)UT(s,u++,GT(a,o++));return i}});var FT,qT,BT,VT=ot.f,HT=R.Int8Array,KT=HT&&HT.prototype,jT=R.Uint8ClampedArray,zT=jT&&jT.prototype,ZT=HT&&Xo(HT),WT=KT&&Xo(KT),YT=Object.prototype,JT=R.TypeError,XT=xe("toStringTag"),$T=Oe("TYPED_ARRAY_TAG"),QT=Oe("TYPED_ARRAY_CONSTRUCTOR"),eS=qk&&!!cr&&"Opera"!==ln(R.opera),tS=!1,nS={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8},oS={BigInt64Array:8,BigUint64Array:8},rS=function(e){if(!ne(e))return!1;var t=ln(e);return Ae(nS,t)||Ae(oS,t)};for(FT in nS)(BT=(qT=R[FT])&&qT.prototype)?rt(BT,QT,qT):eS=!1;for(FT in oS)(BT=(qT=R[FT])&&qT.prototype)&&rt(BT,QT,qT);if((!eS||!te(ZT)||ZT===Function.prototype)&&(ZT=function(){throw JT("Incorrect invocation")},eS))for(FT in nS)R[FT]&&cr(R[FT],ZT);if((!eS||!WT||WT===YT)&&(WT=ZT.prototype,eS))for(FT in nS)R[FT]&&cr(R[FT].prototype,WT);if(eS&&Xo(zT)!==WT&&cr(zT,WT),O&&!Ae(WT,XT))for(FT in tS=!0,VT(WT,XT,{get:function(){return ne(this)?this[$T]:void 0}}),nS)R[FT]&&rt(R[FT],$T,FT);var iS={NATIVE_ARRAY_BUFFER_VIEWS:eS,TYPED_ARRAY_CONSTRUCTOR:QT,TYPED_ARRAY_TAG:tS&&$T,aTypedArray:function(e){if(rS(e))return e;throw JT("Target is not a typed array")},aTypedArrayConstructor:function(e){if(te(e)&&(!cr||ie(ZT,e)))return e;throw JT(me(e)+" is not a typed array constructor")},exportTypedArrayMethod:function(e,t,n,o){if(O){if(n)for(var r in nS){var i=R[r];if(i&&Ae(i.prototype,e))try{delete i.prototype[e]}catch(XD){try{i.prototype[e]=t}catch(s){}}}WT[e]&&!n||Dt(WT,e,n?t:eS&&KT[e]||t,o)}},exportTypedArrayStaticMethod:function(e,t,n){var o,r;if(O){if(cr){if(n)for(o in nS)if((r=R[o])&&Ae(r,e))try{delete r[e]}catch(XD){}if(ZT[e]&&!n)return;try{return Dt(ZT,e,n?t:eS&&ZT[e]||t)}catch(XD){}}for(o in nS)!(r=R[o])||r[e]&&!n||Dt(r,e,t)}},isView:function(e){if(!ne(e))return!1;var t=ln(e);return"DataView"===t||Ae(nS,t)||Ae(oS,t)},isTypedArray:rS,TypedArray:ZT,TypedArrayPrototype:WT},aS=iS.NATIVE_ARRAY_BUFFER_VIEWS,sS=R.ArrayBuffer,uS=R.Int8Array,cS=!aS||!w((function(){uS(1)}))||!w((function(){new uS(-1)}))||!Uo((function(e){new uS,new uS(null),new uS(1.5),new uS(e)}),!0)||w((function(){return 1!==new uS(new sS(2),1,void 0).length})),lS=Math.floor,dS=Number.isInteger||function(e){return!ne(e)&&isFinite(e)&&lS(e)===e},pS=R.RangeError,fS=R.RangeError,hS=function(e,t){var n=function(e){var t=Lt(e);if(t<0)throw pS("The argument can't be less than 0");return t}(e);if(n%t)throw fS("Wrong offset");return n},gS=iS.aTypedArrayConstructor,vS=function(e){var t,n,o,r,i,a,s=xs(this),u=De(e),c=arguments.length,l=c>1?arguments[1]:void 0,d=void 0!==l,p=Eo(u);if(p&&!So(p))for(a=(i=Lo(u,p)).next,u=[];!(r=G(a,i)).done;)u.push(r.value);for(d&&c>2&&(l=jn(l,arguments[2])),n=Gt(u),o=new(gS(s))(n),t=0;n>t;t++)o[t]=d?l(u[t],t):u[t];return o};D((function(e){var t=Kt.f,n=so.forEach,o=Ct.get,r=Ct.set,i=ot.f,a=We.f,s=Math.round,u=R.RangeError,c=RT.ArrayBuffer,l=c.prototype,d=RT.DataView,p=iS.NATIVE_ARRAY_BUFFER_VIEWS,f=iS.TYPED_ARRAY_CONSTRUCTOR,h=iS.TYPED_ARRAY_TAG,g=iS.TypedArray,v=iS.TypedArrayPrototype,m=iS.aTypedArrayConstructor,_=iS.isTypedArray,y=function(e,t){m(e);for(var n=0,o=t.length,r=new e(o);o>n;)r[n]=t[n++];return r},M=function(e,t){i(e,t,{get:function(){return o(this)[t]}})},I=function(e){var t;return ie(l,e)||"ArrayBuffer"==(t=ln(e))||"SharedArrayBuffer"==t},C=function(e,t){return _(e)&&!ge(t)&&t in e&&dS(+t)&&t>=0},k=function(e,t){return t=Ve(t),C(e,t)?q(2,e[t]):a(e,t)},T=function(e,t,n){return t=Ve(t),!(C(e,t)&&ne(n)&&Ae(n,"value"))||Ae(n,"get")||Ae(n,"set")||n.configurable||Ae(n,"writable")&&!n.writable||Ae(n,"enumerable")&&!n.enumerable?i(e,t,n):(e[t]=n.value,e)};O?(p||(We.f=k,ot.f=T,M(v,"buffer"),M(v,"byteOffset"),M(v,"byteLength"),M(v,"length")),on({target:"Object",stat:!0,forced:!p},{getOwnPropertyDescriptor:k,defineProperty:T}),e.exports=function(e,a,l){var m=e.match(/\d+$/)[0]/8,M=e+(l?"Clamped":"")+"Array",C="get"+e,k="set"+e,T=R[M],S=T,b=S&&S.prototype,D={},E=function(e,t){i(e,t,{get:function(){return function(e,t){var n=o(e);return n.view[C](t*m+n.byteOffset,!0)}(this,t)},set:function(e){return function(e,t,n){var r=o(e);l&&(n=(n=s(n))<0?0:n>255?255:255&n),r.view[k](t*m+r.byteOffset,n,!0)}(this,t,e)},enumerable:!0})};p?cS&&(S=a((function(e,t,n,o){return ws(e,b),xr(ne(t)?I(t)?void 0!==o?new T(t,hS(n,m),o):void 0!==n?new T(t,hS(n,m)):new T(t):_(t)?y(S,t):G(vS,S,t):new T(Vk(t)),e,S)})),cr&&cr(S,g),n(t(T),(function(e){e in S||rt(S,e,T[e])})),S.prototype=b):(S=a((function(e,t,n,o){ws(e,b);var i,a,s,l=0,p=0;if(ne(t)){if(!I(t))return _(t)?y(S,t):G(vS,S,t);i=t,p=hS(n,m);var f=t.byteLength;if(void 0===o){if(f%m)throw u("Wrong length");if((a=f-p)<0)throw u("Wrong length")}else if((a=Pt(o)*m)+p>f)throw u("Wrong length");s=a/m}else s=Vk(t),i=new c(a=s*m);for(r(e,{buffer:i,byteOffset:p,byteLength:a,length:s,view:new d(i)});l<s;)E(e,l++)})),cr&&cr(S,g),b=S.prototype=Hn(v)),b.constructor!==S&&rt(b,"constructor",S),rt(b,f,S),h&&rt(b,h,M),D[M]=S,on({global:!0,forced:S!=T,sham:!p},D),"BYTES_PER_ELEMENT"in S||rt(S,"BYTES_PER_ELEMENT",m),"BYTES_PER_ELEMENT"in b||rt(b,"BYTES_PER_ELEMENT",m),Ls(M)}):e.exports=function(){}}))("Uint8",(function(e){return function(t,n,o){return e(this,t,n,o)}}));var mS=Math.min,_S=j([].copyWithin||function(e,t){var n=De(this),o=Gt(n),r=Ot(e,o),i=Ot(t,o),a=arguments.length>2?arguments[2]:void 0,s=mS((void 0===a?o:Ot(a,o))-i,o-r),u=1;for(i<r&&r<i+s&&(u=-1,i+=s-1,r+=s-1);s-- >0;)i in n?n[r]=n[i]:delete n[r],r+=u,i+=u;return n}),yS=iS.aTypedArray;(0,iS.exportTypedArrayMethod)("copyWithin",(function(e,t){return _S(yS(this),e,t,arguments.length>2?arguments[2]:void 0)}));var MS=so.every,IS=iS.aTypedArray;(0,iS.exportTypedArrayMethod)("every",(function(e){return MS(IS(this),e,arguments.length>1?arguments[1]:void 0)}));var CS=iS.aTypedArray;(0,iS.exportTypedArrayMethod)("fill",(function(e){var t=arguments.length;return G(Xk,CS(this),e,t>1?arguments[1]:void 0,t>2?arguments[2]:void 0)}));var kS=iS.TYPED_ARRAY_CONSTRUCTOR,TS=iS.aTypedArrayConstructor,SS=function(e){return TS(qs(e,e[kS]))},bS=function(e,t){return function(e,t){for(var n=0,o=Gt(t),r=new e(o);o>n;)r[n]=t[n++];return r}(SS(e),t)},DS=so.filter,ES=iS.aTypedArray;(0,iS.exportTypedArrayMethod)("filter",(function(e){var t=DS(ES(this),e,arguments.length>1?arguments[1]:void 0);return bS(this,t)}));var AS=so.find,LS=iS.aTypedArray;(0,iS.exportTypedArrayMethod)("find",(function(e){return AS(LS(this),e,arguments.length>1?arguments[1]:void 0)}));var RS=so.findIndex,wS=iS.aTypedArray;(0,iS.exportTypedArrayMethod)("findIndex",(function(e){return RS(wS(this),e,arguments.length>1?arguments[1]:void 0)}));var OS=so.forEach,NS=iS.aTypedArray;(0,iS.exportTypedArrayMethod)("forEach",(function(e){OS(NS(this),e,arguments.length>1?arguments[1]:void 0)}));var PS=xt.includes,GS=iS.aTypedArray;(0,iS.exportTypedArrayMethod)("includes",(function(e){return PS(GS(this),e,arguments.length>1?arguments[1]:void 0)}));var US=xt.indexOf,xS=iS.aTypedArray;(0,iS.exportTypedArrayMethod)("indexOf",(function(e){return US(xS(this),e,arguments.length>1?arguments[1]:void 0)}));var FS=xe("iterator"),qS=R.Uint8Array,BS=j(Va.values),VS=j(Va.keys),HS=j(Va.entries),KS=iS.aTypedArray,jS=iS.exportTypedArrayMethod,zS=qS&&qS.prototype,ZS=!w((function(){zS[FS].call([1])})),WS=!!zS&&zS.values&&zS[FS]===zS.values&&"values"===zS.values.name,YS=function(){return BS(KS(this))};jS("entries",(function(){return HS(KS(this))}),ZS),jS("keys",(function(){return VS(KS(this))}),ZS),jS("values",YS,ZS||!WS,{name:"values"}),jS(FS,YS,ZS||!WS,{name:"values"});var JS=iS.aTypedArray,XS=iS.exportTypedArrayMethod,$S=j([].join);XS("join",(function(e){return $S(JS(this),e)}));var QS=iS.aTypedArray;(0,iS.exportTypedArrayMethod)("lastIndexOf",(function(e){var t=arguments.length;return Ca(DI,QS(this),t>1?[e,arguments[1]]:[e])}));var eb=so.map,tb=iS.aTypedArray;(0,iS.exportTypedArrayMethod)("map",(function(e){return eb(tb(this),e,arguments.length>1?arguments[1]:void 0,(function(e,t){return new(SS(e))(t)}))}));var nb=R.TypeError,ob=function(e){return function(t,n,o,r){ye(n);var i=De(t),a=X(i),s=Gt(i),u=e?s-1:0,c=e?-1:1;if(o<2)for(;;){if(u in a){r=a[u],u+=c;break}if(u+=c,e?u<0:s<=u)throw nb("Reduce of empty array with no initial value")}for(;e?u>=0:s>u;u+=c)u in a&&(r=n(r,a[u],u,i));return r}},rb={left:ob(!1),right:ob(!0)},ib=rb.left,ab=iS.aTypedArray;(0,iS.exportTypedArrayMethod)("reduce",(function(e){var t=arguments.length;return ib(ab(this),e,t,t>1?arguments[1]:void 0)}));var sb=rb.right,ub=iS.aTypedArray;(0,iS.exportTypedArrayMethod)("reduceRight",(function(e){var t=arguments.length;return sb(ub(this),e,t,t>1?arguments[1]:void 0)}));var cb=iS.aTypedArray,lb=iS.exportTypedArrayMethod,db=Math.floor;lb("reverse",(function(){for(var e,t=cb(this).length,n=db(t/2),o=0;o<n;)e=this[o],this[o++]=this[--t],this[t]=e;return this}));var pb=R.RangeError,fb=R.Int8Array,hb=fb&&fb.prototype,gb=hb&&hb.set,vb=iS.aTypedArray,mb=iS.exportTypedArrayMethod,_b=!w((function(){var e=new Uint8ClampedArray(2);return G(gb,e,{length:1,0:3},1),3!==e[1]})),yb=_b&&iS.NATIVE_ARRAY_BUFFER_VIEWS&&w((function(){var e=new fb(2);return e.set(1),e.set("2",1),0!==e[0]||2!==e[1]}));mb("set",(function(e){vb(this);var t=hS(arguments.length>1?arguments[1]:void 0,1),n=De(e);if(_b)return G(gb,this,n,t);var o=this.length,r=Gt(n),i=0;if(r+t>o)throw pb("Wrong length");for(;i<r;)this[t+i]=n[i++]}),!_b||yb);var Mb=iS.aTypedArray;(0,iS.exportTypedArrayMethod)("slice",(function(e,t){for(var n=Dn(Mb(this),e,t),o=SS(this),r=0,i=n.length,a=new o(i);i>r;)a[r]=n[r++];return a}),w((function(){new Int8Array(1).slice()})));var Ib=so.some,Cb=iS.aTypedArray;(0,iS.exportTypedArrayMethod)("some",(function(e){return Ib(Cb(this),e,arguments.length>1?arguments[1]:void 0)}));var kb=R.Array,Tb=iS.aTypedArray,Sb=iS.exportTypedArrayMethod,bb=R.Uint16Array,Db=bb&&j(bb.prototype.sort),Eb=!(!Db||w((function(){Db(new bb(2),null)}))&&w((function(){Db(new bb(2),{})}))),Ab=!!Db&&!w((function(){if(de)return de<74;if(KI)return KI<67;if(jI)return!0;if(ZI)return ZI<602;var e,t,n=new bb(516),o=kb(516);for(e=0;e<516;e++)t=e%4,n[e]=515-e,o[e]=e-2*t+3;for(Db(n,(function(e,t){return(e/4|0)-(t/4|0)})),e=0;e<516;e++)if(n[e]!==o[e])return!0}));Sb("sort",(function(e){return void 0!==e&&ye(e),Ab?Db(this,e):dy(Tb(this),function(e){return function(t,n){return void 0!==e?+e(t,n)||0:n!=n?-1:t!=t?1:0===t&&0===n?1/t>0&&1/n<0?1:-1:t>n}}(e))}),!Ab||Eb);var Lb=iS.aTypedArray;(0,iS.exportTypedArrayMethod)("subarray",(function(e,t){var n=Lb(this),o=n.length,r=Ot(e,o);return new(SS(n))(n.buffer,n.byteOffset+r*n.BYTES_PER_ELEMENT,Pt((void 0===t?o:Ot(t,o))-r))}));var Rb=R.Int8Array,wb=iS.aTypedArray,Ob=iS.exportTypedArrayMethod,Nb=[].toLocaleString,Pb=!!Rb&&w((function(){Nb.call(new Rb(1))}));Ob("toLocaleString",(function(){return Ca(Nb,Pb?Dn(wb(this)):wb(this),Dn(arguments))}),w((function(){return[1,2].toLocaleString()!=new Rb([1,2]).toLocaleString()}))||!w((function(){Rb.prototype.toLocaleString.call([1,2])})));var Gb=iS.exportTypedArrayMethod,Ub=R.Uint8Array,xb=Ub&&Ub.prototype||{},Fb=[].toString,qb=j([].join);w((function(){Fb.call({})}))&&(Fb=function(){return qb(this)});var Bb=xb.toString!=Fb;Gb("toString",Fb,Bb);var Vb=R.RangeError,Hb=String.fromCharCode,Kb=String.fromCodePoint,jb=j([].join),zb=!!Kb&&1!=Kb.length;on({target:"String",stat:!0,forced:zb},{fromCodePoint:function(e){for(var t,n=[],o=arguments.length,r=0;o>r;){if(t=+arguments[r++],Ot(t,1114111)!==t)throw Vb(t+" is not a valid code point");n[r]=t<65536?Hb(t):Hb(55296+((t-=65536)>>10),t%1024+56320)}return jb(n,"")}});var Zb=String.fromCharCode,Wb=function(e){var t=0|e.charCodeAt(0);if(55296<=t)if(t<56320){var n=0|e.charCodeAt(1);if(56320<=n&&n<=57343){if((t=(t<<10)+n-56613888|0)>65535)return Zb(240|t>>>18,128|t>>>12&63,128|t>>>6&63,128|63&t)}else t=65533}else t<=57343&&(t=65533);return t<=2047?Zb(192|t>>>6,128|63&t):Zb(224|t>>>12,128|t>>>6&63,128|63&t)},Yb=function(e){for(var t=void 0===e?"":(""+e).replace(/[\x80-\uD7ff\uDC00-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]?/g,Wb),n=0|t.length,o=new Uint8Array(n),r=0;r<n;r=r+1|0)o[r]=0|t.charCodeAt(r);return o},Jb=function(e){for(var t=new Uint8Array(e),n="",o=0,r=t.length;o<r;){var i=t[o],a=0,s=0;if(i<=127?(a=0,s=255&i):i<=223?(a=1,s=31&i):i<=239?(a=2,s=15&i):i<=244&&(a=3,s=7&i),r-o-a>0)for(var u=0;u<a;)s=s<<6|63&(i=t[o+u+1]),u+=1;else s=65533,a=r-o;n+=String.fromCodePoint(s),o+=a+1}return n},Xb=function(){function e(t){r(this,e),this._handler=t;var n=t.getURL();if(this._socket=null,this._workerSocket=null,this._id=vd(),this._handler.getIsWorkerEnabled()){var o=URL.createObjectURL(new Blob([';let _socket = null;onmessage = function(event) {  if (event.data.cmd === "start") {    const url = event.data.url;    _socket = new WebSocket(url);    _socket.binaryType = "arraybuffer";    _socket.onopen = function() {      postMessage({ callback: "onOpen" });    };    _socket.onclose = function(e) {      postMessage({ callback: "onOpen", e: { code: e.code, reason: e.reason } });    };    _socket.onmessage = function(e) {      postMessage({ callback: "onMessage", data: e.data });    };    _socket.onerror = function(e) {      postMessage({ callback: "onError", e: { isTrusted: "true" } });    };  } else if (event.data.cmd === "sendMessage") {    if (_socket !== null) {      _socket.send(event.data.data);    }  } else if (event.data.cmd === "stop") {    if (_socket !== null) {      _socket.close(event.data.code);      _socket = null;    }  }};'],{type:"application/javascript; charset=utf-8"}));this._workerSocket=new Worker(o);var i=this;this._workerSocket.onmessage=function(e){var t=e.data,n=t.callback,o=t.e;"onOpen"===n?i._onOpen():"onClose"===n?i._onClose(o):"onError"===n?i._onError(o):"onMessage"===n&&i._onMessage(e.data)},this._workerSocket.postMessage({cmd:"start",id:this._id,url:n})}else nl?Qc?(rl.connectSocket({url:n,header:{"content-type":"application/json"}}),rl.onSocketClose(this._onClose.bind(this)),rl.onSocketOpen(this._onOpen.bind(this)),rl.onSocketMessage(this._onMessage.bind(this)),rl.onSocketError(this._onError.bind(this))):(this._socket=rl.connectSocket({url:n,header:{"content-type":"application/json"},complete:function(){}}),this._socket.onClose(this._onClose.bind(this)),this._socket.onOpen(this._onOpen.bind(this)),this._socket.onMessage(this._onMessage.bind(this)),this._socket.onError(this._onError.bind(this))):ol&&(this._socket=new WebSocket(n),this._socket.binaryType="arraybuffer",this._socket.onopen=this._onOpen.bind(this),this._socket.onmessage=this._onMessage.bind(this),this._socket.onclose=this._onClose.bind(this),this._socket.onerror=this._onError.bind(this));this._canIUseBinaryFrame=t.canIUseBinaryFrame()}return a(e,[{key:"getID",value:function(){return this._id}},{key:"_onOpen",value:function(){this._handler.onOpen({id:this._id})}},{key:"_onClose",value:function(e){this._handler.onClose({id:this._id,e:e})}},{key:"_onMessage",value:function(e){this._handler.onMessage({data:this._canIUseBinaryFrame?Jb(e.data):e.data})}},{key:"_onError",value:function(e){this._handler.onError({id:this._id,e:e})}},{key:"setIsWorkerEnabled",value:function(e){this._isWorkerEnabled=!0}},{key:"close",value:function(e){if(this._workerSocket&&(this._workerSocket.postMessage({cmd:"stop",code:e}),this._workerSocket.terminate(),this._workerSocket=null),Qc)return rl.offSocketClose(),rl.offSocketMessage(),rl.offSocketOpen(),rl.offSocketError(),void rl.closeSocket();this._socket&&(nl?(this._socket.onClose((function(){})),this._socket.onOpen((function(){})),this._socket.onMessage((function(){})),this._socket.onError((function(){}))):ol&&(this._socket.onopen=null,this._socket.onmessage=null,this._socket.onclose=null,this._socket.onerror=null),$c?this._socket.close({code:e}):this._socket.close(e),this._socket=null)}},{key:"send",value:function(e){if(this._workerSocket)this._workerSocket.postMessage({cmd:"sendMessage",data:this._canIUseBinaryFrame?Yb(e.data).buffer:e.data});else{if(Qc)return void rl.sendSocketMessage({data:e.data,fail:function(){e.fail&&e.requestID&&e.fail(e.requestID)}});this._socket&&(nl?this._socket.send({data:this._canIUseBinaryFrame?Yb(e.data).buffer:e.data,fail:function(){e.fail&&e.requestID&&e.fail(e.requestID)}}):ol&&this._socket.send(this._canIUseBinaryFrame?Yb(e.data).buffer:e.data))}}}]),e}(),$b=4e3,Qb=4001,eD=["keyMap"],tD=["keyMap"],nD="connected",oD="connecting",rD="disconnected",iD=function(){function e(t){r(this,e),this._channelModule=t,this._n="SocketHandler",this._promiseMap=new Map,this._readyState=rD,this._simpleRequestMap=new Map,this.MAX_SIZE=100,this._startSequence=vd(),this._startTs=0,this._reConnectFlag=!1,this._nextPingTs=0,this._reConnectCount=0,this.MAX_RECONNECT_COUNT=3,this._socketID=-1,this._random=0,this._socket=null,this._url="",this._onOpenTs=0,this._canIUseBinaryFrame=!0,this._isWorkerEnabled=!0,this._setWebsocketHost(),this._initConnection()}return a(e,[{key:"_setWebsocketHost",value:function(){var e=this._channelModule.getModule(Yf),t=Ec;this._channelModule.isOversea()&&(t=Ac),e.isSingaporeSite()?t=Lc:e.isKoreaSite()?t=Rc:e.isGermanySite()?t=wc:e.isIndiaSite()?t=Oc:e.isJapanSite()?t=Nc:e.isUSASite()&&(t=Pc),Gc.HOST.setCurrent(t)}},{key:"_initConnection",value:function(){id(Gc.HOST.CURRENT.BACKUP)||""===this._url?this._url=Gc.HOST.CURRENT.DEFAULT:this._url===Gc.HOST.CURRENT.DEFAULT?this._url=Gc.HOST.CURRENT.BACKUP:this._url===Gc.HOST.CURRENT.BACKUP&&(this._url=Gc.HOST.CURRENT.DEFAULT);var e=this._channelModule.getModule(Yf).getProxyServer();Yd(e)||(this._url=e),this._connect(),this._nextPingTs=0}},{key:"onCheckTimer",value:function(e){e%1==0&&this._checkPromiseMap()}},{key:"_checkPromiseMap",value:function(){var e=this;0!==this._promiseMap.size&&this._promiseMap.forEach((function(t,n){var o=t.reject,r=t.timestamp,i=15e3;-1!==n.indexOf(mh)&&(i=9e4),Date.now()-r>=i&&(Gl.l("".concat(e._n,"._checkPromiseMap request timeout, delete requestID:").concat(n)),e._promiseMap.delete(n),o(new UI({code:Jm})),e._channelModule.onRequestTimeout(n))}))}},{key:"onOpen",value:function(e){if(""!==this._readyState){this._onOpenTs=Date.now();var t=e.id;this._socketID=t;var n=Date.now()-this._startTs;Gl.l("".concat(this._n,"._onOpen cost ").concat(n," ms. socketID:").concat(t)),new w_("wsOnOpen").setMessage(n).setCostTime(n).setMoreMessage("socketID:".concat(t)).end(),e.id===this._socketID&&(this._readyState=nD,this._reConnectCount=0,this._resend(),!0===this._reConnectFlag&&(this._channelModule.onReconnected(),this._reConnectFlag=!1),this._channelModule.onOpen())}}},{key:"onClose",value:function(e){var t=new w_("wsOnClose"),n=e.id,o=e.e,r="sourceSocketID:".concat(n," currentSocketID:").concat(this._socketID," code:").concat(o.code," reason:").concat(o.reason),i=0;0!==this._onOpenTs&&(i=Date.now()-this._onOpenTs),t.setMessage(i).setCostTime(i).setMoreMessage(r).setCode(o.code).end(),Gl.l("".concat(this._n,"._onClose ").concat(r," onlineTime:").concat(i)),n===this._socketID&&(this._readyState=rD,i<1e3?this._channelModule.onReconnectFailed():this._channelModule.onClose())}},{key:"onError",value:function(e){var t=e.id,n=e.e,o="sourceSocketID:".concat(t," currentSocketID:").concat(this._socketID);new w_("wsOnError").setMessage(n.errMsg||hd(n)).setMoreMessage(o).setLevel("error").end(),Gl.w("".concat(this._n,"._onError"),n,o),t===this._socketID&&(this._readyState="",this._channelModule.onError())}},{key:"onMessage",value:function(e){var t;try{t=JSON.parse(e.data)}catch(XD){new w_("jsonParseError").setMessage(e.data).end()}if(t&&t.head){var n=this._getRequestIDFromHead(t.head),o=t.body;if(!n.startsWith(Gc.NAME.TUIROOM_SVR)){var r=xd(t.head);o=Fk(t.body,this._getResponseKeyMap(r))}if(Gl.d("".concat(this._n,".onMessage ret:").concat(JSON.stringify(o)," requestID:").concat(n," has:").concat(this._promiseMap.has(n))),this._setNextPingTs(),this._promiseMap.has(n)){var i=this._promiseMap.get(n),a=i.resolve,s=i.reject,u=i.timestamp;return this._promiseMap.delete(n),this._calcRTT(u),void(o.errorCode&&0!==o.errorCode?(this._channelModule.onErrorCodeNotZero(o),s(new UI({code:o.errorCode,message:o.errorInfo||"",data:n.includes(Xh)||n.includes(qg)?{elements:o.elements,messageVersion:o.messageVersion,cloudCustomData:o.cloudCustomData}:void 0}))):a(GI(o)))}this._channelModule.onMessage({head:t.head,body:o})}}},{key:"_calcRTT",value:function(e){var t=Date.now()-e;this._channelModule.getModule(ch).addRTT(t)}},{key:"_connect",value:function(){this._startTs=Date.now(),this._onOpenTs=0,this._socket=new Xb(this),this._socketID=this._socket.getID(),this._readyState=oD,Gl.l("".concat(this._n,"._connect isWorkerEnabled:").concat(this.getIsWorkerEnabled()," socketID:").concat(this._socketID," url:").concat(this.getURL())),new w_("wsConnect").setMessage("socketID:".concat(this._socketID," url:").concat(this.getURL())).end()}},{key:"getURL",value:function(){this._channelModule.isDevMode()&&(this._canIUseBinaryFrame=!1);var e=Nd();(Qc||Yc&&"windows"===e||el)&&(this._canIUseBinaryFrame=!1);var t=-1;"ios"===e?t=pl||-1:"android"===e&&(t=hl||-1);var n=this._channelModule.getModule(Yf),o=this._channelModule.getPlatform(),r=n.getSDKAppID(),i=n.getInstanceID(),a="sdkappid=".concat(r,"&instanceid=").concat(i,"&random=").concat(this._getRandom(),"&platform=").concat(o,"&host=").concat(e,"&version=").concat(t);return this._canIUseBinaryFrame?"".concat(this._url,"/binfo?").concat(a):"".concat(this._url,"/info?").concat(a)}},{key:"_closeConnection",value:function(e){Gl.l("".concat(this._n,"._closeConnection socketID:").concat(this._socketID)),this._socket&&(this._socket.close(e),this._socketID=-1,this._socket=null,this._readyState=rD)}},{key:"_resend",value:function(){var e=this;if(Gl.l("".concat(this._n,"._resend reConnectFlag:").concat(this._reConnectFlag),"promiseMap.size:".concat(this._promiseMap.size," simpleRequestMap.size:").concat(this._simpleRequestMap.size)),this._promiseMap.size>0&&this._promiseMap.forEach((function(t,n){var o=t.uplinkData,r=t.resolve,i=t.reject;e._promiseMap.set(n,{resolve:r,reject:i,timestamp:Date.now(),uplinkData:o}),e._execute(n,o)})),this._simpleRequestMap.size>0){var t,n=S(this._simpleRequestMap);try{for(n.s();!(t=n.n()).done;){var o=_(t.value,2),r=o[0],i=o[1];this._execute(r,i)}}catch(s){n.e(s)}finally{n.f()}this._simpleRequestMap.clear()}}},{key:"send",value:function(e){var t=this;e.head.seq=this._getSequence(),e.head.reqtime=Math.floor(Date.now()/1e3),e.keyMap;var n=h(e,eD),o=this._getRequestIDFromHead(e.head),r=JSON.stringify(n);return new Promise((function(e,i){t._promiseMap.set(o,{resolve:e,reject:i,timestamp:Date.now(),uplinkData:r}),Gl.d("".concat(t._n,".send uplinkData:").concat(JSON.stringify(n)," requestID:").concat(o," readyState:").concat(t._readyState)),t._readyState!==nD?t._reConnect():(t._execute(o,r),t._channelModule.getModule(ch).addRequestCount())}))}},{key:"simplySend",value:function(e){e.head.seq=this._getSequence(),e.head.reqtime=Math.floor(Date.now()/1e3),e.keyMap;var t=h(e,tD),n=this._getRequestIDFromHead(e.head),o=JSON.stringify(t);this._readyState!==nD?(this._simpleRequestMap.size<this.MAX_SIZE?this._simpleRequestMap.set(n,o):Gl.l("".concat(this._n,".simplySend. simpleRequestMap is full, drop request!")),this._reConnect()):this._execute(n,o)}},{key:"_execute",value:function(e,t){this._socket.send({data:t,fail:nl?this._onSendFail.bind(this):void 0,requestID:e})}},{key:"_onSendFail",value:function(e){Gl.l("".concat(this._n,"._onSendFail requestID:").concat(e))}},{key:"_getSequence",value:function(){var e;if(this._startSequence<2415919103)return e=this._startSequence,this._startSequence+=1,2415919103===this._startSequence&&(this._startSequence=vd()),e}},{key:"_getRequestIDFromHead",value:function(e){return e.servcmd+e.seq}},{key:"_getResponseKeyMap",value:function(e){var n=this._channelModule.getKeyMap(e);return t(t({},Ok.response),n.response)}},{key:"_reConnect",value:function(){this._readyState!==nD&&this._readyState!==oD&&this.forcedReconnect()}},{key:"forcedReconnect",value:function(){var e=this,t="".concat(this._n,".forcedReconnect");Gl.l("".concat(t," count:").concat(this._reConnectCount," readyState:").concat(this._readyState)),this._reConnectFlag=!0,this._resetRandom(),this._reConnectCount<this.MAX_RECONNECT_COUNT?(this._reConnectCount+=1,this._closeConnection(Qb),this._initConnection()):(this._reConnectCount=0,this._channelModule.probeNetwork().then((function(n){var o=_(n,2),r=o[0];o[1],r?(Gl.w("".concat(t," disconnected from wsserver but network is ok, continue...")),e._closeConnection(Qb),e._initConnection()):e._channelModule.onReconnectFailed()})))}},{key:"getReconnectFlag",value:function(){return this._reConnectFlag}},{key:"_setNextPingTs",value:function(){this._nextPingTs=Date.now()+1e4}},{key:"getNextPingTs",value:function(){return this._nextPingTs}},{key:"isConnected",value:function(){return this._readyState===nD}},{key:"canIUseBinaryFrame",value:function(){return this._canIUseBinaryFrame}},{key:"setIsWorkerEnabled",value:function(e){Gl.l("".concat(this._n,".setIsWorkerEnabled flag:").concat(e)),this._isWorkerEnabled=e}},{key:"getIsWorkerEnabled",value:function(){return this._isWorkerEnabled&&Il}},{key:"_getRandom",value:function(){return 0===this._random&&(this._random=Math.random()),this._random}},{key:"_resetRandom",value:function(){this._random=0}},{key:"close",value:function(){Gl.l("".concat(this._n,".close")),this._closeConnection($b),this._promiseMap.clear(),this._startSequence=vd(),this._readyState=rD,this._simpleRequestMap.clear(),this._reConnectFlag=!1,this._reConnectCount=0,this._onOpenTs=0,this._url="",this._random=0,this._canIUseBinaryFrame=!0,this._isWorkerEnabled=!0}}]),e}(),aD=function(e){u(n,e);var t=m(n);function n(e){var o;if(r(this,n),(o=t.call(this,e))._n="ChannelModule",o._socketHandler=new iD(g(o)),o._probing=!1,o._isAppShowing=!0,o._previousState=Ir.NET_STATE_CONNECTED,nl&&"function"==typeof rl.onAppShow&&"function"==typeof rl.onAppHide){var i=o._onAppHide.bind(g(o)),a=o._onAppShow.bind(g(o));"function"==typeof rl.offAppHide&&rl.offAppHide(i),"function"==typeof rl.offAppShow&&rl.offAppShow(a),rl.onAppHide(i),rl.onAppShow(a)}return o._timerForNotLoggedIn=-1,o._timerForNotLoggedIn=setInterval(o.onCheckTimer.bind(g(o)),1e3),o._fatalErrorFlag=!1,o}return a(n,[{key:"onCheckTimer",value:function(e){this._socketHandler&&(this.isLoggedIn()?(this._timerForNotLoggedIn>0&&(clearInterval(this._timerForNotLoggedIn),this._timerForNotLoggedIn=-1),this._socketHandler.onCheckTimer(e)):this._socketHandler.onCheckTimer(1),this._checkNextPing())}},{key:"onErrorCodeNotZero",value:function(e){this.getModule(oh).onErrorCodeNotZero(e)}},{key:"onMessage",value:function(e){this.getModule(oh).onMessage(e)}},{key:"send",value:function(e){return this._socketHandler?this._previousState!==Ir.NET_STATE_CONNECTED&&e.head.servcmd.includes(uv)?(this.reConnect(),this._sendLogViaHTTP(e)):this._socketHandler.send(e):Promise.reject()}},{key:"_sendLogViaHTTP",value:function(e){var t=Gc.HOST.CURRENT.STAT;return new Promise((function(n,o){var r="".concat(t,"/v4/imopenstat/tim_web_report_v2?sdkappid=").concat(e.head.sdkappid,"&reqtime=").concat(Date.now()),i=JSON.stringify(e.body),a="application/x-www-form-urlencoded;charset=UTF-8";if(nl)rl.request({url:r,data:i,method:"POST",timeout:3e3,header:{"content-type":a},success:function(){n()},fail:function(){o(new UI({code:Ym}))}});else{var s=new XMLHttpRequest,u=setTimeout((function(){s.abort(),o(new UI({code:Jm}))}),3e3);s.onreadystatechange=function(){4===s.readyState&&(clearTimeout(u),200===s.status||304===s.status?n():o(new UI({code:Ym})))},s.open("POST",r,!0),s.setRequestHeader("Content-type",a),s.send(i)}}))}},{key:"simplySend",value:function(e){return this._socketHandler?this._socketHandler.simplySend(e):Promise.reject()}},{key:"onOpen",value:function(){this._ping()}},{key:"onClose",value:function(){this._socketHandler&&this._socketHandler.getReconnectFlag()&&this._emitNetStateChangeEvent(Ir.NET_STATE_DISCONNECTED),this.reConnect()}},{key:"onError",value:function(){nl&&!el&&this.outputWarning("DomainNameInMP"),this._emitNetStateChangeEvent(Ir.NET_STATE_DISCONNECTED)}},{key:"getKeyMap",value:function(e){return this.getModule(oh).getKeyMap(e)}},{key:"_onAppHide",value:function(){this._isAppShowing=!1}},{key:"_onAppShow",value:function(){this._isAppShowing=!0}},{key:"onRequestTimeout",value:function(e){}},{key:"onReconnected",value:function(){Gl.l("".concat(this._n,".onReconnected")),this._m.restartTimer(),this.getModule(oh).onReconnected(),this._emitNetStateChangeEvent(Ir.NET_STATE_CONNECTED)}},{key:"onReconnectFailed",value:function(){Gl.l("".concat(this._n,".onReconnectFailed")),this._emitNetStateChangeEvent(Ir.NET_STATE_DISCONNECTED)}},{key:"setIsWorkerEnabled",value:function(e){this._socketHandler&&this._socketHandler.setIsWorkerEnabled(!1)}},{key:"offline",value:function(){this._emitNetStateChangeEvent(Ir.NET_STATE_DISCONNECTED)}},{key:"reConnect",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=!1;this._socketHandler&&(t=this._socketHandler.getReconnectFlag());var n="forcedFlag:".concat(e," fatalErrorFlag:").concat(this._fatalErrorFlag," previousState:").concat(this._previousState," reconnectFlag:").concat(t);if(Gl.l("".concat(this._n,".reConnect ").concat(n)),!this._fatalErrorFlag&&this._socketHandler){if(!0===e)this._socketHandler.forcedReconnect();else{if(this._previousState===Ir.NET_STATE_CONNECTING&&t)return;this._socketHandler.forcedReconnect()}this._emitNetStateChangeEvent(Ir.NET_STATE_CONNECTING)}}},{key:"_emitNetStateChangeEvent",value:function(e){this._previousState!==e&&(Gl.l("".concat(this._n,"._emitNetStateChangeEvent from ").concat(this._previousState," to ").concat(e)),this._previousState=e,this.emitOuterEvent(Mr.NET_STATE_CHANGE,{state:e}))}},{key:"_ping",value:function(){var e=this;if(!0!==this._probing){this._probing=!0;var t=this.getModule(oh).getProtocolData({protocolName:cv});this.send(t).then((function(){e._probing=!1})).catch((function(t){if(Gl.w("".concat(e._n,"._ping failed. error:"),t),e._probing=!1,t&&60002===t.code)return new w_("error").setMessage("code:".concat(t.code," message:").concat(t.message)).setNetworkType(e.getModule($f).getNetworkType()).end(),e._fatalErrorFlag=!0,void e._emitNetStateChangeEvent(Ir.NET_STATE_DISCONNECTED);e.probeNetwork().then((function(t){var n=_(t,2),o=n[0],r=n[1];Gl.l("".concat(e._n,"._ping failed. probe network, isAppShowing:").concat(e._isAppShowing," online:").concat(o," networkType:").concat(r)),o?e.reConnect():e._emitNetStateChangeEvent(Ir.NET_STATE_DISCONNECTED)}))}))}}},{key:"_checkNextPing",value:function(){this._socketHandler&&this._socketHandler.isConnected()&&Date.now()>=this._socketHandler.getNextPingTs()&&this._ping()}},{key:"dealloc",value:function(){this._socketHandler&&(this._socketHandler.close(),this._socketHandler=null),this._timerForNotLoggedIn>-1&&clearInterval(this._timerForNotLoggedIn)}},{key:"onRestApiKickedOut",value:function(){this._socketHandler&&(this._socketHandler.close(),this.reConnect(!0))}},{key:"reset",value:function(){Gl.l("".concat(this._n,".reset")),this._previousState=Ir.NET_STATE_CONNECTED,this._probing=!1,this._fatalErrorFlag=!1,this._timerForNotLoggedIn=setInterval(this.onCheckTimer.bind(this),1e3)}}]),n}(vh),sD=["a2","tinyid"],uD=["a2","tinyid"],cD=function(){function e(t){r(this,e),this._n="ProtocolHandler",this._sessionModule=t,this._configMap=new Map,this._fillConfigMap()}return a(e,[{key:"_fillConfigMap",value:function(){this._configMap.clear();var e=this._sessionModule.genCommonHead(),n=this._sessionModule.genCosSpecifiedHead(),o=this._sessionModule.genSSOReportHead(),r=this._sessionModule.isIntl();this._configMap.set(mh,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.IM_OPEN_STATUS,".").concat(Gc.CMD.LOGIN)}),body:{state:"Online",isWebUniapp:0,deviceBrand:0},keyMap:{request:{deviceBrand:"InstType"},response:{InstId:"instanceID",HelloInterval:"helloInterval"}}}}(e)),this._configMap.set(_h,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.IM_OPEN_STATUS,".").concat(Gc.CMD.LOGOUT)}),body:{type:0},keyMap:{request:{type:"wslogout_type"}}}}(e)),this._configMap.set(yh,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.IM_OPEN_STATUS,".").concat(Gc.CMD.HELLO)}),body:{isWebUniapp:0},keyMap:{response:{NewInstInfo:"newInstanceInfo"}}}}(e)),this._configMap.set(Mh,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.STAT_SERVICE,".").concat(Gc.CMD.KICK_OTHER)}),body:{}}}(e)),this._configMap.set(iv,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.IM_COS_SIGN,".").concat(Gc.CMD.COS_SIGN)}),body:{cmd:"open_im_cos_svc",subCmd:"get_cos_token",duration:300,version:2},keyMap:{request:{userSig:"usersig",subCmd:"sub_cmd",cmd:"cmd",duration:"duration",version:"version"},response:{expired_time:"expiredTime",bucket_name:"bucketName",session_token:"sessionToken",tmp_secret_id:"secretId",tmp_secret_key:"secretKey"}}}}(n)),this._configMap.set(av,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.CUSTOM_UPLOAD,".").concat(Gc.CMD.COS_PRE_SIG)}),body:{fileType:void 0,fileName:void 0,uploadMethod:0,duration:900},keyMap:{request:{userSig:"usersig",fileType:"file_type",fileName:"file_name",uploadMethod:"upload_method"},response:{expired_time:"expiredTime",request_id:"requestId",head_url:"headUrl",upload_url:"uploadUrl",download_url:"downloadUrl",ci_url:"ciUrl",snapshot_url:"requestSnapshotUrl"}}}}(n)),this._configMap.set(sv,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.CUSTOM_UPLOAD,".").concat(Gc.CMD.VIDEO_COVER)}),body:{version:1,platform:void 0,coverName:void 0,requestSnapshotUrl:void 0},keyMap:{request:{version:"version",platform:"platform",coverName:"cover_name",requestSnapshotUrl:"snapshot_url"},response:{error_code:"errorCode",error_msg:"errorInfo",download_url:"snapshotUrl"}}}}(n)),this._configMap.set(_v,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.IM_CONFIG_MANAGER,".").concat(Gc.CMD.FETCH_COMMERCIAL_CONFIG)}),body:{SDKAppID:0},keyMap:{request:{SDKAppID:"uint32_sdkappid"},response:{int32_error_code:"errorCode",str_error_message:"errorMessage",str_purchase_bits:"purchaseBits",uint32_expired_time:"expiredTime"}}}}(e)),this._configMap.set(yv,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.IM_CONFIG_MANAGER,".").concat(Gc.CMD.PUSHED_COMMERCIAL_CONFIG)}),body:{},keyMap:{response:{int32_error_code:"errorCode",str_error_message:"errorMessage",str_purchase_bits:"purchaseBits",uint32_expired_time:"expiredTime"}}}}(e)),this._configMap.set(vv,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.IM_CONFIG_MANAGER,".").concat(Gc.CMD.FETCH_CLOUD_CONTROL_CONFIG)}),body:{SDKAppID:0,version:0},keyMap:{request:{SDKAppID:"uint32_sdkappid",version:"uint64_version"},response:{int32_error_code:"errorCode",str_error_message:"errorMessage",str_json_config:"cloudControlConfig",uint32_expired_time:"expiredTime",uint32_sdkappid:"SDKAppID",uint64_version:"version"}}}}(e)),this._configMap.set(mv,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.IM_CONFIG_MANAGER,".").concat(Gc.CMD.PUSHED_CLOUD_CONTROL_CONFIG)}),body:{},keyMap:{response:{int32_error_code:"errorCode",str_error_message:"errorMessage",str_json_config:"cloudControlConfig",uint32_expired_time:"expiredTime",uint32_sdkappid:"SDKAppID",uint64_version:"version"}}}}(e)),this._configMap.set(Mv,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.OVERLOAD_PUSH,".").concat(Gc.CMD.OVERLOAD_NOTIFY)}),body:{},keyMap:{response:{OverLoadServCmd:"overloadCommand",DelaySecs:"waitingTime"}}}}(e)),this._configMap.set(Ih,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.OPEN_IM,".").concat(Gc.CMD.GET_MESSAGES)}),body:{cookie:"",syncFlag:0,needAbstract:1,isOnlineSync:0,needSignaling:1},keyMap:{request:{fromAccount:"From_Account",toAccount:"To_Account",from:"From_Account",to:"To_Account",time:"MsgTimeStamp",sequence:"MsgSeq",random:"MsgRandom",elements:"MsgBody"},response:{MsgList:"messageList",SyncFlag:"syncFlag",To_Account:"to",From_Account:"from",ClientSeq:"clientSequence",MsgSeq:"sequence",NoticeSeq:"noticeSequence",NotifySeq:"notifySequence",MsgRandom:"random",MsgTimeStamp:"time",MsgContent:"content",ToGroupId:"to",MsgKey:"messageKey",GroupTips:"groupTips",MsgBody:"elements",MsgType:"type",C2CRemainingUnreadCount:"C2CRemainingUnreadList",C2CPairUnreadCount:"C2CPairUnreadList"}}}}(e)),r||(this._configMap.set(Ch,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.OPEN_IM,".").concat(Gc.CMD.BIG_DATA_HALLWAY_AUTH_KEY)}),body:{}}}(e)),this._configMap.set(wv,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.IM_MSG_AUDIT_MGR,".").concat(Gc.CMD.GET_RPOFANITY_LIST)}),body:{version:0,deviceID:"",startIndex:void 0},keyMap:{request:{version:"uint64_version",deviceID:"str_device_id",startIndex:"uint64_start_index"},response:{msg_cmd_error_code:"errorInfo",str_err_msg:"errorMessage",uint32_code:"errorCode",msg_scene_ctl_config:"filterConfig",uint64_c2c_custom_msg_flag:"c2c_custom_message",uint64_c2c_text_msg_flag:"c2c_text_message",uint64_group_custom_msg_flag:"group_custom_message",uint64_group_text_msg_flag:"group_text_message",uint64_group_info_flag:"group_profile",uint64_group_member_info_flag:"group_member_profile",uint64_relation_chain_flag:"sns",uint64_user_info_flag:"user_profile",rpt_msg_dirty_word:"lexicon",str_dirty_word:"profanity",str_replaced_content:"replacement",uint64_filter_type:"filterType",uint64_id:"id",uint64_word_type:"profanityType",uint64_complete_flag:"completeFlag",uint64_next_start_index:"nextStartIndex",uint64_version:"version",uint64_expired_time:"expiredTime"}}}}(e))),this._configMap.set(kh,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.OPEN_IM,".").concat(Gc.CMD.SEND_MESSAGE)}),body:{fromAccount:"",toAccount:"",msgSeq:0,msgRandom:0,msgBody:[],cloudCustomData:void 0,nick:"",avatar:"",msgLifeTime:void 0,offlinePushInfo:{pushFlag:0,title:"",desc:"",ext:"",apnsInfo:{badgeMode:0,isVoipPush:void 0},androidInfo:{OPPOChannelID:""}},messageControlInfo:void 0,clientTime:void 0,needReadReceipt:0,isSupportExtension:0},keyMap:{request:{fromAccount:"From_Account",toAccount:"To_Account",msgTimeStamp:"MsgTimeStamp",msgSeq:"MsgSeq",msgRandom:"MsgRandom",msgBody:"MsgBody",count:"MaxCnt",lastMessageTime:"LastMsgTime",messageKey:"MsgKey",peerAccount:"Peer_Account",data:"Data",description:"Desc",extension:"Ext",type:"MsgType",content:"MsgContent",sizeType:"Type",uuid:"UUID",url:"",imageUrl:"URL",fileUrl:"Url",remoteAudioUrl:"Url",remoteVideoUrl:"VideoUrl",thumbUUID:"ThumbUUID",videoUUID:"VideoUUID",videoUrl:"",downloadFlag:"Download_Flag",nick:"From_AccountNick",avatar:"From_AccountHeadurl",from:"From_Account",time:"MsgTimeStamp",messageRandom:"MsgRandom",messageSequence:"MsgSeq",elements:"MsgBody",clientSequence:"ClientSeq",payload:"MsgContent",messageList:"MsgList",messageNumber:"MsgNum",abstractList:"AbstractList",messageBody:"MsgBody",needReadReceipt:"IsNeedReadReceipt"}}}}(e)),this._configMap.set(Th,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.GROUP,".").concat(Gc.CMD.SEND_GROUP_MESSAGE)}),body:{fromAccount:"",groupID:"",random:0,clientSequence:0,priority:"",msgBody:[],cloudCustomData:void 0,onlineOnlyFlag:0,offlinePushInfo:{pushFlag:0,title:"",desc:"",ext:"",apnsInfo:{badgeMode:0,isVoipPush:void 0},androidInfo:{OPPOChannelID:""}},groupAtInfo:[],messageControlInfo:void 0,clientTime:void 0,needReadReceipt:0,topicID:void 0,receiverList:void 0,isSupportExtension:0},keyMap:{request:{to:"GroupId",extension:"Ext",data:"Data",description:"Desc",random:"Random",sequence:"ReqMsgSeq",count:"ReqMsgNumber",type:"MsgType",priority:"MsgPriority",content:"MsgContent",elements:"MsgBody",sizeType:"Type",uuid:"UUID",url:"",imageUrl:"URL",fileUrl:"Url",remoteAudioUrl:"Url",remoteVideoUrl:"VideoUrl",thumbUUID:"ThumbUUID",videoUUID:"VideoUUID",videoUrl:"",downloadFlag:"Download_Flag",clientSequence:"ClientSeq",from:"From_Account",time:"MsgTimeStamp",messageRandom:"MsgRandom",messageSequence:"MsgSeq",payload:"MsgContent",messageList:"MsgList",messageNumber:"MsgNum",abstractList:"AbstractList",messageBody:"MsgBody",needReadReceipt:"NeedReadReceipt",receiverList:"To_Account"},response:{MsgTime:"time",MsgSeq:"sequence"}}}}(e)),this._configMap.set(Kh,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.OPEN_IM,".").concat(Gc.CMD.REVOKE_C2C_MESSAGE)}),body:{msgInfo:{fromAccount:"",toAccount:"",msgTimeStamp:0,msgSeq:0,msgRandom:0}},keyMap:{request:{msgInfo:"MsgInfo",msgTimeStamp:"MsgTimeStamp",msgSeq:"MsgSeq",msgRandom:"MsgRandom"}}}}(e)),this._configMap.set(bg,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.GROUP,".").concat(Gc.CMD.REVOKE_GROUP_MESSAGE)}),body:{groupID:"",msgSeqList:void 0,topicID:""},keyMap:{request:{msgSeqList:"MsgSeqList",msgSeq:"MsgSeq"}}}}(e)),this._configMap.set(Wh,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.OPEN_IM,".").concat(Gc.CMD.GET_C2C_ROAM_MESSAGES)}),body:{peerAccount:"",count:15,lastMessageTime:0,messageKey:"",withRecalledMessage:1,direction:0},keyMap:{request:{messageKey:"MsgKey",peerAccount:"Peer_Account",count:"MaxCnt",lastMessageTime:"LastMsgTime",withRecalledMessage:"WithRecalledMsg",direction:"GetDirection"},response:{LastMsgTime:"lastMessageTime",IsNeedReadReceipt:"needReadReceipt",IsPeerRead:"readReceiptSentByPeer"}}}}(e)),this._configMap.set(Xh,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.OPEN_IM,".").concat(Gc.CMD.MODIFY_C2C_MESSAGE)}),body:{from:"",to:"",sequence:0,random:0,time:0,version:0,elements:void 0,cloudCustomData:void 0},keyMap:{request:{sequence:"MsgSeq",random:"MsgRandom",time:"MsgTime",version:"MsgVersion",type:"MsgType",content:"MsgContent"}}}}(e)),this._configMap.set(Ag,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.GROUP,".").concat(Gc.CMD.GET_GROUP_ROAM_MESSAGES)}),body:{withRecalledMsg:1,groupID:"",count:15,sequence:"",topicID:void 0},keyMap:{request:{sequence:"ReqMsgSeq",count:"ReqMsgNumber",withRecalledMessage:"WithRecalledMsg"},response:{Random:"random",MsgTime:"time",MsgSeq:"sequence",ReqMsgSeq:"sequence",RspMsgList:"messageList",IsPlaceMsg:"isPlaceMessage",IsSystemMsg:"isSystemMessage",ToGroupId:"to",EnumFrom_AccountType:"fromAccountType",EnumTo_AccountType:"toAccountType",GroupCode:"groupCode",MsgPriority:"priority",MsgBody:"elements",MsgType:"type",MsgContent:"content",IsFinished:"complete",Download_Flag:"downloadFlag",ClientSeq:"clientSequence",ThumbUUID:"thumbUUID",VideoUUID:"videoUUID",ToTopicId:"topicID",InvisibleMsgSeq:"invisibleSequenceList"}}}}(e)),this._configMap.set(jh,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.OPEN_IM,".").concat(Gc.CMD.SET_C2C_MESSAGE_READ)}),body:{C2CMsgReaded:void 0},keyMap:{request:{lastMessageTime:"LastedMsgTime"}}}}(e)),this._configMap.set(zh,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.OPEN_IM,".").concat(Gc.CMD.SET_C2C_PEER_MUTE_NOTIFICATIONS)}),body:{userIDList:void 0,muteFlag:0},keyMap:{request:{userIDList:"Peer_Account",muteFlag:"Mute_Notifications"}}}}(e)),this._configMap.set(Zh,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.OPEN_IM,".").concat(Gc.CMD.GET_C2C_PEER_MUTE_NOTIFICATIONS)}),body:{updateSequence:0},keyMap:{response:{MuteNotificationsList:"muteFlagList"}}}}(e)),this._configMap.set(Dg,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.GROUP,".").concat(Gc.CMD.SET_GROUP_MESSAGE_READ)}),body:{groupID:void 0,messageReadSeq:void 0,topicID:void 0},keyMap:{request:{messageReadSeq:"MsgReadedSeq"}}}}(e)),this._configMap.set(Eg,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.OPEN_IM,".").concat(Gc.CMD.SET_ALL_MESSAGE_READ)}),body:{readAllC2CMessage:0,groupMessageReadInfoList:[]},keyMap:{request:{readAllC2CMessage:"C2CReadAllMsg",groupMessageReadInfoList:"GroupReadInfo",messageSequence:"MsgSeq"},response:{C2CReadAllMsg:"readAllC2CMessage",GroupReadInfoArray:"groupMessageReadInfoList"}}}}(e)),this._configMap.set(Jh,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.OPEN_IM,".").concat(Gc.CMD.DELETE_C2C_MESSAGE)}),body:{fromAccount:"",to:"",keyList:void 0},keyMap:{request:{keyList:"MsgKeyList"}}}}(e)),this._configMap.set(Fg,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.GROUP,".").concat(Gc.CMD.DELETE_GROUP_MESSAGE)}),body:{groupID:"",deleter:"",keyList:void 0,topicID:void 0},keyMap:{request:{deleter:"Deleter_Account",keyList:"Seqs"}}}}(e)),this._configMap.set(Ov,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.IM_OPEN_TRANSLATE,".").concat(Gc.CMD.TRANSLATE_TEXT)}),body:{sourceTextList:void 0,SDKAppID:0,from:0,source:"",target:""},keyMap:{request:{sourceTextList:"SourceText",SDKAppID:"SdkAppId",from:"FromAccount"},response:{TargetText:"translatedTextList",RequestId:"requestID",CmdErrorCode:"error",ErrorCode:"code",ErrorInfo:"message"}}}}(e)),this._configMap.set(qg,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.OPEN_IM,".").concat(Gc.CMD.MODIFY_GROUP_MESSAGE)}),body:{groupID:"",topicID:void 0,sequence:0,version:0,elements:void 0,cloudCustomData:void 0},keyMap:{request:{sequence:"MsgSeq",version:"MsgVersion",type:"MsgType",content:"MsgContent"}}}}(e)),this._configMap.set(Lg,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.GROUP,".").concat(Gc.CMD.GET_READ_RECEIPT)}),body:{groupID:"",sequenceList:void 0},keyMap:{request:{sequence:"MsgSeq"}}}}(e)),this._configMap.set(wg,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.OPEN_IM,".").concat(Gc.CMD.SEND_C2C_READ_RECEIPT)}),body:{peerAccount:"",messageInfoList:void 0},keyMap:{request:{peerAccount:"Peer_Account",messageInfoList:"C2CMsgInfo",fromAccount:"From_Account",toAccount:"To_Account",sequence:"MsgSeq",random:"MsgRandom",time:"MsgTime",clientTime:"MsgClientTime"}}}}(e)),this._configMap.set(Rg,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.GROUP,".").concat(Gc.CMD.SEND_READ_RECEIPT)}),body:{groupID:"",sequenceList:void 0},keyMap:{request:{sequenceList:"MsgSeqList",sequence:"MsgSeq"}}}}(e)),this._configMap.set(Og,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.GROUP,".").concat(Gc.CMD.GET_READ_RECEIPT_DETAIL)}),body:{groupID:"",sequence:void 0,flag:0,cursor:0,count:0},keyMap:{request:{sequence:"MsgSeq",count:"Num"},response:{ReadList:"readUserIDList",Read_Account:"userID",UnreadList:"unreadUserIDList",Unread_Account:"userID",IsFinish:"isCompleted"}}}}(e)),this._configMap.set($h,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.OPEN_IM_MSG_EXT,".").concat(Gc.CMD.MODIFY_C2C_MESSAGE_EXTENSIONS)}),body:{from:void 0,to:void 0,messageKey:void 0,operateType:void 0,extensionList:void 0}}}(e)),this._configMap.set(Qh,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.OPEN_IM_MSG_EXT,".").concat(Gc.CMD.GET_C2C_MESSAGE_EXTENSIONS)}),body:{from:void 0,to:void 0,messageKey:void 0,startSequence:void 0}}}(e)),this._configMap.set(zg,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.OPEN_IM_MSG_EXT,".").concat(Gc.CMD.MODIFY_GROUP_MESSAGE_EXTENSIONS)}),body:{groupID:void 0,messageSequence:void 0,operateType:void 0,extensionList:void 0}}}(e)),this._configMap.set(Zg,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.OPEN_IM_MSG_EXT,".").concat(Gc.CMD.GET_GROUP_MESSAGE_EXTENSIONS)}),body:{groupID:void 0,messageSequence:void 0,startSequence:void 0}}}(e)),this._configMap.set(Yh,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.OPEN_IM,".").concat(Gc.CMD.GET_PEER_READ_TIME)}),body:{userIDList:void 0},keyMap:{request:{userIDList:"To_Account"},response:{ReadTime:"peerReadTimeList"}}}}(e)),this._configMap.set(tg,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.RECENT_CONTACT,".").concat(Gc.CMD.GET_CONVERSATION_LIST)}),body:{fromAccount:void 0,count:0},keyMap:{request:{},response:{SessionItem:"conversations",ToAccount:"groupID",To_Account:"userID",UnreadMsgCount:"unreadCount",MsgGroupReadedSeq:"messageReadSeq",C2cPeerReadTime:"c2cPeerReadTime"}}}}(e)),this._configMap.set(eg,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.RECENT_CONTACT,".").concat(Gc.CMD.PAGING_GET_CONVERSATION_LIST)}),body:{fromAccount:void 0,timeStamp:void 0,startIndex:void 0,pinnedTimeStamp:void 0,pinnedStartIndex:void 0,orderType:void 0,messageAssistFlag:4,assistFlag:15},keyMap:{request:{messageAssistFlag:"MsgAssistFlags",assistFlag:"AssistFlags",pinnedTimeStamp:"TopTimeStamp",pinnedStartIndex:"TopStartIndex"},response:{SessionItem:"conversations",ToAccount:"groupID",To_Account:"userID",UnreadMsgCount:"unreadCount",MsgGroupReadedSeq:"messageReadSeq",C2cPeerReadTime:"c2cPeerReadTime",LastMsgFlags:"lastMessageFlag",TopFlags:"isPinned",TopTimeStamp:"pinnedTimeStamp",TopStartIndex:"pinnedStartIndex",GroupId:"convGroupID"}}}}(e)),this._configMap.set(ng,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.RECENT_CONTACT,".").concat(Gc.CMD.DELETE_CONVERSATION)}),body:{fromAccount:"",toAccount:void 0,type:1,toGroupID:void 0,clearHistoryMessage:1},keyMap:{request:{toGroupID:"ToGroupid",clearHistoryMessage:"ClearRamble"}}}}(e)),this._configMap.set(og,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.RECENT_CONTACT,".").concat(Gc.CMD.CLEAR_HISTORY_MESSAGE)}),body:{fromAccount:"",toAccount:void 0,type:1,toGroupID:void 0},keyMap:{request:{toGroupID:"ToGroupid"}}}}(e)),this._configMap.set(rg,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.RECENT_CONTACT,".").concat(Gc.CMD.PIN_CONVERSATION)}),body:{fromAccount:"",operationType:1,itemList:void 0},keyMap:{request:{itemList:"RecentContactItem"}}}}(e)),this._configMap.set(ig,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.OPEN_IM,".").concat(Gc.CMD.DELETE_GROUP_AT_TIPS)}),body:{messageListToDelete:void 0},keyMap:{request:{messageListToDelete:"DelMsgList",messageSeq:"MsgSeq",messageRandom:"MsgRandom"}}}}(e)),this._configMap.set(ag,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.RECENT_CONTACT,".").concat(Gc.CMD.MARK_CONVERSATION)}),body:{fromAccount:"",itemList:void 0},keyMap:{request:{itemList:"MarkItem",operationType:"OptType",groupID:"ToGroupId"},response:{ToGroupId:"groupID",OptType:"operationType"}}}}(e)),this._configMap.set(sg,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.RECENT_CONTACT,".").concat(Gc.CMD.MARK_CONVERSATION)}),body:{fromAccount:"",itemList:void 0},keyMap:{request:{itemList:"MarkItem",operationType:"OptType",groupID:"ToGroupId"},response:{ToGroupId:"groupID",OptType:"operationType"}}}}(e)),this._configMap.set(ug,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.RECENT_CONTACT,".").concat(Gc.CMD.CREATE_CONVERSATION_GROUP)}),body:{fromAccount:"",itemList:void 0},keyMap:{request:{itemList:"GroupContactItem",groupID:"ToGroupId"},response:{GroupId:"convGroupID",ToGroupId:"groupID",OptType:"operationType"}}}}(e)),this._configMap.set(cg,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.RECENT_CONTACT,".").concat(Gc.CMD.DELETE_CONVERSATION_GROUP)}),body:{fromAccount:"",groupName:void 0},keyMap:{request:{},response:{GroupId:"convGroupID"}}}}(e)),this._configMap.set(lg,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.RECENT_CONTACT,".").concat(Gc.CMD.UPDATE_CONVERSATION_GROUP)}),body:{fromAccount:"",updateType:void 0,updateGroup:void 0},keyMap:{request:{oldName:"OldGroupName",newName:"NewGroupName",groupID:"ToGroupId",operationType:"ContactOptType",groupName:"OldGroupName",updateItem:"ContactUpdateItem"},response:{ContactOptType:"operationType",ToGroupId:"groupID",GroupId:"convGroupID"}}}}(e)),this._configMap.set(dg,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.RECENT_CONTACT,".").concat(Gc.CMD.UPDATE_CONVERSATION_GROUP)}),body:{fromAccount:"",updateType:void 0,updateGroup:{groupName:void 0,updateGroupType:void 0,updateItem:void 0}},keyMap:{request:{},response:{}}}}(e)),this._configMap.set(pg,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.RECENT_CONTACT,".").concat(Gc.CMD.UPDATE_CONVERSATION_GROUP)}),body:{fromAccount:"",updateType:void 0,updateGroup:void 0},keyMap:{request:{},response:{}}}}(e)),this._configMap.set(fg,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.RECENT_CONTACT,".").concat(Gc.CMD.GET_CONVERSATION_GROUP_LIST)}),body:{fromAccount:"",startTime:void 0,startIndex:void 0},keyMap:{request:{},response:{GroupId:"convGroupID",ToGroupId:"groupID",OptType:"operationType",CustomMark:"customData",ContactGroupId:"convGroupIDList"}}}}(e)),this._configMap.set(Sh,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.PROFILE,".").concat(Gc.CMD.PORTRAIT_GET)}),body:{fromAccount:"",userItem:[]},keyMap:{request:{toAccount:"To_Account",standardSequence:"StandardSequence",customSequence:"CustomSequence"}}}}(e)),this._configMap.set(bh,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.PROFILE,".").concat(Gc.CMD.PORTRAIT_SET)}),body:{fromAccount:"",profileItem:[{tag:xl.NICK,value:""},{tag:xl.GENDER,value:""},{tag:xl.ALLOWTYPE,value:""},{tag:xl.AVATAR,value:""}]},keyMap:{request:{toAccount:"To_Account",standardSequence:"StandardSequence",customSequence:"CustomSequence"}}}}(e)),this._configMap.set(Dh,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.FRIEND,".").concat(Gc.CMD.GET_BLACKLIST)}),body:{fromAccount:"",startIndex:0,maxLimited:30,lastSequence:0},keyMap:{response:{CurruentSequence:"currentSequence"}}}}(e)),this._configMap.set(Eh,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.FRIEND,".").concat(Gc.CMD.ADD_BLACKLIST)}),body:{fromAccount:"",toAccount:[]}}}(e)),this._configMap.set(Ah,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.FRIEND,".").concat(Gc.CMD.DELETE_BLACKLIST)}),body:{fromAccount:"",toAccount:[]}}}(e)),this._configMap.set(Sv,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.IM_OPEN_STATUS,".").concat(Gc.CMD.SET_SELF_STATUS)}),body:{customStatus:""},keyMap:{}}}(e)),this._configMap.set(bv,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.IM_OPEN_STATUS,".").concat(Gc.CMD.GET_USER_STATUS)}),body:{userIDList:void 0},keyMap:{response:{UserStatusList:"successUserList",ErrorList:"failureUserList",To_Account:"userID",Invalid_Account:"invalidUserID",Status:"statusType"}}}}(e)),this._configMap.set(Dv,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.IM_OPEN_STATUS,".").concat(Gc.CMD.SUBSCRIBE_USER_STATUS)}),body:{userIDList:void 0},keyMap:{response:{ErrorList:"failureUserList",To_Account:"userID",Invalid_Account:"invalidUserID"}}}}(e)),this._configMap.set(Ev,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.IM_OPEN_STATUS,".").concat(Gc.CMD.UNSUBSCRIBE_USER_STATUS)}),body:{userIDList:void 0,unsubscribeAll:void 0},keyMap:{response:{ErrorList:"failureUserList",To_Account:"userID",Invalid_Account:"invalidUserID"}}}}(e)),this._configMap.set(Lh,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.FRIEND,".").concat(Gc.CMD.GET_FRIEND_LIST)}),body:{fromAccount:"",startIndex:0,standardSequence:0,customSequence:0},keyMap:{response:{FriendNum:"friendCount",UserDataItem:"resultList",ValueItem:"tagValueList"}}}}(e)),this._configMap.set(Nh,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.FRIEND,".").concat(Gc.CMD.ADD_FRIEND)}),body:{fromAccount:"",addFriendItem:[],type:""},keyMap:{request:{source:"AddSource",wording:"AddWording",type:"AddType"},response:{ResultItem:"resultList"}}}}(e)),this._configMap.set(Ph,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.FRIEND,".").concat(Gc.CMD.UPDATE_FRIEND)}),body:{fromAccount:"",updateItem:void 0},keyMap:{request:{snsItem:"SnsItem"},response:{ResultItem:"resultList"}}}}(e)),this._configMap.set(Oh,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.FRIEND,".").concat(Gc.CMD.DELETE_FRIEND)}),body:{fromAccount:"",userIDList:[],type:""},keyMap:{request:{type:"DeleteType"},response:{ResultItem:"resultList"}}}}(e)),this._configMap.set(Rh,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.FRIEND,".").concat(Gc.CMD.GET_FRIEND_PROFILE)}),body:{fromAccount:"",userIDList:void 0},keyMap:{response:{InfoItem:"resultList",SnsProfileItem:"tagValueList"}}}}(e)),this._configMap.set(wh,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.FRIEND,".").concat(Gc.CMD.CHECK_FRIEND)}),body:{fromAccount:"",userIDList:[],type:""},keyMap:{request:{type:"CheckType"},response:{InfoItem:"resultList"}}}}(e)),this._configMap.set(Uh,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.FRIEND,".").concat(Gc.CMD.GET_FRIEND_APPLICATION_LIST)}),body:{fromAccount:"",applicationType:"",startTime:0,maxLimited:0,lastSequence:0},keyMap:{response:{PendencyItem:"resultList",AddSource:"source",AddTime:"time",AddWording:"wording",Image:"avatar",UnreadPendencyCount:"unreadCount",To_Account:"userID",PendencyType:"type"}}}}(e)),this._configMap.set(Gh,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.FRIEND,".").concat(Gc.CMD.RESPOND_FRIEND_APPLICATION)}),body:{fromAccount:"",responseFriendItem:[]},keyMap:{request:{tag:"TagName",action:"ResponseAction"},response:{ResultItem:"resultList"}}}}(e)),this._configMap.set(xh,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.FRIEND,".").concat(Gc.CMD.DELETE_FRIEND_APPLICATION)}),body:{fromAccount:"",type:"",userIDList:void 0},keyMap:{request:{type:"PendencyType",userIDList:"To_Account"},response:{ResultItem:"resultList"}}}}(e)),this._configMap.set(Fh,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.FRIEND,".").concat(Gc.CMD.REPORT_FRIEND_APPLICATION)}),body:{fromAccount:"",latestTimeStamp:""},keyMap:{request:{latestTimeStamp:"LatestPendencyTimeStamp"}}}}(e)),this._configMap.set(Bh,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.FRIEND,".").concat(Gc.CMD.CREATE_FRIEND_GROUP)}),body:{fromAccount:"",groupName:void 0,userIDList:void 0},keyMap:{request:{groupName:"GroupName",userIDList:"To_Account"},response:{ResultItem:"resultList"}}}}(e)),this._configMap.set(Vh,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.FRIEND,".").concat(Gc.CMD.DELETE_FRIEND_GROUP)}),body:{fromAccount:"",nameList:void 0},keyMap:{request:{nameList:"GroupName"}}}}(e)),this._configMap.set(qh,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.FRIEND,".").concat(Gc.CMD.GET_FRIEND_GROUP_LIST)}),body:{fromAccount:"",lastSequence:0,needFriend:"Need_Friend_Type_Yes"},keyMap:{response:{ResultItem:"resultList",GroupName:"name",FriendNumber:"friendCount",To_Account:"userIDList"}}}}(e)),this._configMap.set(Hh,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.FRIEND,".").concat(Gc.CMD.UPDATE_FRIEND_GROUP)}),body:{fromAccount:"",oldName:"",newName:void 0,updateGroupItem:void 0},keyMap:{request:{oldName:"GroupOldName",newName:"GroupNewName"},response:{UpdateType:"type",ResultItem:"resultList"}}}}(e)),this._configMap.set(hg,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.GROUP,".").concat(Gc.CMD.GET_JOINED_GROUPS)}),body:{memberAccount:"",limit:void 0,offset:void 0,groupType:void 0,responseFilter:{groupBaseInfoFilter:void 0,selfInfoFilter:void 0},isSupportTopic:0},keyMap:{request:{memberAccount:"Member_Account"},response:{GroupIdList:"groups",NoUnreadSeqList:"excludedUnreadSequenceList",MsgSeq:"readedSequence",LastRecallTime:"_lastRevokedTime"}}}}(e)),this._configMap.set(gg,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.GROUP,".").concat(Gc.CMD.GET_GROUP_INFO)}),body:{groupIDList:void 0,responseFilter:{groupBaseInfoFilter:["Type","Name","Introduction","Notification","FaceUrl","Owner_Account","CreateTime","InfoSeq","LastInfoTime","LastMsgTime","MemberNum","MaxMemberNum","ApplyJoinOption","NextMsgSeq","ShutUpAllMember"],groupCustomFieldFilter:void 0,memberInfoFilter:void 0,memberCustomFieldFilter:void 0}},keyMap:{request:{groupIDList:"GroupIdList",groupCustomField:"AppDefinedData",memberCustomField:"AppMemberDefinedData",groupCustomFieldFilter:"AppDefinedDataFilter_Group",memberCustomFieldFilter:"AppDefinedDataFilter_GroupMember"},response:{GroupIdList:"groups",AppDefinedData:"groupCustomField",AppMemberDefinedData:"memberCustomField",AppDefinedDataFilter_Group:"groupCustomFieldFilter",AppDefinedDataFilter_GroupMember:"memberCustomFieldFilter",InfoSeq:"infoSequence",MemberList:"members",GroupInfo:"groups",ShutUpUntil:"muteUntil",ShutUpAllMember:"muteAllMembers"}}}}(e)),this._configMap.set(vg,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.GROUP,".").concat(Gc.CMD.CREATE_GROUP)}),body:{type:void 0,name:void 0,groupID:void 0,ownerID:void 0,introduction:void 0,notification:void 0,maxMemberNum:void 0,joinOption:void 0,memberList:void 0,groupCustomField:void 0,memberCustomField:void 0,webPushFlag:1,avatar:"",isSupportTopic:void 0},keyMap:{request:{ownerID:"Owner_Account",userID:"Member_Account",avatar:"FaceUrl",maxMemberNum:"MaxMemberCount",joinOption:"ApplyJoinOption",groupCustomField:"AppDefinedData",memberCustomField:"AppMemberDefinedData"},response:{HugeGroupFlag:"avChatRoomFlag",OverJoinedGroupLimit_Account:"overLimitUserIDList"}}}}(e)),this._configMap.set(mg,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.GROUP,".").concat(Gc.CMD.DESTROY_GROUP)}),body:{groupID:void 0}}}(e)),this._configMap.set(_g,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.GROUP,".").concat(Gc.CMD.MODIFY_GROUP_INFO)}),body:{groupID:void 0,name:void 0,introduction:void 0,notification:void 0,avatar:void 0,joinOption:void 0,groupCustomField:void 0,muteAllMembers:void 0},keyMap:{request:{groupCustomField:"AppDefinedData",muteAllMembers:"ShutUpAllMember",joinOption:"ApplyJoinOption",avatar:"FaceUrl"},response:{AppDefinedData:"groupCustomField",ShutUpAllMember:"muteAllMembers"}}}}(e)),this._configMap.set(yg,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.GROUP,".").concat(Gc.CMD.APPLY_JOIN_GROUP)}),body:{groupID:void 0,applyMessage:void 0,userDefinedField:void 0,webPushFlag:1,historyMessageFlag:void 0},keyMap:{request:{applyMessage:"ApplyMsg",historyMessageFlag:"HugeGroupHistoryMsgFlag"},response:{HugeGroupFlag:"avChatRoomFlag",AVChatRoomKey:"avChatRoomKey",RspMsgList:"messageList",ToGroupId:"to"}}}}(e)),this._configMap.set(Mg,function(e){return e.a2,e.tinyid,{head:t(t({},h(e,sD)),{},{servcmd:"".concat(Gc.NAME.BIG_GROUP_NO_AUTH,".").concat(Gc.CMD.APPLY_JOIN_GROUP)}),body:{groupID:void 0,applyMessage:void 0,userDefinedField:void 0,webPushFlag:1},keyMap:{request:{applyMessage:"ApplyMsg"},response:{HugeGroupFlag:"avChatRoomFlag"}}}}(e)),this._configMap.set(Ig,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.GROUP,".").concat(Gc.CMD.QUIT_GROUP)}),body:{groupID:void 0}}}(e)),this._configMap.set(Cg,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.GROUP,".").concat(Gc.CMD.SEARCH_GROUP_BY_ID)}),body:{groupIDList:void 0,responseFilter:{groupBasePublicInfoFilter:["Type","Name","Introduction","Notification","FaceUrl","CreateTime","Owner_Account","LastInfoTime","LastMsgTime","NextMsgSeq","MemberNum","MaxMemberNum","ApplyJoinOption"]}},keyMap:{response:{}}}}(e)),this._configMap.set(kg,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.GROUP,".").concat(Gc.CMD.CHANGE_GROUP_OWNER)}),body:{groupID:void 0,newOwnerID:void 0},keyMap:{request:{newOwnerID:"NewOwner_Account"}}}}(e)),this._configMap.set(Tg,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.GROUP,".").concat(Gc.CMD.HANDLE_APPLY_JOIN_GROUP)}),body:{groupID:void 0,applicant:void 0,handleAction:void 0,handleMessage:void 0,authentication:void 0,messageKey:void 0,userDefinedField:void 0},keyMap:{request:{applicant:"Applicant_Account",handleAction:"HandleMsg",handleMessage:"ApprovalMsg",messageKey:"MsgKey"}}}}(e)),this._configMap.set(Sg,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.GROUP,".").concat(Gc.CMD.HANDLE_GROUP_INVITATION)}),body:{groupID:void 0,inviter:void 0,handleAction:void 0,handleMessage:void 0,authentication:void 0,messageKey:void 0,userDefinedField:void 0},keyMap:{request:{inviter:"Inviter_Account",handleAction:"HandleMsg",handleMessage:"ApprovalMsg",messageKey:"MsgKey"}}}}(e)),this._configMap.set(Ng,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.GROUP,".").concat(Gc.CMD.GET_GROUP_APPLICATION)}),body:{startTime:void 0,limit:void 0,handleAccount:void 0},keyMap:{request:{handleAccount:"Handle_Account"}}}}(e)),this._configMap.set(Pg,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.OPEN_IM,".").concat(Gc.CMD.DELETE_GROUP_SYSTEM_MESSAGE)}),body:{messageListToDelete:void 0},keyMap:{request:{messageListToDelete:"DelMsgList",messageSeq:"MsgSeq",messageRandom:"MsgRandom"}}}}(e)),this._configMap.set(Gg,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.BIG_GROUP_LONG_POLLING,".").concat(Gc.CMD.AVCHATROOM_LONG_POLL)}),body:{USP:1,startSeq:1,startBroadcastSeq:void 0,holdTime:90,key:void 0},keyMap:{request:{USP:"USP"},response:{ToGroupId:"groupID",RspBroadcastMsgList:"broadcastMessageList",IsSystemMsg:"isSystemMessage"}}}}(e)),this._configMap.set(Ug,function(e){return e.a2,e.tinyid,{head:t(t({},h(e,uD)),{},{servcmd:"".concat(Gc.NAME.BIG_GROUP_LONG_POLLING_NO_AUTH,".").concat(Gc.CMD.AVCHATROOM_LONG_POLL)}),body:{USP:1,startSeq:1,holdTime:90,key:void 0},keyMap:{request:{USP:"USP"},response:{ToGroupId:"groupID"}}}}(e)),this._configMap.set(xg,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.GROUP,".").concat(Gc.CMD.GET_ONLINE_MEMBER_NUM)}),body:{groupID:void 0}}}(e)),this._configMap.set(Bg,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.GROUP,".").concat(Gc.CMD.SET_GROUP_ATTRIBUTES)}),body:{groupID:void 0,groupAttributeList:void 0,mainSequence:void 0,avChatRoomKey:void 0,attributeControl:["RaceConflict"]},keyMap:{request:{key:"key",value:"value"}}}}(e)),this._configMap.set(Vg,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.GROUP,".").concat(Gc.CMD.MODIFY_GROUP_ATTRIBUTES)}),body:{groupID:void 0,groupAttributeList:void 0,mainSequence:void 0,avChatRoomKey:void 0,attributeControl:["RaceConflict"]},keyMap:{request:{key:"key",value:"value"}}}}(e)),this._configMap.set(Hg,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.GROUP,".").concat(Gc.CMD.DELETE_GROUP_ATTRIBUTES)}),body:{groupID:void 0,groupAttributeList:void 0,mainSequence:void 0,avChatRoomKey:void 0,attributeControl:["RaceConflict"]},keyMap:{request:{key:"key"}}}}(e)),this._configMap.set(Kg,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.GROUP,".").concat(Gc.CMD.CLEAR_GROUP_ATTRIBUTES)}),body:{groupID:void 0,mainSequence:void 0,avChatRoomKey:void 0,attributeControl:["RaceConflict"]}}}(e)),this._configMap.set(jg,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.GROUP_ATTR,".").concat(Gc.CMD.GET_GROUP_ATTRIBUTES)}),body:{groupID:void 0,avChatRoomKey:void 0,groupType:1},keyMap:{request:{avChatRoomKey:"Key",groupType:"GroupType"}}}}(e)),this._configMap.set(Wg,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.GROUP,".").concat(Gc.CMD.GET_GROUP_NOTIFY)}),body:{notifyType:1,groupID:"",beginTime:0,endTime:0,limit:20},keyMap:{request:{},response:{NextMsgTime:"nextRevokedTime",NotifyMsgList:"notifyList"}}}}(e)),this._configMap.set(Yg,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.GROUP,".").concat(Gc.CMD.UPDATE_GROUP_COUNTER)}),body:{groupID:void 0,counterList:void 0,avChatRoomKey:void 0,mode:void 0},keyMap:{request:{counterList:"GroupCounter"}}}}(e)),this._configMap.set(Jg,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.GROUP,".").concat(Gc.CMD.GET_GROUP_COUNTER)}),body:{groupID:void 0,keyList:[],avChatRoomKey:void 0},keyMap:{request:{keyList:"GroupCounterKeys"}}}}(e)),this._configMap.set(Iv,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.GROUP_COMMUNITY,".").concat(Gc.CMD.CREATE_TOPIC)}),body:{groupID:void 0,topicName:void 0,avatar:void 0,customData:void 0,topicID:void 0,notification:void 0,introduction:void 0},keyMap:{request:{avatar:"FaceUrl"}}}}(e)),this._configMap.set(Cv,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.GROUP_COMMUNITY,".").concat(Gc.CMD.DELETE_TOPIC)}),body:{groupID:void 0,topicIDList:void 0},keyMap:{request:{topicIDList:"TopicIdList"},response:{DestroyResultItem:"resultList"}}}}(e)),this._configMap.set(kv,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.GROUP_COMMUNITY,".").concat(Gc.CMD.UPDATE_TOPIC_PROFILE)}),body:{groupID:void 0,topicID:void 0,avatar:void 0,customData:void 0,notification:void 0,introduction:void 0,muteAllMembers:void 0,topicName:void 0},keyMap:{request:{avatar:"FaceUrl",muteAllMembers:"ShutUpAllMember"}}}}(e)),this._configMap.set(Tv,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.GROUP_COMMUNITY,".").concat(Gc.CMD.GET_TOPIC_LIST)}),body:{groupID:void 0,topicIDList:void 0,MemberInfoFilter:["NoUnreadSeqList"]},keyMap:{request:{topicIDList:"TopicIdList"},response:{TopicAndSelfInfo:"topicInfoList",TopicInfo:"topic",GroupID:"groupID",ShutUpTime:"muteTime",ShutUpAllFlag:"muteAllMembers",LastMsgTime:"lastMessageTime",MsgSeq:"readedSequence",LastMsgSeq:"sequence",NoUnreadSeqList:"excludedUnreadSequenceList"}}}}(e)),this._configMap.set(Xg,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.GROUP,".").concat(Gc.CMD.GET_GROUP_MEMBER_LIST)}),body:{groupID:void 0,limit:0,offset:void 0,next:void 0,memberRoleFilter:void 0,memberInfoFilter:["Role","NameCard","ShutUpUntil","JoinTime"],memberCustomFieldFilter:void 0},keyMap:{request:{memberCustomFieldFilter:"AppDefinedDataFilter_GroupMember"},response:{AppMemberDefinedData:"memberCustomField",AppDefinedDataFilter_GroupMember:"memberCustomFieldFilter",MemberList:"members",ShutUpUntil:"muteUntil"}}}}(e)),this._configMap.set($g,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.GROUP_AVCHATROOM,".").concat(Gc.CMD.GET_AVCHATROOM_MEMBER_LIST)}),body:{groupID:void 0,offset:void 0,filter:void 0},keyMap:{request:{offset:"Timestamp",filter:"Mark"},response:{NextTimestamp:"offset"}}}}(e)),this._configMap.set(Qg,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.GROUP,".").concat(Gc.CMD.GET_GROUP_MEMBER_INFO)}),body:{groupID:void 0,userIDList:void 0,memberInfoFilter:void 0,memberCustomFieldFilter:void 0},keyMap:{request:{userIDList:"Member_List_Account",memberCustomFieldFilter:"AppDefinedDataFilter_GroupMember"},response:{MemberList:"members",ShutUpUntil:"muteUntil",AppDefinedDataFilter_GroupMember:"memberCustomFieldFilter",AppMemberDefinedData:"memberCustomField"}}}}(e)),this._configMap.set(ev,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.GROUP,".").concat(Gc.CMD.ADD_GROUP_MEMBER)}),body:{groupID:void 0,silence:void 0,userIDList:void 0},keyMap:{request:{userID:"Member_Account",userIDList:"MemberList"},response:{MemberList:"members"}}}}(e)),this._configMap.set(tv,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.GROUP,".").concat(Gc.CMD.DELETE_GROUP_MEMBER)}),body:{groupID:void 0,userIDList:void 0,reason:void 0},keyMap:{request:{userIDList:"MemberToDel_Account"}}}}(e)),this._configMap.set(nv,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.GROUP,".").concat(Gc.CMD.BAN_AVCHATROOM_MEMBER)}),body:{groupID:void 0,userIDList:void 0,duration:void 0,reason:""},keyMap:{request:{userIDList:"Members_Account",duration:"Duration",reason:"Description"}}}}(e)),this._configMap.set(ov,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.GROUP,".").concat(Gc.CMD.MODIFY_GROUP_MEMBER_INFO)}),body:{groupID:void 0,topicID:void 0,userID:void 0,messageRemindType:void 0,nameCard:void 0,role:void 0,memberCustomField:void 0,muteTime:void 0},keyMap:{request:{userID:"Member_Account",memberCustomField:"AppMemberDefinedData",muteTime:"ShutUpTime",messageRemindType:"MsgFlag"}}}}(e)),this._configMap.set(rv,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.GROUP_AVCHATROOM,".").concat(Gc.CMD.MARK_AVCHATROOM_MEMBER_INFO)}),body:{groupID:void 0,operationType:1,memberList:[]},keyMap:{request:{operationType:"CommandType",memberList:"MemberList",markType:"Marks",userID:"Member_Account"},response:{CommandType:"operationType",Marks:"markType",Member_Account:"userID"}}}}(e)),this._configMap.set(uv,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.IM_OPEN_STAT,".").concat(Gc.CMD.TIM_WEB_REPORT_V2)}),body:{header:{},event:[],quality:[]},keyMap:{request:{SDKType:"sdk_type",SDKVersion:"sdk_version",deviceType:"device_type",platform:"platform",instanceID:"instance_id",traceID:"trace_id",SDKAppID:"sdk_app_id",userID:"user_id",tinyID:"tiny_id",extension:"extension",timestamp:"timestamp",networkType:"network_type",eventType:"event_type",code:"error_code",message:"error_message",moreMessage:"more_message",duplicate:"duplicate",costTime:"cost_time",level:"level",qualityType:"quality_type",reportIndex:"report_index",wholePeriod:"whole_period",totalCount:"total_count",rttCount:"success_count_business",successRateOfRequest:"percent_business",countLessThan1Second:"success_count_business",percentOfCountLessThan1Second:"percent_business",countLessThan3Second:"success_count_platform",percentOfCountLessThan3Second:"percent_platform",successCountOfBusiness:"success_count_business",successRateOfBusiness:"percent_business",successCountOfPlatform:"success_count_platform",successRateOfPlatform:"percent_platform",successCountOfMessageReceived:"success_count_business",successRateOfMessageReceived:"percent_business",avgRTT:"average_value",avgDelay:"average_value",avgValue:"average_value",uiPlatform:"ui_platform"}}}}(o)),this._configMap.set(cv,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.HEARTBEAT,".").concat(Gc.CMD.ALIVE)}),body:{}}}(e)),this._configMap.set(lv,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.IM_OPEN_PUSH,".").concat(Gc.CMD.MESSAGE_PUSH)}),body:{},keyMap:{response:{C2cMsgArray:"C2CMessageArray",GroupMsgArray:"groupMessageArray",GroupTips:"groupTips",C2cNotifyMsgArray:"C2CNotifyMessageArray",C2cMsgInfo:"C2CReadReceiptArray",ClientSeq:"clientSequence",MsgPriority:"priority",NoticeSeq:"noticeSequence",MsgContent:"content",MsgType:"type",MsgBody:"elements",ToGroupId:"to",Desc:"description",Ext:"extension",IsSyncMsg:"isSyncMessage",Flag:"needSync",NeedAck:"needAck",PendencyAdd_Account:"userID",ProfileImNick:"nick",PendencyType:"applicationType",C2CReadAllMsg:"readAllC2CMessage",IsNeedReadReceipt:"needReadReceipt",Status:"statusType",MsgExtensionNotify:"messageExtensionNotify",ExtensionC2cMsgInfo:"messageInfo",ExtensionGroupMsgInfo:"messageInfo",MsgOptType:"operateType",SetKVInfo:"operateResultList",DeleteKVInfo:"operateResultList",ClearKVInfo:"operateResultList",MsgKeyValue:"extensions",ClearMsgSeq:"clearSequence",MsgLastSeq:"globalSequence"}}}}(e)),this._configMap.set(dv,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.IM_OPEN_PUSH,".").concat(Gc.CMD.MULTI_MESSAGE_PUSH)}),body:{},keyMap:{response:{GroupMsgArray:"groupMessageArray",GroupTips:"groupTips",ClientSeq:"clientSequence",MsgPriority:"priority",NoticeSeq:"noticeSequence",MsgContent:"content",MsgType:"type",MsgBody:"elements",ToGroupId:"to",Desc:"description",Ext:"extension",IsSyncMsg:"isSyncMessage",Flag:"needSync",NeedAck:"needAck",PendencyType:"applicationType"}}}}(e)),this._configMap.set(pv,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.OPEN_IM,".").concat(Gc.CMD.MESSAGE_PUSH_ACK)}),body:{sessionData:void 0},keyMap:{request:{sessionData:"SessionData"}}}}(e)),this._configMap.set(fv,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.IM_OPEN_STATUS,".").concat(Gc.CMD.STATUS_FORCE_OFFLINE)}),body:{},keyMap:{response:{C2cNotifyMsgArray:"C2CNotifyMessageArray",NoticeSeq:"noticeSequence",KickoutMsgNotify:"kickoutMsgNotify",NewInstInfo:"newInstanceInfo"}}}}(e)),this._configMap.set(gv,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.IM_LONG_MESSAGE,".").concat(Gc.CMD.DOWNLOAD_MERGER_MESSAGE)}),body:{downloadKey:""},keyMap:{response:{Data:"data",Desc:"description",Ext:"extension",Download_Flag:"downloadFlag",ThumbUUID:"thumbUUID",VideoUUID:"videoUUID"}}}}(e)),this._configMap.set(hv,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.IM_LONG_MESSAGE,".").concat(Gc.CMD.UPLOAD_MERGER_MESSAGE)}),body:{messageList:[]},keyMap:{request:{fromAccount:"From_Account",toAccount:"To_Account",msgTimeStamp:"MsgTimeStamp",msgSeq:"MsgSeq",msgRandom:"MsgRandom",msgBody:"MsgBody",type:"MsgType",content:"MsgContent",data:"Data",description:"Desc",extension:"Ext",sizeType:"Type",uuid:"UUID",url:"",imageUrl:"URL",fileUrl:"Url",remoteAudioUrl:"Url",remoteVideoUrl:"VideoUrl",thumbUUID:"ThumbUUID",videoUUID:"VideoUUID",videoUrl:"",downloadFlag:"Download_Flag",from:"From_Account",time:"MsgTimeStamp",messageRandom:"MsgRandom",messageSequence:"MsgSeq",elements:"MsgBody",clientSequence:"ClientSeq",payload:"MsgContent",messageList:"MsgList",messageNumber:"MsgNum",abstractList:"AbstractList",messageBody:"MsgBody"}}}}(e)),this._configMap.set(Rv,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.IM_OPEN_STATUS,".").concat(Gc.CMD.SET_TOKEN)}),body:{tokenID:"",pushMsg:0,sdkAppID:0,businessID:"",deviceBrand:"",deviceToken:"",isTpns:0,isWebUniapp:0},keyMap:{request:{tokenID:"TokenID",pushMsg:"PushMsg",sdkAppID:"EnterVersion",businessID:"BusiID",deviceBrand:"InstType",deviceToken:"VarToken",isTpns:"IsTpns"}}}}(e)),this._configMap.set(Lv,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.IM_OPEN_STATUS,".").concat(Gc.CMD.STAT_FOREGROUND)}),body:{isWebUniapp:0}}}(e)),this._configMap.set(Av,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.IM_OPEN_STATUS,".").concat(Gc.CMD.STAT_BACKGROUND)}),body:{C2CUnread:0,GroupUnread:0,isWebUniapp:0},keyMap:{request:{c2cUnreadCount:"C2cUnread",groupUnreadCount:"GrpUnread"}}}}(e))}},{key:"has",value:function(e){return this._configMap.has(e)}},{key:"get",value:function(e){return this._configMap.get(e)}},{key:"update",value:function(){this._fillConfigMap()}},{key:"getKeyMap",value:function(e){return this.has(e)?this.get(e).keyMap||{}:(Gl.w("".concat(this._n,".getKeyMap unknown protocolName:").concat(e)),{})}},{key:"getProtocolData",value:function(e){var t=e.protocolName,n=e.requestData,o=this.get(t),r=null;if(n){var i=this._simpleDeepCopy(o),a=this._updateService(n,i),s=a.body,u=Object.create(null);for(var c in s)if(Object.prototype.hasOwnProperty.call(s,c)){if(u[c]=s[c],void 0===n[c])continue;u[c]=n[c]}a.body=u,r=this._getUplinkData(a)}else r=this._getUplinkData(o);return r}},{key:"_getUplinkData",value:function(e){var t=this._requestDataCleaner(e),n=xd(t.head),o=xk(t.body,this._getRequestKeyMap(n));return t.body=o,t}},{key:"_updateService",value:function(e,t){var n=xd(t.head);if(this._isFromGroupRequest(t)){var o=e.type,r=e.groupID,i=void 0===r?void 0:r,a=e.groupIDList,s=void 0===a?[]:a;id(i)&&(i=s[0]||""),bd({type:o,groupID:i})&&(t.head.servcmd="".concat(Gc.NAME.GROUP_COMMUNITY,".").concat(n))}return t}},{key:"_isFromGroupRequest",value:function(e){return e.head.servcmd.includes(Gc.NAME.GROUP)||e.head.servcmd.includes(Gc.NAME.GROUP_ATTR)}},{key:"_getRequestKeyMap",value:function(e){var n=this.getKeyMap(e);return t(t({},Ok.request),n.request)}},{key:"_requestDataCleaner",value:function(e){var t=Array.isArray(e)?[]:Object.create(null);for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&ld(n)&&null!==e[n]&&void 0!==e[n]&&("object"!==o(e[n])?t[n]=e[n]:t[n]=this._requestDataCleaner.bind(this)(e[n]));return t}},{key:"_simpleDeepCopy",value:function(e){for(var t,n=Object.keys(e),o={},r=0,i=n.length;r<i;r++)t=n[r],rd(e[t])?o[t]=Array.from(e[t]):nd(e[t])?o[t]=this._simpleDeepCopy(e[t]):o[t]=e[t];return o}}]),e}(),lD=[pv],dD=function(){function e(t){r(this,e),this._sessionModule=t,this._n="DownlinkHandler",this._eventHandlerMap=new Map,this._eventHandlerMap.set("C2CMessageArray",this._c2cMessageArrayHandler.bind(this)),this._eventHandlerMap.set("groupMessageArray",this._groupMessageArrayHandler.bind(this)),this._eventHandlerMap.set("groupTips",this._groupTipsHandler.bind(this)),this._eventHandlerMap.set("C2CNotifyMessageArray",this._C2CNotifyMessageArrayHandler.bind(this)),this._eventHandlerMap.set("C2CReadReceiptArray",this._C2CReadReceiptArrayHandler.bind(this)),this._eventHandlerMap.set("profileModify",this._profileHandler.bind(this)),this._eventHandlerMap.set("friendListMod",this._relationChainHandler.bind(this)),this._eventHandlerMap.set("recentContactMod",this._recentContactHandler.bind(this)),this._eventHandlerMap.set("readAllC2CMessage",this._allMessageReadHandler.bind(this)),this._eventHandlerMap.set("c2cMessageModified",this._c2cMessageModifiedHandler.bind(this)),this._eventHandlerMap.set("groupMessageModified",this._groupMessageModifiedHandler.bind(this)),this._eventHandlerMap.set("userStatusList",this._userStatusListHandler.bind(this)),this._eventHandlerMap.set("messageExtensionNotify",this._messageExtensionNotifyHandler.bind(this)),this._keys=y(this._eventHandlerMap.keys())}return a(e,[{key:"_c2cMessageArrayHandler",value:function(e){var t=this._sessionModule.getModule(Hf);t&&(e.dataList.forEach((function(e){if(1===e.isSyncMessage){var t=e.from;e.from=e.to,e.to=t}})),1===e.needSync&&this._sessionModule.getModule(nh).startOnlineSync(),t.onNewC2CMessage({dataList:e.dataList,isInstantMessage:!0}))}},{key:"_c2cMessageModifiedHandler",value:function(e){var t=this._sessionModule.getModule(Hf);t&&t.onC2CMessageModified(e)}},{key:"_groupMessageArrayHandler",value:function(e){var t=this._sessionModule.getModule(Kf);t&&t.onNewGroupMessage({event:e.event,dataList:e.dataList,isInstantMessage:!0})}},{key:"_groupMessageModifiedHandler",value:function(e){var t=this._sessionModule.getModule(Kf);t&&t.onGroupMessageModified(e)}},{key:"_groupTipsHandler",value:function(e){var t=this._sessionModule.getModule(Kf);if(t){var n=e.event,o=e.dataList,r=e.isInstantMessage,i=void 0===r||r,a=e.isSyncingEnded;switch(n){case 4:case 6:t.onNewGroupTips({event:n,dataList:o});break;case 5:for(var s=0;s<o.length;s++)if(rd(o[s].elements.revokedInfos))t.onGroupMessageRevoked({dataList:o});else if(rd(o[s].elements.groupMessageReadNotice))t.onGroupMessageReadNotice({dataList:o});else{if(!rd(o[s].elements.readReceiptList)){t.onNewGroupSystemNotice({dataList:o,isInstantMessage:i,isSyncingEnded:a});break}t.onReadReceiptList({dataList:o})}break;case 12:this._sessionModule.getModule(Wf).onNewGroupAtTips({dataList:o});break;default:Gl.l("".concat(this._n,"._groupTipsHandler unknown event:").concat(n," dataList:"),o)}}}},{key:"_C2CNotifyMessageArrayHandler",value:function(e){var t=this,n=e.dataList;if(rd(n)){var o=this._sessionModule.getModule(Hf);n.forEach((function(e){if(od(e))if(e.hasOwnProperty("kickoutMsgNotify")){var r=e.kickoutMsgNotify,i=r.kickType,a=r.newInstanceInfo,s=void 0===a?{}:a;1===i?t._sessionModule.onMultipleAccountKickedOut(s):2===i?t._sessionModule.onMultipleDeviceKickedOut(s):3===i&&t._sessionModule.onRestApiKickedOut(s)}else e.hasOwnProperty("c2cMessageRevokedNotify")?o&&o.onC2CMessageRevoked({dataList:n}):e.hasOwnProperty("c2cMessageReadReceipt")?o&&o.onC2CMessageReadReceipt({dataList:n}):e.hasOwnProperty("c2cMessageReadNotice")?o&&o.onC2CMessageReadNotice({dataList:n}):e.hasOwnProperty("muteNotificationsSync")&&t._sessionModule.getModule(Wf).onC2CMessageRemindTypeSynced({dataList:n})}))}}},{key:"_C2CReadReceiptArrayHandler",value:function(e){this._sessionModule.getModule(Hf).onReadReceiptList(e)}},{key:"_profileHandler",value:function(e){this._sessionModule.getModule(Vf).onProfileModified({dataList:e.dataList});var t=this._sessionModule.getModule(jf);t&&t.onFriendProfileModified({dataList:e.dataList})}},{key:"_relationChainHandler",value:function(e){this._sessionModule.getModule(Vf).onRelationChainModified({dataList:e.dataList});var t=this._sessionModule.getModule(jf);t&&t.onRelationChainModified({dataList:e.dataList})}},{key:"_recentContactHandler",value:function(e){var t=e.dataList;if(rd(t)){var n=this._sessionModule.getModule(Wf);n&&t.forEach((function(e){var t=e.pushType;if(1===t){var o=e.recentContactDeleteItem;n.onConversationDeleted(o.recentContactList)}else if(2===t){var r=e.recentContactTopItem;n.onConversationPinned(r.recentContactList)}else if(3===t){var i=e.recentContactTopItem;n.onConversationUnpinned(i.recentContactList)}else if(4===t){var a=e.recentContactMarkContact;n.onConversationMarkUpdated(a.recentContactMarkContactItem)}else if(5===t){var s=e.recentContactCreateContactGroup;n.onConversationGroupCreated(s.msgContactGroupContactItem)}else if(6===t){var u=e.recentContactDelContactGroup;n.onConversationGroupDeleted(u.msgGroupItem)}else if(7===t){var c=e.recentContactUpdateContactGroup,l=c.updateType,d=c.msgUpdateGroup,p=c.msgUpdateContact;if(1===l){var f=d.updateGroupType;1===f?n.onConversationGroupNameUpdated(d):2===f&&n.onConversationInGroupUpdated(d)}else 2===l&&n.onConversationAddedToOrDeletedFromGroup(p)}}))}}},{key:"_allMessageReadHandler",value:function(e){var t=e.dataList,n=this._sessionModule.getModule(Wf);n&&n.onPushedAllMessageRead(t)}},{key:"_userStatusListHandler",value:function(e){this._sessionModule.getModule(Vf).onUserStatusUpdated(e)}},{key:"_messageExtensionNotifyHandler",value:function(e){this._sessionModule.getModule(Bf).onMessageExtensionNotify(e)}},{key:"onMessage",value:function(e){var t=this,n=e.body;if(this._filterMessageFromIMOpenPush(e)){var o=n.eventArray,r=n.isInstantMessage,i=n.isSyncingEnded,a=n.needSync;if(rd(o))for(var s=null,u=null,c=0,l=0,d=o.length;l<d;l++){c=(s=o[l]).event;var p=Object.keys(s).find((function(e){return-1!==t._keys.indexOf(e)}));p?(u=14===c?{readAllC2CMessage:s[p],groupMessageReadInfoList:s.groupMessageReadNotice||[]}:16===c?{userID:s.userID,readReceiptList:s[p]}:s[p],this._eventHandlerMap.get(p)({event:c,dataList:u,isInstantMessage:r,isSyncingEnded:i,needSync:a})):Gl.l("".concat(this._n,".onMessage unknown eventItem:").concat(s))}}}},{key:"_filterMessageFromIMOpenPush",value:function(e){var t=e.head,n=e.body,o=t.servcmd,r=!1;if(id(o)||(r=o.includes(Gc.NAME.IM_CONFIG_MANAGER)||o.includes(Gc.NAME.OVERLOAD_PUSH)||o.includes(Gc.NAME.STAT_SERVICE)),!r)return!0;if(o.includes(Gc.CMD.PUSHED_CLOUD_CONTROL_CONFIG))this._sessionModule.getModule(ah).onPushedCloudControlConfig(n);else if(o.includes(Gc.CMD.PUSHED_COMMERCIAL_CONFIG))this._sessionModule.getModule(lh).onPushedConfig(n);else if(o.includes(Gc.CMD.OVERLOAD_NOTIFY))this._sessionModule.onPushedServerOverload(n);else if(o.includes(Gc.CMD.KICK_OTHER)){var i=Date.now();this._sessionModule.reLoginOnKickOther();var a=new w_("kickOther"),s=this._sessionModule.getModule(Ff).getLastWsHelloTs(),u=i-s;a.setMessage("last wshello time:".concat(s," diff:").concat(u,"ms")).setNetworkType(this._sessionModule.getNetworkType()).end()}return!1}}]),e}(),pD=[{cmd:Gc.CMD.GET_GROUP_INFO,interval:1,count:20},{cmd:Gc.CMD.GET_AVCHATROOM_MEMBER_LIST,interval:3,count:1},{cmd:Gc.CMD.GET_GROUP_APPLICATION,interval:1,count:1},{cmd:Gc.CMD.GET_TOPIC_LIST,interval:1,count:10},{cmd:Gc.CMD.SET_GROUP_ATTRIBUTES,interval:5,count:10},{cmd:Gc.CMD.MODIFY_GROUP_ATTRIBUTES,interval:5,count:10},{cmd:Gc.CMD.DELETE_GROUP_ATTRIBUTES,interval:5,count:10},{cmd:Gc.CMD.CLEAR_GROUP_ATTRIBUTES,interval:5,count:10},{cmd:Gc.CMD.GET_GROUP_ATTRIBUTES,interval:5,count:20},{cmd:Gc.CMD.UPDATE_GROUP_COUNTER,interval:5,count:20},{cmd:Gc.CMD.GET_GROUP_COUNTER,interval:5,count:20},{cmd:Gc.CMD.SET_ALL_MESSAGE_READ,interval:1,count:1},{cmd:Gc.CMD.GET_USER_STATUS,interval:5,count:20},{cmd:Gc.CMD.SUBSCRIBE_USER_STATUS,interval:5,count:20},{cmd:Gc.CMD.UNSUBSCRIBE_USER_STATUS,interval:5,count:20}],fD=function(e){u(o,e);var n=m(o);function o(e){var t;return r(this,o),(t=n.call(this,e))._n="SessionModule",t._platform=t.getPlatform(),t._protocolHandler=new cD(g(t)),t._messageDispatcher=new dD(g(t)),t._commandFrequencyLimitMap=new Map,t._commandRequestInfoMap=new Map,t._serverOverloadInfoMap=new Map,t._init(),t.getInnerEmitterInstance().on(iC,t._onCloudConfigUpdated,g(t)),t}return a(o,[{key:"_init",value:function(){this._updateCommandFrequencyLimitMap(pD)}},{key:"_onCloudConfigUpdated",value:function(){var e=this.getCloudConfig("cmd_frequency_limit");id(e)||(e=JSON.parse(e),this._updateCommandFrequencyLimitMap(e))}},{key:"_updateCommandFrequencyLimitMap",value:function(e){var t=this;e.forEach((function(e){t._commandFrequencyLimitMap.set(e.cmd,{interval:e.interval,count:e.count})}))}},{key:"updateProtocolConfig",value:function(){this._protocolHandler.update()}},{key:"request",value:function(e){Gl.d("".concat(this._n,".request options:"),e);var t=e.protocolName,n=e.tjgID;if(!this._protocolHandler.has(t))return Gl.w("".concat(this._n,".request unknown protocol:").concat(t)),BI({code:t_});var o=this.getProtocolData(e),r=o.head.servcmd;if(this._isFrequencyOverLimit(r))return BI({code:e_});if(this._isServerOverload(r))return BI({code:m_});Yd(n)||(o.head.tjgID=n);var i=this.getModule(rh);return lD.includes(t)?i.simplySend(o):i.send(o)}},{key:"getKeyMap",value:function(e){return this._protocolHandler.getKeyMap(e)}},{key:"genCommonHead",value:function(){var e=this.getModule(Yf);return{ver:"v4",platform:this._platform,websdkappid:Dc,websdkversion:bc,a2:e.getA2Key()||void 0,tinyid:e.getTinyID()||void 0,status_instid:e.getStatusInstanceID(),sdkappid:e.getSDKAppID(),contenttype:e.getContentType(),reqtime:0,identifier:e.getA2Key()?void 0:e.getUserID(),usersig:e.getA2Key()?void 0:e.getUserSig(),sdkability:192371,tjgID:""}}},{key:"genCosSpecifiedHead",value:function(){var e=this.getModule(Yf);return{ver:"v4",platform:this._platform,websdkappid:Dc,websdkversion:bc,sdkappid:e.getSDKAppID(),contenttype:e.getContentType(),reqtime:0,identifier:e.getUserID(),usersig:e.getUserSig(),status_instid:e.getStatusInstanceID(),sdkability:192371}}},{key:"genSSOReportHead",value:function(){var e=this.getModule(Yf);return{ver:"v4",platform:this._platform,websdkappid:Dc,websdkversion:bc,sdkappid:e.getSDKAppID(),contenttype:"",reqtime:0,identifier:"",usersig:"",status_instid:e.getStatusInstanceID(),sdkability:192371}}},{key:"getProtocolData",value:function(e){return this._protocolHandler.getProtocolData(e)}},{key:"trans",value:function(e){var n=e.servcmd,o=e.data,r={head:t(t({},this.genCommonHead()),{},{servcmd:n}),body:o};return this.getModule(rh).send(r)}},{key:"sendComboMessage",value:function(e){var n=e.servcmd,o=e.data,r={head:t(t({},this.genCommonHead()),{},{servcmd:n}),body:o};return this.getModule(rh).send(r)}},{key:"onErrorCodeNotZero",value:function(e){var t=e.errorCode;if(t===v_){var n=e.kickType,o=e.newInstanceInfo,r=void 0===o?{}:o;1===n?this.onMultipleAccountKickedOut(r):2===n?this.onMultipleDeviceKickedOut(r):3===n&&this.onRestApiKickedOut(r)}t!==h_&&t!==g_||(this._onUserSigExpired(),this.getModule(rh).reConnect())}},{key:"onMessage",value:function(e){var t=e.body,n=t.needAck,o=void 0===n?0:n,r=t.sessionData;1===o&&this._sendACK(r),this._messageDispatcher.onMessage(e)}},{key:"onReconnected",value:function(){this._reLoginOnReconnected()}},{key:"reLoginOnKickOther",value:function(){Gl.l("".concat(this._n,".reLoginOnKickOther")),this._reLogin()}},{key:"_reLoginOnReconnected",value:function(){Gl.l("".concat(this._n,"._reLoginOnReconnected")),this._reLogin()}},{key:"_reLogin",value:function(){var e=this;if(this.isLoggedIn()){var t=0,n=this.getModule(dh);n.canIUseOfflinePush()&&(t=n.getUniAppPlatform()),this.request({protocolName:mh,requestData:{isWebUniapp:t}}).then((function(t){var n=t.data.instanceID;e.getModule(Yf).setStatusInstanceID(n),Gl.l("".concat(e._n,"._reLogin ok. start to sync unread messages")),e.getModule(Wf).syncConversationList().then((function(){e.getModule(uh).start()})),e.getModule(Kf).updateLocalMainSequenceOnReconnected();var o=e.getModule(Zf);o.resetGetTopicTime(),o.getTopicListOnReconnected()}))}}},{key:"onMultipleAccountKickedOut",value:function(e){this.getModule(Ff).onMultipleAccountKickedOut(e)}},{key:"onMultipleDeviceKickedOut",value:function(e){this.getModule(Ff).onMultipleDeviceKickedOut(e)}},{key:"_onUserSigExpired",value:function(){this.getModule(Ff).onUserSigExpired()}},{key:"onRestApiKickedOut",value:function(e){this.getModule(Ff).onRestApiKickedOut(e)}},{key:"_sendACK",value:function(e){this.request({protocolName:pv,requestData:{sessionData:e}})}},{key:"_isFrequencyOverLimit",value:function(e){var t=e.split(".")[1];if(!this._commandFrequencyLimitMap.has(t))return!1;if(!this._commandRequestInfoMap.has(t))return this._commandRequestInfoMap.set(t,{startTime:Date.now(),requestCount:1}),!1;var n=this._commandFrequencyLimitMap.get(t),o=n.count,r=n.interval,i=this._commandRequestInfoMap.get(t),a=i.startTime,s=i.requestCount;if(Date.now()-a>1e3*r)return this._commandRequestInfoMap.set(t,{startTime:Date.now(),requestCount:1}),!1;s+=1,this._commandRequestInfoMap.set(t,{startTime:a,requestCount:s});var u=!1;return s>o&&(u=!0),u}},{key:"_isServerOverload",value:function(e){if(!this._serverOverloadInfoMap.has(e))return!1;var t=this._serverOverloadInfoMap.get(e),n=t.overloadTime,o=t.waitingTime,r=!1;return Date.now()-n<=1e3*o?r=!0:(this._serverOverloadInfoMap.delete(e),r=!1),r}},{key:"onPushedServerOverload",value:function(e){var t=e.overloadCommand,n=e.waitingTime;this._serverOverloadInfoMap.set(t,{overloadTime:Date.now(),waitingTime:n}),Gl.w("".concat(this._n,".onPushedServerOverload waitingTime:").concat(n,"s"))}},{key:"reset",value:function(){Gl.l("".concat(this._n,".reset")),this._updateCommandFrequencyLimitMap(pD),this._commandRequestInfoMap.clear(),this._serverOverloadInfoMap.clear()}}]),o}(vh),hD=function(e){u(n,e);var t=m(n);function n(e){var o;return r(this,n),(o=t.call(this,e))._n="MessageLossDetectionModule",o._maybeLostSequencesMap=new Map,o._firstRoundRet=[],o}return a(n,[{key:"onMessageMaybeLost",value:function(e,t,n){this._maybeLostSequencesMap.has(e)||this._maybeLostSequencesMap.set(e,[]);for(var o=this._maybeLostSequencesMap.get(e),r=0;r<n;r++)-1===o.indexOf(t+r)&&o.push(t+r)}},{key:"detectFirstRound",value:function(e,t){var n=this._maybeLostSequencesMap.get(e);if(!Yd(n)&&!Yd(t)){var o=n.filter((function(e){return-1===t.indexOf(e)}));0===o.length?Gl.i("".concat(this._n,".detectFirstRound no message loss. conversationID:").concat(e)):this._firstRoundRet=this._firstRoundRet.concat(o),n.length=0}}},{key:"detectSecondRound",value:function(e,t){if(!Yd(this._firstRoundRet)&&!Yd(t)){var n=this._firstRoundRet.filter((function(e){return-1===t.indexOf(e)}));this._firstRoundRet.length=0;var o,r=n.length;0!==r&&(r<=5?o=e+"-"+n.join("-"):(n.sort((function(e,t){return e-t})),o=e+" start:"+n[0]+" end:"+n[r-1]+" count:"+r),new w_("messageLoss").setMessage(o).setNetworkType(this.getNetworkType()).setLevel("warning").end(),Gl.i("".concat(this._n,".detectSecondRound message loss detected. conversationID:").concat(e," lostSequences:").concat(n)))}}},{key:"reset",value:function(){Gl.l("".concat(this._n,".reset")),this._maybeLostSequencesMap.clear(),this._firstRoundRet.length=0}}]),n}(vh),gD=function(e){u(n,e);var t=m(n);function n(e){var o;return r(this,n),(o=t.call(this,e))._n="CloudControlModule",o._cloudConfig=new Map,o._expiredTime=0,o._version=0,o._isFetching=!1,o}return a(n,[{key:"getCloudConfig",value:function(e){return id(e)?this._cloudConfig:this._cloudConfig.has(e)?this._cloudConfig.get(e):void 0}},{key:"_canFetchConfig",value:function(){return this.isLoggedIn()&&!this._isFetching&&Date.now()>=this._expiredTime}},{key:"fetchConfig",value:function(){var e=this,t=this._canFetchConfig();if(Gl.l("".concat(this._n,".fetchConfig canFetchConfig:").concat(t)),t){var n=new w_("fetchCloudControlConfig"),o=this.getModule(Yf).getSDKAppID();this._isFetching=!0,this.request({protocolName:vv,requestData:{SDKAppID:o,version:this._version}}).then((function(t){e._isFetching=!1,n.setMessage("version:".concat(e._version," newVersion:").concat(t.data.version," config:").concat(t.data.cloudControlConfig)).setNetworkType(e.getNetworkType()).end(),Gl.l("".concat(e._n,".fetchConfig ok")),e._parseCloudControlConfig(t.data)})).catch((function(t){e._isFetching=!1,e.probeNetwork().then((function(e){var o=_(e,2),r=o[0],i=o[1];n.setError(t,r,i).end()})),Gl.l("".concat(e._n,".fetchConfig failed. error:"),t),e._setExpiredTimeOnResponseError(12e4)}))}}},{key:"onPushedCloudControlConfig",value:function(e){Gl.l("".concat(this._n,".onPushedCloudControlConfig")),new w_("pushedCloudControlConfig").setNetworkType(this.getNetworkType()).setMessage("newVersion:".concat(e.version," config:").concat(e.cloudControlConfig)).end(),this._parseCloudControlConfig(e)}},{key:"onCheckTimer",value:function(e){this._canFetchConfig()&&this.fetchConfig()}},{key:"_parseCloudControlConfig",value:function(e){var t=this,n="".concat(this._n,"._parseCloudControlConfig"),o=e.errorCode,r=e.errorMessage,i=e.cloudControlConfig,a=e.version,s=e.expiredTime;if(0===o){if(this._version!==a){var u=null;try{u=JSON.parse(i)}catch(XD){this.isPrivateNetWork()||Gl.e("".concat(n," JSON parse error. cloudControlConfig:"),i)}u&&(this._cloudConfig.clear(),Object.keys(u).forEach((function(e){t._cloudConfig.set(e,u[e])})),this._version=a,this.emitInnerEvent(iC))}this._expiredTime=Date.now()+1e3*s}else id(o)?(Gl.l("".concat(n," failed. Invalid message format:"),e),this._setExpiredTimeOnResponseError(36e5)):(Gl.e("".concat(n," errorCode:").concat(o," errorMessage:").concat(r)),this._setExpiredTimeOnResponseError(12e4))}},{key:"_setExpiredTimeOnResponseError",value:function(e){this._expiredTime=Date.now()+e}},{key:"reset",value:function(){Gl.l("".concat(this._n,".reset")),this._cloudConfig.clear(),this._expiredTime=0,this._version=0,this._isFetching=!1}}]),n}(vh),vD=function(e){u(n,e);var t=m(n);function n(e){var o;return r(this,n),(o=t.call(this,e))._n="RecoverMessageModule",o.PULL_LIMIT_COUNT=15,o}return a(n,[{key:"start",value:function(){this._recoverGroupChat(),this._recoverC2CChat()}},{key:"_recoverGroupChat",value:function(){var e,t,n=this,o=this._getLocalConversationList().filter((function(e){return e.type===Ir.CONV_GROUP&&e.groupProfile.type!==Ir.GRP_AVCHATROOM})),r=this.getModule(Wf),i=0,a=0,s=0;o.forEach((function(o){var u=o.conversationID,c=o.lastMessage;t=u.replace(Ir.CONV_GROUP,""),e=r.getLocalLastMessage(u),c&&0!==c.lastSequence&&e?(a=c.lastSequence,i=e.sequence,s=a-i,i>0&&s>=1&&s<300?n._recoverGroupMessage({groupID:t,localLastMessageSequence:i,remoteLastMessageSequence:a}):n._getGroupNotify(t)):n._getGroupNotify(t)}))}},{key:"_recoverC2CChat",value:function(){var e,t=this,n=this._getLocalConversationList().filter((function(e){return e.type===Ir.CONV_C2C})),o=this.getModule(Wf),r=0,i=0,a=0,s=[Promise.resolve()];n.forEach((function(n){var u=n.conversationID,c=n.lastMessage;e=o.getLocalLastMessage(u),c&&0!==c.lastTime&&e&&(i=c.lastTime,r=e.time,a=i-r,r>0&&a>=1&&a<=600&&s.push(t._recoverC2CMessage({conversationID:u,localLastMessageTime:r,remoteLastMessageTime:i})))})),Promise.all(s).then((function(){Gl.l("".concat(t._n,"._recoverC2CChat all promise fulfilled, start to sync unread messages")),t.getModule(nh).startSyncOnReconnected()}))}},{key:"_getLocalConversationList",value:function(){return this.getModule(Wf).getLocalConversationList()}},{key:"_recoverGroupMessage",value:function(e){var t=this,n="".concat(this._n,"._recoverGroupMessage");Gl.l("".concat(n," options:"),e);var o=e.groupID,r=e.localLastMessageSequence,i=e.remoteLastMessageSequence;this._getGroupRomaingMessage({groupID:o,sequence:r}).then((function(e){var r=e.data,a=r.complete,s=r.messageList;if(!id(s)){var u=s[0].sequence;Gl.l("".concat(n," pkgLastMessageSequence:").concat(u," complete:").concat(a)),u<i&&2!==a&&t._recoverGroupMessage({groupID:o,localLastMessageSequence:u,remoteLastMessageSequence:i}),new w_("recoverMessage").setNetworkType(t.getNetworkType()).setMessage("groupID:".concat(o," complete:").concat(a," messageList length:").concat(s.length)).end(),t.getModule(Kf).onNewGroupMessage({dataList:s,isInstantMessage:!1,updateUnreadCount:!1}),t._getGroupNotify(o)}}))}},{key:"_getGroupNotify",value:function(e){this.getModule(Kf).getGroupNotify(e)}},{key:"_getGroupRomaingMessage",value:function(e){var t=e.groupID,n=e.sequence;return this.request({protocolName:Ag,requestData:{groupID:t,count:this.PULL_LIMIT_COUNT,sequence:n+this.PULL_LIMIT_COUNT-1}})}},{key:"_recoverC2CMessage",value:function(e){var t=this,n="".concat(this._n,"._recoverC2CMessage");Gl.l("".concat(this._n,"._recoverC2CMessage options:"),e);var o=e.conversationID,r=e.localLastMessageTime,i=e.remoteLastMessageTime;return this._getC2CRoamingMessage({conversationID:o,time:r}).then((function(e){var r=e.data,a=r.complete,s=r.messageList;if(!id(s)){new w_("recoverMessage").setNetworkType(t.getNetworkType()).setMessage("".concat(o," complete:").concat(a," messageList length:").concat(u)).end(),t.getModule(Hf).onNewC2CMessage({dataList:s,isInstantMessage:!0});var u=s.length,c=s[u-1].time;if(Gl.l("".concat(n," pkgLastMessageTime:").concat(c," complete:").concat(a)),c<i&&1!==a)return t._recoverC2CMessage({conversationID:o,localLastMessageTime:c,remoteLastMessageTime:i})}}))}},{key:"_getC2CRoamingMessage",value:function(e){var t=e.conversationID,n=e.time;return this.request({protocolName:Wh,requestData:{peerAccount:t.replace(Ir.CONV_C2C,""),count:this.PULL_LIMIT_COUNT+1,lastMessageTime:n,direction:1}})}},{key:"reset",value:function(){Gl.l("".concat(this._n,".reset"))}}]),n}(vh),mD=function(){function e(){r(this,e),this._n="AvgE2EDelay",this._e2eDelayArray=[]}return a(e,[{key:"addMessageDelay",value:function(e){var t=wl()-e;t>=0&&this._e2eDelayArray.push(t)}},{key:"_calcAvg",value:function(e,t){if(0===t)return 0;var n=0;return e.forEach((function(e){n+=e})),Fd(n/t,1)}},{key:"_calcCountWithLimit",value:function(e){var t=e.e2eDelayArray,n=e.min,o=e.max;return t.filter((function(e){return n<=e&&e<o})).length}},{key:"_calcPercent",value:function(e,t){var n=Fd(e/t*100,2);return n>100&&(n=100),n}},{key:"_checkE2EDelayException",value:function(e,t){var n=e.filter((function(e){return e>t}));if(n.length>0){var o=n.length,r=Math.min.apply(Math,y(n)),i=Math.max.apply(Math,y(n)),a=this._calcAvg(n,o),s=Fd(o/e.length*100,2);s>50&&new w_("messageE2EDelayException").setMessage("count:".concat(o," min:").concat(r," max:").concat(i," avg:").concat(a," percent:").concat(s)).setLevel("warning").end()}}},{key:"getStatResult",value:function(){var e=this._e2eDelayArray.length;if(0===e)return null;var t=y(this._e2eDelayArray),n=this._calcCountWithLimit({e2eDelayArray:t,min:0,max:1}),o=this._calcCountWithLimit({e2eDelayArray:t,min:1,max:3}),r=this._calcPercent(n,e),i=this._calcPercent(o,e),a=this._calcAvg(t,e);return this._checkE2EDelayException(t,3),t.length=0,this.reset(),{totalCount:e,countLessThan1Second:n,percentOfCountLessThan1Second:r,countLessThan3Second:o,percentOfCountLessThan3Second:i,avgDelay:a}}},{key:"reset",value:function(){this._e2eDelayArray.length=0}}]),e}(),_D=function(){function e(){r(this,e),this._n="AvgRTT",this._requestCount=0,this._rttArray=[]}return a(e,[{key:"addRequestCount",value:function(){this._requestCount+=1}},{key:"addRTT",value:function(e){this._rttArray.push(e)}},{key:"_calcTotalCount",value:function(){return this._requestCount}},{key:"_calcRTTCount",value:function(e){return e.length}},{key:"_calcSuccessRateOfRequest",value:function(e,t){if(0===t)return 0;var n=Fd(e/t*100,2);return n>100&&(n=100),n}},{key:"_calcAvg",value:function(e,t){if(0===t)return 0;var n=0;return e.forEach((function(e){n+=e})),parseInt(n/t)}},{key:"_calcMax",value:function(){return Math.max.apply(Math,y(this._rttArray))}},{key:"_calcMin",value:function(){return Math.min.apply(Math,y(this._rttArray))}},{key:"getStatResult",value:function(){var e=this._calcTotalCount(),t=y(this._rttArray);if(0===e)return null;var n=this._calcRTTCount(t),o=this._calcSuccessRateOfRequest(n,e),r=this._calcAvg(t,n);return Gl.l("".concat(this._n,".getStatResult max:").concat(this._calcMax()," min:").concat(this._calcMin()," avg:").concat(r)),this.reset(),{totalCount:e,rttCount:n,successRateOfRequest:o,avgRTT:r}}},{key:"reset",value:function(){this._requestCount=0,this._rttArray.length=0}}]),e}(),yD=function(){function e(){r(this,e),this._map=new Map}return a(e,[{key:"initMap",value:function(e){var t=this;e.forEach((function(e){t._map.set(e,{totalCount:0,successCount:0,failedCountOfUserSide:0,costArray:[],fileSizeArray:[]})}))}},{key:"addTotalCount",value:function(e){return!(id(e)||!this._map.has(e))&&(this._map.get(e).totalCount+=1,!0)}},{key:"addSuccessCount",value:function(e){return!(id(e)||!this._map.has(e))&&(this._map.get(e).successCount+=1,!0)}},{key:"addFailedCountOfUserSide",value:function(e){return!(id(e)||!this._map.has(e))&&(this._map.get(e).failedCountOfUserSide+=1,!0)}},{key:"addCost",value:function(e,t){return!(id(e)||!this._map.has(e))&&(this._map.get(e).costArray.push(t),!0)}},{key:"addFileSize",value:function(e,t){return!(id(e)||!this._map.has(e))&&(this._map.get(e).fileSizeArray.push(t),!0)}},{key:"_calcSuccessRateOfBusiness",value:function(e){if(id(e)||!this._map.has(e))return-1;var t=this._map.get(e),n=Fd(t.successCount/t.totalCount*100,2);return n>100&&(n=100),n}},{key:"_calcSuccessRateOfPlatform",value:function(e){if(id(e)||!this._map.has(e))return-1;var t=this._map.get(e),n=this._calcSuccessCountOfPlatform(e)/t.totalCount*100;return(n=Fd(n,2))>100&&(n=100),n}},{key:"_calcTotalCount",value:function(e){return id(e)||!this._map.has(e)?-1:this._map.get(e).totalCount}},{key:"_calcSuccessCountOfBusiness",value:function(e){return id(e)||!this._map.has(e)?-1:this._map.get(e).successCount}},{key:"_calcSuccessCountOfPlatform",value:function(e){if(id(e)||!this._map.has(e))return-1;var t=this._map.get(e);return t.successCount+t.failedCountOfUserSide}},{key:"_calcAvg",value:function(e){return id(e)||!this._map.has(e)?-1:e===T_?this._calcAvgSpeed(e):this._calcAvgCost(e)}},{key:"_calcAvgCost",value:function(e){var t=this._map.get(e).costArray.length;if(0===t)return 0;var n=0;return this._map.get(e).costArray.forEach((function(e){n+=e})),parseInt(n/t)}},{key:"_calcAvgSpeed",value:function(e){var t=0,n=0;return this._map.get(e).costArray.forEach((function(e){t+=e})),this._map.get(e).fileSizeArray.forEach((function(e){n+=e})),parseInt(1e3*n/t)}},{key:"getStatResult",value:function(e){var t=this._calcTotalCount(e);if(0===t)return null;var n=this._calcSuccessCountOfBusiness(e),o=this._calcSuccessRateOfBusiness(e),r=this._calcSuccessCountOfPlatform(e),i=this._calcSuccessRateOfPlatform(e),a=this._calcAvg(e);return this.reset(e),{totalCount:t,successCountOfBusiness:n,successRateOfBusiness:o,successCountOfPlatform:r,successRateOfPlatform:i,avgValue:a}}},{key:"reset",value:function(e){id(e)?this._map.clear():this._map.set(e,{totalCount:0,successCount:0,failedCountOfUserSide:0,costArray:[],fileSizeArray:[]})}}]),e}(),MD=function(){function e(){r(this,e),this._lastMap=new Map,this._currentMap=new Map}return a(e,[{key:"initMap",value:function(e){var t=this;e.forEach((function(e){t._lastMap.set(e,new Map),t._currentMap.set(e,new Map)}))}},{key:"addMessageSequence",value:function(e){var t=e.key,n=e.message;if(id(t)||!this._lastMap.has(t)||!this._currentMap.has(t))return!1;var o=n.conversationID,r=n.sequence,i=o.replace(Ir.CONV_GROUP,"");if(0===this._lastMap.get(t).size)this._addCurrentMap(e);else if(this._lastMap.get(t).has(i)){var a=this._lastMap.get(t).get(i),s=a.length-1;r>a[0]&&r<a[s]?(a.push(r),a.sort(),this._lastMap.get(t).set(i,a)):this._addCurrentMap(e)}else this._addCurrentMap(e);return!0}},{key:"_addCurrentMap",value:function(e){var t=e.key,n=e.message,o=n.conversationID,r=n.sequence,i=o.replace(Ir.CONV_GROUP,"");this._currentMap.get(t).has(i)||this._currentMap.get(t).set(i,[]),this._currentMap.get(t).get(i).push(r)}},{key:"_copyData",value:function(e){if(!id(e)){this._lastMap.set(e,new Map);var t,n=this._lastMap.get(e),o=S(this._currentMap.get(e));try{for(o.s();!(t=o.n()).done;){var r=_(t.value,2),i=r[0],a=r[1];n.set(i,a)}}catch(u){o.e(u)}finally{o.f()}n=null,this._currentMap.set(e,new Map)}}},{key:"getStatResult",value:function(e){if(id(this._currentMap.get(e))||id(this._lastMap.get(e)))return null;if(0===this._lastMap.get(e).size)return this._copyData(e),null;var t=0,n=0;if(this._lastMap.get(e).forEach((function(e,o){var r=y(e.values()),i=r.length,a=r[i-1]-r[0]+1;t+=a,n+=i})),0===t)return null;var o=Fd(n/t*100,2);return o>100&&(o=100),this._copyData(e),{totalCount:t,successCountOfMessageReceived:n,successRateOfMessageReceived:o}}},{key:"reset",value:function(){this._currentMap.clear(),this._lastMap.clear()}}]),e}(),ID=function(e){u(o,e);var n=m(o);function o(e){var t;r(this,o),(t=n.call(this,e))._n="QualityStatModule",t.TAG="im-ssolog-quality-stat",t.reportIndex=0,t.wholePeriod=!1,t._qualityItems=[__,y_,M_,I_,C_,k_,T_,S_,b_,D_],t._messageSentItems=[M_,I_,C_,k_,T_],t._messageReceivedItems=[S_,b_,D_],t.REPORT_INTERVAL=120,t.REPORT_SDKAPPID_BLACKLIST=[],t.REPORT_TINYID_WHITELIST=[],t._statInfoArr=[],t._avgRTT=new _D,t._avgE2EDelay=new mD,t._rateMessageSent=new yD,t._rateMessageReceived=new MD;var i=t.getInnerEmitterInstance();return i.on(rC,t._onLoginSuccess,g(t)),i.on(iC,t._onCloudConfigUpdated,g(t)),t}return a(o,[{key:"_onLoginSuccess",value:function(){var e=this;this._rateMessageSent.initMap(this._messageSentItems),this._rateMessageReceived.initMap(this._messageReceivedItems);var t=this.getModule(Jf),n=t.getItem(this.TAG,!1);!Yd(n)&&sd(n.forEach)&&(Gl.l("".concat(this._n,"._onLoginSuccess get quality stat logs from local storage, count:").concat(n.length)),n.forEach((function(t){e._statInfoArr.push(t)})),t.removeItem(this.TAG,!1))}},{key:"_onCloudConfigUpdated",value:function(){var e=this.getCloudConfig("q_rpt_interval"),t=this.getCloudConfig("q_rpt_sdkappid_bl"),n=this.getCloudConfig("q_rpt_tinyid_wl");id(e)||(this.REPORT_INTERVAL=Number(e)),id(t)||(this.REPORT_SDKAPPID_BLACKLIST=t.split(",").map((function(e){return Number(e)}))),id(n)||(this.REPORT_TINYID_WHITELIST=n.split(","))}},{key:"onCheckTimer",value:function(e){this.isLoggedIn()&&e%this.REPORT_INTERVAL==0&&(this.wholePeriod=!0,this._report())}},{key:"addRequestCount",value:function(){this._avgRTT.addRequestCount()}},{key:"addRTT",value:function(e){this._avgRTT.addRTT(e)}},{key:"addMessageDelay",value:function(e){this._avgE2EDelay.addMessageDelay(e)}},{key:"addTotalCount",value:function(e){this._rateMessageSent.addTotalCount(e)||Gl.w("".concat(this._n,".addTotalCount invalid key:"),e)}},{key:"addSuccessCount",value:function(e){this._rateMessageSent.addSuccessCount(e)||Gl.w("".concat(this._n,".addSuccessCount invalid key:"),e)}},{key:"addFailedCountOfUserSide",value:function(e){this._rateMessageSent.addFailedCountOfUserSide(e)||Gl.w("".concat(this._n,".addFailedCountOfUserSide invalid key:"),e)}},{key:"addCost",value:function(e,t){this._rateMessageSent.addCost(e,t)||Gl.w("".concat(this._n,".addCost invalid key or cost:"),e,t)}},{key:"addFileSize",value:function(e,t){this._rateMessageSent.addFileSize(e,t)||Gl.w("".concat(this._n,".addFileSize invalid key or size:"),e,t)}},{key:"addMessageSequence",value:function(e){this._rateMessageReceived.addMessageSequence(e)||Gl.w("".concat(this._n,".addMessageSequence invalid key:"),e.key)}},{key:"_getQualityItem",value:function(e){var n={},o=L_[this.getNetworkType()];id(o)&&(o=8);var r={qualityType:E_[e],timestamp:Ll(),networkType:o,extension:""};switch(e){case __:n=this._avgRTT.getStatResult();break;case y_:n=this._avgE2EDelay.getStatResult();break;case M_:case I_:case C_:case k_:case T_:n=this._rateMessageSent.getStatResult(e);break;case S_:case b_:case D_:n=this._rateMessageReceived.getStatResult(e)}return null===n?null:t(t({},r),n)}},{key:"_report",value:function(e){var t=this,n=[],o=null;id(e)?this._qualityItems.forEach((function(e){null!==(o=t._getQualityItem(e))&&(o.reportIndex=t.reportIndex,o.wholePeriod=t.wholePeriod,n.push(o))})):null!==(o=this._getQualityItem(e))&&(o.reportIndex=this.reportIndex,o.wholePeriod=this.wholePeriod,n.push(o)),Gl.d("".concat(this._n,"._report"),n),this._statInfoArr.length>0&&(n=n.concat(this._statInfoArr),this._statInfoArr=[]);var r=this.getModule(Yf),i=r.getSDKAppID(),a=r.getTinyID();qd(this.REPORT_SDKAPPID_BLACKLIST,i)&&!Bd(this.REPORT_TINYID_WHITELIST,a)&&(n=[]),n.length>0&&this._doReport(n)}},{key:"_doReport",value:function(e){var n=this,o={header:pk(this),quality:e};this.request({protocolName:uv,requestData:t({},o)}).then((function(){n.reportIndex++,n.wholePeriod=!1})).catch((function(t){Gl.w("".concat(n._n,"._doReport, online:").concat(n.getNetworkType()," error:"),t),n._statInfoArr=n._statInfoArr.concat(e),n._flushAtOnce()}))}},{key:"_flushAtOnce",value:function(){var e=this.getModule(Jf),t=e.getItem(this.TAG,!1),n=this._statInfoArr,o="".concat(this._n,"._flushAtOnce");if(Yd(t))Gl.l("".concat(o," count:").concat(n.length)),e.setItem(this.TAG,n,!0,!1);else{var r=n.concat(t);r.length>10&&(r=r.slice(0,10)),Gl.l("".concat(o," count:").concat(r.length)),e.setItem(this.TAG,r,!0,!1)}this._statInfoArr=[]}},{key:"reset",value:function(){Gl.l("".concat(this._n,".reset")),this._report(),this.reportIndex=0,this.wholePeriod=!1,this.REPORT_SDKAPPID_BLACKLIST=[],this.REPORT_TINYID_WHITELIST=[],this._avgRTT.reset(),this._avgE2EDelay.reset(),this._rateMessageSent.reset(),this._rateMessageReceived.reset()}}]),o}(vh),CD=a((function e(t){r(this,e),Yd(t)||(this.userID=t.userID||"",this.nick=t.nick||"",this.avatar=t.avatar||"",this.time=t.time||0,this.source=t.source||"",this.wording=t.wording||"",this.type=t.type||"")})),kD=function(){function e(t){r(this,e),this._snsModule=t,this._n="FriendApplicationHandler",this._startTime=0,this._maxLimited=100,this._currentSequence=0,this._friendApplicationMap=new Map,this._unreadCount=0}return a(e,[{key:"getLocalFriendApplicationList",value:function(){return{friendApplicationList:y(this._friendApplicationMap.values()),unreadCount:this._unreadCount}}},{key:"_onFriendApplicationListUpdated",value:function(){this._snsModule.emitOuterEvent(Mr.FRIEND_APPLICATION_LIST_UPDATED,{friendApplicationList:y(this._friendApplicationMap.values()),unreadCount:this._unreadCount})}},{key:"onFriendApplicationRead",value:function(){this._unreadCount=0,this._onFriendApplicationListUpdated()}},{key:"onFriendApplicationAdded",value:function(e,n){var o=this;if(!Yd(e)){var r="";r=n===this._snsModule.getMyUserID()?Ir.SNS_APPLICATION_SENT_BY_ME:Ir.SNS_APPLICATION_SENT_TO_ME;var i=!1;e.forEach((function(e){var n="".concat(e.userID,"_").concat(r);r!==Ir.SNS_APPLICATION_SENT_TO_ME||o._friendApplicationMap.has(n)||(o._unreadCount+=1),o._friendApplicationMap.set(n,new CD(t(t({},e),{},{type:r}))),i=!0})),i&&this._onFriendApplicationListUpdated()}}},{key:"onFriendApplicationDeleted",value:function(e){Yd(e)||this.getFriendApplicationList()}},{key:"getFriendApplicationList",value:function(){var e=this,t="".concat(this._n,".").concat("getFriendApplicationList"),n=new w_("getFriendApplicationList");return this._snsModule.request({protocolName:Uh,requestData:{applicationType:Ir.SNS_APPLICATION_TYPE_BOTH,fromAccount:this._snsModule.getMyUserID(),maxLimited:this._maxLimited,startTime:this._startTime,lastSequence:this._currentSequence}}).then((function(o){var r=o.data,i=r.resultList,a=r.unreadCount,s=r.startTime,u=r.currentSequence;e._startTime=s,e._currentSequence=u,e._unreadCount=a;var c=rd(i)?i.length:0;n.setNetworkType(e._snsModule.getNetworkType()).setMessage("applicationCount:".concat(c," unreadCount:").concat(a)).end(),Gl.i("".concat(t," ok. applicationCount:").concat(c," unreadCount:").concat(a)),e._friendApplicationMap.clear(),rd(i)&&i.forEach((function(t){var n=t.userID,o=t.type,r=new CD(t);e._friendApplicationMap.set("".concat(n,"_").concat(o),r)})),e._onFriendApplicationListUpdated()})).catch((function(o){return e._snsModule.probeNetwork().then((function(e){var t=_(e,2),r=t[0],i=t[1];n.setError(o,r,i).end()})),Gl.w("".concat(t," failed. error:"),o),BI(o)}))}},{key:"deleteFriendApplication",value:function(e){var t=this,n="".concat(this._n,".").concat("deleteFriendApplication"),o=e.userID,r=e.type;if((!r||r!==Ir.SNS_APPLICATION_SENT_BY_ME&&r!==Ir.SNS_APPLICATION_SENT_TO_ME)&&(r=Ir.SNS_APPLICATION_SENT_TO_ME),!this._friendApplicationMap.has("".concat(o,"_").concat(r)))return BI({code:jm});var i=new w_("deleteFriendApplication");return i.setMessage("userID:".concat(o," type:").concat(r)),this._snsModule.request({protocolName:xh,requestData:{fromAccount:this._snsModule.getMyUserID(),userIDList:[o],type:r}}).then((function(e){var a=e.data.resultList,s=a[0],u=s.to,c=s.resultCode,l=s.resultInfo;return i.setNetworkType(t._snsModule.getNetworkType()).setMoreMessage("resultList:".concat(JSON.stringify(a))).end(),Gl.i("".concat(n," ok. userID:").concat(o," type:").concat(r)),0===c?GI():BI({userID:u,code:c,message:l})})).catch((function(e){return t._snsModule.probeNetwork().then((function(t){var n=_(t,2),o=n[0],r=n[1];i.setError(e,o,r).end()})),Gl.w("".concat(n," failed. error:"),e),BI(e)}))}},{key:"acceptFriendApplication",value:function(e){var t=this,n="".concat(this._n,".").concat("acceptFriendApplication"),o=e.userID,r=e.remark,i=e.tag,a=e.type;(!a||a!==Ir.SNS_APPLICATION_AGREE&&a!==Ir.SNS_APPLICATION_AGREE_AND_ADD)&&(a=Ir.SNS_APPLICATION_AGREE_AND_ADD);var s=new w_("acceptFriendApplication");return s.setMessage("userID:".concat(o," type:").concat(a)),this._snsModule.request({protocolName:Gh,requestData:{fromAccount:this._snsModule.getMyUserID(),responseFriendItem:[{userID:o,remark:r,tag:i,action:a}]}}).then((function(e){s.setNetworkType(t._snsModule.getNetworkType()).end();var r=e.data.resultList[0],i=r.resultCode,u=r.resultInfo;if(0!==i)return BI({code:i,message:u});Gl.i("".concat(n," ok. userID:").concat(o," type:").concat(a))})).catch((function(e){return t._snsModule.probeNetwork().then((function(t){var n=_(t,2),o=n[0],r=n[1];s.setError(e,o,r).end()})),Gl.w("".concat(n," failed. error:"),e),BI(e)}))}},{key:"refuseFriendApplication",value:function(e){var t=this,n="".concat(this._n,".").concat("refuseFriendApplication"),o=e.userID,r=new w_("refuseFriendApplication");return r.setMessage("userID:".concat(o)),this._snsModule.request({protocolName:Gh,requestData:{fromAccount:this._snsModule.getMyUserID(),responseFriendItem:[{userID:o,action:"Response_Action_Reject"}]}}).then((function(e){r.setNetworkType(t._snsModule.getNetworkType()).end();var i=e.data.resultList[0],a=i.resultCode,s=i.resultInfo;if(0!==a)return BI({code:a,message:s});Gl.i("".concat(n," ok. userID:").concat(o))})).catch((function(e){return t._snsModule.probeNetwork().then((function(t){var n=_(t,2),o=n[0],i=n[1];r.setError(e,o,i).end()})),Gl.w("".concat(n," failed. error:"),e),BI(e)}))}},{key:"_onFriendApplicationProcessed",value:function(e){var t=this;if(0!==e.length){var n=!1;e.forEach((function(e){var o="".concat(e.to,"_").concat(Ir.SNS_APPLICATION_SENT_TO_ME);t._friendApplicationMap.has(o)&&(t._friendApplicationMap.delete(o),t._unreadCount-=1,n=!0)})),this._unreadCount<0&&(this._unreadCount=0),n&&this._onFriendApplicationListUpdated()}}},{key:"setFriendApplicationRead",value:function(){var e=this,t="".concat(this._n,".").concat("setFriendApplicationRead"),n=new w_("setFriendApplicationRead");return this._snsModule.request({protocolName:Fh,requestData:{fromAccount:this._snsModule.getMyUserID(),latestTimeStamp:Fd(Ll()/1e3,0)}}).then((function(o){n.setNetworkType(e._snsModule.getNetworkType()).end(),Gl.i("".concat(t," ok")),e._unreadCount=0})).catch((function(o){return e._snsModule.probeNetwork().then((function(e){var t=_(e,2),r=t[0],i=t[1];n.setError(o,r,i).end()})),Gl.w("".concat(t," failed. error:"),o),BI(o)}))}},{key:"reset",value:function(){this._startIndex=0,this._maxLimited=100,this._currentSequence=0,this._unreadCount=0,this._friendApplicationMap.clear()}}]),e}(),TD=function(){function e(n,o){r(this,e),this.userID=n,this.remark="",this.groupList=[],this.source="",this.addTime=0,this.friendCustomField=[],this.timestamp=0;var i={},a=[];if(i.userID=n,!Yd(o))for(var s="",u="",c=0,l=o.length;c<l;c++)if(s=o[c].tag,u=o[c].value,s.indexOf("Tag_SNS_Custom")>-1)this.friendCustomField.push({key:s,value:u});else if(s.indexOf("Tag_Profile_Custom")>-1)a.push({key:s,value:u});else switch(s){case xl.NICK:i.nick=u;break;case xl.GENDER:i.gender=u;break;case xl.BIRTHDAY:i.birthday=u;break;case xl.LOCATION:i.location=u;break;case xl.SELFSIGNATURE:i.selfSignature=u;break;case xl.ALLOWTYPE:i.allowType=u;break;case xl.LANGUAGE:i.language=u;break;case xl.AVATAR:i.avatar=u;break;case xl.MESSAGESETTINGS:i.messageSettings=u;break;case xl.ADMINFORBIDTYPE:i.adminForbidType=u;break;case xl.LEVEL:i.level=u;break;case xl.ROLE:i.role=u;break;case ql:this.remark=u;break;case Hl:this.addTime=u;break;case Fl:this.groupList=JSON.parse(JSON.stringify(u));break;case Bl:this.source=u;break;case Vl:break;default:Gl.l("snsProfileItem unknown tag->",o[c].tag)}this.profile=new hC(t(t({},i),{},{profileCustomField:a}))}return a(e,[{key:"validate",value:function(e){var t=!0,n="";if(Yd(e))return{valid:!1,tips:"empty options"};if(e.profileCustomField)for(var o=e.profileCustomField.length,r=null,i=0;i<o;i++){if(r=e.profileCustomField[i],!td(r.key)||-1===r.key.indexOf("Tag_Profile_Custom"))return{valid:!1,tips:"The prefix of keys of the custom profile key-value pairs (which is profileCustomField) must be Tag_Profile_Custom"};if(!td(r.value))return{valid:!1,tips:"The type of values of the custom profile key-value pairs (which is profileCustomField) must be String"}}for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){if("profileCustomField"===a)continue;if(Yd(e[a])&&!td(e[a])&&!ed(e[a])){n="key:"+a+", invalid value:"+e[a],t=!1;continue}switch(a){case"nick":td(e[a])||(n="nick must be a string",t=!1),gd(e[a])>500&&(n="nick name limited: must less than or equal to ".concat(500," bytes, current size: ").concat(gd(e[a])," bytes"),t=!1);break;case"gender":yd(Kl,e.gender)||(n="key:gender, invalid value:"+e.gender,t=!1);break;case"birthday":ed(e.birthday)||(n="birthday must be a number",t=!1);break;case"location":td(e.location)||(n="location must be a string",t=!1);break;case"selfSignature":td(e.selfSignature)||(n="selfSignature must be a string",t=!1);break;case"allowType":yd(zl,e.allowType)||(n="key:allowType, invalid value:"+e.allowType,t=!1);break;case"language":ed(e.language)||(n="language must be a number",t=!1);break;case"avatar":td(e.avatar)||(n="avatar must be a string",t=!1);break;case"messageSettings":0!==e.messageSettings&&1!==e.messageSettings&&(n="messageSettings must be 0 or 1",t=!1);break;case"adminForbidType":yd(jl,e.adminForbidType)||(n="key:adminForbidType, invalid value:"+e.adminForbidType,t=!1);break;case"level":ed(e.level)||(n="level must be a number",t=!1);break;case"role":ed(e.role)||(n="role must be a number",t=!1);break;default:n="unknown key:"+a+"  "+e[a],t=!1}}return{valid:t,tips:n}}},{key:"update",value:function(e){var t="",n="",o=[];this.friendCustomField.forEach((function(e){o.push(e.key)}));for(var r=0,i=e.length;r<i;r++)if(t=e[r].tag,n=e[r].value,t.indexOf("Tag_SNS_Custom")>-1)o.indexOf(t)>-1?this.friendCustomField.forEach((function(e){e.key===t&&(e.value=n)})):this.friendCustomField.push({key:t,value:n});else if(t.indexOf("Tag_Profile_Custom")>-1){var a=!1;this.profile.profileCustomField.forEach((function(e){e.key===t&&(e.value=n,a=!0)})),a||this.profile.profileCustomField.push({key:t,value:n})}else switch(t){case xl.NICK:this.profile.nick=n;break;case xl.GENDER:this.profile.gender=n;break;case xl.BIRTHDAY:this.profile.birthday=n;break;case xl.LOCATION:this.profile.location=n;break;case xl.SELFSIGNATURE:this.profile.selfSignature=n;break;case xl.ALLOWTYPE:this.profile.allowType=n;break;case xl.LANGUAGE:this.profile.language=n;break;case xl.AVATAR:this.profile.avatar=n;break;case xl.MESSAGESETTINGS:this.profile.messageSettings=n;break;case xl.ADMINFORBIDTYPE:this.profile.adminForbidType=n;break;case xl.LEVEL:this.profile.level=n;break;case xl.ROLE:this.profile.role=n;break;case ql:this.remark=n;break;case Hl:this.addTime=n;break;case Fl:this.groupList=JSON.parse(JSON.stringify(n));break;case Bl:this.source=n;break;case Vl:break;default:Gl.d("snsProfileItem unkown tag->",e[r].tag)}this.timestamp=Date.now(),o.length=0}},{key:"updateProfile",value:function(e){this.profile=JSON.parse(JSON.stringify(e)),this.timestamp=Date.now()}},{key:"addToGroupList",value:function(e){-1===this.groupList.indexOf(e)&&(this.groupList.push(e),this.count=this.groupList.length)}},{key:"removeFromGroupList",value:function(e){var t=this.groupList.indexOf(e);t>-1&&(this.groupList.splice(t,1),this.count=this.groupList.length)}}]),e}(),SD=function(){function e(t){r(this,e),this._snsModule=t,this._n="FriendHandler",this._friendMap=new Map,this._startIndex=0,this._standardSequence=0,this._customSequence=0,this._expirationTime=18e4}return a(e,[{key:"getLocalFriendList",value:function(){return y(this._friendMap.values())}},{key:"getFriendRemark",value:function(e){return this._friendMap.has(e)?this._friendMap.get(e).remark:""}},{key:"onFriendProfileModified",value:function(e){var t=this,n=e.dataList;if(!Yd(n)){var o=this._snsModule.getModule(Wf);n.forEach((function(e){var n=e.userID,r=e.profileList;if(t.isMyFriend(n)){Gl.l("".concat(t._n,".onFriendProfileModified. friend account:").concat(n,", profileList:").concat(JSON.stringify(r)));var i=t._friendMap.get(n);i.update(r),o.modifyMessageSentByPeer({conversationID:"".concat(Ir.CONV_C2C).concat(n),latestNick:i.profile.nick,latestAvatar:i.profile.avatar})}})),this._onFriendListUpdated()}}},{key:"onFriendAdded",value:function(e){var t=this;0!==e.length&&(Gl.l("".concat(this._n,".onFriendAdded userIDList:").concat(e)),e.forEach((function(e){t._friendMap.set(e,new TD(e))})),this.getFriendProfile({userIDList:e}).then((function(n){e.forEach((function(e){var n=t._friendMap.get(e);n.groupList.length>0&&t._snsModule.updateWhenFriendAdded({nameList:n.groupList,userID:e})})),t._onFriendListUpdated()})))}},{key:"onFriendDeleted",value:function(e){var t=this;0!==e.length&&(Gl.l("".concat(this._n,".onFriendDeleted userIDList:").concat(e)),e.forEach((function(e){var n=t._friendMap.get(e);n.groupList.length>0&&t._snsModule.updateWhenFriendDeleted({nameList:n.groupList,userID:e}),t._friendMap.delete(e)})),this._onFriendListUpdated())}},{key:"_onFriendListUpdated",value:function(){this._snsModule.emitOuterEvent(Mr.FRIEND_LIST_UPDATED),this._snsModule.getModule(Wf).checkAndPatchRemark()}},{key:"getFriendProfile",value:function(e){var t=this,n="".concat(this._n,".").concat("getFriendProfile"),o=e.userIDList,r=[],i=[],a=[];if(o.forEach((function(e){if(t._friendMap.has(e)){var n=t._friendMap.get(e);Date.now()-n.timestamp<t._expirationTime?i.push(n):a.push(e)}else r.push({userID:e,code:Bm,message:t._snsModule.getErrorMessage(Bm)})})),0===a.length)return Gl.i("".concat(n," newUserIDList is empty")),qI({friendList:i,failureUserIDList:r});var s=new w_("getFriendProfile");return s.setMessage("userIDList:".concat(a)),Gl.i("".concat(n," userIDList:").concat(a)),this._snsModule.request({protocolName:Rh,requestData:{fromAccount:this._snsModule.getMyUserID(),userIDList:a}}).then((function(e){return s.setNetworkType(t._snsModule.getNetworkType()).end(),Gl.i("".concat(n," ok")),e.data.resultList.forEach((function(e){var n,o=e.to,a=e.resultCode,s=e.resultInfo,u=e.tagValueList;id(a)||0===a?(t._friendMap.has(o)?(n=t._friendMap.get(o)).update(u):(n=new TD(o,u),t._friendMap.set(o,n)),i.push(n)):r.push({userID:o,code:a,message:s})})),GI({friendList:i,failureUserIDList:r})})).catch((function(e){return t._snsModule.probeNetwork().then((function(t){var n=_(t,2),o=n[0],r=n[1];s.setError(e,o,r).end()})),Gl.w("".concat(n," failed. error:"),e),BI(e)}))}},{key:"isMyFriend",value:function(e){return this._friendMap.has(e)}},{key:"pagingGetFriendList",value:function(){var e=this,t="".concat(this._n,".").concat("getFriendList"),n=new w_("getFriendList"),o=Date.now();this._snsModule.request({protocolName:Lh,requestData:{fromAccount:this._snsModule.getMyUserID(),startIndex:this._startIndex,standardSequence:this._standardSequence,customSequence:this._customSequence}}).then((function(r){var i=r.data,a=i.friendCount,s=i.resultList,u=i.nextStartIndex,c=i.standardSequence,l=i.customSequence,d=i.completeFlag;e._startIndex=u,e._standardSequence=c,e._customSequence=l;var p=Date.now()-o,f="friendCount:".concat(a," nextStartIndex:").concat(u," standardSequence:").concat(c," ")+"customSequence:".concat(l," completeFlag:").concat(d," cost ").concat(p," ms");n.setNetworkType(e._snsModule.getNetworkType()).setMessage(f).end(),Gl.i("".concat(t," ok."),f),Yd(s)||s.forEach((function(t){var n=t.to,o=t.tagValueList;e._friendMap.set(n,new TD(n,o))})),0===d?e.pagingGetFriendList():(e._snsModule.emitOuterEvent(Mr.FRIEND_LIST_UPDATED),e._pagingGetFriendProfile())})).catch((function(o){return e._snsModule.probeNetwork().then((function(e){var t=_(e,2),r=t[0],i=t[1];n.setError(o,r,i).end()})),Gl.w("".concat(t," failed. error:"),o),BI(o)}))}},{key:"_pagingGetFriendProfile",value:function(){var e=this,t=y(this._friendMap.keys()),n=this._snsModule.getModule(Vf),o=t.length,r=o<=100?1:Math.ceil(o/100);Gl.l("".concat(this._n,"._pagingGetFriendProfile friendCount:").concat(o," pageCount:").concat(r));for(var i=0;i<r;i++)n.getUserProfile({userIDList:t.slice(100*i,100*(i+1))}).then((function(t){t.data.forEach((function(t){var n=e._friendMap.get(t.userID);n&&n.updateProfile(t)})),e._onFriendListUpdated()}))}},{key:"addFriend",value:function(e){var t=this,n="".concat(this._n,".").concat("addFriend");if(this._friendMap.has(e.to))return BI({code:Vm});if(e.wording&&!1===this._snsModule.filterProfanity("wording",e))return BI({code:f_});var o=e.to,r=e.source,i=e.type,a=e.wording,s=e.remark,u=e.groupName,c=i;(!c||c!==Ir.SNS_ADD_TYPE_SINGLE&&c!==Ir.SNS_ADD_TYPE_BOTH)&&(c=Ir.SNS_ADD_TYPE_BOTH);var l=new w_("addFriend");return l.setMessage("to:".concat(o," source:").concat(r," type:").concat(c)),this._snsModule.request({protocolName:Nh,requestData:{fromAccount:this._snsModule.getMyUserID(),addFriendItem:[{to:o,source:r,wording:a,remark:s,groupName:u}],type:c}}).then((function(e){var o=e.data.resultList;l.setNetworkType(t._snsModule.getNetworkType()).setMoreMessage("resultList:".concat(JSON.stringify(o))).end();var r=o[0],i=r.to,a=r.resultCode,s=r.resultInfo;return Gl.i("".concat(n," ok. to:").concat(i," type:").concat(c," code:").concat(a)),id(a)||0===a?GI({userID:i,code:0}):30539===a?GI({userID:i,code:a,message:t._snsModule.getErrorMessage(a)}):BI({userID:i,code:a,message:t._snsModule.getErrorMessage(a)||s})})).catch((function(e){return t._snsModule.probeNetwork().then((function(t){var n=_(t,2),o=n[0],r=n[1];l.setError(e,o,r).end()})),Gl.w("".concat(n," failed. error:"),e),BI(e)}))}},{key:"deleteFriend",value:function(e){var t=this,n="".concat(this._n,".").concat("deleteFriend"),o=e.userIDList,r=e.type;o.length>1e3&&(Gl.w("".concat(n," ").concat(Zd(1e3))),o.length=1e3);var i=[],a=[],s=[];if(o.forEach((function(e){t._friendMap.has(e)?s.push(e):i.push({userID:e,code:Bm,message:t._snsModule.getErrorMessage(Bm)})})),0===s.length)return qI({successUserIDList:a,failureUserIDList:i});var u=r;(!u||u!==Ir.SNS_DELETE_TYPE_SINGLE&&u!==Ir.SNS_DELETE_TYPE_BOTH)&&(u=Ir.SNS_DELETE_TYPE_BOTH);var c=new w_("deleteFriend");return c.setMessage("userIDList:".concat(s," type:").concat(u)),this._snsModule.request({protocolName:Oh,requestData:{fromAccount:this._snsModule.getMyUserID(),userIDList:s,type:u}}).then((function(e){c.setNetworkType(t._snsModule.getNetworkType()).end(),Gl.i("".concat(n," ok"));var o=e.data.resultList;return Yd(o)||o.forEach((function(e){var t=e.to,n=e.resultCode,o=e.resultInfo;id(n)||0===n?a.push({userID:t}):i.push({userID:t,code:n,message:o})})),GI({successUserIDList:a,failureUserIDList:i})})).catch((function(e){return t._snsModule.probeNetwork().then((function(t){var n=_(t,2),o=n[0],r=n[1];c.setError(e,o,r).end()})),Gl.w("".concat(n," error:"),e),BI(e)}))}},{key:"updateFriend",value:function(e){var t=this,n=e.userID,o=e.remark,r=e.friendCustomField;if(!this._friendMap.has(n))return BI({code:Bm});var i="".concat(this._n,".").concat("updateFriend"),a=new w_("updateFriend");a.setMessage("userID:".concat(n," remark:").concat(o," friendCustomField:").concat(r));var s=[];return id(o)||s.push({tag:ql,value:o}),rd(r)&&r.length>0&&r.forEach((function(e){s.push({tag:e.key,value:e.value})})),this._snsModule.request({protocolName:Ph,requestData:{fromAccount:this._snsModule.getMyUserID(),updateItem:[{to:n,snsItem:s}]}}).then((function(e){a.setNetworkType(t._snsModule.getNetworkType()).end(),Gl.i("".concat(i," ok"));var n=e.data.resultList[0],s=n.to,u=n.resultCode,c=n.resultInfo;if(id(u)||0===u){var l=t._friendMap.get(s);return l&&(id(o)||(l.remark=o),rd(r)&&r.length>0&&kd(l.friendCustomField,r),t._onFriendListUpdated()),GI(l)}return BI({code:u,message:c})})).catch((function(e){return t._snsModule.probeNetwork().then((function(t){var n=_(t,2),o=n[0],r=n[1];a.setError(e,o,r).end()})),Gl.w("".concat(i," failed. error:"),e),BI(e)}))}},{key:"checkFriend",value:function(e){var t=this,n="".concat(this._n,".").concat("checkFriend"),o=e.userIDList,r=e.type;(!r||r!==Ir.SNS_CHECK_TYPE_SINGLE&&r!==Ir.SNS_CHECK_TYPE_BOTH)&&(r=Ir.SNS_CHECK_TYPE_BOTH);var i=new w_("checkFriend");return i.setMessage("userIDList:".concat(o," type:").concat(r)),this._snsModule.request({protocolName:wh,requestData:{fromAccount:this._snsModule.getMyUserID(),userIDList:o,type:r}}).then((function(e){i.setNetworkType(t._snsModule.getNetworkType()).end(),Gl.i("".concat(n," ok. userIDList:").concat(o," type:").concat(r));var a=[],s=[],u=e.data.resultList;return rd(u)&&u.forEach((function(e){var t=e.to,n=e.relation,o=e.resultCode,r=e.resultInfo;id(o)||0===o?a.push({userID:t,code:0,relation:n}):s.push({userID:t,code:o,message:r})})),GI({successUserIDList:a,failureUserIDList:s})})).catch((function(e){return t._snsModule.probeNetwork().then((function(t){var n=_(t,2),o=n[0],r=n[1];i.setError(e,o,r).end()})),Gl.w("".concat(n," failed. error:"),e),BI(e)}))}},{key:"updateWhenAddedToFriendGroup",value:function(e){var t=this,n=e.name,o=e.userIDList;Gl.l("".concat(this._n,".updateWhenAddedToFriendGroup groupName:").concat(n," userIDList:").concat(o)),n&&!Yd(o)&&o.forEach((function(e){t._friendMap.has(e)&&t._friendMap.get(e).addToGroupList(n)}))}},{key:"updateWhenRemovedFromFriendGroup",value:function(e){var t=this,n=e.name,o=e.userIDList;Gl.l("".concat(this._n,".updateWhenRemovedFromFriendGroup groupName:").concat(n," userIDList:").concat(o)),n&&!Yd(o)&&o.forEach((function(e){t._friendMap.has(e)&&t._friendMap.get(e).removeFromGroupList(n)}))}},{key:"reset",value:function(){this._friendMap.clear(),this._startIndex=0,this._standardSequence=0,this._customSequence=0}}]),e}(),bD=function(){function e(t){r(this,e),Yd(t)||(this.name=t.name||"",this.userIDList=t.userIDList||[],this.count=this.userIDList.length||0)}return a(e,[{key:"addToUserIDList",value:function(e){-1===this.userIDList.indexOf(e)&&(this.userIDList.push(e),this.count=this.userIDList.length)}},{key:"removeFromUserIDList",value:function(e){var t=this.userIDList.indexOf(e);t>-1&&(this.userIDList.splice(t,1),this.count=this.userIDList.length)}}]),e}(),DD=function(){function e(t){r(this,e),this._snsModule=t,this._n="FriendGroupHandler",this._friendGroupMap=new Map}return a(e,[{key:"getLocalFriendGroupList",value:function(){return y(this._friendGroupMap.values())}},{key:"_emitFriendGroupListUpdated",value:function(){var e=y(this._friendGroupMap.values());this._snsModule.emitOuterEvent(Mr.FRIEND_GROUP_LIST_UPDATED,e)}},{key:"getFriendGroupList",value:function(){var e=this,t="".concat(this._n,".").concat("getFriendGroupList"),n=new w_("getFriendGroupList");return this._snsModule.request({protocolName:qh,requestData:{fromAccount:this._snsModule.getMyUserID()}}).then((function(o){n.setNetworkType(e._snsModule.getNetworkType()).end();var r=o.data.resultList;Yd(r)?Gl.i("".concat(t," ok. friend group count:0")):(Gl.i("".concat(t," ok. friend group count:").concat(r.length)),e._friendGroupMap.clear(),r.forEach((function(t){var n=new bD(t);e._friendGroupMap.set(t.name,n)})),e._emitFriendGroupListUpdated())})).catch((function(o){return e._snsModule.probeNetwork().then((function(e){var t=_(e,2),r=t[0],i=t[1];n.setError(o,r,i).end()})),Gl.w("".concat(t," error:"),o),BI(o)}))}},{key:"createFriendGroup",value:function(e){var t=this,n="".concat(this._n,".").concat("createFriendGroup"),o=e.name,r=e.userIDList;if(this._friendGroupMap.has(o))return BI({code:Hm});var i=new w_("createFriendGroup");return i.setMessage("name:".concat(o," userIDList:").concat(r)),this._snsModule.request({protocolName:Bh,requestData:{fromAccount:this._snsModule.getMyUserID(),groupName:[o],userIDList:rd(r)?r:void 0}}).then((function(e){i.setNetworkType(t._snsModule.getNetworkType()).end(),Gl.l("".concat(n," ok. name:").concat(o," userIDList:").concat(r));var a=e.data.resultList,s=[],u=[];a&&a.forEach((function(e){var t=e.to,n=e.resultCode,o=e.resultInfo;if(id(n)||0===n)s.push(t);else{var r={userID:e.to,code:n,message:o};u.push(r)}}));var c=new bD({name:o,userIDList:s});return t._friendGroupMap.set(o,c),t._snsModule.updateWhenAddedToFriendGroup({name:o,userIDList:s}),t._emitFriendGroupListUpdated(),GI({friendGroup:c,failureUserIDList:u})})).catch((function(e){return t._snsModule.probeNetwork().then((function(t){var n=_(t,2),o=n[0],r=n[1];i.setError(e,o,r).end()})),Gl.w("".concat(n," failed. error:"),e),BI(e)}))}},{key:"deleteFriendGroup",value:function(e){var t=this,n="".concat(this._n,".").concat("deleteFriendGroup"),o=e.name;if(!this._friendGroupMap.has(o))return BI({code:Km});var r=new w_("deleteFriendGroup");return r.setMessage("name:".concat(o)),this._snsModule.request({protocolName:Vh,requestData:{fromAccount:this._snsModule.getMyUserID(),nameList:[o]}}).then((function(e){r.setNetworkType(t._snsModule.getNetworkType()).end(),Gl.l("".concat(n," ok. name:").concat(o));var i=t._friendGroupMap.get(o);return i&&(t._snsModule.updateWhenRemovedFromFriendGroup({name:o,userIDList:i.userIDList}),t._friendGroupMap.delete(o),i.userIDList.length=0),t._emitFriendGroupListUpdated(),GI(i)})).catch((function(e){return t._snsModule.probeNetwork().then((function(t){var n=_(t,2),o=n[0],i=n[1];r.setError(e,o,i).end()})),Gl.w("".concat(n," failed. error:"),e),BI(e)}))}},{key:"renameFriendGroup",value:function(e){var t=this,n="".concat(this._n,".").concat("renameFriendGroup"),o=e.oldName,r=e.newName;if(!this._friendGroupMap.has(o))return BI({code:Km});var i=new w_("renameFriendGroup");return i.setMessage("oldName:".concat(o," newName:").concat(r)),this._snsModule.request({protocolName:Hh,requestData:{fromAccount:this._snsModule.getMyUserID(),oldName:o,newName:r}}).then((function(){if(i.setNetworkType(t._snsModule.getNetworkType()).end(),Gl.l("".concat(n," ok. oldName:").concat(o," newName:").concat(r)),t._friendGroupMap.has(o)){var e=t._friendGroupMap.get(o);return e.name=r,t._friendGroupMap.delete(o),t._friendGroupMap.set(r,e),t._snsModule.updateWhenRemovedFromFriendGroup({name:o,userIDList:e.userIDList}),t._snsModule.updateWhenAddedToFriendGroup({name:r,userIDList:e.userIDList}),t._emitFriendGroupListUpdated(),GI(e)}return GI()})).catch((function(e){return t._snsModule.probeNetwork().then((function(t){var n=_(t,2),o=n[0],r=n[1];i.setError(e,o,r).end()})),Gl.w("".concat(n," failed. error:"),e),BI(e)}))}},{key:"addToFriendGroup",value:function(e){var t=this,n="".concat(this._n,".").concat("addToFriendGroup"),o=e.name,r=e.userIDList;if(!this._friendGroupMap.has(o))return this._onFriendGroupNotExist(o);var i=new w_("addToFriendGroup");return i.setMessage("name:".concat(o," userIDList:").concat(r)),Gl.l("".concat(n," name:").concat(o," userIDList:").concat(r)),this._snsModule.request({protocolName:Hh,requestData:{fromAccount:this._snsModule.getMyUserID(),oldName:o,updateGroupItem:r.filter((function(e){return t._snsModule.isMyFriend(e)})).map((function(e){return{to:e,updateType:"Update_Type_Add"}}))}}).then((function(e){return i.setNetworkType(t._snsModule.getNetworkType()).end(),t._onFriendGroupUpdated(o,e)})).catch((function(e){return t._snsModule.probeNetwork().then((function(t){var n=_(t,2),o=n[0],r=n[1];i.setError(e,o,r).end()})),Gl.w("".concat(n," failed. error:"),e),BI(e)}))}},{key:"removeFromFriendGroup",value:function(e){var t=this,n="".concat(this._n,".").concat("removeFromFriendGroup"),o=e.name,r=e.userIDList;if(!this._friendGroupMap.has(o))return this._onFriendGroupNotExist(o);var i=new w_("removeFromFriendGroup");return i.setMessage("name:".concat(o," userIDList:").concat(r)),Gl.l("".concat(n," name:").concat(o," userIDList:").concat(r)),this._snsModule.request({protocolName:Hh,requestData:{fromAccount:this._snsModule.getMyUserID(),oldName:o,updateGroupItem:r.filter((function(e){return t._snsModule.isMyFriend(e)})).map((function(e){return{to:e,updateType:"Update_Type_Delete"}}))}}).then((function(e){return i.setNetworkType(t._snsModule.getNetworkType()).end(),t._onFriendGroupUpdated(o,e)})).catch((function(e){return t._snsModule.probeNetwork().then((function(t){var n=_(t,2),o=n[0],r=n[1];i.setError(e,o,r).end()})),Gl.w("".concat(n," failed. error:"),e),BI(e)}))}},{key:"_onFriendGroupUpdated",value:function(e,t){var n=t.data.resultList,o=this._friendGroupMap.get(e),r=[],i=[],a=[];return rd(n)&&n.forEach((function(e){var t=e.to,n=e.resultCode,s=e.resultInfo,u=e.type;0===n?"Update_Type_Add"===u?o&&(o.addToUserIDList(t),i.push(t)):"Update_Type_Delete"===u&&o&&(o.removeFromUserIDList(t),a.push(t)):r.push({to:e.to,code:n,message:s})})),Gl.l("".concat(this._n,"._onFriendGroupUpdated name:").concat(e," userIDList:").concat(o.userIDList)),i.length>0&&this._snsModule.updateWhenAddedToFriendGroup({name:e,userIDList:i}),a.length>0&&this._snsModule.updateWhenRemovedFromFriendGroup({name:e,userIDList:a}),GI({friendGroup:o,failureUserIDList:r})}},{key:"updateWhenFriendAdded",value:function(e){var t=this,n=e.nameList,o=e.userID;Gl.l("".concat(this._n,".updateWhenFriendAdded userID:").concat(o," nameList:").concat(n)),Yd(n)||n.forEach((function(e){t._friendGroupMap.has(e)&&t._friendGroupMap.get(e).addToUserIDList(o)}))}},{key:"updateWhenFriendDeleted",value:function(e){var t=this,n=e.nameList,o=e.userID;Gl.l("".concat(this._n,".updateWhenFriendDeleted userID:").concat(o," nameList:").concat(n)),Yd(n)||n.forEach((function(e){t._friendGroupMap.has(e)&&t._friendGroupMap.get(e).removeFromUserIDList(o)}))}},{key:"reset",value:function(){this._friendGroupMap.clear()}}]),e}(),ED=function(e){u(n,e);var t=m(n);function n(e){var o;return r(this,n),(o=t.call(this,e))._n="SnsModule",o._friendHandler=new SD(g(o)),o._friendApplicationHandler=new kD(g(o)),o._friendGroupHandler=new DD(g(o)),o.getInnerEmitterInstance().on(rC,o.onContextUpdated,g(o)),o}return a(n,[{key:"onContextUpdated",value:function(e){this._friendHandler.pagingGetFriendList(),this._friendGroupHandler.getFriendGroupList(),this._friendApplicationHandler.getFriendApplicationList()}},{key:"onRelationChainModified",value:function(e){var t=this,n=e.dataList;if(!Yd(n)){var o=[],r=[],i=[],a=[],s=!1,u="";n.forEach((function(e){if(3!==e.pushType&&4!==e.pushType||!e.from||(u=e.from),e.friendAddAccount&&(o.push.apply(o,y(e.friendAddAccount)),a.push.apply(a,y(e.friendAddAccount))),e.friendDelAccount&&r.push.apply(r,y(e.friendDelAccount)),e.friendApplicationAdded&&i.push.apply(i,y(e.friendApplicationAdded)),e.friendApplicationDeletedUserIDList&&a.push.apply(a,y(e.friendApplicationDeletedUserIDList)),e.reportTime&&7===e.pushType&&(s=!0),e.friendUpInfo){var n={dataList:[]};e.friendUpInfo.forEach((function(e){n.dataList.push({userID:e.friendAccount,profileList:y(e.sns)})})),t.onFriendProfileModified(n)}})),s&&this._friendApplicationHandler.onFriendApplicationRead(),this._friendApplicationHandler.onFriendApplicationAdded(i,u),this._friendApplicationHandler.onFriendApplicationDeleted(a),this._friendHandler.onFriendAdded(o),this._friendHandler.onFriendDeleted(r)}}},{key:"isMyFriend",value:function(e){return this._friendHandler.isMyFriend(e)}},{key:"filterProfanity",value:function(e,t){var n=this.getModule(ph);if(!n)return!0;var o=n.filterText(t[e],Hc),r=o.isAllowedToSend,i=o.modifiedText;return!0===r&&(t[e]=i,!0)}},{key:"onFriendProfileModified",value:function(e){this._friendHandler.onFriendProfileModified(e)}},{key:"getLocalFriendList",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=this._friendHandler.getLocalFriendList();return e?qI(t):t}},{key:"getFriendRemark",value:function(e){return this._friendHandler.getFriendRemark(e)}},{key:"getFriendList",value:function(){return this._friendHandler.pagingGetFriendList()}},{key:"addFriend",value:function(e){return this._friendHandler.addFriend(e)}},{key:"deleteFriend",value:function(e){return this._friendHandler.deleteFriend(e)}},{key:"checkFriend",value:function(e){return this._friendHandler.checkFriend(e)}},{key:"getFriendProfile",value:function(e){return this._friendHandler.getFriendProfile(e)}},{key:"updateFriend",value:function(e){return this._friendHandler.updateFriend(e)}},{key:"updateWhenAddedToFriendGroup",value:function(e){this._friendHandler.updateWhenAddedToFriendGroup(e)}},{key:"updateWhenRemovedFromFriendGroup",value:function(e){this._friendHandler.updateWhenRemovedFromFriendGroup(e)}},{key:"getLocalFriendApplicationList",value:function(){var e=this._friendApplicationHandler.getLocalFriendApplicationList();return qI(e)}},{key:"deleteFriendApplication",value:function(e){return this._friendApplicationHandler.deleteFriendApplication(e)}},{key:"refuseFriendApplication",value:function(e){return this._friendApplicationHandler.refuseFriendApplication(e)}},{key:"acceptFriendApplication",value:function(e){return this._friendApplicationHandler.acceptFriendApplication(e)}},{key:"setFriendApplicationRead",value:function(e){return this._friendApplicationHandler.setFriendApplicationRead(e)}},{key:"getLocalFriendGroupList",value:function(){var e=this._friendGroupHandler.getLocalFriendGroupList();return qI(e)}},{key:"createFriendGroup",value:function(e){return this._friendGroupHandler.createFriendGroup(e)}},{key:"deleteFriendGroup",value:function(e){return this._friendGroupHandler.deleteFriendGroup(e)}},{key:"addToFriendGroup",value:function(e){return this._friendGroupHandler.addToFriendGroup(e)}},{key:"removeFromFriendGroup",value:function(e){return this._friendGroupHandler.removeFromFriendGroup(e)}},{key:"renameFriendGroup",value:function(e){return this._friendGroupHandler.renameFriendGroup(e)}},{key:"onAddToFriendGroup",value:function(e){return this._friendGroupHandler.onAddToFriendGroup(e)}},{key:"updateWhenFriendAdded",value:function(e){this._friendGroupHandler.updateWhenFriendAdded(e)}},{key:"updateWhenFriendDeleted",value:function(e){this._friendGroupHandler.updateWhenFriendDeleted(e)}},{key:"reset",value:function(){Gl.l("".concat(this._n,".reset")),this._friendHandler.reset(),this._friendGroupHandler.reset(),this._friendApplicationHandler.reset()}}]),n}(vh),AD=function(e){u(n,e);var t=m(n);function n(e){var o;return r(this,n),(o=t.call(this,e))._n="WorkerTimerModule",o._isWorkerEnabled=!0,o._workerTimer=null,o._init(),o.getInnerEmitterInstance().on(iC,o._onCloudConfigUpdated,g(o)),o}return a(n,[{key:"isWorkerEnabled",value:function(){return this._isWorkerEnabled&&Il}},{key:"startWorkerTimer",value:function(){Gl.l("".concat(this._n,".startWorkerTimer")),this._workerTimer&&this._workerTimer.postMessage("start")}},{key:"stopWorkerTimer",value:function(){Gl.l("".concat(this._n,".stopWorkerTimer")),this._workerTimer&&this._workerTimer.postMessage("stop")}},{key:"_init",value:function(){if(Il){var e=URL.createObjectURL(new Blob(['let interval = -1;onmessage = function(event) {  if (event.data === "start") {    if (interval > 0) {      clearInterval(interval);    }    interval = setInterval(() => {      postMessage("");    }, 1000)  } else if (event.data === "stop") {    clearInterval(interval);    interval = -1;  }};'],{type:"application/javascript; charset=utf-8"}));this._workerTimer=new Worker(e);var t=this;this._workerTimer.onmessage=function(){t._m.onCheckTimer()}}}},{key:"_onCloudConfigUpdated",value:function(){var e=this.getCloudConfig("enable_worker");Gl.l("".concat(this._n,"._onCloudConfigUpdated enableWorker:").concat(e)),id(e)||"1"===e?!this._isWorkerEnabled&&Il&&(this._isWorkerEnabled=!0,this.startWorkerTimer(),this._m.onWorkerTimerEnabled()):this._isWorkerEnabled&&Il&&(this._isWorkerEnabled=!1,this.stopWorkerTimer(),this._m.onWorkerTimerDisabled())}},{key:"terminate",value:function(){Gl.l("".concat(this._n,".terminate")),this._workerTimer&&(this._workerTimer.terminate(),this._workerTimer=null)}},{key:"reset",value:function(){Gl.l("".concat(this._n,".reset"))}}]),n}(vh),LD=function(){function e(){r(this,e),this._n="PurchasedFeatureHandler",this._purchasedFeatureMap=new Map}return a(e,[{key:"isValidPurchaseBits",value:function(e){return e&&"string"==typeof e&&e.length>=1&&e.length<=64&&/[01]{1,64}/.test(e)}},{key:"parsePurchaseBits",value:function(e){var t="".concat(this._n,".parsePurchaseBits");if(this.isValidPurchaseBits(e)){this._purchasedFeatureMap.clear();for(var n=null,o=e.length-1,r=0;o>=0;o--,r++)n=r<32?new kc(0,Math.pow(2,r)).toString():new kc(Math.pow(2,r-32),0).toString(),"1"===e[o]?this._purchasedFeatureMap.set(n,!0):this._purchasedFeatureMap.set(n,!1)}else Gl.w("".concat(t," invalid purchase bits:").concat(e))}},{key:"hasPurchasedFeature",value:function(e){return!!this._purchasedFeatureMap.get(e)}},{key:"isFeatureEnabled",value:function(e){for(var t=parseInt(e).toString(2),n=void 0,o=!0,r=t.length-1,i=0;r>=0;r--,i++)if("1"===t.charAt(r)&&(n=i<32?new kc(0,Math.pow(2,i)).toString():new kc(Math.pow(2,i-32),0).toString(),!this._purchasedFeatureMap.get(n))){o=!1;break}return Gl.l("".concat(this._n,".isFeatureEnabled decimalNumber:").concat(e," binaryString:").concat(t," ret:").concat(o)),qI({enabled:o})}},{key:"clear",value:function(){this._purchasedFeatureMap.clear()}}]),e}(),RD=function(){function e(t){r(this,e),this._m=t,this._n="CommercialConfigModule",this._expiredTime=0,this._isFetching=!1,this._purchasedFeatureHandler=new LD}return a(e,[{key:"_canFetch",value:function(){return this._getModule(Yf).isLoggedIn()?!this._isFetching&&Date.now()>=this._expiredTime:(this._expiredTime=Date.now()+2e3,!1)}},{key:"onCheckTimer",value:function(e){this._canFetch()&&this.fetchConfig()}},{key:"fetchConfig",value:function(){var e=this,t=this._canFetch(),n="".concat(this._n,".fetchConfig");if(Gl.l("".concat(n," canFetch:").concat(t)),t){var o=this._getModule($f),r=new w_("fetchCommercialConfig");r.setNetworkType(o.getNetworkType());var i=this._getModule(Yf).getSDKAppID(),a=this._getModule(oh);this._isFetching=!0,a.request({protocolName:_v,requestData:{SDKAppID:i}}).then((function(t){r.setMessage("purchaseBits:".concat(t.data.purchaseBits)).end(),Gl.l("".concat(n," ok.")),e._parseConfig(t.data),e._isFetching=!1})).catch((function(t){o.probe().then((function(e){var n=_(e,2),o=n[0],i=n[1];r.setError(t,o,i).end()})),e._isFetching=!1}))}}},{key:"onPushedConfig",value:function(e){var t="".concat(this._n,".onPushedConfig");Gl.l("".concat(t)),new w_("pushedCommercialConfig").setNetworkType(this._getModule($f).getNetworkType()).setMessage("purchaseBits:".concat(e.purchaseBits)).end(),this._parseConfig(e)}},{key:"_parseConfig",value:function(e){var t="".concat(this._n,"._parseConfig"),n=e.errorCode,o=e.errorMessage,r=e.purchaseBits,i=e.expiredTime;0===n?(this._purchasedFeatureHandler.parsePurchaseBits(r),this._expiredTime=Date.now()+1e3*i):id(n)?(Gl.l("".concat(t," failed. Invalid message format:"),e),this._setExpiredTimeOnResponseError(36e5)):(Gl.e("".concat(t," errorCode:").concat(n," errorMessage:").concat(o)),this._setExpiredTimeOnResponseError(12e4))}},{key:"_setExpiredTimeOnResponseError",value:function(e){this._expiredTime=Date.now()+e}},{key:"canIUse",value:function(e){return this._purchasedFeatureHandler.hasPurchasedFeature(e)}},{key:"isFeatureEnabled",value:function(e){return this._purchasedFeatureHandler.isFeatureEnabled(e)}},{key:"_getModule",value:function(e){return this._m.getModule(e)}},{key:"reset",value:function(){Gl.l("".concat(this._n,".reset")),this._expiredTime=0,this._isFetching=!1,this._purchasedFeatureHandler.clear()}}]),e}(),wD=function(e){u(n,e);var t=m(n);function n(e){var o;return r(this,n),(o=t.call(this,e))._m=e,o._n="OfflinePushModule",o._offlinePushPlugin=void 0,o._androidPushConfig={huaweiPushBussinessId:"",xiaomiPushBussinessId:"",xiaomiPushAppId:"",xiaomiPushAppKey:"",meizuPushBussinessId:"",meizuPushAppId:"",meizuPushAppKey:"",vivoPushBussinessId:"",fcmPushBussinessId:"",oppoPushBussinessId:"",oppoPushAppKey:"",oppoPushAppSecret:"",honorPushBussinessId:""},o._deviceToken="",o._businessID=0,o._iosBusinessID=0,o._c2cUnreadCount=0,o._groupUnreadCount=0,o._isWebUniapp=0,o}return a(n,[{key:"registerPlugin",value:function(e){if(el){this._offlinePushPlugin=e["tim-offline-push-plugin"];var t=e.offlinePushConfig||{},n=t.huaweiBusinessID,o=t.xiaomiBusinessID,r=t.xiaomiAppID,i=t.xiaomiAppKey,a=t.meizuBusinessID,s=t.meizuAppID,u=t.meizuAppKey,c=t.vivoBusinessID,l=t.oppoBusinessID,d=t.oppoAppKey,p=t.oppoAppSecret,f=t.honorBusinessID,h=t.iosBusinessID;this._androidPushConfig.huaweiPushBussinessId=n,this._androidPushConfig.xiaomiPushBussinessId=o,this._androidPushConfig.xiaomiPushAppId=r,this._androidPushConfig.xiaomiPushAppKey=i,this._androidPushConfig.meizuPushBussinessId=a,this._androidPushConfig.meizuPushAppId=s,this._androidPushConfig.meizuPushAppKey=u,this._androidPushConfig.vivoPushBussinessId=c,this._androidPushConfig.oppoPushBussinessId=l,this._androidPushConfig.oppoPushAppKey=d,this._androidPushConfig.oppoPushAppSecret=p,this._androidPushConfig.honorPushBussinessId=f,new w_("registerPlugin").setMessage("tim-offline-push-plugin").setMoreMessage("isExist:".concat(!id(this._offlinePushPlugin))).end(!0),Gl.l("".concat(this._n,".").concat("registerPlugin"," ok. offlinePushConfig:").concat(JSON.stringify(e.offlinePushConfig))),this._iosBusinessID=h,this._setAppShowListener()}else this.outputWarning("OfflinePushInUniapp")}},{key:"init",value:function(){this._isWebUniapp=this.getUniAppPlatform(),this._getDeviceToken()}},{key:"_getDeviceToken",value:function(){var e=this,t="".concat(this._n,".").concat("_getDeviceToken");if(sd(this._offlinePushPlugin.getDeviceToken)){var n="androidPushConfig:".concat(JSON.stringify(this._androidPushConfig),", iosBusinessID:").concat(this._iosBusinessID);Gl.l("".concat(t," start. ").concat(n)),new w_("_getDeviceToken").setMessage("".concat(n)).end(!0),this._offlinePushPlugin.getDeviceToken(this._androidPushConfig,(function(o){var r=new w_("getDeviceTokenRes"),i=o.code,a=o.msg;if(0===i){var s=o.data,u=s.deviceToken,c=s.deviceBrand,l=s.deviceType,d=s.bussinessId;e._deviceToken=u,e._businessID=d||e._iosBusinessID,n="deviceToken:".concat(u,", deviceBrand:").concat(c||l,", businessID:").concat(e._businessID),Gl.l("".concat(t," ok. ").concat(n)),r.setMessage(n).end(!0),e._setToken()}else r.setMessage("code:".concat(i,", msg:").concat(a)).end(!0),Gl.e("".concat(t," failed. error:"),o)}))}else Gl.e("".concat(t," getDeviceToken is not a function"))}},{key:"canIUseOfflinePush",value:function(){return el&&!id(this._offlinePushPlugin)}},{key:"_setAppShowListener",value:function(){var e=this,t="".concat(this._n,".").concat("_setAppShowListener");id(this._offlinePushPlugin)?Gl.e("".concat(t," offlinePushPlugin is undefined")):sd(this._offlinePushPlugin.setAppShowListener)?(new w_("_setAppShowListener").end(!0),Gl.l("".concat(t," start")),this._offlinePushPlugin.setAppShowListener((function(n){var o=(n||{}).appShow;new w_("setAppShowListenerRes").setMessage("appShow:".concat(o)).end(!0),Gl.l("".concat(t," ok. appShow:").concat(o)),e._m.isReady()&&(0===o?(e._getConvUnreadCount(),e._onBackground()):1===o&&e._onForeground())}))):Gl.e("".concat(t," setAppShowListener is not a function"))}},{key:"getDeviceBrand",value:function(){if(!id(this._offlinePushPlugin)&&sd(this._offlinePushPlugin.getDeviceType)){var e=(this._offlinePushPlugin.getDeviceType()||{}).deviceType;return Gl.l("".concat(this._n,".getDeviceBrand ok. deviceType:").concat(e)),e}}},{key:"_setToken",value:function(){var e,t=this,n="".concat(this._n,"._setToken"),o=this.getModule(Yf),r=1,i="",a="";Yd(this._deviceToken)&&(r=0);var s=this.getUniAppPlatform(),u=this.getDeviceBrand();s===Sc.IOS||s===Sc.IPAD||s===Sc.MAC?a=this._deviceToken:s===Sc.ANDROID&&(i=this._deviceToken);var c=new w_("offlinePushSetToken");return e="deviceToken:".concat(a||i,", businessID:").concat(this._businessID,", ")+"deviceBrand:".concat(u,", isWebUniapp:").concat(this._isWebUniapp,", pushMsg:").concat(r,", platform:").concat(s),c.setMessage("".concat(e)),Gl.l("".concat(n," ").concat(e)),this.request({protocolName:Rv,requestData:{tokenID:i,pushMsg:r,sdkAppID:o.getSDKAppID(),businessID:parseInt(this._businessID),deviceBrand:u,deviceToken:a,isWebUniapp:this._isWebUniapp}}).then((function(e){return c.end(),Gl.l("".concat(n," ok")),e})).catch((function(e){return t.probeNetwork().then((function(t){var n=_(t,2),o=n[0],r=n[1];c.setError(e,o,r).end()})),Gl.e("".concat(n," failed. error:"),e),BI(e)}))}},{key:"_getConvUnreadCount",value:function(){var e=this;this._c2cUnreadCount=0,this._groupUnreadCount=0,this.getModule(Wf).getLocalConversationList().forEach((function(t){t.type===Ir.CONV_C2C&&(e._c2cUnreadCount+=t.unreadCount),t.type===Ir.CONV_GROUP&&(e._groupUnreadCount+=t.unreadCount)}))}},{key:"_onBackground",value:function(){var e=this,t="".concat(this._n,".").concat("_onBackground"),n=new w_("_onBackground");this.request({protocolName:Av,requestData:{c2cUnreadCount:this._c2cUnreadCount,groupUnreadCount:this._groupUnreadCount,isWebUniapp:this._isWebUniapp}}).then((function(o){return n.setMessage("c2cUnreadCount: ".concat(e._c2cUnreadCount,", groupUnreadCount: ").concat(e._groupUnreadCount)).end(),Gl.l("".concat(t," ok")),o})).catch((function(o){e.probeNetwork().then((function(e){var t=_(e,2),r=t[0],i=t[1];n.setError(o,r,i).end()})),Gl.e("".concat(t," failed. error:"),o)}))}},{key:"_onForeground",value:function(){var e=this,t="".concat(this._n,".").concat("_onForeground"),n=new w_("_onForeground");this.request({protocolName:Lv,requestData:{isWebUniapp:this._isWebUniapp}}).then((function(e){return n.end(),Gl.l("".concat(t," ok")),e})).catch((function(o){e.probeNetwork().then((function(e){var t=_(e,2),r=t[0],i=t[1];n.setError(o,r,i).end()})),Gl.e("".concat(t," failed. error:"),o)}))}},{key:"getUniAppPlatform",value:function(){var e=uni.getSystemInfoSync().platform,t=this.getDeviceBrand();return"ios"===e?Sc.IOS:"android"===e?Sc.ANDROID:1002===t?Sc.IPAD:1001===t?Sc.MAC:void 0}},{key:"reset",value:function(){this._deviceToken="",this._businessID=0,this._c2cUnreadCount=0,this._groupUnreadCount=0,this._isWebUniapp=0,Gl.l("".concat(this._n,".reset"))}}]),n}(vh),OD=function(e){u(n,e);var t=m(n);function n(e){var o;return r(this,n),(o=t.call(this,e))._n="ProfanityFilterModule",o._plugin=null,o._filterConfigMap=new Map,o._startIndex=0,o._version=0,o._canIUseLexicon=!1,o._isFetching=!1,o._expiredTime=0,o}return a(n,[{key:"init",value:function(){var e=this.getModule(th).getPlugin("tim-profanity-filter-plugin");e?(this._plugin=new e({logger:Gl,isArray:rd,isMap:$l,isDevMode:this.isDevMode()}),this._getLexicon()):this.outputWarning("ProfanityPluginNotFound")}},{key:"onCheckTimer",value:function(){this._plugin&&this._canIUseLexicon&&this.isLoggedIn()&&!this._isFetching&&Date.now()>=this._expiredTime&&this._getLexicon()}},{key:"filterMessage",value:function(e,t){var n=!0;if(!this._plugin||!this._canIUseLexicon)return n;if(t&&t.messageControlInfo&&!0===t.messageControlInfo.excludedFromContentModeration)return n;var o=e.type,r=e.conversationType;if(o!==Ir.MSG_TEXT&&o!==Ir.MSG_CUSTOM)return n;var i,a="".concat(this._n,".filterMessage");if(Gl.l("".concat(a)),o===Ir.MSG_TEXT){if(r===Ir.CONV_C2C?i=xc:r===Ir.CONV_GROUP&&(i=qc),!this._isConfigOn(i))return n;var s=this._plugin.filter(e.payload.text),u=s.type,c=s.modifiedText;1===u?n=!1:2===u&&(e.payload.text=c)}else if(o===Ir.MSG_CUSTOM){if(r===Ir.CONV_C2C?i=Fc:r===Ir.CONV_GROUP&&(i=Bc),!this._isConfigOn(i))return n;var l=this._plugin.filter(e.payload.data),d=this._plugin.filter(e.payload.description),p=this._plugin.filter(e.payload.extension);1===l.type||1===d.type||1===p.type?n=!1:(2===l.type&&(e.payload.data=l.modifiedText),2===d.type&&(e.payload.description=d.modifiedText),2===p.type&&(e.payload.extension=p.modifiedText))}return Gl.l("".concat(a," done. isAllowedToSend:").concat(n)),n}},{key:"filterText",value:function(e,t){var n="".concat(this._n,".filterText"),o={isAllowedToSend:!0,modifiedText:e};if(!this._plugin||!this._canIUseLexicon)return o;if(!this._isConfigOn(t))return o;Gl.l("".concat(n));var r=this._plugin.filter(e),i=r.type,a=r.modifiedText;return 1===i?o.isAllowedToSend=!1:2===i&&(o.modifiedText=a),Gl.l("".concat(n," done. ret:"),o),o}},{key:"_getLexicon",value:function(){var e=this,t=new w_("profanityFilter"),n="".concat(this._n,"._getLexicon");this._isFetching=!0,this.request({protocolName:wv,requestData:{startIndex:this._startIndex,version:this._version}}).then((function(o){var r=o.data,i=r.errorInfo,a=r.filterConfig,s=r.lexicon,u=r.strToken,c=r.completeFlag,l=r.nextStartIndex,d=r.version,p=r.expiredTime,f=i.errorCode,h=i.errorMessage;return 0!==f?(e._isFetching=!1,Gl.w("".concat(n," failed. error:"),i),void t.setCode(f).setMessage(h).end()):(e._onFilterConfig(a),e._getToken(u),1===c?(Gl.l("".concat(n," done. version:").concat(d," expiredTime:").concat(p)),e._version=d,e._canIUseLexicon=!0,e._isFetching=!1,e._expiredTime=Date.now()+1e3*p,void e._plugin.onLexiconCompleted(s)):(e._startIndex=l,e._plugin.onLexiconSliced(s),void e._getLexicon()))})).catch((function(o){e.probeNetwork().then((function(e){var n=_(e,2),r=n[0],i=n[1];t.setError(o,r,i).end()})),e._isFetching=!1,Gl.l("".concat(n," failed. error:"),o)}))}},{key:"_onFilterConfig",value:function(e){var t=this;Yd(e)||(this._filterConfigMap.clear(),Object.keys(e).forEach((function(n){t._filterConfigMap.set(n,e[n])})),Gl.l("".concat(this._n,"._onFilterConfig. keys:").concat(Array.from(this._filterConfigMap.keys())," values:").concat(Array.from(this._filterConfigMap.values()))))}},{key:"_isConfigOn",value:function(e){return 1===this._filterConfigMap.get(e)}},{key:"_getToken",value:function(e){if(td(e)){var t=e.length,n="";if(t%2==0)for(var o=0;o<=t-1;o+=2)n+=e[o+1],n+=e[o];else{for(var r=0;r<t-1;r+=2)n+=e[r+1],n+=e[r];n+=e[t-1]}this._plugin.onToken(n)}}},{key:"reset",value:function(){Gl.l("".concat(this._n,".reset")),this._plugin&&(this._plugin.reset(),this._plugin=null),this._filterConfigMap.clear(),this._startIndex=0,this._version=0,this._canIUseLexicon=!1,this._isFetching=!1,this._expiredTime=0}}]),n}(vh),ND=function(){function e(t){r(this,e),this._m=t,this._n="TransCmdModule"}return a(e,[{key:"sendTRTCCustomData",value:function(e){return this._trans(t({serv:Gc.NAME.TUIROOM_SVR},e))}},{key:"_trans",value:function(e){Gl.l("".concat(this._n,"._trans. options:").concat(JSON.stringify(e)));var t=e.serv,n=e.data;return this._m.getModule(oh).trans({servcmd:"".concat(t,".*"),data:td(n)?JSON.parse(n):n})}},{key:"reset",value:function(){Gl.l("".concat(this._n,".reset"))}}]),e}(),PD=xe("replace"),GD=RegExp.prototype,UD=R.TypeError,xD=j(ri),FD=j("".indexOf),qD=(j("".replace),j("".slice)),BD=Math.max,VD=function(e,t,n){return n>e.length?-1:""===t?n:FD(e,t,n)};on({target:"String",proto:!0},{replaceAll:function(e,t){var n,o,r,i,a,s,u,c,l=Q(this),d=0,p=0,f="";if(null!=e){if(Wi(e)&&(n=pn(Q("flags"in GD?e.flags:xD(e))),!~FD(n,"g")))throw UD("`.replaceAll` does not allow non-global regexes");if(o=Me(e,PD))return G(o,e,l,t)}for(r=pn(l),i=pn(e),(a=te(t))||(t=pn(t)),s=i.length,u=BD(1,s),d=VD(r,i,0);-1!==d;)c=a?pn(t(i,d,r)):Aa(i,r,d,[],void 0,t),f+=qD(r,p,d)+c,p=d+s,d=VD(r,i,d+u);return p<r.length&&(f+=qD(r,p)),f}});var HD=function(){function e(t){r(this,e),this._m=t,this._n="ErrorMessageModule",this.TIM_ERROR_ASSISTANCE="tim_error_assistance",this.STORAGE_EXPIRES_TIME=6048e5,this._map=new Map,this._init()}return a(e,[{key:"_init",value:function(){var e=this._getStorageModule().getItem(this.TIM_ERROR_ASSISTANCE,!1);if(e){var t=JSON.parse(e);this._needToUpdate(t)?this._fetch():this._fillMap(t.message)}else this._fetch()}},{key:"_needToUpdate",value:function(e){var t=e.localSavedTime,n=e.localSavedVersion,o=t&&(new Date).getTime()-t>=this.STORAGE_EXPIRES_TIME,r=!n||"2.26.3"!==n;return Gl.l("".concat(this._n,"._needToUpdate isTimeout:").concat(o," isDifferentVersion:").concat(r)),o||r}},{key:"_fetch",value:function(){if(!this._m.getModule(Yf).isPrivateNetWork()){var e="https://web.sdk.qcloud.com/im/download/error-message/0.0.1/tim-error-message.txt",t="application/x-www-form-urlencoded;charset=UTF-8",n="".concat(this._n,"._fetch ok in"),o=this;if(nl)rl.request({url:e,method:"GET",timeout:3e3,header:{"content-type":t},success:function(e){o._fillAndSave(e.data),Gl.l("".concat(n," mini program"))},fail:function(){}});else{var r=new XMLHttpRequest,i=setTimeout((function(){r.abort()}),3e3);r.onreadystatechange=function(){4===r.readyState&&(clearTimeout(i),200!==r.status&&304!==r.status||(Gl.l("".concat(n," browser")),o._fillAndSave(r.responseText)))},r.open("GET",e,!0),r.setRequestHeader("Content-type",t),r.send()}}}},{key:"_fillAndSave",value:function(e){this._fillMap(e),this._getStorageModule().setItem(this.TIM_ERROR_ASSISTANCE,JSON.stringify({message:e,localSavedTime:(new Date).getTime(),localSavedVersion:"2.26.3"}),!0,!1)}},{key:"_getStorageModule",value:function(){return this._m.getModule(Jf)}},{key:"_fillMap",value:function(e){this._map.clear();for(var t,n,o,r=e.split(";\n"),i=r.length,a=0;a<i;a++)if(t=r[a].indexOf(":"),n=r[a].slice(0,t),o=r[a].slice(t+1,r[a].length),!n.startsWith("//")){if(id(o))continue;this._map.set(n,o.replaceAll("'",""))}}},{key:"get",value:function(e){var t=e.isIntl,n=e.key,o=e.replacement1,r=e.replacement2,i="".concat(n,t?"_en":"_cn");!this._map.has(i)&&this._map.has(n)&&(i=n);var a="";return this._map.has(i)?(a=this._map.get(i),id(o)||(a=a.replace("$replacement1",o)),id(r)||(a=a.replace("$replacement2",r)),a):a}},{key:"reset",value:function(){Gl.l("".concat(this._n,".reset"))}}]),e}(),KD=function(){function e(t){r(this,e);var n=new w_("sdkConstruct");this._n="ModuleManager",this._isReady=!1,this._reason=Fv,this._startLoginTs=0,this._moduleMap=new Map,this._innerEmitter=null,this._outerEmitter=null,this._checkCount=0,this._checkTimer=-1,this._moduleMap.set(Yf,new ak(this,t)),this._moduleMap.set(lh,new RD(this)),this._moduleMap.set(ah,new gD(this)),this._moduleMap.set(sh,new AD(this)),this._moduleMap.set(ch,new ID(this)),this._moduleMap.set(rh,new aD(this)),this._moduleMap.set(oh,new fD(this)),this._moduleMap.set(Ff,new sk(this)),this._moduleMap.set(qf,new Ek(this)),this._moduleMap.set(Bf,new Ak(this)),this._moduleMap.set(hh,new Lk(this)),this._moduleMap.set(Vf,new ik(this)),this._moduleMap.set(Hf,new VI(this)),this._moduleMap.set(Wf,new DC(this)),this._moduleMap.set(Kf,new ZC(this)),this._moduleMap.set(zf,new YC(this)),this._moduleMap.set(Zf,new QC(this)),this._moduleMap.set(Jf,new lk(this)),this._moduleMap.set(gh,new HD(this)),this._moduleMap.set(Xf,new fk(this)),this._moduleMap.set($f,new mk(this)),this._moduleMap.set(Qf,new yk(this)),this._moduleMap.set(eh,new Ik(this)),this._moduleMap.set(th,new Rk(this)),this._moduleMap.set(nh,new wk(this)),this._moduleMap.set(ih,new hD(this)),this._moduleMap.set(uh,new vD(this)),this._moduleMap.set(jf,new ED(this)),this._moduleMap.set(dh,new wD(this)),this._moduleMap.set(ph,new OD(this)),this._moduleMap.set(fh,new ND(this)),this._eventThrottleMap=new Map;var o=t.instanceID,i=t.oversea,a=t.SDKAppID,s="instanceID:".concat(o," SDKAppID:").concat(a," host:").concat(Nd()," oversea:").concat(i," inBrowser:").concat(ol," inMiniApp:").concat(nl)+" workerAvailable:".concat(Il," UserAgent:").concat(al);w_.bindEventStatModule(this._moduleMap.get(Xf)),n.setMessage("".concat(s," ").concat(function(){var e="";if(nl)try{var t=rl.getSystemInfoSync(),n=t.model,o=t.version,r=t.system,i=t.platform,a=t.SDKVersion;e="model:".concat(n," version:").concat(o," system:").concat(r," platform:").concat(i," SDKVersion:").concat(a)}catch(XD){e=""}return e}())).end(),Gl.i("SDK ".concat(s)),UI.prototype._getErrorMessage=this.getErrorMessage.bind(this),this._readyList=void 0,this._ssoLogForReady=null,this._initReadyList()}return a(e,[{key:"_startTimer",value:function(){var e=this._moduleMap.get(sh),t=e.isWorkerEnabled();Gl.l("".concat(this._n,".startTimer isWorkerEnabled:").concat(t," seed:").concat(this._checkTimer)),t?e.startWorkerTimer():this._startMainThreadTimer()}},{key:"_startMainThreadTimer",value:function(){this._checkTimer<0&&(this._checkTimer=setInterval(this.onCheckTimer.bind(this),1e3)),Gl.l("".concat(this._n,"._startMainThreadTimer seed:").concat(this._checkTimer))}},{key:"stopTimer",value:function(){var e=this._moduleMap.get(sh),t=e.isWorkerEnabled();Gl.l("".concat(this._n,".stopTimer isWorkerEnabled:").concat(t," seed:").concat(this._checkTimer)),t?e.stopWorkerTimer():this._stopMainThreadTimer()}},{key:"_stopMainThreadTimer",value:function(){Gl.l("".concat(this._n,"._stopMainThreadTimer")),this._checkTimer>0&&(clearInterval(this._checkTimer),this._checkTimer=-1,this._checkCount=0)}},{key:"_stopMainThreadSocket",value:function(){Gl.l("".concat(this._n,"._stopMainThreadSocket"));var e=this._moduleMap.get(rh);e.setIsWorkerEnabled(!0),e.reConnect()}},{key:"_startMainThreadSocket",value:function(){Gl.l("".concat(this._n,"._startMainThreadSocket"));var e=this._moduleMap.get(rh);e.setIsWorkerEnabled(!1),e.reConnect()}},{key:"onWorkerTimerEnabled",value:function(){Gl.l("".concat(this._n,".onWorkerTimerEnabled, disable main thread timer and socket")),this._stopMainThreadTimer(),this._stopMainThreadSocket()}},{key:"onWorkerTimerDisabled",value:function(){Gl.l("".concat(this._n,".onWorkerTimerDisabled, enable main thread timer and socket")),this._startMainThreadTimer(),this._startMainThreadSocket()}},{key:"onCheckTimer",value:function(){this._checkCount+=1;var e,t=S(this._moduleMap);try{for(t.s();!(e=t.n()).done;){var n=_(e.value,2)[1];n.onCheckTimer&&n.onCheckTimer(this._checkCount)}}catch(r){t.e(r)}finally{t.f()}}},{key:"_initReadyList",value:function(){var e=this;this._readyList=[this._moduleMap.get(Ff),this._moduleMap.get(Wf)],this._readyList.forEach((function(t){t.ready((function(){return e._onModuleReady()}))}))}},{key:"_onModuleReady",value:function(){var e=!0;if(this._readyList.forEach((function(t){t.isReady()||(e=!1)})),e&&!this._isReady){this._isReady=!0,this._outerEmitter.emit(Mr.SDK_READY);var t=Date.now()-this._startLoginTs;Gl.w("SDK is ready. cost ".concat(t," ms")),this._startLoginTs=Date.now();var n=this._moduleMap.get($f).getNetworkType(),o=this._ssoLogForReady.getStartTs()+Al;this._ssoLogForReady.setNetworkType(n).setMessage(t).start(o).end()}}},{key:"login",value:function(){0===this._startLoginTs&&(Rl(),this._startLoginTs=Date.now(),this._startTimer(),this._moduleMap.get($f).start(),this._ssoLogForReady=new w_("sdkReady"),this._reason=r_)}},{key:"onLoginFailed",value:function(){this._startLoginTs=0}},{key:"getOuterEmitterInstance",value:function(){return null===this._outerEmitter&&(this._outerEmitter=new _k,FI(this._outerEmitter),this._outerEmitter._emit=this._outerEmitter.emit,this._outerEmitter.emit=function(e,t){var n=this;if(e===Mr.CONVERSATION_LIST_UPDATED||e===Mr.FRIEND_LIST_UPDATED||e===Mr.GROUP_LIST_UPDATED||e===Mr.TOTAL_UNREAD_MESSAGE_COUNT_UPDATED)if(this._eventThrottleMap.has(e)){var o=Date.now(),r=this._eventThrottleMap.get(e);o-r.last<1e3?(r.timeoutID&&clearTimeout(r.timeoutID),r.timeoutID=setTimeout((function(){r.last=o,n._outerEmitter._emit.apply(n._outerEmitter,[e,{name:e,data:n._getEventData(e)}])}),500)):(r.last=o,this._outerEmitter._emit.apply(this._outerEmitter,[e,{name:e,data:this._getEventData(e)}]))}else this._eventThrottleMap.set(e,{last:Date.now(),timeoutID:-1}),this._outerEmitter._emit.apply(this._outerEmitter,[e,{name:e,data:this._getEventData(e)}]);else this._outerEmitter._emit.apply(this._outerEmitter,[e,{name:e,data:arguments[1]}])}.bind(this)),this._outerEmitter}},{key:"_getEventData",value:function(e){return e===Mr.CONVERSATION_LIST_UPDATED?this._moduleMap.get(Wf).getLocalConversationList():e===Mr.FRIEND_LIST_UPDATED?this._moduleMap.get(jf).getLocalFriendList(!1):e===Mr.GROUP_LIST_UPDATED?this._moduleMap.get(Kf).getLocalGroupList():e===Mr.TOTAL_UNREAD_MESSAGE_COUNT_UPDATED?this._moduleMap.get(Wf).getTotalUnreadMessageCount():void 0}},{key:"getInnerEmitterInstance",value:function(){return null===this._innerEmitter&&(this._innerEmitter=new _k,this._innerEmitter._emit=this._innerEmitter.emit,this._innerEmitter.emit=function(e,t){var n;n=od(arguments[1])&&arguments[1].data?[e,{name:arguments[0],data:arguments[1].data}]:[e,{name:arguments[0],data:arguments[1]}],this._innerEmitter._emit.apply(this._innerEmitter,n)}.bind(this)),this._innerEmitter}},{key:"hasModule",value:function(e){return this._moduleMap.has(e)}},{key:"getModule",value:function(e){return this._moduleMap.get(e)}},{key:"isReady",value:function(){return this._isReady}},{key:"isIntl",value:function(){return this.getModule(Yf).isIntl()}},{key:"getNotReadyReason",value:function(){return this._reason}},{key:"setNotReadyReason",value:function(e){this._reason=e}},{key:"getErrorMessage",value:function(e,t,n){return this._moduleMap.get(gh).get({key:e,replacement1:t,replacement2:n,isIntl:this.isIntl()})}},{key:"outputWarning",value:function(e,t,n){var o=this.getErrorMessage(e,t,n);o&&Gl.w(o)}},{key:"onError",value:function(e){var t="code:".concat(e.code," message:").concat(e.message);Gl.w("Oops! ".concat(t)),new w_("error").setMessage(t).setNetworkType(this.getModule($f).getNetworkType()).setLevel("error").end(),this.getOuterEmitterInstance().emit(Mr.ERROR,e)}},{key:"restartTimer",value:function(){Gl.l("".concat(this._n,".restartTimer")),this.stopTimer(),this._startTimer(),this.getModule(Kf).restartPolling()}},{key:"reset",value:function(){Gl.l("".concat(this._n,".reset")),Rl();var e,t=S(this._moduleMap);try{for(t.s();!(e=t.n()).done;){var n=_(e.value,2)[1];n.reset&&n.reset()}}catch(s){t.e(s)}finally{t.f()}this._startLoginTs=0,this._initReadyList(),this._isReady=!1,this.stopTimer(),this._outerEmitter.emit(Mr.SDK_NOT_READY);var o,r=S(this._eventThrottleMap);try{for(r.s();!(o=r.n()).done;){var i=_(o.value,2)[1];i.timeoutID&&clearTimeout(i.timeoutID)}}catch(s){r.e(s)}finally{r.f()}this._eventThrottleMap.clear()}}]),e}(),jD=function(){function e(t){r(this,e),this._funcMap=new Map,this._m=t}return a(e,[{key:"defense",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;if("string"!=typeof e)return null;if(0===e.length)return null;if("function"!=typeof t)return null;if(this._funcMap.has(e)&&this._funcMap.get(e).has(t))return this._funcMap.get(e).get(t);this._funcMap.has(e)||this._funcMap.set(e,new Map);var o=null;return this._funcMap.get(e).has(t)?o=this._funcMap.get(e).get(t):(o=this._pack(e,t,n),this._funcMap.get(e).set(t,o)),o}},{key:"defenseOnce",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;return"function"!=typeof t?null:this._pack(e,t,n)}},{key:"find",value:function(e,t){return"string"!=typeof e||0===e.length||"function"!=typeof t?null:this._funcMap.has(e)&&this._funcMap.get(e).has(t)?this._funcMap.get(e).get(t):(this._m.outputWarning("ListenerFnNotFound",e),null)}},{key:"delete",value:function(e,t){return"function"==typeof t&&!!this._funcMap.has(e)&&!!this._funcMap.get(e).has(t)&&(this._funcMap.get(e).delete(t),0===this._funcMap.get(e).size&&this._funcMap.delete(e),!0)}},{key:"_pack",value:function(e,t,n){var o=this;return function(){try{t.apply(n,Array.from(arguments))}catch(c){var r=Object.values(Mr).indexOf(e),i="CallbackError";if(-1!==r){var a=Object.keys(Mr)[r];o._m.outputWarning(i,a,c)}new w_(i).setMessage("eventName:".concat(e)).setMoreMessage(c.message).end()}}}}]),e}(),zD=function(){function e(t){r(this,e);var n={SDKAppID:t.SDKAppID,unlimitedAVChatRoom:t.unlimitedAVChatRoom||!1,scene:t.scene||"",oversea:t.oversea||!1,instanceID:Od(),devMode:t.devMode||!1,proxyServer:t.proxyServer||void 0};this._m=new KD(n),this._safetyCallbackFactory=new jD(this._m)}return a(e,[{key:"onError",value:function(e){this._m.onError(e)}},{key:"login",value:function(e){return this._m.login(),this._getModule(Ff).login(e)}},{key:"logout",value:function(){var e=this;return this._getModule(Ff).logout().then((function(t){return e._m.reset(),t}))}},{key:"isReady",value:function(){return this._m.isReady()}},{key:"isIntl",value:function(){return this._m.isIntl()}},{key:"getNotReadyReason",value:function(){return this._m.getNotReadyReason()}},{key:"getErrorMessage",value:function(e,t,n){return this._m.getErrorMessage(e,t,n)}},{key:"_getModule",value:function(e){return this._m.getModule(e)}},{key:"destroy",value:function(){var e=this;return this.logout().finally((function(){e._m.stopTimer(),e._getModule(sh).terminate(),e._getModule(rh).dealloc();var t=e._m.getOuterEmitterInstance(),n=e._getModule(Yf);t.emit(Mr.SDK_DESTROY,{SDKAppID:n.getSDKAppID()})}))}},{key:"on",value:function(e,t,n){Gl.d("on","eventName:".concat(e)),this._m.getOuterEmitterInstance().on(e,this._safetyCallbackFactory.defense(e,t,n),n)}},{key:"once",value:function(e,t,n){Gl.d("once","eventName:".concat(e)),this._m.getOuterEmitterInstance().once(e,this._safetyCallbackFactory.defenseOnce(e,t,n),n||this)}},{key:"off",value:function(e,t,n,o){Gl.d("off","eventName:".concat(e));var r=this._safetyCallbackFactory.find(e,t);null!==r&&(this._m.getOuterEmitterInstance().off(e,r,n,o),this._safetyCallbackFactory.delete(e,t))}},{key:"registerPlugin",value:function(e){id(e["tim-offline-push-plugin"])?this._getModule(th).registerPlugin(e):this._getModule(dh).registerPlugin(e)}},{key:"setLogLevel",value:function(e){if(e<=0){var t=this.getErrorMessage("TIM_ASCII_ART");t&&console.log(t);var n=this.getErrorMessage("API_REFER");n&&(zd()?console.log("%c ".concat("IM SDK API ->"," %c"),"background:#ff9d00; padding:1px; border-radius:3px; color: #fff","background:transparent",n):console.log("IM SDK API ->",n));var o=this.getErrorMessage("DOCS_GUIDE");o&&console.log(o)}Gl.setLevel(e)}},{key:"createTextMessage",value:function(e){return this._getModule(qf).createTextMessage(e)}},{key:"createTextAtMessage",value:function(e){return this._getModule(qf).createTextMessage(e)}},{key:"createImageMessage",value:function(e){return this._getModule(qf).createImageMessage(e)}},{key:"createAudioMessage",value:function(e){return this._getModule(qf).createAudioMessage(e)}},{key:"createVideoMessage",value:function(e){return this._getModule(qf).createVideoMessage(e)}},{key:"createCustomMessage",value:function(e){return this._getModule(qf).createCustomMessage(e)}},{key:"createFaceMessage",value:function(e){return this._getModule(qf).createFaceMessage(e)}},{key:"createFileMessage",value:function(e){return this._getModule(qf).createFileMessage(e)}},{key:"createLocationMessage",value:function(e){return this._getModule(qf).createLocationMessage(e)}},{key:"createMergerMessage",value:function(e){return this._getModule(qf).createMergerMessage(e)}},{key:"downloadMergerMessage",value:function(e){return e.type!==Ir.MSG_MERGER?BI({code:hm}):Yd(e.payload.downloadKey)?BI({code:gm}):this._getModule(qf).downloadMergerMessage(e).catch((function(e){return BI({code:vm})}))}},{key:"createForwardMessage",value:function(e){return this._getModule(qf).createForwardMessage(e)}},{key:"sendMessage",value:function(e,t){return e instanceof PI?this._getModule(qf).sendMessageInstance(e,t):BI({code:jv})}},{key:"callExperimentalAPI",value:function(e,t){return"sendComboMessage"===e?this._getModule(hh).sendMessage(t):"handleGroupInvitation"===e?this._getModule(Kf).handleGroupInvitation(t):"isCommercialAbilityEnabled"===e?this._getModule(lh).isFeatureEnabled(t):"isIntl"===e?this.isIntl():"sendTRTCCustomData"===e?this._getModule(fh).sendTRTCCustomData(t):BI({code:Qm})}},{key:"revokeMessage",value:function(e){return this._getModule(qf).revokeMessage(e)}},{key:"resendMessage",value:function(e){return this._getModule(qf).resendMessage(e)}},{key:"deleteMessage",value:function(e){return this._getModule(qf).deleteMessage(e)}},{key:"translateText",value:function(e){return this._getModule(qf).translateText(e)}},{key:"setMessageExtensions",value:function(e,t){return this._getModule(Bf).setMessageExtensions(e,t)}},{key:"getMessageExtensions",value:function(e){return this._getModule(Bf).getMessageExtensions(e)}},{key:"deleteMessageExtensions",value:function(e,t){return this._getModule(Bf).deleteMessageExtensions(e,t)}},{key:"modifyMessage",value:function(e){return this._getModule(qf).modifyRemoteMessage(e)}},{key:"getMessageList",value:function(e){return this._getModule(Wf).getMessageList(e)}},{key:"getMessageListHopping",value:function(e){return this._getModule(Wf).getMessageListHopping(e)}},{key:"sendMessageReadReceipt",value:function(e){return this._getModule(Wf).sendReadReceipt(e)}},{key:"getMessageReadReceiptList",value:function(e){return this._getModule(Wf).getReadReceiptList(e)}},{key:"getGroupMessageReadMemberList",value:function(e){return this._getModule(Kf).getReadReceiptDetail(e)}},{key:"findMessage",value:function(e){return this._getModule(Wf).findMessage(e)}},{key:"setMessageRead",value:function(e){return this._getModule(Wf).setMessageRead(e)}},{key:"getConversationList",value:function(e){return this._getModule(Wf).getConversationList(e)}},{key:"getConversationProfile",value:function(e){return this._getModule(Wf).getConversationProfile(e)}},{key:"deleteConversation",value:function(e){return this._getModule(Wf).deleteConversation(e)}},{key:"clearHistoryMessage",value:function(e){return this._getModule(Wf).clearHistoryMessage(e)}},{key:"pinConversation",value:function(e){return this._getModule(Wf).pinConversation(e)}},{key:"setAllMessageRead",value:function(e){return this._getModule(Wf).setAllMessageRead(e)}},{key:"setMessageRemindType",value:function(e){return this._getModule(Wf).setMessageRemindType(e)}},{key:"getTotalUnreadMessageCount",value:function(){return this._getModule(Wf).getTotalUnreadMessageCount()}},{key:"setConversationCustomData",value:function(e){return this._getModule(Wf).setConversationCustomData(e)}},{key:"markConversation",value:function(e){return this._getModule(Wf).markConversation(e)}},{key:"getConversationGroupList",value:function(){return this._getModule(Wf).getConversationGroupList()}},{key:"createConversationGroup",value:function(e){return this._getModule(Wf).createConversationGroup(e)}},{key:"deleteConversationGroup",value:function(e){return this._getModule(Wf).deleteConversationGroup(e)}},{key:"renameConversationGroup",value:function(e){return this._getModule(Wf).renameConversationGroup(e)}},{key:"addConversationsToGroup",value:function(e){return this._getModule(Wf).addConversationsToGroup(e)}},{key:"deleteConversationsFromGroup",value:function(e){return this._getModule(Wf).deleteConversationsFromGroup(e)}},{key:"getMyProfile",value:function(){return this._getModule(Vf).getMyProfile()}},{key:"getUserProfile",value:function(e){return this._getModule(Vf).getUserProfile(e)}},{key:"updateMyProfile",value:function(e){return this._getModule(Vf).updateMyProfile(e)}},{key:"getBlacklist",value:function(){return this._getModule(Vf).getLocalBlacklist()}},{key:"addToBlacklist",value:function(e){return this._getModule(Vf).addBlacklist(e)}},{key:"removeFromBlacklist",value:function(e){return this._getModule(Vf).deleteBlacklist(e)}},{key:"setSelfStatus",value:function(e){return this._getModule(Vf).setSelfStatus(e)}},{key:"getUserStatus",value:function(e){return this._getModule(Vf).getUserStatus(e)}},{key:"subscribeUserStatus",value:function(e){return this._getModule(Vf).subscribeUserStatus(e)}},{key:"unsubscribeUserStatus",value:function(e){return this._getModule(Vf).unsubscribeUserStatus(e)}},{key:"getFriendList",value:function(){var e=this._getModule(jf);return e?e.getLocalFriendList():BI({code:n_})}},{key:"addFriend",value:function(e){var t=this._getModule(jf);return t?t.addFriend(e):BI({code:n_})}},{key:"deleteFriend",value:function(e){var t=this._getModule(jf);return t?t.deleteFriend(e):BI({code:n_})}},{key:"checkFriend",value:function(e){var t=this._getModule(jf);return t?t.checkFriend(e):BI({code:n_})}},{key:"getFriendProfile",value:function(e){var t=this._getModule(jf);return t?t.getFriendProfile(e):BI({code:n_})}},{key:"updateFriend",value:function(e){var t=this._getModule(jf);return t?t.updateFriend(e):BI({code:n_})}},{key:"getFriendApplicationList",value:function(){var e=this._getModule(jf);return e?e.getLocalFriendApplicationList():BI({code:n_})}},{key:"acceptFriendApplication",value:function(e){var t=this._getModule(jf);return t?t.acceptFriendApplication(e):BI({code:n_})}},{key:"refuseFriendApplication",value:function(e){var t=this._getModule(jf);return t?t.refuseFriendApplication(e):BI({code:n_})}},{key:"deleteFriendApplication",value:function(e){var t=this._getModule(jf);return t?t.deleteFriendApplication(e):BI({code:n_})}},{key:"setFriendApplicationRead",value:function(){var e=this._getModule(jf);return e?e.setFriendApplicationRead():BI({code:n_})}},{key:"getFriendGroupList",value:function(){var e=this._getModule(jf);return e?e.getLocalFriendGroupList():BI({code:n_})}},{key:"createFriendGroup",value:function(e){var t=this._getModule(jf);return t?t.createFriendGroup(e):BI({code:n_})}},{key:"deleteFriendGroup",value:function(e){var t=this._getModule(jf);return t?t.deleteFriendGroup(e):BI({code:n_})}},{key:"addToFriendGroup",value:function(e){var t=this._getModule(jf);return t?t.addToFriendGroup(e):BI({code:n_})}},{key:"removeFromFriendGroup",value:function(e){var t=this._getModule(jf);return t?t.removeFromFriendGroup(e):BI({code:n_})}},{key:"renameFriendGroup",value:function(e){var t=this._getModule(jf);return t?t.renameFriendGroup(e):BI({code:n_})}},{key:"getGroupList",value:function(e){return this._getModule(Kf).getGroupList(e)}},{key:"getGroupProfile",value:function(e){return this._getModule(Kf).getGroupProfile(e)}},{key:"createGroup",value:function(e){return this._getModule(Kf).createGroup(e)}},{key:"dismissGroup",value:function(e){return this._getModule(Kf).dismissGroup(e)}},{key:"updateGroupProfile",value:function(e){return this._getModule(Kf).updateGroupProfile(e)}},{key:"joinGroup",value:function(e){return this._getModule(Kf).joinGroup(e)}},{key:"quitGroup",value:function(e){return this._getModule(Kf).quitGroup(e)}},{key:"searchGroupByID",value:function(e){return this._getModule(Kf).searchGroupByID(e)}},{key:"getGroupOnlineMemberCount",value:function(e){return this._getModule(Kf).getGroupOnlineMemberCount(e)}},{key:"changeGroupOwner",value:function(e){return this._getModule(Kf).changeGroupOwner(e)}},{key:"getGroupApplicationList",value:function(){return this._getModule(Kf).getGroupApplicationList()}},{key:"handleGroupApplication",value:function(e){return this._getModule(Kf).handleGroupApplication(e)}},{key:"initGroupAttributes",value:function(e){return this._getModule(Kf).initGroupAttributes(e)}},{key:"setGroupAttributes",value:function(e){return this._getModule(Kf).setGroupAttributes(e)}},{key:"deleteGroupAttributes",value:function(e){return this._getModule(Kf).deleteGroupAttributes(e)}},{key:"getGroupAttributes",value:function(e){return this._getModule(Kf).getGroupAttributes(e)}},{key:"setGroupCounters",value:function(e){return this._getModule(Kf).setGroupCounters(e)}},{key:"increaseGroupCounter",value:function(e){return this._getModule(Kf).increaseGroupCounter(e)}},{key:"decreaseGroupCounter",value:function(e){return this._getModule(Kf).decreaseGroupCounter(e)}},{key:"getGroupCounters",value:function(e){return this._getModule(Kf).getGroupCounters(e)}},{key:"getGroupMemberList",value:function(e){return this._getModule(zf).getGroupMemberList(e)}},{key:"getGroupMemberProfile",value:function(e){return this._getModule(zf).getGroupMemberProfile(e)}},{key:"addGroupMember",value:function(e){return this._getModule(zf).addGroupMember(e)}},{key:"deleteGroupMember",value:function(e){return this._getModule(zf).deleteGroupMember(e)}},{key:"setGroupMemberMuteTime",value:function(e){return this._getModule(zf).setGroupMemberMuteTime(e)}},{key:"setGroupMemberRole",value:function(e){return this._getModule(zf).setGroupMemberRole(e)}},{key:"setGroupMemberNameCard",value:function(e){return this._getModule(zf).setGroupMemberNameCard(e)}},{key:"setGroupMemberCustomField",value:function(e){return this._getModule(zf).setGroupMemberCustomField(e)}},{key:"markGroupMemberList",value:function(e){return this._getModule(zf).markGroupMemberList(e)}},{key:"getJoinedCommunityList",value:function(){return this._getModule(Zf).getJoinedCommunityList()}},{key:"createTopicInCommunity",value:function(e){return this._getModule(Zf).createTopicInCommunity(e)}},{key:"deleteTopicFromCommunity",value:function(e){return this._getModule(Zf).deleteTopicFromCommunity(e)}},{key:"updateTopicProfile",value:function(e){return this._getModule(Zf).updateTopicProfile(e)}},{key:"getTopicList",value:function(e){return this._getModule(Zf).getTopicList(e)}}]),e}(),ZD={login:1,logout:1,destroy:1,on:1,off:1,ready:1,setLogLevel:1,joinGroup:1,quitGroup:1,registerPlugin:1,getGroupOnlineMemberCount:1};function WD(e,t){if(e.isReady()||1===ZD[t])return!0;var n=e.getNotReadyReason(),o={code:n,message:"".concat(e.getErrorMessage(n)," | ").concat(t," | ").concat(e.getErrorMessage(o_))};return e.onError(o),o}var YD={},JD={create:function(e){var n=0,o=e.SDKAppID;if(ed(o))n=o;else if(n=parseInt(o),isNaN(o))return Gl.e("".concat("TIM.create"," failed. Failed to parse the SDKAppID, please check the arguments")),null;if(n&&YD[n])return YD[n];Gl.l("".concat("TIM.create"));var r=new zD(t(t({},e),{},{SDKAppID:n}));r.on(Mr.SDK_DESTROY,(function(e){YD[e.data.SDKAppID]=null,delete YD[e.data.SDKAppID]}));var i=function(e){var t=Object.create(null);return Object.keys(If).forEach((function(n){if(e[n]){var o=new br;t[n]=function(){var t=Array.from(arguments);return o.use((function(t,o){var r=WD(e,n);return!0===r?o():BI(r)})).use((function(e,t){if(!0===Jd(e,Mf[n],n))return t()})).use((function(t,o){return e[n].apply(e,t)})),o.run(t)}}})),t}(r);return YD[n]=i,Mf.hookGetAPITips(r.getErrorMessage.bind(r)),Gl.l("".concat("TIM.create"," ok")),i}};return JD.TYPES=Ir,JD.EVENT=Mr,JD.VERSION="2.26.3",Gl.l("TIM.VERSION:".concat(JD.VERSION)),JD}()},3437:function(e,t,n){"use strict";e.exports=function(){function e(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function t(t){for(var n=1;n<arguments.length;n++){var o=null!=arguments[n]?arguments[n]:{};n%2?e(Object(o),!0).forEach((function(e){s(t,e,o[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):e(Object(o)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(o,e))}))}return t}function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function a(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&l(e,t)}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function l(e,t){return(l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function d(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function p(e,t,n){return(p=d()?Reflect.construct:function(e,t,n){var o=[null];o.push.apply(o,t);var r=new(Function.bind.apply(e,o));return n&&l(r,n.prototype),r}).apply(null,arguments)}function f(e){var t="function"==typeof Map?new Map:void 0;return(f=function(e){if(null===e||(n=e,-1===Function.toString.call(n).indexOf("[native code]")))return e;var n;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,o)}function o(){return p(e,arguments,c(this).constructor)}return o.prototype=Object.create(e.prototype,{constructor:{value:o,enumerable:!1,writable:!0,configurable:!0}}),l(o,e)})(e)}function h(e,t){if(null==e)return{};var n,o,r=function(e,t){if(null==e)return{};var n,o,r={},i=Object.keys(e);for(o=0;o<i.length;o++)n=i[o],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function g(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function v(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return g(e)}function m(e){var t=d();return function(){var n,o=c(e);if(t){var r=c(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return v(this,n)}}function _(e,t){return M(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var o,r,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(o=n.next()).done)&&(i.push(o.value),!t||i.length!==t);a=!0);}catch(c){s=!0,r=c}finally{try{a||null==n.return||n.return()}finally{if(s)throw r}}return i}}(e,t)||C(e,t)||T()}function y(e){return function(e){if(Array.isArray(e))return k(e)}(e)||I(e)||C(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function M(e){if(Array.isArray(e))return e}function I(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function C(e,t){if(e){if("string"==typeof e)return k(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?k(e,t):void 0}}function k(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}function T(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function S(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=C(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var o=0,r=function(){};return{s:r,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}var b="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof n.g?n.g:"undefined"!=typeof self?self:{};function D(e,t){return e(t={exports:{}},t.exports),t.exports}var E,A,L=function(e){return e&&e.Math==Math&&e},R=L("object"==typeof globalThis&&globalThis)||L("object"==typeof window&&window)||L("object"==typeof self&&self)||L("object"==typeof b&&b)||function(){return this}()||Function("return this")(),w=function(e){try{return!!e()}catch(t){return!0}},O=!w((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]})),N=!w((function(){var e=function(){}.bind();return"function"!=typeof e||e.hasOwnProperty("prototype")})),P=Function.prototype.call,G=N?P.bind(P):function(){return P.apply(P,arguments)},U={}.propertyIsEnumerable,x=Object.getOwnPropertyDescriptor,F={f:x&&!U.call({1:2},1)?function(e){var t=x(this,e);return!!t&&t.enumerable}:U},q=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}},B=Function.prototype,V=B.bind,H=B.call,K=N&&V.bind(H,H),j=N?function(e){return e&&K(e)}:function(e){return e&&function(){return H.apply(e,arguments)}},z=j({}.toString),Z=j("".slice),W=function(e){return Z(z(e),8,-1)},Y=R.Object,J=j("".split),X=w((function(){return!Y("z").propertyIsEnumerable(0)}))?function(e){return"String"==W(e)?J(e,""):Y(e)}:Y,$=R.TypeError,Q=function(e){if(null==e)throw $("Can't call method on "+e);return e},ee=function(e){return X(Q(e))},te=function(e){return"function"==typeof e},ne=function(e){return"object"==typeof e?null!==e:te(e)},oe=function(e){return te(e)?e:void 0},re=function(e,t){return arguments.length<2?oe(R[e]):R[e]&&R[e][t]},ie=j({}.isPrototypeOf),ae=re("navigator","userAgent")||"",se=R.process,ue=R.Deno,ce=se&&se.versions||ue&&ue.version,le=ce&&ce.v8;le&&(A=(E=le.split("."))[0]>0&&E[0]<4?1:+(E[0]+E[1])),!A&&ae&&(!(E=ae.match(/Edge\/(\d+)/))||E[1]>=74)&&(E=ae.match(/Chrome\/(\d+)/))&&(A=+E[1]);var de=A,pe=!!Object.getOwnPropertySymbols&&!w((function(){var e=Symbol();return!String(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&de&&de<41})),fe=pe&&!Symbol.sham&&"symbol"==typeof Symbol.iterator,he=R.Object,ge=fe?function(e){return"symbol"==typeof e}:function(e){var t=re("Symbol");return te(t)&&ie(t.prototype,he(e))},ve=R.String,me=function(e){try{return ve(e)}catch(t){return"Object"}},_e=R.TypeError,ye=function(e){if(te(e))return e;throw _e(me(e)+" is not a function")},Me=function(e,t){var n=e[t];return null==n?void 0:ye(n)},Ie=R.TypeError,Ce=Object.defineProperty,ke=function(e,t){try{Ce(R,e,{value:t,configurable:!0,writable:!0})}catch(o){R[e]=t}return t},Te=R["__core-js_shared__"]||ke("__core-js_shared__",{}),Se=D((function(e){(e.exports=function(e,t){return Te[e]||(Te[e]=void 0!==t?t:{})})("versions",[]).push({version:"3.21.0",mode:"global",copyright:"\xa9 2014-2022 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.21.0/LICENSE",source:"https://github.com/zloirock/core-js"})})),be=R.Object,De=function(e){return be(Q(e))},Ee=j({}.hasOwnProperty),Ae=Object.hasOwn||function(e,t){return Ee(De(e),t)},Le=0,Re=Math.random(),we=j(1..toString),Oe=function(e){return"Symbol("+(void 0===e?"":e)+")_"+we(++Le+Re,36)},Ne=Se("wks"),Pe=R.Symbol,Ge=Pe&&Pe.for,Ue=fe?Pe:Pe&&Pe.withoutSetter||Oe,xe=function(e){if(!Ae(Ne,e)||!pe&&"string"!=typeof Ne[e]){var t="Symbol."+e;pe&&Ae(Pe,e)?Ne[e]=Pe[e]:Ne[e]=fe&&Ge?Ge(t):Ue(t)}return Ne[e]},Fe=R.TypeError,qe=xe("toPrimitive"),Be=function(e,t){if(!ne(e)||ge(e))return e;var n,o=Me(e,qe);if(o){if(void 0===t&&(t="default"),n=G(o,e,t),!ne(n)||ge(n))return n;throw Fe("Can't convert object to primitive value")}return void 0===t&&(t="number"),function(e,t){var n,o;if("string"===t&&te(n=e.toString)&&!ne(o=G(n,e)))return o;if(te(n=e.valueOf)&&!ne(o=G(n,e)))return o;if("string"!==t&&te(n=e.toString)&&!ne(o=G(n,e)))return o;throw Ie("Can't convert object to primitive value")}(e,t)},Ve=function(e){var t=Be(e,"string");return ge(t)?t:t+""},He=R.document,Ke=ne(He)&&ne(He.createElement),je=function(e){return Ke?He.createElement(e):{}},ze=!O&&!w((function(){return 7!=Object.defineProperty(je("div"),"a",{get:function(){return 7}}).a})),Ze=Object.getOwnPropertyDescriptor,We={f:O?Ze:function(e,t){if(e=ee(e),t=Ve(t),ze)try{return Ze(e,t)}catch(o){}if(Ae(e,t))return q(!G(F.f,e,t),e[t])}},Ye=O&&w((function(){return 42!=Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype})),Je=R.String,Xe=R.TypeError,$e=function(e){if(ne(e))return e;throw Xe(Je(e)+" is not an object")},Qe=R.TypeError,et=Object.defineProperty,nt=Object.getOwnPropertyDescriptor,ot={f:O?Ye?function(e,t,n){if($e(e),t=Ve(t),$e(n),"function"==typeof e&&"prototype"===t&&"value"in n&&"writable"in n&&!n.writable){var o=nt(e,t);o&&o.writable&&(e[t]=n.value,n={configurable:"configurable"in n?n.configurable:o.configurable,enumerable:"enumerable"in n?n.enumerable:o.enumerable,writable:!1})}return et(e,t,n)}:et:function(e,t,n){if($e(e),t=Ve(t),$e(n),ze)try{return et(e,t,n)}catch(r){}if("get"in n||"set"in n)throw Qe("Accessors not supported");return"value"in n&&(e[t]=n.value),e}},rt=O?function(e,t,n){return ot.f(e,t,q(1,n))}:function(e,t,n){return e[t]=n,e},it=j(Function.toString);te(Te.inspectSource)||(Te.inspectSource=function(e){return it(e)});var at,st,ut,ct=Te.inspectSource,lt=R.WeakMap,dt=te(lt)&&/native code/.test(ct(lt)),pt=Se("keys"),ft=function(e){return pt[e]||(pt[e]=Oe(e))},ht={},gt=R.TypeError,vt=R.WeakMap;if(dt||Te.state){var mt=Te.state||(Te.state=new vt),_t=j(mt.get),yt=j(mt.has),Mt=j(mt.set);at=function(e,t){if(yt(mt,e))throw new gt("Object already initialized");return t.facade=e,Mt(mt,e,t),t},st=function(e){return _t(mt,e)||{}},ut=function(e){return yt(mt,e)}}else{var It=ft("state");ht[It]=!0,at=function(e,t){if(Ae(e,It))throw new gt("Object already initialized");return t.facade=e,rt(e,It,t),t},st=function(e){return Ae(e,It)?e[It]:{}},ut=function(e){return Ae(e,It)}}var Ct={set:at,get:st,has:ut,enforce:function(e){return ut(e)?st(e):at(e,{})},getterFor:function(e){return function(t){var n;if(!ne(t)||(n=st(t)).type!==e)throw gt("Incompatible receiver, "+e+" required");return n}}},kt=Function.prototype,Tt=O&&Object.getOwnPropertyDescriptor,St=Ae(kt,"name"),bt={EXISTS:St,PROPER:St&&"something"===function(){}.name,CONFIGURABLE:St&&(!O||O&&Tt(kt,"name").configurable)},Dt=D((function(e){var t=bt.CONFIGURABLE,n=Ct.get,o=Ct.enforce,r=String(String).split("String");(e.exports=function(e,n,i,a){var s,u=!!a&&!!a.unsafe,c=!!a&&!!a.enumerable,l=!!a&&!!a.noTargetGet,d=a&&void 0!==a.name?a.name:n;te(i)&&("Symbol("===String(d).slice(0,7)&&(d="["+String(d).replace(/^Symbol\(([^)]*)\)/,"$1")+"]"),(!Ae(i,"name")||t&&i.name!==d)&&rt(i,"name",d),(s=o(i)).source||(s.source=r.join("string"==typeof d?d:""))),e!==R?(u?!l&&e[n]&&(c=!0):delete e[n],c?e[n]=i:rt(e,n,i)):c?e[n]=i:ke(n,i)})(Function.prototype,"toString",(function(){return te(this)&&n(this).source||ct(this)}))})),Et=Math.ceil,At=Math.floor,Lt=function(e){var t=+e;return t!=t||0===t?0:(t>0?At:Et)(t)},Rt=Math.max,wt=Math.min,Ot=function(e,t){var n=Lt(e);return n<0?Rt(n+t,0):wt(n,t)},Nt=Math.min,Pt=function(e){return e>0?Nt(Lt(e),9007199254740991):0},Gt=function(e){return Pt(e.length)},Ut=function(e){return function(t,n,o){var r,i=ee(t),a=Gt(i),s=Ot(o,a);if(e&&n!=n){for(;a>s;)if((r=i[s++])!=r)return!0}else for(;a>s;s++)if((e||s in i)&&i[s]===n)return e||s||0;return!e&&-1}},xt={includes:Ut(!0),indexOf:Ut(!1)},Ft=xt.indexOf,qt=j([].push),Bt=function(e,t){var n,o=ee(e),r=0,i=[];for(n in o)!Ae(ht,n)&&Ae(o,n)&&qt(i,n);for(;t.length>r;)Ae(o,n=t[r++])&&(~Ft(i,n)||qt(i,n));return i},Vt=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],Ht=Vt.concat("length","prototype"),Kt={f:Object.getOwnPropertyNames||function(e){return Bt(e,Ht)}},jt={f:Object.getOwnPropertySymbols},zt=j([].concat),Zt=re("Reflect","ownKeys")||function(e){var t=Kt.f($e(e)),n=jt.f;return n?zt(t,n(e)):t},Wt=function(e,t,n){for(var o=Zt(t),r=ot.f,i=We.f,a=0;a<o.length;a++){var s=o[a];Ae(e,s)||n&&Ae(n,s)||r(e,s,i(t,s))}},Yt=/#|\.prototype\./,Jt=function(e,t){var n=$t[Xt(e)];return n==en||n!=Qt&&(te(t)?w(t):!!t)},Xt=Jt.normalize=function(e){return String(e).replace(Yt,".").toLowerCase()},$t=Jt.data={},Qt=Jt.NATIVE="N",en=Jt.POLYFILL="P",tn=Jt,nn=We.f,on=function(e,t){var n,o,r,i,a,s=e.target,u=e.global,c=e.stat;if(n=u?R:c?R[s]||ke(s,{}):(R[s]||{}).prototype)for(o in t){if(i=t[o],r=e.noTargetGet?(a=nn(n,o))&&a.value:n[o],!tn(u?o:s+(c?".":"#")+o,e.forced)&&void 0!==r){if(typeof i==typeof r)continue;Wt(i,r)}(e.sham||r&&r.sham)&&rt(i,"sham",!0),Dt(n,o,i,e)}},rn={};rn[xe("toStringTag")]="z";var an="[object z]"===String(rn),sn=xe("toStringTag"),un=R.Object,cn="Arguments"==W(function(){return arguments}()),ln=an?W:function(e){var t,n,o;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(n=function(e,t){try{return e[t]}catch(n){}}(t=un(e),sn))?n:cn?W(t):"Object"==(o=W(t))&&te(t.callee)?"Arguments":o},dn=R.String,pn=function(e){if("Symbol"===ln(e))throw TypeError("Cannot convert a Symbol value to a string");return dn(e)},fn="\t\n\v\f\r \xa0\u1680\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029\ufeff",hn=j("".replace),gn="["+fn+"]",vn=RegExp("^"+gn+gn+"*"),mn=RegExp(gn+gn+"*$"),_n=function(e){return function(t){var n=pn(Q(t));return 1&e&&(n=hn(n,vn,"")),2&e&&(n=hn(n,mn,"")),n}},yn={start:_n(1),end:_n(2),trim:_n(3)},Mn=yn.trim,In=R.parseInt,Cn=R.Symbol,kn=Cn&&Cn.iterator,Tn=/^[+-]?0x/i,Sn=j(Tn.exec),bn=8!==In(fn+"08")||22!==In(fn+"0x16")||kn&&!w((function(){In(Object(kn))}))?function(e,t){var n=Mn(pn(e));return In(n,t>>>0||(Sn(Tn,n)?16:10))}:In;on({global:!0,forced:parseInt!=bn},{parseInt:bn});var Dn=j([].slice),En=R.Function,An=j([].concat),Ln=j([].join),Rn={},wn=function(e,t,n){if(!Ae(Rn,t)){for(var o=[],r=0;r<t;r++)o[r]="a["+r+"]";Rn[t]=En("C,a","return new C("+Ln(o,",")+")")}return Rn[t](e,n)},On=N?En.bind:function(e){var t=ye(this),n=t.prototype,o=Dn(arguments,1),r=function n(){var r=An(o,Dn(arguments));return this instanceof n?wn(t,r.length,r):t.apply(e,r)};return ne(n)&&(r.prototype=n),r};on({target:"Function",proto:!0,forced:Function.bind!==On},{bind:On});var Nn,Pn=Object.keys||function(e){return Bt(e,Vt)},Gn={f:O&&!Ye?Object.defineProperties:function(e,t){$e(e);for(var n,o=ee(t),r=Pn(t),i=r.length,a=0;i>a;)ot.f(e,n=r[a++],o[n]);return e}},Un=re("document","documentElement"),xn=ft("IE_PROTO"),Fn=function(){},qn=function(e){return"<script>"+e+"<\/script>"},Bn=function(e){e.write(qn("")),e.close();var t=e.parentWindow.Object;return e=null,t},Vn=function(){try{Nn=new ActiveXObject("htmlfile")}catch(r){}var e,t;Vn="undefined"!=typeof document?document.domain&&Nn?Bn(Nn):((t=je("iframe")).style.display="none",Un.appendChild(t),t.src=String("javascript:"),(e=t.contentWindow.document).open(),e.write(qn("document.F=Object")),e.close(),e.F):Bn(Nn);for(var n=Vt.length;n--;)delete Vn.prototype[Vt[n]];return Vn()};ht[xn]=!0;var Hn=Object.create||function(e,t){var n;return null!==e?(Fn.prototype=$e(e),n=new Fn,Fn.prototype=null,n[xn]=e):n=Vn(),void 0===t?n:Gn.f(n,t)};on({target:"Object",stat:!0,sham:!O},{create:Hn});var Kn=j(j.bind),jn=function(e,t){return ye(e),void 0===t?e:N?Kn(e,t):function(){return e.apply(t,arguments)}},zn=Array.isArray||function(e){return"Array"==W(e)},Zn=function(){},Wn=[],Yn=re("Reflect","construct"),Jn=/^\s*(?:class|function)\b/,Xn=j(Jn.exec),$n=!Jn.exec(Zn),Qn=function(e){if(!te(e))return!1;try{return Yn(Zn,Wn,e),!0}catch(t){return!1}},eo=function(e){if(!te(e))return!1;switch(ln(e)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return $n||!!Xn(Jn,ct(e))}catch(t){return!0}};eo.sham=!0;var to=!Yn||w((function(){var e;return Qn(Qn.call)||!Qn(Object)||!Qn((function(){e=!0}))||e}))?eo:Qn,no=xe("species"),oo=R.Array,ro=function(e,t){return new(function(e){var t;return zn(e)&&(t=e.constructor,(to(t)&&(t===oo||zn(t.prototype))||ne(t)&&null===(t=t[no]))&&(t=void 0)),void 0===t?oo:t}(e))(0===t?0:t)},io=j([].push),ao=function(e){var t=1==e,n=2==e,o=3==e,r=4==e,i=6==e,a=7==e,s=5==e||i;return function(u,c,l,d){for(var p,f,h=De(u),g=X(h),v=jn(c,l),m=Gt(g),_=0,y=d||ro,M=t?y(u,m):n||a?y(u,0):void 0;m>_;_++)if((s||_ in g)&&(f=v(p=g[_],_,h),e))if(t)M[_]=f;else if(f)switch(e){case 3:return!0;case 5:return p;case 6:return _;case 2:io(M,p)}else switch(e){case 4:return!1;case 7:io(M,p)}return i?-1:o||r?r:M}},so={forEach:ao(0),map:ao(1),filter:ao(2),some:ao(3),every:ao(4),find:ao(5),findIndex:ao(6),filterReject:ao(7)},uo=function(e,t){var n=[][e];return!!n&&w((function(){n.call(null,t||function(){throw 1},1)}))},co=so.forEach,lo=uo("forEach")?[].forEach:function(e){return co(this,e,arguments.length>1?arguments[1]:void 0)};on({target:"Array",proto:!0,forced:[].forEach!=lo},{forEach:lo});var po=an?{}.toString:function(){return"[object "+ln(this)+"]"};an||Dt(Object.prototype,"toString",po,{unsafe:!0});var fo={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},ho=je("span").classList,go=ho&&ho.constructor&&ho.constructor.prototype,vo=go===Object.prototype?void 0:go,mo=function(e){if(e&&e.forEach!==lo)try{rt(e,"forEach",lo)}catch(t){e.forEach=lo}};for(var _o in fo)fo[_o]&&mo(R[_o]&&R[_o].prototype);mo(vo);var yo=w((function(){Pn(1)}));on({target:"Object",stat:!0,forced:yo},{keys:function(e){return Pn(De(e))}});var Mo=function(e,t,n){var o,r;$e(e);try{if(!(o=Me(e,"return"))){if("throw"===t)throw n;return n}o=G(o,e)}catch(a){r=!0,o=a}if("throw"===t)throw n;if(r)throw o;return $e(o),n},Io=function(e,t,n,o){try{return o?t($e(n)[0],n[1]):t(n)}catch(i){Mo(e,"throw",i)}},Co={},ko=xe("iterator"),To=Array.prototype,So=function(e){return void 0!==e&&(Co.Array===e||To[ko]===e)},bo=function(e,t,n){var o=Ve(t);o in e?ot.f(e,o,q(0,n)):e[o]=n},Do=xe("iterator"),Eo=function(e){if(null!=e)return Me(e,Do)||Me(e,"@@iterator")||Co[ln(e)]},Ao=R.TypeError,Lo=function(e,t){var n=arguments.length<2?Eo(e):t;if(ye(n))return $e(G(n,e));throw Ao(me(e)+" is not iterable")},Ro=R.Array,wo=function(e){var t=De(e),n=to(this),o=arguments.length,r=o>1?arguments[1]:void 0,i=void 0!==r;i&&(r=jn(r,o>2?arguments[2]:void 0));var a,s,u,c,l,d,p=Eo(t),f=0;if(!p||this==Ro&&So(p))for(a=Gt(t),s=n?new this(a):Ro(a);a>f;f++)d=i?r(t[f],f):t[f],bo(s,f,d);else for(l=(c=Lo(t,p)).next,s=n?new this:[];!(u=G(l,c)).done;f++)d=i?Io(c,r,[u.value,f],!0):u.value,bo(s,f,d);return s.length=f,s},Oo=xe("iterator"),No=!1;try{var Po=0,Go={next:function(){return{done:!!Po++}},return:function(){No=!0}};Go[Oo]=function(){return this},Array.from(Go,(function(){throw 2}))}catch(yD){}var Uo=function(e,t){if(!t&&!No)return!1;var n=!1;try{var o={};o[Oo]=function(){return{next:function(){return{done:n=!0}}}},e(o)}catch(yD){}return n},xo=!Uo((function(e){Array.from(e)}));on({target:"Array",stat:!0,forced:xo},{from:wo});var Fo,qo,Bo,Vo=j("".charAt),Ho=j("".charCodeAt),Ko=j("".slice),jo=function(e){return function(t,n){var o,r,i=pn(Q(t)),a=Lt(n),s=i.length;return a<0||a>=s?e?"":void 0:(o=Ho(i,a))<55296||o>56319||a+1===s||(r=Ho(i,a+1))<56320||r>57343?e?Vo(i,a):o:e?Ko(i,a,a+2):r-56320+(o-55296<<10)+65536}},zo={codeAt:jo(!1),charAt:jo(!0)},Zo=!w((function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype})),Wo=ft("IE_PROTO"),Yo=R.Object,Jo=Yo.prototype,Xo=Zo?Yo.getPrototypeOf:function(e){var t=De(e);if(Ae(t,Wo))return t[Wo];var n=t.constructor;return te(n)&&t instanceof n?n.prototype:t instanceof Yo?Jo:null},$o=xe("iterator"),Qo=!1;[].keys&&("next"in(Bo=[].keys())?(qo=Xo(Xo(Bo)))!==Object.prototype&&(Fo=qo):Qo=!0),(null==Fo||w((function(){var e={};return Fo[$o].call(e)!==e})))&&(Fo={}),te(Fo[$o])||Dt(Fo,$o,(function(){return this}));var er={IteratorPrototype:Fo,BUGGY_SAFARI_ITERATORS:Qo},tr=ot.f,nr=xe("toStringTag"),or=function(e,t,n){e&&!n&&(e=e.prototype),e&&!Ae(e,nr)&&tr(e,nr,{configurable:!0,value:t})},rr=er.IteratorPrototype,ir=function(){return this},ar=function(e,t,n,o){var r=t+" Iterator";return e.prototype=Hn(rr,{next:q(+!o,n)}),or(e,r,!1),Co[r]=ir,e},sr=R.String,ur=R.TypeError,cr=Object.setPrototypeOf||("__proto__"in{}?function(){var e,t=!1,n={};try{(e=j(Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set))(n,[]),t=n instanceof Array}catch(yD){}return function(n,o){return $e(n),function(e){if("object"==typeof e||te(e))return e;throw ur("Can't set "+sr(e)+" as a prototype")}(o),t?e(n,o):n.__proto__=o,n}}():void 0),lr=bt.PROPER,dr=bt.CONFIGURABLE,pr=er.IteratorPrototype,fr=er.BUGGY_SAFARI_ITERATORS,hr=xe("iterator"),gr=function(){return this},vr=function(e,t,n,o,r,i,a){ar(n,t,o);var s,u,c,l=function(e){if(e===r&&g)return g;if(!fr&&e in f)return f[e];switch(e){case"keys":case"values":case"entries":return function(){return new n(this,e)}}return function(){return new n(this)}},d=t+" Iterator",p=!1,f=e.prototype,h=f[hr]||f["@@iterator"]||r&&f[r],g=!fr&&h||l(r),v="Array"==t&&f.entries||h;if(v&&(s=Xo(v.call(new e)))!==Object.prototype&&s.next&&(Xo(s)!==pr&&(cr?cr(s,pr):te(s[hr])||Dt(s,hr,gr)),or(s,d,!0)),lr&&"values"==r&&h&&"values"!==h.name&&(dr?rt(f,"name","values"):(p=!0,g=function(){return G(h,this)})),r)if(u={values:l("values"),keys:i?g:l("keys"),entries:l("entries")},a)for(c in u)(fr||p||!(c in f))&&Dt(f,c,u[c]);else on({target:t,proto:!0,forced:fr||p},u);return f[hr]!==g&&Dt(f,hr,g,{name:r}),Co[t]=g,u},mr=zo.charAt,_r=Ct.set,yr=Ct.getterFor("String Iterator");vr(String,"String",(function(e){_r(this,{type:"String Iterator",string:pn(e),index:0})}),(function(){var e,t=yr(this),n=t.string,o=t.index;return o>=n.length?{value:void 0,done:!0}:(e=mr(n,o),t.index+=e.length,{value:e,done:!1})}));var Mr={SDK_READY:"sdkStateReady",SDK_NOT_READY:"sdkStateNotReady",SDK_DESTROY:"sdkDestroy",MESSAGE_RECEIVED:"onMessageReceived",MESSAGE_MODIFIED:"onMessageModified",MESSAGE_REVOKED:"onMessageRevoked",MESSAGE_READ_BY_PEER:"onMessageReadByPeer",MESSAGE_READ_RECEIPT_RECEIVED:"onMessageReadReceiptReceived",MESSAGE_EXTENSIONS_UPDATED:"onMessageExtensionsUpdated",MESSAGE_EXTENSIONS_DELETED:"onMessageExtensionsDeleted",CONVERSATION_LIST_UPDATED:"onConversationListUpdated",TOTAL_UNREAD_MESSAGE_COUNT_UPDATED:"onTotalUnreadMessageCountUpdated",CONVERSATION_GROUP_LIST_UPDATED:"onConversationGroupListUpdated",CONVERSATION_IN_GROUP_UPDATED:"onConversationInGroupUpdated",GROUP_LIST_UPDATED:"onGroupListUpdated",GROUP_SYSTEM_NOTICE_RECEIVED:"receiveGroupSystemNotice",GROUP_ATTRIBUTES_UPDATED:"groupAttributesUpdated",GROUP_COUNTER_UPDATED:"onGroupCounterUpdated",TOPIC_CREATED:"onTopicCreated",TOPIC_DELETED:"onTopicDeleted",TOPIC_UPDATED:"onTopicUpdated",PROFILE_UPDATED:"onProfileUpdated",USER_STATUS_UPDATED:"onUserStatusUpdated",BLACKLIST_UPDATED:"blacklistUpdated",FRIEND_LIST_UPDATED:"onFriendListUpdated",FRIEND_GROUP_LIST_UPDATED:"onFriendGroupListUpdated",FRIEND_APPLICATION_LIST_UPDATED:"onFriendApplicationListUpdated",KICKED_OUT:"kickedOut",ERROR:"error",NET_STATE_CHANGE:"netStateChange",SDK_RELOAD:"sdkReload"},Ir={MSG_TEXT:"TIMTextElem",MSG_IMAGE:"TIMImageElem",MSG_SOUND:"TIMSoundElem",MSG_AUDIO:"TIMSoundElem",MSG_FILE:"TIMFileElem",MSG_FACE:"TIMFaceElem",MSG_VIDEO:"TIMVideoFileElem",MSG_GEO:"TIMLocationElem",MSG_LOCATION:"TIMLocationElem",MSG_GRP_TIP:"TIMGroupTipElem",MSG_GRP_SYS_NOTICE:"TIMGroupSystemNoticeElem",MSG_CUSTOM:"TIMCustomElem",MSG_MERGER:"TIMRelayElem",MSG_PRIORITY_HIGH:"High",MSG_PRIORITY_NORMAL:"Normal",MSG_PRIORITY_LOW:"Low",MSG_PRIORITY_LOWEST:"Lowest",CONV_C2C:"C2C",CONV_GROUP:"GROUP",CONV_TOPIC:"TOPIC",CONV_SYSTEM:"@TIM#SYSTEM",CONV_AT_ME:1,CONV_AT_ALL:2,CONV_AT_ALL_AT_ME:3,CONV_MARK_TYPE_STAR:1,CONV_MARK_TYPE_UNREAD:2,CONV_MARK_TYPE_FOLD:4,CONV_MARK_TYPE_HIDE:8,GRP_PRIVATE:"Private",GRP_WORK:"Private",GRP_PUBLIC:"Public",GRP_CHATROOM:"ChatRoom",GRP_MEETING:"ChatRoom",GRP_AVCHATROOM:"AVChatRoom",GRP_COMMUNITY:"Community",GRP_MBR_ROLE_OWNER:"Owner",GRP_MBR_ROLE_ADMIN:"Admin",GRP_MBR_ROLE_MEMBER:"Member",GRP_MBR_ROLE_CUSTOM:"Custom",GRP_TIP_MBR_JOIN:1,GRP_TIP_MBR_QUIT:2,GRP_TIP_MBR_KICKED_OUT:3,GRP_TIP_MBR_SET_ADMIN:4,GRP_TIP_MBR_CANCELED_ADMIN:5,GRP_TIP_GRP_PROFILE_UPDATED:6,GRP_TIP_MBR_PROFILE_UPDATED:7,GRP_TIP_BAN_AVCHATROOM_MEMBER:10,GRP_TIP_UNBAN_AVCHATROOM_MEMBER:11,MSG_REMIND_ACPT_AND_NOTE:"AcceptAndNotify",MSG_REMIND_ACPT_NOT_NOTE:"AcceptNotNotify",MSG_REMIND_DISCARD:"Discard",GENDER_UNKNOWN:"Gender_Type_Unknown",GENDER_FEMALE:"Gender_Type_Female",GENDER_MALE:"Gender_Type_Male",KICKED_OUT_MULT_ACCOUNT:"multipleAccount",KICKED_OUT_MULT_DEVICE:"multipleDevice",KICKED_OUT_USERSIG_EXPIRED:"userSigExpired",KICKED_OUT_REST_API:"REST_API_Kick",ALLOW_TYPE_ALLOW_ANY:"AllowType_Type_AllowAny",ALLOW_TYPE_NEED_CONFIRM:"AllowType_Type_NeedConfirm",ALLOW_TYPE_DENY_ANY:"AllowType_Type_DenyAny",FORBID_TYPE_NONE:"AdminForbid_Type_None",FORBID_TYPE_SEND_OUT:"AdminForbid_Type_SendOut",JOIN_OPTIONS_FREE_ACCESS:"FreeAccess",JOIN_OPTIONS_NEED_PERMISSION:"NeedPermission",JOIN_OPTIONS_DISABLE_APPLY:"DisableApply",JOIN_STATUS_SUCCESS:"JoinedSuccess",JOIN_STATUS_ALREADY_IN_GROUP:"AlreadyInGroup",JOIN_STATUS_WAIT_APPROVAL:"WaitAdminApproval",GRP_PROFILE_OWNER_ID:"ownerID",GRP_PROFILE_CREATE_TIME:"createTime",GRP_PROFILE_LAST_INFO_TIME:"lastInfoTime",GRP_PROFILE_MEMBER_NUM:"memberNum",GRP_PROFILE_MAX_MEMBER_NUM:"maxMemberNum",GRP_PROFILE_JOIN_OPTION:"joinOption",GRP_PROFILE_INTRODUCTION:"introduction",GRP_PROFILE_NOTIFICATION:"notification",GRP_PROFILE_MUTE_ALL_MBRS:"muteAllMembers",SNS_ADD_TYPE_SINGLE:"Add_Type_Single",SNS_ADD_TYPE_BOTH:"Add_Type_Both",SNS_DELETE_TYPE_SINGLE:"Delete_Type_Single",SNS_DELETE_TYPE_BOTH:"Delete_Type_Both",SNS_APPLICATION_TYPE_BOTH:"Pendency_Type_Both",SNS_APPLICATION_SENT_TO_ME:"Pendency_Type_ComeIn",SNS_APPLICATION_SENT_BY_ME:"Pendency_Type_SendOut",SNS_APPLICATION_AGREE:"Response_Action_Agree",SNS_APPLICATION_AGREE_AND_ADD:"Response_Action_AgreeAndAdd",SNS_CHECK_TYPE_BOTH:"CheckResult_Type_Both",SNS_CHECK_TYPE_SINGLE:"CheckResult_Type_Single",SNS_TYPE_NO_RELATION:"CheckResult_Type_NoRelation",SNS_TYPE_A_WITH_B:"CheckResult_Type_AWithB",SNS_TYPE_B_WITH_A:"CheckResult_Type_BWithA",SNS_TYPE_BOTH_WAY:"CheckResult_Type_BothWay",NET_STATE_CONNECTED:"connected",NET_STATE_CONNECTING:"connecting",NET_STATE_DISCONNECTED:"disconnected",MSG_AT_ALL:"__kImSDK_MesssageAtALL__",READ_ALL_C2C_MSG:"readAllC2CMessage",READ_ALL_GROUP_MSG:"readAllGroupMessage",READ_ALL_MSG:"readAllMessage",USER_STATUS_UNKNOWN:0,USER_STATUS_ONLINE:1,USER_STATUS_OFFLINE:2,USER_STATUS_UNLOGINED:3},Cr=xe("species"),kr=function(e){return de>=51||!w((function(){var t=[];return(t.constructor={})[Cr]=function(){return{foo:1}},1!==t[e](Boolean).foo}))},Tr=so.map,Sr=kr("map");on({target:"Array",proto:!0,forced:!Sr},{map:function(e){return Tr(this,e,arguments.length>1?arguments[1]:void 0)}});var br=function(){function e(){r(this,e),this.cache=[],this.options=null}return a(e,[{key:"use",value:function(e){if("function"!=typeof e)throw"middleware must be a function";return this.cache.push(e),this}},{key:"next",value:function(e){if(this.middlewares&&this.middlewares.length>0)return this.middlewares.shift().call(this,this.options,this.next.bind(this))}},{key:"run",value:function(e){return this.middlewares=this.cache.map((function(e){return e})),this.options=e,this.next()}}]),e}(),Dr=bt.EXISTS,Er=ot.f,Ar=Function.prototype,Lr=j(Ar.toString),Rr=/function\b(?:\s|\/\*[\S\s]*?\*\/|\/\/[^\n\r]*[\n\r]+)*([^\s(/]*)/,wr=j(Rr.exec);O&&!Dr&&Er(Ar,"name",{configurable:!0,get:function(){try{return wr(Rr,Lr(this))[1]}catch(yD){return""}}});var Or=xe("isConcatSpreadable"),Nr=R.TypeError,Pr=de>=51||!w((function(){var e=[];return e[Or]=!1,e.concat()[0]!==e})),Gr=kr("concat"),Ur=function(e){if(!ne(e))return!1;var t=e[Or];return void 0!==t?!!t:zn(e)};on({target:"Array",proto:!0,forced:!Pr||!Gr},{concat:function(e){var t,n,o,r,i,a=De(this),s=ro(a,0),u=0;for(t=-1,o=arguments.length;t<o;t++)if(Ur(i=-1===t?a:arguments[t])){if(u+(r=Gt(i))>9007199254740991)throw Nr("Maximum allowed index exceeded");for(n=0;n<r;n++,u++)n in i&&bo(s,u,i[n])}else{if(u>=9007199254740991)throw Nr("Maximum allowed index exceeded");bo(s,u++,i)}return s.length=u,s}});var xr=function(e,t,n){var o,r;return cr&&te(o=t.constructor)&&o!==n&&ne(r=o.prototype)&&r!==n.prototype&&cr(e,r),e},Fr=j(1..valueOf),qr=Kt.f,Br=We.f,Vr=ot.f,Hr=yn.trim,Kr=R.Number,jr=Kr.prototype,zr=R.TypeError,Zr=j("".slice),Wr=j("".charCodeAt),Yr=function(e){var t=Be(e,"number");return"bigint"==typeof t?t:Jr(t)},Jr=function(e){var t,n,o,r,i,a,s,u,c=Be(e,"number");if(ge(c))throw zr("Cannot convert a Symbol value to a number");if("string"==typeof c&&c.length>2)if(c=Hr(c),43===(t=Wr(c,0))||45===t){if(88===(n=Wr(c,2))||120===n)return NaN}else if(48===t){switch(Wr(c,1)){case 66:case 98:o=2,r=49;break;case 79:case 111:o=8,r=55;break;default:return+c}for(a=(i=Zr(c,2)).length,s=0;s<a;s++)if((u=Wr(i,s))<48||u>r)return NaN;return parseInt(i,o)}return+c};if(tn("Number",!Kr(" 0o1")||!Kr("0b1")||Kr("+0x1"))){for(var Xr,$r=function e(t){var n=arguments.length<1?0:Kr(Yr(t)),o=this;return ie(jr,o)&&w((function(){Fr(o)}))?xr(Object(n),o,e):n},Qr=O?qr(Kr):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,isFinite,isInteger,isNaN,isSafeInteger,parseFloat,parseInt,fromString,range".split(","),ei=0;Qr.length>ei;ei++)Ae(Kr,Xr=Qr[ei])&&!Ae($r,Xr)&&Vr($r,Xr,Br(Kr,Xr));$r.prototype=jr,jr.constructor=$r,Dt(R,"Number",$r)}var ti=w((function(){Xo(1)}));on({target:"Object",stat:!0,forced:ti,sham:!Zo},{getPrototypeOf:function(e){return Xo(De(e))}}),on({target:"Array",stat:!0},{isArray:zn});var ni,oi,ri=function(){var e=$e(this),t="";return e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.dotAll&&(t+="s"),e.unicode&&(t+="u"),e.sticky&&(t+="y"),t},ii=R.RegExp,ai=w((function(){var e=ii("a","y");return e.lastIndex=2,null!=e.exec("abcd")})),si=ai||w((function(){return!ii("a","y").sticky})),ui={BROKEN_CARET:ai||w((function(){var e=ii("^r","gy");return e.lastIndex=2,null!=e.exec("str")})),MISSED_STICKY:si,UNSUPPORTED_Y:ai},ci=R.RegExp,li=w((function(){var e=ci(".","s");return!(e.dotAll&&e.exec("\n")&&"s"===e.flags)})),di=R.RegExp,pi=w((function(){var e=di("(?<a>b)","g");return"b"!==e.exec("b").groups.a||"bc"!=="b".replace(e,"$<a>c")})),fi=Ct.get,hi=Se("native-string-replace",String.prototype.replace),gi=RegExp.prototype.exec,vi=gi,mi=j("".charAt),_i=j("".indexOf),yi=j("".replace),Mi=j("".slice),Ii=(oi=/b*/g,G(gi,ni=/a/,"a"),G(gi,oi,"a"),0!==ni.lastIndex||0!==oi.lastIndex),Ci=ui.BROKEN_CARET,ki=void 0!==/()??/.exec("")[1];(Ii||ki||Ci||li||pi)&&(vi=function(e){var t,n,o,r,i,a,s,u=this,c=fi(u),l=pn(e),d=c.raw;if(d)return d.lastIndex=u.lastIndex,t=G(vi,d,l),u.lastIndex=d.lastIndex,t;var p=c.groups,f=Ci&&u.sticky,h=G(ri,u),g=u.source,v=0,m=l;if(f&&(h=yi(h,"y",""),-1===_i(h,"g")&&(h+="g"),m=Mi(l,u.lastIndex),u.lastIndex>0&&(!u.multiline||u.multiline&&"\n"!==mi(l,u.lastIndex-1))&&(g="(?: "+g+")",m=" "+m,v++),n=new RegExp("^(?:"+g+")",h)),ki&&(n=new RegExp("^"+g+"$(?!\\s)",h)),Ii&&(o=u.lastIndex),r=G(gi,f?n:u,m),f?r?(r.input=Mi(r.input,v),r[0]=Mi(r[0],v),r.index=u.lastIndex,u.lastIndex+=r[0].length):u.lastIndex=0:Ii&&r&&(u.lastIndex=u.global?r.index+r[0].length:o),ki&&r&&r.length>1&&G(hi,r[0],n,(function(){for(i=1;i<arguments.length-2;i++)void 0===arguments[i]&&(r[i]=void 0)})),r&&p)for(r.groups=a=Hn(null),i=0;i<p.length;i++)a[(s=p[i])[0]]=r[s[1]];return r});var Ti=vi;on({target:"RegExp",proto:!0,forced:/./.exec!==Ti},{exec:Ti});var Si=Date.prototype,bi=j(Si.toString),Di=j(Si.getTime);"Invalid Date"!=String(new Date(NaN))&&Dt(Si,"toString",(function(){var e=Di(this);return e==e?bi(this):"Invalid Date"}));var Ei=bt.PROPER,Ai=RegExp.prototype,Li=Ai.toString,Ri=j(ri),wi=w((function(){return"/a/b"!=Li.call({source:"a",flags:"b"})})),Oi=Ei&&"toString"!=Li.name;(wi||Oi)&&Dt(RegExp.prototype,"toString",(function(){var e=$e(this),t=pn(e.source),n=e.flags;return"/"+t+"/"+pn(void 0===n&&ie(Ai,e)&&!("flags"in Ai)?Ri(e):n)}),{unsafe:!0});var Ni=xe("species"),Pi=RegExp.prototype,Gi=function(e,t,n,o){var r=xe(e),i=!w((function(){var t={};return t[r]=function(){return 7},7!=""[e](t)})),a=i&&!w((function(){var t=!1,n=/a/;return"split"===e&&((n={}).constructor={},n.constructor[Ni]=function(){return n},n.flags="",n[r]=/./[r]),n.exec=function(){return t=!0,null},n[r](""),!t}));if(!i||!a||n){var s=j(/./[r]),u=t(r,""[e],(function(e,t,n,o,r){var a=j(e),u=t.exec;return u===Ti||u===Pi.exec?i&&!r?{done:!0,value:s(t,n,o)}:{done:!0,value:a(n,t,o)}:{done:!1}}));Dt(String.prototype,e,u[0]),Dt(Pi,r,u[1])}o&&rt(Pi[r],"sham",!0)},Ui=zo.charAt,xi=function(e,t,n){return t+(n?Ui(e,t).length:1)},Fi=R.TypeError,qi=function(e,t){var n=e.exec;if(te(n)){var o=G(n,e,t);return null!==o&&$e(o),o}if("RegExp"===W(e))return G(Ti,e,t);throw Fi("RegExp#exec called on incompatible receiver")};Gi("match",(function(e,t,n){return[function(t){var n=Q(this),o=null==t?void 0:Me(t,e);return o?G(o,t,n):new RegExp(t)[e](pn(n))},function(e){var o=$e(this),r=pn(e),i=n(t,o,r);if(i.done)return i.value;if(!o.global)return qi(o,r);var a=o.unicode;o.lastIndex=0;for(var s,u=[],c=0;null!==(s=qi(o,r));){var l=pn(s[0]);u[c]=l,""===l&&(o.lastIndex=xi(r,Pt(o.lastIndex),a)),c++}return 0===c?null:u}]}));var Bi=R.Date,Vi=j(Bi.prototype.getTime);on({target:"Date",stat:!0},{now:function(){return Vi(new Bi)}});var Hi=xe("unscopables"),Ki=Array.prototype;null==Ki[Hi]&&ot.f(Ki,Hi,{configurable:!0,value:Hn(null)});var ji=function(e){Ki[Hi][e]=!0},zi=xt.includes;on({target:"Array",proto:!0},{includes:function(e){return zi(this,e,arguments.length>1?arguments[1]:void 0)}}),ji("includes");var Zi=xe("match"),Wi=function(e){var t;return ne(e)&&(void 0!==(t=e[Zi])?!!t:"RegExp"==W(e))},Yi=R.TypeError,Ji=function(e){if(Wi(e))throw Yi("The method doesn't accept regular expressions");return e},Xi=xe("match"),$i=function(e){var t=/./;try{"/./"[e](t)}catch(o){try{return t[Xi]=!1,"/./"[e](t)}catch(r){}}return!1},Qi=j("".indexOf);on({target:"String",proto:!0,forced:!$i("includes")},{includes:function(e){return!!~Qi(pn(Q(this)),pn(Ji(e)),arguments.length>1?arguments[1]:void 0)}});var ea=R.RangeError,ta=j((function(e){var t=pn(Q(this)),n="",o=Lt(e);if(o<0||1/0==o)throw ea("Wrong number of repetitions");for(;o>0;(o>>>=1)&&(t+=t))1&o&&(n+=t);return n})),na=j("".slice),oa=Math.ceil,ra=function(e){return function(t,n,o){var r,i,a=pn(Q(t)),s=Pt(n),u=a.length,c=void 0===o?" ":pn(o);return s<=u||""==c?a:((i=ta(c,oa((r=s-u)/c.length))).length>r&&(i=na(i,0,r)),e?a+i:i+a)}},ia=[ra(!1),ra(!0)][0],aa=R.RangeError,sa=Math.abs,ua=Date.prototype,ca=ua.toISOString,la=j(ua.getTime),da=j(ua.getUTCDate),pa=j(ua.getUTCFullYear),fa=j(ua.getUTCHours),ha=j(ua.getUTCMilliseconds),ga=j(ua.getUTCMinutes),va=j(ua.getUTCMonth),ma=j(ua.getUTCSeconds),_a=w((function(){return"0385-07-25T07:06:39.999Z"!=ca.call(new Date(-50000000000001))}))||!w((function(){ca.call(new Date(NaN))}))?function(){if(!isFinite(la(this)))throw aa("Invalid time value");var e=pa(this),t=ha(this),n=e<0?"-":e>9999?"+":"";return n+ia(sa(e),n?6:4,0)+"-"+ia(va(this)+1,2,0)+"-"+ia(da(this),2,0)+"T"+ia(fa(this),2,0)+":"+ia(ga(this),2,0)+":"+ia(ma(this),2,0)+"."+ia(t,3,0)+"Z"}:ca;on({target:"Date",proto:!0,forced:Date.prototype.toISOString!==_a},{toISOString:_a});var ya=Function.prototype,Ma=ya.apply,Ia=ya.call,Ca="object"==typeof Reflect&&Reflect.apply||(N?Ia.bind(Ma):function(){return Ia.apply(Ma,arguments)}),ka=Math.floor,Ta=j("".charAt),Sa=j("".replace),ba=j("".slice),Da=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,Ea=/\$([$&'`]|\d{1,2})/g,Aa=function(e,t,n,o,r,i){var a=n+e.length,s=o.length,u=Ea;return void 0!==r&&(r=De(r),u=Da),Sa(i,u,(function(i,u){var c;switch(Ta(u,0)){case"$":return"$";case"&":return e;case"`":return ba(t,0,n);case"'":return ba(t,a);case"<":c=r[ba(u,1,-1)];break;default:var l=+u;if(0===l)return i;if(l>s){var d=ka(l/10);return 0===d?i:d<=s?void 0===o[d-1]?Ta(u,1):o[d-1]+Ta(u,1):i}c=o[l-1]}return void 0===c?"":c}))},La=xe("replace"),Ra=Math.max,wa=Math.min,Oa=j([].concat),Na=j([].push),Pa=j("".indexOf),Ga=j("".slice),Ua="$0"==="a".replace(/./,"$0"),xa=!!/./[La]&&""===/./[La]("a","$0");Gi("replace",(function(e,t,n){var o=xa?"$":"$0";return[function(e,n){var o=Q(this),r=null==e?void 0:Me(e,La);return r?G(r,e,o,n):G(t,pn(o),e,n)},function(e,r){var i=$e(this),a=pn(e);if("string"==typeof r&&-1===Pa(r,o)&&-1===Pa(r,"$<")){var s=n(t,i,a,r);if(s.done)return s.value}var u=te(r);u||(r=pn(r));var c=i.global;if(c){var l=i.unicode;i.lastIndex=0}for(var d=[];;){var p=qi(i,a);if(null===p)break;if(Na(d,p),!c)break;""===pn(p[0])&&(i.lastIndex=xi(a,Pt(i.lastIndex),l))}for(var f,h="",g=0,v=0;v<d.length;v++){for(var m=pn((p=d[v])[0]),_=Ra(wa(Lt(p.index),a.length),0),y=[],M=1;M<p.length;M++)Na(y,void 0===(f=p[M])?f:String(f));var I=p.groups;if(u){var C=Oa([m],y,_,a);void 0!==I&&Na(C,I);var k=pn(Ca(r,void 0,C))}else k=Aa(m,a,_,y,I,r);_>=g&&(h+=Ga(a,g,_)+k,g=_+m.length)}return h+Ga(a,g)}]}),!!w((function(){var e=/./;return e.exec=function(){var e=[];return e.groups={a:"7"},e},"7"!=="".replace(e,"$<a>")}))||!Ua||xa);var Fa=ot.f,qa=Ct.set,Ba=Ct.getterFor("Array Iterator"),Va=vr(Array,"Array",(function(e,t){qa(this,{type:"Array Iterator",target:ee(e),index:0,kind:t})}),(function(){var e=Ba(this),t=e.target,n=e.kind,o=e.index++;return!t||o>=t.length?(e.target=void 0,{value:void 0,done:!0}):"keys"==n?{value:o,done:!1}:"values"==n?{value:t[o],done:!1}:{value:[o,t[o]],done:!1}}),"values"),Ha=Co.Arguments=Co.Array;if(ji("keys"),ji("values"),ji("entries"),O&&"values"!==Ha.name)try{Fa(Ha,"name",{value:"values"})}catch(yD){}var Ka=xe("iterator"),ja=xe("toStringTag"),za=Va.values,Za=function(e,t){if(e){if(e[Ka]!==za)try{rt(e,Ka,za)}catch(yD){e[Ka]=za}if(e[ja]||rt(e,ja,t),fo[t])for(var n in Va)if(e[n]!==Va[n])try{rt(e,n,Va[n])}catch(yD){e[n]=Va[n]}}};for(var Wa in fo)Za(R[Wa]&&R[Wa].prototype,Wa);Za(vo,"DOMTokenList");var Ya=kr("slice"),Ja=xe("species"),Xa=R.Array,$a=Math.max;on({target:"Array",proto:!0,forced:!Ya},{slice:function(e,t){var n,o,r,i=ee(this),a=Gt(i),s=Ot(e,a),u=Ot(void 0===t?a:t,a);if(zn(i)&&(n=i.constructor,(to(n)&&(n===Xa||zn(n.prototype))||ne(n)&&null===(n=n[Ja]))&&(n=void 0),n===Xa||void 0===n))return Dn(i,s,u);for(o=new(void 0===n?Xa:n)($a(u-s,0)),r=0;s<u;s++,r++)s in i&&bo(o,r,i[s]);return o.length=r,o}});var Qa=j([].join),es=X!=Object,ts=uo("join",",");on({target:"Array",proto:!0,forced:es||!ts},{join:function(e){return Qa(ee(this),void 0===e?",":e)}});var ns=xt.indexOf,os=j([].indexOf),rs=!!os&&1/os([1],1,-0)<0,is=uo("indexOf");on({target:"Array",proto:!0,forced:rs||!is},{indexOf:function(e){var t=arguments.length>1?arguments[1]:void 0;return rs?os(this,e,t)||0:ns(this,e,t)}});var as=R.Array,ss=Math.max,us=function(e,t,n){for(var o=Gt(e),r=Ot(t,o),i=Ot(void 0===n?o:n,o),a=as(ss(i-r,0)),s=0;r<i;r++,s++)bo(a,s,e[r]);return a.length=s,a},cs=Kt.f,ls="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],ds={f:function(e){return ls&&"Window"==W(e)?function(e){try{return cs(e)}catch(yD){return us(ls)}}(e):cs(ee(e))}},ps=ds.f,fs=w((function(){return!Object.getOwnPropertyNames(1)}));on({target:"Object",stat:!0,forced:fs},{getOwnPropertyNames:ps});var hs=so.find,gs=!0;"find"in[]&&Array(1).find((function(){gs=!1})),on({target:"Array",proto:!0,forced:gs},{find:function(e){return hs(this,e,arguments.length>1?arguments[1]:void 0)}}),ji("find");var vs,ms=We.f,_s=j("".startsWith),ys=j("".slice),Ms=Math.min,Is=$i("startsWith"),Cs=!(Is||(vs=ms(String.prototype,"startsWith"),!vs||vs.writable));on({target:"String",proto:!0,forced:!Cs&&!Is},{startsWith:function(e){var t=pn(Q(this));Ji(e);var n=Pt(Ms(arguments.length>1?arguments[1]:void 0,t.length)),o=pn(e);return _s?_s(t,o,n):ys(t,n,n+o.length)===o}});var ks,Ts,Ss,bs,Ds=R.Promise,Es=function(e,t,n){for(var o in t)Dt(e,o,t[o],n);return e},As=xe("species"),Ls=function(e){var t=re(e),n=ot.f;O&&t&&!t[As]&&n(t,As,{configurable:!0,get:function(){return this}})},Rs=R.TypeError,ws=function(e,t){if(ie(t,e))return e;throw Rs("Incorrect invocation")},Os=R.TypeError,Ns=function(e,t){this.stopped=e,this.result=t},Ps=Ns.prototype,Gs=function(e,t,n){var o,r,i,a,s,u,c,l=n&&n.that,d=!(!n||!n.AS_ENTRIES),p=!(!n||!n.IS_ITERATOR),f=!(!n||!n.INTERRUPTED),h=jn(t,l),g=function(e){return o&&Mo(o,"normal",e),new Ns(!0,e)},v=function(e){return d?($e(e),f?h(e[0],e[1],g):h(e[0],e[1])):f?h(e,g):h(e)};if(p)o=e;else{if(!(r=Eo(e)))throw Os(me(e)+" is not iterable");if(So(r)){for(i=0,a=Gt(e);a>i;i++)if((s=v(e[i]))&&ie(Ps,s))return s;return new Ns(!1)}o=Lo(e,r)}for(u=o.next;!(c=G(u,o)).done;){try{s=v(c.value)}catch(yD){Mo(o,"throw",yD)}if("object"==typeof s&&s&&ie(Ps,s))return s}return new Ns(!1)},Us=R.TypeError,xs=function(e){if(to(e))return e;throw Us(me(e)+" is not a constructor")},Fs=xe("species"),qs=function(e,t){var n,o=$e(e).constructor;return void 0===o||null==(n=$e(o)[Fs])?t:xs(n)},Bs=R.TypeError,Vs=function(e,t){if(e<t)throw Bs("Not enough arguments");return e},Hs=/(?:ipad|iphone|ipod).*applewebkit/i.test(ae),Ks="process"==W(R.process),js=R.setImmediate,zs=R.clearImmediate,Zs=R.process,Ws=R.Dispatch,Ys=R.Function,Js=R.MessageChannel,Xs=R.String,$s=0,Qs={};try{ks=R.location}catch(yD){}var eu=function(e){if(Ae(Qs,e)){var t=Qs[e];delete Qs[e],t()}},tu=function(e){return function(){eu(e)}},nu=function(e){eu(e.data)},ou=function(e){R.postMessage(Xs(e),ks.protocol+"//"+ks.host)};js&&zs||(js=function(e){Vs(arguments.length,1);var t=te(e)?e:Ys(e),n=Dn(arguments,1);return Qs[++$s]=function(){Ca(t,void 0,n)},Ts($s),$s},zs=function(e){delete Qs[e]},Ks?Ts=function(e){Zs.nextTick(tu(e))}:Ws&&Ws.now?Ts=function(e){Ws.now(tu(e))}:Js&&!Hs?(bs=(Ss=new Js).port2,Ss.port1.onmessage=nu,Ts=jn(bs.postMessage,bs)):R.addEventListener&&te(R.postMessage)&&!R.importScripts&&ks&&"file:"!==ks.protocol&&!w(ou)?(Ts=ou,R.addEventListener("message",nu,!1)):Ts="onreadystatechange"in je("script")?function(e){Un.appendChild(je("script")).onreadystatechange=function(){Un.removeChild(this),eu(e)}}:function(e){setTimeout(tu(e),0)});var ru,iu,au,su,uu,cu,lu,du,pu={set:js,clear:zs},fu=/ipad|iphone|ipod/i.test(ae)&&void 0!==R.Pebble,hu=/web0s(?!.*chrome)/i.test(ae),gu=We.f,vu=pu.set,mu=R.MutationObserver||R.WebKitMutationObserver,_u=R.document,yu=R.process,Mu=R.Promise,Iu=gu(R,"queueMicrotask"),Cu=Iu&&Iu.value;Cu||(ru=function(){var e,t;for(Ks&&(e=yu.domain)&&e.exit();iu;){t=iu.fn,iu=iu.next;try{t()}catch(yD){throw iu?su():au=void 0,yD}}au=void 0,e&&e.enter()},Hs||Ks||hu||!mu||!_u?!fu&&Mu&&Mu.resolve?((lu=Mu.resolve(void 0)).constructor=Mu,du=jn(lu.then,lu),su=function(){du(ru)}):Ks?su=function(){yu.nextTick(ru)}:(vu=jn(vu,R),su=function(){vu(ru)}):(uu=!0,cu=_u.createTextNode(""),new mu(ru).observe(cu,{characterData:!0}),su=function(){cu.data=uu=!uu}));var ku=Cu||function(e){var t={fn:e,next:void 0};au&&(au.next=t),iu||(iu=t,su()),au=t},Tu=function(e){var t,n;this.promise=new e((function(e,o){if(void 0!==t||void 0!==n)throw TypeError("Bad Promise constructor");t=e,n=o})),this.resolve=ye(t),this.reject=ye(n)},Su={f:function(e){return new Tu(e)}},bu=function(e,t){if($e(e),ne(t)&&t.constructor===e)return t;var n=Su.f(e);return(0,n.resolve)(t),n.promise},Du=function(e){try{return{error:!1,value:e()}}catch(yD){return{error:!0,value:yD}}},Eu=function(){this.head=null,this.tail=null};Eu.prototype={add:function(e){var t={item:e,next:null};this.head?this.tail.next=t:this.head=t,this.tail=t},get:function(){var e=this.head;if(e)return this.head=e.next,this.tail===e&&(this.tail=null),e.item}};var Au,Lu,Ru,wu,Ou=Eu,Nu="object"==typeof window,Pu=pu.set,Gu=xe("species"),Uu="Promise",xu=Ct.getterFor(Uu),Fu=Ct.set,qu=Ct.getterFor(Uu),Bu=Ds&&Ds.prototype,Vu=Ds,Hu=Bu,Ku=R.TypeError,ju=R.document,zu=R.process,Zu=Su.f,Wu=Zu,Yu=!!(ju&&ju.createEvent&&R.dispatchEvent),Ju=te(R.PromiseRejectionEvent),Xu=!1,$u=tn(Uu,(function(){var e=ct(Vu),t=e!==String(Vu);if(!t&&66===de)return!0;if(de>=51&&/native code/.test(e))return!1;var n=new Vu((function(e){e(1)})),o=function(e){e((function(){}),(function(){}))};return(n.constructor={})[Gu]=o,!(Xu=n.then((function(){}))instanceof o)||!t&&Nu&&!Ju})),Qu=$u||!Uo((function(e){Vu.all(e).catch((function(){}))})),ec=function(e){var t;return!(!ne(e)||!te(t=e.then))&&t},tc=function(e,t){var n,o,r,i=t.value,a=1==t.state,s=a?e.ok:e.fail,u=e.resolve,c=e.reject,l=e.domain;try{s?(a||(2===t.rejection&&ac(t),t.rejection=1),!0===s?n=i:(l&&l.enter(),n=s(i),l&&(l.exit(),r=!0)),n===e.promise?c(Ku("Promise-chain cycle")):(o=ec(n))?G(o,n,u,c):u(n)):c(i)}catch(yD){l&&!r&&l.exit(),c(yD)}},nc=function(e,t){e.notified||(e.notified=!0,ku((function(){for(var n,o=e.reactions;n=o.get();)tc(n,e);e.notified=!1,t&&!e.rejection&&rc(e)})))},oc=function(e,t,n){var o,r;Yu?((o=ju.createEvent("Event")).promise=t,o.reason=n,o.initEvent(e,!1,!0),R.dispatchEvent(o)):o={promise:t,reason:n},!Ju&&(r=R["on"+e])?r(o):"unhandledrejection"===e&&function(e,t){var n=R.console;n&&n.error&&(1==arguments.length?n.error(e):n.error(e,t))}("Unhandled promise rejection",n)},rc=function(e){G(Pu,R,(function(){var t,n=e.facade,o=e.value;if(ic(e)&&(t=Du((function(){Ks?zu.emit("unhandledRejection",o,n):oc("unhandledrejection",n,o)})),e.rejection=Ks||ic(e)?2:1,t.error))throw t.value}))},ic=function(e){return 1!==e.rejection&&!e.parent},ac=function(e){G(Pu,R,(function(){var t=e.facade;Ks?zu.emit("rejectionHandled",t):oc("rejectionhandled",t,e.value)}))},sc=function(e,t,n){return function(o){e(t,o,n)}},uc=function(e,t,n){e.done||(e.done=!0,n&&(e=n),e.value=t,e.state=2,nc(e,!0))},cc=function e(t,n,o){if(!t.done){t.done=!0,o&&(t=o);try{if(t.facade===n)throw Ku("Promise can't be resolved itself");var r=ec(n);r?ku((function(){var o={done:!1};try{G(r,n,sc(e,o,t),sc(uc,o,t))}catch(yD){uc(o,yD,t)}})):(t.value=n,t.state=1,nc(t,!1))}catch(yD){uc({done:!1},yD,t)}}};if($u&&(Hu=(Vu=function(e){ws(this,Hu),ye(e),G(Au,this);var t=xu(this);try{e(sc(cc,t),sc(uc,t))}catch(yD){uc(t,yD)}}).prototype,(Au=function(e){Fu(this,{type:Uu,done:!1,notified:!1,parent:!1,reactions:new Ou,rejection:!1,state:0,value:void 0})}).prototype=Es(Hu,{then:function(e,t){var n=qu(this),o=Zu(qs(this,Vu));return n.parent=!0,o.ok=!te(e)||e,o.fail=te(t)&&t,o.domain=Ks?zu.domain:void 0,0==n.state?n.reactions.add(o):ku((function(){tc(o,n)})),o.promise},catch:function(e){return this.then(void 0,e)}}),Lu=function(){var e=new Au,t=xu(e);this.promise=e,this.resolve=sc(cc,t),this.reject=sc(uc,t)},Su.f=Zu=function(e){return e===Vu||e===Ru?new Lu(e):Wu(e)},te(Ds)&&Bu!==Object.prototype)){wu=Bu.then,Xu||(Dt(Bu,"then",(function(e,t){var n=this;return new Vu((function(e,t){G(wu,n,e,t)})).then(e,t)}),{unsafe:!0}),Dt(Bu,"catch",Hu.catch,{unsafe:!0}));try{delete Bu.constructor}catch(yD){}cr&&cr(Bu,Hu)}on({global:!0,wrap:!0,forced:$u},{Promise:Vu}),or(Vu,Uu,!1),Ls(Uu),Ru=re(Uu),on({target:Uu,stat:!0,forced:$u},{reject:function(e){var t=Zu(this);return G(t.reject,void 0,e),t.promise}}),on({target:Uu,stat:!0,forced:$u},{resolve:function(e){return bu(this,e)}}),on({target:Uu,stat:!0,forced:Qu},{all:function(e){var t=this,n=Zu(t),o=n.resolve,r=n.reject,i=Du((function(){var n=ye(t.resolve),i=[],a=0,s=1;Gs(e,(function(e){var u=a++,c=!1;s++,G(n,t,e).then((function(e){c||(c=!0,i[u]=e,--s||o(i))}),r)})),--s||o(i)}));return i.error&&r(i.value),n.promise},race:function(e){var t=this,n=Zu(t),o=n.reject,r=Du((function(){var r=ye(t.resolve);Gs(e,(function(e){G(r,t,e).then(n.resolve,o)}))}));return r.error&&o(r.value),n.promise}});var lc=ui.UNSUPPORTED_Y,dc=Math.min,pc=[].push,fc=j(/./.exec),hc=j(pc),gc=j("".slice);Gi("split",(function(e,t,n){var o;return o="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||".".split(/()()/).length>1||"".split(/.?/).length?function(e,n){var o=pn(Q(this)),r=void 0===n?4294967295:n>>>0;if(0===r)return[];if(void 0===e)return[o];if(!Wi(e))return G(t,o,e,r);for(var i,a,s,u=[],c=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":""),l=0,d=new RegExp(e.source,c+"g");(i=G(Ti,d,o))&&!((a=d.lastIndex)>l&&(hc(u,gc(o,l,i.index)),i.length>1&&i.index<o.length&&Ca(pc,u,us(i,1)),s=i[0].length,l=a,u.length>=r));)d.lastIndex===i.index&&d.lastIndex++;return l===o.length?!s&&fc(d,"")||hc(u,""):hc(u,gc(o,l)),u.length>r?us(u,0,r):u}:"0".split(void 0,0).length?function(e,n){return void 0===e&&0===n?[]:G(t,this,e,n)}:t,[function(t,n){var r=Q(this),i=null==t?void 0:Me(t,e);return i?G(i,t,r,n):G(o,pn(r),t,n)},function(e,r){var i=$e(this),a=pn(e),s=n(o,i,a,r,o!==t);if(s.done)return s.value;var u=qs(i,RegExp),c=i.unicode,l=(i.ignoreCase?"i":"")+(i.multiline?"m":"")+(i.unicode?"u":"")+(lc?"g":"y"),d=new u(lc?"^(?:"+i.source+")":i,l),p=void 0===r?4294967295:r>>>0;if(0===p)return[];if(0===a.length)return null===qi(d,a)?[a]:[];for(var f=0,h=0,g=[];h<a.length;){d.lastIndex=lc?0:h;var v,m=qi(d,lc?gc(a,h):a);if(null===m||(v=dc(Pt(d.lastIndex+(lc?h:0)),a.length))===f)h=xi(a,h,c);else{if(hc(g,gc(a,f,h)),g.length===p)return g;for(var _=1;_<=m.length-1;_++)if(hc(g,m[_]),g.length===p)return g;h=f=v}}return hc(g,gc(a,f)),g}]}),!!w((function(){var e=/(?:)/,t=e.exec;e.exec=function(){return t.apply(this,arguments)};var n="ab".split(e);return 2!==n.length||"a"!==n[0]||"b"!==n[1]})),lc);var vc=zo.codeAt;on({target:"String",proto:!0},{codePointAt:function(e){return vc(this,e)}});var mc=yn.trim,_c=j("".charAt),yc=R.parseFloat,Mc=R.Symbol,Ic=Mc&&Mc.iterator,Cc=1/yc(fn+"-0")!=-1/0||Ic&&!w((function(){yc(Object(Ic))}))?function(e){var t=mc(pn(e)),n=yc(t);return 0===n&&"-"==_c(t,0)?-0:n}:yc;on({global:!0,forced:parseFloat!=Cc},{parseFloat:Cc});var kc=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;r(this,e),this.high=t,this.low=n}return a(e,[{key:"equal",value:function(e){return null!==e&&this.low===e.low&&this.high===e.high}},{key:"toString",value:function(){var e=Number(this.high).toString(16),t=Number(this.low).toString(16);if(t.length<8)for(var n=8-t.length;n;)t="0"+t,n--;return e+t}}]),e}(),Tc={TEST:{CHINA:{DEFAULT:"wss://wss-dev.tim.qq.com"},OVERSEA:{DEFAULT:"wss://wss-dev.tim.qq.com"},SINGAPORE:{DEFAULT:"wss://wsssgp-dev.im.qcloud.com"},KOREA:{DEFAULT:"wss://wsskr-dev.im.qcloud.com"},GERMANY:{DEFAULT:"wss://wssger-dev.im.qcloud.com"},IND:{DEFAULT:"wss://wssind-dev.im.qcloud.com"},JPN:{DEFAULT:"wss://wssjpn-dev.im.qcloud.com"},USA:{DEFAULT:"wss://wssusa-dev.im.qcloud.com"}},PRODUCTION:{CHINA:{DEFAULT:"wss://wss.im.qcloud.com",BACKUP:"wss://wss.tim.qq.com",STAT:"https://events.im.qcloud.com"},OVERSEA:{DEFAULT:"wss://wss.im.qcloud.com",BACKUP:"wss://wss.my-imcloud.com",STAT:"https://api.my-imcloud.com"},SINGAPORE:{DEFAULT:"wss://wsssgp.im.qcloud.com",BACKUP:"wss://wsssgp.my-imcloud.com",STAT:"https://apisgp.my-imcloud.com"},KOREA:{DEFAULT:"wss://wsskr.im.qcloud.com",BACKUP:"wss://wsskr.my-imcloud.com",STAT:"https://apikr.my-imcloud.com"},GERMANY:{DEFAULT:"wss://wssger.im.qcloud.com",BACKUP:"wss://wssger.my-imcloud.com",STAT:"https://apiger.my-imcloud.com"},IND:{DEFAULT:"wss://wssind.my-imcloud.com",BACKUP:"wss://wssind.im.qcloud.com",STAT:"https://apiind.my-imcloud.com"},JPN:{DEFAULT:"wss://wssjpn.im.qcloud.com",BACKUP:"wss://wssjpn.my-imcloud.com",STAT:"https://apijpn.my-imcloud.com"},USA:{DEFAULT:"wss://wssusa.im.qcloud.com",BACKUP:"wss://wssusa.my-imcloud.com",STAT:"https://apiusa.my-imcloud.com"}}},Sc={ANDROID:2,IOS:3,MAC:4,WEB:7,WX_MP:8,QQ_MP:9,TT_MP:10,BAIDU_MP:11,ALI_MP:12,IPAD:13,UNI_NATIVE_APP:15},bc="1.7.3",Dc=537048168,Ec="CHINA",Ac="OVERSEA",Lc="SINGAPORE",Rc="KOREA",wc="GERMANY",Oc="IND",Nc="JPN",Pc="USA",Gc={HOST:{CURRENT:{DEFAULT:"wss://wss.im.qcloud.com",STAT:"https://events.im.qcloud.com"},setCurrent:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ec;this.CURRENT=Tc.PRODUCTION[e]}},NAME:{OPEN_IM:"openim",OPEN_IM_MSG_EXT:"openim_msg_ext_http_svc",GROUP:"group_open_http_svc",GROUP_AVCHATROOM:"group_open_avchatroom_http_svc",GROUP_COMMUNITY:"million_group_open_http_svc",GROUP_ATTR:"group_open_attr_http_svc",FRIEND:"sns",PROFILE:"profile",RECENT_CONTACT:"recentcontact",PIC:"openpic",BIG_GROUP_NO_AUTH:"group_open_http_noauth_svc",BIG_GROUP_LONG_POLLING:"group_open_long_polling_http_svc",BIG_GROUP_LONG_POLLING_NO_AUTH:"group_open_long_polling_http_noauth_svc",IM_OPEN_STAT:"imopenstat",WEB_IM:"webim",IM_COS_SIGN:"im_cos_sign_svr",CUSTOM_UPLOAD:"im_cos_msg",HEARTBEAT:"heartbeat",IM_OPEN_PUSH:"im_open_push",IM_OPEN_STATUS:"im_open_status",IM_LONG_MESSAGE:"im_long_msg",IM_CONFIG_MANAGER:"im_sdk_config_mgr",STAT_SERVICE:"StatSvc",OVERLOAD_PUSH:"OverLoadPush",IM_MSG_AUDIT_MGR:"im_msg_audit_mgr",TUIROOM_SVR:"tui_room_svr",IM_OPEN_TRANSLATE:"im_open_translate"},CMD:{LOGIN:"wslogin",LOGOUT_LONG_POLL:"longpollinglogout",LOGOUT:"wslogout",HELLO:"wshello",STAT_BACKGROUND:"ws_stat_background",STAT_FOREGROUND:"ws_stat_foreground",SET_TOKEN:"ws_stat_settoken",PORTRAIT_GET:"portrait_get_all",PORTRAIT_SET:"portrait_set",GET_LONG_POLL_ID:"getlongpollingid",LONG_POLL:"longpolling",AVCHATROOM_LONG_POLL:"get_msg",ADD_FRIEND:"friend_add",UPDATE_FRIEND:"friend_update",GET_FRIEND_LIST:"friend_get",GET_FRIEND_PROFILE:"friend_get_specified",DELETE_FRIEND:"friend_delete",CHECK_FRIEND:"friend_check",GET_FRIEND_GROUP_LIST:"group_get",RESPOND_FRIEND_APPLICATION:"friend_response",GET_FRIEND_APPLICATION_LIST:"pendency_get",DELETE_FRIEND_APPLICATION:"pendency_delete",REPORT_FRIEND_APPLICATION:"pendency_report",GET_GROUP_APPLICATION:"get_pendency",CREATE_FRIEND_GROUP:"group_add",DELETE_FRIEND_GROUP:"group_delete",UPDATE_FRIEND_GROUP:"group_update",GET_BLACKLIST:"black_list_get",ADD_BLACKLIST:"black_list_add",DELETE_BLACKLIST:"black_list_delete",CREATE_GROUP:"create_group",GET_JOINED_GROUPS:"get_joined_group_list",SET_GROUP_ATTRIBUTES:"set_group_attr",MODIFY_GROUP_ATTRIBUTES:"modify_group_attr",DELETE_GROUP_ATTRIBUTES:"delete_group_attr",CLEAR_GROUP_ATTRIBUTES:"clear_group_attr",GET_GROUP_ATTRIBUTES:"get_group_attr",SEND_MESSAGE:"sendmsg",REVOKE_C2C_MESSAGE:"msgwithdraw",DELETE_C2C_MESSAGE:"delete_c2c_msg_ramble",MODIFY_C2C_MESSAGE:"modify_c2c_msg",MODIFY_C2C_MESSAGE_EXTENSIONS:"set_key_values",GET_C2C_MESSAGE_EXTENSIONS:"get_key_values",SEND_GROUP_MESSAGE:"send_group_msg",REVOKE_GROUP_MESSAGE:"group_msg_recall",DELETE_GROUP_MESSAGE:"delete_group_ramble_msg_by_seq",MODIFY_GROUP_MESSAGE:"modify_group_msg",MODIFY_GROUP_MESSAGE_EXTENSIONS:"group_set_key_values",GET_GROUP_MESSAGE_EXTENSIONS:"group_get_key_values",GET_GROUP_INFO:"get_group_self_member_info",GET_GROUP_MEMBER_INFO:"get_specified_group_member_info",GET_GROUP_MEMBER_LIST:"get_group_member_info",GET_AVCHATROOM_MEMBER_LIST:"get_members",MARK_AVCHATROOM_MEMBER_INFO:"modify_user_info",QUIT_GROUP:"quit_group",CHANGE_GROUP_OWNER:"change_group_owner",DESTROY_GROUP:"destroy_group",ADD_GROUP_MEMBER:"add_group_member",DELETE_GROUP_MEMBER:"delete_group_member",BAN_AVCHATROOM_MEMBER:"ban_group_member",SEARCH_GROUP_BY_ID:"get_group_public_info",APPLY_JOIN_GROUP:"apply_join_group",HANDLE_APPLY_JOIN_GROUP:"handle_apply_join_group",HANDLE_GROUP_INVITATION:"handle_invite_join_group",MODIFY_GROUP_INFO:"modify_group_base_info",MODIFY_GROUP_MEMBER_INFO:"modify_group_member_info",DELETE_GROUP_SYSTEM_MESSAGE:"deletemsg",DELETE_GROUP_AT_TIPS:"deletemsg",GET_GROUP_NOTIFY:"get_group_notify",GET_CONVERSATION_LIST:"get",PAGING_GET_CONVERSATION_LIST:"page_get",DELETE_CONVERSATION:"delete",CLEAR_HISTORY_MESSAGE:"clear_msg",PIN_CONVERSATION:"top",SET_CONVERSATION_CUSTOM_DATA:"mark_contact",MARK_CONVERSATION:"mark_contact",CREATE_CONVERSATION_GROUP:"create_contact_group",DELETE_CONVERSATION_GROUP:"del_contact_group",UPDATE_CONVERSATION_GROUP:"update_contact_group",GET_CONVERSATION_GROUP_LIST:"get_contact_group",GET_MESSAGES:"getmsg",GET_C2C_ROAM_MESSAGES:"getroammsg",SET_C2C_PEER_MUTE_NOTIFICATIONS:"set_c2c_peer_mute_notifications",GET_C2C_PEER_MUTE_NOTIFICATIONS:"get_c2c_peer_mute_notifications",GET_GROUP_ROAM_MESSAGES:"group_msg_get",GET_READ_RECEIPT:"get_group_msg_receipt",GET_READ_RECEIPT_DETAIL:"get_group_msg_receipt_detail",SEND_READ_RECEIPT:"group_msg_receipt",SEND_C2C_READ_RECEIPT:"c2c_msg_read_receipt",SET_C2C_MESSAGE_READ:"msgreaded",GET_PEER_READ_TIME:"get_peer_read_time",SET_GROUP_MESSAGE_READ:"msg_read_report",FILE_READ_AND_WRITE_AUTHKEY:"authkey",FILE_UPLOAD:"pic_up",COS_SIGN:"cos",COS_PRE_SIG:"pre_sig",VIDEO_COVER:"video_cover",TIM_WEB_REPORT_V2:"tim_web_report_v2",BIG_DATA_HALLWAY_AUTH_KEY:"authkey",GET_ONLINE_MEMBER_NUM:"get_online_member_num",ALIVE:"alive",MESSAGE_PUSH:"msg_push",MULTI_MESSAGE_PUSH:"multi_msg_push_ws",MESSAGE_PUSH_ACK:"ws_msg_push_ack",STATUS_FORCE_OFFLINE:"stat_forceoffline",DOWNLOAD_MERGER_MESSAGE:"get_relay_json_msg",UPLOAD_MERGER_MESSAGE:"save_relay_json_msg",FETCH_CLOUD_CONTROL_CONFIG:"fetch_config",PUSHED_CLOUD_CONTROL_CONFIG:"push_configv2",FETCH_COMMERCIAL_CONFIG:"fetch_imsdk_purchase_bitsv2",PUSHED_COMMERCIAL_CONFIG:"push_imsdk_purchase_bitsv2",KICK_OTHER:"KickOther",OVERLOAD_NOTIFY:"notify2",SET_ALL_MESSAGE_READ:"read_all_unread_msg",CREATE_TOPIC:"create_topic",DELETE_TOPIC:"destroy_topic",UPDATE_TOPIC_PROFILE:"modify_topic",GET_TOPIC_LIST:"get_topic",SET_SELF_STATUS:"ws_set_custom_status",GET_USER_STATUS:"ws_get_user_status",SUBSCRIBE_USER_STATUS:"ws_status_subscribe",UNSUBSCRIBE_USER_STATUS:"ws_status_unsubscribe",GET_RPOFANITY_LIST:"get_local_words",TRANSLATE_TEXT:"ws_batch_trans_text",UPDATE_GROUP_COUNTER:"update_group_counter",GET_GROUP_COUNTER:"get_group_counter"},CHANNEL:{SOCKET:1,XHR:2,AUTO:0},NAME_VERSION:{openim:"v4",group_open_http_svc:"v4",sns:"v4",profile:"v4",recentcontact:"v4",openpic:"v4",group_open_http_noauth_svc:"v4",group_open_long_polling_http_svc:"v4",group_open_long_polling_http_noauth_svc:"v4",imopenstat:"v4",im_cos_sign_svr:"v4",im_cos_msg:"v4",webim:"v4",im_open_push:"v4",im_open_status:"v4"}},Uc={SEARCH_MSG:new kc(0,Math.pow(2,0)).toString(),SEARCH_GRP_SNS:new kc(0,Math.pow(2,1)).toString(),AVCHATROOM_HISTORY_MSG:new kc(0,Math.pow(2,2)).toString(),GRP_COMMUNITY:new kc(0,Math.pow(2,3)).toString(),MSG_TO_SPECIFIED_GRP_MBR:new kc(0,Math.pow(2,4)).toString(),AVCHATROOM_MBR_LIST:new kc(0,Math.pow(2,6)).toString(),USER_STATUS:new kc(0,Math.pow(2,7)).toString(),CONV_MARK:new kc(0,Math.pow(2,9)).toString(),CONV_GROUP:new kc(0,Math.pow(2,10)).toString(),AVCHATROOM_BAN_MBR:new kc(0,Math.pow(2,11)).toString(),MSG_EXT:new kc(0,Math.pow(2,13)).toString(),GRP_COUNTER:new kc(0,Math.pow(2,15)).toString()},xc="c2c_text_message",Fc="c2c_custom_message",qc="group_text_message",Bc="group_custom_message",Vc="user_profile",Hc="group_profile",Kc="group_member_profile";Gc.HOST.setCurrent(Ec);var jc,zc,Zc,Wc="undefined"!=typeof wx&&"function"==typeof wx.getSystemInfoSync&&Boolean(wx.getSystemInfoSync().fontSizeSetting),Yc="undefined"!=typeof qq&&"function"==typeof qq.getSystemInfoSync&&Boolean(qq.getSystemInfoSync().fontSizeSetting),Jc="undefined"!=typeof tt&&"function"==typeof tt.getSystemInfoSync&&Boolean(tt.getSystemInfoSync().fontSizeSetting),Xc="undefined"!=typeof swan&&"function"==typeof swan.getSystemInfoSync&&Boolean(swan.getSystemInfoSync().fontSizeSetting),$c="undefined"!=typeof my&&"function"==typeof my.getSystemInfoSync&&Boolean(my.getSystemInfoSync().fontSizeSetting),Qc="undefined"!=typeof uni&&"undefined"==typeof window,el="undefined"!=typeof uni,tl=Wc||Yc||Jc||Xc||$c||Qc,nl=("undefined"!=typeof uni||"undefined"!=typeof window)&&!tl,ol=Yc?qq:Jc?tt:Xc?swan:$c?my:Wc?wx:Qc?uni:{},rl=(jc="WEB",ml?jc="WEB":Yc?jc="QQ_MP":Jc?jc="TT_MP":Xc?jc="BAIDU_MP":$c?jc="ALI_MP":Wc?jc="WX_MP":Qc&&(jc="UNI_NATIVE_APP"),Sc[jc]),il=nl&&window&&window.navigator&&window.navigator.userAgent||"",al=/AppleWebKit\/([\d.]+)/i.exec(il),sl=(al&&parseFloat(al.pop()),/iPad/i.test(il)),ul=/iPhone/i.test(il)&&!sl,cl=/iPod/i.test(il),ll=ul||sl||cl,dl=function(){var e=il.match(/OS (\d+)_/i);return e&&e[1]?e[1]:null}(),pl=/Android/i.test(il),fl=function(){var e=il.match(/Android (\d+)(?:\.(\d+))?(?:\.(\d+))*/i);if(!e)return null;var t=e[1]&&parseFloat(e[1]),n=e[2]&&parseFloat(e[2]);return t&&n?parseFloat(e[1]+"."+e[2]):t||null}(),hl=(pl&&/webkit/i.test(il),/Firefox/i.test(il),!/Edge/i.test(il)&&/Chrome/i.test(il),function(){var e=il.match(/Chrome\/(\d+)/);e&&e[1]&&parseFloat(e[1])}(),/MSIE/.test(il)||il.indexOf("Trident")>-1&&il.indexOf("rv:11.0")>-1),gl=(/MSIE\s8\.0/.test(il),function(){var e=/MSIE\s(\d+)\.\d/.exec(il),t=e&&parseFloat(e[1]);return!t&&/Trident\/7.0/i.test(il)&&/rv:11.0/.test(il)&&(t=11),t}()),vl=(/Safari/i.test(il),/TBS\/\d+/i.test(il)),ml=(function(){var e=il.match(/TBS\/(\d+)/i);e&&e[1]&&e[1]}(),!vl&&/MQQBrowser\/\d+/i.test(il),!vl&&/ QQBrowser\/\d+/i.test(il),/(micromessenger|webbrowser)/i.test(il)),_l=/Windows/i.test(il),yl=/MAC OS X/i.test(il),Ml=(/MicroMessenger/i.test(il),nl&&"undefined"!=typeof Worker&&!hl),Il=pl||ll,Cl=nl&&void 0!==window.tencent_cloud_im_csig_flutter_for_web_25F_cy,kl="undefined"!=typeof n.g?n.g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{};zc="undefined"!=typeof console?console:void 0!==kl&&kl.console?kl.console:"undefined"!=typeof window&&window.console?window.console:{};for(var Tl=function(){},Sl=["assert","clear","count","debug","dir","dirxml","error","group","groupCollapsed","groupEnd","info","log","profile","profileEnd","table","time","timeEnd","timeStamp","trace","warn"],bl=Sl.length;bl--;)Zc=Sl[bl],console[Zc]||(zc[Zc]=Tl);var Dl=zc,El=0,Al=function(){return(new Date).getTime()+El},Ll=function(){El=0},Rl=function(){return Math.floor(Al()/1e3)},wl=0;function Ol(){return qd()?"%c TIM %c":"TIM"}function Nl(){var e,t=((e=new Date).setTime(Al()),e);return t.toLocaleTimeString("en-US",{hour12:!1})+"."+function(e){var t;switch(e.toString().length){case 1:t="00"+e;break;case 2:t="0"+e;break;default:t=e}return t}(t.getMilliseconds())}var Pl={arguments2String:function(e){var t="";if(1===e.length)t=e[0];else for(var n=0,o=e.length;n<o;n++)ed(e[n])?nd(e[n])?t+=ud(e[n]):t+=JSON.stringify(e[n]):t+=e[n],t+=" ";return t},_exec:function(e,t){qd()?Dl[e](Ol(),"background:#0abf5b; padding:1px; border-radius:3px; color: #fff","background:transparent",Nl(),t):Dl[e]("".concat(Ol()," ").concat(Nl()," ").concat(t))},d:function(){if(wl<=-1){var e=this.arguments2String(arguments);this._exec("debug",e)}},l:function(){if(wl<=0){var e=this.arguments2String(arguments);this._exec("log",e)}},log:function(){if(wl<=0){var e=this.arguments2String(arguments);this._exec("log",e)}},i:function(){if(wl<=1){var e=this.arguments2String(arguments);this._exec("info",e)}},w:function(){if(wl<=2){var e=this.arguments2String(arguments);this._exec("warn",e)}},e:function(){if(wl<=3){var e=this.arguments2String(arguments);this._exec("error",e)}},setLevel:function(e){e<4&&this._exec("log","set level from "+wl+" to "+e),wl=e},getLevel:function(){return wl}},Gl={JPG:1,JPEG:1,GIF:2,PNG:3,BMP:4,UNKNOWN:255},Ul={NICK:"Tag_Profile_IM_Nick",GENDER:"Tag_Profile_IM_Gender",BIRTHDAY:"Tag_Profile_IM_BirthDay",LOCATION:"Tag_Profile_IM_Location",SELFSIGNATURE:"Tag_Profile_IM_SelfSignature",ALLOWTYPE:"Tag_Profile_IM_AllowType",LANGUAGE:"Tag_Profile_IM_Language",AVATAR:"Tag_Profile_IM_Image",MESSAGESETTINGS:"Tag_Profile_IM_MsgSettings",ADMINFORBIDTYPE:"Tag_Profile_IM_AdminForbidType",LEVEL:"Tag_Profile_IM_Level",ROLE:"Tag_Profile_IM_Role"},xl={UNKNOWN:"Gender_Type_Unknown",FEMALE:"Gender_Type_Female",MALE:"Gender_Type_Male"},Fl={NONE:"AdminForbid_Type_None",SEND_OUT:"AdminForbid_Type_SendOut"},ql={NEED_CONFIRM:"AllowType_Type_NeedConfirm",ALLOW_ANY:"AllowType_Type_AllowAny",DENY_ANY:"AllowType_Type_DenyAny"},Bl="JoinedSuccess",Vl="WaitAdminApproval",Hl="@TGS#_",Kl="@TOPIC#_",jl=["url"],zl=function(e){return"map"===od(e)},Zl=function(e){return"file"===od(e)},Wl=function(e){return null!==e&&("number"==typeof e&&!isNaN(e-0)||"object"===o(e)&&e.constructor===Number)},Yl=function(e){return"string"==typeof e},Jl=function(e){return null!==e&&"object"===o(e)},Xl=function(e){if("object"!==o(e)||null===e)return!1;var t=Object.getPrototypeOf(e);if(null===t)return!0;for(var n=t;null!==Object.getPrototypeOf(n);)n=Object.getPrototypeOf(n);return t===n},$l=function(e){return"function"==typeof Array.isArray?Array.isArray(e):"array"===od(e)},Ql=function(e){return void 0===e},ed=function(e){return $l(e)||Jl(e)},td=function(e){return"function"==typeof e},nd=function(e){return e instanceof Error},od=function(e){return Object.prototype.toString.call(e).match(/^\[object (.*)\]$/)[1].toLowerCase()},rd=function(e){if("string"!=typeof e)return!1;var t=e[0];return!/[^a-zA-Z0-9]/.test(t)},id=0;Date.now||(Date.now=function(){return(new Date).getTime()});var ad=function(){0===id&&(id=Date.now()-1);var e=Date.now()-id;return e>4294967295?(id+=4294967295,Date.now()-id):e},sd=function e(t,n,o,r){if(!ed(t)||!ed(n))return 0;for(var i,a=0,s=Object.keys(n),u=0,c=s.length;u<c;u++)if(i=s[u],!(Ql(n[i])||o&&o.includes(i)))if(ed(t[i])&&ed(n[i]))a+=e(t[i],n[i],o,r);else{if(r&&r.includes(n[i]))continue;t[i]!==n[i]&&(t[i]=n[i],a+=1)}return a},ud=function(e){return JSON.stringify(e,["message","code"])},cd=function(e){if(0===e.length)return 0;for(var t=0,n=0,o="undefined"!=typeof document&&void 0!==document.characterSet?document.characterSet:"UTF-8";void 0!==e[t];)n+=e[t++].charCodeAt[t]<=255?1:!1===o?3:2;return n},ld=function(e){var t=e||99999999;return Math.round(Math.random()*t)},dd="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ",pd=dd.length,fd=function(e,t){for(var n in e)if(e[n]===t)return!0;return!1},hd={},gd=function(e){return-1===e.indexOf("http://")||-1===e.indexOf("https://")?"https://"+e:e.replace(/https|http/,"https")},vd=function e(t){if(0===Object.getOwnPropertyNames(t).length)return Object.create(null);var n=Array.isArray(t)?[]:Object.create(null),r="";for(var i in t)null!==t[i]?void 0!==t[i]?(r=o(t[i]),["string","number","function","boolean"].indexOf(r)>=0?n[i]=t[i]:n[i]=e(t[i])):n[i]=void 0:n[i]=null;return n};function md(e,t){$l(e)&&$l(t)&&t.forEach((function(t){var n=t.key,o=t.value,r=e.find((function(e){return e.key===n}));r?r.value=o:e.push({key:n,value:o})}))}var _d=function(e){return e===Ir.GRP_PUBLIC},yd=function(e){return e===Ir.GRP_AVCHATROOM},Md=function(e){var t=e.type,n=e.groupID;return t===Ir.GRP_COMMUNITY||"".concat(n).startsWith(Hl)&&!"".concat(n).includes(Kl)},Id=function(e){return"".concat(e).startsWith(Hl)&&"".concat(e).includes(Kl)},Cd=function(e){return Yl(e)&&e.slice(0,3)===Ir.CONV_C2C},kd=function(e){return Yl(e)&&e.slice(0,5)===Ir.CONV_GROUP},Td=function(e){return Yl(e)&&e===Ir.CONV_SYSTEM};function Sd(e,t){var n={};return Object.keys(e).forEach((function(o){n[o]=t(e[o],o)})),n}function bd(e){return tl?new Promise((function(t,n){ol.getImageInfo({src:e,success:function(e){t({width:e.width,height:e.height})},fail:function(){t({width:0,height:0})}})})):hl&&9===gl?Promise.resolve({width:0,height:0}):new Promise((function(t,n){var o=new Image;o.onload=function(){t({width:this.width,height:this.height}),o=null},o.onerror=function(){t({width:0,height:0}),o=null},o.src=e}))}function Dd(){function e(){return(65536*(1+Math.random())|0).toString(16).substring(1)}return"".concat(e()+e()).concat(e()).concat(e()).concat(e()).concat(e()).concat(e()).concat(e())}function Ed(){var e="unknown";if(yl&&(e="mac"),_l&&(e="windows"),ll&&(e="ios"),pl&&(e="android"),tl)try{var t=ol.getSystemInfoSync().platform;void 0!==t&&(e=t)}catch(yD){}return e}function Ad(e,t){e=e.split("."),t=t.split(".");for(var n=Math.max(e.length,t.length);e.length<n;)e.push("0");for(;t.length<n;)t.push("0");for(var o=0;o<n;o++){var r=parseInt(e[o]),i=parseInt(t[o]);if(r>i)return 1;if(r<i)return-1}return 0}function Ld(e){var t=e.originUrl,n=void 0===t?void 0:t,o=e.originWidth,r=e.originHeight,i=e.min,a=void 0===i?198:i,s=parseInt(o),u=parseInt(r),c={url:void 0,width:0,height:0};if((s<=u?s:u)<=a)c.url=n,c.width=s,c.height=u;else{u<=s?(c.width=Math.ceil(s*a/u),c.height=a):(c.width=a,c.height=Math.ceil(u*a/s));var l=n&&n.indexOf("?")>-1?"".concat(n,"&"):"".concat(n,"?");c.url="".concat(l,198===a?"imageView2/3/w/198/h/198":"imageView2/3/w/720/h/720")}return Ql(n)?h(c,jl):c}function Rd(e){var t=e[2];e[2]=e[1],e[1]=t;for(var n=0;n<e.length;n++)e[n].setType(n)}function wd(e){var t=e.servcmd;return t.slice(t.indexOf(".")+1)}function Od(e,t){return Math.round(Number(e)*Math.pow(10,t))/Math.pow(10,t)}function Nd(e,t){return e.includes(t)}function Pd(e,t){return e.includes(t)}function Gd(e){return e.split(Kl)[0]}var Ud=function(e,t,n){if(Ql(t))return"";switch(e){case Ir.MSG_TEXT:return t.text;case Ir.MSG_IMAGE:return n?"[Image]":"[\u56fe\u7247]";case Ir.MSG_LOCATION:return n?"[Location]":"[\u4f4d\u7f6e]";case Ir.MSG_AUDIO:return n?"[Voice]":"[\u8bed\u97f3]";case Ir.MSG_VIDEO:return n?"[Video]":"[\u89c6\u9891]";case Ir.MSG_FILE:return n?"[File]":"[\u6587\u4ef6]";case Ir.MSG_CUSTOM:return n?"[Custom Messages]":"[\u81ea\u5b9a\u4e49\u6d88\u606f]";case Ir.MSG_GRP_TIP:return n?"[Group Notification]":"[\u7fa4\u63d0\u793a\u6d88\u606f]";case Ir.MSG_GRP_SYS_NOTICE:return n?"[Group System Message]":"[\u7fa4\u7cfb\u7edf\u901a\u77e5]";case Ir.MSG_FACE:return n?"[Animated Sticker]":"[\u52a8\u753b\u8868\u60c5]";case Ir.MSG_MERGER:return n?"[Chat Record]":"[\u804a\u5929\u8bb0\u5f55]";default:return""}};function xd(e){return e===Ir.MSG_TEXT||e===Ir.MSG_CUSTOM||e===Ir.MSG_LOCATION||e===Ir.MSG_FACE}function Fd(e){var t=[];if(!Yl(e))return t;var n=e.length;if(0===n)return t;for(var o=n-1;o>=0;o--)"1"===e[o]&&t.push(Math.pow(2,n-o-1));return t}function qd(){return!hl&&!tl}function Bd(e){return"the length of userIDList cannot exceed ".concat(e)}var Vd=Object.prototype.hasOwnProperty;function Hd(e){if(null==e)return!0;if("boolean"==typeof e)return!1;if("number"==typeof e)return 0===e;if("string"==typeof e)return 0===e.length;if("function"==typeof e)return 0===e.length;if(Array.isArray(e))return 0===e.length;if(e instanceof Error)return""===e.message;if(Xl(e)){for(var t in e)if(Vd.call(e,t))return!1;return!0}return!(!zl(e)&&(n=e,"set"!==od(n))&&!Zl(e))&&0===e.size;var n}function Kd(e,t,n){if(void 0===t)return!0;var o=!0;if(Xl(t))Object.keys(t).forEach((function(r){var i=1===e.length?e[0][r]:void 0;o=!!jd(i,t[r],n,r)&&o}));else if($l(t))for(var r=0;r<t.length;r++)o=!!jd(e[r],t[r],n,t[r].name)&&o;if(o)return o;throw new Error("Params validate failed.")}function jd(e,t,n,o){if(void 0===t)return!0;var r=!0;return t.required&&Hd(e)&&(Pl.e("[".concat(n,'] Missing required params: "').concat(o,'".')),r=!1),Hd(e)||od(e).toLowerCase()===t.type.toLowerCase()||(Pl.e("[".concat(n,'] Invalid params: type check failed for "').concat(o,'".Expected ').concat(t.type,".")),r=!1),t.validator&&!t.validator(e)&&(Pl.e("[".concat(n,"] Invalid params: custom validator check failed for params.")),r=!1),r}var zd={f:xe},Zd=R,Wd=ot.f,Yd=so.forEach,Jd=ft("hidden"),Xd=xe("toPrimitive"),$d=Ct.set,Qd=Ct.getterFor("Symbol"),ep=Object.prototype,tp=R.Symbol,np=tp&&tp.prototype,op=R.TypeError,rp=R.QObject,ip=re("JSON","stringify"),ap=We.f,sp=ot.f,up=ds.f,cp=F.f,lp=j([].push),dp=Se("symbols"),pp=Se("op-symbols"),fp=Se("string-to-symbol-registry"),hp=Se("symbol-to-string-registry"),gp=Se("wks"),vp=!rp||!rp.prototype||!rp.prototype.findChild,mp=O&&w((function(){return 7!=Hn(sp({},"a",{get:function(){return sp(this,"a",{value:7}).a}})).a}))?function(e,t,n){var o=ap(ep,t);o&&delete ep[t],sp(e,t,n),o&&e!==ep&&sp(ep,t,o)}:sp,_p=function(e,t){var n=dp[e]=Hn(np);return $d(n,{type:"Symbol",tag:e,description:t}),O||(n.description=t),n},yp=function e(t,n,o){t===ep&&e(pp,n,o),$e(t);var r=Ve(n);return $e(o),Ae(dp,r)?(o.enumerable?(Ae(t,Jd)&&t[Jd][r]&&(t[Jd][r]=!1),o=Hn(o,{enumerable:q(0,!1)})):(Ae(t,Jd)||sp(t,Jd,q(1,{})),t[Jd][r]=!0),mp(t,r,o)):sp(t,r,o)},Mp=function(e,t){$e(e);var n=ee(t),o=Pn(n).concat(Tp(n));return Yd(o,(function(t){O&&!G(Ip,n,t)||yp(e,t,n[t])})),e},Ip=function(e){var t=Ve(e),n=G(cp,this,t);return!(this===ep&&Ae(dp,t)&&!Ae(pp,t))&&(!(n||!Ae(this,t)||!Ae(dp,t)||Ae(this,Jd)&&this[Jd][t])||n)},Cp=function(e,t){var n=ee(e),o=Ve(t);if(n!==ep||!Ae(dp,o)||Ae(pp,o)){var r=ap(n,o);return!r||!Ae(dp,o)||Ae(n,Jd)&&n[Jd][o]||(r.enumerable=!0),r}},kp=function(e){var t=up(ee(e)),n=[];return Yd(t,(function(e){Ae(dp,e)||Ae(ht,e)||lp(n,e)})),n},Tp=function(e){var t=e===ep,n=up(t?pp:ee(e)),o=[];return Yd(n,(function(e){!Ae(dp,e)||t&&!Ae(ep,e)||lp(o,dp[e])})),o};if(pe||(np=(tp=function(){if(ie(np,this))throw op("Symbol is not a constructor");var e=arguments.length&&void 0!==arguments[0]?pn(arguments[0]):void 0,t=Oe(e),n=function e(n){this===ep&&G(e,pp,n),Ae(this,Jd)&&Ae(this[Jd],t)&&(this[Jd][t]=!1),mp(this,t,q(1,n))};return O&&vp&&mp(ep,t,{configurable:!0,set:n}),_p(t,e)}).prototype,Dt(np,"toString",(function(){return Qd(this).tag})),Dt(tp,"withoutSetter",(function(e){return _p(Oe(e),e)})),F.f=Ip,ot.f=yp,Gn.f=Mp,We.f=Cp,Kt.f=ds.f=kp,jt.f=Tp,zd.f=function(e){return _p(xe(e),e)},O&&(sp(np,"description",{configurable:!0,get:function(){return Qd(this).description}}),Dt(ep,"propertyIsEnumerable",Ip,{unsafe:!0}))),on({global:!0,wrap:!0,forced:!pe,sham:!pe},{Symbol:tp}),Yd(Pn(gp),(function(e){!function(e){var t=Zd.Symbol||(Zd.Symbol={});Ae(t,e)||Wd(t,e,{value:zd.f(e)})}(e)})),on({target:"Symbol",stat:!0,forced:!pe},{for:function(e){var t=pn(e);if(Ae(fp,t))return fp[t];var n=tp(t);return fp[t]=n,hp[n]=t,n},keyFor:function(e){if(!ge(e))throw op(e+" is not a symbol");if(Ae(hp,e))return hp[e]},useSetter:function(){vp=!0},useSimple:function(){vp=!1}}),on({target:"Object",stat:!0,forced:!pe,sham:!O},{create:function(e,t){return void 0===t?Hn(e):Mp(Hn(e),t)},defineProperty:yp,defineProperties:Mp,getOwnPropertyDescriptor:Cp}),on({target:"Object",stat:!0,forced:!pe},{getOwnPropertyNames:kp,getOwnPropertySymbols:Tp}),on({target:"Object",stat:!0,forced:w((function(){jt.f(1)}))},{getOwnPropertySymbols:function(e){return jt.f(De(e))}}),ip){var Sp=!pe||w((function(){var e=tp();return"[null]"!=ip([e])||"{}"!=ip({a:e})||"{}"!=ip(Object(e))}));on({target:"JSON",stat:!0,forced:Sp},{stringify:function(e,t,n){var o=Dn(arguments),r=t;if((ne(t)||void 0!==e)&&!ge(e))return zn(t)||(t=function(e,t){if(te(r)&&(t=G(r,this,e,t)),!ge(t))return t}),o[1]=t,Ca(ip,null,o)}})}if(!np[Xd]){var bp=np.valueOf;Dt(np,Xd,(function(e){return G(bp,this)}))}or(tp,"Symbol"),ht[Jd]=!0;var Dp=ot.f,Ep=R.Symbol,Ap=Ep&&Ep.prototype;if(O&&te(Ep)&&(!("description"in Ap)||void 0!==Ep().description)){var Lp={},Rp=function(){var e=arguments.length<1||void 0===arguments[0]?void 0:pn(arguments[0]),t=ie(Ap,this)?new Ep(e):void 0===e?Ep():Ep(e);return""===e&&(Lp[t]=!0),t};Wt(Rp,Ep),Rp.prototype=Ap,Ap.constructor=Rp;var wp="Symbol(test)"==String(Ep("test")),Op=j(Ap.toString),Np=j(Ap.valueOf),Pp=/^Symbol\((.*)\)[^)]+$/,Gp=j("".replace),Up=j("".slice);Dp(Ap,"description",{configurable:!0,get:function(){var e=Np(this),t=Op(e);if(Ae(Lp,e))return"";var n=wp?Up(t,7,-1):Gp(t,Pp,"$1");return""===n?void 0:n}}),on({global:!0,forced:!0},{Symbol:Rp})}var xp={UNSEND:"unSend",SUCCESS:"success",FAIL:"fail"},Fp={NOT_START:"notStart",PENDING:"pending",RESOLVED:"resolved",REJECTED:"rejected"},qp=function(e){if(!e)return!1;if(Cd(e)||kd(e)||Td(e))return!0;var t=ff("InvalidConversationID",e);return t&&Pl.w(t),!1},Bp=function(e){""!==e.desc&&""!==ff("API_REFER")&&Pl.w("[".concat(e.api,"] | ").concat(e.param," | ").concat(e.desc,", ").concat(ff("API_REFER")).concat(e.api))},Vp=function(){return ff("StringRequiredLog")},Hp=function(e){return ff("NonEmptyStringRequiredLog",e)},Kp=function(){return ff("NumberRequiredLog")},jp=function(){return ff("UndefinedNotAllowedLog")},zp=function(){return ff("FileRequiredLog")},Zp=function(){return ff("FunctionRequiredLog")},Wp=function(){return ff("ArrayRequiredLog")},Yp=function(){return ff("NonEmptyArrayLog")},Jp=function(){return ff("CallbackMissingLog")},Xp=function(){return ff("PositiveIntegerRequiredLog")},$p=function(e,t){return ff("StringNotLongerThanLog",e,t)},Qp=function(e,t){return ff("NumberLessThanLog",e,t)},ef=function(e){return ff("KeyValueStringRequiredLog",e)},tf=function(){return ff("PlainObjectRequiredLog")},nf=function(){return ff("NonEmptyContentRequiredLog")},of=function(){return ff("FileNotSelectedLog")},rf=function(){return ff("MessageInstanceRequiredLog")},af=function(){return ff("NonAnonymousFunctionLog")},sf=function(){return ff("MessageExtensionNotAvailableLog")},uf={type:"String",required:!0},cf={type:"Array",required:!0},lf={type:"Object",required:!0},df={type:"Boolean",required:!0},pf={type:"number",required:!0},ff=null,hf={hookGetAPITips:function(e){ff=e},login:{userID:uf,userSig:uf},addToBlacklist:{userIDList:cf},removeFromBlacklist:{userIDList:cf},on:[{name:"eventName",type:"String",validator:function(e){return"string"==typeof e&&0!==e.length||(Bp({api:"on",param:"eventName",desc:Hp("eventName")}),!1)}},{name:"handler",type:"Function",validator:function(e){return"function"!=typeof e?(Bp({api:"on",param:"handler",desc:Zp()}),!1):(""===e.name&&Bp({api:"on",param:"handler",desc:af()}),!0)}}],once:[{name:"eventName",type:"String",validator:function(e){return"string"==typeof e&&0!==e.length||(Bp({api:"once",param:"eventName",desc:Hp("eventName")}),!1)}},{name:"handler",type:"Function",validator:function(e){return"function"!=typeof e?(Bp({api:"once",param:"handler",desc:Zp()}),!1):(""===e.name&&Bp({api:"once",param:"handler",desc:af()}),!0)}}],off:[{name:"eventName",type:"String",validator:function(e){return"string"==typeof e&&0!==e.length||(Bp({api:"off",param:"eventName",desc:Hp("eventName")}),!1)}},{name:"handler",type:"Function",validator:function(e){return"function"!=typeof e?(Bp({api:"off",param:"handler",desc:Zp()}),!1):(""===e.name&&Bp({api:"off",param:"handler",desc:af()}),!0)}}],sendMessage:[t({name:"message"},lf)],setMessageExtensions:[t(t({name:"message"},lf),{},{validator:function(e){return e.status===xp.SUCCESS&&!0===e.isSupportExtension||(Bp({api:"setMessageExtensions",param:"message",desc:sf()}),!1)}}),t({name:"extensions"},cf)],getMessageExtensions:[t(t({name:"message"},lf),{},{validator:function(e){return e.status===xp.SUCCESS&&!0===e.isSupportExtension||(Bp({api:"getMessageExtensions",param:"message",desc:sf()}),!1)}})],deleteMessageExtensions:[t(t({name:"message"},lf),{},{validator:function(e){return e.status===xp.SUCCESS&&!0===e.isSupportExtension||(Bp({api:"deleteMessageExtensions",param:"message",desc:sf()}),!1)}})],getMessageList:{conversationID:t(t({},uf),{},{validator:function(e){return qp(e)}}),nextReqMessageID:{type:"String"},count:{type:"Number",validator:function(e){return!(!Ql(e)&&!/^[1-9][0-9]*$/.test(e))||(Bp({api:"getMessageList",param:"count",desc:Xp()}),!1)}}},getMessageListHopping:{conversationID:t(t({},uf),{},{validator:function(e){return qp(e)}}),sequence:{type:"Number"},time:{type:"Number"},direction:{type:"Number",validator:function(e){return!(!Ql(e)&&0!==e&&1!==e)||(Bp({api:"getMessageListHopping",param:"direction",desc:ff("0Or1RequiredLog")}),!1)}},count:{type:"Number",validator:function(e){return!(!Ql(e)&&!/^[1-9][0-9]*$/.test(e))||(Bp({api:"getMessageListHopping",param:"count",desc:Xp}),!1)}}},setMessageRead:{conversationID:t(t({},uf),{},{validator:function(e){return qp(e)}})},setAllMessageRead:{scope:{type:"String",required:!1,validator:function(e){return!e||-1!==[Ir.READ_ALL_C2C_MSG,Ir.READ_ALL_GROUP_MSG,Ir.READ_ALL_MSG].indexOf(e)||(Bp({api:"setAllMessageRead",param:"scope",desc:"TIM.TYPES.READ_ALL_C2C_MSG or TIM.TYPES.READ_ALL_GROUP_MSG or TIM.TYPES.READ_ALL_MSG required"}),!1)}}},getConversationProfile:[t(t({name:"conversationID"},uf),{},{validator:function(e){return qp(e)}})],deleteConversation:[t(t({name:"conversationID"},uf),{},{validator:function(e){return qp(e)}})],clearHistoryMessage:[t(t({name:"conversationID"},uf),{},{validator:function(e){return qp(e)}})],pinConversation:{conversationID:t(t({},uf),{},{validator:function(e){return qp(e)}}),isPinned:t({},df)},setConversationCustomData:{conversationIDList:t({},cf),customData:{type:"String",validator:function(e){return Yl(e)?!(e.length>256)||(Bp({api:"setConversationCustomData",param:"customData",desc:$p("customData",256)}),!1):(Bp({api:"setConversationCustomData",param:"customData",desc:Vp()}),!1)}}},markConversation:{conversationIDList:t({},cf),markType:{type:"number",validator:function(e){return Wl(e)?e<=0?(Bp({api:"markConversation",param:"markType",desc:(t="markType",n=0,ff("NumberGreaterThanLog",t,n))}),!1):!(e>=Math.pow(2,64))||(Bp({api:"markConversation",param:"markType",desc:Qp("markType","Math.pow(2,64)")}),!1):(Bp({api:"markConversation",param:"markType",desc:Kp()}),!1);var t,n}},enableMark:t({},df)},createConversationGroup:{conversationIDList:t({},cf),groupName:t(t({},uf),{},{validator:function(e){return!!e&&(!(e.length>32)||(Bp({api:"createConversationGroup",param:"groupName",desc:$p("groupName",32)}),!1))}})},deleteConversationGroup:[t({name:"groupName"},uf)],renameConversationGroup:{oldName:t({},uf),newName:t(t({},uf),{},{validator:function(e){return!!e&&(!(e.length>32)||(Bp({api:"renameConversationGroup",param:"newName",desc:$p("newName",32)}),!1))}})},addConversationsToGroup:{conversationIDList:t({},cf),groupName:t({},uf)},deleteConversationsFromGroup:{conversationIDList:t({},cf),groupName:t({},uf)},getGroupList:{groupProfileFilter:{type:"Array"}},getGroupProfile:{groupID:uf,groupCustomFieldFilter:{type:"Array"},memberCustomFieldFilter:{type:"Array"}},getGroupProfileAdvance:{groupIDList:cf},createGroup:{name:uf},joinGroup:{groupID:uf,type:{type:"String"},applyMessage:{type:"String"}},quitGroup:[t({name:"groupID"},uf)],handleApplication:{message:lf,handleAction:uf,handleMessage:{type:"String"}},changeGroupOwner:{groupID:uf,newOwnerID:uf},updateGroupProfile:{groupID:uf,muteAllMembers:{type:"Boolean"}},dismissGroup:[t({name:"groupID"},uf)],searchGroupByID:[t({name:"groupID"},uf)],initGroupAttributes:{groupID:uf,groupAttributes:t(t({},lf),{},{validator:function(e){var t=!0;return Object.keys(e).forEach((function(n){if(!Yl(e[n]))return Bp({api:"initGroupAttributes",param:"groupAttributes",desc:ef("value")}),t=!1})),t}})},setGroupAttributes:{groupID:uf,groupAttributes:t(t({},lf),{},{validator:function(e){var t=!0;return Object.keys(e).forEach((function(n){if(!Yl(e[n]))return Bp({api:"setGroupAttributes",param:"groupAttributes",desc:ef("value")}),t=!1})),t}})},deleteGroupAttributes:{groupID:uf,keyList:{type:"Array",validator:function(e){if(Ql(e)||!$l(e))return Bp({api:"deleteGroupAttributes",param:"keyList",desc:Wp()}),!1;if(!Hd(e)){var t=!0;return e.forEach((function(e){if(!Yl(e))return Bp({api:"deleteGroupAttributes",param:"keyList",desc:ff("StringArrayRequiredLog")}),t=!1})),t}return!0}}},getGroupAttributes:{groupID:uf,keyList:{type:"Array",validator:function(e){if(Ql(e)||!$l(e))return Bp({api:"getGroupAttributes",param:"keyList",desc:Wp()}),!1;if(!Hd(e)){var t=!0;return e.forEach((function(e){if(!Yl(e))return Bp({api:"getGroupAttributes",param:"keyList",desc:ef("key")}),t=!1})),t}return!0}}},setGroupCounters:{groupID:uf,counters:lf},increaseGroupCounter:{groupID:uf,key:uf,value:pf},decreaseGroupCounter:{groupID:uf,key:uf,value:pf},getGroupCounters:{groupID:uf},getGroupMemberList:{groupID:uf,count:{type:"Number"}},getGroupMemberProfile:{groupID:uf,userIDList:cf,memberCustomFieldFilter:{type:"Array"}},addGroupMember:{groupID:uf,userIDList:cf},setGroupMemberRole:{groupID:uf,userID:uf,role:uf},setGroupMemberMuteTime:{groupID:uf,userID:uf,muteTime:{type:"Number",validator:function(e){return e>=0}}},setGroupMemberNameCard:{groupID:uf,userID:{type:"String"},nameCard:{type:"String",validator:function(e){return Yl(e)?(e.length,!0):(Bp({api:"setGroupMemberNameCard",param:"nameCard",desc:Vp()}),!1)}}},setGroupMemberCustomField:{groupID:uf,userID:{type:"String"},memberCustomField:cf},deleteGroupMember:{groupID:uf},markGroupMemberList:{groupID:uf,markType:{type:"number",validator:function(e){return Wl(e)?!(e<1e3)||(Bp({api:"markGroupMemberList",param:"markType",desc:(t="markType",n=1e3,ff("NumberGreaterOrEqualLog",t,n))}),!1):(Bp({api:"markGroupMemberList",param:"markType",desc:Kp()}),!1);var t,n}},userIDList:t({},cf),enableMark:t({},df)},createTextMessage:{to:uf,conversationType:uf,payload:t(t({},lf),{},{validator:function(e){return Xl(e)?Yl(e.text)?0!==e.text.length||(Bp({api:"createTextMessage",param:"payload.text",desc:nf()}),!1):(Bp({api:"createTextMessage",param:"payload.text",desc:Vp()}),!1):(Bp({api:"createTextMessage",param:"payload",desc:tf()}),!1)}})},createTextAtMessage:{to:uf,conversationType:uf,payload:t(t({},lf),{},{validator:function(e){return Xl(e)?Yl(e.text)?0===e.text.length?(Bp({api:"createTextAtMessage",param:"payload.text",desc:nf()}),!1):!(e.atUserList&&!$l(e.atUserList))||(Bp({api:"createTextAtMessage",param:"payload.atUserList",desc:Wp()}),!1):(Bp({api:"createTextAtMessage",param:"payload.text",desc:Vp()}),!1):(Bp({api:"createTextAtMessage",param:"payload",desc:tf()}),!1)}})},createCustomMessage:{to:uf,conversationType:uf,payload:t(t({},lf),{},{validator:function(e){return Xl(e)?e.data&&!Yl(e.data)?(Bp({api:"createCustomMessage",param:"payload.data",desc:Vp()}),!1):e.description&&!Yl(e.description)?(Bp({api:"createCustomMessage",param:"payload.description",desc:Vp()}),!1):!(e.extension&&!Yl(e.extension))||(Bp({api:"createCustomMessage",param:"payload.extension",desc:Vp()}),!1):(Bp({api:"createCustomMessage",param:"payload",desc:tf()}),!1)}})},createImageMessage:{to:uf,conversationType:uf,payload:t(t({},lf),{},{validator:function(e){if(!Xl(e))return Bp({api:"createImageMessage",param:"payload",desc:tf()}),!1;if(Ql(e.file))return Bp({api:"createImageMessage",param:"payload.file",desc:jp()}),!1;if(nl){if(!(e.file instanceof HTMLInputElement||Zl(e.file)))return Xl(e.file)&&"undefined"!=typeof uni?0!==e.file.tempFilePaths.length&&0!==e.file.tempFiles.length||(Bp({api:"createImageMessage",param:"payload.file",desc:of()}),!1):(Bp({api:"createImageMessage",param:"payload.file",desc:zp()}),!1);if(e.file instanceof HTMLInputElement&&0===e.file.files.length)return Bp({api:"createImageMessage",param:"payload.file",desc:of()}),!1}return!0},onProgress:{type:"Function",required:!1,validator:function(e){return Ql(e)&&Bp({api:"createImageMessage",param:"onProgress",desc:Jp()}),!0}}})},createAudioMessage:{to:uf,conversationType:uf,payload:t(t({},lf),{},{validator:function(e){return!!Xl(e)||(Bp({api:"createAudioMessage",param:"payload",desc:tf()}),!1)}}),onProgress:{type:"Function",required:!1,validator:function(e){return Ql(e)&&Bp({api:"createAudioMessage",param:"onProgress",desc:Jp()}),!0}}},createVideoMessage:{to:uf,conversationType:uf,payload:t(t({},lf),{},{validator:function(e){if(!Xl(e))return Bp({api:"createVideoMessage",param:"payload",desc:tf()}),!1;if(Ql(e.file))return Bp({api:"createVideoMessage",param:"payload.file",desc:jp()}),!1;if(nl){if(!(e.file instanceof HTMLInputElement||Zl(e.file)))return Xl(e.file)&&"undefined"!=typeof uni?!!Zl(e.file.tempFile)||(Bp({api:"createVideoMessage",param:"payload.file",desc:of()}),!1):(Bp({api:"createVideoMessage",param:"payload.file",desc:zp()}),!1);if(e.file instanceof HTMLInputElement&&0===e.file.files.length)return Bp({api:"createVideoMessage",param:"payload.file",desc:of()}),!1}return!0}}),onProgress:{type:"Function",required:!1,validator:function(e){return Ql(e)&&Bp({api:"createVideoMessage",param:"onProgress",desc:Jp()}),!0}}},createFaceMessage:{to:uf,conversationType:uf,payload:t(t({},lf),{},{validator:function(e){return Xl(e)?Wl(e.index)?!!Yl(e.data)||(Bp({api:"createFaceMessage",param:"payload.data",desc:Vp()}),!1):(Bp({api:"createFaceMessage",param:"payload.index",desc:Kp()}),!1):(Bp({api:"createFaceMessage",param:"payload",desc:tf()}),!1)}})},createFileMessage:{to:uf,conversationType:uf,payload:t(t({},lf),{},{validator:function(e){if(!Xl(e))return Bp({api:"createFileMessage",param:"payload",desc:tf()}),!1;if(Ql(e.file))return Bp({api:"createFileMessage",param:"payload.file",desc:jp()}),!1;if(nl){if(!(e.file instanceof HTMLInputElement||Zl(e.file)))return Xl(e.file)&&"undefined"!=typeof uni?0!==e.file.tempFilePaths.length&&0!==e.file.tempFiles.length||(Bp({api:"createFileMessage",param:"payload.file",desc:of()}),!1):(Bp({api:"createFileMessage",param:"payload.file",desc:zp()}),!1);if(e.file instanceof HTMLInputElement&&0===e.file.files.length)return Bp({api:"createFileMessage",param:"payload.file",desc:of()}),!1}return!0}}),onProgress:{type:"Function",required:!1,validator:function(e){return Ql(e)&&Bp({api:"createFileMessage",param:"onProgress",desc:Jp()}),!0}}},createLocationMessage:{to:uf,conversationType:uf,payload:t(t({},lf),{},{validator:function(e){return Xl(e)?Yl(e.description)?Wl(e.longitude)?!!Wl(e.latitude)||(Bp({api:"createLocationMessage",param:"payload.latitude",desc:Kp()}),!1):(Bp({api:"createLocationMessage",param:"payload.longitude",desc:Kp()}),!1):(Bp({api:"createLocationMessage",param:"payload.description",desc:Vp()}),!1):(Bp({api:"createLocationMessage",param:"payload",desc:tf()}),!1)}})},createMergerMessage:{to:uf,conversationType:uf,payload:t(t({},lf),{},{validator:function(e){if(Hd(e.messageList))return Bp({api:"createMergerMessage",param:"payload.messageList",desc:Yp()}),!1;if(Hd(e.compatibleText))return Bp({api:"createMergerMessage",param:"payload.compatibleText",desc:Hp("compatibleText")}),!1;var t=!1;return e.messageList.forEach((function(e){e.status===xp.FAIL&&(t=!0)})),!t||(Bp({api:"createMergerMessage",param:"payload.messageList",desc:ff("MergeFailedMessageLog")}),!1)}})},revokeMessage:[t(t({name:"message"},lf),{},{validator:function(e){return Hd(e)?(Bp({api:"revokeMessage",param:"message",desc:rf()}),!1):e.conversationType===Ir.CONV_SYSTEM?(Bp({api:"revokeMessage",param:"message",desc:ff("MessageCanBeRevokedDesc")}),!1):!0!==e.isRevoked||(Bp({api:"revokeMessage",param:"message",desc:ff("MessageRevokedLog")}),!1)}})],deleteMessage:[t(t({name:"messageList"},cf),{},{validator:function(e){return!Hd(e)||(Bp({api:"deleteMessage",param:"messageList",desc:Yp()}),!1)}})],translateText:{sourceTextList:cf,sourceLanguage:uf,targetLanguage:uf},modifyMessage:[t(t({name:"message"},lf),{},{validator:function(e){return Hd(e)?(Bp({api:"modifyMessage",param:"message",desc:rf()}),!1):e.conversationType===Ir.CONV_SYSTEM?(Bp({api:"modifyMessage",param:"message",desc:ff("MessageCanBeModifiedLog")}),!1):!0!==e._onlineOnlyFlag||(Bp({api:"modifyMessage",param:"message",desc:ff("OnlineMessageNotSupportLog")}),!1)}})],getUserProfile:{userIDList:{type:"Array",validator:function(e){return $l(e)?(0===e.length&&Bp({api:"getUserProfile",param:"userIDList",desc:Yp()}),!0):(Bp({api:"getUserProfile",param:"userIDList",desc:Wp()}),!1)}}},updateMyProfile:{profileCustomField:{type:"Array",validator:function(e){return!!Ql(e)||!!$l(e)||(Bp({api:"updateMyProfile",param:"profileCustomField",desc:Wp()}),!1)}}},setSelfStatus:{customStatus:{type:"String",validator:function(e){return!!Yl(e)||(Bp({api:"setSelfStatus",param:"customStatus",desc:Vp()}),!1)}}},getUserStatus:{userIDList:{type:"Array",validator:function(e){return $l(e)?0!==e.length||(Bp({api:"getUserStatus",param:"userIDList",desc:Yp()}),!1):(Bp({api:"getUserStatus",param:"userIDList",desc:Wp()}),!1)}}},subscribeUserStatus:{userIDList:{type:"Array",validator:function(e){return $l(e)?0!==e.length||(Bp({api:"subscribeUserStatus",param:"userIDList",desc:Yp()}),!1):(Bp({api:"subscribeUserStatus",param:"userIDList",desc:Wp()}),!1)}}},unsubscribeUserStatus:{userIDList:{type:"Array",validator:function(e){return!e||!!$l(e)||(Bp({api:"subscribeUserStatus",param:"userIDList",desc:Wp()}),!1)}}},addFriend:{to:uf,source:{type:"String",required:!0,validator:function(e){return!!e&&(e.startsWith("AddSource_Type_")?!(e.replace("AddSource_Type_","").length>8)||(Bp({api:"addFriend",param:"source",desc:$p("keyword",8)}),!1):(Bp({api:"addFriend",param:"source",desc:ff("SourcePrefixLog")}),!1))}},remark:{type:"String",required:!1,validator:function(e){return!(Yl(e)&&e.length>96)||(Bp({api:"addFriend",param:"remark",desc:$p("remark",96)}),!1)}}},deleteFriend:{userIDList:cf},checkFriend:{userIDList:cf},getFriendProfile:{userIDList:cf},updateFriend:{userID:uf,remark:{type:"String",required:!1,validator:function(e){return!(Yl(e)&&e.length>96)||(Bp({api:"updateFriend",param:"remark",desc:$p("remark",96)}),!1)}},friendCustomField:{type:"Array",required:!1,validator:function(e){if(e){if(!$l(e))return Bp({api:"updateFriend",param:"friendCustomField",desc:Wp()}),!1;var t=!0;return e.forEach((function(e){return Yl(e.key)&&-1!==e.key.indexOf("Tag_SNS_Custom")?Yl(e.value)?e.key.replace("Tag_SNS_Custom_","").length>8?(Bp({api:"updateFriend",param:"friendCustomField",desc:$p("keyword",8)}),t=!1):void 0:(Bp({api:"updateFriend",param:"friendCustomField",desc:ef("value")}),t=!1):(Bp({api:"updateFriend",param:"friendCustomField",desc:ff("FriendCustomFieldPrefixLog")}),t=!1)})),t}return!0}}},acceptFriendApplication:{userID:uf},refuseFriendApplication:{userID:uf},deleteFriendApplication:{userID:uf},createFriendGroup:{name:uf},deleteFriendGroup:{name:uf},addToFriendGroup:{name:uf,userIDList:cf},removeFromFriendGroup:{name:uf,userIDList:cf},renameFriendGroup:{oldName:uf,newName:uf},sendMessageReadReceipt:[{name:"messageList",type:"Array",validator:function(e){return $l(e)?0!==e.length||(Bp({api:"sendMessageReadReceipt",param:"messageList",desc:Yp()}),!1):(Bp({api:"sendMessageReadReceipt",param:"messageList",desc:Wp()}),!1)}}],getMessageReadReceiptList:[{name:"messageList",type:"Array",validator:function(e){return $l(e)?0!==e.length||(Bp({api:"getMessageReadReceiptList",param:"messageList",desc:Yp()}),!1):(Bp({api:"getMessageReadReceiptList",param:"messageList",desc:Wp()}),!1)}}],createTopicInCommunity:{groupID:uf,topicName:uf},deleteTopicFromCommunity:{groupID:uf,topicIDList:{type:"Array",validator:function(e){return!e||!!$l(e)||(Bp({api:"deleteTopicFromCommunity",param:"topicIDList",desc:Wp()}),!1)}}},updateTopicProfile:{groupID:uf,topicID:uf},getTopicList:{groupID:uf,topicIDList:{type:"Array",validator:function(e){return!e||!!$l(e)||(Bp({api:"getTopicList",param:"topicIDList",desc:Wp()}),!1)}}}},gf={login:1,logout:1,on:1,once:1,off:1,setLogLevel:1,registerPlugin:1,destroy:1,createTextMessage:1,createTextAtMessage:1,createImageMessage:1,createAudioMessage:1,createVideoMessage:1,createCustomMessage:1,createFaceMessage:1,createFileMessage:1,createLocationMessage:1,createMergerMessage:1,downloadMergerMessage:1,createForwardMessage:1,sendMessage:1,resendMessage:1,revokeMessage:1,deleteMessage:1,translateText:1,modifyMessage:1,sendMessageReadReceipt:1,getGroupMessageReadMemberList:1,getMessageReadReceiptList:1,setMessageExtensions:1,getMessageExtensions:1,deleteMessageExtensions:1,getMessageList:1,findMessage:1,getMessageListHopping:1,setMessageRead:1,setAllMessageRead:1,getConversationList:1,getConversationProfile:1,deleteConversation:1,pinConversation:1,getTotalUnreadMessageCount:1,setConversationCustomData:1,markConversation:1,createConversationGroup:1,getConversationGroupList:1,deleteConversationGroup:1,renameConversationGroup:1,addConversationsToGroup:1,deleteConversationsFromGroup:1,clearHistoryMessage:1,getGroupList:1,getGroupProfile:1,createGroup:1,joinGroup:1,updateGroupProfile:1,quitGroup:1,dismissGroup:1,changeGroupOwner:1,searchGroupByID:1,setMessageRemindType:1,getGroupApplicationList:1,handleGroupApplication:1,initGroupAttributes:1,setGroupAttributes:1,deleteGroupAttributes:1,getGroupAttributes:1,setGroupCounters:1,increaseGroupCounter:1,decreaseGroupCounter:1,getGroupCounters:1,getJoinedCommunityList:1,createTopicInCommunity:1,deleteTopicFromCommunity:1,updateTopicProfile:1,getTopicList:1,getGroupMemberProfile:1,getGroupMemberList:1,addGroupMember:1,deleteGroupMember:1,setGroupMemberNameCard:1,setGroupMemberMuteTime:1,setGroupMemberRole:1,setGroupMemberCustomField:1,getGroupOnlineMemberCount:1,markGroupMemberList:1,getMyProfile:1,getUserProfile:1,updateMyProfile:1,setSelfStatus:1,getUserStatus:1,subscribeUserStatus:1,unsubscribeUserStatus:1,getBlacklist:1,addToBlacklist:1,removeFromBlacklist:1,getFriendList:1,addFriend:1,deleteFriend:1,checkFriend:1,updateFriend:1,getFriendProfile:1,getFriendApplicationList:1,refuseFriendApplication:1,deleteFriendApplication:1,acceptFriendApplication:1,setFriendApplicationRead:1,getFriendGroupList:1,createFriendGroup:1,renameFriendGroup:1,deleteFriendGroup:1,addToFriendGroup:1,removeFromFriendGroup:1,callExperimentalAPI:1},vf=!!Ds&&w((function(){Ds.prototype.finally.call({then:function(){}},(function(){}))}));if(on({target:"Promise",proto:!0,real:!0,forced:vf},{finally:function(e){var t=qs(this,re("Promise")),n=te(e);return this.then(n?function(n){return bu(t,e()).then((function(){return n}))}:e,n?function(n){return bu(t,e()).then((function(){throw n}))}:e)}}),te(Ds)){var mf=re("Promise").prototype.finally;Ds.prototype.finally!==mf&&Dt(Ds.prototype,"finally",mf,{unsafe:!0})}var _f=w((function(){if("function"==typeof ArrayBuffer){var e=new ArrayBuffer(8);Object.isExtensible(e)&&Object.defineProperty(e,"a",{value:8})}})),yf=Object.isExtensible,Mf=w((function(){yf(1)}))||_f?function(e){return!!ne(e)&&(!_f||"ArrayBuffer"!=W(e))&&(!yf||yf(e))}:yf,If=!w((function(){return Object.isExtensible(Object.preventExtensions({}))})),Cf=D((function(e){var t=ot.f,n=!1,o=Oe("meta"),r=0,i=function(e){t(e,o,{value:{objectID:"O"+r++,weakData:{}}})},a=e.exports={enable:function(){a.enable=function(){},n=!0;var e=Kt.f,t=j([].splice),r={};r[o]=1,e(r).length&&(Kt.f=function(n){for(var r=e(n),i=0,a=r.length;i<a;i++)if(r[i]===o){t(r,i,1);break}return r},on({target:"Object",stat:!0,forced:!0},{getOwnPropertyNames:ds.f}))},fastKey:function(e,t){if(!ne(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!Ae(e,o)){if(!Mf(e))return"F";if(!t)return"E";i(e)}return e[o].objectID},getWeakData:function(e,t){if(!Ae(e,o)){if(!Mf(e))return!0;if(!t)return!1;i(e)}return e[o].weakData},onFreeze:function(e){return If&&n&&Mf(e)&&!Ae(e,o)&&i(e),e}};ht[o]=!0})),kf=(Cf.enable,Cf.fastKey,Cf.getWeakData,Cf.onFreeze,ot.f),Tf=Cf.fastKey,Sf=Ct.set,bf=Ct.getterFor;!function(e,t,n){var o=-1!==e.indexOf("Map"),r=-1!==e.indexOf("Weak"),i=o?"set":"add",a=R[e],s=a&&a.prototype,u=a,c={},l=function(e){var t=j(s[e]);Dt(s,e,"add"==e?function(e){return t(this,0===e?0:e),this}:"delete"==e?function(e){return!(r&&!ne(e))&&t(this,0===e?0:e)}:"get"==e?function(e){return r&&!ne(e)?void 0:t(this,0===e?0:e)}:"has"==e?function(e){return!(r&&!ne(e))&&t(this,0===e?0:e)}:function(e,n){return t(this,0===e?0:e,n),this})};if(tn(e,!te(a)||!(r||s.forEach&&!w((function(){(new a).entries().next()})))))u=n.getConstructor(t,e,o,i),Cf.enable();else if(tn(e,!0)){var d=new u,p=d[i](r?{}:-0,1)!=d,f=w((function(){d.has(1)})),h=Uo((function(e){new a(e)})),g=!r&&w((function(){for(var e=new a,t=5;t--;)e[i](t,t);return!e.has(-0)}));h||((u=t((function(e,t){ws(e,s);var n=xr(new a,e,u);return null!=t&&Gs(t,n[i],{that:n,AS_ENTRIES:o}),n}))).prototype=s,s.constructor=u),(f||g)&&(l("delete"),l("has"),o&&l("get")),(g||p)&&l(i),r&&s.clear&&delete s.clear}c[e]=u,on({global:!0,forced:u!=a},c),or(u,e),r||n.setStrong(u,e,o)}("Map",(function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}}),{getConstructor:function(e,t,n,o){var r=e((function(e,r){ws(e,i),Sf(e,{type:t,index:Hn(null),first:void 0,last:void 0,size:0}),O||(e.size=0),null!=r&&Gs(r,e[o],{that:e,AS_ENTRIES:n})})),i=r.prototype,a=bf(t),s=function(e,t,n){var o,r,i=a(e),s=u(e,t);return s?s.value=n:(i.last=s={index:r=Tf(t,!0),key:t,value:n,previous:o=i.last,next:void 0,removed:!1},i.first||(i.first=s),o&&(o.next=s),O?i.size++:e.size++,"F"!==r&&(i.index[r]=s)),e},u=function(e,t){var n,o=a(e),r=Tf(t);if("F"!==r)return o.index[r];for(n=o.first;n;n=n.next)if(n.key==t)return n};return Es(i,{clear:function(){for(var e=a(this),t=e.index,n=e.first;n;)n.removed=!0,n.previous&&(n.previous=n.previous.next=void 0),delete t[n.index],n=n.next;e.first=e.last=void 0,O?e.size=0:this.size=0},delete:function(e){var t=a(this),n=u(this,e);if(n){var o=n.next,r=n.previous;delete t.index[n.index],n.removed=!0,r&&(r.next=o),o&&(o.previous=r),t.first==n&&(t.first=o),t.last==n&&(t.last=r),O?t.size--:this.size--}return!!n},forEach:function(e){for(var t,n=a(this),o=jn(e,arguments.length>1?arguments[1]:void 0);t=t?t.next:n.first;)for(o(t.value,t.key,this);t&&t.removed;)t=t.previous},has:function(e){return!!u(this,e)}}),Es(i,n?{get:function(e){var t=u(this,e);return t&&t.value},set:function(e,t){return s(this,0===e?0:e,t)}}:{add:function(e){return s(this,e=0===e?0:e,e)}}),O&&kf(i,"size",{get:function(){return a(this).size}}),r},setStrong:function(e,t,n){var o=t+" Iterator",r=bf(t),i=bf(o);vr(e,t,(function(e,t){Sf(this,{type:o,target:e,state:r(e),kind:t,last:void 0})}),(function(){for(var e=i(this),t=e.kind,n=e.last;n&&n.removed;)n=n.previous;return e.target&&(e.last=n=n?n.next:e.state.first)?"keys"==t?{value:n.key,done:!1}:"values"==t?{value:n.value,done:!1}:{value:[n.key,n.value],done:!1}:(e.target=void 0,{value:void 0,done:!0})}),n?"entries":"values",!n,!0),Ls(t)}});var Df=/MSIE .\./.test(ae),Ef=R.Function,Af=function(e){return function(t,n){var o=Vs(arguments.length,1)>2,r=te(t)?t:Ef(t),i=o?Dn(arguments,2):void 0;return e(o?function(){Ca(r,this,i)}:r,n)}};on({global:!0,bind:!0,forced:Df},{setTimeout:Af(R.setTimeout),setInterval:Af(R.setInterval)});var Lf=so.filter,Rf=kr("filter");on({target:"Array",proto:!0,forced:!Rf},{filter:function(e){return Lf(this,e,arguments.length>1?arguments[1]:void 0)}});var wf,Of=1,Nf=2,Pf=3,Gf=4,Uf=6,xf=7,Ff=8,qf=9,Bf=10,Vf=11,Hf=12,Kf=13,jf=14,zf=15,Zf=16,Wf=17,Yf=18,Jf=19,Xf=20,$f=21,Qf=22,eh=23,th=24,nh=25,oh=26,rh=27,ih=28,ah=29,sh=30,uh=31,ch=32,lh=function(){function e(t){r(this,e),this._m=t,this._n=""}return a(e,[{key:"isLoggedIn",value:function(){return this._m.getModule(Hf).isLoggedIn()}},{key:"isOversea",value:function(){return this._m.getModule(Hf).isOversea()}},{key:"isPrivateNetWork",value:function(){return this._m.getModule(Hf).isPrivateNetWork()}},{key:"getMyUserID",value:function(){return this._m.getModule(Hf).getUserID()}},{key:"getMyTinyID",value:function(){return this._m.getModule(Hf).getTinyID()}},{key:"getSDKAppID",value:function(){return this._m.getModule(Hf).getSDKAppID()}},{key:"isIntl",value:function(){return this._m.getModule(Hf).isIntl()}},{key:"isDevMode",value:function(){return this._m.getModule(Hf).isDevMode()}},{key:"getModule",value:function(e){return this._m.getModule(e)}},{key:"getPlatform",value:function(){return rl}},{key:"getNetworkType",value:function(){return this._m.getModule(zf).getNetworkType()}},{key:"probeNetwork",value:function(e){return this._m.getModule(zf).probe(e)}},{key:"getCloudConfig",value:function(e){return this._m.getModule(eh).getCloudConfig(e)}},{key:"emitOuterEvent",value:function(e,t){this._m.getOuterEmitterInstance().emit(e,t)}},{key:"emitInnerEvent",value:function(e,t){this._m.getInnerEmitterInstance().emit(e,t)}},{key:"getInnerEmitterInstance",value:function(){return this._m.getInnerEmitterInstance()}},{key:"generateTjgID",value:function(e){return this._m.getModule(Hf).getTinyID()+"-"+e.random}},{key:"filterModifiedMessage",value:function(e){if(!Hd(e)){var t=e.filter((function(e){return!0===e.isModified}));t.length>0&&this.emitOuterEvent(Mr.MESSAGE_MODIFIED,t)}}},{key:"filterUnmodifiedMessage",value:function(e){return Hd(e)?[]:e.filter((function(e){return!1===e.isModified}))}},{key:"request",value:function(e){return this._m.getModule(Xf).request(e)}},{key:"canIUse",value:function(e){return this._m.getModule(rh).canIUse(e)}},{key:"getErrorMessage",value:function(e,t,n){return this._m.getErrorMessage(e,t,n)}},{key:"outputWarning",value:function(e,t,n){var o=this.getErrorMessage(e,t,n);o&&Pl.w(o)}}]),e}(),dh="wslogin",ph="wslogout",fh="wshello",hh="KickOther",gh="getmsg",vh="authkey",mh="sendmsg",_h="send_group_msg",yh="portrait_get_all",Mh="portrait_set",Ih="black_list_get",Ch="black_list_add",kh="black_list_delete",Th="msgwithdraw",Sh="msgreaded",bh="set_c2c_peer_mute_notifications",Dh="get_c2c_peer_mute_notifications",Eh="getroammsg",Ah="get_peer_read_time",Lh="delete_c2c_msg_ramble",Rh="modify_c2c_msg",wh="set_key_values",Oh="get_key_values",Nh="page_get",Ph="get",Gh="delete",Uh="clear_msg",xh="top",Fh="deletemsg",qh="set_conv_custom_data",Bh="mark_contact",Vh="create_contact_group",Hh="del_contact_group",Kh="update_contact_group",jh="add_conv_to_group",zh="del_conv_from_group",Zh="get_contact_group",Wh="get_joined_group_list",Yh="get_group_self_member_info",Jh="create_group",Xh="destroy_group",$h="modify_group_base_info",Qh="apply_join_group",eg="apply_join_group_noauth",tg="quit_group",ng="get_group_public_info",og="change_group_owner",rg="handle_apply_join_group",ig="handle_invite_join_group",ag="group_msg_recall",sg="msg_read_report",ug="read_all_unread_msg",cg="group_msg_get",lg="get_group_msg_receipt",dg="group_msg_receipt",pg="c2c_msg_read_receipt",fg="get_group_msg_receipt_detail",hg="get_pendency",gg="deletemsg",vg="get_msg",mg="get_msg_noauth",_g="get_online_member_num",yg="delete_group_ramble_msg_by_seq",Mg="modify_group_msg",Ig="set_group_attr",Cg="modify_group_attr",kg="delete_group_attr",Tg="clear_group_attr",Sg="get_group_attr",bg="group_set_key_values",Dg="group_get_key_values",Eg="get_group_notify",Ag="update_group_counter",Lg="get_group_counter",Rg="get_group_member_info",wg="get_members",Og="get_specified_group_member_info",Ng="add_group_member",Pg="delete_group_member",Gg="ban_group_member",Ug="modify_group_member_info",xg="modify_user_info",Fg="cos",qg="pre_sig",Bg="video_cover",Vg="tim_web_report_v2",Hg="alive",Kg="msg_push",jg="multi_msg_push_ws",zg="ws_msg_push_ack",Zg="stat_forceoffline",Wg="save_relay_json_msg",Yg="get_relay_json_msg",Jg="fetch_config",Xg="push_configv2",$g="fetch_imsdk_purchase_bitsv2",Qg="push_imsdk_purchase_bitsv2",ev="notify2",tv="create_topic",nv="destroy_topic",ov="modify_topic",rv="get_topic",iv="ws_set_custom_status",av="ws_get_user_status",sv="ws_status_subscribe",uv="ws_status_unsubscribe",cv="ws_stat_background",lv="ws_stat_foreground",dv="ws_stat_settoken",pv="get_local_words",fv="ws_batch_trans_text",hv=2e3,gv=2002,vv=2003,mv=2022,_v=2023,yv=2024,Mv=2025,Iv=2040,Cv=2041,kv=2100,Tv=2101,Sv=2105,bv=2106,Dv=2108,Ev=2109,Av=2110,Lv=2111,Rv=2112,wv=2114,Ov=2115,Nv=2116,Pv=2117,Gv=2251,Uv=2252,xv=2253,Fv=2300,qv=2301,Bv=2350,Vv=2351,Hv=2352,Kv=2400,jv=2401,zv=2402,Zv=2403,Wv=2450,Yv=2451,Jv=2452,Xv=2453,$v=2480,Qv=2481,em=2500,tm=2501,nm=2502,om=2503,rm=2600,im=2601,am=2602,sm=2603,um=2620,cm=2621,lm=2622,dm=2623,pm=2660,fm=2661,hm=2662,gm=2681,vm=2682,mm=2683,_m=2684,ym=2685,Mm=2686,Im=2721,Cm=2722,km=2742,Tm=2800,Sm=2801,bm=2805,Dm=2903,Em=2905,Am=2996,Lm=2997,Rm=2998,wm=2999,Om=3e3,Nm=3001,Pm=3002,Gm=3003,Um=3004,xm=3005,Fm=3006,qm=3021,Bm=3122,Vm=3123,Hm=20002,Km=70001,jm=1002,zm=60022,Zm="networkRTT",Wm="messageE2EDelay",Ym="sendMessageC2C",Jm="sendMessageGroup",Xm="sendMessageGroupAV",$m="sendMessageRichMedia",Qm="cosUpload",e_="messageReceivedGroup",t_="messageReceivedGroupAVPush",n_="messageReceivedGroupAVPull",o_=(s(wf={},Zm,2),s(wf,Wm,3),s(wf,Ym,4),s(wf,Jm,5),s(wf,Xm,6),s(wf,$m,7),s(wf,e_,8),s(wf,t_,9),s(wf,n_,10),s(wf,Qm,11),wf),r_={info:4,warning:5,error:6},i_={wifi:1,"2g":2,"3g":3,"4g":4,"5g":5,unknown:6,none:7,online:8},a_={login:4},s_=function(){function e(t){r(this,e),this._n="SSOLogData",this.eventType=a_[t]||0,this.timestamp=0,this.networkType=8,this.code=0,this.message="",this.moreMessage="",this.extension=t,this.costTime=0,this.duplicate=!1,this.level=4,this.uiPlatform=void 0,this._sentFlag=!1,this._startts=Al()}return a(e,[{key:"updateTimeStamp",value:function(){this.timestamp=Al()}},{key:"start",value:function(e){return this._startts=e,this}},{key:"end",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this._sentFlag){var n=Al();0===this.costTime&&(this.costTime=n-this._startts),this.setMoreMessage("startts:".concat(this._startts," endts:").concat(n)),t?(this._sentFlag=!0,this._eventStatModule&&this._eventStatModule.pushIn(this)):setTimeout((function(){e._sentFlag=!0,e._eventStatModule&&e._eventStatModule.pushIn(e)}),0)}}},{key:"setError",value:function(e,t,n){if(!(e instanceof Error))return Pl.w("".concat(this._n,".setError value not instanceof Error, please check!")),this;if(this._sentFlag)return this;if(this.setNetworkType(n),t)e.code&&this.setCode(e.code),e.message&&this.setMoreMessage(e.message);else{var o=bm;this.setCode(o)}return this.setLevel("error"),this}},{key:"setCode",value:function(e){return Ql(e)||this._sentFlag||("ECONNABORTED"===e&&(this.code=103),Wl(e)?this.code=e:Pl.w("".concat(this._n,".setCode value not a number, please check!"),e,o(e))),this}},{key:"setMessage",value:function(e){return Ql(e)||this._sentFlag||(Wl(e)&&(this.message=e.toString()),Yl(e)&&(this.message=e)),this}},{key:"setCostTime",value:function(e){return this.costTime=e,this}},{key:"setLevel",value:function(e){return Ql(e)||this._sentFlag||(this.level=r_[e]),this}},{key:"setMoreMessage",value:function(e){return Hd(this.moreMessage)?this.moreMessage="".concat(e):this.moreMessage+=" ".concat(e),this}},{key:"setNetworkType",value:function(e){if(Ql(e))Pl.w("".concat(this._n,".setNetworkType value is undefined, please check!"));else{var t=i_[e.toLowerCase()];Ql(t)||(this.networkType=t)}return this}},{key:"getStartTs",value:function(){return this._startts}},{key:"setUIPlatform",value:function(e){this.uiPlatform=e}}],[{key:"bindEventStatModule",value:function(t){e.prototype._eventStatModule=t}}]),e}(),u_=F.f,c_=j(u_),l_=j([].push),d_=function(e){return function(t){for(var n,o=ee(t),r=Pn(o),i=r.length,a=0,s=[];i>a;)n=r[a++],O&&!c_(o,n)||l_(s,e?[n,o[n]]:o[n]);return s}},p_=(d_(!0),d_(!1));on({target:"Object",stat:!0},{values:function(e){return p_(e)}});var f_=function(){function e(t){r(this,e),this.type=Ir.MSG_TEXT,this.content={text:t.text||""}}return a(e,[{key:"setText",value:function(e){this.content.text=e}},{key:"sendable",value:function(){return 0!==this.content.text.length}}]),e}(),h_=xe("iterator"),g_=!w((function(){var e=new URL("b?a=1&b=2&c=3","http://a"),t=e.searchParams,n="";return e.pathname="c%20d",t.forEach((function(e,o){t.delete("b"),n+=o+e})),!t.sort||"http://a/c%20d?a=1&c=3"!==e.href||"3"!==t.get("c")||"a=1"!==String(new URLSearchParams("?a=1"))||!t[h_]||"a"!==new URL("https://a@b").username||"b"!==new URLSearchParams(new URLSearchParams("a=b")).get("a")||"xn--e1aybc"!==new URL("http://\u0442\u0435\u0441\u0442").host||"#%D0%B1"!==new URL("http://a#\u0431").hash||"a1c3"!==n||"x"!==new URL("http://x",void 0).host})),v_=Object.assign,m_=Object.defineProperty,__=j([].concat),y_=!v_||w((function(){if(O&&1!==v_({b:1},v_(m_({},"a",{enumerable:!0,get:function(){m_(this,"b",{value:3,enumerable:!1})}}),{b:2})).b)return!0;var e={},t={},n=Symbol();return e[n]=7,"abcdefghijklmnopqrst".split("").forEach((function(e){t[e]=e})),7!=v_({},e)[n]||"abcdefghijklmnopqrst"!=Pn(v_({},t)).join("")}))?function(e,t){for(var n=De(e),o=arguments.length,r=1,i=jt.f,a=F.f;o>r;)for(var s,u=X(arguments[r++]),c=i?__(Pn(u),i(u)):Pn(u),l=c.length,d=0;l>d;)s=c[d++],O&&!G(a,u,s)||(n[s]=u[s]);return n}:v_,M_=/[^\0-\u007E]/,I_=/[.\u3002\uFF0E\uFF61]/g,C_="Overflow: input needs wider integers to process",k_=R.RangeError,T_=j(I_.exec),S_=Math.floor,b_=String.fromCharCode,D_=j("".charCodeAt),E_=j([].join),A_=j([].push),L_=j("".replace),R_=j("".split),w_=j("".toLowerCase),O_=function(e){return e+22+75*(e<26)},N_=function(e,t,n){var o=0;for(e=n?S_(e/700):e>>1,e+=S_(e/t);e>455;)e=S_(e/35),o+=36;return S_(o+36*e/(e+38))},P_=function(e){var t,n,o=[],r=(e=function(e){for(var t=[],n=0,o=e.length;n<o;){var r=D_(e,n++);if(r>=55296&&r<=56319&&n<o){var i=D_(e,n++);56320==(64512&i)?A_(t,((1023&r)<<10)+(1023&i)+65536):(A_(t,r),n--)}else A_(t,r)}return t}(e)).length,i=128,a=0,s=72;for(t=0;t<e.length;t++)(n=e[t])<128&&A_(o,b_(n));var u=o.length,c=u;for(u&&A_(o,"-");c<r;){var l=2147483647;for(t=0;t<e.length;t++)(n=e[t])>=i&&n<l&&(l=n);var d=c+1;if(l-i>S_((2147483647-a)/d))throw k_(C_);for(a+=(l-i)*d,i=l,t=0;t<e.length;t++){if((n=e[t])<i&&++a>2147483647)throw k_(C_);if(n==i){for(var p=a,f=36;;){var h=f<=s?1:f>=s+26?26:f-s;if(p<h)break;var g=p-h,v=36-h;A_(o,b_(O_(h+g%v))),p=S_(g/v),f+=36}A_(o,b_(O_(p))),s=N_(a,d,c==u),a=0,c++}}a++,i++}return E_(o,"")},G_=Math.floor,U_=function e(t,n){var o=t.length,r=G_(o/2);return o<8?x_(t,n):F_(t,e(us(t,0,r),n),e(us(t,r),n),n)},x_=function(e,t){for(var n,o,r=e.length,i=1;i<r;){for(o=i,n=e[i];o&&t(e[o-1],n)>0;)e[o]=e[--o];o!==i++&&(e[o]=n)}return e},F_=function(e,t,n,o){for(var r=t.length,i=n.length,a=0,s=0;a<r||s<i;)e[a+s]=a<r&&s<i?o(t[a],n[s])<=0?t[a++]:n[s++]:a<r?t[a++]:n[s++];return e},q_=U_,B_=xe("iterator"),V_=Ct.set,H_=Ct.getterFor("URLSearchParams"),K_=Ct.getterFor("URLSearchParamsIterator"),j_=re("fetch"),z_=re("Request"),Z_=re("Headers"),W_=z_&&z_.prototype,Y_=Z_&&Z_.prototype,J_=R.RegExp,X_=R.TypeError,$_=R.decodeURIComponent,Q_=R.encodeURIComponent,ey=j("".charAt),ty=j([].join),ny=j([].push),oy=j("".replace),ry=j([].shift),iy=j([].splice),ay=j("".split),sy=j("".slice),uy=/\+/g,cy=Array(4),ly=function(e){return cy[e-1]||(cy[e-1]=J_("((?:%[\\da-f]{2}){"+e+"})","gi"))},dy=function(e){try{return $_(e)}catch(yD){return e}},py=function(e){var t=oy(e,uy," "),n=4;try{return $_(t)}catch(yD){for(;n;)t=oy(t,ly(n--),dy);return t}},fy=/[!'()~]|%20/g,hy={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+"},gy=function(e){return hy[e]},vy=function(e){return oy(Q_(e),fy,gy)},_y=ar((function(e,t){V_(this,{type:"URLSearchParamsIterator",iterator:Lo(H_(e).entries),kind:t})}),"Iterator",(function(){var e=K_(this),t=e.kind,n=e.iterator.next(),o=n.value;return n.done||(n.value="keys"===t?o.key:"values"===t?o.value:[o.key,o.value]),n}),!0),yy=function(e){this.entries=[],this.url=null,void 0!==e&&(ne(e)?this.parseObject(e):this.parseQuery("string"==typeof e?"?"===ey(e,0)?sy(e,1):e:pn(e)))};yy.prototype={type:"URLSearchParams",bindURL:function(e){this.url=e,this.update()},parseObject:function(e){var t,n,o,r,i,a,s,u=Eo(e);if(u)for(n=(t=Lo(e,u)).next;!(o=G(n,t)).done;){if(i=(r=Lo($e(o.value))).next,(a=G(i,r)).done||(s=G(i,r)).done||!G(i,r).done)throw X_("Expected sequence with length 2");ny(this.entries,{key:pn(a.value),value:pn(s.value)})}else for(var c in e)Ae(e,c)&&ny(this.entries,{key:c,value:pn(e[c])})},parseQuery:function(e){if(e)for(var t,n,o=ay(e,"&"),r=0;r<o.length;)(t=o[r++]).length&&(n=ay(t,"="),ny(this.entries,{key:py(ry(n)),value:py(ty(n,"="))}))},serialize:function(){for(var e,t=this.entries,n=[],o=0;o<t.length;)e=t[o++],ny(n,vy(e.key)+"="+vy(e.value));return ty(n,"&")},update:function(){this.entries.length=0,this.parseQuery(this.url.query)},updateURL:function(){this.url&&this.url.update()}};var My=function(){ws(this,Iy),V_(this,new yy(arguments.length>0?arguments[0]:void 0))},Iy=My.prototype;if(Es(Iy,{append:function(e,t){Vs(arguments.length,2);var n=H_(this);ny(n.entries,{key:pn(e),value:pn(t)}),n.updateURL()},delete:function(e){Vs(arguments.length,1);for(var t=H_(this),n=t.entries,o=pn(e),r=0;r<n.length;)n[r].key===o?iy(n,r,1):r++;t.updateURL()},get:function(e){Vs(arguments.length,1);for(var t=H_(this).entries,n=pn(e),o=0;o<t.length;o++)if(t[o].key===n)return t[o].value;return null},getAll:function(e){Vs(arguments.length,1);for(var t=H_(this).entries,n=pn(e),o=[],r=0;r<t.length;r++)t[r].key===n&&ny(o,t[r].value);return o},has:function(e){Vs(arguments.length,1);for(var t=H_(this).entries,n=pn(e),o=0;o<t.length;)if(t[o++].key===n)return!0;return!1},set:function(e,t){Vs(arguments.length,1);for(var n,o=H_(this),r=o.entries,i=!1,a=pn(e),s=pn(t),u=0;u<r.length;u++)(n=r[u]).key===a&&(i?iy(r,u--,1):(i=!0,n.value=s));i||ny(r,{key:a,value:s}),o.updateURL()},sort:function(){var e=H_(this);q_(e.entries,(function(e,t){return e.key>t.key?1:-1})),e.updateURL()},forEach:function(e){for(var t,n=H_(this).entries,o=jn(e,arguments.length>1?arguments[1]:void 0),r=0;r<n.length;)o((t=n[r++]).value,t.key,this)},keys:function(){return new _y(this,"keys")},values:function(){return new _y(this,"values")},entries:function(){return new _y(this,"entries")}},{enumerable:!0}),Dt(Iy,B_,Iy.entries,{name:"entries"}),Dt(Iy,"toString",(function(){return H_(this).serialize()}),{enumerable:!0}),or(My,"URLSearchParams"),on({global:!0,forced:!g_},{URLSearchParams:My}),!g_&&te(Z_)){var Cy=j(Y_.has),ky=j(Y_.set),Ty=function(e){if(ne(e)){var t,n=e.body;if("URLSearchParams"===ln(n))return t=e.headers?new Z_(e.headers):new Z_,Cy(t,"content-type")||ky(t,"content-type","application/x-www-form-urlencoded;charset=UTF-8"),Hn(e,{body:q(0,pn(n)),headers:q(0,t)})}return e};if(te(j_)&&on({global:!0,enumerable:!0,forced:!0},{fetch:function(e){return j_(e,arguments.length>1?Ty(arguments[1]):{})}}),te(z_)){var Sy=function(e){return ws(this,W_),new z_(e,arguments.length>1?Ty(arguments[1]):{})};W_.constructor=Sy,Sy.prototype=W_,on({global:!0,forced:!0},{Request:Sy})}}var by,Dy={URLSearchParams:My,getState:H_},Ey=Gn.f,Ay=zo.codeAt,Ly=Ct.set,Ry=Ct.getterFor("URL"),wy=Dy.URLSearchParams,Oy=Dy.getState,Ny=R.URL,Py=R.TypeError,Gy=R.parseInt,Uy=Math.floor,xy=Math.pow,Fy=j("".charAt),qy=j(/./.exec),By=j([].join),Vy=j(1..toString),Hy=j([].pop),Ky=j([].push),jy=j("".replace),zy=j([].shift),Zy=j("".split),Wy=j("".slice),Yy=j("".toLowerCase),Jy=j([].unshift),Xy=/[a-z]/i,$y=/[\d+-.a-z]/i,Qy=/\d/,eM=/^0x/i,tM=/^[0-7]+$/,nM=/^\d+$/,oM=/^[\da-f]+$/i,rM=/[\0\t\n\r #%/:<>?@[\\\]^|]/,iM=/[\0\t\n\r #/:<>?@[\\\]^|]/,aM=/^[\u0000-\u0020]+|[\u0000-\u0020]+$/g,sM=/[\t\n\r]/g,uM=function(e){var t,n,o,r;if("number"==typeof e){for(t=[],n=0;n<4;n++)Jy(t,e%256),e=Uy(e/256);return By(t,".")}if("object"==typeof e){for(t="",o=function(e){for(var t=null,n=1,o=null,r=0,i=0;i<8;i++)0!==e[i]?(r>n&&(t=o,n=r),o=null,r=0):(null===o&&(o=i),++r);return r>n&&(t=o,n=r),t}(e),n=0;n<8;n++)r&&0===e[n]||(r&&(r=!1),o===n?(t+=n?":":"::",r=!0):(t+=Vy(e[n],16),n<7&&(t+=":")));return"["+t+"]"}return e},cM={},lM=y_({},cM,{" ":1,'"':1,"<":1,">":1,"`":1}),dM=y_({},lM,{"#":1,"?":1,"{":1,"}":1}),pM=y_({},dM,{"/":1,":":1,";":1,"=":1,"@":1,"[":1,"\\":1,"]":1,"^":1,"|":1}),fM=function(e,t){var n=Ay(e,0);return n>32&&n<127&&!Ae(t,e)?e:encodeURIComponent(e)},hM={ftp:21,file:null,http:80,https:443,ws:80,wss:443},gM=function(e,t){var n;return 2==e.length&&qy(Xy,Fy(e,0))&&(":"==(n=Fy(e,1))||!t&&"|"==n)},vM=function(e){var t;return e.length>1&&gM(Wy(e,0,2))&&(2==e.length||"/"===(t=Fy(e,2))||"\\"===t||"?"===t||"#"===t)},mM=function(e){return"."===e||"%2e"===Yy(e)},_M={},yM={},MM={},IM={},CM={},kM={},TM={},SM={},bM={},DM={},EM={},AM={},LM={},RM={},wM={},OM={},NM={},PM={},GM={},UM={},xM={},FM=function e(t,n,o){var r,i,a,s=pn(t);if(n){if(i=this.parse(s))throw Py(i);this.searchParams=null}else{if(void 0!==o&&(r=new e(o,!0)),i=this.parse(s,null,r))throw Py(i);(a=Oy(new wy)).bindURL(this),this.searchParams=a}};FM.prototype={type:"URL",parse:function(e,t,n){var o,r,i,a,s,u=this,c=t||_M,l=0,d="",p=!1,f=!1,h=!1;for(e=pn(e),t||(u.scheme="",u.username="",u.password="",u.host=null,u.port=null,u.path=[],u.query=null,u.fragment=null,u.cannotBeABaseURL=!1,e=jy(e,aM,"")),e=jy(e,sM,""),o=wo(e);l<=o.length;){switch(r=o[l],c){case _M:if(!r||!qy(Xy,r)){if(t)return"Invalid scheme";c=MM;continue}d+=Yy(r),c=yM;break;case yM:if(r&&(qy($y,r)||"+"==r||"-"==r||"."==r))d+=Yy(r);else{if(":"!=r){if(t)return"Invalid scheme";d="",c=MM,l=0;continue}if(t&&(u.isSpecial()!=Ae(hM,d)||"file"==d&&(u.includesCredentials()||null!==u.port)||"file"==u.scheme&&!u.host))return;if(u.scheme=d,t)return void(u.isSpecial()&&hM[u.scheme]==u.port&&(u.port=null));d="","file"==u.scheme?c=RM:u.isSpecial()&&n&&n.scheme==u.scheme?c=IM:u.isSpecial()?c=SM:"/"==o[l+1]?(c=CM,l++):(u.cannotBeABaseURL=!0,Ky(u.path,""),c=GM)}break;case MM:if(!n||n.cannotBeABaseURL&&"#"!=r)return"Invalid scheme";if(n.cannotBeABaseURL&&"#"==r){u.scheme=n.scheme,u.path=us(n.path),u.query=n.query,u.fragment="",u.cannotBeABaseURL=!0,c=xM;break}c="file"==n.scheme?RM:kM;continue;case IM:if("/"!=r||"/"!=o[l+1]){c=kM;continue}c=bM,l++;break;case CM:if("/"==r){c=DM;break}c=PM;continue;case kM:if(u.scheme=n.scheme,r==by)u.username=n.username,u.password=n.password,u.host=n.host,u.port=n.port,u.path=us(n.path),u.query=n.query;else if("/"==r||"\\"==r&&u.isSpecial())c=TM;else if("?"==r)u.username=n.username,u.password=n.password,u.host=n.host,u.port=n.port,u.path=us(n.path),u.query="",c=UM;else{if("#"!=r){u.username=n.username,u.password=n.password,u.host=n.host,u.port=n.port,u.path=us(n.path),u.path.length--,c=PM;continue}u.username=n.username,u.password=n.password,u.host=n.host,u.port=n.port,u.path=us(n.path),u.query=n.query,u.fragment="",c=xM}break;case TM:if(!u.isSpecial()||"/"!=r&&"\\"!=r){if("/"!=r){u.username=n.username,u.password=n.password,u.host=n.host,u.port=n.port,c=PM;continue}c=DM}else c=bM;break;case SM:if(c=bM,"/"!=r||"/"!=Fy(d,l+1))continue;l++;break;case bM:if("/"!=r&&"\\"!=r){c=DM;continue}break;case DM:if("@"==r){p&&(d="%40"+d),p=!0,i=wo(d);for(var g=0;g<i.length;g++){var v=i[g];if(":"!=v||h){var m=fM(v,pM);h?u.password+=m:u.username+=m}else h=!0}d=""}else if(r==by||"/"==r||"?"==r||"#"==r||"\\"==r&&u.isSpecial()){if(p&&""==d)return"Invalid authority";l-=wo(d).length+1,d="",c=EM}else d+=r;break;case EM:case AM:if(t&&"file"==u.scheme){c=OM;continue}if(":"!=r||f){if(r==by||"/"==r||"?"==r||"#"==r||"\\"==r&&u.isSpecial()){if(u.isSpecial()&&""==d)return"Invalid host";if(t&&""==d&&(u.includesCredentials()||null!==u.port))return;if(a=u.parseHost(d))return a;if(d="",c=NM,t)return;continue}"["==r?f=!0:"]"==r&&(f=!1),d+=r}else{if(""==d)return"Invalid host";if(a=u.parseHost(d))return a;if(d="",c=LM,t==AM)return}break;case LM:if(!qy(Qy,r)){if(r==by||"/"==r||"?"==r||"#"==r||"\\"==r&&u.isSpecial()||t){if(""!=d){var _=Gy(d,10);if(_>65535)return"Invalid port";u.port=u.isSpecial()&&_===hM[u.scheme]?null:_,d=""}if(t)return;c=NM;continue}return"Invalid port"}d+=r;break;case RM:if(u.scheme="file","/"==r||"\\"==r)c=wM;else{if(!n||"file"!=n.scheme){c=PM;continue}if(r==by)u.host=n.host,u.path=us(n.path),u.query=n.query;else if("?"==r)u.host=n.host,u.path=us(n.path),u.query="",c=UM;else{if("#"!=r){vM(By(us(o,l),""))||(u.host=n.host,u.path=us(n.path),u.shortenPath()),c=PM;continue}u.host=n.host,u.path=us(n.path),u.query=n.query,u.fragment="",c=xM}}break;case wM:if("/"==r||"\\"==r){c=OM;break}n&&"file"==n.scheme&&!vM(By(us(o,l),""))&&(gM(n.path[0],!0)?Ky(u.path,n.path[0]):u.host=n.host),c=PM;continue;case OM:if(r==by||"/"==r||"\\"==r||"?"==r||"#"==r){if(!t&&gM(d))c=PM;else if(""==d){if(u.host="",t)return;c=NM}else{if(a=u.parseHost(d))return a;if("localhost"==u.host&&(u.host=""),t)return;d="",c=NM}continue}d+=r;break;case NM:if(u.isSpecial()){if(c=PM,"/"!=r&&"\\"!=r)continue}else if(t||"?"!=r)if(t||"#"!=r){if(r!=by&&(c=PM,"/"!=r))continue}else u.fragment="",c=xM;else u.query="",c=UM;break;case PM:if(r==by||"/"==r||"\\"==r&&u.isSpecial()||!t&&("?"==r||"#"==r)){if(".."===(s=Yy(s=d))||"%2e."===s||".%2e"===s||"%2e%2e"===s?(u.shortenPath(),"/"==r||"\\"==r&&u.isSpecial()||Ky(u.path,"")):mM(d)?"/"==r||"\\"==r&&u.isSpecial()||Ky(u.path,""):("file"==u.scheme&&!u.path.length&&gM(d)&&(u.host&&(u.host=""),d=Fy(d,0)+":"),Ky(u.path,d)),d="","file"==u.scheme&&(r==by||"?"==r||"#"==r))for(;u.path.length>1&&""===u.path[0];)zy(u.path);"?"==r?(u.query="",c=UM):"#"==r&&(u.fragment="",c=xM)}else d+=fM(r,dM);break;case GM:"?"==r?(u.query="",c=UM):"#"==r?(u.fragment="",c=xM):r!=by&&(u.path[0]+=fM(r,cM));break;case UM:t||"#"!=r?r!=by&&("'"==r&&u.isSpecial()?u.query+="%27":u.query+="#"==r?"%23":fM(r,cM)):(u.fragment="",c=xM);break;case xM:r!=by&&(u.fragment+=fM(r,lM))}l++}},parseHost:function(e){var t,n,o;if("["==Fy(e,0)){if("]"!=Fy(e,e.length-1))return"Invalid host";if(!(t=function(e){var t,n,o,r,i,a,s,u=[0,0,0,0,0,0,0,0],c=0,l=null,d=0,p=function(){return Fy(e,d)};if(":"==p()){if(":"!=Fy(e,1))return;d+=2,l=++c}for(;p();){if(8==c)return;if(":"!=p()){for(t=n=0;n<4&&qy(oM,p());)t=16*t+Gy(p(),16),d++,n++;if("."==p()){if(0==n)return;if(d-=n,c>6)return;for(o=0;p();){if(r=null,o>0){if(!("."==p()&&o<4))return;d++}if(!qy(Qy,p()))return;for(;qy(Qy,p());){if(i=Gy(p(),10),null===r)r=i;else{if(0==r)return;r=10*r+i}if(r>255)return;d++}u[c]=256*u[c]+r,2!=++o&&4!=o||c++}if(4!=o)return;break}if(":"==p()){if(d++,!p())return}else if(p())return;u[c++]=t}else{if(null!==l)return;d++,l=++c}}if(null!==l)for(a=c-l,c=7;0!=c&&a>0;)s=u[c],u[c--]=u[l+a-1],u[l+--a]=s;else if(8!=c)return;return u}(Wy(e,1,-1))))return"Invalid host";this.host=t}else if(this.isSpecial()){if(e=function(e){var t,n,o=[],r=R_(L_(w_(e),I_,"."),".");for(t=0;t<r.length;t++)n=r[t],A_(o,T_(M_,n)?"xn--"+P_(n):n);return E_(o,".")}(e),qy(rM,e))return"Invalid host";if(null===(t=function(e){var t,n,o,r,i,a,s,u=Zy(e,".");if(u.length&&""==u[u.length-1]&&u.length--,(t=u.length)>4)return e;for(n=[],o=0;o<t;o++){if(""==(r=u[o]))return e;if(i=10,r.length>1&&"0"==Fy(r,0)&&(i=qy(eM,r)?16:8,r=Wy(r,8==i?1:2)),""===r)a=0;else{if(!qy(10==i?nM:8==i?tM:oM,r))return e;a=Gy(r,i)}Ky(n,a)}for(o=0;o<t;o++)if(a=n[o],o==t-1){if(a>=xy(256,5-t))return null}else if(a>255)return null;for(s=Hy(n),o=0;o<n.length;o++)s+=n[o]*xy(256,3-o);return s}(e)))return"Invalid host";this.host=t}else{if(qy(iM,e))return"Invalid host";for(t="",n=wo(e),o=0;o<n.length;o++)t+=fM(n[o],cM);this.host=t}},cannotHaveUsernamePasswordPort:function(){return!this.host||this.cannotBeABaseURL||"file"==this.scheme},includesCredentials:function(){return""!=this.username||""!=this.password},isSpecial:function(){return Ae(hM,this.scheme)},shortenPath:function(){var e=this.path,t=e.length;!t||"file"==this.scheme&&1==t&&gM(e[0],!0)||e.length--},serialize:function(){var e=this,t=e.scheme,n=e.username,o=e.password,r=e.host,i=e.port,a=e.path,s=e.query,u=e.fragment,c=t+":";return null!==r?(c+="//",e.includesCredentials()&&(c+=n+(o?":"+o:"")+"@"),c+=uM(r),null!==i&&(c+=":"+i)):"file"==t&&(c+="//"),c+=e.cannotBeABaseURL?a[0]:a.length?"/"+By(a,"/"):"",null!==s&&(c+="?"+s),null!==u&&(c+="#"+u),c},setHref:function(e){var t=this.parse(e);if(t)throw Py(t);this.searchParams.update()},getOrigin:function(){var e=this.scheme,t=this.port;if("blob"==e)try{return new qM(e.path[0]).origin}catch(yD){return"null"}return"file"!=e&&this.isSpecial()?e+"://"+uM(this.host)+(null!==t?":"+t:""):"null"},getProtocol:function(){return this.scheme+":"},setProtocol:function(e){this.parse(pn(e)+":",_M)},getUsername:function(){return this.username},setUsername:function(e){var t=wo(pn(e));if(!this.cannotHaveUsernamePasswordPort()){this.username="";for(var n=0;n<t.length;n++)this.username+=fM(t[n],pM)}},getPassword:function(){return this.password},setPassword:function(e){var t=wo(pn(e));if(!this.cannotHaveUsernamePasswordPort()){this.password="";for(var n=0;n<t.length;n++)this.password+=fM(t[n],pM)}},getHost:function(){var e=this.host,t=this.port;return null===e?"":null===t?uM(e):uM(e)+":"+t},setHost:function(e){this.cannotBeABaseURL||this.parse(e,EM)},getHostname:function(){var e=this.host;return null===e?"":uM(e)},setHostname:function(e){this.cannotBeABaseURL||this.parse(e,AM)},getPort:function(){var e=this.port;return null===e?"":pn(e)},setPort:function(e){this.cannotHaveUsernamePasswordPort()||(""==(e=pn(e))?this.port=null:this.parse(e,LM))},getPathname:function(){var e=this.path;return this.cannotBeABaseURL?e[0]:e.length?"/"+By(e,"/"):""},setPathname:function(e){this.cannotBeABaseURL||(this.path=[],this.parse(e,NM))},getSearch:function(){var e=this.query;return e?"?"+e:""},setSearch:function(e){""==(e=pn(e))?this.query=null:("?"==Fy(e,0)&&(e=Wy(e,1)),this.query="",this.parse(e,UM)),this.searchParams.update()},getSearchParams:function(){return this.searchParams.facade},getHash:function(){var e=this.fragment;return e?"#"+e:""},setHash:function(e){""!=(e=pn(e))?("#"==Fy(e,0)&&(e=Wy(e,1)),this.fragment="",this.parse(e,xM)):this.fragment=null},update:function(){this.query=this.searchParams.serialize()||null}};var qM=function(e){var t=ws(this,BM),n=Vs(arguments.length,1)>1?arguments[1]:void 0,o=Ly(t,new FM(e,!1,n));O||(t.href=o.serialize(),t.origin=o.getOrigin(),t.protocol=o.getProtocol(),t.username=o.getUsername(),t.password=o.getPassword(),t.host=o.getHost(),t.hostname=o.getHostname(),t.port=o.getPort(),t.pathname=o.getPathname(),t.search=o.getSearch(),t.searchParams=o.getSearchParams(),t.hash=o.getHash())},BM=qM.prototype,VM=function(e,t){return{get:function(){return Ry(this)[e]()},set:t&&function(e){return Ry(this)[t](e)},configurable:!0,enumerable:!0}};if(O&&Ey(BM,{href:VM("serialize","setHref"),origin:VM("getOrigin"),protocol:VM("getProtocol","setProtocol"),username:VM("getUsername","setUsername"),password:VM("getPassword","setPassword"),host:VM("getHost","setHost"),hostname:VM("getHostname","setHostname"),port:VM("getPort","setPort"),pathname:VM("getPathname","setPathname"),search:VM("getSearch","setSearch"),searchParams:VM("getSearchParams"),hash:VM("getHash","setHash")}),Dt(BM,"toJSON",(function(){return Ry(this).serialize()}),{enumerable:!0}),Dt(BM,"toString",(function(){return Ry(this).serialize()}),{enumerable:!0}),Ny){var HM=Ny.createObjectURL,KM=Ny.revokeObjectURL;HM&&Dt(qM,"createObjectURL",jn(HM,Ny)),KM&&Dt(qM,"revokeObjectURL",jn(KM,Ny))}or(qM,"URL"),on({global:!0,forced:!g_,sham:!O},{URL:qM}),on({target:"Object",stat:!0,forced:Object.assign!==y_},{assign:y_});var jM=function(){function e(t){r(this,e),this._imageMemoryURL="",tl?this.createImageDataASURLInWXMiniApp(t.file):this.createImageDataASURLInWeb(t.file),this._initImageInfoModel(),this.type=Ir.MSG_IMAGE,this._percent=0,this.content={imageFormat:t.imageFormat||Gl.UNKNOWN,uuid:t.uuid,imageInfoArray:[]},this.initImageInfoArray(t.imageInfoArray),this._autoFixUrl()}return a(e,[{key:"_initImageInfoModel",value:function(){var e=this;this._ImageInfoModel=function(t){this.instanceID=ld(9999999),this.sizeType=t.type||0,this.type=0,this.size=t.size||0,this.width=t.width||0,this.height=t.height||0,this.imageUrl=t.url||"",this.url=t.url||e._imageMemoryURL||e._defaultImage},this._ImageInfoModel.prototype={setSizeType:function(e){this.sizeType=e},setType:function(e){this.type=e},setImageUrl:function(e){e&&(this.imageUrl=e)},getImageUrl:function(){return this.imageUrl}}}},{key:"initImageInfoArray",value:function(e){for(var t=0,n=null,o=null;t<=2;)o=Ql(e)||Ql(e[t])?{type:0,size:0,width:0,height:0,url:""}:e[t],(n=new this._ImageInfoModel(o)).setSizeType(t+1),n.setType(t),this.addImageInfo(n),t++;this.updateAccessSideImageInfoArray()}},{key:"updateImageInfoArray",value:function(e){for(var t,n=this.content.imageInfoArray.length,o=0;o<n;o++)t=this.content.imageInfoArray[o],e[o].size&&(t.size=e[o].size),e[o].url&&t.setImageUrl(e[o].url),e[o].width&&(t.width=e[o].width),e[o].height&&(t.height=e[o].height)}},{key:"_autoFixUrl",value:function(){for(var e=this.content.imageInfoArray.length,t="",n="",o=["http","https"],r=null,i=0;i<e;i++)this.content.imageInfoArray[i].url&&""!==(r=this.content.imageInfoArray[i]).imageUrl&&(n=r.imageUrl.slice(0,r.imageUrl.indexOf("://")+1),t=r.imageUrl.slice(r.imageUrl.indexOf("://")+1),o.indexOf(n)<0&&(n="https:"),this.content.imageInfoArray[i].setImageUrl([n,t].join("")))}},{key:"updatePercent",value:function(e){this._percent=e,this._percent>1&&(this._percent=1)}},{key:"updateImageFormat",value:function(e){this.content.imageFormat=Gl[e.toUpperCase()]||Gl.UNKNOWN}},{key:"createImageDataASURLInWeb",value:function(e){void 0!==e&&e.files.length>0&&(this._imageMemoryURL=window.URL.createObjectURL(e.files[0]))}},{key:"createImageDataASURLInWXMiniApp",value:function(e){e&&e.url&&(this._imageMemoryURL=e.url)}},{key:"replaceImageInfo",value:function(e,t){this.content.imageInfoArray[t]instanceof this._ImageInfoModel||(this.content.imageInfoArray[t]=e)}},{key:"addImageInfo",value:function(e){this.content.imageInfoArray.length>=3||this.content.imageInfoArray.push(e)}},{key:"updateAccessSideImageInfoArray",value:function(){var e=this.content.imageInfoArray,t=e[0],n=t.width,o=void 0===n?0:n,r=t.height,i=void 0===r?0:r;0!==o&&0!==i&&(Rd(e),Object.assign(e[2],Ld({originWidth:o,originHeight:i,min:720})))}},{key:"sendable",value:function(){return 0!==this.content.imageInfoArray.length&&""!==this.content.imageInfoArray[0].imageUrl&&0!==this.content.imageInfoArray[0].size}}]),e}(),zM=function(){function e(t){r(this,e),this.type=Ir.MSG_FACE,this.content=t||null}return a(e,[{key:"sendable",value:function(){return null!==this.content}}]),e}(),ZM=function(){function e(t){r(this,e),this.type=Ir.MSG_AUDIO,this._percent=0,this.content={downloadFlag:2,second:t.second,size:t.size,url:t.url,remoteAudioUrl:t.url||"",uuid:t.uuid}}return a(e,[{key:"updatePercent",value:function(e){this._percent=e,this._percent>1&&(this._percent=1)}},{key:"updateAudioUrl",value:function(e){this.content.remoteAudioUrl=e}},{key:"sendable",value:function(){return""!==this.content.remoteAudioUrl}}]),e}(),WM={from:!0,groupID:!0,groupName:!0,to:!0},YM=function(){function e(t){r(this,e),this.type=Ir.MSG_GRP_TIP,this.content={},this._initContent(t)}return a(e,[{key:"_initContent",value:function(e){var t=this;Object.keys(e).forEach((function(n){switch(n){case"remarkInfo":case"operatorInfo":case"memberExtraInfo":case"onlineMemberInfo":break;case"groupProfile":t.content.groupProfile={},t._initGroupProfile(e[n]);break;case"memberInfoList":case"msgMemberInfo":t._updateMemberList(e[n]);break;case"memberNum":t.content[n]=e[n],t.content.memberCount=e[n];break;case"newGroupProfile":t.content.newGroupProfile={},t._initNewGroupProfile(e[n]);break;default:t.content[n]=e[n]}})),this.content.userIDList||(this.content.userIDList=[this.content.operatorID])}},{key:"_initGroupProfile",value:function(e){for(var t=Object.keys(e),n=0;n<t.length;n++){var o=t[n];WM[o]&&(this.content.groupProfile[o]=e[o])}}},{key:"_updateMemberList",value:function(e){Hd(this.content.memberList)?this.content.memberList=e:this.content.memberList.forEach((function(t){e.forEach((function(e){t.userID===e.userID&&Object.assign(t,e)}))}))}},{key:"_initNewGroupProfile",value:function(e){for(var t=Object.keys(e),n=0;n<t.length;n++){var o=t[n];this.content.newGroupProfile[o]="muteAllMembers"!==o?e[o]:1===e[o]}}}]),e}(),JM={from:!0,groupID:!0,groupName:!0,to:!0},XM=function(){function e(t){r(this,e),this.type=Ir.MSG_GRP_SYS_NOTICE,this.content={},this._initContent(t)}return a(e,[{key:"_initContent",value:function(e){var t=this;Object.keys(e).forEach((function(n){switch(n){case"memberInfoList":break;case"remarkInfo":t.content.handleMessage=e[n];break;case"groupProfile":t.content.groupProfile={},t._initGroupProfile(e[n]);break;default:t.content[n]=e[n]}}))}},{key:"_initGroupProfile",value:function(e){for(var t=Object.keys(e),n=0;n<t.length;n++){var o=t[n];JM[o]&&("groupName"===o?this.content.groupProfile.name=e[o]:this.content.groupProfile[o]=e[o])}}}]),e}(),$M=Math.min,QM=[].lastIndexOf,eI=!!QM&&1/[1].lastIndexOf(1,-0)<0,tI=uo("lastIndexOf"),nI=eI||!tI?function(e){if(eI)return Ca(QM,this,arguments)||0;var t=ee(this),n=Gt(t),o=n-1;for(arguments.length>1&&(o=$M(o,Lt(arguments[1]))),o<0&&(o=n+o);o>=0;o--)if(o in t&&t[o]===e)return o||0;return-1}:QM;on({target:"Array",proto:!0,forced:nI!==[].lastIndexOf},{lastIndexOf:nI});var oI=function(){function e(t){r(this,e),this.type=Ir.MSG_FILE,this._percent=0;var n=this._getFileInfo(t);this.content={downloadFlag:2,fileUrl:t.url||"",uuid:t.uuid,fileName:n.name||"",fileSize:n.size||0}}return a(e,[{key:"_getFileInfo",value:function(e){if(!Ql(e.fileName)&&!Ql(e.fileSize))return{size:e.fileSize,name:e.fileName};var t=e.file.files[0];if(Qc){if(t.path&&-1!==t.path.indexOf(".")){var n=t.path.slice(t.path.lastIndexOf(".")+1).toLowerCase();t.type=n,t.name||(t.name="".concat(ld(999999),".").concat(n))}t.name||(t.type="",t.name=t.path.slice(t.path.lastIndexOf("/")+1).toLowerCase()),t.suffix&&(t.type=t.suffix),t.url||(t.url=t.path)}return{size:t.size,name:t.name}}},{key:"updatePercent",value:function(e){this._percent=e,this._percent>1&&(this._percent=1)}},{key:"updateFileUrl",value:function(e){this.content.fileUrl=e}},{key:"sendable",value:function(){return""!==this.content.fileUrl&&""!==this.content.fileName&&0!==this.content.fileSize}}]),e}(),rI=function(){function e(t){r(this,e),this.type=Ir.MSG_CUSTOM,this.content={data:t.data||"",description:t.description||"",extension:t.extension||""}}return a(e,[{key:"setData",value:function(e){return this.content.data=e,this}},{key:"setDescription",value:function(e){return this.content.description=e,this}},{key:"setExtension",value:function(e){return this.content.extension=e,this}},{key:"sendable",value:function(){return 0!==this.content.data.length||0!==this.content.description.length||0!==this.content.extension.length}}]),e}(),iI=function(){function e(t){r(this,e),this.type=Ir.MSG_VIDEO,this._percent=0,this.content={remoteVideoUrl:t.remoteVideoUrl||t.videoUrl||"",videoFormat:t.videoFormat,videoSecond:parseInt(t.videoSecond,10),videoSize:t.videoSize,videoUrl:t.videoUrl,videoDownloadFlag:2,videoUUID:t.videoUUID,thumbUUID:t.thumbUUID,thumbFormat:t.thumbFormat,thumbWidth:t.thumbWidth,snapshotWidth:t.thumbWidth,thumbHeight:t.thumbHeight,snapshotHeight:t.thumbHeight,thumbSize:t.thumbSize,snapshotSize:t.thumbSize,thumbDownloadFlag:2,thumbUrl:t.thumbUrl,snapshotUrl:t.thumbUrl}}return a(e,[{key:"updatePercent",value:function(e){this._percent=e,this._percent>1&&(this._percent=1)}},{key:"updateVideoUrl",value:function(e){e&&(this.content.remoteVideoUrl=e)}},{key:"updateSnapshotInfo",value:function(e){var t=e.snapshotUrl,n=e.snapshotWidth,o=e.snapshotHeight;Hd(t)||(this.content.thumbUrl=this.content.snapshotUrl=t),Hd(n)||(this.content.thumbWidth=this.content.snapshotWidth=Number(n)),Hd(o)||(this.content.thumbHeight=this.content.snapshotHeight=Number(o))}},{key:"sendable",value:function(){return""!==this.content.remoteVideoUrl}}]),e}(),aI=function(){function e(t){r(this,e),this.type=Ir.MSG_LOCATION;var n=t.description,o=t.longitude,i=t.latitude;this.content={description:n,longitude:o,latitude:i}}return a(e,[{key:"sendable",value:function(){return!0}}]),e}(),sI=function(){function e(t){if(r(this,e),this.from=t.from,this.messageSender=t.from,this.time=t.time,this.messageSequence=t.sequence,this.clientSequence=t.clientSequence||t.sequence,this.messageRandom=t.random,this.cloudCustomData=t.cloudCustomData||"",this.clientTime=t.clientTime||void 0,t.ID)this.ID=t.ID||"",this.nick=t.nick||"",this.avatar=t.avatar||"",this.messageBody=[{type:t.type,payload:t.payload}],t.conversationType.startsWith(Ir.CONV_C2C)?this.receiverUserID=t.to:t.conversationType.startsWith(Ir.CONV_GROUP)&&(this.receiverGroupID=t.to),this.messageReceiver=t.to;else{this.nick=t.nick||"",this.avatar=t.avatar||"",this.messageBody=[];var n=t.elements[0].type,o=t.elements[0].content;this._patchRichMediaPayload(n,o),n===Ir.MSG_MERGER?this.messageBody.push({type:n,payload:new uI(o).content}):this.messageBody.push({type:n,payload:o}),t.groupID&&(this.receiverGroupID=t.groupID,this.messageReceiver=t.groupID),t.to&&(this.receiverUserID=t.to,this.messageReceiver=t.to),this.ID="".concat(t.tinyID,"-").concat(t.clientTime,"-").concat(t.random)}}return a(e,[{key:"_patchRichMediaPayload",value:function(e,t){e===Ir.MSG_IMAGE?t.imageInfoArray.forEach((function(e){!e.imageUrl&&e.url&&(e.imageUrl=e.url,e.sizeType=e.type,1===e.type?e.type=0:3===e.type&&(e.type=1))})):e===Ir.MSG_VIDEO?!t.remoteVideoUrl&&t.videoUrl&&(t.remoteVideoUrl=t.videoUrl):e===Ir.MSG_AUDIO?!t.remoteAudioUrl&&t.url&&(t.remoteAudioUrl=t.url):e===Ir.MSG_FILE&&!t.fileUrl&&t.url&&(t.fileUrl=t.url,t.url=void 0)}}]),e}(),uI=function(){function e(t){if(r(this,e),this.type=Ir.MSG_MERGER,this.content={downloadKey:"",pbDownloadKey:"",messageList:[],title:"",abstractList:[],compatibleText:"",version:0,layersOverLimit:!1},t.downloadKey){var n=t.downloadKey,o=t.pbDownloadKey,i=t.title,a=t.abstractList,s=t.compatibleText,u=t.version;this.content.downloadKey=n,this.content.pbDownloadKey=o,this.content.title=i,this.content.abstractList=a,this.content.compatibleText=s,this.content.version=u||0}else if(Hd(t.messageList))1===t.layersOverLimit&&(this.content.layersOverLimit=!0);else{var c=t.messageList,l=t.title,d=t.abstractList,p=t.compatibleText,f=t.version,h=[];c.forEach((function(e){if(!Hd(e)){var t=new sI(e);h.push(t)}})),this.content.messageList=h,this.content.title=l,this.content.abstractList=d,this.content.compatibleText=p,this.content.version=f||0}}return a(e,[{key:"sendable",value:function(){return!Hd(this.content.messageList)||!Hd(this.content.downloadKey)}}]),e}(),cI={1:Ir.MSG_PRIORITY_HIGH,2:Ir.MSG_PRIORITY_NORMAL,3:Ir.MSG_PRIORITY_LOW,4:Ir.MSG_PRIORITY_LOWEST},lI=function(){function e(t){r(this,e),this.ID="",this.conversationID=t.conversationID||null,this.conversationType=t.conversationType||Ir.CONV_C2C,this.conversationSubType=t.conversationSubType,this.time=t.time||Math.ceil(Date.now()/1e3),this.sequence=t.sequence||0,this.clientSequence=t.clientSequence||t.sequence||0,this.random=t.random||0===t.random?t.random:ld(),this.priority=this._computePriority(t.priority),this.nick=t.nick||"",this.avatar=t.avatar||"",this.isPeerRead=!1,this.nameCard="",this._elements=[],this.isPlaceMessage=t.isPlaceMessage||0,this.isRevoked=2===t.isPlaceMessage||8===t.msgFlagBits,this.from=t.from||null,this.to=t.to||null,this.flow="",this.isSystemMessage=t.isSystemMessage||!1,this.protocol=t.protocol||"JSON",this.isResend=!1,this.isRead=!1,this.status=t.status||xp.SUCCESS,this._onlineOnlyFlag=!1,this._groupAtInfoList=[],this._relayFlag=!1,this.atUserList=[],this.cloudCustomData=t.cloudCustomData||"",this.isDeleted=!1,this.isModified=!1,this._isExcludedFromUnreadCount=!(!t.messageControlInfo||1!==t.messageControlInfo.excludedFromUnreadCount),this._isExcludedFromLastMessage=!(!t.messageControlInfo||1!==t.messageControlInfo.excludedFromLastMessage),this.clientTime=t.clientTime||Rl()||0,this.senderTinyID=t.senderTinyID||t.tinyID||"",this.readReceiptInfo=t.readReceiptInfo||{readCount:void 0,unreadCount:void 0,isPeerRead:void 0},this.needReadReceipt=!0===t.needReadReceipt||1===t.needReadReceipt,this.version=t.messageVersion||0,this.isBroadcastMessage=t.isBroadcastMessage||!1,this._receiverList=t.receiverList||void 0,this.isSupportExtension=!0===t.isSupportExtension||1===t.isSupportExtension,this.revoker=t.revokerInfo&&t.revokerInfo.revoker||null,this.reInitialize(t.currentUser),this.extractGroupInfo(t.groupProfile||null),this.handleGroupAtInfo(t),this.initC2CReadReceiptInfo(t.readReceiptSentByPeer)}return a(e,[{key:"elements",get:function(){return this._elements}},{key:"getElements",value:function(){return this._elements}},{key:"extractGroupInfo",value:function(e){if(null!==e){Yl(e.nick)&&(this.nick=e.nick),Yl(e.avatar)&&(this.avatar=e.avatar);var t=e.messageFromAccountExtraInformation;Xl(t)&&Yl(t.nameCard)&&(this.nameCard=t.nameCard)}}},{key:"handleGroupAtInfo",value:function(e){var t=this;e.payload&&e.payload.atUserList&&e.payload.atUserList.forEach((function(e){e!==Ir.MSG_AT_ALL?(t._groupAtInfoList.push({groupAtAllFlag:0,groupAtUserID:e}),t.atUserList.push(e)):(t._groupAtInfoList.push({groupAtAllFlag:1}),t.atUserList.push(Ir.MSG_AT_ALL))})),$l(e.groupAtInfo)&&e.groupAtInfo.forEach((function(e){0===e.groupAtAllFlag?t.atUserList.push(e.groupAtUserID):1===e.groupAtAllFlag&&t.atUserList.push(Ir.MSG_AT_ALL)}))}},{key:"getGroupAtInfoList",value:function(){return this._groupAtInfoList}},{key:"_initProxy",value:function(){this._elements[0]&&(this.payload=this._elements[0].content,this.type=this._elements[0].type)}},{key:"reInitialize",value:function(e){e&&(this.status=this.from?xp.SUCCESS:xp.UNSEND,!this.from&&(this.from=e)),this._initFlow(e),this._initSequence(e),this._concatConversationID(e),this.generateMessageID()}},{key:"isSendable",value:function(){return 0!==this._elements.length&&"function"==typeof this._elements[0].sendable&&this._elements[0].sendable()}},{key:"_initTo",value:function(e){this.conversationType===Ir.CONV_GROUP&&(this.to=e.groupID)}},{key:"_initSequence",value:function(e){0===this.clientSequence&&e&&(this.clientSequence=function(e){if(!e)return!1;if(void 0===hd[e]){var t=new Date,n="3".concat(t.getHours()).slice(-2),o="0".concat(t.getMinutes()).slice(-2),r="0".concat(t.getSeconds()).slice(-2);hd[e]=parseInt([n,o,r,"0001"].join("")),n=null,o=null,r=null,Pl.l("autoIncrementIndex start index:".concat(hd[e]))}return hd[e]++}(e)),0===this.sequence&&this.conversationType===Ir.CONV_C2C&&(this.sequence=this.clientSequence)}},{key:"generateMessageID",value:function(){this.from===Ir.CONV_SYSTEM&&(this.senderTinyID="144115198244471703"),this.ID="".concat(this.senderTinyID,"-").concat(this.clientTime,"-").concat(this.random)}},{key:"_initFlow",value:function(e){""!==e&&(e===this.from?(this.flow="out",this.isRead=!0):this.flow="in")}},{key:"_concatConversationID",value:function(e){var t=this.to,n="",o=this.conversationType;o!==Ir.CONV_SYSTEM?(n=o===Ir.CONV_C2C?e===this.from?t:this.from:this.to,this.conversationID="".concat(o).concat(n)):this.conversationID=Ir.CONV_SYSTEM}},{key:"isElement",value:function(e){return e instanceof f_||e instanceof jM||e instanceof zM||e instanceof ZM||e instanceof oI||e instanceof iI||e instanceof YM||e instanceof XM||e instanceof rI||e instanceof aI||e instanceof uI}},{key:"setElement",value:function(e){var t=this;if(this.isElement(e))return this._elements=[e],void this._initProxy();var n=function(e){if(e.type&&e.content)switch(e.type){case Ir.MSG_TEXT:t.setTextElement(e.content);break;case Ir.MSG_IMAGE:t.setImageElement(e.content);break;case Ir.MSG_AUDIO:t.setAudioElement(e.content);break;case Ir.MSG_FILE:t.setFileElement(e.content);break;case Ir.MSG_VIDEO:t.setVideoElement(e.content);break;case Ir.MSG_CUSTOM:t.setCustomElement(e.content);break;case Ir.MSG_LOCATION:t.setLocationElement(e.content);break;case Ir.MSG_GRP_TIP:t.setGroupTipElement(e.content);break;case Ir.MSG_GRP_SYS_NOTICE:t.setGroupSystemNoticeElement(e.content);break;case Ir.MSG_FACE:t.setFaceElement(e.content);break;case Ir.MSG_MERGER:t.setMergerElement(e.content)}};if($l(e))for(var o=0;o<e.length;o++)n(e[o]);else n(e);this._initProxy()}},{key:"clearElement",value:function(){this._elements.length=0}},{key:"setTextElement",value:function(e){var t="string"==typeof e?e:e.text,n=new f_({text:t});this._elements.push(n)}},{key:"setImageElement",value:function(e){var t=new jM(e);this._elements.push(t)}},{key:"setAudioElement",value:function(e){var t=new ZM(e);this._elements.push(t)}},{key:"setFileElement",value:function(e){var t=new oI(e);this._elements.push(t)}},{key:"setVideoElement",value:function(e){var t=new iI(e);this._elements.push(t)}},{key:"setLocationElement",value:function(e){var t=new aI(e);this._elements.push(t)}},{key:"setCustomElement",value:function(e){var t=new rI(e);this._elements.push(t)}},{key:"setGroupTipElement",value:function(e){var t={},n=e.operationType;if(Hd(e.memberInfoList)?e.operatorInfo&&(t=e.operatorInfo):n!==Ir.GRP_TIP_MBR_JOIN&&n!==Ir.GRP_TIP_MBR_KICKED_OUT&&n!==Ir.GRP_TIP_MBR_SET_ADMIN&&n!==Ir.GRP_TIP_MBR_CANCELED_ADMIN||(t=e.memberInfoList[0]),!Hd(e.memberExtraInfo)){var o=e.memberExtraInfo.reason;e.msgMemberInfo.forEach((function(e){e.reason=o}))}var r=t,i=r.nick,a=r.avatar;Yl(i)&&(this.nick=i),Yl(a)&&(this.avatar=a);var s=new YM(e);this._elements.push(s)}},{key:"setGroupSystemNoticeElement",value:function(e){var t=new XM(e);this._elements.push(t)}},{key:"setFaceElement",value:function(e){var t=new zM(e);this._elements.push(t)}},{key:"setMergerElement",value:function(e){var t=new uI(e);this._elements.push(t)}},{key:"setIsRead",value:function(e){this.isRead=e}},{key:"setRelayFlag",value:function(e){this._relayFlag=e}},{key:"getRelayFlag",value:function(){return this._relayFlag}},{key:"_computePriority",value:function(e){if(Ql(e))return Ir.MSG_PRIORITY_NORMAL;if(Yl(e)&&-1!==Object.values(cI).indexOf(e))return e;if(Wl(e)){var t=""+e;if(-1!==Object.keys(cI).indexOf(t))return cI[t]}return Ir.MSG_PRIORITY_NORMAL}},{key:"setNickAndAvatar",value:function(e){var t=e.nick,n=e.avatar;Yl(t)&&(this.nick=t),Yl(n)&&(this.avatar=n)}},{key:"setNameCard",value:function(e){Yl(e)&&(this.nameCard=e)}},{key:"initC2CReadReceiptInfo",value:function(e){this.conversationType===Ir.CONV_C2C&&!0===this.needReadReceipt&&(this.readReceiptInfo.isPeerRead=1===e)}}]),e}(),dI=function(e){return{code:0,data:e||{}}},pI=function(e){u(n,e);var t=m(n);function n(e){var o;r(this,n),o=t.call(this);var i=e.code,a=e.message,s=e.data;return o.code=i,o.message=a||o._getErrorMessage(o.code),o.data=s||{},o}return a(n)}(f(Error)),fI=null,hI=function(e){fI=e},gI=function(e){return Promise.resolve(dI(e))},vI=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e instanceof pI)return t&&null!==fI&&fI.emit(Mr.ERROR,e),Promise.reject(e);if(e instanceof Error){var n=new pI({code:Dm});return t&&null!==fI&&fI.emit(Mr.ERROR,n),Promise.reject(n)}if(!Ql(e)&&!Ql(e.code)){var o=new pI(e);return t&&null!==fI&&fI.emit(Mr.ERROR,o),Promise.reject(o)}},mI=function(e){u(o,e);var n=m(o);function o(e){var t;return r(this,o),(t=n.call(this,e))._n="C2CModule",t._messageFromUnreadDBMap=new Map,t._signalingFromUnreadDBList=[],t}return a(o,[{key:"onNewC2CMessage",value:function(e){var t=e.dataList,n=e.isInstantMessage,o=e.C2CRemainingUnreadList,r=e.C2CPairUnreadList;Pl.d("".concat(this._n,".onNewC2CMessage count:").concat(t.length," isInstantMessage:").concat(n));var i=this._newC2CMessageStoredAndSummary({dataList:t,C2CRemainingUnreadList:o,C2CPairUnreadList:r,isInstantMessage:n}),a=i.conversationOptionsList,s=i.messageList,u=i.isUnreadC2CMessage;this.filterModifiedMessage(s),a.length>0&&this.getModule(Vf).onNewMessage({conversationOptionsList:a,isInstantMessage:n,isUnreadC2CMessage:u});var c=this.filterUnmodifiedMessage(s);n&&c.length>0&&this.emitOuterEvent(Mr.MESSAGE_RECEIVED,c),s.length=0}},{key:"_newC2CMessageStoredAndSummary",value:function(e){for(var t=e.dataList,n=e.C2CRemainingUnreadList,o=e.C2CPairUnreadList,r=e.isInstantMessage,i=null,a=[],s=[],u={},c=this.getModule(Zf),l=this.getModule(oh),d=!1,p=this.getModule(Vf),f=0,h=t.length;f<h;f++)if(this._isSignaling(t[f]))this._signalingFromUnreadDBList.push(t[f].eventArray[0].c2CNotifyMsgArray[0]);else{var g=t[f];g.currentUser=this.getMyUserID(),g.conversationType=Ir.CONV_C2C,g.isSystemMessage=!!g.isSystemMessage,(Ql(g.nick)||Ql(g.avatar))&&(d=!0,Pl.d("".concat(this._n,"._newC2CMessageStoredAndSummary nick or avatar missing!"))),i=new lI(g),g.elements=c.parseElements(g.elements,g.from),i.setElement(g.elements),i.setNickAndAvatar({nick:g.nick,avatar:g.avatar});var v=i.conversationID;if(r){if(1===this._messageFromUnreadDBMap.get(i.ID))continue;var m=!1;if(i.from!==this.getMyUserID()){var _=p.getLatestMessageSentByPeer(v);if(_){var y=_.nick,M=_.avatar;d?i.setNickAndAvatar({nick:y,avatar:M}):y===i.nick&&M===i.avatar||(m=!0)}}else{var I=p.getLatestMessageSentByMe(v);if(I){var C=I.nick,k=I.avatar;C===i.nick&&k===i.avatar||p.modifyMessageSentByMe({conversationID:v,latestNick:i.nick,latestAvatar:i.avatar})}}var T=1===t[f].isModified;if(p.isMessageSentByCurrentInstance(i)?i.isModified=T:T=!1,0===g.msgLifeTime)i._onlineOnlyFlag=!0,p.isMessageSentByCurrentInstance(i)||s.push(i);else{if(!p.pushIntoMessageList(s,i,T))continue;m&&(p.modifyMessageSentByPeer({conversationID:v,latestNick:i.nick,latestAvatar:i.avatar}),p.updateUserProfileSpecifiedKey({conversationID:v,nick:i.nick,avatar:i.avatar}))}r&&i.clientTime>0&&l.addMessageDelay(i.clientTime)}else this._messageFromUnreadDBMap.set(i.ID,1);if(0!==g.msgLifeTime){if(!1===i._onlineOnlyFlag){var S=p.getLastMessageTime(v);if(Wl(S)&&i.time<S)continue;if(Ql(u[v])){var b=0;"in"===i.flow&&(i._isExcludedFromUnreadCount||(b=1)),u[v]=a.push({conversationID:v,unreadCount:b,type:i.conversationType,subType:i.conversationSubType,lastMessage:i._isExcludedFromLastMessage?"":i})-1}else{var D=u[v];a[D].type=i.conversationType,a[D].subType=i.conversationSubType,a[D].lastMessage=i._isExcludedFromLastMessage?"":i,"in"===i.flow&&(i._isExcludedFromUnreadCount||a[D].unreadCount++)}}}else i._onlineOnlyFlag=!0}this._handleSignalingFromUnreadDB();var E=!1;if($l(o))for(var A=function(e,t){if(o[e].unreadCount>0){E=!0;var n=a.find((function(t){return t.conversationID==="C2C".concat(o[e].from)}));n?n.unreadCount=o[e].unreadCount:a.push({conversationID:"C2C".concat(o[e].from),unreadCount:o[e].unreadCount,type:Ir.CONV_C2C})}},L=0,R=o.length;L<R;L++)A(L);if($l(n))for(var w=function(e,t){a.find((function(t){return t.conversationID==="C2C".concat(n[e].from)}))||a.push({conversationID:"C2C".concat(n[e].from),type:Ir.CONV_C2C,lastMsgTime:n[e].lastMsgTime})},O=0,N=n.length;O<N;O++)w(O);return{conversationOptionsList:a,messageList:s,isUnreadC2CMessage:E}}},{key:"_isSignaling",value:function(e){var t=e.eventArray;return!(!$l(t)||10!==t[0].event)}},{key:"_handleSignalingFromUnreadDB",value:function(){var e=this._signalingFromUnreadDBList.length;if(Pl.l("".concat(this._n,"._handleSignalingFromUnreadDB signalingCount:").concat(e)),0!==e){var t=[];this._signalingFromUnreadDBList.forEach((function(e){e.hasOwnProperty("c2cMessageRevokedNotify")&&t.push(e)})),this.onC2CMessageRevoked({dataList:t}),this._signalingFromUnreadDBList.length=0,t.length=0}}},{key:"onC2CMessageRevoked",value:function(e){var t=this,n=this.getModule(Vf),o=[],r=null,i=!0;e.dataList.forEach((function(e){if(e.c2cMessageRevokedNotify){var a=e.c2cMessageRevokedNotify.revokedInfos;Ql(a)||a.forEach((function(e){var a=t.getMyUserID()===e.from?"".concat(Ir.CONV_C2C).concat(e.to):"".concat(Ir.CONV_C2C).concat(e.from);r=n.revoke(a,e.sequence,e.random);var s=e.revokerInfo&&e.revokerInfo.revoker;if(r)r.revoker=s,o.push(r);else{var u={conversationID:a,sequence:e.sequence,time:e.time,revoker:s};n.isLastMessageRevoked(u)&&(o.push(u),i=!1)}}))}})),0!==o.length&&(n.onMessageRevoked(o),!0===i&&(Pl.l("".concat(this._n,".onC2CMessageRevoked count:").concat(o.length)),this.emitOuterEvent(Mr.MESSAGE_REVOKED,o)))}},{key:"onC2CMessageReadReceipt",value:function(e){var t=this;e.dataList.forEach((function(e){if(!Hd(e.c2cMessageReadReceipt)){var n=e.c2cMessageReadReceipt.to;e.c2cMessageReadReceipt.uinPairReadArray.forEach((function(e){var o=e.peerReadTime;Pl.d("".concat(t._n,"._onC2CMessageReadReceipt to:").concat(n," peerReadTime:").concat(o));var r="".concat(Ir.CONV_C2C).concat(n),i=t.getModule(Vf);i.recordPeerReadTime(r,o),i.updateMessageIsPeerReadProperty(r,o)}))}}))}},{key:"onC2CMessageReadNotice",value:function(e){var t=this;e.dataList.forEach((function(e){if(!Hd(e.c2cMessageReadNotice)){var n=t.getModule(Vf);e.c2cMessageReadNotice.uinPairReadArray.forEach((function(e){var o=e.from,r=e.peerReadTime;Pl.d("".concat(t._n,".onC2CMessageReadNotice from:").concat(o," lastReadTime:").concat(r));var i="".concat(Ir.CONV_C2C).concat(o);n.updateIsReadAfterReadReport({conversationID:i,lastMessageTime:r}),n.updateUnreadCount(i)}))}}))}},{key:"onC2CMessageModified",value:function(e){Pl.d("".concat(this._n,".onC2CMessageModified options:"),JSON.stringify(e));var n=this.getModule(Vf);e.dataList.forEach((function(e){n.onMessageModified(t(t({},e),{},{conversationType:Ir.CONV_C2C}))}))}},{key:"onReadReceiptList",value:function(e){Pl.d("".concat(this._n,".onReadReceiptList options:"),JSON.stringify(e));var t=e.dataList,n=t.userID,o=t.readReceiptList;this.getModule(Vf).updateReadReceiptInfo({userID:n,readReceiptList:o})}},{key:"sendMessage",value:function(e,t){var n=this._createC2CMessagePack(e,t);return this.request(n)}},{key:"_createC2CMessagePack",value:function(e,t){var n=null;t&&(t.offlinePushInfo&&(n=t.offlinePushInfo),!0===t.onlineUserOnly&&(n?n.disablePush=!0:n={disablePush:!0}));var o="";Yl(e.cloudCustomData)&&e.cloudCustomData.length>0&&(o=e.cloudCustomData);var r=[];if(Xl(t)&&Xl(t.messageControlInfo)){var i=t.messageControlInfo,a=i.excludedFromUnreadCount,s=i.excludedFromLastMessage,u=i.excludedFromContentModeration;!0===a&&r.push("NoUnread"),!0===s&&r.push("NoLastMsg"),!0===u&&r.push("NoMsgCheck")}var c=this.isOnlineMessage(e,t)?0:void 0;return{protocolName:mh,tjgID:this.generateTjgID(e),requestData:{fromAccount:this.getMyUserID(),toAccount:e.to,msgBody:e.getElements(),cloudCustomData:o,msgSeq:e.sequence,msgRandom:e.random,msgLifeTime:c,nick:e.nick,avatar:e.avatar,offlinePushInfo:n?{pushFlag:!0===n.disablePush?1:0,title:n.title||"",desc:n.description||"",ext:n.extension||"",apnsInfo:{badgeMode:!0===n.ignoreIOSBadge?1:0,isVoipPush:this._isVoipPush(n)},androidInfo:{OPPOChannelID:n.androidOPPOChannelID||""}}:void 0,messageControlInfo:0!==c?r:void 0,clientTime:e.clientTime,needReadReceipt:!0===e.needReadReceipt?1:0,isSupportExtension:!0===e.isSupportExtension?1:0}}}},{key:"_isVoipPush",value:function(e){var t=void 0;return Ql(e.disableVoipPush)||(t=!1===e.disableVoipPush?1:0),t}},{key:"isOnlineMessage",value:function(e,t){return!(!t||!0!==t.onlineUserOnly)}},{key:"revokeMessage",value:function(e){return this.request({protocolName:Th,requestData:{msgInfo:{fromAccount:e.from,toAccount:e.to,msgSeq:e.sequence,msgRandom:e.random,msgTimeStamp:e.time}}})}},{key:"deleteMessage",value:function(e){var t=e.to,n=e.keyList;return Pl.l("".concat(this._n,".deleteMessage toAccount:").concat(t," count:").concat(n.length)),this.request({protocolName:Lh,requestData:{fromAccount:this.getMyUserID(),to:t,keyList:n}})}},{key:"modifyRemoteMessage",value:function(e){var t=e.from,n=e.to,o=e.version,r=void 0===o?0:o,i=e.sequence,a=e.random,s=e.time,u=e.payload,c=e.type,l=e.cloudCustomData,d=void 0;return xd(c)&&(d=[]).push({type:c,content:u}),this.request({protocolName:Rh,requestData:{from:t,to:n,version:r,sequence:i,random:a,time:s,elements:d,cloudCustomData:l}})}},{key:"setMessageRead",value:function(e){var t=this,n=e.conversationID,o=e.lastMessageTime,r="".concat(this._n,".setMessageRead");Pl.l("".concat(r," conversationID:").concat(n," lastMessageTime:").concat(o)),Wl(o)||this.outputWarning("DoNotModifyLastTime");var i=new s_("setC2CMessageRead");return i.setMessage("conversationID:".concat(n," lastMessageTime:").concat(o)),this.request({protocolName:Sh,requestData:{C2CMsgReaded:{cookie:"",C2CMsgReadedItem:[{toAccount:n.replace("C2C",""),lastMessageTime:o,receipt:1}]}}}).then((function(){i.setNetworkType(t.getNetworkType()).end(),Pl.l("".concat(r," ok"));var e=t.getModule(Vf);return e.updateIsReadAfterReadReport({conversationID:n,lastMessageTime:o}),e.updateUnreadCount(n),dI()})).catch((function(e){return t.probeNetwork().then((function(t){var n=_(t,2),o=n[0],r=n[1];i.setError(e,o,r).end()})),Pl.l("".concat(r," failed. error:"),e),vI(e)}))}},{key:"getRoamingMessage",value:function(e){var t=this,n="".concat(this._n,".getRoamingMessage"),o=e.peerAccount,r=e.conversationID,i=e.count,a=e.lastMessageTime,s=e.messageKey,u="peerAccount:".concat(o," count:").concat(i||15," lastMessageTime:").concat(a||0," messageKey:").concat(s);Pl.l("".concat(n," ").concat(u));var c=new s_("getC2CRoamingMessages");return this.request({protocolName:Eh,requestData:{peerAccount:o,count:i||15,lastMessageTime:a||0,messageKey:s}}).then((function(e){var o=e.data,i=o.complete,a=o.messageList,s=o.messageKey,l=o.lastMessageTime;Ql(a)?Pl.l("".concat(n," ok. complete:").concat(i," but messageList is undefined!")):Pl.l("".concat(n," ok. complete:").concat(i," count:").concat(a.length)),c.setNetworkType(t.getNetworkType()).setMessage("".concat(u," complete:").concat(i," length:").concat(a.length)).end();var d=t.getModule(Vf);1===i&&d.setCompleted(r);var p=d.onRoamingMessage(a,r);d.modifyMessageList(r),d.updateIsRead(r),d.updateRoamingMessageKeyAndTime(r,s,l);var f=d.getPeerReadTime(r);if(Pl.l("".concat(n," update isPeerRead property. conversationID:").concat(r," peerReadTime:").concat(f)),f)d.updateMessageIsPeerReadProperty(r,f);else{var h=r.replace(Ir.CONV_C2C,"");t.getRemotePeerReadTime([h]).then((function(){d.updateMessageIsPeerReadProperty(r,d.getPeerReadTime(r))}))}var g="";if(p.length>0)g=p[0].ID;else{var v=d.getLocalOldestMessage(r);v&&(g=v.ID)}return Pl.l("".concat(n," nextReqID:").concat(g," stored message count:").concat(p.length)),{nextReqID:g,storedMessageList:p}})).catch((function(e){return t.probeNetwork().then((function(t){var n=_(t,2),o=n[0],r=n[1];c.setMessage(u).setError(e,o,r).end()})),Pl.w("".concat(n," failed. error:"),e),vI(e)}))}},{key:"getRoamingMessagesHopping",value:function(e){var t=this,n="".concat(this._n,".getRoamingMessagesHopping"),o=e.peerAccount,r=e.time,i=void 0===r?0:r,a=e.count,s=e.direction,u="".concat(Ir.CONV_C2C).concat(o),c="peerAccount:".concat(o," count:").concat(a," time:").concat(i," direction:").concat(s);Pl.l("".concat(n," ").concat(c));var l=new s_("getC2CRoamingMessagesHopping");return this.request({protocolName:Eh,requestData:{peerAccount:o,count:a+1,lastMessageTime:i,direction:s}}).then((function(e){var o=e.data,r=o.complete,i=o.messageList,a=void 0===i?[]:i,d=o.lastMessageTime;Pl.l("".concat(n," ok. complete:").concat(r," count:").concat(a.length)),l.setNetworkType(t.getNetworkType()).setMessage("".concat(c," complete:").concat(r," length:").concat(a.length)).end(),1!==r&&(1===s?a.pop():a.shift());var p=t.getModule(Vf).onRoamingMessage(a,u,!1);t._modifyMessageList(u,p);var f=t._computeResult({complete:r,lastMessageTime:d,resultList:p});return dI(f)})).catch((function(e){return t.probeNetwork().then((function(t){var n=_(t,2),o=n[0],r=n[1];l.setMessage(c).setError(e,o,r).end()})),Pl.w("".concat(n," failed. error:"),e),vI(e)}))}},{key:"_computeResult",value:function(e){var t=e.complete,n=void 0===t?0:t,o=e.lastMessageTime,r=e.resultList,i={messageList:y(void 0===r?[]:r),isCompleted:!1,nextMessageTime:""};return 1===n?(i.isCompleted=!0,i):(i.nextMessageTime=o,i)}},{key:"_modifyMessageList",value:function(e,t){var n=this.getModule(Vf).getLocalConversation(e);if(n)for(var o=n.userProfile.nick,r=n.userProfile.avatar,i=this.getModule(Gf).getNickAndAvatarByUserID(this.getMyUserID()),a=i.nick,s=i.avatar,u=t.length-1;u>=0;u--){var c=t[u];"in"===c.flow&&(c.nick!==o&&c.setNickAndAvatar({nick:o}),c.avatar!==r&&c.setNickAndAvatar({avatar:r})),"out"===c.flow&&(c.nick!==a&&c.setNickAndAvatar({nick:a}),c.avatar!==s&&c.setNickAndAvatar({avatar:s}))}}},{key:"getRemotePeerReadTime",value:function(e){var t=this,n="".concat(this._n,".getRemotePeerReadTime");if(Hd(e))return Pl.w("".concat(n," userIDList is empty!")),Promise.resolve();var o=new s_("getPeerReadTime");return Pl.l("".concat(n," userIDList:").concat(e)),this.request({protocolName:Ah,requestData:{userIDList:e}}).then((function(r){var i=r.data.peerReadTimeList;Pl.l("".concat(n," ok. peerReadTimeList:").concat(i));for(var a="",s=t.getModule(Vf),u=0;u<e.length;u++)a+="".concat(e[u],"-").concat(i[u]," "),i[u]>0&&s.recordPeerReadTime("C2C".concat(e[u]),i[u]);o.setNetworkType(t.getNetworkType()).setMessage(a).end()})).catch((function(e){t.probeNetwork().then((function(t){var n=_(t,2),r=n[0],i=n[1];o.setError(e,r,i).end()})),Pl.w("".concat(n," failed. error:"),e)}))}},{key:"sendReadReceipt",value:function(e){var t=this,n=e[0].conversationID.replace(Ir.CONV_C2C,""),o=new s_("sendC2CReadReceipt");o.setMessage("peerAccount:".concat(n));var r=this.getMyUserID(),i=e.filter((function(e){return e.from!==r&&!0===e.needReadReceipt})).map((function(e){return{fromAccount:e.from,toAccount:e.to,sequence:e.sequence,random:e.random,time:e.time,clientTime:e.clientTime}}));if(0===i.length)return vI({code:wv});var a="".concat(this._n,".sendReadReceipt");return Pl.l("".concat(a,". peerAccount:").concat(n," messageInfoList length:").concat(i.length)),this.request({protocolName:pg,requestData:{peerAccount:n,messageInfoList:i}}).then((function(e){return o.end(),Pl.l("".concat(a," ok")),dI()})).catch((function(e){return t.probeNetwork().then((function(t){var n=_(t,2),r=n[0],i=n[1];o.setError(e,r,i).end()})),Pl.w("".concat(a," failed. error:"),e),vI(e)}))}},{key:"getReadReceiptList",value:function(e){var t="".concat(this._n,".getReadReceiptList"),n=this.getMyUserID(),o=e.filter((function(e){return e.from===n&&!0===e.needReadReceipt}));return Pl.l("".concat(t," userID:").concat(n," messageList length:").concat(o.length)),gI({messageList:o})}},{key:"getMessageExtensions",value:function(e,t){return Pl.l("".concat(this._n,".getMessageExtensions startSequence:").concat(t)),this.request({protocolName:Oh,requestData:{from:e.from,to:e.to,messageKey:this._getMessageKey(e),startSequence:t}})}},{key:"modifyMessageExtensions",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return Pl.l("".concat(this._n,".modifyMessageExtensions operateType:").concat(n)),this.request({protocolName:wh,requestData:{from:e.from,to:e.to,messageKey:this._getMessageKey(e),extensionList:t,operateType:n}})}},{key:"_getMessageKey",value:function(e){var t=e.clientSequence,n=e.random,o=e.time;return"".concat(t,"_").concat(n,"_").concat(o)}},{key:"reset",value:function(){Pl.l("".concat(this._n,".reset")),this._messageFromUnreadDBMap.clear(),this._signalingFromUnreadDBList.length=0}}]),o}(lh),_I=ae.match(/firefox\/(\d+)/i),yI=!!_I&&+_I[1],MI=/MSIE|Trident/.test(ae),II=ae.match(/AppleWebKit\/(\d+)\./),CI=!!II&&+II[1],kI=[],TI=j(kI.sort),SI=j(kI.push),bI=w((function(){kI.sort(void 0)})),DI=w((function(){kI.sort(null)})),EI=uo("sort"),AI=!w((function(){if(de)return de<70;if(!(yI&&yI>3)){if(MI)return!0;if(CI)return CI<603;var e,t,n,o,r="";for(e=65;e<76;e++){switch(t=String.fromCharCode(e),e){case 66:case 69:case 70:case 72:n=3;break;case 68:case 71:n=4;break;default:n=2}for(o=0;o<47;o++)kI.push({k:t+o,v:n})}for(kI.sort((function(e,t){return t.v-e.v})),o=0;o<kI.length;o++)t=kI[o].k.charAt(0),r.charAt(r.length-1)!==t&&(r+=t);return"DGBEFHACIJK"!==r}}));on({target:"Array",proto:!0,forced:bI||!DI||!EI||!AI},{sort:function(e){void 0!==e&&ye(e);var t=De(this);if(AI)return void 0===e?TI(t):TI(t,e);var n,o,r=[],i=Gt(t);for(o=0;o<i;o++)o in t&&SI(r,t[o]);for(q_(r,function(e){return function(t,n){return void 0===n?-1:void 0===t?1:void 0!==e?+e(t,n)||0:pn(t)>pn(n)?1:-1}}(e)),n=r.length,o=0;o<n;)t[o]=r[o++];for(;o<i;)delete t[o++];return t}});var LI=so.findIndex,RI=!0;"findIndex"in[]&&Array(1).findIndex((function(){RI=!1})),on({target:"Array",proto:!0,forced:RI},{findIndex:function(e){return LI(this,e,arguments.length>1?arguments[1]:void 0)}}),ji("findIndex");var wI=function(){function e(){r(this,e),this.list=new Map,this._n="MessageListHandler",this._latestMessageSentByPeerMap=new Map,this._latestMessageSentByMeMap=new Map}return a(e,[{key:"getLocalOldestMessageByConversationID",value:function(e){if(!e)return null;if(!this.list.has(e))return null;var t=this.list.get(e).values();return t?t.next().value:null}},{key:"pushIn",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=e.conversationID,o=!0;this.list.has(n)||this.list.set(n,new Map);var r=this._getUniqueIDOfMessage(e);if(this.list.get(n).has(r)){var i=this.list.get(n).get(r);if(!t||!0===i.isModified)return!1}return this.list.get(n).set(r,e),this._setLatestMessageSentByPeer(n,e),this._setLatestMessageSentByMe(n,e),o}},{key:"unshift",value:function(e,t){var n;if($l(e)?e.length>0&&(n=e[0].conversationID,this._unshiftMultipleMessages(e,t)):(n=e.conversationID,this._unshiftSingleMessage(e,t)),n&&n.startsWith(Ir.CONV_C2C)){var o=Array.from(this.list.get(n).values()),r=o.length;if(0===r)return;for(var i=r-1;i>=0;i--)if("out"===o[i].flow){this._setLatestMessageSentByMe(n,o[i]);break}for(var a=r-1;a>=0;a--)if("in"===o[a].flow){this._setLatestMessageSentByPeer(n,o[a]);break}}}},{key:"_unshiftSingleMessage",value:function(e,t){var n=e.conversationID,o=this._getUniqueIDOfMessage(e);if(!this.list.has(n))return this.list.set(n,new Map),this.list.get(n).set(o,e),void t.push(e);var r=this.list.get(n),i=Array.from(r);r.has(o)||(i.unshift([o,e]),this.list.set(n,new Map(i)),t.push(e))}},{key:"_unshiftMultipleMessages",value:function(e,t){for(var n=e.length,o=[],r=e[0].conversationID,i=this.list.get(r),a=this.list.has(r)?Array.from(i):[],s=0;s<n;s++){var u=this._getUniqueIDOfMessage(e[s]);i&&i.has(u)||(o.push([u,e[s]]),t.push(e[s]))}this.list.set(r,new Map(o.concat(a)))}},{key:"remove",value:function(e){var t=e.conversationID,n=this._getUniqueIDOfMessage(e);this.list.has(t)&&this.list.get(t).delete(n)}},{key:"revoke",value:function(e,t,n){if(Pl.d("revoke message",e,t,n),this.list.has(e)){var o,r=S(this.list.get(e));try{for(r.s();!(o=r.n()).done;){var i=_(o.value,2)[1];if(i.sequence===t&&(Ql(n)||i.random===n))return i.isRevoked=!0,i}}catch(s){r.e(s)}finally{r.f()}}return null}},{key:"removeByConversationID",value:function(e){this.list.has(e)&&(this.list.delete(e),this._latestMessageSentByPeerMap.delete(e),this._latestMessageSentByMeMap.delete(e))}},{key:"findMessage",value:function(e){var t,n=null,o=S(this.list);try{for(o.s();!(t=o.n()).done;)for(var r=y(_(t.value,2)[1].values()),i=r.length,a=0;a<i;a++)if(r[a].ID===e){n=r[a];break}}catch(u){o.e(u)}finally{o.f()}return n}},{key:"updateMessageIsPeerReadProperty",value:function(e,t){var n=[];if(this.list.has(e)){var o,r=S(this.list.get(e));try{for(r.s();!(o=r.n()).done;){var i=_(o.value,2)[1];i.time<=t&&!i.isPeerRead&&"out"===i.flow&&(i.isPeerRead=!0,n.push(i))}}catch(s){r.e(s)}finally{r.f()}Pl.l("".concat(this._n,".updateMessageIsPeerReadProperty conversationID:").concat(e," peerReadTime:").concat(t," count:").concat(n.length))}return n}},{key:"updateMessageIsModifiedProperty",value:function(e){var t=e.conversationID;if(this.list.has(t)){var n=this._getUniqueIDOfMessage(e),o=this.list.get(t).get(n);o&&(o.isModified=!0)}}},{key:"hasLocalMessageList",value:function(e){return this.list.has(e)}},{key:"getLocalMessageList",value:function(e){return this.hasLocalMessageList(e)?y(this.list.get(e).values()):[]}},{key:"hasLocalMessage",value:function(e,t){for(var n=!1,o=this.getLocalMessageList(e),r=o.length,i=0;i<r;i++)o[i].ID===t&&(n=!0);return n}},{key:"getLocalMessage",value:function(e,t){for(var n=null,o=this.getLocalMessageList(e),r=o.length,i=0;i<r;i++)if(o[i].ID===t){n=o[i];break}return n}},{key:"getLocalLastMessage",value:function(e){var t=this.getLocalMessageList(e);return t[t.length-1]}},{key:"getLocalOldestMessage",value:function(e){return this.getLocalMessageList(e)[0]}},{key:"_setLatestMessageSentByPeer",value:function(e,t){e.startsWith(Ir.CONV_C2C)&&"in"===t.flow&&this._latestMessageSentByPeerMap.set(e,t)}},{key:"_setLatestMessageSentByMe",value:function(e,t){e.startsWith(Ir.CONV_C2C)&&"out"===t.flow&&this._latestMessageSentByMeMap.set(e,t)}},{key:"getLatestMessageSentByPeer",value:function(e){return this._latestMessageSentByPeerMap.get(e)}},{key:"getLatestMessageSentByMe",value:function(e){return this._latestMessageSentByMeMap.get(e)}},{key:"modifyMessageSentByPeer",value:function(e){var t=e.conversationID,n=e.latestNick,o=e.latestAvatar,r=this.list.get(t);if(!Hd(r)){var i=Array.from(r.values()),a=i.length;if(0!==a){for(var s=null,u=0,c=!1,l=a-1;l>=0;l--)"in"===i[l].flow&&((s=i[l]).nick!==n&&(s.setNickAndAvatar({nick:n}),c=!0),s.avatar!==o&&(s.setNickAndAvatar({avatar:o}),c=!0),c&&(u+=1));Pl.l("".concat(this._n,".modifyMessageSentByPeer conversationID:").concat(t," count:").concat(u))}}}},{key:"modifyMessageSentByMe",value:function(e){var t=e.conversationID,n=e.latestNick,o=e.latestAvatar,r=this.list.get(t);if(!Hd(r)){var i=Array.from(r.values()),a=i.length;if(0!==a){for(var s=null,u=0,c=!1,l=a-1;l>=0;l--)"out"===i[l].flow&&((s=i[l]).nick!==n&&(s.setNickAndAvatar({nick:n}),c=!0),s.avatar!==o&&(s.setNickAndAvatar({avatar:o}),c=!0),c&&(u+=1));Pl.l("".concat(this._n,".modifyMessageSentByMe conversationID:").concat(t," count:").concat(u))}}}},{key:"getTopicConversationIDList",value:function(e){return y(this.list.keys()).filter((function(t){return t.startsWith("".concat(Ir.CONV_GROUP).concat(e))}))}},{key:"traversal",value:function(){if(0!==this.list.size&&-1===Pl.getLevel()){console.group("conversationID-messageCount");var e,t=S(this.list);try{for(t.s();!(e=t.n()).done;){var n=_(e.value,2),o=n[0],r=n[1];console.log("".concat(o,"-").concat(r.size))}}catch(a){t.e(a)}finally{t.f()}console.groupEnd()}}},{key:"onMessageModified",value:function(e,t){if(!this.list.has(e))return{isUpdated:!1,message:null};var n=this._getUniqueIDOfMessage(t),o=this.list.get(e).has(n);if(Pl.d("".concat(this._n,".onMessageModified conversationID:").concat(e," uniqueID:").concat(n," has:").concat(o)),o){var r=this.list.get(e).get(n),i=t.messageVersion,a=t.elements,s=t.cloudCustomData;return r.version<i?(r.version=i,r._elements=JSON.parse(JSON.stringify(a)),r.payload=JSON.parse(JSON.stringify(a[0].content)),r.type=a[0].type,r.cloudCustomData=s,r.isModified=!0,{isUpdated:!0,message:r}):{isUpdated:!1,message:r}}return{isUpdated:!1,message:null}}},{key:"_getUniqueIDOfMessage",value:function(e){var t=e.from,n=e.to,o=e.random,r=e.sequence,i=e.time;return"".concat(t,"-").concat(n,"-").concat(o,"-").concat(r,"-").concat(i)}},{key:"reset",value:function(){this.list.clear(),this._latestMessageSentByPeerMap.clear(),this._latestMessageSentByMeMap.clear()}}]),e}(),OI="_a2KeyAndTinyIDUpdated",NI="_cloudConfigUpdated",PI="_profileUpdated";function GI(e){this.mixin(e)}GI.mixin=function(e){var t=e.prototype||e;t._isReady=!1,t.ready=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e)return this._isReady?void(t?e.call(this):setTimeout(e,1)):(this._readyQueue=this._readyQueue||[],void this._readyQueue.push(e))},t.triggerReady=function(){var e=this;this._isReady=!0,setTimeout((function(){var t=e._readyQueue;e._readyQueue=[],t&&t.length>0&&t.forEach((function(e){e.call(this)}),e)}),1)},t.resetReady=function(){this._isReady=!1,this._readyQueue=[]},t.isReady=function(){return this._isReady}};var UI=["jpg","jpeg","gif","png","bmp","image","webp"],xI=["mp4","quicktime","mov"],FI=1,qI=2,BI=3,VI=255,HI=function(){function e(t){var n=this;r(this,e),Hd(t)||(this.userID=t.userID||"",this.nick=t.nick||"",this.gender=t.gender||"",this.birthday=t.birthday||0,this.location=t.location||"",this.selfSignature=t.selfSignature||"",this.allowType=t.allowType||Ir.ALLOW_TYPE_ALLOW_ANY,this.language=t.language||0,this.avatar=t.avatar||"",this.messageSettings=t.messageSettings||0,this.adminForbidType=t.adminForbidType||Ir.FORBID_TYPE_NONE,this.level=t.level||0,this.role=t.role||0,this.lastUpdatedTime=0,this.profileCustomField=[],Hd(t.profileCustomField)||t.profileCustomField.forEach((function(e){n.profileCustomField.push({key:e.key,value:e.value})})))}return a(e,[{key:"validate",value:function(e){var t=!0,n="";if(Hd(e))return{valid:!1,tips:"empty options"};if(e.profileCustomField)for(var o=e.profileCustomField.length,r=null,i=0;i<o;i++){if(r=e.profileCustomField[i],!Yl(r.key)||-1===r.key.indexOf("Tag_Profile_Custom"))return{valid:!1,tips:"The prefix of keys of the custom profile key-value pairs (which is profileCustomField) must be Tag_Profile_Custom"};if(!Yl(r.value))return{valid:!1,tips:"The type of values of the custom profile key-value pairs (which is profileCustomField) must be String"}}for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){if("profileCustomField"===a)continue;if(Hd(e[a])&&!Yl(e[a])&&!Wl(e[a])){n="key:"+a+", invalid value:"+e[a],t=!1;continue}switch(a){case"nick":Yl(e[a])||(n="nick must be a string",t=!1),cd(e[a])>500&&(n="nick name limited: must less than or equal to ".concat(500," bytes, current size: ").concat(cd(e[a])," bytes"),t=!1);break;case"gender":fd(xl,e.gender)||(n="key:gender, invalid value:"+e.gender,t=!1);break;case"birthday":Wl(e.birthday)||(n="birthday must be a number",t=!1);break;case"location":Yl(e.location)||(n="location must be a string",t=!1);break;case"selfSignature":Yl(e.selfSignature)||(n="selfSignature must be a string",t=!1);break;case"allowType":fd(ql,e.allowType)||(n="key:allowType, invalid value:"+e.allowType,t=!1);break;case"language":Wl(e.language)||(n="language must be a number",t=!1);break;case"avatar":Yl(e.avatar)||(n="avatar must be a string",t=!1);break;case"messageSettings":0!==e.messageSettings&&1!==e.messageSettings&&(n="messageSettings must be 0 or 1",t=!1);break;case"adminForbidType":fd(Fl,e.adminForbidType)||(n="key:adminForbidType, invalid value:"+e.adminForbidType,t=!1);break;case"level":Wl(e.level)||(n="level must be a number",t=!1);break;case"role":Wl(e.role)||(n="role must be a number",t=!1);break;default:n="unknown key:"+a+"  "+e[a],t=!1}}return{valid:t,tips:n}}}]),e}(),KI=a((function e(t){r(this,e),this.value=t,this.next=null})),jI=function(){function e(t){r(this,e),this.MAX_LENGTH=t,this.pTail=null,this.pNodeToDel=null,this.map=new Map}return a(e,[{key:"set",value:function(e){var t=new KI(e);if(this.map.size<this.MAX_LENGTH)null===this.pTail?(this.pTail=t,this.pNodeToDel=t):(this.pTail.next=t,this.pTail=t),this.map.set(e,1);else{var n=this.pNodeToDel;this.pNodeToDel=this.pNodeToDel.next,this.map.delete(n.value),n.next=null,n=null,this.pTail.next=t,this.pTail=t,this.map.set(e,1)}}},{key:"has",value:function(e){return this.map.has(e)}},{key:"delete",value:function(e){this.has(e)&&this.map.delete(e)}},{key:"tail",value:function(){return this.pTail}},{key:"size",value:function(){return this.map.size}},{key:"data",value:function(){return Array.from(this.map.keys())}},{key:"reset",value:function(){for(var e;null!==this.pNodeToDel;)e=this.pNodeToDel,this.pNodeToDel=this.pNodeToDel.next,e.next=null,e=null;this.pTail=null,this.map.clear()}}]),e}(),zI=["groupID","name","avatar","type","introduction","notification","ownerID","selfInfo","createTime","infoSequence","lastInfoTime","lastMessage","nextMessageSeq","memberNum","maxMemberNum","memberList","joinOption","groupCustomField","muteAllMembers","isSupportTopic","_lastRevokedTime"],ZI=function(){function e(t){r(this,e),this.groupID="",this.name="",this.avatar="",this.type="",this.introduction="",this.notification="",this.ownerID="",this.createTime="",this.infoSequence="",this.lastInfoTime="",this.selfInfo={messageRemindType:"",joinTime:"",nameCard:"",role:"",userID:"",memberCustomField:void 0,readedSequence:0,excludedUnreadSequenceList:void 0},this.lastMessage={lastTime:"",lastSequence:"",fromAccount:"",messageForShow:""},this.nextMessageSeq="",this.memberNum="",this.memberCount="",this.maxMemberNum="",this.maxMemberCount="",this.joinOption="",this.groupCustomField=[],this.muteAllMembers=!1,this.isSupportTopic=!1,this._lastRevokedTime=0,this._initGroup(t)}return a(e,[{key:"memberNum",get:function(){return this.memberCount},set:function(e){}},{key:"maxMemberNum",get:function(){return this.maxMemberCount},set:function(e){}},{key:"_initGroup",value:function(e){for(var t in e)zI.indexOf(t)<0||("selfInfo"!==t?("memberNum"===t&&(this.memberCount=e[t]),"maxMemberNum"===t&&(this.maxMemberCount=e[t]),"isSupportTopic"!==t?this[t]=e[t]:this.isSupportTopic=1===e[t]):this.updateSelfInfo(e[t]))}},{key:"updateGroup",value:function(e){var t=this;e.appid=void 0,e.grossTopicNextMsgSeq=void 0,e.selfInfo&&(e.selfInfo.grossTopicReadSeq=void 0);var n=JSON.parse(JSON.stringify(e));n.lastMsgTime&&(this.lastMessage.lastTime=n.lastMsgTime),Ql(n.muteAllMembers)||("On"===n.muteAllMembers?n.muteAllMembers=!0:n.muteAllMembers=!1),n.groupCustomField&&md(this.groupCustomField,n.groupCustomField),Ql(n.memberNum)||(this.memberCount=n.memberNum),Ql(n.maxMemberNum)||(this.maxMemberCount=n.maxMemberNum),Ql(n.isSupportTopic)||(this.isSupportTopic=Wl(n.isSupportTopic)?1===n.isSupportTopic:n.isSupportTopic),sd(this,n,["members","errorCode","lastMsgTime","groupCustomField","memberNum","maxMemberNum","isSupportTopic"]),$l(n.members)&&n.members.length>0&&n.members.forEach((function(e){e.userID===t.selfInfo.userID&&sd(t.selfInfo,e,["sequence"])}))}},{key:"updateSelfInfo",value:function(e){var n={nameCard:e.nameCard,joinTime:e.joinTime,role:e.role,messageRemindType:e.messageRemindType,readedSequence:e.readedSequence,excludedUnreadSequenceList:e.excludedUnreadSequenceList};sd(this.selfInfo,t({},n),[],["",null,void 0,0,NaN])}},{key:"setSelfNameCard",value:function(e){this.selfInfo.nameCard=e}}]),e}(),WI=function(e,n){return Ql(e)?{lastTime:0,lastSequence:0,fromAccount:0,messageForShow:"",payload:null,type:"",isRevoked:!1,cloudCustomData:"",onlineOnlyFlag:!1,nick:"",nameCard:"",version:0,isPeerRead:!1,revoker:null}:e instanceof lI?{lastTime:e.time||0,lastSequence:e.sequence||0,fromAccount:e.from||"",messageForShow:Ud(e.type,e.payload,n),payload:e.payload||null,type:e.type||null,isRevoked:e.isRevoked||!1,cloudCustomData:e.cloudCustomData||"",onlineOnlyFlag:e._onlineOnlyFlag||!1,nick:e.nick||"",nameCard:e.nameCard||"",version:e.version||0,isPeerRead:e.isPeerRead||!1,revoker:e.revoker||null}:t(t({},e),{},{messageForShow:Ud(e.type,e.payload,n)})},YI=function(){function e(t,n){r(this,e),this.conversationID=t.conversationID||"",this.unreadCount=t.unreadCount||0,this.type=t.type||"",this.lastMessage=WI(t.lastMessage,n),t.lastMsgTime&&(this.lastMessage.lastTime=t.lastMsgTime),this._isInfoCompleted=!1,this.peerReadTime=t.peerReadTime||0,this.groupAtInfoList=[],this.remark="",this.isPinned=t.isPinned||!1,this.messageRemindType="",this.markList=t.markList||[],this.customData=t.customData||"",this.conversationGroupList=t.conversationGroupList||[],this._initProfile(t)}return a(e,[{key:"toAccount",get:function(){return this.conversationID.startsWith(Ir.CONV_C2C)?this.conversationID.replace(Ir.CONV_C2C,""):this.conversationID.startsWith(Ir.CONV_GROUP)?this.conversationID.replace(Ir.CONV_GROUP,""):""}},{key:"subType",get:function(){return this.groupProfile?this.groupProfile.type:""}},{key:"_initProfile",value:function(e){var t=this;Object.keys(e).forEach((function(n){switch(n){case"userProfile":t.userProfile=e.userProfile;break;case"groupProfile":t.groupProfile=e.groupProfile}})),Ql(this.userProfile)&&this.type===Ir.CONV_C2C?this.userProfile=new HI({userID:e.conversationID.replace("C2C","")}):Ql(this.groupProfile)&&this.type===Ir.CONV_GROUP&&(this.groupProfile=new ZI({groupID:e.conversationID.replace("GROUP","")}))}},{key:"updateUnreadCount",value:function(e){var t=e.nextUnreadCount,n=e.isFromGetConversations,o=e.isUnreadC2CMessage;Ql(t)||(yd(this.subType)?this.unreadCount=0:n&&this.type===Ir.CONV_GROUP||n&&this.type===Ir.CONV_TOPIC||o&&this.type===Ir.CONV_C2C?this.unreadCount=t:this.unreadCount=this.unreadCount+t)}},{key:"updateLastMessage",value:function(e){this.lastMessage=WI(e)}},{key:"updateGroupAtInfoList",value:function(e){if(!this._isNeedMergeGroupAtInfo(e)){var t,n=(M(t=e.groupAtType)||I(t)||C(t)||T()).slice(0);-1!==n.indexOf(Ir.CONV_AT_ME)&&-1!==n.indexOf(Ir.CONV_AT_ALL)&&(n=[Ir.CONV_AT_ALL_AT_ME]);var o={from:e.from,groupID:e.groupID,topicID:e.topicID,messageSequence:e.sequence,atTypeArray:n,__random:e.__random,__sequence:e.__sequence};this.groupAtInfoList.push(o)}}},{key:"_isNeedMergeGroupAtInfo",value:function(e){var t=e.groupID,n=e.sequence;if(!Md({groupID:t}))return!1;var o=!1;return this.groupAtInfoList.forEach((function(t){t.messageSequence===n&&(t.atTypeArray.indexOf(Ir.CONV_AT_ME)>-1&&e.groupAtType.indexOf(Ir.CONV_AT_ALL)>-1&&(t.atTypeArray=[Ir.CONV_AT_ALL_AT_ME]),t.atTypeArray.indexOf(Ir.CONV_AT_ALL)>-1&&e.groupAtType.indexOf(Ir.CONV_AT_ME)>-1&&(t.atTypeArray=[Ir.CONV_AT_ALL_AT_ME],t.__random=e.__random,t.__sequence=e.__sequence),o=!0)})),o}},{key:"clearGroupAtInfoList",value:function(){this.groupAtInfoList.length=0}},{key:"reduceUnreadCount",value:function(){return this.unreadCount>=1&&(this.unreadCount-=1,!0)}},{key:"isLastMessageRevoked",value:function(e){var t=e.sequence,n=e.time;return this.type===Ir.CONV_C2C&&t===this.lastMessage.lastSequence&&n===this.lastMessage.lastTime||this.type===Ir.CONV_GROUP&&t===this.lastMessage.lastSequence}},{key:"setLastMessageRevoked",value:function(e){this.lastMessage.isRevoked=e}},{key:"setLastMessageRevoker",value:function(e){this.lastMessage.revoker=e}}]),e}(),JI=function(){function e(t){r(this,e),this._conversationModule=t,this._n="MessageRemindHandler",this._updateSequence=0}return a(e,[{key:"getC2CMessageRemindType",value:function(){var e=this,t="".concat(this._n,".getC2CMessageRemindType");return this._conversationModule.request({protocolName:Dh,updateSequence:this._updateSequence}).then((function(n){Pl.l("".concat(t," ok"));var o=n.data,r=o.updateSequence,i=o.muteFlagList;e._updateSequence=r,e._patchC2CMessageRemindType(i)})).catch((function(e){Pl.e("".concat(t," failed. error:"),e)}))}},{key:"_patchC2CMessageRemindType",value:function(e){var t=this,n=0,o="";$l(e)&&e.length>0&&e.forEach((function(e){var r=e.userID,i=e.muteFlag;0===i?o=Ir.MSG_REMIND_ACPT_AND_NOTE:1===i?o=Ir.MSG_REMIND_DISCARD:2===i&&(o=Ir.MSG_REMIND_ACPT_NOT_NOTE),!0===t._conversationModule.patchMessageRemindType({ID:r,isC2CConversation:!0,messageRemindType:o})&&(n+=1)})),Pl.l("".concat(this._n,"._patchC2CMessageRemindType count:").concat(n))}},{key:"set",value:function(e){return e.groupID?this._setGroupMessageRemindType(e):$l(e.userIDList)?this._setC2CMessageRemindType(e):void 0}},{key:"_setGroupMessageRemindType",value:function(e){var t=this,n="".concat(this._n,"._setGroupMessageRemindType"),o=e.groupID,r=e.messageRemindType,i="groupID:".concat(o," messageRemindType:").concat(r),a=new s_("setMessageRemindType");return a.setMessage(i),this._getModule(qf).modifyGroupMemberInfo({groupID:o,messageRemindType:r,userID:this._conversationModule.getMyUserID()}).then((function(){a.setNetworkType(t._conversationModule.getNetworkType()).end(),Pl.l("".concat(n," ok. ").concat(i));var o=t.onGroupMessageRemindTypeUpdated(e);return t._conversationModule.emitTotalUnreadMessageCountUpdate(),dI(o)})).catch((function(e){return t._conversationModule.probeNetwork().then((function(t){var n=_(t,2),o=n[0],r=n[1];a.setError(e,o,r).end()})),Pl.e("".concat(n," failed. error:"),e),vI(e)}))}},{key:"onGroupMessageRemindTypeUpdated",value:function(e){var t=e.groupID,n=e.messageRemindType,o=this._getModule(xf).getLocalGroupProfile(t);if(o&&(o.selfInfo.messageRemindType=n),Id(t)){var r=t,i=Gd(r),a=this._getModule(Bf).getLocalTopic(i,r);return a&&(a.updateSelfInfo({messageRemindType:n}),this._conversationModule.emitOuterEvent(Mr.TOPIC_UPDATED,{groupID:i,topic:a})),{topic:a}}return this._conversationModule.patchMessageRemindType({ID:t,isC2CConversation:!1,messageRemindType:n})&&this._emitConversationUpdate(),{group:o}}},{key:"_setC2CMessageRemindType",value:function(e){var t=this,n="".concat(this._n,"._setC2CMessageRemindType"),o=e.userIDList,r=e.messageRemindType,i=o.slice(0,30),a=0;r===Ir.MSG_REMIND_DISCARD?a=1:r===Ir.MSG_REMIND_ACPT_NOT_NOTE&&(a=2);var s="userIDList:".concat(i," messageRemindType:").concat(r),u=new s_("setMessageRemindType");return u.setMessage(s),this._conversationModule.request({protocolName:bh,requestData:{userIDList:i,muteFlag:a}}).then((function(e){u.setNetworkType(t._conversationModule.getNetworkType()).end();var o=e.data,a=o.updateSequence,s=o.errorList;t._updateSequence=a;var c=[],l=[];$l(s)&&s.forEach((function(e){c.push(e.userID),l.push({userID:e.userID,code:e.errorCode})}));var d=i.filter((function(e){return-1===c.indexOf(e)}));Pl.l("".concat(n," ok. successUserIDList:").concat(d," failureUserIDList:").concat(JSON.stringify(l)));var p=0;return d.forEach((function(e){t._conversationModule.patchMessageRemindType({ID:e,isC2CConversation:!0,messageRemindType:r})&&(p+=1)})),p>=1&&t._emitConversationUpdate(),i.length=c.length=0,t._conversationModule.emitTotalUnreadMessageCountUpdate(),gI({successUserIDList:d.map((function(e){return{userID:e}})),failureUserIDList:l})})).catch((function(e){return t._conversationModule.probeNetwork().then((function(t){var n=_(t,2),o=n[0],r=n[1];u.setError(e,o,r).end()})),Pl.e("".concat(n," failed. error:"),e),vI(e)}))}},{key:"_getModule",value:function(e){return this._conversationModule.getModule(e)}},{key:"_emitConversationUpdate",value:function(){this._conversationModule.emitConversationUpdate(!0,!1)}},{key:"setUpdateSequence",value:function(e){this._updateSequence=e}},{key:"reset",value:function(){Pl.l("".concat(this._n,".reset")),this._updateSequence=0}}]),e}(),XI=kr("splice"),$I=R.TypeError,QI=Math.max,eC=Math.min;on({target:"Array",proto:!0,forced:!XI},{splice:function(e,t){var n,o,r,i,a,s,u=De(this),c=Gt(u),l=Ot(e,c),d=arguments.length;if(0===d?n=o=0:1===d?(n=0,o=c-l):(n=d-2,o=eC(QI(Lt(t),0),c-l)),c+n-o>9007199254740991)throw $I("Maximum allowed length exceeded");for(r=ro(u,o),i=0;i<o;i++)(a=l+i)in u&&bo(r,i,u[a]);if(r.length=o,n<o){for(i=l;i<c-o;i++)s=i+n,(a=i+o)in u?u[s]=u[a]:delete u[s];for(i=c;i>c-o+n;i--)delete u[i-1]}else if(n>o)for(i=c-o;i>l;i--)s=i+n-1,(a=i+o-1)in u?u[s]=u[a]:delete u[s];for(i=0;i<n;i++)u[i+l]=arguments[i+2];return u.length=c-o+n,r}});var tC=function(){function e(t){r(this,e),this._conversationModule=t,this._n="ConvGroupHandler",this._convGroupMap=new Map,this._startIndex=0,this._pagingStatus=Fp.NOT_START}return a(e,[{key:"setConvCustomData",value:function(e){var t=this,n="".concat(this._n,".").concat("setConvCustomData"),o=e.conversationIDList,r=e.customData;Pl.l("".concat(n," options:"),e);var i=new s_("setConvCustomData");i.setMessage(JSON.stringify(e));var a={fromAccount:this._getMyUserID(),itemList:[]},s=[],u=[];return o.forEach((function(e){if(!t._hasLocalConversation(e))return t._onConversationNotFound(u,e),!0;if(!Cd(e)&&!kd(e))return t._onConversationIDInvalid(u,e),!0;var n={operationType:2,contactItem:void 0,customMark:r};Cd(e)?n.contactItem={type:1,toAccount:e.replace(Ir.CONV_C2C,"")}:kd(e)&&(n.contactItem={type:2,groupID:e.replace(Ir.CONV_GROUP,"")}),a.itemList.push(n)})),u.length===o.length?gI({successConversationIDList:s,failureConversationIDList:u}):this._conversationModule.request({protocolName:qh,requestData:a}).then((function(e){i.setNetworkType(t._conversationModule.getNetworkType()).end(),Pl.l("".concat(n," ok"));var o=e.data.resultItem;if($l(o)){var a,c,l=!1;o.forEach((function(e){a=t._concatConversationID(e.contactItem),0===e.resultCode?(s.push(a),(c=t._getLocalConversation(a))&&c.customData!==r&&(c.customData=r,l=!0)):u.push({conversationID:a,code:e.resultCode,message:e.resultInfo})})),!0===l&&t._emitConversationUpdate()}return dI({successConversationIDList:s,failureConversationIDList:u})})).catch((function(e){return t._conversationModule.probeNetwork().then((function(t){var n=_(t,2),o=n[0],r=n[1];i.setError(e,o,r).end()})),Pl.e("".concat(n," failed. error:"),e),vI(e)}))}},{key:"markConversation",value:function(e){var t=this;if(!this._conversationModule.canIUse(Uc.CONV_MARK))return vI({code:Bm});var n="".concat(this._n,".").concat("markConversation"),o=e.conversationIDList,r=e.markType,i=e.enableMark;Pl.l("".concat(n," options:"),e);var a=new s_("markConversation");a.setMessage(JSON.stringify(e));var s=void 0,u=void 0,c=this._getFlagBit(r);!0===i?u=[c]:s=[c];var l={fromAccount:this._getMyUserID(),itemList:[]},d=[],p=[];return o.forEach((function(e){if(!t._hasLocalConversation(e))return t._onConversationNotFound(p,e),!0;if(!Cd(e)&&!kd(e))return t._onConversationIDInvalid(p,e),!0;var n={operationType:1,contactItem:void 0,clearMark:s,setMark:u};Cd(e)?n.contactItem={type:1,toAccount:e.replace(Ir.CONV_C2C,"")}:kd(e)&&(n.contactItem={type:2,groupID:e.replace(Ir.CONV_GROUP,"")}),l.itemList.push(n)})),p.length===o.length?gI({successConversationIDList:d,failureConversationIDList:p}):this._conversationModule.request({protocolName:Bh,requestData:l}).then((function(e){a.setNetworkType(t._conversationModule.getNetworkType()).end(),Pl.l("".concat(n," ok"));var o=e.data.resultItem;if($l(o)){var s,u,c=!1;o.forEach((function(e){if(s=t._concatConversationID(e.contactItem),0===e.resultCode){if(d.push(s),u=t._getLocalConversation(s)){var n=u.markList.indexOf(r);!0===i?-1===n&&(u.markList.push(r),c=!0):-1!==n&&(u.markList.splice(n,1),c=!0)}}else p.push({conversationID:s,code:e.resultCode,message:e.resultInfo})})),!0===c&&t._emitConversationUpdate()}return dI({successConversationIDList:d,failureConversationIDList:p})})).catch((function(e){return t._conversationModule.probeNetwork().then((function(t){var n=_(t,2),o=n[0],r=n[1];a.setError(e,o,r).end()})),Pl.e("".concat(n," failed. error:"),e),vI(e)}))}},{key:"getLocalConvGroupList",value:function(){var e=this;return Pl.l("".concat(this._n,".getLocalConvGroupList pagingStatus:").concat(this._pagingStatus)),this._pagingStatus===Fp.REJECTED?this.getRemoteConvGroupList().then((function(){return dI(y(e._convGroupMap.values()))})):gI(y(this._convGroupMap.values()))}},{key:"getRemoteConvGroupList",value:function(){var e=this,t="".concat(this._n,".getRemoteConvGroupList");return this._pagingStatus=Fp.PENDING,this._conversationModule.request({protocolName:Zh,requestData:{fromAccount:this._getMyUserID(),startIndex:this._startIndex,startTime:Rl()}}).then((function(n){var o,r,i=n.data,a=i.completeFlag,s=i.contactItem,u=i.nextStartIndex,c=void 0===u?0:u,l=i.groupItem;if(e._startIndex=c,Pl.l("".concat(t," completeFlag:").concat(a," nextStartIndex:").concat(c)),$l(l)&&l.forEach((function(t){var n=t.convGroupID,o=t.groupName;e._convGroupMap.set(n,o)})),$l(s)&&s.forEach((function(t){var n=t.standardMark,i=t.customData,a=t.convGroupIDList;if(o=e._concatConversationID(t),(r=e._getLocalConversation(o))&&(r.markList=Fd(n),r.customData=i||"",$l(a))){var s=[];a.forEach((function(t){e._convGroupMap.has(t)&&s.push(e._convGroupMap.get(t))})),r.conversationGroupList=[].concat(s),s.length=0}})),0===a)return e.getRemoteConvGroupList();1===a&&(e._pagingStatus=Fp.RESOLVED,e._emitConversationUpdate(),e._emitConvGroupListUpdate())})).catch((function(n){e._pagingStatus=Fp.REJECTED,Pl.w("".concat(t," failed. error:"),n)}))}},{key:"createConvGroup",value:function(e){var t=this;if(!this._conversationModule.canIUse(Uc.CONV_GROUP))return vI({code:Bm});var n="".concat(this._n,".").concat("createConvGroup");Pl.l("".concat(n," options:"),e);var o=new s_("createConvGroup");o.setMessage(JSON.stringify(e));var r=e.groupName,i=e.conversationIDList,a={fromAccount:this._getMyUserID(),itemList:[{groupName:r,contactItem:[]}]},s=[],u=[];return i.forEach((function(e){return t._hasLocalConversation(e)?Cd(e)||kd(e)?void(Cd(e)?a.itemList[0].contactItem.push({type:1,toAccount:e.replace(Ir.CONV_C2C,"")}):kd(e)&&a.itemList[0].contactItem.push({type:2,groupID:e.replace(Ir.CONV_GROUP,"")})):(t._onConversationIDInvalid(u,e),!0):(t._onConversationNotFound(u,e),!0)})),u.length===i.length?gI({successConversationIDList:s,failureConversationIDList:u}):this._conversationModule.request({protocolName:Vh,requestData:a}).then((function(e){o.setNetworkType(t._conversationModule.getNetworkType()).end(),Pl.l("".concat(n," ok"));var i=e.data.groupResultItem[0],a=i.groupItem,c=i.resultItem;if(Xl(a)&&(t._convGroupMap.set(a.convGroupID,a.groupName),t._emitConvGroupListUpdate()),$l(c)){var l,d,p=!1;c.forEach((function(e){l=t._concatConversationID(e.contactItem),0===e.resultCode?(s.push(l),(d=t._getLocalConversation(l))&&-1===d.conversationGroupList.indexOf(r)&&(d.conversationGroupList.push(r),p=!0)):u.push({conversationID:l,code:e.resultCode,message:e.resultInfo})})),!0===p&&(t._emitConversationUpdate(),t._emitConvGroupListUpdate())}return dI({successConversationIDList:s,failureConversationIDList:u})})).catch((function(e){return t._conversationModule.probeNetwork().then((function(t){var n=_(t,2),r=n[0],i=n[1];o.setError(e,r,i).end()})),Pl.e("".concat(n," failed. error:"),e),vI(e)}))}},{key:"deleteConvGroup",value:function(e){var t=this;if(!this._conversationModule.canIUse(Uc.CONV_GROUP))return vI({code:Bm});var n="".concat(this._n,".").concat("deleteConvGroup");Pl.l("".concat(n," groupName:").concat(e));var o=new s_("deleteConvGroup");return o.setMessage(e),this._conversationModule.request({protocolName:Hh,requestData:{fromAccount:this._getMyUserID(),groupName:[e]}}).then((function(r){o.setNetworkType(t._conversationModule.getNetworkType()).end(),Pl.l("".concat(n," ok"));var i=r.data.groupItem;if($l(i)){var a=!1;i.forEach((function(e){t._convGroupMap.has(e.convGroupID)&&(t._convGroupMap.delete(e.convGroupID),a=!0)})),!0===a&&t._emitConvGroupListUpdate()}t._eraseFromConversationGroupList([e])})).catch((function(e){return t._conversationModule.probeNetwork().then((function(t){var n=_(t,2),r=n[0],i=n[1];o.setError(e,r,i).end()})),Pl.e("".concat(n," failed. error:"),e),vI(e)}))}},{key:"renameConvGroup",value:function(e){var t=this;if(!this._conversationModule.canIUse(Uc.CONV_GROUP))return vI({code:Bm});var n="".concat(this._n,".").concat("renameConvGroup");Pl.l("".concat(n," options:"),e);var o=new s_("renameConvGroup");o.setMessage(JSON.stringify(e));var r=e.oldName,i=e.newName;return this._conversationModule.request({protocolName:Kh,requestData:{fromAccount:this._getMyUserID(),updateType:1,updateGroup:{updateGroupType:1,oldName:r,newName:i}}}).then((function(e){o.setNetworkType(t._conversationModule.getNetworkType()).end(),Pl.l("".concat(n," ok"));var a=e.data.updateGroupResult.convGroupID;t._convGroupMap.set(a,i),t._emitConvGroupListUpdate();var s,u,c=t._conversationModule.getLocalConversationList(),l=!1;c.forEach((function(e){s=e.conversationGroupList,-1!==(u=s.indexOf(r))&&(s.splice(u,1,i),l=!0)})),!0===l&&t._emitConversationUpdate()})).catch((function(e){return t._conversationModule.probeNetwork().then((function(t){var n=_(t,2),r=n[0],i=n[1];o.setError(e,r,i).end()})),Pl.e("".concat(n," failed. error:"),e),vI(e)}))}},{key:"addConvsToGroup",value:function(e){var t=this;if(!this._conversationModule.canIUse(Uc.CONV_GROUP))return vI({code:Bm});var n="".concat(this._n,".").concat("addConvsToGroup");Pl.l("".concat(n," options:"),e);var o=new s_("addConvsToGroup");o.setMessage(JSON.stringify(e));var r=e.conversationIDList,i=e.groupName,a={fromAccount:this._getMyUserID(),updateType:1,updateGroup:{updateGroupType:2,groupName:i,updateItem:[]}},s=[],u=[];return r.forEach((function(e){return t._hasLocalConversation(e)?Cd(e)||kd(e)?void(Cd(e)?a.updateGroup.updateItem.push({operationType:1,contactItem:{type:1,toAccount:e.replace(Ir.CONV_C2C,"")}}):kd(e)&&a.updateGroup.updateItem.push({operationType:1,contactItem:{type:2,groupID:e.replace(Ir.CONV_GROUP,"")}})):(t._onConversationIDInvalid(u,e),!0):(t._onConversationNotFound(u,e),!0)})),u.length===r.length?gI({successConversationIDList:s,failureConversationIDList:u}):this._conversationModule.request({protocolName:jh,requestData:a}).then((function(e){o.setNetworkType(t._conversationModule.getNetworkType()).end(),Pl.l("".concat(n," ok"));var r=e.data.updateGroupResult.contactResultItem;if($l(r)){var a,c,l=!1;r.forEach((function(e){a=t._concatConversationID(e.contactItem),0===e.resultCode?(c=t._getLocalConversation(a))&&-1===c.conversationGroupList.indexOf(i)&&(c.conversationGroupList.push(i),s.push(a),l=!0):u.push({conversationID:a,code:e.resultCode,message:e.resultInfo})})),!0===l&&(t._emitConversationUpdate(),t._emitConvInGroupUpdate(i))}return dI({successConversationIDList:s,failureConversationIDList:u})})).catch((function(e){return t._conversationModule.probeNetwork().then((function(t){var n=_(t,2),r=n[0],i=n[1];o.setError(e,r,i).end()})),Pl.e("".concat(n," failed. error:"),e),vI(e)}))}},{key:"deleteConvsFromGroup",value:function(e){var t=this;if(!this._conversationModule.canIUse(Uc.CONV_GROUP))return vI({code:Bm});var n="".concat(this._n,".").concat("deleteConvsFromGroup");Pl.l("".concat(n," options:"),e);var o=new s_("deleteConvsFromGroup");o.setMessage(JSON.stringify(e));var r=e.conversationIDList,i=e.groupName,a={fromAccount:this._getMyUserID(),updateType:1,updateGroup:{updateGroupType:2,groupName:i,updateItem:[]}},s=[],u=[];return r.forEach((function(e){return t._hasLocalConversation(e)?Cd(e)||kd(e)?void(Cd(e)?a.updateGroup.updateItem.push({operationType:2,contactItem:{type:1,toAccount:e.replace(Ir.CONV_C2C,"")}}):kd(e)&&a.updateGroup.updateItem.push({operationType:2,contactItem:{type:2,groupID:e.replace(Ir.CONV_GROUP,"")}})):(t._onConversationIDInvalid(u,e),!0):(t._onConversationNotFound(u,e),!0)})),u.length===r.length?gI({successConversationIDList:s,failureConversationIDList:u}):this._conversationModule.request({protocolName:zh,requestData:a}).then((function(e){o.setNetworkType(t._conversationModule.getNetworkType()).end(),Pl.l("".concat(n," ok"));var r=e.data.updateGroupResult.contactResultItem;if($l(r)){var a,c,l=!1;r.forEach((function(e){if(a=t._concatConversationID(e.contactItem),0===e.resultCode){if(c=t._getLocalConversation(a)){var n=c.conversationGroupList.indexOf(i);-1!==n&&(c.conversationGroupList.splice(n,1),s.push(a),l=!0)}}else u.push({conversationID:a,code:e.resultCode,message:e.resultInfo})})),!0===l&&(t._emitConversationUpdate(),t._emitConvInGroupUpdate(i))}return dI({successConversationIDList:s,failureConversationIDList:u})})).catch((function(e){return t._conversationModule.probeNetwork().then((function(t){var n=_(t,2),r=n[0],i=n[1];o.setError(e,r,i).end()})),Pl.e("".concat(n," failed. error:"),e),vI(e)}))}},{key:"onConvMarkUpdated",value:function(e){var t=this;if(!Hd(e)){var n,o;Pl.d("".concat(this._n,".onConvMarkUpdated markItemList:"),e);var r=!1;e.forEach((function(e){var i=e.recentContactItem,a=e.optType,s=e.standardMark,u=e.customMark;if(n=t._concatConversationID(i),o=t._getLocalConversation(n))if(1===a){var c=Fd(s);!0!==function(e,t){if(e===t)return!0;if(!e||!t)return!1;if(e.length!==t.length)return!1;for(var n=0,o=e.length;n<o;n++)if(e[n]!==t[n])return!1;return!0}(o.markList,c)&&(o.markList=c,r=!0)}else 2===a&&o.customData!==u&&void 0!==u&&(o.customData=u,r=!0)})),!0===r&&this._emitConversationUpdate()}}},{key:"onConvGroupCreated",value:function(e){var t=this;Pl.d("".concat(this._n,".onConvGroupCreated resultList:"),e);var n=!1,o=!1;$l(e)&&(e.forEach((function(e){var r=e.msgGroupItem,i=r.groupID,a=r.groupName;t._convGroupMap.get(i)!==a&&(t._convGroupMap.set(i,a),o=!0);var s,u,c=e.msgRecentContactItem;$l(c)&&c.forEach((function(e){s=t._concatConversationID(e),(u=t._getLocalConversation(s))&&-1===u.conversationGroupList.indexOf(a)&&(u.conversationGroupList.push(a),n=!0)}))})),!0===n&&this._emitConversationUpdate(),!0===o&&this._emitConvGroupListUpdate())}},{key:"onConvGroupDeleted",value:function(e){var t=this;Pl.d("".concat(this._n,".onConvGroupDeleted groupItemList:"),e);var n=[];if($l(e)){var o=!1;e.forEach((function(e){var r=e.groupID,i=e.groupName;t._convGroupMap.has(r)&&(t._convGroupMap.delete(r),o=!0,n.push(i))})),!0===o&&this._emitConvGroupListUpdate()}this._eraseFromConversationGroupList(n)}},{key:"_eraseFromConversationGroupList",value:function(e){Hd(e)||(this._conversationModule.getLocalConversationList().forEach((function(t){t.conversationGroupList=t.conversationGroupList.filter((function(t){return!e.includes(t)}))})),this._emitConversationUpdate())}},{key:"onConvGroupNameUpdated",value:function(e){Pl.d("".concat(this._n,".onConvGroupNameUpdated options:"),e);var t=e.groupID,n=e.groupName,o=e.oldGroupName;if(this._convGroupMap.get(t)!==n){this._convGroupMap.set(t,n),this._emitConvGroupListUpdate();var r,i,a=this._conversationModule.getLocalConversationList(),s=!1;a.forEach((function(e){r=e.conversationGroupList,-1!==(i=r.indexOf(o))&&(r.splice(i,1,n),s=!0)})),!0===s&&this._emitConversationUpdate()}}},{key:"onConvInGroupUpdated",value:function(e){var t=this;Pl.d("".concat(this._n,".onConvInGroupUpdated options:"),e);var n=e.oldGroupName,o=e.recentContactUpdateGroupItem;if($l(o)){var r,i,a,s=!1;o.forEach((function(e){var o=e.contactOptType,u=e.recentContactItem;r=t._concatConversationID(u),(i=t._getLocalConversation(r))&&(a=i.conversationGroupList.indexOf(n),1===o?-1===a&&(i.conversationGroupList.push(n),s=!0):2===o&&-1!==a&&(i.conversationGroupList.splice(a,1),s=!0))})),!0===s&&(this._emitConversationUpdate(),this._emitConvInGroupUpdate(n))}}},{key:"onConvAddedToOrDeletedFromGroup",value:function(e){var t=this;Pl.d("".concat(this._n,".onConvAddedToOrDeletedFromGroup options:"),e);var n=e.msgRecentContactItem,o=e.msgRecentContactUpdateContactItem,r=this._concatConversationID(n),i=this._getLocalConversation(r);if(i&&$l(o)){var a,s=!1;o.forEach((function(e){var n=e.groupOptType,o=e.recentContactGroupItem.groupName;a=i.conversationGroupList.indexOf(o),1===n?-1===a&&(i.conversationGroupList.push(o),s=!0):2===n&&-1!==a&&(i.conversationGroupList.splice(a,1),s=!0),!0===s&&t._emitConvInGroupUpdate(o)})),!0===s&&this._emitConversationUpdate()}}},{key:"onConvGroupListSynced",value:function(e){var t=this;$l(e)&&0!==e.length&&(Pl.l("".concat(this._n,".onConvGroupListSynced groupItemList:"),e),e.forEach((function(e){t._convGroupMap.set(e.convGroupID,e.groupName)})))}},{key:"getConvGroupListByID",value:function(e){var t=this;if(!Hd(e)){var n=[];return e.forEach((function(e){t._convGroupMap.has(e)&&n.push(t._convGroupMap.get(e))})),n}}},{key:"_onConversationNotFound",value:function(e,t){e.push({conversationID:t,code:em,message:this._conversationModule.getErrorMessage(em)})}},{key:"_onConversationIDInvalid",value:function(e,t){e.push({conversationID:t,code:om,message:this._conversationModule.getErrorMessage(om)})}},{key:"_getFlagBit",value:function(e){for(var t=e.toString(2),n=t.length,o=n-1;o>=0;o--)if("1"===t[o])return n-o-1}},{key:"_concatConversationID",value:function(e){var t,n=e.type,o=e.to,r=e.groupID,i=e.userID;return 1===n?Ql(i)?Ql(o)||(t="".concat(Ir.CONV_C2C).concat(o)):t="".concat(Ir.CONV_C2C).concat(i):2===n&&(t="".concat(Ir.CONV_GROUP).concat(r)),t}},{key:"_getMyUserID",value:function(){return this._conversationModule.getMyUserID()}},{key:"_insertConversationGroup",value:function(e,t){var n=this._getLocalConversation(e);if(n){var o=n.conversationGroupList;-1===o.indexOf(t)&&o.push(t)}}},{key:"_getLocalConversation",value:function(e){return this._conversationModule.getLocalConversation(e)}},{key:"_hasLocalConversation",value:function(e){return this._conversationModule.hasLocalConversation(e)}},{key:"_emitConversationUpdate",value:function(){this._conversationModule.emitConversationUpdate(!0,!1)}},{key:"_emitConvGroupListUpdate",value:function(){this._conversationModule.emitOuterEvent(Mr.CONVERSATION_GROUP_LIST_UPDATED,y(this._convGroupMap.values()))}},{key:"_emitConvInGroupUpdate",value:function(e){var t={groupName:e,conversationList:[]},n=this._conversationModule.getLocalConversationList();t.conversationList=n.filter((function(t){return t.conversationGroupList.includes(e)})),this._conversationModule.emitOuterEvent(Mr.CONVERSATION_IN_GROUP_UPDATED,t)}},{key:"reset",value:function(){Pl.l("".concat(this._n,".reset")),this._convGroupMap.clear(),this._startIndex=0,this._pagingStatus=Fp.NOT_START}}]),e}(),nC=function(e){u(o,e);var n=m(o);function o(e){var t;return r(this,o),(t=n.call(this,e))._n="ConversationModule",GI.mixin(g(t)),t._messageListHandler=new wI,t._messageRemindHandler=new JI(g(t)),t._convGroupHandler=new tC(g(t)),t.singlyLinkedList=new jI(100),t._pagingStatus=Fp.NOT_START,t._pagingTimeStamp=0,t._pagingStartIndex=0,t._pagingPinnedTimeStamp=0,t._pagingPinnedStartIndex=0,t._pagingConvIDMap=new Map,t._convIDFromUnreadDBMap=new Map,t._conversationMap=new Map,t._tmpGroupList=[],t._tmpGroupAtTipsList=[],t._peerReadTimeMap=new Map,t._completedMap=new Map,t._roamingMessageKeyAndTimeMap=new Map,t._roamingMessageSequenceMap=new Map,t._remoteGroupReadSequenceMap=new Map,t._convTotalUnreadCount=0,t._initListeners(),t}return a(o,[{key:"_initListeners",value:function(){var e=this.getInnerEmitterInstance();e.on(OI,this._initLocalConversationList,this),e.on(PI,this._onProfileUpdated,this)}},{key:"onCheckTimer",value:function(e){e%60==0&&this._messageListHandler.traversal()}},{key:"_initLocalConversationList",value:function(){var e=this,t=new s_("_initLocalConversationList");Pl.l("".concat(this._n,".").concat("_initLocalConversationList"));var n="",o=this._getStorageConversationList(),r=this.isIntl();if(o){for(var i=o.length,a=0;a<i;a++){var s=o[a];if(s){if(s.conversationID==="".concat(Ir.CONV_C2C,"@TLS#ERROR")||s.conversationID==="".concat(Ir.CONV_C2C,"@TLS#NOT_FOUND"))continue;if(s.groupProfile){var u=s.groupProfile.type;if(yd(u))continue}}this._conversationMap.set(o[a].conversationID,new YI(o[a],r))}this.emitConversationUpdate(!0,!1),n="count:".concat(i)}else n="count:0";t.setNetworkType(this.getNetworkType()).setMessage(n).end(),this.getModule(Uf)||this.triggerReady(),this.ready((function(){e._tmpGroupList.length>0&&(e.updateConversationGroupProfile(e._tmpGroupList),e._tmpGroupList.length=0)})),this.syncConversationList()}},{key:"onMessageSent",value:function(e){this._onSendOrReceiveMessage({conversationOptionsList:e.conversationOptionsList,isInstantMessage:!0})}},{key:"onNewMessage",value:function(e){this._onSendOrReceiveMessage(e)}},{key:"_onSendOrReceiveMessage",value:function(e){var t=this,n=e.conversationOptionsList,o=e.isInstantMessage,r=void 0===o||o,i=e.isUnreadC2CMessage,a=void 0!==i&&i,s=e.updateUnreadCount,u=void 0===s||s;this._isReady?0!==n.length&&(this._getC2CPeerReadTime(n),this._updateLocalConversationList({conversationOptionsList:n,isInstantMessage:r,isUnreadC2CMessage:a,isFromGetConversations:!1,updateUnreadCount:u}),r||(this._convIDFromUnreadDBMap=new Map([].concat(y(this._convIDFromUnreadDBMap),y(n.map((function(e){return[e.conversationID,1]}))))),this.deleteEmptyConvFromUndread()),this._setStorageConversationList(),n.filter((function(e){return e.type===Ir.CONV_TOPIC})).length>0||this.emitConversationUpdate()):this.ready((function(){t._onSendOrReceiveMessage(e)}))}},{key:"updateConversationGroupProfile",value:function(e){var t=this;if(!$l(e)||0!==e.length)if(0!==this._conversationMap.size){var n=!1;e.forEach((function(e){var o="GROUP".concat(e.groupID);if(t._conversationMap.has(o)){n=!0;var r=t._conversationMap.get(o);r.groupProfile=JSON.parse(JSON.stringify(e)),r.lastMessage.lastSequence<e.nextMessageSeq&&(r.lastMessage.lastSequence=e.nextMessageSeq-1),r.subType||(r.subType=e.type)}})),n&&this.emitConversationUpdate(!0,!1)}else this._tmpGroupList=e}},{key:"_updateConversationUserProfile",value:function(e){var t=this;e.data.forEach((function(e){var n="C2C".concat(e.userID);t._conversationMap.has(n)&&(t._conversationMap.get(n).userProfile=e)})),this.emitConversationUpdate(!0,!1)}},{key:"onMessageRevoked",value:function(e){var t=this;if(0!==e.length){var n=null,o=!1,r=[];e.forEach((function(e){(n=t._conversationMap.get(e.conversationID))&&(n.type===Ir.CONV_TOPIC?r.push(e):(n.reduceUnreadCount()&&(o=!0),n.isLastMessageRevoked({sequence:e.sequence,time:e.time})&&(n.setLastMessageRevoked(!0),n.setLastMessageRevoker(e.revoker),o=!0)))})),this.getModule(Bf).onMessageRevoked(r),o&&(this.emitConversationUpdate(!0,!1),this.emitTotalUnreadMessageCountUpdate())}}},{key:"isLastMessageRevoked",value:function(e){var t=!1,n=e.conversationID,o=e.sequence,r=e.time,i=this._conversationMap.get(n);return i&&(t=i.type===Ir.CONV_TOPIC?this.getModule(Bf).isLastMessageRevoked({topicID:n.replace(Ir.CONV_GROUP,""),sequence:o}):i.isLastMessageRevoked({sequence:o,time:r})),Pl.l("".concat(this._n,".isLastMessageRevoked options:").concat(JSON.stringify(e)," ret:").concat(t)),t}},{key:"onMessageDeleted",value:function(e){var t=this;if(0!==e.length){var n=null;e.forEach((function(e){(n=t._messageListHandler.getLocalMessage(e.conversationID,e.ID))&&(n.isDeleted=!0),e!==n&&(e.isDeleted=!0)}));for(var o=e[0].conversationID,r=this._messageListHandler.getLocalMessageList(o),i={},a=r.length-1;a>=0;a--)if(!r[a].isDeleted){i=r[a];break}var s=this._conversationMap.get(o);if(s){var u=!1;s.lastMessage.lastSequence===i.sequence&&s.lastMessage.lastTime===i.time||(Hd(i)&&(i=void 0),s.updateLastMessage(i),s.type!==Ir.CONV_TOPIC&&(u=!0),Pl.l("".concat(this._n,".onMessageDeleted. update conversationID:").concat(o," with lastMessage:"),s.lastMessage)),o.startsWith(Ir.CONV_C2C)&&this.updateUnreadCount(o),u&&this.emitConversationUpdate(!0,!1)}}}},{key:"onMessageModified",value:function(e){var t=e.conversationType,n=e.from,o=e.to,r=e.time,i=e.sequence,a=e.elements,s=e.cloudCustomData,u=e.messageVersion,c=this.getMyUserID(),l="".concat(t).concat(o);o===c&&t===Ir.CONV_C2C&&(l="".concat(t).concat(n));var d=this._messageListHandler.onMessageModified(l,e),p=d.isUpdated,f=d.message;!0===p&&this.emitOuterEvent(Mr.MESSAGE_MODIFIED,[f]);var h=this._isTopicConversation(l);if(Pl.l("".concat(this._n,".onMessageModified isUpdated:").concat(p," isTopicMessage:").concat(h," from:").concat(n," to:").concat(o)),h)this.getModule(Bf).onMessageModified(e);else{var g=this._conversationMap.get(l);if(g){var v=g.lastMessage;Pl.d("".concat(this._n.onMessageModified," lastMessage:"),JSON.stringify(v),"options:",JSON.stringify(e)),v&&v.lastTime===r&&v.lastSequence===i&&v.version!==u&&(v.type=a[0].type,v.payload=a[0].content,v.messageForShow=Ud(v.type,v.payload,this.isIntl()),v.cloudCustomData=s,v.version=u,this.emitConversationUpdate(!0,!1))}}return f}},{key:"onNewGroupAtTips",value:function(e){var n=this,o=e.dataList,r=null;o.forEach((function(e){e.groupAtTips?r=e.groupAtTips:e.elements?r=t(t({},e.elements),{},{sync:!0}):e.groupAtType&&(r=t(t({},e),{},{sync:!0})),r.__random=e.random,r.__sequence=e.clientSequence,n._tmpGroupAtTipsList.push(r)})),Pl.d("".concat(this._n,".onNewGroupAtTips isReady:").concat(this._isReady),this._tmpGroupAtTipsList),this._isReady&&this._handleGroupAtTipsList()}},{key:"_handleGroupAtTipsList",value:function(){var e=this;if(0!==this._tmpGroupAtTipsList.length){var t=!1;this._tmpGroupAtTipsList.forEach((function(n){var o=n.groupID,r=n.from,i=n.topicID,a=void 0===i?void 0:i,s=n.sync,u=void 0!==s&&s;if(r!==e.getMyUserID())if(Ql(a)){var c=e._conversationMap.get("".concat(Ir.CONV_GROUP).concat(o));c&&(c.updateGroupAtInfoList(n),t=!0)}else{var l=e._conversationMap.get("".concat(Ir.CONV_GROUP).concat(a));if(l){l.updateGroupAtInfoList(n);var d=e.getModule(Bf),p=l.groupAtInfoList;d.onConversationProxy({topicID:a,groupAtInfoList:p})}Hd(l)&&u&&(e.updateTopicConversation([{conversationID:"".concat(Ir.CONV_GROUP).concat(a),type:Ir.CONV_TOPIC}]),e._conversationMap.get("".concat(Ir.CONV_GROUP).concat(a)).updateGroupAtInfoList(n))}})),t&&this.emitConversationUpdate(!0,!1),this._tmpGroupAtTipsList.length=0}}},{key:"_getC2CPeerReadTime",value:function(e){var t=this,n=[];if(e.forEach((function(e){t._conversationMap.has(e.conversationID)||e.type!==Ir.CONV_C2C||n.push(e.conversationID.replace(Ir.CONV_C2C,""))})),n.length>0){Pl.d("".concat(this._n,"._getC2CPeerReadTime userIDList:").concat(n));var o=this.getModule(Uf);o&&o.getRemotePeerReadTime(n)}}},{key:"_getStorageConversationList",value:function(){return this.getModule(Kf).getItem("conversationMap")}},{key:"_setStorageConversationList",value:function(){var e=this.getLocalConversationList().filter((function(e){return e.type===Ir.CONV_C2C||e.type===Ir.CONV_GROUP&&e.lastMessage.type!==Ir.MSG_GRP_TIP})).slice(0,20).map((function(e){return{conversationID:e.conversationID,type:e.type,subType:e.subType,lastMessage:e.lastMessage,groupProfile:e.groupProfile,userProfile:e.userProfile}}));this.getModule(Kf).setItem("conversationMap",e)}},{key:"emitConversationUpdate",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this.getLocalConversationList();if(t){var o=this.getModule(xf);o&&o.updateGroupLastMessage(n)}e&&this.emitOuterEvent(Mr.CONVERSATION_LIST_UPDATED)}},{key:"getLocalConversationList",value:function(){return y(this._conversationMap.values()).filter((function(e){return e.type!==Ir.CONV_TOPIC}))}},{key:"getLocalConversation",value:function(e){return this._conversationMap.get(e)}},{key:"hasLocalConversation",value:function(e){return this._conversationMap.has(e)}},{key:"getLocalOldestMessage",value:function(e){return this._messageListHandler.getLocalOldestMessage(e)}},{key:"syncConversationList",value:function(){var e=this,t=new s_("syncConversationList");return this._pagingStatus===Fp.NOT_START&&this._conversationMap.clear(),this._pagingGetConversationList().then((function(n){return e._pagingStatus=Fp.RESOLVED,e.deleteEmptyConvFromUndread(),e.emitConversationUpdate(!0,!1),e._setStorageConversationList(),e._handleC2CPeerReadTime(),e._patchConversationProperties(),t.setMessage(e._conversationMap.size).setNetworkType(e.getNetworkType()).end(),n})).catch((function(n){return e._pagingStatus=Fp.REJECTED,t.setMessage(e._pagingTimeStamp),e.probeNetwork().then((function(e){var o=_(e,2),r=o[0],i=o[1];t.setError(n,r,i).end()})),vI(n)}))}},{key:"deleteEmptyConvFromUndread",value:function(){var e=this;this._isSyncCompleted()&&this._conversationMap.forEach((function(t,n){!e._pagingConvIDMap.has(n)&&e._convIDFromUnreadDBMap.has(n)&&e._conversationMap.delete(n)}))}},{key:"_patchConversationProperties",value:function(){var e=this,t=Date.now(),n=this.checkAndPatchRemark(),o=this._messageRemindHandler.getC2CMessageRemindType(),r=this.getModule(xf).getGroupList();Promise.all([n,o,r]).then((function(){var n=Date.now()-t;Pl.l("".concat(e._n,"._patchConversationProperties ok. cost ").concat(n," ms")),e.emitConversationUpdate(!0,!1),e.emitTotalUnreadMessageCountUpdate()}))}},{key:"_pagingGetConversationList",value:function(){var e=this,t="".concat(this._n,"._pagingGetConversationList");return Pl.l("".concat(t," timeStamp:").concat(this._pagingTimeStamp," startIndex:").concat(this._pagingStartIndex)+" pinnedTimeStamp:".concat(this._pagingPinnedTimeStamp," pinnedStartIndex:").concat(this._pagingPinnedStartIndex)),this._pagingStatus=Fp.PENDING,this.request({protocolName:Nh,requestData:{fromAccount:this.getMyUserID(),timeStamp:this._pagingTimeStamp,startIndex:this._pagingStartIndex,pinnedTimeStamp:this._pagingPinnedTimeStamp,pinnedStartIndex:this._pagingPinnedStartIndex,orderType:1}}).then((function(n){var o=n.data,r=o.completeFlag,i=o.conversations,a=void 0===i?[]:i,s=o.timeStamp,u=o.startIndex,c=o.pinnedTimeStamp,l=o.pinnedStartIndex,d=o.groupItem;if(Pl.l("".concat(t," ok. completeFlag:").concat(r," count:").concat(a.length," isReady:").concat(e._isReady)),e._convGroupHandler.onConvGroupListSynced(d),a.length>0){var p=e._getConversationOptions(a);e._pagingConvIDMap=new Map([].concat(y(e._pagingConvIDMap),y(p.map((function(e){return[e.conversationID,1]}))))),e._updateLocalConversationList({conversationOptionsList:p,isFromGetConversations:!0}),e.isLoggedIn()&&e.emitConversationUpdate()}if(!e._isReady){if(!e.isLoggedIn())return gI();e.triggerReady()}return e._pagingTimeStamp=s,e._pagingStartIndex=u,e._pagingPinnedTimeStamp=c,e._pagingPinnedStartIndex=l,1!==r?e._pagingGetConversationList():(e._handleGroupAtTipsList(),e._convGroupHandler.getRemoteConvGroupList(),gI())})).catch((function(n){throw e.isLoggedIn()&&(e._isReady||(Pl.w("".concat(t," failed. error:"),n),e.triggerReady())),n}))}},{key:"_updateLocalConversationList",value:function(e){var t,n=e.isFromGetConversations,o=e.isInstantMessage,r=Date.now();t=this._getTmpConversationListMapping(e),this._conversationMap=new Map(this._sortConversationList([].concat(y(t.toBeUpdatedConversationList),y(this._conversationMap)))),n||(this._updateUserOrGroupProfile(t.newConversationList),o&&this.emitTotalUnreadMessageCountUpdate()),Pl.d("".concat(this._n,"._updateLocalConversationList cost ").concat(Date.now()-r," ms"))}},{key:"_getTmpConversationListMapping",value:function(e){for(var t=e.conversationOptionsList,n=e.isFromGetConversations,o=e.isInstantMessage,r=e.isUnreadC2CMessage,i=void 0!==r&&r,a=e.updateUnreadCount,s=[],u=[],c=this.getModule(xf),l=this.getModule(Ff),d=this.isIntl(),p=0,f=t.length;p<f;p++){var h=new YI(t[p],d),g=h.conversationID;if(g!=="".concat(Ir.CONV_C2C,"@TLS#ERROR")&&g!=="".concat(Ir.CONV_C2C,"@TLS#NOT_FOUND"))if(this._conversationMap.has(g)){var v=this._conversationMap.get(g),m=["unreadCount","allowType","adminForbidType","payload","isPinned"];!1===o&&m.push("lastMessage");var _=t[p].lastMessage,y=!Ql(_);y||t[p].type===Ir.CONV_TOPIC||this._onLastMessageNotExist(t[p]),Ql(o)&&y&&null===v.lastMessage.payload&&(v.lastMessage.payload=_.payload),Hd(v.lastMessage.revoker)||(v.lastMessage.revoker=null),sd(v,h,m,[null,void 0,"",0,NaN]),!0===a&&v.updateUnreadCount({nextUnreadCount:h.unreadCount,isFromGetConversations:n,isUnreadC2CMessage:i}),o&&y&&(_.payload&&(v.lastMessage.payload=_.payload),v.type===Ir.CONV_GROUP&&(v.lastMessage.nameCard=_.nameCard,v.lastMessage.nick=_.nick)),y&&v.lastMessage.cloudCustomData!==_.cloudCustomData&&(v.lastMessage.cloudCustomData=_.cloudCustomData||""),this._conversationMap.delete(g),s.push([g,v])}else{if(h.type===Ir.CONV_GROUP&&c){var M=h.groupProfile.groupID,I=c.getLocalGroupProfile(M);I&&(h.groupProfile=I,!0===a&&h.updateUnreadCount({nextUnreadCount:0}))}else if(h.type===Ir.CONV_C2C){var C=g.replace(Ir.CONV_C2C,"");l&&l.isMyFriend(C)&&(h.remark=l.getFriendRemark(C))}u.push(h),s.push([g,h])}}var k=this.getModule(Bf);return s.forEach((function(e){if(e[1].type===Ir.CONV_TOPIC){var t=e[1],n=t.conversationID,o=t.unreadCount,r=t.groupAtInfoList;k.onConversationProxy({topicID:n.replace(Ir.CONV_GROUP,""),unreadCount:o,groupAtInfoList:Hd(r)?void 0:r})}})),{toBeUpdatedConversationList:s,newConversationList:u}}},{key:"_onLastMessageNotExist",value:function(e){new s_("lastMessageNotExist").setMessage("".concat(JSON.stringify(e))).setNetworkType(this.getNetworkType()).end()}},{key:"_sortConversationList",value:function(e){var t=[],n=[],o=[],r=[];return e.forEach((function(e){!0===e[1].isPinned?Hd(e[1].lastMessage.lastTime)?n.push(e):t.push(e):Hd(e[1].lastMessage.lastTime)?r.push(e):o.push(e)})),t.sort((function(e,t){return t[1].lastMessage.lastTime-e[1].lastMessage.lastTime})).concat(n).concat(o.sort((function(e,t){return t[1].lastMessage.lastTime-e[1].lastMessage.lastTime}))).concat(r)}},{key:"_sortConversationListAndEmitEvent",value:function(){this._conversationMap=new Map(this._sortConversationList(y(this._conversationMap))),this.emitConversationUpdate(!0,!1)}},{key:"_updateUserOrGroupProfile",value:function(e){var t=this;if(0!==e.length){var n=[],o=[],r=this.getModule(Gf),i=this.getModule(xf);e.forEach((function(e){if(e.type===Ir.CONV_C2C)n.push(e.toAccount);else if(e.type===Ir.CONV_GROUP){var t=e.toAccount;i.hasLocalGroup(t)?e.groupProfile=i.getLocalGroupProfile(t):o.push(t)}})),Pl.l("".concat(this._n,"._updateUserOrGroupProfile c2cUserIDList:").concat(n," groupIDList:").concat(o)),n.length>0&&r.getUserProfile({userIDList:n}).then((function(e){var n=e.data;$l(n)?n.forEach((function(e){t._conversationMap.get("C2C".concat(e.userID)).userProfile=e})):t._conversationMap.get("C2C".concat(n.userID)).userProfile=n})),o.length>0&&i.getGroupProfileAdvance({groupIDList:o,responseFilter:{groupBaseInfoFilter:["Type","Name","FaceUrl"]}}).then((function(e){e.data.successGroupList.forEach((function(e){var n="GROUP".concat(e.groupID);if(t._conversationMap.has(n)){var o=t._conversationMap.get(n);sd(o.groupProfile,e,[],[null,void 0,"",0,NaN]),!o.subType&&e.type&&(o.subType=e.type)}}))}))}}},{key:"_getConversationOptions",value:function(e){var n=this,o=[],r=e.filter((function(e){var t=e.type,n=e.userID;return 1===t&&"@TLS#NOT_FOUND"!==n&&"@TLS#ERROR"!==n||2===t})),i=this.getMyUserID(),a=r.map((function(e){if(Ql(e.lastMsg)&&(e.lastMsg={elements:[]}),1===e.type){var r={userID:e.userID,nick:e.peerNick,avatar:e.peerAvatar};return o.push(r),{conversationID:"C2C".concat(e.userID),type:"C2C",lastMessage:{lastTime:e.time,lastSequence:e.sequence,fromAccount:e.lastC2CMsgFromAccount,messageForShow:e.messageShow,type:e.lastMsg.elements[0]?e.lastMsg.elements[0].type:null,payload:e.lastMsg.elements[0]?n._amendLayersOverLimitProperty(e.lastMsg.elements[0].content):null,cloudCustomData:e.lastMsg.cloudCustomData||"",isRevoked:8===e.lastMessageFlag,onlineOnlyFlag:!1,nick:"",nameCard:"",version:0,isPeerRead:e.lastC2CMsgFromAccount===i&&e.time<=e.c2cPeerReadTime,revoker:e.lastMsg.revokerInfo?e.lastMsg.revokerInfo.revoker:null},userProfile:new HI(r),peerReadTime:e.c2cPeerReadTime,isPinned:1===e.isPinned,messageRemindType:"",customData:e.customMark||"",markList:Fd(e.standardMark),conversationGroupList:n._convGroupHandler.getConvGroupListByID(e.contactGroupId)}}return{conversationID:"GROUP".concat(e.groupID),type:"GROUP",lastMessage:t(t({lastTime:e.time,lastSequence:e.messageReadSeq+e.unreadCount,fromAccount:e.msgGroupFromAccount,messageForShow:e.messageShow},n._patchTypeAndPayload(e)),{},{cloudCustomData:e.lastMsg.cloudCustomData||"",isRevoked:2===e.lastMessageFlag,onlineOnlyFlag:!1,nick:e.senderNick||"",nameCard:e.senderNameCard||"",revoker:e.lastMsg.revokerInfo?e.lastMsg.revokerInfo.revoker:null}),groupProfile:new ZI({groupID:e.groupID,name:e.groupNick,avatar:e.groupImage}),unreadCount:e.unreadCount,peerReadTime:0,isPinned:1===e.isPinned,messageRemindType:"",version:0,customData:e.customMark||"",markList:Fd(e.standardMark),conversationGroupList:n._convGroupHandler.getConvGroupListByID(e.contactGroupId)}}));return o.length>0&&this.getModule(Gf).onConversationsProfileUpdated(o),a}},{key:"_patchTypeAndPayload",value:function(e){var n=e.lastMsg,o=n.event,r=void 0===o?void 0:o,i=n.elements,a=void 0===i?[]:i,s=n.groupTips,u=void 0===s?{}:s;if(!Ql(r)&&!Hd(u)){var c=new lI(u);c.setElement({type:Ir.MSG_GRP_TIP,content:t(t({},u.elements),{},{groupProfile:u.groupProfile})});var l=JSON.parse(JSON.stringify(c.payload));return c=null,{type:Ir.MSG_GRP_TIP,payload:l}}return{type:a[0]?a[0].type:null,payload:a[0]?this._amendLayersOverLimitProperty(a[0].content):null}}},{key:"_amendLayersOverLimitProperty",value:function(e){var t=e.layersOverLimit;return 0===t?e.layersOverLimit=!1:1===t&&(e.layersOverLimit=!0),e}},{key:"getLocalMessageList",value:function(e){return this._messageListHandler.getLocalMessageList(e)}},{key:"deleteLocalMessage",value:function(e){e instanceof lI&&this._messageListHandler.remove(e)}},{key:"onConversationDeleted",value:function(e){var t=this;Pl.l("".concat(this._n,".onConversationDeleted")),$l(e)&&e.forEach((function(e){var n=e.type,o=e.userID,r=e.groupID,i="";1===n?i="".concat(Ir.CONV_C2C).concat(o):2===n&&(i="".concat(Ir.CONV_GROUP).concat(r)),t.deleteLocalConversation(i)}))}},{key:"onConversationPinned",value:function(e){var t=this;if($l(e)){var n=!1;e.forEach((function(e){var o,r=e.type,i=e.userID,a=e.groupID;1===r?o=t.getLocalConversation("".concat(Ir.CONV_C2C).concat(i)):2===r&&(o=t.getLocalConversation("".concat(Ir.CONV_GROUP).concat(a))),o&&(Pl.l("".concat(t._n,".onConversationPinned conversationID:").concat(o.conversationID," isPinned:").concat(o.isPinned)),o.isPinned||(o.isPinned=!0,n=!0))})),n&&this._sortConversationListAndEmitEvent()}}},{key:"onConversationUnpinned",value:function(e){var t=this;if($l(e)){var n=!1;e.forEach((function(e){var o,r=e.type,i=e.userID,a=e.groupID;1===r?o=t.getLocalConversation("".concat(Ir.CONV_C2C).concat(i)):2===r&&(o=t.getLocalConversation("".concat(Ir.CONV_GROUP).concat(a))),o&&(Pl.l("".concat(t._n,".onConversationUnpinned conversationID:").concat(o.conversationID," isPinned:").concat(o.isPinned)),o.isPinned&&(o.isPinned=!1,n=!0))})),n&&this._sortConversationListAndEmitEvent()}}},{key:"getMessageList",value:function(e){var t=this,n=e.conversationID,o=e.nextReqMessageID,r=e.count,i="".concat(this._n,".getMessageList"),a=this.getLocalConversation(n),s="";if(a&&a.groupProfile&&(s=a.groupProfile.type),yd(s))return Pl.l("".concat(i," not available in avchatroom. conversationID:").concat(n)),gI({messageList:[],nextReqMessageID:"",isCompleted:!0});(Ql(r)||r>15)&&(r=15),!o&&this._isNotInCommunity(n)&&(this._messageListHandler.removeByConversationID(n),this._completedMap.delete(n),this._roamingMessageSequenceMap.delete(n));var u=this._computeRemainingCount({conversationID:n,nextReqMessageID:o}),c=this._completedMap.has(n);if(Pl.l("".concat(i," conversationID:").concat(n," nextReqMessageID:").concat(o)+" remainingCount:".concat(u," count:").concat(r," isCompleted:").concat(c)),this._needGetHistory({conversationID:n,remainingCount:u,count:r}))return this.getHistoryMessages({conversationID:n,nextReqMessageID:o,count:20}).then((function(e){var o=e.nextReqID,r=e.storedMessageList,a=t._completedMap.has(n),s=r;u>0&&(s=t._messageListHandler.getLocalMessageList(n).slice(0,r.length+u));var c={nextReqMessageID:a?"":o,messageList:s,isCompleted:a};return Pl.l("".concat(i," ret.nextReqMessageID:").concat(c.nextReqMessageID," ret.isCompleted:").concat(c.isCompleted," ret.length:").concat(s.length)),dI(c)}));this.modifyMessageList(n);var l=this._getMessageListFromMemory({conversationID:n,nextReqMessageID:o,count:r});return gI(l)}},{key:"_getMessageListFromMemory",value:function(e){var t=e.conversationID,n=e.nextReqMessageID,o=e.count,r="".concat(this._n,"._getMessageListFromMemory"),i=this._messageListHandler.getLocalMessageList(t),a=i.length,s=0,u={isCompleted:!1,nextReqMessageID:"",messageList:[]};return n?(s=i.findIndex((function(e){return e.ID===n})))>o?(u.messageList=i.slice(s-o,s),u.nextReqMessageID=i[s-o].ID):(u.messageList=i.slice(0,s),u.isCompleted=!0):a>o?(s=a-o,u.messageList=i.slice(s,a),u.nextReqMessageID=i[s].ID):(u.messageList=i.slice(0,a),u.isCompleted=!0),Pl.l("".concat(r," conversationID:").concat(t)+" ret.nextReqMessageID:".concat(u.nextReqMessageID," ret.isCompleted:").concat(u.isCompleted," ret.length:").concat(u.messageList.length)),u}},{key:"getMessageListHopping",value:function(e){var t=e.conversationID,n=e.sequence,o=e.time,r=e.count,i=e.direction,a=void 0===i?0:i;if((Ql(r)||r>15)&&(r=15),t.startsWith(Ir.CONV_C2C)){var s=this.getModule(Uf),u=t.replace(Ir.CONV_C2C,"");return s.getRoamingMessagesHopping({peerAccount:u,time:o,count:r,direction:a})}if(t.startsWith(Ir.CONV_GROUP)){var c=this.getModule(xf),l=t.replace(Ir.CONV_GROUP,"");return c.getRoamingMessagesHopping({groupID:l,sequence:n,count:r,direction:a})}}},{key:"_computeRemainingCount",value:function(e){var t=e.conversationID,n=e.nextReqMessageID,o=this._messageListHandler.getLocalMessageList(t),r=o.length;if(!n)return r;var i=0;return Cd(t)?i=o.findIndex((function(e){return e.ID===n})):kd(t)&&(i=-1!==n.indexOf("-")?o.findIndex((function(e){return e.ID===n})):o.findIndex((function(e){return e.sequence===n}))),-1===i&&(i=0),i}},{key:"_getMessageListSize",value:function(e){return this._messageListHandler.getLocalMessageList(e).length}},{key:"_needGetHistory",value:function(e){var t=e.conversationID,n=e.remainingCount,o=e.count,r=this.getLocalConversation(t),i="";return r&&r.groupProfile&&(i=r.groupProfile.type),!Td(t)&&!yd(i)&&!(kd(t)&&this._isPagingGetGroupListCompleted()&&this._getLocalGroupCount()<=4e3&&!this._hasLocalGroup(t)&&!this._isTopicConversation(t))&&n<=o&&!this._completedMap.has(t)}},{key:"_isTopicConversation",value:function(e){var t=e.replace(Ir.CONV_GROUP,"");return Id(t)}},{key:"getHistoryMessages",value:function(e){var t=e.conversationID,n=e.count;if(t===Ir.CONV_SYSTEM)return gI();var o=15;n>20&&(o=20);var r=null;if(Cd(t)){var i=this._roamingMessageKeyAndTimeMap.has(t);return(r=this.getModule(Uf))?r.getRoamingMessage({conversationID:t,peerAccount:t.replace(Ir.CONV_C2C,""),count:o,lastMessageTime:i?this._roamingMessageKeyAndTimeMap.get(t).lastMessageTime:0,messageKey:i?this._roamingMessageKeyAndTimeMap.get(t).messageKey:""}):vI({code:Rm})}if(kd(t)){if(!(r=this.getModule(xf)))return vI({code:Rm});var a=null;this._conversationMap.has(t)&&(a=this._conversationMap.get(t).lastMessage);var s=0;a&&(s=a.lastSequence);var u=this._roamingMessageSequenceMap.get(t);return r.getRoamingMessage({conversationID:t,groupID:t.replace(Ir.CONV_GROUP,""),count:o,sequence:u||s})}return gI()}},{key:"patchConversationLastMessage",value:function(e){var t=this.getLocalConversation(e);if(t){var n=t.lastMessage,o=n.messageForShow,r=n.payload;if(Hd(o)||Hd(r)){var i=this._messageListHandler.getLocalMessageList(e);if(0===i.length)return;var a=i[i.length-1];Pl.l("".concat(this._n,".patchConversationLastMessage conversationID:").concat(e," payload:"),a.payload),t.updateLastMessage(a)}}}},{key:"onRoamingMessage",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1?arguments[1]:void 0,o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=n.startsWith(Ir.CONV_C2C)?Ir.CONV_C2C:Ir.CONV_GROUP,i=null,a=[],s=[],u=0,c=e.length,l=null,d=r===Ir.CONV_GROUP,p=this.getModule(Zf),f=function(){u=d?e.length-1:0,c=d?0:e.length},h=function(){d?--u:++u},g=function(){return d?u>=c:u<c};for(f();g();h())if(d&&1===e[u].sequence&&o&&this.setCompleted(n),1!==e[u].isPlaceMessage)if((i=new lI(e[u])).to=e[u].to,r!==Ir.CONV_GROUP||Ql(e[u].topicID)||(i.to=e[u].topicID),i.isSystemMessage=!!e[u].isSystemMessage,i.conversationType=r,4===e[u].event?l={type:Ir.MSG_GRP_TIP,content:t(t({},e[u].elements),{},{groupProfile:e[u].groupProfile})}:(e[u].elements=p.parseElements(e[u].elements,e[u].from),l=e[u].elements),d||i.setNickAndAvatar({nick:e[u].nick,avatar:e[u].avatar}),Hd(l)){var v=new s_("emptyMessageBody");v.setMessage("from:".concat(i.from," to:").concat(i.to," sequence:").concat(i.sequence," event:").concat(e[u].event)),v.setNetworkType(this.getNetworkType()).setLevel("warning").end()}else i.setElement(l),i.reInitialize(this.getMyUserID()),a.push(i);return f=h=g=null,o?(this._messageListHandler.unshift(a,s),a=null,s):(s=null,a)}},{key:"findMessage",value:function(e){return this._messageListHandler.findMessage(e)}},{key:"_isNotInCommunity",value:function(e){var t=!1;if(e.startsWith(Ir.CONV_GROUP)&&this._isTopicConversation(e)){var n=Gd(e.replace(Ir.CONV_GROUP,""));this.getModule(xf).hasLocalGroup(n)||(t=!0)}return t}},{key:"deleteTopicRoamingMessageInfo",value:function(e){var t=this;Md({groupID:e})&&this._messageListHandler.getTopicConversationIDList(e).forEach((function(e){t._messageListHandler.removeByConversationID(e),t._completedMap.delete(e),t._roamingMessageSequenceMap.delete(e)}))}},{key:"deleteGroupRomaingMessageInfo",value:function(e){var t="".concat(Ir.CONV_GROUP).concat(e);this._messageListHandler.removeByConversationID(t),this._completedMap.delete(t),this._roamingMessageSequenceMap.delete(t)}},{key:"setMessageRead",value:function(e){var t=e.conversationID,n=this.getLocalConversation(t);if(Pl.l("".concat(this._n,".setMessageRead conversationID:").concat(t," unreadCount:").concat(n?n.unreadCount:0)),!n)return gI();if(n.type!==Ir.CONV_GROUP&&n.type!==Ir.CONV_TOPIC||Hd(n.groupAtInfoList)||this.deleteGroupAtTips(t),0===n.unreadCount)return gI();if(n.type===Ir.CONV_GROUP&&!this._hasLocalGroup(t))return 0!==n.unreadCount&&(n.unreadCount=0,this.emitConversationUpdate(!0,!1)),gI();var o=this._messageListHandler.getLocalLastMessage(t),r=n.lastMessage.lastTime;o&&r<o.time&&(r=o.time);var i=n.lastMessage.lastSequence;if(o&&i<o.sequence&&(i=o.sequence),n.type===Ir.CONV_TOPIC&&Ql(o)){var a=this.getModule(Bf),s=t.replace(Ir.CONV_GROUP,""),u=Gd(s),c=a.getLocalTopic(u,s);c&&(i=c.nextMessageSeq-1)}var l=null;switch(n.type){case Ir.CONV_C2C:return(l=this.getModule(Uf))?l.setMessageRead({conversationID:t,lastMessageTime:r}):vI({code:Rm});case Ir.CONV_GROUP:case Ir.CONV_TOPIC:return(l=this.getModule(xf))?l.setMessageRead({conversationID:t,lastMessageSeq:i}):vI({code:Rm});case Ir.CONV_SYSTEM:return n.unreadCount=0,this.emitConversationUpdate(!0,!1),gI();default:return gI()}}},{key:"setAllMessageRead",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n="setAllMessageRead",o="".concat(this._n,".").concat(n);t.scope||(t.scope=Ir.READ_ALL_MSG),Pl.l("".concat(o," options:"),t);var r=this._createSetAllMessageReadPack(t);if(0===r.readAllC2CMessage&&0===r.groupMessageReadInfoList.length)return gI();var i=new s_(n);return this.request({protocolName:ug,requestData:r}).then((function(n){var o=n.data,r=e._handleAllMessageRead(o);return i.setMessage("scope:".concat(t.scope," failureGroups:").concat(JSON.stringify(r))).setNetworkType(e.getNetworkType()).end(),gI()})).catch((function(t){return e.probeNetwork().then((function(e){var n=_(e,2),o=n[0],r=n[1];i.setError(t,o,r).end()})),Pl.w("".concat(o," failed. error:"),t),vI({code:t&&t.code?t.code:Rv,message:t&&t.message?t.message:void 0})}))}},{key:"setConversationCustomData",value:function(e){return this._convGroupHandler.setConvCustomData(e)}},{key:"markConversation",value:function(e){return this._convGroupHandler.markConversation(e)}},{key:"getConversationGroupList",value:function(){return this._convGroupHandler.getLocalConvGroupList()}},{key:"createConversationGroup",value:function(e){return this._convGroupHandler.createConvGroup(e)}},{key:"deleteConversationGroup",value:function(e){return this._convGroupHandler.deleteConvGroup(e)}},{key:"renameConversationGroup",value:function(e){return this._convGroupHandler.renameConvGroup(e)}},{key:"addConversationsToGroup",value:function(e){return this._convGroupHandler.addConvsToGroup(e)}},{key:"deleteConversationsFromGroup",value:function(e){return this._convGroupHandler.deleteConvsFromGroup(e)}},{key:"onConversationMarkUpdated",value:function(e){this._convGroupHandler.onConvMarkUpdated(e)}},{key:"onConversationGroupCreated",value:function(e){this._convGroupHandler.onConvGroupCreated(e)}},{key:"onConversationGroupDeleted",value:function(e){this._convGroupHandler.onConvGroupDeleted(e)}},{key:"onConversationGroupNameUpdated",value:function(e){this._convGroupHandler.onConvGroupNameUpdated(e)}},{key:"onConversationInGroupUpdated",value:function(e){this._convGroupHandler.onConvInGroupUpdated(e)}},{key:"onConversationAddedToOrDeletedFromGroup",value:function(e){this._convGroupHandler.onConvAddedToOrDeletedFromGroup(e)}},{key:"_getConversationLastMessageSequence",value:function(e){var t=this._messageListHandler.getLocalLastMessage(e.conversationID),n=e.lastMessage.lastSequence;return t&&n<t.sequence&&(n=t.sequence),n}},{key:"_getConversationLastMessageTime",value:function(e){var t=this._messageListHandler.getLocalLastMessage(e.conversationID),n=e.lastMessage.lastTime;return t&&n<t.time&&(n=t.time),n}},{key:"_createSetAllMessageReadPack",value:function(e){var t,n={readAllC2CMessage:0,groupMessageReadInfoList:[]},o=e.scope,r=S(this._conversationMap);try{for(r.s();!(t=r.n()).done;){var i=_(t.value,2)[1];if(i.unreadCount>0)if(i.type===Ir.CONV_C2C&&0===n.readAllC2CMessage){if(o===Ir.READ_ALL_MSG)n.readAllC2CMessage=1;else if(o===Ir.READ_ALL_C2C_MSG){n.readAllC2CMessage=1;break}}else if(i.type===Ir.CONV_GROUP&&(o===Ir.READ_ALL_GROUP_MSG||o===Ir.READ_ALL_MSG)){var a=this._getConversationLastMessageSequence(i);n.groupMessageReadInfoList.push({groupID:i.groupProfile.groupID,messageSequence:a})}}}catch(u){r.e(u)}finally{r.f()}return n}},{key:"onPushedAllMessageRead",value:function(e){this._handleAllMessageRead(e)}},{key:"_handleAllMessageRead",value:function(e){var t=e.groupMessageReadInfoList,n=e.readAllC2CMessage,o=this._parseGroupReadInfo(t);return this._updateAllConversationUnreadCount({readAllC2CMessage:n})>=1&&(this.emitConversationUpdate(!0,!1),this.emitTotalUnreadMessageCountUpdate()),o}},{key:"_parseGroupReadInfo",value:function(e){var t=[];if(e&&e.length)for(var n=0,o=e.length;n<o;n++){var r=e[n],i=r.groupID,a=r.sequence,s=r.retCode,u=r.lastMessageSeq;Ql(s)?this._remoteGroupReadSequenceMap.set(i,u):(this._remoteGroupReadSequenceMap.set(i,a),0!==s&&t.push("".concat(i,"-").concat(a,"-").concat(s)))}return t}},{key:"_updateAllConversationUnreadCount",value:function(e){var t,n=e.readAllC2CMessage,o=0,r=S(this._conversationMap);try{for(r.s();!(t=r.n()).done;){var i=_(t.value,2),a=i[0],s=i[1];if(s.unreadCount>=1){if(1===n&&s.type===Ir.CONV_C2C){var u=this._getConversationLastMessageTime(s);this.updateIsReadAfterReadReport({conversationID:a,lastMessageTime:u})}else if(s.type===Ir.CONV_GROUP){var c=a.replace(Ir.CONV_GROUP,"");if(this._remoteGroupReadSequenceMap.has(c)){var l=this._remoteGroupReadSequenceMap.get(c),d=this._getConversationLastMessageSequence(s);this.updateIsReadAfterReadReport({conversationID:a,remoteReadSequence:l}),d>=l&&this._remoteGroupReadSequenceMap.delete(c)}}this.updateUnreadCount(a,!1)&&(o+=1)}}}catch(f){r.e(f)}finally{r.f()}return o}},{key:"isRemoteRead",value:function(e){var t=e.conversationID,n=e.sequence,o=t.replace(Ir.CONV_GROUP,""),r=!1;if(this._remoteGroupReadSequenceMap.has(o)){var i=this._remoteGroupReadSequenceMap.get(o);n<=i&&(r=!0,Pl.l("".concat(this._n,".isRemoteRead conversationID:").concat(t," messageSequence:").concat(n," remoteReadSequence:").concat(i))),n>=i+10&&this._remoteGroupReadSequenceMap.delete(o)}return r}},{key:"updateIsReadAfterReadReport",value:function(e){var t=e.conversationID,n=e.lastMessageSeq,o=e.lastMessageTime,r=this._messageListHandler.getLocalMessageList(t);if(0!==r.length)for(var i,a=r.length-1;a>=0;a--)if(i=r[a],!(o&&i.time>o||n&&i.sequence>n)){if("in"===i.flow&&i.isRead)break;i.setIsRead(!0)}}},{key:"updateUnreadCount",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=!1,o=this.getLocalConversation(e),r=this._messageListHandler.getLocalMessageList(e);if(o){var i=o.unreadCount,a=r.filter((function(e){return!e.isRead&&!e._onlineOnlyFlag&&!e.isDeleted})).length;if(i!==a&&(o.unreadCount=a,n=!0,Pl.l("".concat(this._n,".updateUnreadCount from ").concat(i," to ").concat(a,", conversationID:").concat(e)),!0===t&&(this.emitConversationUpdate(!0,!1),this.emitTotalUnreadMessageCountUpdate())),n&&o.type===Ir.CONV_TOPIC){var s=o.unreadCount,u=this.getModule(Bf),c=e.replace(Ir.CONV_GROUP,"");u.onConversationProxy({topicID:c,unreadCount:s})}return n}}},{key:"clearGroupAtInfoList",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this.getLocalConversation(e);if(n&&n.groupAtInfoList.length>0){if(n.clearGroupAtInfoList(),Pl.l("".concat(this._n,".clearGroupAtInfoList conversationID:").concat(e)),n.type===Ir.CONV_TOPIC){var o=n.groupAtInfoList,r=this.getModule(Bf),i=e.replace(Ir.CONV_GROUP,"");r.onConversationProxy({topicID:i,groupAtInfoList:o})}!0===t&&this.emitConversationUpdate(!0,!1)}}},{key:"updateReadReceiptInfo",value:function(e){var t=this,n=e.userID,o=void 0===n?void 0:n,r=e.groupID,i=void 0===r?void 0:r,a=e.readReceiptList;if(!Hd(a)){var s=[];if(Ql(o)){if(!Ql(i)){var u="".concat(Ir.CONV_GROUP).concat(i);a.forEach((function(e){var n=e.tinyID,o=e.clientTime,r=e.random,a=e.readCount,c=e.unreadCount,l="".concat(n,"-").concat(o,"-").concat(r),d=t._messageListHandler.getLocalMessage(u,l),p={groupID:i,messageID:l,readCount:0,unreadCount:0};d&&(Wl(a)&&(d.readReceiptInfo.readCount=a,p.readCount=a),Wl(c)&&(d.readReceiptInfo.unreadCount=c,p.unreadCount=c),s.push(p))}))}}else{var c="".concat(Ir.CONV_C2C).concat(o);a.forEach((function(e){var n=e.tinyID,r=e.clientTime,i=e.random,a="".concat(n,"-").concat(r,"-").concat(i),u=t._messageListHandler.getLocalMessage(c,a);if(u){u.readReceiptInfo.isPeerRead=!0;var l={userID:o,messageID:a,isPeerRead:!0};s.push(l)}}))}s.length>0&&this.emitOuterEvent(Mr.MESSAGE_READ_RECEIPT_RECEIVED,s)}}},{key:"recomputeGroupUnreadCount",value:function(e){var t=e.conversationID,n=e.count,o=this.getLocalConversation(t);if(o){var r=o.unreadCount,i=r-n;i<0&&(i=0),o.unreadCount=i,Pl.l("".concat(this._n,".recomputeGroupUnreadCount from ").concat(r," to ").concat(i,", conversationID:").concat(t))}}},{key:"updateIsRead",value:function(e){var t=this.getLocalConversation(e),n=this.getLocalMessageList(e);if(t&&0!==n.length&&!Td(t.type)){for(var o=[],r=0,i=n.length;r<i;r++)"in"!==n[r].flow?"out"!==n[r].flow||n[r].isRead||n[r].setIsRead(!0):o.push(n[r]);var a=0;if(t.type===Ir.CONV_C2C){var s=o.slice(-t.unreadCount).filter((function(e){return e.isRevoked})).length;a=o.length-t.unreadCount-s}else a=o.length-t.unreadCount;for(var u=0;u<a&&!o[u].isRead;u++)o[u].setIsRead(!0)}}},{key:"deleteGroupAtTips",value:function(e){var t=this,n="".concat(this._n,".deleteGroupAtTips");Pl.l("".concat(n));var o=this._conversationMap.get(e);if(!o)return Promise.resolve();var r=o.groupAtInfoList;if(0===r.length)return Promise.resolve();var i=void 0;e.startsWith(Ir.CONV_GROUP)&&(i=e.replace(Ir.CONV_GROUP,""));var a=y(r);if((Md({groupID:i})||Id(i))&&0===(a=r.filter((function(e){return!e.atTypeArray.includes(Ir.CONV_AT_ALL)}))).length)return this.clearGroupAtInfoList(e,!1),Promise.resolve();var s=this.getMyUserID();return this.request({protocolName:Fh,requestData:{messageListToDelete:a.map((function(e){return{from:e.from,to:s,messageSeq:e.__sequence,messageRandom:e.__random,groupID:Ql(e.topicID)?e.groupID:e.topicID}}))}}).then((function(){return Pl.l("".concat(n," ok. count:").concat(r.length)),t.clearGroupAtInfoList(e,!1),Promise.resolve()})).catch((function(e){return Pl.e("".concat(n," failed. error:"),e),vI(e)}))}},{key:"appendToMessageList",value:function(e){this._messageListHandler.pushIn(e)}},{key:"setMessageRandom",value:function(e){this.singlyLinkedList.set(e.random)}},{key:"deleteMessageRandom",value:function(e){this.singlyLinkedList.delete(e.random)}},{key:"pushIntoMessageList",value:function(e,t,n){return!(!this._messageListHandler.pushIn(t,n)||this._isMessageFromCurrentInstance(t)&&!n)&&(e.push(t),!0)}},{key:"_isMessageFromCurrentInstance",value:function(e){return this.singlyLinkedList.has(e.random)}},{key:"revoke",value:function(e,t,n){return this._messageListHandler.revoke(e,t,n)}},{key:"getPeerReadTime",value:function(e){return this._peerReadTimeMap.get(e)}},{key:"recordPeerReadTime",value:function(e,t){this._peerReadTimeMap.has(e)?this._peerReadTimeMap.get(e)<t&&this._peerReadTimeMap.set(e,t):this._peerReadTimeMap.set(e,t)}},{key:"updateMessageIsPeerReadProperty",value:function(e,t){if(e.startsWith(Ir.CONV_C2C)&&t>0){var n=this._messageListHandler.updateMessageIsPeerReadProperty(e,t);if(n.length>0&&this.emitOuterEvent(Mr.MESSAGE_READ_BY_PEER,n),this._conversationMap.has(e)){var o=this._conversationMap.get(e).lastMessage;Hd(o)||o.fromAccount===this.getMyUserID()&&o.lastTime<=t&&!o.isPeerRead&&(o.isPeerRead=!0,this.emitConversationUpdate(!0,!1))}}}},{key:"updateMessageIsModifiedProperty",value:function(e){this._messageListHandler.updateMessageIsModifiedProperty(e)}},{key:"setCompleted",value:function(e){Pl.l("".concat(this._n,".setCompleted. conversationID:").concat(e)),this._completedMap.set(e,!0)}},{key:"updateRoamingMessageKeyAndTime",value:function(e,t,n){this._roamingMessageKeyAndTimeMap.set(e,{messageKey:t,lastMessageTime:n})}},{key:"updateRoamingMessageSequence",value:function(e,t){this._roamingMessageSequenceMap.set(e,t)}},{key:"getConversationList",value:function(e){var t=this,n="getConversationList",o="".concat(this._n,".").concat(n),r="pagingStatus:".concat(this._pagingStatus,", local conversation count:").concat(this._conversationMap.size,", options:").concat(e);if(Pl.l("".concat(o,". ").concat(r)),this._pagingStatus===Fp.REJECTED){var i=new s_(n);return i.setMessage(r),this.syncConversationList().then((function(){i.setNetworkType(t.getNetworkType()).end();var n=t._getConversationList(e);return dI({conversationList:n,isSyncCompleted:t._isSyncCompleted()})})).catch((function(e){return t.probeNetwork().then((function(t){var n=_(t,2),o=n[0],r=n[1];i.setError(e,o,r).end()})),Pl.e("".concat(o," failed. error:"),e),vI(e)}))}if(0===this._conversationMap.size){var a=new s_(n);return a.setMessage(r),this.syncConversationList().then((function(){a.setNetworkType(t.getNetworkType()).end();var n=t._getConversationList(e);return dI({conversationList:n,isSyncCompleted:t._isSyncCompleted()})})).catch((function(e){return t.probeNetwork().then((function(t){var n=_(t,2),o=n[0],r=n[1];a.setError(e,o,r).end()})),Pl.e("".concat(o," failed. error:"),e),vI(e)}))}var s=this._getConversationList(e);return Pl.l("".concat(o,". returned conversation count:").concat(s.length)),gI({conversationList:s,isSyncCompleted:this._isSyncCompleted()})}},{key:"_getConversationList",value:function(e){if(Ql(e))return this.getLocalConversationList();if($l(e))return 0===e.length?[]:this.getLocalConversationList().filter((function(t){return e.includes(t.conversationID)}));if(Xl(e)){var t=e.type,n=e.markType,o=e.groupName;return this.getLocalConversationList().filter((function(e){return(t!==Ir.CONV_C2C&&t!==Ir.CONV_GROUP||e.type===t)&&(!Yl(o)||e.conversationGroupList.includes(o))&&(!Wl(n)||e.markList.includes(n))}))}return[]}},{key:"_handleC2CPeerReadTime",value:function(){var e,t=S(this._conversationMap);try{for(t.s();!(e=t.n()).done;){var n=_(e.value,2),o=n[0],r=n[1];r.type===Ir.CONV_C2C&&(Pl.d("".concat(this._n,"._handleC2CPeerReadTime conversationID:").concat(o," peerReadTime:").concat(r.peerReadTime)),this.recordPeerReadTime(o,r.peerReadTime))}}catch(a){t.e(a)}finally{t.f()}}},{key:"_isPagingGetGroupListCompleted",value:function(){return this.getModule(xf).isPagingGetCompleted()}},{key:"_getLocalGroupCount",value:function(){return this.getModule(xf).getLocalGroupList().length}},{key:"_hasLocalGroup",value:function(e){return this.getModule(xf).hasLocalGroup(e.replace(Ir.CONV_GROUP,""))}},{key:"getConversationProfile",value:function(e){var t,n=this;if((t=this._conversationMap.has(e)?this._conversationMap.get(e):new YI({conversationID:e,type:e.slice(0,3)===Ir.CONV_C2C?Ir.CONV_C2C:Ir.CONV_GROUP},this.isIntl()))._isInfoCompleted||t.type===Ir.CONV_SYSTEM)return gI({conversation:t});if(kd(e)&&!this._hasLocalGroup(e))return gI({conversation:t});var o="".concat(this._n,".").concat("getConversationProfile"),r=new s_("getConversationProfile");return Pl.l("".concat(o,". conversationID:").concat(e," remark:").concat(t.remark," lastMessage:"),t.lastMessage),this._updateUserOrGroupProfileCompletely(t).then((function(i){r.setNetworkType(n.getNetworkType()).setMessage("conversationID:".concat(e," unreadCount:").concat(i.data.conversation.unreadCount)).end();var a=n.getModule(Ff);if(a&&t.type===Ir.CONV_C2C){var s=e.replace(Ir.CONV_C2C,"");if(a.isMyFriend(s)){var u=a.getFriendRemark(s);t.remark!==u&&(t.remark=u,Pl.l("".concat(o,". conversationID:").concat(e," patch remark:").concat(t.remark)))}}return Pl.l("".concat(o," ok. conversationID:").concat(e)),i})).catch((function(t){return n.probeNetwork().then((function(n){var o=_(n,2),i=o[0],a=o[1];r.setError(t,i,a).setMessage("conversationID:".concat(e)).end()})),Pl.e("".concat(o," failed. error:"),t),vI(t)}))}},{key:"_updateUserOrGroupProfileCompletely",value:function(e){var t=this;return e.type===Ir.CONV_C2C?this.getModule(Gf).getUserProfile({userIDList:[e.toAccount]}).then((function(n){var o=n.data;return 0===o.length?vI(new pI({code:tm})):(e.userProfile=o[0],e._isInfoCompleted=!0,t._unshiftConversation(e),gI({conversation:e}))})):this.getModule(xf).getGroupProfile({groupID:e.toAccount}).then((function(n){return e.groupProfile=n.data.group,e._isInfoCompleted=!0,t._unshiftConversation(e),gI({conversation:e})}))}},{key:"_unshiftConversation",value:function(e){e instanceof YI&&!this._conversationMap.has(e.conversationID)&&(this._conversationMap=new Map([[e.conversationID,e]].concat(y(this._conversationMap))),this._setStorageConversationList(),this.emitConversationUpdate(!0,!1))}},{key:"_onProfileUpdated",value:function(e){var t=this;e.data.forEach((function(e){var n=e.userID;if(n===t.getMyUserID())t._onMyProfileModified({latestNick:e.nick,latestAvatar:e.avatar});else{var o=t._conversationMap.get("".concat(Ir.CONV_C2C).concat(n));o&&(o.userProfile=e)}}))}},{key:"_isSyncCompleted",value:function(){return this._pagingStatus===Fp.RESOLVED}},{key:"deleteConversation",value:function(e){var t=this,n={fromAccount:this.getMyUserID(),toAccount:void 0,type:void 0,toGroupID:void 0};if(!this._conversationMap.has(e))return vI({code:em});var o=this._conversationMap.get(e).type;if(o===Ir.CONV_C2C)n.type=1,n.toAccount=e.replace(Ir.CONV_C2C,"");else{if(o!==Ir.CONV_GROUP)return o===Ir.CONV_SYSTEM?(this.getModule(xf).deleteGroupSystemNotice({messageList:this._messageListHandler.getLocalMessageList(e)}),this.deleteLocalConversation(e),gI({conversationID:e})):vI({code:nm});if(!this._hasLocalGroup(e))return this.deleteLocalConversation(e),gI({conversationID:e});n.type=2,n.toGroupID=e.replace(Ir.CONV_GROUP,"")}var r="".concat(this._n,".").concat("deleteConversation"),i=new s_("deleteConversation");return i.setMessage("conversationID:".concat(e)),Pl.l("".concat(r,". conversationID:").concat(e)),this.setMessageRead({conversationID:e}).then((function(){return t.request({protocolName:Gh,requestData:n})})).then((function(){return i.setNetworkType(t.getNetworkType()).end(),Pl.l("".concat(r," ok")),t.deleteLocalConversation(e),gI({conversationID:e})})).catch((function(e){return t.probeNetwork().then((function(t){var n=_(t,2),o=n[0],r=n[1];i.setError(e,o,r).end()})),Pl.e("".concat(r," failed. error:"),e),vI(e)}))}},{key:"clearHistoryMessage",value:function(e){var t=this,n={fromAccount:this.getMyUserID(),toAccount:void 0,type:void 0,toGroupID:void 0};if(!this._conversationMap.has(e))return vI({code:em});var o=this._conversationMap.get(e).type;if(o===Ir.CONV_C2C)n.type=1,n.toAccount=e.replace(Ir.CONV_C2C,"");else{if(o!==Ir.CONV_GROUP)return o===Ir.CONV_SYSTEM?(this.getModule(xf).deleteGroupSystemNotice({messageList:this._messageListHandler.getLocalMessageList(e)}),gI({conversationID:e})):vI({code:nm});n.type=2,n.toGroupID=e.replace(Ir.CONV_GROUP,"")}var r="".concat(this._n,".").concat("clearHistoryMessage"),i=new s_("clearHistoryMessage");return i.setMessage("conversationID:".concat(e)),Pl.l("".concat(r,". conversationID:").concat(e)),this.setMessageRead({conversationID:e}).then((function(){return t.request({protocolName:Uh,requestData:n})})).then((function(){i.setNetworkType(t.getNetworkType()).end(),Pl.l("".concat(r," ok")),t._messageListHandler.removeByConversationID(e),t.setCompleted(e);var n=t.getLocalConversation(e);return n&&(n.updateLastMessage(),t._sortConversationListAndEmitEvent()),gI({conversationID:e})})).catch((function(e){return t.probeNetwork().then((function(t){var n=_(t,2),o=n[0],r=n[1];i.setError(e,o,r).end()})),Pl.e("".concat(r," failed. error:"),e),vI(e)}))}},{key:"pinConversation",value:function(e){var t=this,n=e.conversationID,o=e.isPinned;if(!this._conversationMap.has(n))return vI({code:em});var r=this.getLocalConversation(n);if(r.isPinned===o)return gI({conversationID:n});var i="".concat(this._n,".").concat("pinConversation"),a=new s_("pinConversation");a.setMessage("conversationID:".concat(n," isPinned:").concat(o)),Pl.l("".concat(i,". conversationID:").concat(n," isPinned:").concat(o));var s=null;return Cd(n)?s={type:1,toAccount:n.replace(Ir.CONV_C2C,"")}:kd(n)&&(s={type:2,groupID:n.replace(Ir.CONV_GROUP,"")}),this.request({protocolName:xh,requestData:{fromAccount:this.getMyUserID(),operationType:!0===o?1:2,itemList:[s]}}).then((function(){return a.setNetworkType(t.getNetworkType()).end(),Pl.l("".concat(i," ok")),r.isPinned!==o&&(r.isPinned=o,t._sortConversationListAndEmitEvent()),dI({conversationID:n})})).catch((function(e){return t.probeNetwork().then((function(t){var n=_(t,2),o=n[0],r=n[1];a.setError(e,o,r).end()})),Pl.e("".concat(i," failed. error:"),e),vI(e)}))}},{key:"setMessageRemindType",value:function(e){return this._messageRemindHandler.set(e)}},{key:"patchMessageRemindType",value:function(e){var t=e.ID,n=e.isC2CConversation,o=e.messageRemindType,r=!1,i=this.getLocalConversation(n?"".concat(Ir.CONV_C2C).concat(t):"".concat(Ir.CONV_GROUP).concat(t));return i&&i.messageRemindType!==o&&(i.messageRemindType=o,r=!0),Pl.d("".concat(this._n,".patchMessageRemindType options:"),e,"ret:".concat(r)),r}},{key:"onC2CMessageRemindTypeSynced",value:function(e){var t=this,n="".concat(this._n,".onC2CMessageRemindTypeSynced");Pl.d(n,e),e.dataList.forEach((function(e){if(!Hd(e.muteNotificationsSync)){var o,r=e.muteNotificationsSync,i=r.to,a=r.updateSequence,s=r.muteFlag;t._messageRemindHandler.setUpdateSequence(a),0===s?o=Ir.MSG_REMIND_ACPT_AND_NOTE:1===s?o=Ir.MSG_REMIND_DISCARD:2===s&&(o=Ir.MSG_REMIND_ACPT_NOT_NOTE);var u=0;t.patchMessageRemindType({ID:i,isC2CConversation:!0,messageRemindType:o})&&(u+=1),Pl.l("".concat(n," updateCount:").concat(u)),u>=1&&t.emitConversationUpdate(!0,!1)}}))}},{key:"onGroupMessageRemindTypeSynced",value:function(e){Pl.d("".concat(this._n,".onGroupMessageRemindTypeSynced options:"),e),this._messageRemindHandler.onGroupMessageRemindTypeUpdated(e)}},{key:"deleteLocalConversation",value:function(e){var t=this._conversationMap.has(e);if(Pl.l("".concat(this._n,".deleteLocalConversation conversationID:").concat(e," has:").concat(t)),t){this._conversationMap.delete(e),this._roamingMessageKeyAndTimeMap.has(e)&&this._roamingMessageKeyAndTimeMap.delete(e),this._roamingMessageSequenceMap.has(e)&&this._roamingMessageSequenceMap.delete(e),this._setStorageConversationList(),this._messageListHandler.removeByConversationID(e),this._completedMap.delete(e);var n=!this._isTopicConversation(e);this.emitConversationUpdate(n,!1)}}},{key:"isMessageSentByCurrentInstance",value:function(e){return!(!this._messageListHandler.hasLocalMessage(e.conversationID,e.ID)&&!this.singlyLinkedList.has(e.random))}},{key:"modifyMessageList",value:function(e){if(e.startsWith(Ir.CONV_C2C)&&this._conversationMap.has(e)){var t=this._conversationMap.get(e),n=Date.now();this._messageListHandler.modifyMessageSentByPeer({conversationID:e,latestNick:t.userProfile.nick,latestAvatar:t.userProfile.avatar});var o=this.getModule(Gf).getNickAndAvatarByUserID(this.getMyUserID());this._messageListHandler.modifyMessageSentByMe({conversationID:e,latestNick:o.nick,latestAvatar:o.avatar}),Pl.l("".concat(this._n,".modifyMessageList conversationID:").concat(e," cost ").concat(Date.now()-n," ms"))}}},{key:"updateUserProfileSpecifiedKey",value:function(e){Pl.l("".concat(this._n,".updateUserProfileSpecifiedKey options:"),e);var t=e.conversationID,n=e.nick,o=e.avatar;if(this._conversationMap.has(t)){var r=this._conversationMap.get(t).userProfile;Yl(n)&&r.nick!==n&&(r.nick=n),Yl(o)&&r.avatar!==o&&(r.avatar=o),this.emitConversationUpdate(!0,!1)}}},{key:"_onMyProfileModified",value:function(e){var n=this,o=this.getLocalConversationList(),r=Date.now();o.forEach((function(o){n.modifyMessageSentByMe(t({conversationID:o.conversationID},e))})),Pl.l("".concat(this._n,"._onMyProfileModified. modify all messages sent by me, cost ").concat(Date.now()-r," ms"))}},{key:"modifyMessageSentByMe",value:function(e){this._messageListHandler.modifyMessageSentByMe(e)}},{key:"getLatestMessageSentByMe",value:function(e){return this._messageListHandler.getLatestMessageSentByMe(e)}},{key:"modifyMessageSentByPeer",value:function(e){this._messageListHandler.modifyMessageSentByPeer(e)}},{key:"getLatestMessageSentByPeer",value:function(e){return this._messageListHandler.getLatestMessageSentByPeer(e)}},{key:"pushIntoNoticeResult",value:function(e,t){return!(!this._messageListHandler.pushIn(t)||this.singlyLinkedList.has(t.random))&&(e.push(t),!0)}},{key:"getLocalLastMessage",value:function(e){return this._messageListHandler.getLocalLastMessage(e)}},{key:"checkAndPatchRemark",value:function(){var e=Promise.resolve();if(0===this._conversationMap.size)return e;var t=this.getModule(Ff);if(!t)return e;var n=y(this._conversationMap.values()).filter((function(e){return e.type===Ir.CONV_C2C}));if(0===n.length)return e;var o=0;return n.forEach((function(e){var n=e.conversationID.replace(Ir.CONV_C2C,"");if(t.isMyFriend(n)){var r=t.getFriendRemark(n);e.remark!==r&&(e.remark=r,o+=1)}})),Pl.l("".concat(this._n,".checkAndPatchRemark. c2c conversation count:").concat(n.length,", patched count:").concat(o)),e}},{key:"updateTopicConversation",value:function(e){this._updateLocalConversationList({conversationOptionsList:e,isFromGetConversations:!0})}},{key:"sendReadReceipt",value:function(e){var t=e[0],n=null;return t.conversationType===Ir.CONV_C2C?n=this._m.getModule(Uf):t.conversationType===Ir.CONV_GROUP&&(n=this._m.getModule(xf)),n?n.sendReadReceipt(e):vI({code:Rm})}},{key:"getReadReceiptList",value:function(e){var t=e[0],n=null;return t.conversationType===Ir.CONV_C2C?n=this._m.getModule(Uf):t.conversationType===Ir.CONV_GROUP&&(n=this._m.getModule(xf)),n?n.getReadReceiptList(e):vI({code:Rm})}},{key:"getLastMessageTime",value:function(e){var t=this.getLocalConversation(e);return t?t.lastMessage.lastTime:0}},{key:"getTotalUnreadMessageCount",value:function(){var e=this.getLocalConversationList(),t=0;return e.forEach((function(e){e.type!==Ir.CONV_SYSTEM&&(""!==e.messageRemindType&&e.messageRemindType!==Ir.MSG_REMIND_ACPT_AND_NOTE||(t+=e.unreadCount))})),t}},{key:"emitTotalUnreadMessageCountUpdate",value:function(){var e=this.getTotalUnreadMessageCount();this._convTotalUnreadCount!==e&&(Pl.l("".concat(this._n,".emitTotalUnreadMessageCountUpdate from ").concat(this._convTotalUnreadCount," to ").concat(e)),this._convTotalUnreadCount=e,this.emitOuterEvent(Mr.TOTAL_UNREAD_MESSAGE_COUNT_UPDATED))}},{key:"reset",value:function(){Pl.l("".concat(this._n,".reset")),this._pagingStatus=Fp.NOT_START,this._messageListHandler.reset(),this._messageRemindHandler.reset(),this._roamingMessageKeyAndTimeMap.clear(),this._roamingMessageSequenceMap.clear(),this.singlyLinkedList.reset(),this._peerReadTimeMap.clear(),this._completedMap.clear(),this._conversationMap.clear(),this._pagingTimeStamp=0,this._pagingStartIndex=0,this._pagingPinnedTimeStamp=0,this._pagingPinnedStartIndex=0,this._remoteGroupReadSequenceMap.clear(),this._convTotalUnreadCount=0,this.resetReady()}}]),o}(lh),oC=function(){function e(t){r(this,e),this._groupModule=t,this._n="GroupTipsHandler",this._cachedGroupTipsMap=new Map,this._checkCountMap=new Map,this.MAX_CHECK_COUNT=4,this._getTopicPendingMap=new Map}return a(e,[{key:"onCheckTimer",value:function(e){e%1==0&&this._cachedGroupTipsMap.size>0&&this._checkCachedGroupTips()}},{key:"_checkCachedGroupTips",value:function(){var e=this;this._cachedGroupTipsMap.forEach((function(t,n){var o=e._checkCountMap.get(n),r=e._groupModule.hasLocalGroup(n);Pl.l("".concat(e._n,"._checkCachedGroupTips groupID:").concat(n," hasLocalGroup:").concat(r," checkCount:").concat(o)),r?(e._notifyCachedGroupTips(n),e._checkCountMap.delete(n),e._groupModule.deleteUnjoinedAVChatRoom(n)):o>=e.MAX_CHECK_COUNT?(e._deleteCachedGroupTips(n),e._checkCountMap.delete(n)):(o++,e._checkCountMap.set(n,o))}))}},{key:"onNewGroupTips",value:function(e){Pl.d("".concat(this._n,".onReceiveGroupTips count:").concat(e.dataList.length));var t=this.newGroupTipsStoredAndSummary(e),n=t.eventDataList,o=t.result,r=t.AVChatRoomMessageList;r.length>0&&this._groupModule.onAVChatRoomMessage(r),n.length>0&&(this._groupModule.updateNextMessageSeq(n),this._groupModule.getModule(Vf).onNewMessage({conversationOptionsList:n,isInstantMessage:!0})),o.length>0&&(this._groupModule.emitOuterEvent(Mr.MESSAGE_RECEIVED,o),this.handleMessageList(o))}},{key:"newGroupTipsStoredAndSummary",value:function(e){for(var n=this,o=e.event,r=e.dataList,i=null,a=[],s=[],u={},c=[],l=function(e,l){var d=vd(r[e]);if(6===o){if(n._groupModule.isGroupAttributesUpdatedNotice(d))return"continue";if(n._groupModule.isGroupCountersNotice(d))return"continue"}var p=d.groupProfile,f=p.groupID,h=p.communityType,g=void 0===h?0:h,v=p.topicID,m=void 0===v?void 0:v,_=p.invisible,y=void 0,M=n._groupModule.isMessageFromTopic(g,m);if(M){y=Ir.CONV_TOPIC,d.to=m;var I=n._groupModule.getModule(Bf);I.hasLocalTopic(f,m)||n._getTopicPendingMap.has(m)||(n._getTopicPendingMap.set(m,1),I.getTopicList({groupID:f,topicIDList:[m]}).finally((function(){n._getTopicPendingMap.delete(m)})))}var C=n._groupModule.hasLocalGroup(f);if(!C&&n._groupModule.isUnjoinedAVChatRoom(f))return"continue";if(!C&&!M)return n._cacheGroupTipsAndProbe({groupID:f,event:o,item:d}),"continue";if(n._groupModule.isMessageFromOrToAVChatroom(f))return d.event=o,c.push(d),"continue";if(d.currentUser=n._groupModule.getMyUserID(),d.conversationType=Ir.CONV_GROUP,(i=new lI(d)).setElement({type:Ir.MSG_GRP_TIP,content:t(t({},d.elements),{},{groupProfile:d.groupProfile})}),i.isSystemMessage=!1,1===_)return n._qualityStat(i),"continue";var k=n._groupModule.getModule(Vf),T=i,S=T.conversationID,b=T.sequence;if(6===o)i._onlineOnlyFlag=!0,s.push(i);else if(!k.pushIntoNoticeResult(s,i))return"continue";if(n._groupModule.isMessageFromCommunityOfTopic(g,m))return"continue";if(6===o&&k.getLocalConversation(S))return"continue";6!==o&&n._qualityStat(i);var D=k.isRemoteRead({conversationID:S,sequence:b});if(Ql(u[S])){var E=0;"in"===i.flow&&(i._isExcludedFromUnreadCount||i._onlineOnlyFlag||D||(E=1)),u[S]=a.push({conversationID:S,unreadCount:E,type:Ql(y)?i.conversationType:y,subType:i.conversationSubType,lastMessage:i._isExcludedFromLastMessage?"":i})-1}else{var A=u[S];a[A].type=i.conversationType,a[A].subType=i.conversationSubType,a[A].lastMessage=i._isExcludedFromLastMessage?"":i,"in"===i.flow&&(i._isExcludedFromUnreadCount||i._onlineOnlyFlag||D||a[A].unreadCount++)}},d=0,p=r.length;d<p;d++)l(d);return{eventDataList:a,result:s,AVChatRoomMessageList:c}}},{key:"_qualityStat",value:function(e){this._groupModule.getModule(oh).addMessageSequence({key:e_,message:e})}},{key:"handleMessageList",value:function(e){var t=this;e.forEach((function(e){switch(e.payload.operationType){case 1:t._onNewMemberComeIn(e);break;case 2:t._onMemberQuit(e);break;case 3:t._onMemberKickedOut(e);break;case 4:t._onMemberSetAdmin(e);break;case 5:t._onMemberCancelledAdmin(e);break;case 6:t._onGroupProfileModified(e);break;case 7:t._onMemberInfoModified(e);break;case 8:t._onTopicProfileUpdated(e);break;default:Pl.w("".concat(t._n,".handleMessageList unknown operationType:").concat(e.payload.operationType))}}))}},{key:"_onNewMemberComeIn",value:function(e){var t=e.payload,n=t.memberNum,o=t.groupProfile.groupID,r=this._groupModule.getLocalGroupProfile(o);r&&Wl(n)&&r.memberCount!==n&&(r.memberCount=n,this._updateConversationGroupProfile(r))}},{key:"_onMemberQuit",value:function(e){var t=e.payload,n=t.memberNum,o=t.groupProfile.groupID,r=this._groupModule.getLocalGroupProfile(o);r&&Wl(n)&&r.memberCount!==n&&(r.memberCount=n,this._updateConversationGroupProfile(r)),this._groupModule.getModule(qf).deleteLocalGroupMembers(o,e.payload.userIDList)}},{key:"_onMemberKickedOut",value:function(e){var t=e.payload,n=t.memberNum,o=t.groupProfile.groupID,r=this._groupModule.getLocalGroupProfile(o);r&&Wl(n)&&r.memberCount!==n&&(r.memberCount=n,this._updateConversationGroupProfile(r)),this._groupModule.getModule(qf).deleteLocalGroupMembers(o,e.payload.userIDList)}},{key:"_updateConversationGroupProfile",value:function(e){this._groupModule.getModule(Vf).updateConversationGroupProfile([e])}},{key:"_onMemberSetAdmin",value:function(e){var t=e.payload.groupProfile.groupID,n=e.payload.userIDList,o=this._groupModule.getModule(qf);n.forEach((function(e){var n=o.getLocalGroupMemberInfo(t,e);n&&n.updateRole(Ir.GRP_MBR_ROLE_ADMIN)}))}},{key:"_onMemberCancelledAdmin",value:function(e){var t=e.payload.groupProfile.groupID,n=e.payload.userIDList,o=this._groupModule.getModule(qf);n.forEach((function(e){var n=o.getLocalGroupMemberInfo(t,e);n&&n.updateRole(Ir.GRP_MBR_ROLE_MEMBER)}))}},{key:"_onGroupProfileModified",value:function(e){var t=this,n=e.payload,o=n.newGroupProfile,r=n.groupProfile.groupID,i=this._groupModule.getLocalGroupProfile(r);Object.keys(o).forEach((function(e){switch(e){case"ownerID":t._ownerChanged(i,o);break;case"muteAllMembers":i.muteAllMembers=o.muteAllMembers;break;case"joinOption":i.joinOption=o.joinOption;break;default:i[e]=o[e]}}));var a=!i.isSupportTopic;this._groupModule.emitGroupListUpdate(!0,a)}},{key:"_ownerChanged",value:function(e,t){var n=e.groupID,o=this._groupModule.getLocalGroupProfile(n),r=this._groupModule.getMyUserID();if(r===t.ownerID){o.updateGroup({selfInfo:{role:Ir.GRP_MBR_ROLE_OWNER}});var i=this._groupModule.getModule(qf),a=i.getLocalGroupMemberInfo(n,r),s=this._groupModule.getLocalGroupProfile(n).ownerID,u=i.getLocalGroupMemberInfo(n,s);a&&a.updateRole(Ir.GRP_MBR_ROLE_OWNER),u&&u.updateRole(Ir.GRP_MBR_ROLE_MEMBER)}}},{key:"_onMemberInfoModified",value:function(e){var t=e.to,n=e.payload,o=n.groupProfile,r=n.memberList,i=o.groupID;Id(t)&&this._updateTopicMuteTime(e);var a=this._groupModule.getModule(qf);r.forEach((function(e){var t=a.getLocalGroupMemberInfo(i,e.userID);t&&Wl(e.muteTime)&&t.updateMuteUntil(e.muteTime)}))}},{key:"_updateTopicMuteTime",value:function(e){var t=e.to,n=e.payload,o=n.groupProfile,r=n.memberList,i=void 0===r?[]:r,a=this._groupModule.getModule(Bf),s=o.groupID,u=a.getLocalTopic(s,t);if(u){for(var c=!1,l=0;l<i.length;l++){var d=i[l];if(d.userID===this._groupModule.getMyUserID()&&d.muteTime>=0){u.updateSelfInfo({muteTime:d.muteTime}),c=!0;break}}c&&this._groupModule.emitOuterEvent(Mr.TOPIC_UPDATED,{groupID:s,topic:u})}}},{key:"_onTopicProfileUpdated",value:function(e){var n=e.payload,o=n.groupProfile.groupID,r=n.newTopicInfo;this._groupModule.getModule(Bf).onTopicProfileUpdated(t({groupID:o,topicID:e.to},r))}},{key:"_cacheGroupTips",value:function(e,t){this._cachedGroupTipsMap.has(e)||this._cachedGroupTipsMap.set(e,[]),this._cachedGroupTipsMap.get(e).push(t)}},{key:"_deleteCachedGroupTips",value:function(e){this._cachedGroupTipsMap.has(e)&&this._cachedGroupTipsMap.delete(e)}},{key:"_notifyCachedGroupTips",value:function(e){var t=this,n=this._cachedGroupTipsMap.get(e)||[];n.forEach((function(e){t.onNewGroupTips(e)})),this._deleteCachedGroupTips(e),Pl.l("".concat(this._n,"._notifyCachedGroupTips groupID:").concat(e," count:").concat(n.length))}},{key:"_cacheGroupTipsAndProbe",value:function(e){var t=this,n=e.groupID,o=e.event,r=e.item;this._cacheGroupTips(n,{event:o,dataList:[r]}),this._groupModule.getGroupSimplifiedInfo(n).then((function(e){e.type===Ir.GRP_AVCHATROOM?t._groupModule.hasLocalGroup(n)?t._notifyCachedGroupTips(n):t._groupModule.setUnjoinedAVChatRoom(n):(t._groupModule.updateGroupMap([e]),t._notifyCachedGroupTips(n))})),this._checkCountMap.has(n)||this._checkCountMap.set(n,0),Pl.l("".concat(this._n,"._cacheGroupTipsAndProbe groupID:").concat(n))}},{key:"reset",value:function(){this._cachedGroupTipsMap.clear(),this._checkCountMap.clear(),this._getTopicPendingMap.clear()}}]),e}(),rC=function(){function e(t){r(this,e),this._groupModule=t,this._n="CommonGroupHandler",this.tempConversationList=null,this._cachedGroupMessageMap=new Map,this._checkCountMap=new Map,this.MAX_CHECK_COUNT=4,this._getTopicPendingMap=new Map,this._isPagingGetCompleted=!1,t.getInnerEmitterInstance().once(OI,this._initGroupList,this)}return a(e,[{key:"onCheckTimer",value:function(e){e%1==0&&this._cachedGroupMessageMap.size>0&&this._checkCachedGroupMessage()}},{key:"_checkCachedGroupMessage",value:function(){var e=this;this._cachedGroupMessageMap.forEach((function(t,n){var o=e._checkCountMap.get(n),r=e._groupModule.hasLocalGroup(n);Pl.l("".concat(e._n,"._checkCachedGroupMessage groupID:").concat(n," hasLocalGroup:").concat(r," checkCount:").concat(o)),r?(e._notifyCachedGroupMessage(n),e._checkCountMap.delete(n),e._groupModule.deleteUnjoinedAVChatRoom(n)):o>=e.MAX_CHECK_COUNT?(e._deleteCachedGroupMessage(n),e._checkCountMap.delete(n)):(o++,e._checkCountMap.set(n,o))}))}},{key:"_initGroupList",value:function(){var e=this;Pl.l("".concat(this._n,"._initGroupList"));var t=new s_("getGroupListInStorage"),n=this._groupModule.getStorageGroupList();if($l(n)&&n.length>0){n.forEach((function(t){e._groupModule.initGroupMap(t)})),this._groupModule.emitGroupListUpdate(!0,!1);var o=this._groupModule.getLocalGroupList().length;t.setNetworkType(this._groupModule.getNetworkType()).setMessage("group count:".concat(o)).end()}else t.setNetworkType(this._groupModule.getNetworkType()).setMessage("group count:0").end();Pl.l("".concat(this._n,"._initGroupList ok"))}},{key:"handleUpdateGroupLastMessage",value:function(e){var n="".concat(this._n,".handleUpdateGroupLastMessage");if(Pl.l("".concat(n," conversation count:").concat(e.length,", local group count:").concat(this._groupModule.getLocalGroupList().length)),0!==this._groupModule.getGroupMap().size){for(var o,r,i,a=!1,s=0,u=e.length;s<u;s++)(o=e[s]).type===Ir.CONV_GROUP&&(r=o.conversationID.split(/^GROUP/)[1],(i=this._groupModule.getLocalGroupProfile(r))&&(i.lastMessage=t({},o.lastMessage),a=!0));a&&(this._groupModule.sortLocalGroupList(),this._groupModule.emitGroupListUpdate(!0,!1))}else this.tempConversationList=e}},{key:"onNewGroupMessage",value:function(e){Pl.d("".concat(this._n,".onNewGroupMessage count:").concat(e.dataList.length));var t=this._newGroupMessageStoredAndSummary(e),n=t.conversationOptionsList,o=t.messageList,r=t.AVChatRoomMessageList;r.length>0&&this._groupModule.onAVChatRoomMessage(r),this._groupModule.filterModifiedMessage(o),n.length>0&&(this._groupModule.updateNextMessageSeq(n),this._groupModule.getModule(Vf).onNewMessage({conversationOptionsList:n,isInstantMessage:e.isInstantMessage||!0,updateUnreadCount:e.updateUnreadCount||!0}));var i=this._groupModule.filterUnmodifiedMessage(o);i.length>0&&this._groupModule.emitOuterEvent(Mr.MESSAGE_RECEIVED,i),o.length=0}},{key:"_newGroupMessageStoredAndSummary",value:function(e){var t=this,n=e.dataList,o=e.event,r=e.isInstantMessage,i=null,a=[],s=[],u=[],c={},l=this._groupModule.getModule(Zf),d=n.length;d>1&&n.sort((function(e,t){return e.sequence-t.sequence}));for(var p=function(e){var d=vd(n[e]),p=d.groupProfile,f=p.groupID,h=p.communityType,g=void 0===h?0:h,v=p.topicID,m=void 0===v?void 0:v,_=p.invisible,y=void 0,M=t._groupModule.isMessageFromTopic(g,m);if(M){y=Ir.CONV_TOPIC,d.to=m;var I=t._groupModule.getModule(Bf);I.hasLocalTopic(f,m)||t._getTopicPendingMap.has(m)||(t._getTopicPendingMap.set(m,1),I.getTopicList({groupID:f,topicIDList:[m]}).finally((function(){t._getTopicPendingMap.delete(m)})))}var C=t._groupModule.hasLocalGroup(f);if(!C&&t._groupModule.isUnjoinedAVChatRoom(f))return"continue";if(!C&&!M)return t._cacheGroupMessageAndProbe({groupID:f,event:o,item:d}),"continue";if(t._groupModule.isMessageFromOrToAVChatroom(f))return d.event=o,u.push(d),"continue";if(d.currentUser=t._groupModule.getMyUserID(),d.conversationType=Ir.CONV_GROUP,d.isSystemMessage=!!d.isSystemMessage,i=new lI(d),d.elements=l.parseElements(d.elements,d.from),i.setElement(d.elements),1===_)return t._qualityStat(r,i),"continue";var k=1===n[e].isModified,T=t._groupModule.getModule(Vf);if(T.isMessageSentByCurrentInstance(i)?i.isModified=k:k=!1,1===d.onlineOnlyFlag)i._onlineOnlyFlag=!0,T.isMessageSentByCurrentInstance(i)||s.push(i);else{if(t._groupModule.isMessageFromCommunityOfTopic(g,m))return s.push(i),"continue";if(!T.pushIntoMessageList(s,i,k))return"continue";t._qualityStat(r,i);var S=i,b=S.conversationID,D=S.sequence,E=T.isRemoteRead({conversationID:b,sequence:D});if(Ql(c[b])){var A=0;"in"===i.flow&&(i._isExcludedFromUnreadCount||E||(A=1)),c[b]=a.push({conversationID:b,unreadCount:A,type:Ql(y)?i.conversationType:y,subType:i.conversationSubType,lastMessage:i._isExcludedFromLastMessage?"":i})-1}else{var L=c[b];a[L].type=Ql(y)?i.conversationType:y,a[L].subType=i.conversationSubType,a[L].lastMessage=i._isExcludedFromLastMessage?"":i,"in"===i.flow&&(i._isExcludedFromUnreadCount||E||a[L].unreadCount++)}}},f=0;f<d;f++)p(f);return{conversationOptionsList:a,messageList:s,AVChatRoomMessageList:u}}},{key:"_qualityStat",value:function(e,t){var n=this._groupModule.getModule(oh);n.addMessageSequence({key:e_,message:t}),e&&t.clientTime>0&&n.addMessageDelay(t.clientTime)}},{key:"onGroupMessageRevoked",value:function(e){var t=this._groupModule.getModule(Vf),n=[],o=null,r=!0;e.dataList.forEach((function(e){var i=e.elements.revokedInfos;Ql(i)||i.forEach((function(e){var i=Hd(e.topicID)?"GROUP".concat(e.groupID):"GROUP".concat(e.topicID);o=t.revoke(i,e.sequence,e.random);var a=e.revokerInfo&&e.revokerInfo.revoker;if(o)o.revoker=a,n.push(o);else{var s={conversationID:i,to:e.topicID||"",sequence:e.sequence,time:e.time,revoker:a};t.isLastMessageRevoked(s)&&(n.push(s),r=!1)}}))})),0!==n.length&&(t.onMessageRevoked(n),!0===r&&(Pl.l("".concat(this._n,".onGroupMessageRevoked count:").concat(n.length)),this._groupModule.emitOuterEvent(Mr.MESSAGE_REVOKED,n)))}},{key:"_groupListTreeShaking",value:function(e){for(var t=new Map(y(this._groupModule.getGroupMap())),n=0,o=e.length;n<o;n++)t.delete(e[n].groupID);this._groupModule.hasJoinedAVChatRoom()&&this._groupModule.getJoinedAVChatRoom().forEach((function(e){t.delete(e)})),this._groupModule.getGroupMap().forEach((function(e,n){e.isSupportTopic&&t.delete(n)}));for(var r=y(t.keys()),i=0,a=r.length;i<a;i++)this._groupModule.deleteGroup(r[i])}},{key:"getGroupList",value:function(e){var t=this,n="".concat(this._n,".").concat("getGroupList"),o=new s_("getGroupList");Pl.l("".concat(n));var r={introduction:"Introduction",notification:"Notification",createTime:"CreateTime",ownerID:"Owner_Account",lastInfoTime:"LastInfoTime",memberNum:"MemberNum",maxMemberNum:"MaxMemberNum",joinOption:"ApplyJoinOption",muteAllMembers:"ShutUpAllMember"},i=["Type","Name","FaceUrl","NextMsgSeq","LastMsgTime","AtInfoList","LastRecallTime"],a=[];e&&e.groupProfileFilter&&e.groupProfileFilter.forEach((function(e){r[e]&&i.push(r[e])}));var s=(e||{}).isGroupWithTopicOnly,u=void 0!==s&&s;return this._pagingGetGroupList({limit:50,offset:0,groupBaseInfoFilter:i,groupList:a,isGroupWithTopicOnly:u}).then((function(){Pl.l("".concat(n," ok. count:").concat(a.length," isGroupWithTopicOnly:").concat(u)),u||t._groupListTreeShaking(a),t._groupModule.updateGroupMap(a);var e=t._groupModule.getLocalGroupList().length;o.setNetworkType(t._groupModule.getNetworkType()).setMessage("remote count:".concat(a.length,", after tree shaking, local count:").concat(e,", isGroupWithTopicOnly:").concat(u)).end(),t.tempConversationList&&(t.handleUpdateGroupLastMessage(t.tempConversationList),t.tempConversationList=null),t._groupModule.patchGroupMessageRemindType(),t._groupModule.recomputeUnreadCount(),t._groupModule.emitGroupListUpdate(!0,!u);var r=t._groupModule.getLocalGroupList();if(u){var i=r.filter((function(e){return!0===e.isSupportTopic}));return dI({groupList:i})}return t._isPagingGetCompleted=!0,dI({groupList:r})})).catch((function(e){return t._groupModule.probeNetwork().then((function(t){var n=_(t,2),r=n[0],i=n[1];o.setError(e,r,i).end()})),Pl.e("".concat(n," failed. error:"),e),vI(e)}))}},{key:"isPagingGetCompleted",value:function(){return this._isPagingGetCompleted}},{key:"_pagingGetGroupList",value:function(e){var t=this,n="".concat(this._n,".").concat("_pagingGetGroupList"),o=e.isCommunityRelay,r=void 0!==o&&o,i=e.isGroupWithTopicOnly,a=void 0!==i&&i,s=e.limit,u=e.offset,c=e.groupBaseInfoFilter,l=e.groupList;if(a)return this._pagingGetGroupListWithTopic({limit:s,offset:u,groupBaseInfoFilter:c,groupList:l});var d=new s_("_pagingGetGroupList");return this._groupModule.request({protocolName:Wh,requestData:{type:r?Ir.GRP_COMMUNITY:void 0,memberAccount:this._groupModule.getMyUserID(),limit:s,offset:u,responseFilter:{groupBaseInfoFilter:c,selfInfoFilter:["Role","JoinTime","MsgFlag","MsgSeq"]}}}).then((function(e){var o=e.data,i=o.groups,a=void 0===i?[]:i,p=o.totalCount;l.push.apply(l,y(a)),t._handleGroupAtInfoWithoutTopic(r,a);var f=u+s,h=!(p>f),g="offset:".concat(u," totalCount:").concat(p," isCompleted:").concat(h," ")+"currentCount:".concat(l.length," isCommunityRelay:").concat(r);return d.setNetworkType(t._groupModule.getNetworkType()).setMessage("".concat(g)).end(),r||h?!r&&h?(Pl.l("".concat(n," start to get community list")),u=0,t._pagingGetGroupList({limit:s,offset:u,groupBaseInfoFilter:c,groupList:l,isCommunityRelay:!0})):r&&!h?(u=f,t._pagingGetGroupList({limit:s,offset:u,groupBaseInfoFilter:c,groupList:l,isCommunityRelay:!0})):(Pl.l("".concat(n," ok. totalCount:").concat(l.length)),dI({groupList:l})):(u=f,t._pagingGetGroupList({limit:s,offset:u,groupBaseInfoFilter:c,groupList:l}))})).catch((function(e){return 11e3!==e.code&&t._groupModule.probeNetwork().then((function(t){var n=_(t,2),o=n[0],i=n[1];d.setMessage("isCommunityRelay:".concat(r)).setError(e,o,i).end()})),r?(11e3===e.code&&(d=null,Pl.l("".concat(n," ok. community unavailable"))),gI({groupList:l})):vI(e)}))}},{key:"_pagingGetGroupListWithTopic",value:function(e){var t=this,n="".concat(this._n,"._pagingGetGroupListWithTopic"),o=e.limit,r=e.offset,i=e.groupBaseInfoFilter,a=e.groupList,s=new s_("pagingGetGroupListWithTopic");return this._groupModule.request({protocolName:Wh,requestData:{type:Ir.GRP_COMMUNITY,memberAccount:this._groupModule.getMyUserID(),limit:o,offset:r,responseFilter:{groupBaseInfoFilter:i,selfInfoFilter:["Role","JoinTime","MsgFlag","MsgSeq"]},isSupportTopic:1}}).then((function(e){var u=e.data,c=u.groups,l=void 0===c?[]:c,d=u.totalCount;a.push.apply(a,y(l));var p=r+o,f=!(d>p),h="offset:".concat(r," totalCount:").concat(d," isCompleted:").concat(f," ")+"currentCount:".concat(a.length);return s.setNetworkType(t._groupModule.getNetworkType()).setMessage("".concat(h)).end(),f?(Pl.l("".concat(n," ok. totalCount:").concat(a.length)),dI({groupList:a})):(r=p,t._pagingGetGroupListWithTopic({limit:o,offset:r,groupBaseInfoFilter:i,groupList:a}))})).catch((function(e){return t._groupModule.probeNetwork().then((function(t){var n=_(t,2),o=n[0],r=n[1];s.setError(e,o,r).end()})),vI(e)}))}},{key:"_cacheGroupMessage",value:function(e,t){this._cachedGroupMessageMap.has(e)||this._cachedGroupMessageMap.set(e,[]),this._cachedGroupMessageMap.get(e).push(t)}},{key:"_deleteCachedGroupMessage",value:function(e){this._cachedGroupMessageMap.has(e)&&this._cachedGroupMessageMap.delete(e)}},{key:"_notifyCachedGroupMessage",value:function(e){var t=this,n=this._cachedGroupMessageMap.get(e)||[];n.forEach((function(e){t.onNewGroupMessage(e)})),this._deleteCachedGroupMessage(e),Pl.l("".concat(this._n,"._notifyCachedGroupMessage groupID:").concat(e," count:").concat(n.length))}},{key:"_cacheGroupMessageAndProbe",value:function(e){var t=this,n=e.groupID,o=e.event,r=e.item;this._cacheGroupMessage(n,{event:o,dataList:[r]}),this._groupModule.getGroupSimplifiedInfo(n).then((function(e){e.type===Ir.GRP_AVCHATROOM?t._groupModule.hasLocalGroup(n)?t._notifyCachedGroupMessage(n):t._groupModule.setUnjoinedAVChatRoom(n):(t._groupModule.updateGroupMap([e]),t._notifyCachedGroupMessage(n))})),this._checkCountMap.has(n)||this._checkCountMap.set(n,0),Pl.l("".concat(this._n,"._cacheGroupMessageAndProbe groupID:").concat(n))}},{key:"_handleGroupAtInfoWithoutTopic",value:function(e,n){var o=this;e&&0!==n.length&&n.forEach((function(e){var n=e.groupID,r=e.groupAtInfoList,i=[];Ql(r)||(r.forEach((function(e){i.push(t(t({},e),{},{groupID:n}))})),o._groupModule.getModule(Vf).onNewGroupAtTips({dataList:i}))}))}},{key:"reset",value:function(){this._cachedGroupMessageMap.clear(),this._checkCountMap.clear(),this._getTopicPendingMap.clear(),this._isPagingGetCompleted=!1,this._groupModule.getInnerEmitterInstance().once(OI,this._initGroupList,this)}}]),e}(),iC=1,aC=2,sC=3,uC=4,cC=5,lC=function(){function e(t){r(this,e),this._groupModule=t,this._n="GroupAttributesHandler",this._groupAttributesMap=new Map,this.CACHE_EXPIRE_TIME=3e4,this._groupModule.getInnerEmitterInstance().on(NI,this._onCloudConfigUpdated,this)}return a(e,[{key:"_onCloudConfigUpdated",value:function(){var e=this._groupModule.getCloudConfig("grp_attr_cache_time");Ql(e)||(this.CACHE_EXPIRE_TIME=Number(e))}},{key:"updateLocalMainSequenceOnReconnected",value:function(){this._groupAttributesMap.forEach((function(e){e.localMainSequence=0}))}},{key:"isGroupAttributesUpdatedNotice",value:function(e){var t=e.to,n=e.elements.newGroupProfile,o=!Ql(n)&&!Hd(n.groupAttributeOption);return o&&this._onGroupAttributesUpdated({groupID:t,groupAttributeOption:n.groupAttributeOption}),o}},{key:"_onGroupAttributesUpdated",value:function(e){var t=this,n=e.groupID,o=e.groupAttributeOption,r=o.mainSequence,i=o.isWithChangedAttributeInfo,a=o.groupAttributeList,s=void 0===a?[]:a,u=o.operationType;if(Pl.l("".concat(this._n,".onGroupAttributesUpdated. ")+"groupID:".concat(n," isWithChangedAttributeInfo:").concat(i," operationType:").concat(u)),!Ql(u)){if(1===i)return this._refreshCachedGroupAttributes({groupID:n,remoteMainSequence:r,groupAttributeList:s,operationType:u}),void this._emitGroupAttributesUpdated(n);if(this._hasLocalGroupAttributes(n)){var c=this._getLocalGroupAttributes(n).avChatRoomKey;this._getGroupAttributes({groupID:n,avChatRoomKey:c}).then((function(){t._emitGroupAttributesUpdated(n)}))}}}},{key:"initGroupAttributesCache",value:function(e){var t=e.groupID,n=e.avChatRoomKey,o=void 0===n?void 0:n;this._groupAttributesMap.set(t,{lastUpdateTime:0,localMainSequence:0,remoteMainSequence:0,attributes:new Map,avChatRoomKey:o}),Pl.l("".concat(this._n,".initGroupAttributesCache groupID:").concat(t," avChatRoomKey:").concat(o))}},{key:"initGroupAttributes",value:function(e){var t=this,n=e.groupID,o=e.groupAttributes,r=this._getLocalGroupAttributes(n),i=r.remoteMainSequence,a=r.avChatRoomKey,s=new s_("initGroupAttributes");return s.setMessage("groupID:".concat(n," avChatRoomKey:").concat(a," mainSequence:").concat(i)),this._groupModule.request({protocolName:Ig,requestData:{groupID:n,avChatRoomKey:a,mainSequence:i,groupAttributeList:this._transformGroupAttributes(o)}}).then((function(e){var r=e.data,i=r.mainSequence,a=y(r.groupAttributeList);return a.forEach((function(e){e.value=o[e.key]})),t._refreshCachedGroupAttributes({groupID:n,remoteMainSequence:i,groupAttributeList:a,operationType:iC}),s.setNetworkType(t._groupModule.getNetworkType()).end(),Pl.l("".concat(t._n,".").concat("initGroupAttributes"," ok. groupID:").concat(n)),dI({groupAttributes:o})})).catch((function(e){return t._groupModule.probeNetwork().then((function(t){var n=_(t,2),o=n[0],r=n[1];s.setError(e,o,r).end()})),vI(e)}))}},{key:"setGroupAttributes",value:function(e){var t=this,n="".concat(this._n,".").concat("setGroupAttributes"),o=e.groupID,r=e.groupAttributes,i=this._getLocalGroupAttributes(o),a=i.remoteMainSequence,s=i.avChatRoomKey,u=i.attributes,c=this._transformGroupAttributes(r);c.forEach((function(e){var t=e.key;e.sequence=0,u.has(t)&&(e.sequence=u.get(t).sequence)}));var l=new s_("setGroupAttributes");return l.setMessage("groupID:".concat(o," groupAttributes:").concat(JSON.stringify(r))),Pl.l("".concat(n,". groupID:").concat(o," mainSequence:").concat(a)),this._groupModule.request({protocolName:Cg,requestData:{groupID:o,avChatRoomKey:s,mainSequence:a,groupAttributeList:c}}).then((function(e){var i=e.data,a=i.mainSequence,s=y(i.groupAttributeList);return s.forEach((function(e){e.value=r[e.key]})),t._refreshCachedGroupAttributes({groupID:o,remoteMainSequence:a,groupAttributeList:s,operationType:aC}),l.setNetworkType(t._groupModule.getNetworkType()).end(),Pl.l("".concat(n," ok.")),dI({groupAttributes:r})})).catch((function(e){return t._groupModule.probeNetwork().then((function(t){var n=_(t,2),o=n[0],r=n[1];l.setError(e,o,r).end()})),vI(e)}))}},{key:"deleteGroupAttributes",value:function(e){var t=this,n=e.groupID,o=e.keyList,r=void 0===o?[]:o,i=this._getLocalGroupAttributes(n),a=i.remoteMainSequence,s=i.avChatRoomKey,u=i.attributes,c=y(u.keys()),l=Tg,d=sC,p={groupID:n,avChatRoomKey:s,mainSequence:a},f=[];r.length>0&&(c=[],l=kg,d=uC,r.forEach((function(e){var t=0;u.has(e)&&(t=u.get(e).sequence,c.push(e)),f.push({key:e,sequence:t})})),p.groupAttributeList=f);var h=new s_("deleteGroupAttributes");return h.setMessage("groupID:".concat(n," mainSequence:").concat(a," keyList:").concat(r," protocolName:").concat(l)),this._groupModule.request({protocolName:l,requestData:p}).then((function(e){var o=e.data.mainSequence;return t._refreshCachedGroupAttributes({groupID:n,remoteMainSequence:o,groupAttributeList:f,operationType:d}),h.setNetworkType(t._groupModule.getNetworkType()).end(),Pl.l("".concat(t._n,".").concat("deleteGroupAttributes"," ok. groupID:").concat(n)),dI({keyList:c})})).catch((function(e){return t._groupModule.probeNetwork().then((function(t){var n=_(t,2),o=n[0],r=n[1];h.setError(e,o,r).end()})),vI(e)}))}},{key:"getGroupAttributes",value:function(e){var t=this,n="".concat(this._n,".").concat("getGroupAttributes"),o=e.groupID,r=this._getLocalGroupAttributes(o),i=r.avChatRoomKey,a=r.lastUpdateTime,s=r.localMainSequence,u=r.remoteMainSequence,c=new s_("getGroupAttributes");if(c.setMessage("groupID:".concat(o," localMainSequence:").concat(s," remoteMainSequence:").concat(u," keyList:").concat(e.keyList)),Date.now()-a>=this.CACHE_EXPIRE_TIME||s<u)return this._getGroupAttributes({groupID:o,avChatRoomKey:i}).then((function(r){c.setMoreMessage("get attributes from remote. count:".concat(r.length)).setNetworkType(t._groupModule.getNetworkType()).end(),Pl.l("".concat(n," from remote. groupID:").concat(o));var i=t._getCachedAttributes(e);return dI({groupAttributes:i})})).catch((function(e){return t._groupModule.probeNetwork().then((function(t){var n=_(t,2),o=n[0],r=n[1];c.setError(e,o,r).end()})),vI(e)}));c.setMoreMessage("get attributes from cache").setNetworkType(this._groupModule.getNetworkType()).end(),Pl.l("".concat(n," from cache. groupID:").concat(o));var l=this._getCachedAttributes(e);return gI({groupAttributes:l})}},{key:"_getGroupAttributes",value:function(e){var n=this,o=0;return Ql(e.avChatRoomKey)||(o=1),this._groupModule.request({protocolName:Sg,requestData:t(t({},e),{},{groupType:o})}).then((function(t){var o=t.data,r=o.mainSequence,i=o.groupAttributeList,a=y(i);return Ql(r)||n._refreshCachedGroupAttributes({groupID:e.groupID,remoteMainSequence:r,groupAttributeList:a,operationType:cC}),Pl.l("".concat(n._n,"._getGroupAttributes ok. groupID:").concat(e.groupID)),i})).catch((function(e){return vI(e)}))}},{key:"_refreshCachedGroupAttributes",value:function(e){var t=e.groupID,n=e.remoteMainSequence,o=e.groupAttributeList,r=e.operationType;if(this._hasLocalGroupAttributes(t)){var i=this._getLocalGroupAttributes(t),a=i.localMainSequence;if(r===cC||n-a==1)i.remoteMainSequence=n,i.localMainSequence=n,i.lastUpdateTime=Date.now(),this._updateCachedAttributes({groupAttributes:i,groupAttributeList:o,operationType:r});else{if(a===n)return;i.remoteMainSequence=n}this._groupAttributesMap.set(t,i);var s="operationType:".concat(r," localMainSequence:").concat(a," remoteMainSequence:").concat(n);Pl.l("".concat(this._n,"._refreshCachedGroupAttributes. ").concat(s))}}},{key:"_getCachedAttributes",value:function(e){var t=e.groupID,n=e.keyList,o=void 0===n?[]:n,r={};if(this._hasLocalGroupAttributes(t)){var i=this._getLocalGroupAttributes(t).attributes;if(o.length>0)o.forEach((function(e){i.has(e)&&(r[e]=i.get(e).value)}));else{var a,s=S(i.keys());try{for(s.s();!(a=s.n()).done;){var u=a.value;r[u]=i.get(u).value}}catch(l){s.e(l)}finally{s.f()}}}return r}},{key:"_updateCachedAttributes",value:function(e){var t=e.groupAttributes,n=e.groupAttributeList,o=e.operationType;o!==sC?o!==uC?(o===iC&&t.attributes.clear(),n.forEach((function(e){var n=e.key,o=e.value,r=e.sequence;t.attributes.set(n,{value:o,sequence:r})}))):n.forEach((function(e){t.attributes.delete(e.key)})):t.attributes.clear()}},{key:"_hasLocalGroupAttributes",value:function(e){return this._groupAttributesMap.has(e)}},{key:"_getLocalGroupAttributes",value:function(e){return this._hasLocalGroupAttributes(e)||this.initGroupAttributesCache({groupID:e}),this._groupAttributesMap.get(e)}},{key:"_transformGroupAttributes",value:function(e){var t=[];return Object.keys(e).forEach((function(n){t.push({key:n,value:e[n]})})),t}},{key:"_emitGroupAttributesUpdated",value:function(e){var t=this._getCachedAttributes({groupID:e});this._groupModule.emitOuterEvent(Mr.GROUP_ATTRIBUTES_UPDATED,{groupID:e,groupAttributes:t})}},{key:"deleteLocalGroupAttributes",value:function(e){this._hasLocalGroupAttributes(e)&&this._groupAttributesMap.delete(e)}},{key:"reset",value:function(){this._groupAttributesMap.clear(),this.CACHE_EXPIRE_TIME=3e4}}]),e}(),dC="Set",pC="Increase",fC="Decrease",hC=function(){function e(t){r(this,e),this._groupModule=t,this._n="GroupCountersHandler",this._groupCountersMap=new Map,this.EXPIRE_TIME=3e4,this._groupModule.getInnerEmitterInstance().on(NI,this._onCloudConfigUpdated,this)}return a(e,[{key:"_onCloudConfigUpdated",value:function(){var e=this._groupModule.getCloudConfig("grp_counter_expire_time");Ql(e)||(this.EXPIRE_TIME=Number(e))}},{key:"isGroupCountersNotice",value:function(e){var t=e.to,n=e.elements.groupCounterInfo,o=!1;return Hd(n)||(this._onGroupCountersUpdated({groupID:t,groupCounterInfo:n}),o=!0),o}},{key:"_onGroupCountersUpdated",value:function(e){var t=this,n=e.groupID;e.groupCounterInfo.forEach((function(e){var o=e.type,r=e.groupCounterSeq,i=e.counterList,a=void 0===i?[]:i;0!==o&&2!==o||(t._updateLocalGroupCounters({groupID:n,groupCounterSeq:r,counterList:a}),a.forEach((function(e){t._groupModule.emitOuterEvent(Mr.GROUP_COUNTER_UPDATED,{groupID:n,key:e.key,value:e.value})}))),1===o&&t._deleteLocalGroupCounters({groupID:n,groupCounterSeq:r,counterList:a})})),Pl.l("".concat(this._n,"._onGroupCountersUpdated groupID:").concat(n))}},{key:"initGroupCountersCache",value:function(e){var t=e.groupID,n=e.avChatRoomKey;this._groupCountersMap.set(t,{lastUpdateTime:0,groupCounterSeq:0,counters:new Map,avChatRoomKey:n}),Pl.l("".concat(this._n,".initGroupCountersCache groupID:").concat(t," avChatRoomKey:").concat(n))}},{key:"setGroupCounters",value:function(e){var t=this;if(!this._groupModule.canIUse(Uc.GRP_COUNTER))return vI({code:Bm});var n="".concat(this._n,".setGroupCounters"),o=e.groupID,r=e.counters,i=this._convertObjectToList(r),a=this._getLocalGroupCounters(o).avChatRoomKey,s="groupID:".concat(o," count:").concat(i.length),u=new s_("setGroupCounters");return u.setMessage("".concat(s)),Pl.l("".concat(n,". ").concat(s)),this._updateGroupCounters({groupID:o,counterList:i,avChatRoomKey:a,mode:dC}).then((function(e){return u.end(),Pl.l("".concat(n," ok.")),dI({counters:e})})).catch((function(e){return t._groupModule.probeNetwork().then((function(t){var n=_(t,2),o=n[0],r=n[1];u.setError(e,o,r).end()})),Pl.e("".concat(n," failed. error:"),e),vI(e)}))}},{key:"increaseGroupCounter",value:function(e){var t=this;if(!this._groupModule.canIUse(Uc.GRP_COUNTER))return vI({code:Bm});var n="".concat(this._n,".increaseGroupCounters"),o=e.groupID,r=e.key,i=e.value,a=this._getLocalGroupCounters(o).avChatRoomKey,s="groupID:".concat(o," key:").concat(r," value:").concat(i),u=new s_("increaseGroupCounter");u.setMessage("".concat(s)),Pl.l("".concat(n,". ").concat(s));var c=[{key:r,value:i}];return this._updateGroupCounters({groupID:o,counterList:c,avChatRoomKey:a,mode:pC}).then((function(e){return u.end(),Pl.l("".concat(n," ok.")),dI({counters:e})})).catch((function(e){return t._groupModule.probeNetwork().then((function(t){var n=_(t,2),o=n[0],r=n[1];u.setError(e,o,r).end()})),Pl.e("".concat(n," failed. error:"),e),vI(e)}))}},{key:"decreaseGroupCounter",value:function(e){var t=this;if(!this._groupModule.canIUse(Uc.GRP_COUNTER))return vI({code:Bm});var n="".concat(this._n,".decreaseGroupCounter"),o=e.groupID,r=e.key,i=e.value,a=this._getLocalGroupCounters(o).avChatRoomKey,s="groupID:".concat(o," key:").concat(r," value:").concat(i),u=new s_("decreaseGroupCounter");u.setMessage("".concat(s)),Pl.l("".concat(n,". ").concat(s));var c=[{key:r,value:i}];return this._updateGroupCounters({groupID:o,counterList:c,avChatRoomKey:a,mode:fC}).then((function(e){return u.end(),Pl.l("".concat(n," ok.")),dI({counters:e})})).catch((function(e){return t._groupModule.probeNetwork().then((function(t){var n=_(t,2),o=n[0],r=n[1];u.setError(e,o,r).end()})),Pl.e("".concat(n," failed. error:"),e),vI(e)}))}},{key:"getGroupCounters",value:function(e){var t=this;if(!this._groupModule.canIUse(Uc.GRP_COUNTER))return vI({code:Bm});var n="".concat(this._n,".getGroupCounters"),o=e.groupID,r=e.keyList,i=void 0===r?[]:r,a=this._getLocalGroupCounters(o),s=a.avChatRoomKey,u=a.lastUpdateTime,c=new s_("getGroupCounters");if(c.setMessage("groupID:".concat(o)),Date.now()-u>=this.EXPIRE_TIME)return this._getRemoteGroupCounters({groupID:o,avChatRoomKey:s}).then((function(e){c.setMoreMessage("from remote. count:".concat(e.length)).end(),Pl.l("".concat(n," from remote. groupID:").concat(o));var r=t._getLocalCounters(o,i);return dI({counters:r})})).catch((function(e){return t._groupModule.probeNetwork().then((function(t){var n=_(t,2),o=n[0],r=n[1];c.setError(e,o,r).end()})),vI(e)}));c.setMoreMessage("from cache").end(),Pl.l("".concat(n," from cache. groupID:").concat(o));var l=this._getLocalCounters(o,i);return gI({counters:l})}},{key:"_getRemoteGroupCounters",value:function(e){var n=this;return this._groupModule.request({protocolName:Lg,requestData:t({},e)}).then((function(t){var o=t.data,r=o.counterList,i=void 0===r?[]:r,a=o.groupCounterSeq;return n._updateLocalGroupCounters({groupID:e.groupID,counterList:i,groupCounterSeq:a}),Pl.l("".concat(n._n,"._getRemoteGroupCounters ok. groupID:").concat(e.groupID)),i})).catch((function(e){return vI(e)}))}},{key:"_convertObjectToList",value:function(e){var t=[];return Object.keys(e).forEach((function(n){t.push({key:n,value:e[n]})})),t}},{key:"_updateGroupCounters",value:function(e){var n="".concat(this._n,"._updateGroupCounters"),o=e.groupID,r=e.avChatRoomKey,i=e.mode;return Pl.l("".concat(n,". groupID:").concat(o," avChatRoomKey:").concat(r," mode:").concat(i)),this._groupModule.request({protocolName:Ag,requestData:t({},e)}).then((function(e){Pl.l("".concat(n," ok."));var t=e.data.counterList,o={};return(void 0===t?[]:t).forEach((function(e){var t=e.key,n=e.value;o[t]=n})),o})).catch((function(e){return vI(e)}))}},{key:"_hasLocalGroupCounters",value:function(e){return this._groupCountersMap.has(e)}},{key:"_getLocalGroupCounters",value:function(e){return this._hasLocalGroupCounters(e)||this.initGroupCountersCache({groupID:e}),this._groupCountersMap.get(e)}},{key:"_updateLocalGroupCounters",value:function(e){var t=e.groupID,n=e.counterList,o=void 0===n?[]:n,r=e.groupCounterSeq;if(this._hasLocalGroupCounters(t)){var i=this._getLocalGroupCounters(t),a=i.counters,s=i.avChatRoomKey,u=i.groupCounterSeq;if(r>0&&r<u)return;o.forEach((function(e){var t=e.key,n=e.value;a.set(t,n)})),this._groupCountersMap.set(t,{lastUpdateTime:Date.now(),groupCounterSeq:r,counters:a,avChatRoomKey:s})}}},{key:"_deleteLocalGroupCounters",value:function(e){var t=e.groupID,n=e.counterList,o=void 0===n?[]:n,r=e.groupCounterSeq;if(this._hasLocalGroupCounters(t)){var i=this._getLocalGroupCounters(t),a=i.counters,s=i.avChatRoomKey;o.forEach((function(e){a.delete(e.key)})),this._groupCountersMap.set(t,{lastUpdateTime:Date.now(),groupCounterSeq:r,counters:a,avChatRoomKey:s})}}},{key:"_getLocalCounters",value:function(e,t){var n={};if(!this._hasLocalGroupCounters(e))return n;var o=this._getLocalGroupCounters(e).counters;if(t.length>0)t.forEach((function(e){o.has(e)&&(n[e]=o.get(e))}));else{var r,i=S(o.keys());try{for(i.s();!(r=i.n()).done;){var a=r.value;n[a]=o.get(a)}}catch(u){i.e(u)}finally{i.f()}}return n}},{key:"reset",value:function(){this._groupCountersMap.clear(),this.EXPIRE_TIME=3e4}}]),e}(),gC=function(){function e(t){r(this,e);var n=t.manager,o=t.groupID,i=t.onInit,a=t.onSuccess,s=t.onFail;this._n="Polling",this._manager=n,this._groupModule=n._groupModule,this._onInit=i,this._onSuccess=a,this._onFail=s,this._groupID=o,this._timeoutID=-1,this._isRunning=!1,this._protocolName=vg}return a(e,[{key:"start",value:function(){var e=this._groupModule.isLoggedIn();e||(this._protocolName=mg),Pl.l("".concat(this._n,".start pollingInterval:").concat(this._manager.getPollingInterval()," isLoggedIn:").concat(e)),this._isRunning=!0,this._request()}},{key:"isRunning",value:function(){return this._isRunning}},{key:"_request",value:function(){var e=this,t=this._onInit(this._groupID);this._groupModule.request({protocolName:this._protocolName,requestData:t}).then((function(t){e._onSuccess(e._groupID,t),e.isRunning()&&(clearTimeout(e._timeoutID),e._timeoutID=setTimeout(e._request.bind(e),e._manager.getPollingInterval()))})).catch((function(t){e._onFail(e._groupID,t),e.isRunning()&&(clearTimeout(e._timeoutID),e._timeoutID=setTimeout(e._request.bind(e),e._manager.MAX_POLLING_INTERVAL))}))}},{key:"stop",value:function(){Pl.l("".concat(this._n,".stop")),this._timeoutID>0&&(clearTimeout(this._timeoutID),this._timeoutID=-1),this._isRunning=!1}}]),e}(),vC={3:!0,4:!0,5:!0,6:!0,17:!0},mC=function(){function e(t){r(this,e),this._groupModule=t,this._n="AVChatRoomHandler",this._joinedGroupMap=new Map,this._pollingRequestInfoMap=new Map,this._pollingInstanceMap=new Map,this.sequencesLinkedList=new jI(200),this.messageIDLinkedList=new jI(100),this.receivedMessageCount=0,this._reportMessageStackedCount=0,this._onlineMemberCountMap=new Map,this.DEFAULT_EXPIRE_TIME=60,this.DEFAULT_POLLING_INTERVAL=300,this.MAX_POLLING_INTERVAL=2e3,this._pollingInterval=this.DEFAULT_POLLING_INTERVAL,this.DEFAULT_POLLING_NO_MESSAGE_COUNT=20,this.DEFAULT_POLLING_INTERVAL_PLUS=2e3,this._pollingNoMessageCount=0,this._startBroadcastSeq=1,this._broadcastMessageIDMap=new Map}return a(e,[{key:"hasJoinedAVChatRoom",value:function(){return this._joinedGroupMap.size>0}},{key:"checkJoinedAVChatRoomByID",value:function(e){return this._joinedGroupMap.has(e)}},{key:"getJoinedAVChatRoom",value:function(){return this._joinedGroupMap.size>0?y(this._joinedGroupMap.keys()):null}},{key:"_updateRequestData",value:function(e){var n=this._pollingRequestInfoMap.get(e);return e===y(this._pollingInstanceMap.keys())[0]?t(t({},n),{},{startBroadcastSeq:this._startBroadcastSeq}):t({},n)}},{key:"_handleSuccess",value:function(e,t){var n=t.data,o=n.key,r=n.nextSeq,i=n.rspMsgList,a=n.errorCode,s=n.nextBroadcastSeq,u=n.broadcastMessageList;if(0!==a){var c=this._pollingRequestInfoMap.get(e),l=new s_("longPollingAVError"),d=c?"".concat(c.key,"-").concat(c.startSeq):"requestInfo is undefined";l.setMessage("".concat(e,"-").concat(d,"-").concat(t.errorInfo)).setCode(t.errorCode).setNetworkType(this._groupModule.getNetworkType()).end(!0)}else{if(!this.checkJoinedAVChatRoomByID(e))return;Yl(o)&&Wl(r)&&this._pollingRequestInfoMap.set(e,{key:o,startSeq:r}),Wl(s)&&s>this._startBroadcastSeq&&(this._startBroadcastSeq=s),$l(i)&&i.length>0?(i.forEach((function(e){e.to=e.groupID})),this.onMessage(i)):(this._pollingNoMessageCount+=1,this._pollingNoMessageCount===this.DEFAULT_POLLING_NO_MESSAGE_COUNT&&(this._pollingInterval=this.DEFAULT_POLLING_INTERVAL+this.DEFAULT_POLLING_INTERVAL_PLUS)),this._onBroadcastMessage(u)}}},{key:"_handleFailure",value:function(e,t){}},{key:"onMessage",value:function(e){if($l(e)&&0!==e.length){0!==this._pollingNoMessageCount&&(this._pollingNoMessageCount=0,this._pollingInterval=this.DEFAULT_POLLING_INTERVAL);var t=null,n=[],o=this._getModule(Vf),r=this._getModule(oh),i=e.length;i>1&&e.sort((function(e,t){return e.sequence-t.sequence}));for(var a=this._getModule(Hf),s=0;s<i;s++)if(vC[e[s].event]){if(6===e[s].event){if(this._groupModule.isGroupAttributesUpdatedNotice(e[s]))continue;if(this._groupModule.isGroupCountersNotice(e[s]))continue}this.receivedMessageCount+=1,t=this.packMessage(e[s],e[s].event);var u=1===e[s].isModified,c=1===e[s].isHistoryMessage;if((a.isUnlimitedAVChatRoom()||!this.sequencesLinkedList.has(t.sequence))&&!this.messageIDLinkedList.has(t.ID)){var l=t.conversationID;if(this.receivedMessageCount%50==0?this._getModule(Qf).detectFirstRound(l,this.sequencesLinkedList.data()):this.receivedMessageCount%80==0&&this._getModule(Qf).detectSecondRound(l,this.sequencesLinkedList.data()),null!==this.sequencesLinkedList.tail()){var d=this.sequencesLinkedList.tail().value,p=t.sequence-d;p>1&&p<=20?this._getModule(Qf).onMessageMaybeLost(l,d+1,p-1):p<-1&&p>=-20&&this._getModule(Qf).onMessageMaybeLost(l,t.sequence+1,Math.abs(p)-1)}this.sequencesLinkedList.set(t.sequence),this.messageIDLinkedList.set(t.ID);var f=!1;if(this._isMessageSentByCurrentInstance(t)?u&&(f=!0,t.isModified=u,o.updateMessageIsModifiedProperty(t)):f=!0,f){if(t.conversationType===Ir.CONV_SYSTEM&&5===t.payload.operationType&&this._onGroupDismissed(t.payload.groupProfile.groupID),!c&&t.conversationType!==Ir.CONV_SYSTEM){var h=t.conversationID.replace(Ir.CONV_GROUP,"");this._pollingInstanceMap.has(h)?this._groupModule.isLoggedIn()&&r.addMessageSequence({key:n_,message:t}):(t.type!==Ir.MSG_GRP_TIP&&t.clientTime>0&&r.addMessageDelay(t.clientTime),r.addMessageSequence({key:t_,message:t}))}n.push(t)}}}else Pl.w("".concat(this._n,".onMessage unknown event:").concat(e[s].event));if(0!==n.length){this._groupModule.filterModifiedMessage(n);var g=this.packConversationOption(n);g.length>0&&this._getModule(Vf).onNewMessage({conversationOptionsList:g,isInstantMessage:!0}),Pl.d("".concat(this._n,".onMessage count:").concat(n.length)),this._checkMessageStacked(n);var v=this._groupModule.filterUnmodifiedMessage(n);v.length>0&&this._groupModule.emitOuterEvent(Mr.MESSAGE_RECEIVED,v),n.length=0}}}},{key:"_onGroupDismissed",value:function(e){Pl.l("".concat(this._n,"._onGroupDismissed groupID:").concat(e)),this._groupModule.deleteLocalGroupAndConversation(e),this.reset(e)}},{key:"_checkMessageStacked",value:function(e){var t="MessageStacked",n=e.length;n>=100&&(this._groupModule.outputWarning(t),this._reportMessageStackedCount<5&&(new s_(t).setNetworkType(this._groupModule.getNetworkType()).setMessage("count:".concat(n," groupID:").concat(y(this._joinedGroupMap.keys()))).setLevel("warning").end(),this._reportMessageStackedCount+=1))}},{key:"_isMessageSentByCurrentInstance",value:function(e){return!!this._getModule(Vf).isMessageSentByCurrentInstance(e)}},{key:"packMessage",value:function(e,t){e.currentUser=this._groupModule.getMyUserID(),e.conversationType=5===t?Ir.CONV_SYSTEM:Ir.CONV_GROUP,e.isSystemMessage=!!e.isSystemMessage;var n=new lI(e),o=this.packElements(e,t);return n.setElement(o),n}},{key:"packElements",value:function(e,n){return 4===n||6===n?(this._updateMemberCountByGroupTips(e),{type:Ir.MSG_GRP_TIP,content:t(t({},e.elements),{},{groupProfile:e.groupProfile})}):5===n?{type:Ir.MSG_GRP_SYS_NOTICE,content:t(t({},e.elements),{},{groupProfile:t(t({},e.groupProfile),{},{groupID:e.groupID})})}:this._getModule(Zf).parseElements(e.elements,e.from)}},{key:"packConversationOption",value:function(e){for(var t=new Map,n=0;n<e.length;n++){var o=e[n],r=o.conversationID;if(t.has(r)){var i=t.get(r);i.lastMessage=o,"in"===o.flow&&i.unreadCount++}else t.set(r,{conversationID:o.conversationID,unreadCount:"out"===o.flow?0:1,type:o.conversationType,subType:o.conversationSubType,lastMessage:o})}return y(t.values())}},{key:"_updateMemberCountByGroupTips",value:function(e){var t=e.groupProfile.groupID,n=e.elements.onlineMemberInfo,o=void 0===n?void 0:n;if(!Hd(o)){var r=o.onlineMemberNum,i=void 0===r?0:r,a=o.expireTime,s=void 0===a?this.DEFAULT_EXPIRE_TIME:a,u=this._onlineMemberCountMap.get(t)||{},c=Date.now();Hd(u)?Object.assign(u,{lastReqTime:0,lastSyncTime:0,latestUpdateTime:c,memberCount:i,expireTime:s}):(u.latestUpdateTime=c,u.memberCount=i),Pl.d("".concat(this._n,"._updateMemberCountByGroupTips info:"),u),this._onlineMemberCountMap.set(t,u)}}},{key:"_onBroadcastMessage",value:function(e){if(!Hd(e)){for(var t=[],n=e.length,o=null,r=0;r<n;r++)vC[e[r].event]?((o=this.packMessage(e[r],e[r].event)).isBroadcastMessage=!0,this._broadcastMessageIDMap.has(o.ID)||(t.push(o),this._broadcastMessageIDMap.set(o.ID,1))):Pl.w("".concat(this._n,"._onBroadcastMessage unknown event:").concat(e[r].event));t.length>0&&this._groupModule.emitOuterEvent(Mr.MESSAGE_RECEIVED,t)}}},{key:"start",value:function(e){if(this._pollingInstanceMap.has(e)){var t=this._pollingInstanceMap.get(e);t.isRunning()||t.start()}else{var n=new gC({manager:this,groupID:e,onInit:this._updateRequestData.bind(this),onSuccess:this._handleSuccess.bind(this),onFail:this._handleFailure.bind(this)});n.start(),this._pollingInstanceMap.set(e,n),Pl.l("".concat(this._n,".start groupID:").concat(e))}}},{key:"handleJoinResult",value:function(e){var t=this;return this._preCheck().then((function(){var n=e.longPollingKey,o=e.group,r=o.groupID;return t._joinedGroupMap.set(r,o),t._groupModule.updateGroupMap([o]),t._groupModule.deleteUnjoinedAVChatRoom(r),t._groupModule.emitGroupListUpdate(!0,!1),Ql(n)?gI({status:Bl,group:o}):Promise.resolve()}))}},{key:"startRunLoop",value:function(e){var t=this;return this.handleJoinResult(e).then((function(){var n=e.longPollingKey,o=e.group,r=e.startSeq,i=void 0===r?0:r,a=o.groupID;return t._pollingRequestInfoMap.set(a,{key:n,startSeq:i}),t.start(a),t._groupModule.isLoggedIn()?gI({status:Bl,group:o}):gI({status:Bl})}))}},{key:"_preCheck",value:function(){if(this._getModule(Hf).isUnlimitedAVChatRoom())return Promise.resolve();if(!this.hasJoinedAVChatRoom())return Promise.resolve();var e=_(this._joinedGroupMap.entries().next().value,2),t=e[0],n=e[1];if(this._groupModule.isLoggedIn()){if(n.selfInfo.role!==Ir.GRP_MBR_ROLE_OWNER&&n.ownerID!==this._groupModule.getMyUserID())return this._groupModule.quitGroup(t);this._groupModule.deleteLocalGroupAndConversation(t)}else this._groupModule.deleteLocalGroupAndConversation(t);return this.reset(t),Promise.resolve()}},{key:"joinWithoutAuth",value:function(e){var t=this,n=e.groupID,o="".concat(this._n,".").concat("joinWithoutAuth"),r=new s_("joinWithoutAuth");return this._groupModule.request({protocolName:eg,requestData:e}).then((function(e){var i=e.data.longPollingKey;if(t._groupModule.probeNetwork().then((function(e){var t=_(e,2),o=(t[0],t[1]);r.setNetworkType(o).setMessage("groupID:".concat(n," longPollingKey:").concat(i)).end(!0)})),Ql(i))return vI({code:hm});Pl.l("".concat(o," ok. groupID:").concat(n)),t._getModule(Vf).setCompleted("".concat(Ir.CONV_GROUP).concat(n));var a=new ZI({groupID:n});return t.startRunLoop({group:a,longPollingKey:i}),dI({status:Bl})})).catch((function(e){return Pl.e("".concat(o," failed. groupID:").concat(n," error:"),e),t._groupModule.probeNetwork().then((function(t){var o=_(t,2),i=o[0],a=o[1];r.setError(e,i,a).setMessage("groupID:".concat(n)).end(!0)})),vI(e)})).finally((function(){t._groupModule.getModule(jf).reportAtOnce()}))}},{key:"getGroupOnlineMemberCount",value:function(e){var t=this._onlineMemberCountMap.get(e)||{},n=Date.now();return Hd(t)||n-t.lastSyncTime>1e3*t.expireTime&&n-t.latestUpdateTime>1e4&&n-t.lastReqTime>3e3?(t.lastReqTime=n,this._onlineMemberCountMap.set(e,t),this._getGroupOnlineMemberCount(e).then((function(e){return dI({memberCount:e.memberCount})})).catch((function(e){return vI(e)}))):gI({memberCount:t.memberCount})}},{key:"_getGroupOnlineMemberCount",value:function(e){var t=this,n="".concat(this._n,".").concat("_getGroupOnlineMemberCount");return this._groupModule.request({protocolName:_g,requestData:{groupID:e}}).then((function(o){var r=t._onlineMemberCountMap.get(e)||{},i=o.data,a=i.onlineMemberNum,s=void 0===a?0:a,u=i.expireTime,c=void 0===u?t.DEFAULT_EXPIRE_TIME:u;Pl.l("".concat(n," ok. groupID:").concat(e," memberCount:").concat(s," expireTime:").concat(c));var l=Date.now();return Hd(r)&&(r.lastReqTime=l),t._onlineMemberCountMap.set(e,Object.assign(r,{lastSyncTime:l,latestUpdateTime:l,memberCount:s,expireTime:c})),{memberCount:s}})).catch((function(o){return Pl.w("".concat(n," failed. error:"),o),new s_("_getGroupOnlineMemberCount").setCode(o.code).setMessage("groupID:".concat(e," error:").concat(JSON.stringify(o))).setNetworkType(t._groupModule.getNetworkType()).end(),Promise.reject(o)}))}},{key:"_getModule",value:function(e){return this._groupModule.getModule(e)}},{key:"setPollingInterval",value:function(e){Ql(e)||(Wl(e)?this._pollingInterval=this.DEFAULT_POLLING_INTERVAL=e:this._pollingInterval=this.DEFAULT_POLLING_INTERVAL=parseInt(e,10))}},{key:"setPollingIntervalPlus",value:function(e){Ql(e)||(Wl(e)?this.DEFAULT_POLLING_INTERVAL_PLUS=e:this.DEFAULT_POLLING_INTERVAL_PLUS=parseInt(e,10))}},{key:"setPollingNoMessageCount",value:function(e){Ql(e)||(Wl(e)?this.DEFAULT_POLLING_NO_MESSAGE_COUNT=e:this.DEFAULT_POLLING_NO_MESSAGE_COUNT=parseInt(e,10))}},{key:"getPollingInterval",value:function(){return this._pollingInterval}},{key:"onAVChatRoomMemberBanned",value:function(e){var t=e.payload.groupProfile.groupID;Pl.l("".concat(this._n,".onAVChatRoomMemberBanned groupID:").concat(t)),this._groupModule.deleteLocalGroupAndConversation(t),this.reset(t)}},{key:"restartPolling",value:function(){Pl.l("".concat(this._n,".restartPolling count:").concat(this._pollingInstanceMap.size));var e,t=S(this._pollingInstanceMap.values());try{for(t.s();!(e=t.n()).done;){var n=e.value;n.stop(),n.start()}}catch(r){t.e(r)}finally{t.f()}}},{key:"reset",value:function(e){if(e){Pl.l("".concat(this._n,".reset groupID:").concat(e));var t=this._pollingInstanceMap.get(e);t&&t.stop(),this._pollingInstanceMap.delete(e),this._joinedGroupMap.delete(e),this._pollingRequestInfoMap.delete(e),this._onlineMemberCountMap.delete(e)}else{Pl.l("".concat(this._n,".reset all"));var n,o=S(this._pollingInstanceMap.values());try{for(o.s();!(n=o.n()).done;)n.value.stop()}catch(i){o.e(i)}finally{o.f()}this._pollingInstanceMap.clear(),this._joinedGroupMap.clear(),this._pollingRequestInfoMap.clear(),this._onlineMemberCountMap.clear(),this._broadcastMessageIDMap.clear()}this.sequencesLinkedList.reset(),this.messageIDLinkedList.reset(),this.receivedMessageCount=0,this._reportMessageStackedCount=0,this._pollingInterval=this.DEFAULT_POLLING_INTERVAL=300,this.DEFAULT_POLLING_NO_MESSAGE_COUNT=20,this.DEFAULT_POLLING_INTERVAL_PLUS=2e3,this._pollingNoMessageCount=0}}]),e}(),_C=1,yC=15,MC=function(){function e(t){r(this,e),this._groupModule=t,this._n="GroupSystemNoticeHandler",this.pendencyMap=new Map}return a(e,[{key:"onNewGroupSystemNotice",value:function(e){var t=e.dataList,n=e.isSyncingEnded,o=e.isInstantMessage;Pl.d("".concat(this._n,".onReceiveSystemNotice count:").concat(t.length));var r=this.newSystemNoticeStoredAndSummary({notifiesList:t,isInstantMessage:o}),i=r.eventDataList,a=r.result;i.length>0&&(this._groupModule.getModule(Vf).onNewMessage({conversationOptionsList:i,isInstantMessage:o}),this._onReceivedGroupSystemNotice({result:a,isInstantMessage:o})),o?a.length>0&&this._groupModule.emitOuterEvent(Mr.MESSAGE_RECEIVED,a):!0===n&&this._clearGroupSystemNotice()}},{key:"newSystemNoticeStoredAndSummary",value:function(e){var n=e.notifiesList,o=e.isInstantMessage,r=null,i=n.length,a=0,s=[],u={conversationID:Ir.CONV_SYSTEM,unreadCount:0,type:Ir.CONV_SYSTEM,subType:null,lastMessage:null};for(a=0;a<i;a++){var c=n[a],l=c.groupProfile,d=l.communityType,p=void 0===d?0:d,f=l.topicID,h=void 0===f?void 0:f,g=c.elements,v=g.topicIDList,m=void 0===v?void 0:v,_=g.operationType;if(!(2!==p||Hd(h)&&Hd(m))){if([17,18,20].includes(_)){this._handleTopicSystemNotice(c);continue}Hd(h)||(c.to=h)}c.elements.operationType!==yC&&(c.currentUser=this._groupModule.getMyUserID(),c.conversationType=Ir.CONV_SYSTEM,c.conversationID=Ir.CONV_SYSTEM,(r=new lI(c)).setElement({type:Ir.MSG_GRP_SYS_NOTICE,content:t(t({},c.elements),{},{groupProfile:t({},c.groupProfile)})}),r.isSystemMessage=!0,(1===r.sequence&&1===r.random||2===r.sequence&&2===r.random)&&(r.sequence=ld(),r.random=ld(),r.generateMessageID(),Pl.l("".concat(this._n,".newSystemNoticeStoredAndSummary sequence and random maybe duplicated, regenerate. ID:").concat(r.ID))),this._groupModule.getModule(Vf).pushIntoNoticeResult(s,r)&&(o?u.unreadCount++:r.setIsRead(!0),u.subType=r.conversationSubType))}return u.lastMessage=s[s.length-1],{eventDataList:s.length>0?[u]:[],result:s}}},{key:"_clearGroupSystemNotice",value:function(){var e=this;this._getPendencyList().then((function(t){t.forEach((function(t){e.pendencyMap.set("".concat(t.from,"_").concat(t.groupID,"_").concat(t.to),t)}));var n=e._groupModule.getModule(Vf).getLocalMessageList(Ir.CONV_SYSTEM),o=[];n.forEach((function(t){var n=t.payload,r=n.operatorID,i=n.operationType,a=n.groupProfile;if(i===_C){var s="".concat(r,"_").concat(a.groupID,"_").concat(a.to),u=e.pendencyMap.get(s);u&&Wl(u.handled)&&0!==u.handled&&o.push(t)}})),e.deleteGroupSystemNotice({messageList:o})}))}},{key:"deleteGroupSystemNotice",value:function(e){var t=this,n="".concat(this._n,".deleteGroupSystemNotice");return $l(e.messageList)&&0!==e.messageList.length?(Pl.l("".concat(n," ")+e.messageList.map((function(e){return e.ID}))),this._groupModule.request({protocolName:gg,requestData:{messageListToDelete:e.messageList.map((function(e){return{from:Ir.CONV_SYSTEM,messageSeq:e.clientSequence,messageRandom:e.random}}))}}).then((function(){Pl.l("".concat(n," ok"));var o=t._groupModule.getModule(Vf);return e.messageList.forEach((function(e){o.deleteLocalMessage(e)})),dI()})).catch((function(e){return Pl.e("".concat(n," error:"),e),vI(e)}))):gI()}},{key:"_getPendencyList",value:function(e){var t=this;return this._groupModule.request({protocolName:hg,requestData:{startTime:e&&e.startTime?e.startTime:0,limit:e&&e.limit?e.limit:10,handleAccount:this._groupModule.getMyUserID()}}).then((function(e){var n=e.data.pendencyList;return 0!==e.data.nextStartTime?t._getPendencyList({startTime:e.data.nextStartTime}).then((function(e){return[].concat(y(n),y(e))})):n}))}},{key:"getGroupApplicationList",value:function(){var e=this;return this._getPendencyList().then((function(t){var n=[];return t.forEach((function(t){e.pendencyMap.set("".concat(t.from,"_").concat(t.groupID,"_").concat(t.to),t),0===t.handled&&n.push({applicant:t.from,applicantNick:t.fromUserNickName,groupName:t.groupName,groupID:t.groupID,authentication:t.authentication,messageKey:t.time})})),gI({applicationList:n})}))}},{key:"_onReceivedGroupSystemNotice",value:function(e){var t=this,n=e.result;e.isInstantMessage&&n.forEach((function(e){switch(e.payload.operationType){case 1:case 3:case 6:case 11:case 12:case 15:break;case 2:t._onApplyGroupRequestAgreed(e);break;case 4:t._onMemberKicked(e);break;case 5:t._onGroupDismissed(e);break;case 7:t._onInviteGroup(e);break;case 8:t._onQuitGroup(e);break;case 9:t._onSetManager(e);break;case 10:t._onDeleteManager(e);break;case 20:t._onMessageRemindTypeSynced(e);break;case 21:t._groupModule.onAVChatRoomMemberBanned(e)}}))}},{key:"_onApplyGroupRequestAgreed",value:function(e){var t=this,n=e.payload.groupProfile.groupID;this._groupModule.hasLocalGroup(n)||this._groupModule.getGroupProfile({groupID:n}).then((function(e){var n=e.data.group;if(n){t._groupModule.updateGroupMap([n]);var o=!n.isSupportTopic;t._groupModule.emitGroupListUpdate(!0,o)}}))}},{key:"_onMemberKicked",value:function(e){var t=e.payload.groupProfile.groupID;this._groupModule.hasLocalGroup(t)&&this._groupModule.deleteLocalGroupAndConversation(t)}},{key:"_onGroupDismissed",value:function(e){var t=e.payload.groupProfile.groupID;this._groupModule.hasLocalGroup(t)&&this._groupModule.deleteLocalGroupAndConversation(t);var n=this._groupModule._AVChatRoomHandler;n&&n.checkJoinedAVChatRoomByID(t)&&n.reset(t)}},{key:"_onInviteGroup",value:function(e){var t=this,n=e.payload.groupProfile.groupID;this._groupModule.hasLocalGroup(n)||this._groupModule.getGroupProfile({groupID:n}).then((function(e){var n=e.data.group;n&&(t._groupModule.updateGroupMap([n]),t._groupModule.emitGroupListUpdate())}))}},{key:"_onQuitGroup",value:function(e){var t=e.payload.groupProfile.groupID;this._groupModule.hasLocalGroup(t)&&this._groupModule.deleteLocalGroupAndConversation(t)}},{key:"_onSetManager",value:function(e){var t=e.payload.groupProfile,n=t.to,o=t.groupID,r=this._groupModule.getModule(qf).getLocalGroupMemberInfo(o,n);r&&r.updateRole(Ir.GRP_MBR_ROLE_ADMIN)}},{key:"_onDeleteManager",value:function(e){var t=e.payload.groupProfile,n=t.to,o=t.groupID,r=this._groupModule.getModule(qf).getLocalGroupMemberInfo(o,n);r&&r.updateRole(Ir.GRP_MBR_ROLE_MEMBER)}},{key:"_onMessageRemindTypeSynced",value:function(e){var t=e.payload.groupProfile.groupID,n=e.payload.messageRemindType;this._groupModule.getModule(Vf).onGroupMessageRemindTypeSynced({groupID:t,messageRemindType:n})}},{key:"_handleTopicSystemNotice",value:function(e){var t=e.groupProfile,n=t.groupID,o=t.topicID,r=e.elements,i=r.operationType,a=r.topicIDList,s=r.messageRemindType,u=this._groupModule.getModule(Bf);17===i?u.onTopicCreated({groupID:n,topicID:o}):18===i?u.onTopicDeleted({groupID:n,topicIDList:a}):20===i&&u.onTopicMessageRemindTypeUpdated({groupID:n,topicID:o,messageRemindType:s})}},{key:"reset",value:function(){this.pendencyMap.clear()}}]),e}(),IC=["relayFlag"],CC=function(e){u(o,e);var n=m(o);function o(e){var t;return r(this,o),(t=n.call(this,e))._n="GroupModule",t._commonGroupHandler=null,t._AVChatRoomHandler=null,t._groupSystemNoticeHandler=null,t._commonGroupHandler=new rC(g(t)),t._groupAttributesHandler=new lC(g(t)),t._groupCountersHandler=new hC(g(t)),t._AVChatRoomHandler=new mC(g(t)),t._groupTipsHandler=new oC(g(t)),t._groupSystemNoticeHandler=new MC(g(t)),t.groupMap=new Map,t._unjoinedAVChatRoomList=new Map,t._receiptDetailCompleteMap=new Map,t.getInnerEmitterInstance().on(NI,t._onCloudConfigUpdated,g(t)),t}return a(o,[{key:"_onCloudConfigUpdated",value:function(){var e=this.getCloudConfig("polling_interval"),t=this.getCloudConfig("polling_interval_plus"),n=this.getCloudConfig("polling_no_msg_count");this._AVChatRoomHandler&&(Pl.l("".concat(this._n,"._onCloudConfigUpdated pollingInterval:").concat(e)+" pollingIntervalPlus:".concat(t," pollingNoMessageCount:").concat(n)),this._AVChatRoomHandler.setPollingInterval(e),this._AVChatRoomHandler.setPollingIntervalPlus(t),this._AVChatRoomHandler.setPollingNoMessageCount(n))}},{key:"onCheckTimer",value:function(e){this.isLoggedIn()&&(this._commonGroupHandler.onCheckTimer(e),this._groupTipsHandler.onCheckTimer(e))}},{key:"guardForAVChatRoom",value:function(e){var t=this;if(e.conversationType===Ir.CONV_GROUP){var n=Id(e.to)?Gd(e.to):e.to;return this.hasLocalGroup(n)?gI():this.getGroupProfile({groupID:n}).then((function(o){var r=o.data.group.type;if(Pl.l("".concat(t._n,".guardForAVChatRoom. groupID:").concat(n," type:").concat(r)),r===Ir.GRP_AVCHATROOM){var i=Tv;return vI(new pI({code:i,message:t.getErrorMessage(i,e.from,n),data:{message:e}}))}return gI()}))}return gI()}},{key:"checkJoinedAVChatRoomByID",value:function(e){return!!this._AVChatRoomHandler&&this._AVChatRoomHandler.checkJoinedAVChatRoomByID(e)}},{key:"onNewGroupMessage",value:function(e){this._commonGroupHandler&&this._commonGroupHandler.onNewGroupMessage(e)}},{key:"updateNextMessageSeq",value:function(e){var t=this;if($l(e)){var n=this.getModule(Bf);e.forEach((function(e){var o=e.conversationID.replace(Ir.CONV_GROUP,"");Id(o)&&n.updateLastMessage(o,e.lastMessage),t.groupMap.has(o)&&(t.groupMap.get(o).nextMessageSeq=e.lastMessage.sequence+1)}))}}},{key:"onNewGroupTips",value:function(e){this._groupTipsHandler&&this._groupTipsHandler.onNewGroupTips(e)}},{key:"onGroupMessageRevoked",value:function(e){this._commonGroupHandler&&this._commonGroupHandler.onGroupMessageRevoked(e)}},{key:"onNewGroupSystemNotice",value:function(e){this._groupSystemNoticeHandler&&this._groupSystemNoticeHandler.onNewGroupSystemNotice(e)}},{key:"onGroupMessageReadNotice",value:function(e){var t=this;e.dataList.forEach((function(e){var n=e.elements.groupMessageReadNotice;if(!Ql(n)){var o=t.getModule(Vf);n.forEach((function(e){var n=e.groupID,r=e.topicID,i=void 0===r?void 0:r,a=e.lastMessageSeq;Pl.d("".concat(t._n,".onGroupMessageReadNotice groupID:").concat(n," lastMessageSeq:").concat(a));var s="".concat(Ir.CONV_GROUP).concat(n),u=!0;Hd(i)||(s="".concat(Ir.CONV_GROUP).concat(i),u=!1),o.updateIsReadAfterReadReport({conversationID:s,lastMessageSeq:a}),o.updateUnreadCount(s,u),o.clearGroupAtInfoList(s,u)}))}}))}},{key:"onReadReceiptList",value:function(e){var t=this;Pl.d("".concat(this._n,".onReadReceiptList options:"),JSON.stringify(e)),e.dataList.forEach((function(e){var n=e.groupProfile,o=e.elements,r=n.groupID,i=t.getModule(Vf),a=o.readReceiptList;i.updateReadReceiptInfo({groupID:r,readReceiptList:a})}))}},{key:"onGroupMessageModified",value:function(e){Pl.d("".concat(this._n,".onGroupMessageModified options:"),JSON.stringify(e));var n=this.getModule(Vf);e.dataList.forEach((function(e){n.onMessageModified(t(t({},e),{},{conversationType:Ir.CONV_GROUP,to:e.topicID?e.topicID:e.groupID}))}))}},{key:"deleteGroupSystemNotice",value:function(e){this._groupSystemNoticeHandler&&this._groupSystemNoticeHandler.deleteGroupSystemNotice(e)}},{key:"initGroupMap",value:function(e){this.groupMap.set(e.groupID,new ZI(e))}},{key:"deleteGroup",value:function(e){this.groupMap.delete(e)}},{key:"updateGroupMap",value:function(e){var t,n=this,o=this.getModule(Vf);e.forEach((function(e){t=e.groupID,n.groupMap.has(t)?n.groupMap.get(t).updateGroup(e):(n.groupMap.set(t,new ZI(e)),o.deleteGroupRomaingMessageInfo(t))}));var r,i=this.getMyUserID(),a=S(this.groupMap);try{for(a.s();!(r=a.n()).done;){var s=_(r.value,2)[1];s.selfInfo.userID=i,"Owner"===s.selfInfo.role&&(s.ownerID=i)}}catch(c){a.e(c)}finally{a.f()}this._setStorageGroupList()}},{key:"getStorageGroupList",value:function(){return this.getModule(Kf).getItem("groupMap")}},{key:"_setStorageGroupList",value:function(){var e=this.getLocalGroupList().filter((function(e){var t=e.type;return!yd(t)})).filter((function(e){return!e.isSupportTopic})).slice(0,20).map((function(e){return{groupID:e.groupID,name:e.name,avatar:e.avatar,type:e.type}}));this.getModule(Kf).setItem("groupMap",e)}},{key:"getGroupMap",value:function(){return this.groupMap}},{key:"getLocalGroupList",value:function(){return y(this.groupMap.values())}},{key:"getLocalGroupProfile",value:function(e){return this.groupMap.get(e)}},{key:"sortLocalGroupList",value:function(){var e=y(this.groupMap).filter((function(e){var t=_(e,2);return t[0],!Hd(t[1].lastMessage)}));e.sort((function(e,t){return t[1].lastMessage.lastTime-e[1].lastMessage.lastTime})),this.groupMap=new Map(y(e))}},{key:"updateGroupLastMessage",value:function(e){this._commonGroupHandler&&this._commonGroupHandler.handleUpdateGroupLastMessage(e)}},{key:"emitGroupListUpdate",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this.getLocalGroupList();if(e&&this.emitOuterEvent(Mr.GROUP_LIST_UPDATED),t){var o=JSON.parse(JSON.stringify(n));this.getModule(Vf).updateConversationGroupProfile(o)}}},{key:"patchGroupMessageRemindType",value:function(){var e=this.getLocalGroupList(),t=this.getModule(Vf),n=0;e.forEach((function(e){!0===t.patchMessageRemindType({ID:e.groupID,isC2CConversation:!1,messageRemindType:e.selfInfo.messageRemindType})&&(n+=1)})),Pl.l("".concat(this._n,".patchGroupMessageRemindType count:").concat(n))}},{key:"recomputeUnreadCount",value:function(){var e=this.getLocalGroupList(),t=this.getModule(Vf);e.forEach((function(e){var n=e.groupID,o=e.selfInfo,r=o.excludedUnreadSequenceList,i=o.readedSequence;if($l(r)){var a=0;r.forEach((function(t){t>=i&&t<=e.nextMessageSeq-1&&(a+=1)})),a>=1&&t.recomputeGroupUnreadCount({conversationID:"".concat(Ir.CONV_GROUP).concat(n),count:a})}}))}},{key:"getMyNameCardByGroupID",value:function(e){var t=this.getLocalGroupProfile(e);return t?t.selfInfo.nameCard:""}},{key:"isPagingGetCompleted",value:function(){return!!this._commonGroupHandler&&this._commonGroupHandler.isPagingGetCompleted()}},{key:"getGroupList",value:function(e){return this._commonGroupHandler?this._commonGroupHandler.getGroupList(e):gI()}},{key:"getGroupProfile",value:function(e){var t=this,n="".concat(this._n,".").concat("getGroupProfile"),o=new s_("getGroupProfile"),r=e.groupID,i=e.groupCustomFieldFilter;Pl.l("".concat(n," groupID:").concat(r));var a={groupIDList:[r],responseFilter:{groupBaseInfoFilter:["Type","Name","Introduction","Notification","FaceUrl","Owner_Account","CreateTime","InfoSeq","LastInfoTime","LastMsgTime","MemberNum","MaxMemberNum","ApplyJoinOption","NextMsgSeq","ShutUpAllMember"],groupCustomFieldFilter:i,memberInfoFilter:["Role","JoinTime","MsgSeq","MsgFlag","NameCard"]}};return this.getGroupProfileAdvance(a).then((function(e){var i,a=e.data,s=a.successGroupList,u=a.failureGroupList;return Pl.l("".concat(n," ok")),u.length>0?vI(u[0]):(yd(s[0].type)&&!t.hasLocalGroup(r)?i=new ZI(s[0]):(t.updateGroupMap(s),i=t.getLocalGroupProfile(r)),i.isSupportTopic||t.getModule(Vf).updateConversationGroupProfile([i]),o.setNetworkType(t.getNetworkType()).setMessage("groupID:".concat(r," type:").concat(i.type," muteAllMembers:").concat(i.muteAllMembers," ownerID:").concat(i.ownerID)).end(),dI({group:i}))})).catch((function(r){return t.probeNetwork().then((function(t){var n=_(t,2),i=n[0],a=n[1];o.setError(r,i,a).setMessage("groupID:".concat(e.groupID)).end()})),Pl.e("".concat(n," failed. error:"),r),vI(r)}))}},{key:"getGroupProfileAdvance",value:function(e){var n="".concat(this._n,".getGroupProfileAdvance"),o=e.groupIDList;$l(o)&&o.length>50&&(this.outputWarning("GetGroupProfileLimit"),o.length=50);var r=[],i=[];o.forEach((function(e){Md({groupID:e})?i.push(e):r.push(e)}));var a=[];if(r.length>0){var s=this._getGroupProfileAdvance(t(t({},e),{},{groupIDList:r}));a.push(s)}if(i.length>0){var u=this._getGroupProfileAdvance(t(t({},e),{},{groupIDList:i,relayFlag:r.length>0}));a.push(u)}return Promise.all(a).then((function(e){var t=[],n=[];return e.forEach((function(e){t.push.apply(t,y(e.successGroupList)),n.push.apply(n,y(e.failureGroupList))})),dI({successGroupList:t,failureGroupList:n})})).catch((function(e){return Pl.e("".concat(n," failed. error:"),e),vI(e)}))}},{key:"_getGroupProfileAdvance",value:function(e){var t=this,n=e.relayFlag,o=void 0!==n&&n,r=h(e,IC);return this.request({protocolName:Yh,requestData:r}).then((function(e){Pl.l("".concat(t._n,"._getGroupProfileAdvance ok."));var n=e.data.groups;return{successGroupList:n.filter((function(e){return Ql(e.errorCode)||0===e.errorCode})),failureGroupList:n.filter((function(e){return e.errorCode&&0!==e.errorCode})).map((function(e){return new pI({code:e.errorCode,message:e.errorInfo,data:{groupID:e.groupID}})}))}})).catch((function(t){return o&&Md({groupID:e.groupIDList[0]})?{successGroupList:[],failureGroupList:[]}:vI(t)}))}},{key:"createGroup",value:function(e){var n=this,o="".concat(this._n,".").concat("createGroup"),r=e.type,i=e.groupID;if(e.name&&!1===this._filterProfanity("name",e))return vI({code:Vm});if(e.introduction&&!1===this._filterProfanity("introduction",e))return vI({code:Vm});if(e.notification&&!1===this._filterProfanity("notification",e))return vI({code:Vm});if(!["Public","Private","ChatRoom","AVChatRoom","Community"].includes(r))return vI({code:rm});if(!Md({type:r})){if(!Hd(i)&&Md({groupID:i}))return vI({code:am});e.isSupportTopic=void 0}if(yd(r)&&!Ql(e.memberList)&&e.memberList.length>0&&(e.memberList=void 0),_d(r)||Ql(e.joinOption)||(e.joinOption=void 0),Md({type:r})){if(!Hd(i)&&!Md({groupID:i}))return vI({code:am});e.isSupportTopic=!0===e.isSupportTopic?1:0}var a=new s_("createGroup");Pl.l("".concat(o," options:"),e);var s=null,u=[];return this.request({protocolName:Jh,requestData:t(t({},e),{},{ownerID:this.getMyUserID(),webPushFlag:1})}).then((function(r){var i=r.data,c=i.groupID,l=i.overLimitUserIDList,d=void 0===l?[]:l;if(s=c,u=d,a.setNetworkType(n.getNetworkType()).setMessage("groupType:".concat(e.type," groupID:").concat(c," overLimitUserIDList=").concat(d)).end(),Pl.l("".concat(o," ok groupID:").concat(c," overLimitUserIDList:"),d),e.type===Ir.GRP_AVCHATROOM)return n.getGroupProfile({groupID:c});if(e.type===Ir.GRP_COMMUNITY&&1===e.isSupportTopic)return n.getGroupProfile({groupID:c});Hd(e.memberList)||Hd(d)||(e.memberList=e.memberList.filter((function(e){return-1===d.indexOf(e.userID)}))),n.updateGroupMap([t(t({},e),{},{groupID:c})]);var p=n.getModule(Nf),f=p.createCustomMessage({to:c,conversationType:Ir.CONV_GROUP,payload:{data:"group_create",extension:n.isIntl()?"".concat(n.getMyUserID()," created a group"):"".concat(n.getMyUserID(),"\u521b\u5efa\u7fa4\u7ec4")}});return p.sendMessageInstance(f),n.emitGroupListUpdate(),n.getGroupProfile({groupID:c})})).then((function(e){var t=e.data.group,n=t.selfInfo,o=n.nameCard,r=n.joinTime;return t.updateSelfInfo({nameCard:o,joinTime:r,messageRemindType:Ir.MSG_REMIND_ACPT_AND_NOTE,role:Ir.GRP_MBR_ROLE_OWNER}),dI({group:t,overLimitUserIDList:u})})).catch((function(r){if(a.setMessage("groupType:".concat(e.type)),n.probeNetwork().then((function(e){var t=_(e,2),n=t[0],o=t[1];a.setError(r,n,o).end()})),10010===r.code||10007===r.code){n.updateGroupMap([t(t({},e),{},{groupID:s})]);var i=n.getLocalGroupProfile(s);return Pl.l("".concat(o," success, but failed to get group profile.")),dI({group:i,overLimitUserIDList:u})}return Pl.e("".concat(o," failed. error:"),r),vI(r)}))}},{key:"dismissGroup",value:function(e){var t=this,n="".concat(this._n,".").concat("dismissGroup");if(this.hasLocalGroup(e)&&this.getLocalGroupProfile(e).type===Ir.GRP_WORK)return vI(new pI({code:lm}));var o=new s_("dismissGroup");return o.setMessage("groupID:".concat(e)),Pl.l("".concat(n," groupID:").concat(e)),this.request({protocolName:Xh,requestData:{groupID:e}}).then((function(){return o.setNetworkType(t.getNetworkType()).end(),Pl.l("".concat(n," ok")),t.deleteLocalGroupAndConversation(e),t.checkJoinedAVChatRoomByID(e)&&t._AVChatRoomHandler.reset(e),dI({groupID:e})})).catch((function(e){return t.probeNetwork().then((function(t){var n=_(t,2),r=n[0],i=n[1];o.setError(e,r,i).end()})),Pl.e("".concat(n," failed. error:"),e),vI(e)}))}},{key:"updateGroupProfile",value:function(e){var t=this,n="".concat(this._n,".").concat("updateGroupProfile");if(!this.hasLocalGroup(e.groupID)||_d(this.getLocalGroupProfile(e.groupID).type)||Ql(e.joinOption)||(Pl.w("".concat(n," joinOption is unavailable for Work/Meeting/AVChatRoom/Community")),e.joinOption=void 0),Ql(e.muteAllMembers)||(e.muteAllMembers?e.muteAllMembers="On":e.muteAllMembers="Off"),e.name&&!1===this._filterProfanity("name",e))return vI({code:Vm});if(e.introduction&&!1===this._filterProfanity("introduction",e))return vI({code:Vm});if(e.notification&&!1===this._filterProfanity("notification",e))return vI({code:Vm});var o=new s_("updateGroupProfile");return o.setMessage(JSON.stringify(e)),Pl.l("".concat(n," groupID:").concat(e.groupID)),this.request({protocolName:$h,requestData:e}).then((function(){return o.setNetworkType(t.getNetworkType()).end(),Pl.l("".concat(n," ok")),t.hasLocalGroup(e.groupID)&&(t.groupMap.get(e.groupID).updateGroup(e),t._setStorageGroupList()),dI({group:t.groupMap.get(e.groupID)})})).catch((function(e){return t.probeNetwork().then((function(t){var n=_(t,2),r=n[0],i=n[1];o.setError(e,r,i).end()})),Pl.l("".concat(n," failed. error:"),e),vI(e)}))}},{key:"_filterProfanity",value:function(e,t){var n=this.getModule(ah);if(!n)return!0;var o=n.filterText(t[e],Hc),r=o.isAllowedToSend,i=o.modifiedText;return!0===r&&(t[e]=i,!0)}},{key:"joinGroup",value:function(e){var t=this,n=e.groupID,o=e.type,r="".concat(this._n,".joinGroup");if(o===Ir.GRP_WORK)return vI({code:im});if(this.deleteUnjoinedAVChatRoom(n),this.hasLocalGroup(n)){if(!this.isLoggedIn())return gI({status:Ir.JOIN_STATUS_ALREADY_IN_GROUP});var i=new s_("applyJoinGroup");return this.getGroupProfile({groupID:n}).then((function(){return i.setNetworkType(t.getNetworkType()).setMessage("groupID:".concat(n," joinedStatus:").concat(Ir.JOIN_STATUS_ALREADY_IN_GROUP)).end(),gI({status:Ir.JOIN_STATUS_ALREADY_IN_GROUP})})).catch((function(o){return i.setNetworkType(t.getNetworkType()).setMessage("groupID:".concat(n," unjoined")).end(),Pl.w("".concat(r," ").concat(n," was unjoined, now join!")),t.groupMap.delete(n),t.applyJoinGroup(e)}))}return Pl.l("".concat(r," groupID:").concat(n)),this.isLoggedIn()?this.applyJoinGroup(e):this._AVChatRoomHandler.joinWithoutAuth(e)}},{key:"applyJoinGroup",value:function(e){var n=this,o="".concat(this._n,".").concat("applyJoinGroup"),r=e.groupID;if(!Hd(e.applyMessage)&&!1===this._filterProfanity("applyMessage",e))return vI({code:Vm});var i=new s_("applyJoinGroup"),a=t({},e),s=this.canIUse(Uc.AVCHATROOM_HISTORY_MSG);return s&&(a.historyMessageFlag=1),this.getModule(Vf).deleteTopicRoamingMessageInfo(r),this.request({protocolName:Qh,requestData:a}).then((function(e){var t=e.data,a=t.joinedStatus,u=t.longPollingKey,c=t.startSeq,l=t.avChatRoomFlag,d=t.avChatRoomKey,p=t.messageList,f="groupID:".concat(r," joinedStatus:").concat(a," longPollingKey:").concat(u," startSeq:").concat(c)+" avChatRoomFlag:".concat(l," canGetAVChatRoomHistoryMessage:").concat(s,",")+" history message count:".concat(Hd(p)?0:p.length);switch(i.setNetworkType(n.getNetworkType()).setMessage("".concat(f)).end(),Pl.l("".concat(o," ok. ").concat(f)),a){case Vl:return dI({status:Vl});case Bl:return n.getGroupProfile({groupID:r}).then((function(e){var t=e.data.group;return n._handleJoinResult({group:t,avChatRoomFlag:l,longPollingKey:u,startSeq:c,avChatRoomKey:d,messageList:p})})).catch((function(){var e=new ZI({groupID:r});return n._handleJoinResult({group:e,avChatRoomFlag:l,longPollingKey:u,startSeq:c,avChatRoomKey:d,messageList:p})}));default:var h=new pI({code:pm});return Pl.e("".concat(o," failed. error:"),h),vI(h)}})).catch((function(e){return i.setMessage("groupID:".concat(r)),n.probeNetwork().then((function(t){var n=_(t,2),o=n[0],r=n[1];i.setError(e,o,r).end()})),Pl.e("".concat(o," failed. error:"),e),vI(e)}))}},{key:"_handleJoinResult",value:function(e){var t,n=this,o=e.group,r=e.avChatRoomFlag,i=e.longPollingKey,a=e.startSeq,s=e.avChatRoomKey,u=e.messageList,c=o.groupID;return 1===r?(this.getModule(Vf).setCompleted("".concat(Ir.CONV_GROUP).concat(c)),this._groupAttributesHandler.initGroupAttributesCache({groupID:c,avChatRoomKey:s}),this._groupCountersHandler.initGroupCountersCache({groupID:c,avChatRoomKey:s}),(t=Ql(i)?this._AVChatRoomHandler.handleJoinResult({group:o}):this._AVChatRoomHandler.startRunLoop({group:o,longPollingKey:i,startSeq:a})).then((function(){n._onAVChatRoomHistoryMessage(u)})),t):(this.emitGroupListUpdate(!0,!1),dI({status:Bl,group:o}))}},{key:"quitGroup",value:function(e){var t=this,n="".concat(this._n,".").concat("quitGroup");Pl.l("".concat(n," groupID:").concat(e));var o=this.checkJoinedAVChatRoomByID(e);if(!o&&!this.hasLocalGroup(e))return vI({code:dm});if(o&&!this.isLoggedIn())return Pl.l("".concat(n," anonymously ok. groupID:").concat(e)),this.deleteLocalGroupAndConversation(e),this._AVChatRoomHandler.reset(e),gI({groupID:e});var r=new s_("quitGroup");return r.setMessage("groupID:".concat(e)),this.request({protocolName:tg,requestData:{groupID:e}}).then((function(){return r.setNetworkType(t.getNetworkType()).end(),Pl.l("".concat(n," ok")),t.deleteLocalGroupAndConversation(e),o&&t._AVChatRoomHandler.reset(e),t._groupAttributesHandler.deleteLocalGroupAttributes(e),dI({groupID:e})})).catch((function(e){return t.probeNetwork().then((function(t){var n=_(t,2),o=n[0],i=n[1];r.setError(e,o,i).end()})),Pl.e("".concat(n," failed. error:"),e),vI(e)}))}},{key:"searchGroupByID",value:function(e){var t=this,n="".concat(this._n,".").concat("searchGroupByID"),o={groupIDList:[e]},r=new s_("searchGroupByID");return r.setMessage("groupID:".concat(e)),Pl.l("".concat(n," groupID:").concat(e)),this.request({protocolName:ng,requestData:o}).then((function(e){var o=e.data.groupProfile;if(0!==o[0].errorCode)throw new pI({code:o[0].errorCode,message:o[0].errorInfo});return r.setNetworkType(t.getNetworkType()).end(),Pl.l("".concat(n," ok")),dI({group:new ZI(o[0])})})).catch((function(e){return t.probeNetwork().then((function(t){var n=_(t,2),o=n[0],i=n[1];r.setError(e,o,i).end()})),Pl.w("".concat(n," failed. error:"),e),vI(e)}))}},{key:"changeGroupOwner",value:function(e){var t=this,n="".concat(this._n,".").concat("changeGroupOwner");if(this.hasLocalGroup(e.groupID)&&this.getLocalGroupProfile(e.groupID).type===Ir.GRP_AVCHATROOM)return vI({code:um});if(e.newOwnerID===this.getMyUserID())return vI({code:cm});var o=new s_("changeGroupOwner");return o.setMessage("groupID:".concat(e.groupID," newOwnerID:").concat(e.newOwnerID)),Pl.l("".concat(n," groupID:").concat(e.groupID)),this.request({protocolName:og,requestData:e}).then((function(){o.setNetworkType(t.getNetworkType()).end(),Pl.l("".concat(n," ok"));var r=e.groupID,i=e.newOwnerID;t.groupMap.get(r).ownerID=i;var a=t.getModule(qf).getLocalGroupMemberList(r);if(a instanceof Map){var s=a.get(t.getMyUserID());Ql(s)||(s.updateRole("Member"),t.groupMap.get(r).selfInfo.role="Member");var u=a.get(i);Ql(u)||u.updateRole("Owner")}return t.emitGroupListUpdate(!0,!1),dI({group:t.groupMap.get(r)})})).catch((function(e){return t.probeNetwork().then((function(t){var n=_(t,2),r=n[0],i=n[1];o.setError(e,r,i).end()})),Pl.e("".concat(n," failed. error:"),e),vI(e)}))}},{key:"getGroupApplicationList",value:function(){return this._groupSystemNoticeHandler.getGroupApplicationList()}},{key:"handleGroupApplication",value:function(e){var t,n,o,r,i=this,a="".concat(this._n,".").concat("handleGroupApplication"),s=e.handleAction,u=e.handleMessage,c=e.message,l=e.application;c?(t=c.payload.operatorID,n=c.payload.groupProfile.groupID,o=c.payload.authentication,r=c.payload.messageKey):l&&(t=l.applicant,n=l.groupID,o=l.authentication,r=l.messageKey);var d=new s_("handleGroupApplication");return d.setMessage("groupID:".concat(n)),Pl.l("".concat(a," groupID:").concat(n)),this.request({protocolName:rg,requestData:{handleAction:s,handleMessage:u,applicant:t,groupID:n,authentication:o,messageKey:r}}).then((function(){return d.setNetworkType(i.getNetworkType()).end(),Pl.l("".concat(a," ok")),c&&i._groupSystemNoticeHandler.deleteGroupSystemNotice({messageList:[e.message]}),dI({group:i.getLocalGroupProfile(n)})})).catch((function(e){return i.probeNetwork().then((function(t){var n=_(t,2),o=n[0],r=n[1];d.setError(e,o,r).end()})),Pl.e("".concat(a," failed. error"),e),vI(e)}))}},{key:"handleGroupInvitation",value:function(e){var n=this,o="".concat(this._n,".").concat("handleGroupInvitation"),r=e.message.payload,i=r.groupProfile.groupID,a=r.authentication,s=r.messageKey,u=r.operatorID,c=e.handleAction,l=new s_("handleGroupInvitation");return l.setMessage("groupID:".concat(i," inviter:").concat(u," handleAction:").concat(c)),Pl.l("".concat(o," groupID:").concat(i," inviter:").concat(u," handleAction:").concat(c)),this.request({protocolName:ig,requestData:t(t({},e),{},{inviter:u,groupID:i,authentication:a,messageKey:s})}).then((function(){return l.setNetworkType(n.getNetworkType()).end(),Pl.l("".concat(o," ok")),n._groupSystemNoticeHandler.deleteGroupSystemNotice({messageList:[e.message]}),dI({group:n.getLocalGroupProfile(i)})})).catch((function(e){return n.probeNetwork().then((function(t){var n=_(t,2),o=n[0],r=n[1];l.setError(e,o,r).end()})),Pl.e("".concat(o," failed. error"),e),vI(e)}))}},{key:"getGroupOnlineMemberCount",value:function(e){return this._AVChatRoomHandler?this._AVChatRoomHandler.checkJoinedAVChatRoomByID(e)?this._AVChatRoomHandler.getGroupOnlineMemberCount(e):gI({memberCount:0}):vI({code:Rm})}},{key:"hasLocalGroup",value:function(e){return this.groupMap.has(e)}},{key:"deleteLocalGroupAndConversation",value:function(e){var t=this.checkJoinedAVChatRoomByID(e);if(Pl.l("".concat(this._n,".deleteLocalGroupAndConversation isJoinedAVChatRoom:").concat(t)),t&&this.getModule(Vf).deleteLocalConversation("".concat(Ir.CONV_GROUP).concat(e)),Md({groupID:e})){var n=this.getLocalGroupProfile(e);n&&!0===n.isSupportTopic&&this.getModule(Bf).deleteTopicListInCommunity(e)}this._deleteLocalGroup(e),this.emitGroupListUpdate(!0,!1)}},{key:"_deleteLocalGroup",value:function(e){this.groupMap.delete(e),this.getModule(qf).deleteGroupMemberList(e),this._setStorageGroupList()}},{key:"sendMessage",value:function(e,t){if($l(e._receiverList)&&e._receiverList.length>0&&!this.canIUse(Uc.MSG_TO_SPECIFIED_GRP_MBR))return vI({code:Bm});var n=this.createGroupMessagePack(e,t);return this.request(n)}},{key:"createGroupMessagePack",value:function(e,t){var n=null;t&&t.offlinePushInfo&&(n=t.offlinePushInfo);var o="";Yl(e.cloudCustomData)&&e.cloudCustomData.length>0&&(o=e.cloudCustomData);var r=[];if(Xl(t)&&Xl(t.messageControlInfo)){var i=t.messageControlInfo,a=i.excludedFromUnreadCount,s=i.excludedFromLastMessage,u=i.excludedFromContentModeration;!0===a&&r.push("NoUnread"),!0===s&&r.push("NoLastMsg"),!0===u&&r.push("NoMsgCheck")}var c=void 0;$l(e._receiverList)&&e._receiverList.length>0&&(c=e._receiverList,e._receiverList.length>50&&(c=e._receiverList.slice(0,50),this.outputWarning("ReceiverListLimit")));var l=this.isOnlineMessage(e,t)?1:0,d=e.getGroupAtInfoList(),p={fromAccount:this.getMyUserID(),groupID:e.to,msgBody:e.getElements(),cloudCustomData:o,random:e.random,priority:e.priority,clientSequence:e.clientSequence,groupAtInfo:e.type!==Ir.MSG_TEXT||Hd(d)?void 0:d,onlineOnlyFlag:l,clientTime:e.clientTime,offlinePushInfo:n?{pushFlag:!0===n.disablePush?1:0,title:n.title||"",desc:n.description||"",ext:n.extension||"",apnsInfo:{badgeMode:!0===n.ignoreIOSBadge?1:0,isVoipPush:this._isVoipPush(n)},androidInfo:{OPPOChannelID:n.androidOPPOChannelID||""}}:void 0,messageControlInfo:0===l?r:void 0,needReadReceipt:!0!==e.needReadReceipt||this.isMessageFromOrToAVChatroom(e.to)?0:1,receiverList:c,isSupportExtension:!0===e.isSupportExtension?1:0};return Id(e.to)&&(p.groupID=Gd(e.to),p.topicID=e.to),{protocolName:_h,tjgID:this.generateTjgID(e),requestData:p}}},{key:"_isVoipPush",value:function(e){var t=void 0;return Ql(e.disableVoipPush)||(t=!1===e.disableVoipPush?1:0),t}},{key:"revokeMessage",value:function(e){var t={groupID:e.to,msgSeqList:[{msgSeq:e.sequence}]};return Id(e.to)&&(t.groupID=Gd(e.to),t.topicID=e.to),this.request({protocolName:ag,requestData:t})}},{key:"deleteMessage",value:function(e){var t=e.to,n=e.keyList;Pl.l("".concat(this._n,".deleteMessage groupID:").concat(t," count:").concat(n.length));var o={groupID:t,deleter:this.getMyUserID(),keyList:n};return Id(t)&&(o.groupID=Gd(t),o.topicID=t),this.request({protocolName:yg,requestData:o})}},{key:"modifyRemoteMessage",value:function(e){var t=e.to,n=e.sequence,o=e.payload,r=e.type,i=e.version,a=void 0===i?0:i,s=e.cloudCustomData,u=t,c=void 0;Id(t)&&(u=Gd(t),c=t);var l=void 0;return xd(r)&&(l=[]).push({type:r,content:o}),this.request({protocolName:Mg,requestData:{groupID:u,topicID:c,sequence:n,version:a,elements:l,cloudCustomData:s}})}},{key:"getRoamingMessage",value:function(e){var t=this,n="".concat(this._n,".getRoamingMessage"),o=e.conversationID,r=e.groupID,i=e.sequence,a=new s_("getGroupRoamingMessages"),s=0,u=void 0;return Id(r)&&(r=Gd(u=r)),this._computeLastSequence({groupID:r,topicID:u,sequence:i}).then((function(e){return s=e,Pl.l("".concat(n," groupID:").concat(r," startSequence:").concat(s)),t.request({protocolName:cg,requestData:{groupID:r,count:21,sequence:s,topicID:u}})})).then((function(e){var i=e.data,c=i.messageList,l=i.complete,d=i.invisibleSequenceList,p=void 0===d?[]:d;Ql(c)?Pl.l("".concat(n," ok. complete:").concat(l," but messageList is undefined!")):Pl.l("".concat(n," ok. complete:").concat(l," count:").concat(c.length));var f=t._getMinSequence(p,c)-1;a.setNetworkType(t.getNetworkType()).setMessage("groupID:".concat(r," topicID:").concat(u," startSequence:").concat(s," complete:").concat(l," nextSequence:").concat(f)).end();var h=t.getModule(Vf),g=[];return Hd(c)||(h.updateRoamingMessageSequence(o,f),g=h.onRoamingMessage(c,o),h.updateIsRead(o),h.patchConversationLastMessage(o)),2===l&&(h.setCompleted(o),f=""),Pl.l("".concat(n," nextReqID:").concat(f,", stored message count:").concat(g.length,", invisible sequence count:").concat(p.length)),{nextReqID:f+"",storedMessageList:g}})).catch((function(e){return t.probeNetwork().then((function(t){var n=_(t,2),o=n[0],i=n[1];a.setError(e,o,i).setMessage("groupID:".concat(r," topicID:").concat(u," startSequence:").concat(s)).end()})),Pl.w("".concat(n," failed. error:"),e),vI(e)}))}},{key:"_getGroupIDOfMessage",value:function(e){return e.conversationID.replace(Ir.CONV_GROUP,"")}},{key:"_getMinSequence",value:function(e,t){var n=0;Hd(t)||(n=t[t.length-1].sequence);var o=0;return Hd(e)||(o=e[e.length-1]),Pl.l("".concat(this._n,"._getMinSequence minVisibleSequence:").concat(n," minInvisibleSequence:").concat(o)),o>0&&o<n?o:n}},{key:"getReadReceiptList",value:function(e){var t=this,n="".concat(this._n,".").concat("getReadReceiptList"),o=this._getGroupIDOfMessage(e[0]),r=this.getMyUserID(),i=e.filter((function(e){return e.from===r&&!0===e.needReadReceipt})).map((function(e){return{sequence:e.sequence}}));if(Pl.l("".concat(n," groupID:").concat(o," sequenceList:").concat(JSON.stringify(i))),0===i.length)return gI({messageList:e});var a=new s_("getReadReceiptList");return a.setMessage("groupID:".concat(o)),this.request({protocolName:lg,requestData:{groupID:o,sequenceList:i}}).then((function(t){a.end(),Pl.l("".concat(n," ok"));var o=t.data.readReceiptList;return $l(o)&&o.forEach((function(t){e.forEach((function(e){0===t.code&&t.sequence===e.sequence&&(e.readReceiptInfo.readCount=t.readCount,e.readReceiptInfo.unreadCount=t.unreadCount)}))})),dI({messageList:e})})).catch((function(e){return t.probeNetwork().then((function(t){var n=_(t,2),o=n[0],r=n[1];a.setError(e,o,r).end()})),Pl.w("".concat(n," failed. error:"),e),vI(e)}))}},{key:"sendReadReceipt",value:function(e){var t=this,n="".concat(this._n,".").concat("sendReadReceipt"),o=this._getGroupIDOfMessage(e[0]),r=new s_("sendReadReceipt");r.setMessage("groupID:".concat(o));var i=this.getMyUserID(),a=e.filter((function(e){return e.from!==i&&!0===e.needReadReceipt})).map((function(e){return{sequence:e.sequence}}));return 0===a.length?vI({code:wv}):(Pl.l("".concat(n,". sequenceList:").concat(JSON.stringify(a))),this.request({protocolName:dg,requestData:{groupID:o,sequenceList:a}}).then((function(e){return r.end(),Pl.l("".concat(n," ok")),dI()})).catch((function(e){return t.probeNetwork().then((function(t){var n=_(t,2),o=n[0],i=n[1];r.setError(e,o,i).end()})),Pl.w("".concat(n," failed. error:"),e),vI(e)})))}},{key:"getReadReceiptDetail",value:function(e){var t=this,n=e.message,o=e.filter,r=e.cursor,i=e.count,a=this._getGroupIDOfMessage(n),s=n.ID,u=n.sequence,c="".concat(this._n,".").concat("getReadReceiptDetail"),l=this._receiptDetailCompleteMap.get(s)||!1,d=0!==o&&1!==o?0:o,p=Yl(r)?r:"",f=!Wl(i)||i<=0||i>=100?100:i,h="groupID:".concat(a," sequence:").concat(u," cursor:").concat(p," filter:").concat(d," completeFlag:").concat(l);Pl.l("".concat(c," ").concat(h));var g={cursor:"",isCompleted:!1,messageID:s,unreadUserIDList:[],readUserIDList:[]},v=new s_("getReadReceiptDetail");return v.setMessage(h),this.request({protocolName:fg,requestData:{groupID:a,sequence:u,flag:d,cursor:p,count:f}}).then((function(e){v.end();var n=e.data,o=n.cursor,r=n.isCompleted,i=n.unreadUserIDList,a=n.readUserIDList;return g.cursor=o,1===r&&(g.isCompleted=!0,t._receiptDetailCompleteMap.set(s,!0)),0===d?g.readUserIDList=a.map((function(e){return e.userID})):1===d&&(g.unreadUserIDList=i.map((function(e){return e.userID}))),Pl.l("".concat(c," ok")),dI(g)})).catch((function(e){return t.probeNetwork().then((function(t){var n=_(t,2),o=n[0],r=n[1];v.setError(e,o,r).end()})),Pl.w("".concat(c," failed. error:"),e),vI(e)}))}},{key:"getRoamingMessagesHopping",value:function(e){var t=this,n="".concat(this._n,".getRoamingMessagesHopping"),o=new s_("getGroupRoamingMessagesHopping"),r=e.groupID,i=e.count,a=e.sequence,s=e.direction,u=a;1===s&&(u=a+i-1);var c=void 0;Id(r)&&(r=Gd(c=r));var l="".concat(c?"topicID:".concat(c):"groupID:".concat(r)," sequence:").concat(a," direction:").concat(s);return Pl.l("".concat(n," ").concat(l)),this.request({protocolName:cg,requestData:{groupID:r,topicID:c,count:i,sequence:u}}).then((function(r){var i=r.data,u=i.messageList,c=i.complete,d="complete:".concat(c," count:").concat(u?u.length:0);if(Pl.l("".concat(n," ok. ").concat(d)),o.setNetworkType(t.getNetworkType()).setMessage("".concat(l," ").concat(d)).end(),2===c||Hd(u)){var p=t._computeResult();return dI(p)}var f="".concat(Ir.CONV_GROUP).concat(e.groupID),h=t.getModule(Vf).onRoamingMessage(u,f,!1),g=t._computeResult({direction:s,sequence:a,remoteMessageList:u,processedMessageList:h});return dI(g)})).catch((function(e){return t.probeNetwork().then((function(t){var n=_(t,2),s=n[0],u=n[1];o.setError(e,s,u).setMessage("groupID:".concat(r," sequence:").concat(a," count:").concat(i)).end()})),Pl.w("".concat(n," failed. error:"),e),vI(e)}))}},{key:"_computeResult",value:function(e){var t={messageList:[],isCompleted:!1,nextMessageSeq:""};if(Ql(e))return t.isCompleted=!0,t;var n=e.direction,o=e.sequence,r=e.remoteMessageList,i=void 0===r?[]:r,a=e.processedMessageList,s=void 0===a?[]:a,u=i.length;return 1===n?(t.nextMessageSeq=i[0].sequence+1,s.forEach((function(e){e.sequence>=o&&t.messageList.push(e)})),0===t.messageList.length&&i[0].sequence<o&&(t.isCompleted=!0,t.nextMessageSeq=""),t):(t.nextMessageSeq=i[u-1].sequence-1,t.messageList=y(s),0===t.nextMessageSeq&&(t.isCompleted=!0,t.nextMessageSeq=""),t)}},{key:"setMessageRead",value:function(e){var t=this,n=e.conversationID,o=e.lastMessageSeq,r="".concat(this._n,".setMessageRead");Pl.l("".concat(r," conversationID:").concat(n," lastMessageSeq:").concat(o)),Wl(o)||this.outputWarning("DoNotModifyLastSeq");var i=new s_("setGroupMessageRead");i.setMessage("".concat(n,"-").concat(o));var a=n.replace(Ir.CONV_GROUP,""),s=void 0;return Id(a)&&(a=Gd(s=a)),this.request({protocolName:sg,requestData:{groupID:a,topicID:s,messageReadSeq:o}}).then((function(){i.setNetworkType(t.getNetworkType()).end(),Pl.l("".concat(r," ok."));var e=t.getModule(Vf);e.updateIsReadAfterReadReport({conversationID:n,lastMessageSeq:o});var u=!0;if(!Ql(s)){u=!1;var c=t.getModule(Bf).getLocalTopic(a,s);c&&c.updateSelfInfo({readedSequence:o})}return e.updateUnreadCount(n,u),dI()})).catch((function(e){return t.probeNetwork().then((function(t){var n=_(t,2),o=n[0],r=n[1];i.setError(e,o,r).end()})),Pl.l("".concat(r," failed. error:"),e),vI(e)}))}},{key:"_computeLastSequence",value:function(e){var t=e.groupID,n=e.topicID,o=void 0===n?void 0:n,r=e.sequence;return r>0?Promise.resolve(r):Ql(o)||this.hasLocalGroup(t)?Ql(o)?this.getGroupLastSequence(t):this.getTopicLastSequence({groupID:t,topicID:o}):Promise.resolve(0)}},{key:"getGroupLastSequence",value:function(e){var t=this,n="".concat(this._n,".").concat("getGroupLastSequence"),o=new s_("getGroupLastSequence"),r=0,i="";if(this.hasLocalGroup(e)){var a=this.getLocalGroupProfile(e),s=a.lastMessage;if(s.lastSequence>0&&!1===s.onlineOnlyFlag)return r=s.lastSequence,i="got lastSequence:".concat(r," from local group profile[lastMessage.lastSequence]. groupID:").concat(e),Pl.l("".concat(n," ").concat(i)),o.setNetworkType(this.getNetworkType()).setMessage("".concat(i)).end(),Promise.resolve(r);if(a.nextMessageSeq>1)return r=a.nextMessageSeq-1,i="got lastSequence:".concat(r," from local group profile[nextMessageSeq]. groupID:").concat(e),Pl.l("".concat(n," ").concat(i)),o.setNetworkType(this.getNetworkType()).setMessage("".concat(i)).end(),Promise.resolve(r)}var u="GROUP".concat(e),c=this.getModule(Vf).getLocalConversation(u);if(c&&c.lastMessage.lastSequence&&!1===c.lastMessage.onlineOnlyFlag)return r=c.lastMessage.lastSequence,i="got lastSequence:".concat(r," from local conversation profile[lastMessage.lastSequence]. groupID:").concat(e),Pl.l("".concat(n," ").concat(i)),o.setNetworkType(this.getNetworkType()).setMessage("".concat(i)).end(),Promise.resolve(r);var l={groupIDList:[e],responseFilter:{groupBaseInfoFilter:["NextMsgSeq"]}};return this.getGroupProfileAdvance(l).then((function(a){var s=a.data.successGroupList;return Hd(s)?Pl.l("".concat(n," successGroupList is empty. groupID:").concat(e)):(r=s[0].nextMessageSeq-1,i="got lastSequence:".concat(r," from getGroupProfileAdvance. groupID:").concat(e),Pl.l("".concat(n," ").concat(i))),o.setNetworkType(t.getNetworkType()).setMessage("".concat(i)).end(),r})).catch((function(r){return t.probeNetwork().then((function(t){var n=_(t,2),i=n[0],a=n[1];o.setError(r,i,a).setMessage("get lastSequence failed from getGroupProfileAdvance. groupID:".concat(e)).end()})),Pl.w("".concat(n," failed. error:"),r),vI(r)}))}},{key:"getTopicLastSequence",value:function(e){var t=this,n=e.groupID,o=e.topicID,r="".concat(this._n,".").concat("getTopicLastSequence"),i=new s_("getTopicLastSequence"),a=0,s="",u=this.getModule(Bf);return u.hasLocalTopic(n,o)?(a=u.getLocalTopic(n,o).nextMessageSeq-1,s="get lastSequence:".concat(a," from local topic info[nextMessageSeq]. topicID:").concat(o),Pl.l("".concat(r," ").concat(s)),i.setNetworkType(this.getNetworkType()).setMessage("".concat(s)).end(),Promise.resolve(a)):u.getTopicList({groupID:n,topicIDList:[o]}).then((function(e){var n=e.data.successTopicList;return Hd(n)?Pl.l("".concat(r," successTopicList is empty. topicID:").concat(o)):(a=n[0].nextMessageSeq-1,s="get lastSequence:".concat(a," from getTopicList. topicID:").concat(o),Pl.l("".concat(r," ").concat(s))),i.setNetworkType(t.getNetworkType()).setMessage("".concat(s)).end(),a})).catch((function(e){return t.probeNetwork().then((function(t){var n=_(t,2),r=n[0],a=n[1];i.setError(e,r,a).setMessage("get lastSequence failed from getTopicList. topicID:".concat(o)).end()})),Pl.w("".concat(r," failed. error:"),e),vI(e)}))}},{key:"isMessageFromOrToAVChatroom",value:function(e){return!!this._AVChatRoomHandler&&this._AVChatRoomHandler.checkJoinedAVChatRoomByID(e)}},{key:"hasJoinedAVChatRoom",value:function(){return this._AVChatRoomHandler?this._AVChatRoomHandler.hasJoinedAVChatRoom():0}},{key:"getJoinedAVChatRoom",value:function(){return this._AVChatRoomHandler?this._AVChatRoomHandler.getJoinedAVChatRoom():[]}},{key:"isOnlineMessage",value:function(e,t){return!(!this._canIUseOnlineOnlyFlag(e)||!t||!0!==t.onlineUserOnly)}},{key:"_canIUseOnlineOnlyFlag",value:function(e){var t=this.getJoinedAVChatRoom();return!t||!t.includes(e.to)||e.conversationType!==Ir.CONV_GROUP}},{key:"_onAVChatRoomHistoryMessage",value:function(e){if(!Hd(e)){Pl.l("".concat(this._n,"._onAVChatRoomHistoryMessage count:").concat(e.length));var n=[];e.forEach((function(e){n.push(t(t({},e),{},{isHistoryMessage:1}))})),this.onAVChatRoomMessage(n)}}},{key:"onAVChatRoomMessage",value:function(e){this._AVChatRoomHandler&&this._AVChatRoomHandler.onMessage(e)}},{key:"onAVChatRoomMemberBanned",value:function(e){this._AVChatRoomHandler&&this._AVChatRoomHandler.onAVChatRoomMemberBanned(e)}},{key:"getGroupSimplifiedInfo",value:function(e){var t=this,n=new s_("getGroupSimplifiedInfo"),o={groupIDList:[e],responseFilter:{groupBaseInfoFilter:["Type","Name"]}};return this.getGroupProfileAdvance(o).then((function(o){var r=o.data.successGroupList;return n.setNetworkType(t.getNetworkType()).setMessage("groupID:".concat(e," type:").concat(r[0].type)).end(),r[0]})).catch((function(o){t.probeNetwork().then((function(t){var r=_(t,2),i=r[0],a=r[1];n.setError(o,i,a).setMessage("groupID:".concat(e)).end()}))}))}},{key:"setUnjoinedAVChatRoom",value:function(e){this._unjoinedAVChatRoomList.set(e,1)}},{key:"deleteUnjoinedAVChatRoom",value:function(e){this._unjoinedAVChatRoomList.has(e)&&this._unjoinedAVChatRoomList.delete(e)}},{key:"isUnjoinedAVChatRoom",value:function(e){return this._unjoinedAVChatRoomList.has(e)}},{key:"isGroupAttributesUpdatedNotice",value:function(e){return this._groupAttributesHandler.isGroupAttributesUpdatedNotice(e)}},{key:"updateLocalMainSequenceOnReconnected",value:function(){this._groupAttributesHandler.updateLocalMainSequenceOnReconnected()}},{key:"initGroupAttributes",value:function(e){return this._groupAttributesHandler.initGroupAttributes(e)}},{key:"setGroupAttributes",value:function(e){return this._groupAttributesHandler.setGroupAttributes(e)}},{key:"deleteGroupAttributes",value:function(e){return this._groupAttributesHandler.deleteGroupAttributes(e)}},{key:"getGroupAttributes",value:function(e){return this._groupAttributesHandler.getGroupAttributes(e)}},{key:"isMessageFromTopic",value:function(e,t){return 2===e&&!Hd(t)}},{key:"isMessageFromCommunityOfTopic",value:function(e,t){return 2===e&&Hd(t)}},{key:"getMessageExtensions",value:function(e,t){return Pl.l("".concat(this._n,".getMessageExtensions startSequence:").concat(t)),this.request({protocolName:Dg,requestData:{groupID:e.to,messageSequence:e.sequence,startSequence:t}})}},{key:"modifyMessageExtensions",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return Pl.l("".concat(this._n,".modifyMessageExtensions operateType:").concat(n)),this.request({protocolName:bg,requestData:{groupID:e.to,messageSequence:e.sequence,extensionList:t,operateType:n}})}},{key:"getGroupNotify",value:function(e){var n=this;if(this.hasLocalGroup(e)){var o=this.getLocalGroupProfile(e),r=o.type,i=o.isSupportTopic;if(!yd(r)&&!i){var a="".concat(this._n,".getGroupNotify"),s=this._getGroupLastRevokedTime(e),u=1e3*Al();Pl.l("".concat(a," groupID:").concat(e," type:").concat(r," beginTime:").concat(s," endTime:").concat(u)),this.request({protocolName:Eg,requestData:{type:Md({type:r,groupID:e})?Ir.GRP_COMMUNITY:void 0,groupID:e,beginTime:s,endTime:u}}).then((function(o){var r=o.data,i=r.nextRevokedTime,s=r.notifyList;Pl.l("".concat(a," ok. groupID:").concat(e," nextRevokedTime:").concat(i));var u={dataList:[{elements:{revokedInfos:[]}}]};$l(s)&&s.forEach((function(n){u.dataList[0].elements.revokedInfos.push({groupID:e,sequence:n.sequence,random:n.random,revokerInfo:t({},n.revokerInfo)})})),n.onGroupMessageRevoked(u),0!==i?(n._setGroupLastRevokedTime(e,i),n.getGroupNotify(e)):n._setGroupLastRevokedTime(e,1e3*Al())})).catch((function(e){Pl.e("".concat(a," failed. error:"),e)}))}}}},{key:"_getGroupLastRevokedTime",value:function(e){return this.hasLocalGroup(e)?this.getLocalGroupProfile(e)._lastRevokedTime:0}},{key:"_setGroupLastRevokedTime",value:function(e,t){this.hasLocalGroup(e)&&(this.getLocalGroupProfile(e)._lastRevokedTime=t)}},{key:"isGroupCountersNotice",value:function(e){return this._groupCountersHandler.isGroupCountersNotice(e)}},{key:"setGroupCounters",value:function(e){return this._groupCountersHandler.setGroupCounters(e)}},{key:"increaseGroupCounter",value:function(e){return this._groupCountersHandler.increaseGroupCounter(e)}},{key:"decreaseGroupCounter",value:function(e){return this._groupCountersHandler.decreaseGroupCounter(e)}},{key:"getGroupCounters",value:function(e){return this._groupCountersHandler.getGroupCounters(e)}},{key:"restartPolling",value:function(){this._AVChatRoomHandler&&this._AVChatRoomHandler.restartPolling()}},{key:"reset",value:function(){this.groupMap.clear(),this._unjoinedAVChatRoomList.clear(),this._receiptDetailCompleteMap.clear(),this._commonGroupHandler.reset(),this._groupSystemNoticeHandler.reset(),this._groupTipsHandler.reset(),this._groupAttributesHandler.reset(),this._groupCountersHandler.reset(),this._AVChatRoomHandler&&this._AVChatRoomHandler.reset()}}]),o}(lh),kC=function(){function e(t){r(this,e),this.userID="",this.avatar="",this.nick="",this.role="",this.joinTime="",this.lastSendMsgTime="",this.nameCard="",this.muteUntil=0,this.memberCustomField=[],this._initMember(t)}return a(e,[{key:"_initMember",value:function(e){this.updateMember(e)}},{key:"updateMember",value:function(e){var t=[null,void 0,"",0,NaN];e.memberCustomField&&md(this.memberCustomField,e.memberCustomField),sd(this,e,["memberCustomField","marks"],t)}},{key:"updateRole",value:function(e){["Owner","Admin","Member"].indexOf(e)<0||(this.role=e)}},{key:"updateMuteUntil",value:function(e){Ql(e)||(this.muteUntil=Math.floor((Date.now()+1e3*e)/1e3))}},{key:"updateNameCard",value:function(e){Ql(e)||(this.nameCard=e)}},{key:"updateMemberCustomField",value:function(e){e&&md(this.memberCustomField,e)}}]),e}(),TC=function(e){u(o,e);var n=m(o);function o(e){var t;return r(this,o),(t=n.call(this,e))._n="GroupMemberModule",t.groupMemberListMap=new Map,t.getInnerEmitterInstance().on(PI,t._onProfileUpdated,g(t)),t}return a(o,[{key:"_onProfileUpdated",value:function(e){for(var t=this,n=e.data,o=function(e){var o=n[e];t.groupMemberListMap.forEach((function(e){e.has(o.userID)&&e.get(o.userID).updateMember({nick:o.nick,avatar:o.avatar})}))},r=0;r<n.length;r++)o(r)}},{key:"deleteGroupMemberList",value:function(e){this.groupMemberListMap.delete(e)}},{key:"getGroupMemberList",value:function(e){var t=this,n=e.groupID,o=e.offset,r=void 0===o?0:o,i=e.count,a=void 0===i?15:i,s=e.filter,u=void 0===s?void 0:s,c="".concat(this._n,".").concat("getGroupMemberList"),l=this.getModule(xf),d=l.hasLocalGroup(n);if(Pl.l("".concat(c," groupID:").concat(n," offset:").concat(r," count:").concat(a," hasLocalGroup:").concat(d)),!d)return gI({memberList:[],offset:0});if(l.getLocalGroupProfile(n).type===Ir.GRP_AVCHATROOM){if(this.canIUse(Uc.AVCHATROOM_MBR_LIST))return this._getAVChatRoomMemberList({groupID:n,offset:r,filter:u});this.outputWarning("LiveOnlineMember")}var p=new s_("getGroupMemberList"),f=0,h={groupID:n,limit:a>100?100:a};Md({groupID:n})?h.next="".concat(r):(h.offset=r,f=r+a);var g=[];return this.request({protocolName:Rg,requestData:h}).then((function(e){var o=e.data,r=o.members,i=o.memberNum,a=o.next,s=void 0===a?void 0:a;if(Ql(s)||(f=Hd(s)?0:s),!$l(r)||0===r.length)return f=0,Promise.resolve([]);var u=t.getModule(xf);return u.hasLocalGroup(n)&&(u.getLocalGroupProfile(n).memberNum=i),g=t._updateLocalGroupMemberMap(n,r),t.getModule(Gf).getUserProfile({userIDList:r.map((function(e){return e.userID})),tagList:[Ul.NICK,Ul.AVATAR]})})).then((function(e){var o=e.data;if(!$l(o)||0===o.length)return gI({memberList:[],offset:f});var i=o.map((function(e){return{userID:e.userID,nick:e.nick,avatar:e.avatar}}));return t._updateLocalGroupMemberMap(n,i),g.length<a&&(f=0),p.setNetworkType(t.getNetworkType()).setMessage("groupID:".concat(n," offset:").concat(r," count:").concat(a)).end(),Pl.l("".concat(c," ok.")),dI({memberList:g,offset:f})})).catch((function(e){return t.probeNetwork().then((function(t){var n=_(t,2),o=n[0],r=n[1];p.setError(e,o,r).end()})),Pl.e("".concat(c," failed. error:"),e),vI(e)}))}},{key:"_getAVChatRoomMemberList",value:function(e){var t=this,n=e.groupID,o=e.offset,r=e.filter,i="".concat(this._n,".").concat("_getAVChatRoomMemberList"),a=new s_("_getAVChatRoomMemberList");return a.setMessage("groupID:".concat(n," offset:").concat(o," filter:").concat(r)),this.request({protocolName:wg,requestData:{groupID:n,offset:o,filter:r}}).then((function(e){var o=e.data,r=o.memberList,s=void 0===r?[]:r,u=o.offset,c=void 0===u?0:u;a.setNetworkType(t.getNetworkType()).end(),Pl.l("".concat(i," ok. member count:").concat(s.length,", next request timestamp:").concat(c));var l=t._updateLocalGroupMemberMap(n,s);return dI({memberList:l,offset:c})})).catch((function(e){return t.probeNetwork().then((function(t){var n=_(t,2),o=n[0],r=n[1];a.setError(e,o,r).end()})),Pl.e("".concat(i," failed. error:"),e),vI(e)}))}},{key:"getGroupMemberProfile",value:function(e){var n=this,o="".concat(this._n,".").concat("getGroupMemberProfile"),r=new s_("getGroupMemberProfile");r.setMessage(e.userIDList.length>5?"userIDList.length:".concat(e.userIDList.length):"userIDList:".concat(e.userIDList)),Pl.l("".concat(o," groupID:").concat(e.groupID," userIDList:").concat(e.userIDList.join(","))),e.userIDList.length>50&&(e.userIDList=e.userIDList.slice(0,50));var i=e.groupID,a=e.userIDList;return this._getGroupMemberProfileAdvance(t(t({},e),{},{userIDList:a})).then((function(e){var t=e.data.members;return $l(t)&&0!==t.length?(n._updateLocalGroupMemberMap(i,t),n.getModule(Gf).getUserProfile({userIDList:t.map((function(e){return e.userID})),tagList:[Ul.NICK,Ul.AVATAR]})):gI([])})).then((function(e){var t=e.data.map((function(e){return{userID:e.userID,nick:e.nick,avatar:e.avatar}}));n._updateLocalGroupMemberMap(i,t);var o=a.filter((function(e){return n.hasLocalGroupMember(i,e)})).map((function(e){return n.getLocalGroupMemberInfo(i,e)}));return r.setNetworkType(n.getNetworkType()).end(),dI({memberList:o})}))}},{key:"addGroupMember",value:function(e){var t=this,n="".concat(this._n,".").concat("addGroupMember"),o=e.groupID,r=this.getModule(xf).getLocalGroupProfile(o),i=r.type,a=new s_("addGroupMember");if(a.setMessage("groupID:".concat(o," groupType:").concat(i)),yd(i)){var s=new pI({code:fm});return a.setError(s,!0,this.getNetworkType()).end(),vI(s)}return e.userIDList=e.userIDList.map((function(e){return{userID:e}})),Pl.l("".concat(n," groupID:").concat(o)),this.request({protocolName:Ng,requestData:e}).then((function(o){var i=o.data.members;Pl.l("".concat(n," ok"));var s=i.filter((function(e){return 1===e.result})).map((function(e){return e.userID})),u=i.filter((function(e){return 0===e.result})).map((function(e){return e.userID})),c=i.filter((function(e){return 2===e.result})).map((function(e){return e.userID})),l=i.filter((function(e){return 4===e.result})).map((function(e){return e.userID})),d="groupID:".concat(e.groupID,", ")+"successUserIDList:".concat(s,", ")+"failureUserIDList:".concat(u,", ")+"existedUserIDList:".concat(c,", ")+"overLimitUserIDList:".concat(l);return a.setNetworkType(t.getNetworkType()).setMoreMessage(d).end(),0===s.length?dI({successUserIDList:s,failureUserIDList:u,existedUserIDList:c,overLimitUserIDList:l}):(r.memberCount+=s.length,t._updateConversationGroupProfile(r),dI({successUserIDList:s,failureUserIDList:u,existedUserIDList:c,overLimitUserIDList:l,group:r}))})).catch((function(e){return t.probeNetwork().then((function(t){var n=_(t,2),o=n[0],r=n[1];a.setError(e,o,r).end()})),Pl.e("".concat(n," failed. error:"),e),vI(e)}))}},{key:"deleteGroupMember",value:function(e){var t=this,n="".concat(this._n,".").concat("deleteGroupMember"),o=e.groupID,r=e.userIDList,i=this.getModule(xf).getLocalGroupProfile(o);if(Ql(i))return vI({code:sm});if(yd(i.type))return this.canIUse(Uc.AVCHATROOM_BAN_MBR)?this._banAVChatRoomMember(e):vI({code:Bm});var a=new s_("deleteGroupMember"),s="groupID:".concat(o," ").concat(r.length>5?"userIDList.length:".concat(r.length):"userIDList:".concat(r));return a.setMessage(s),Pl.l("".concat(n," groupID:").concat(o," userIDList:"),r),this.request({protocolName:Pg,requestData:e}).then((function(){return a.setNetworkType(t.getNetworkType()).end(),Pl.l("".concat(n," ok")),i.memberCount-=1,t._updateConversationGroupProfile(i),t.deleteLocalGroupMembers(o,r),dI({group:i,userIDList:r})})).catch((function(e){return t.probeNetwork().then((function(t){var n=_(t,2),o=n[0],r=n[1];a.setError(e,o,r).end()})),Pl.e("".concat(n," failed. error:"),e),vI(e)}))}},{key:"_updateConversationGroupProfile",value:function(e){this.getModule(Vf).updateConversationGroupProfile([e])}},{key:"_banAVChatRoomMember",value:function(e){var t=this,n="".concat(this._n,".").concat("deleteGroupMember"),o=e.groupID,r=e.userIDList,i="groupID:".concat(o," ").concat(r.length>5?"userIDList.length:".concat(r.length):"userIDList:".concat(r)),a=new s_("deleteGroupMember");a.setMessage(i),Pl.l("".concat(n," groupID:").concat(o," userIDList:"),r);var s=this.getModule(xf).getLocalGroupProfile(o);return Ql(e.duration)||0===e.duration?vI({code:Mm}):this.request({protocolName:Gg,requestData:e}).then((function(){return a.setNetworkType(t.getNetworkType()).end(),Pl.l("".concat(n," ok")),t.deleteLocalGroupMembers(o,r),dI({group:s,userIDList:r})})).catch((function(e){return t.probeNetwork().then((function(t){var n=_(t,2),o=n[0],r=n[1];a.setError(e,o,r).end()})),Pl.e("".concat(n," failed. error:"),e),vI(e)}))}},{key:"setGroupMemberMuteTime",value:function(e){var t=this,n=e.groupID,o=e.userID,r=e.muteTime,i="".concat(this._n,".").concat("setGroupMemberMuteTime");if(o===this.getMyUserID())return vI(new pI({code:ym}));Pl.l("".concat(i," groupID:").concat(n," userID:").concat(o));var a=new s_("setGroupMemberMuteTime");return a.setMessage("groupID:".concat(n," userID:").concat(o," muteTime:").concat(r)),this.modifyGroupMemberInfo({groupID:n,userID:o,muteTime:r}).then((function(e){a.setNetworkType(t.getNetworkType()).end(),Pl.l("".concat(i," ok"));var o=t.getModule(xf);return dI({group:o.getLocalGroupProfile(n),member:e})})).catch((function(e){return t.probeNetwork().then((function(t){var n=_(t,2),o=n[0],r=n[1];a.setError(e,o,r).end()})),Pl.e("".concat(i," failed. error:"),e),vI(e)}))}},{key:"setGroupMemberRole",value:function(e){var t=this,n="".concat(this._n,".").concat("setGroupMemberRole"),o=e.groupID,r=e.userID,i=e.role,a=this.getModule(xf).getLocalGroupProfile(o);if(a.selfInfo.role!==Ir.GRP_MBR_ROLE_OWNER)return vI({code:gm});if([Ir.GRP_WORK,Ir.GRP_AVCHATROOM].includes(a.type))return vI({code:vm});var s=[Ir.GRP_MBR_ROLE_ADMIN,Ir.GRP_MBR_ROLE_MEMBER];if(Md({groupID:o})&&s.push(Ir.GRP_MBR_ROLE_CUSTOM),s.indexOf(i)<0)return vI({code:mm});if(r===this.getMyUserID())return vI({code:_m});var u=new s_("setGroupMemberRole");return u.setMessage("groupID:".concat(o," userID:").concat(r," role:").concat(i)),Pl.l("".concat(n," groupID:").concat(o," userID:").concat(r)),this.modifyGroupMemberInfo({groupID:o,userID:r,role:i}).then((function(e){return u.setNetworkType(t.getNetworkType()).end(),Pl.l("".concat(n," ok")),dI({group:a,member:e})})).catch((function(e){return t.probeNetwork().then((function(t){var n=_(t,2),o=n[0],r=n[1];u.setError(e,o,r).end()})),Pl.e("".concat(n," failed. error:"),e),vI(e)}))}},{key:"_filterProfanity",value:function(e,t){var n=this.getModule(ah);if(!n)return!0;var o=n.filterText(t[e],Kc),r=o.isAllowedToSend,i=o.modifiedText;return!0===r&&(t[e]=i,!0)}},{key:"setGroupMemberNameCard",value:function(e){var t=this,n="".concat(this._n,".").concat("setGroupMemberNameCard");if(e.nameCard&&!1===this._filterProfanity("nameCard",e))return vI({code:Vm});var o=e.groupID,r=e.userID,i=void 0===r?this.getMyUserID():r,a=e.nameCard;Pl.l("".concat(n," groupID:").concat(o," userID:").concat(i));var s=new s_("setGroupMemberNameCard");return s.setMessage("groupID:".concat(o," userID:").concat(i," nameCard:").concat(a)),this.modifyGroupMemberInfo({groupID:o,userID:i,nameCard:a}).then((function(e){Pl.l("".concat(n," ok")),s.setNetworkType(t.getNetworkType()).end();var r=t.getModule(xf).getLocalGroupProfile(o);return i===t.getMyUserID()&&r&&r.setSelfNameCard(a),dI({group:r,member:e})})).catch((function(e){return t.probeNetwork().then((function(t){var n=_(t,2),o=n[0],r=n[1];s.setError(e,o,r).end()})),Pl.e("".concat(n," failed. error:"),e),vI(e)}))}},{key:"setGroupMemberCustomField",value:function(e){var t=this,n="".concat(this._n,".").concat("setGroupMemberCustomField"),o=e.groupID,r=e.userID,i=void 0===r?this.getMyUserID():r,a=e.memberCustomField;Pl.l("".concat(n," groupID:").concat(o," userID:").concat(i));var s=new s_("setGroupMemberCustomField");return s.setMessage("groupID:".concat(o," userID:").concat(i," memberCustomField:").concat(JSON.stringify(a))),this.modifyGroupMemberInfo({groupID:o,userID:i,memberCustomField:a}).then((function(e){s.setNetworkType(t.getNetworkType()).end(),Pl.l("".concat(n," ok"));var r=t.getModule(xf).getLocalGroupProfile(o);return dI({group:r,member:e})})).catch((function(e){return t.probeNetwork().then((function(t){var n=_(t,2),o=n[0],r=n[1];s.setError(e,o,r).end()})),Pl.e("".concat(n," failed. error:"),e),vI(e)}))}},{key:"modifyGroupMemberInfo",value:function(e){var n=this,o=e.groupID,r=e.userID,i=void 0;return Id(o)&&(o=Gd(i=o)),this.request({protocolName:Ug,requestData:t(t({},e),{},{groupID:o,topicID:i})}).then((function(){if(n.hasLocalGroupMember(o,r)){var t=n.getLocalGroupMemberInfo(o,r);return Ql(e.muteTime)||t.updateMuteUntil(e.muteTime),Ql(e.role)||t.updateRole(e.role),Ql(e.nameCard)||t.updateNameCard(e.nameCard),Ql(e.memberCustomField)||t.updateMemberCustomField(e.memberCustomField),t}return n.getGroupMemberProfile({groupID:o,userIDList:[r]}).then((function(e){return _(e.data.memberList,1)[0]}))}))}},{key:"markGroupMemberList",value:function(e){var t=this,n="".concat(this._n,".").concat("markGroupMemberList"),o=e.groupID,r=e.markType,i=e.enableMark,a=e.userIDList,s=void 0===a?[]:a,u="groupID:".concat(o," markType:").concat(r," enableMark:").concat(i," userIDList count: ").concat(s.length);Pl.l("".concat(n," ").concat(u));var c=2,l=[];!0===i&&(c=1);var d=y(s);s.length>500&&(d=s.slice(0,500),Pl.w("".concat(n," ").concat(Bd(500)))),d.forEach((function(e){l.push({userID:e,markType:[r]})})),d=null;var p=new s_("markGroupMemberList");return p.setMessage("".concat(u)),this.request({protocolName:xg,requestData:{groupID:o,operationType:c,memberList:l}}).then((function(e){var o=e.data.memberList,r=void 0===o?[]:o,i=[],a=[];r.length===s.length?i.push.apply(i,y(s)):(r.forEach((function(e){i.push(e.userID)})),s.forEach((function(e){i.includes(e)||a.push(e)})));var u="success count:".concat(i.length," fail count:").concat(a.length);return p.setNetworkType(t.getNetworkType()).setMessage(u).end(),Pl.l("".concat(n," ok. ").concat(u)),dI({successUserIDList:i,failureUserIDList:a})})).catch((function(e){return t.probeNetwork().then((function(t){var n=_(t,2),o=n[0],r=n[1];p.setError(e,o,r).end()})),Pl.e("".concat(n," failed. error:"),e),vI(e)}))}},{key:"_getGroupMemberProfileAdvance",value:function(e){return this.request({protocolName:Og,requestData:t(t({},e),{},{memberInfoFilter:e.memberInfoFilter?e.memberInfoFilter:["Role","JoinTime","NameCard","ShutUpUntil"]})})}},{key:"_updateLocalGroupMemberMap",value:function(e,t){var n=this;return $l(t)&&0!==t.length?t.map((function(t){return n.hasLocalGroupMember(e,t.userID)?n.getLocalGroupMemberInfo(e,t.userID).updateMember(t):n.setLocalGroupMember(e,new kC(t)),n.getLocalGroupMemberInfo(e,t.userID)})):[]}},{key:"deleteLocalGroupMembers",value:function(e,t){var n=this.groupMemberListMap.get(e);n&&t.forEach((function(e){n.delete(e)}))}},{key:"getLocalGroupMemberInfo",value:function(e,t){return this.groupMemberListMap.has(e)?this.groupMemberListMap.get(e).get(t):null}},{key:"setLocalGroupMember",value:function(e,t){if(this.groupMemberListMap.has(e))this.groupMemberListMap.get(e).set(t.userID,t);else{var n=(new Map).set(t.userID,t);this.groupMemberListMap.set(e,n)}}},{key:"getLocalGroupMemberList",value:function(e){return this.groupMemberListMap.get(e)}},{key:"hasLocalGroupMember",value:function(e,t){return this.groupMemberListMap.has(e)&&this.groupMemberListMap.get(e).has(t)}},{key:"hasLocalGroupMemberMap",value:function(e){return this.groupMemberListMap.has(e)}},{key:"reset",value:function(){this.groupMemberListMap.clear()}}]),o}(lh),SC=["topicID","topicName","avatar","introduction","notification","unreadCount","muteAllMembers","customData","groupAtInfoList","nextMessageSeq","selfInfo"],bC=function(e,t){return Hd(e)?{lastTime:0,lastSequence:0,fromAccount:"",payload:null,type:"",messageForShow:"",nick:"",version:0,cloudCustomData:"",isRevoked:!1,revoker:null}:{lastTime:e.time||0,lastSequence:e.sequence||0,fromAccount:e.from||"",payload:e.payload||null,type:e.type||"",messageForShow:Ud(e.type,e.payload,t),nick:e.nick||"",version:e.version||0,cloudCustomData:e.cloudCustomData||"",isRevoked:e.isRevoked||!1,revoker:e.revoker||null}},DC=function(){function e(t,n){r(this,e),this.topicID="",this.topicName="",this.avatar="",this.introduction="",this.notification="",this.unreadCount=0,this.muteAllMembers=!1,this.customData="",this.groupAtInfoList=[],this.nextMessageSeq=0,this.lastMessage=bC(t.lastMessage,n),this.selfInfo={muteTime:0,readedSequence:0,messageRemindType:"",excludedUnreadSequenceList:void 0},this._initTopic(t)}return a(e,[{key:"_initTopic",value:function(e){for(var t in e)SC.indexOf(t)<0||("selfInfo"===t?this.updateSelfInfo(e[t]):this[t]="muteAllMembers"===t?1===e[t]:e[t])}},{key:"updateUnreadCount",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.unreadCount=e}},{key:"updateNextMessageSeq",value:function(e){this.nextMessageSeq=e}},{key:"updateLastMessage",value:function(e){this.lastMessage=bC(e)}},{key:"updateGroupAtInfoList",value:function(e){this.groupAtInfoList=JSON.parse(JSON.stringify(e))}},{key:"updateTopic",value:function(e){Ql(e.selfInfo)||this.updateSelfInfo(e.selfInfo),Ql(e.muteAllMembers)||(this.muteAllMembers=1===e.muteAllMembers),sd(this,e,["groupID","lastMessageTime","selfInfo","muteAllMembers","lastMsg"])}},{key:"updateSelfInfo",value:function(e){return 0!==sd(this.selfInfo,e,[],[""])}},{key:"reduceUnreadCount",value:function(){return this.unreadCount>=1&&(this.unreadCount-=1,!0)}},{key:"isLastMessageRevoked",value:function(e){return e.sequence===this.lastMessage.lastSequence}},{key:"setLastMessageRevoked",value:function(e){this.lastMessage.isRevoked=e}},{key:"setLastMessageRevoker",value:function(e){this.lastMessage.revoker=e}}]),e}(),EC=function(e){u(o,e);var n=m(o);function o(e){var t;return r(this,o),(t=n.call(this,e))._n="TopicModule",t._topicMap=new Map,t._getTopicTimeMap=new Map,t.TOPIC_CACHE_TIME=300,t.TOPIC_LAST_ACTIVE_TIME=3600,t.getInnerEmitterInstance().on(NI,t._onCloudConfigUpdated,g(t)),t}return a(o,[{key:"_onCloudConfigUpdated",value:function(){var e=this.getCloudConfig("topic_cache_time"),t=this.getCloudConfig("topic_last_active_time");Ql(e)||(this.TOPIC_CACHE_TIME=Number(e)),Ql(t)||(this.TOPIC_LAST_ACTIVE_TIME=Number(t))}},{key:"onTopicCreated",value:function(e){var t=e.groupID;this.resetGetTopicTime(t),this.emitOuterEvent(Mr.TOPIC_CREATED,e)}},{key:"onTopicDeleted",value:function(e){var t=this,n=e.groupID,o=e.topicIDList;(void 0===o?[]:o).forEach((function(e){t._deleteLocalTopic(n,e)})),this.emitOuterEvent(Mr.TOPIC_DELETED,e)}},{key:"onTopicMessageRemindTypeUpdated",value:function(e){var t=e.groupID,n=e.topicID,o=e.messageRemindType,r=this.getLocalTopic(t,n);if(r){var i=r.updateSelfInfo({messageRemindType:o});i&&this.emitOuterEvent(Mr.TOPIC_UPDATED,{groupID:t,topic:r}),Pl.d("".concat(this._n,".onTopicMessageRemindTypeUpdated topicID:").concat(n)+" messageRemindType:".concat(o," isTopicUpdated:").concat(i))}}},{key:"onTopicProfileUpdated",value:function(e){var t=e.groupID,n=e.topicID,o=this.getLocalTopic(t,n);o&&(o.updateTopic(e),this.emitOuterEvent(Mr.TOPIC_UPDATED,{groupID:t,topic:o}))}},{key:"onConversationProxy",value:function(e){var t=e.topicID,n=e.unreadCount,o=e.groupAtInfoList,r=Gd(t),i=this.getLocalTopic(r,t),a=!1;i&&(Ql(n)||i.unreadCount===n||(i.updateUnreadCount(n),a=!0),Ql(o)||(i.updateGroupAtInfoList(o),a=!0)),a&&this.emitOuterEvent(Mr.TOPIC_UPDATED,{groupID:r,topic:i})}},{key:"onMessageSent",value:function(e){var t=e.groupID,n=e.topicID,o=e.lastMessage,r=this.getLocalTopic(t,n);r&&(r.nextMessageSeq+=1,r.updateLastMessage(o),this.emitOuterEvent(Mr.TOPIC_UPDATED,{groupID:t,topic:r}))}},{key:"onMessageModified",value:function(e){var t=e.to,n=e.time,o=e.sequence,r=e.elements,i=e.cloudCustomData,a=e.messageVersion,s=Gd(t),u=this.getLocalTopic(s,t);if(u){var c=u.lastMessage;Pl.d("".concat(this._n,".onMessageModified topicID:").concat(t," lastMessage:"),JSON.stringify(c),"options:",JSON.stringify(e)),c&&(null===c.payload||c.lastTime===n&&c.lastSequence===o&&c.version!==a)&&(c.type=r[0].type,c.payload=r[0].content,c.messageForShow=Ud(c.type,c.payload,this.isIntl()),c.cloudCustomData=i,c.version=a,c.lastSequence=o,c.lastTime=n,this.emitOuterEvent(Mr.TOPIC_UPDATED,{groupID:s,topic:u}))}}},{key:"onMessageRevoked",value:function(e){var t=this;if(0!==e.length){var n=null,o=null,r=!1;e.forEach((function(e){var i=e.to;o=Gd(i),(n=t.getLocalTopic(o,i))&&(n.reduceUnreadCount()&&(r=!0),n.isLastMessageRevoked(e)&&(n.setLastMessageRevoked(!0),n.setLastMessageRevoker(e.revoker),r=!0))})),r&&this.emitOuterEvent(Mr.TOPIC_UPDATED,{groupID:o,topic:n})}}},{key:"isLastMessageRevoked",value:function(e){var t=e.topicID,n=e.sequence,o=Gd(t),r=this.getLocalTopic(o,t),i=!1;return r&&(i=r.isLastMessageRevoked({sequence:n})),i}},{key:"getJoinedCommunityList",value:function(){return this.getModule(xf).getGroupList({isGroupWithTopicOnly:!0}).then((function(e){var t=e.data.groupList;return dI({groupList:void 0===t?[]:t})})).catch((function(e){return vI(e)}))}},{key:"createTopicInCommunity",value:function(e){var n=this,o="".concat(this._n,".").concat("createTopicInCommunity"),r=e.topicID;if(!Ql(r)&&!Id(r))return vI({code:qm});if(e.topicName&&!1===this._filterProfanity("topicName",e))return vI({code:Vm});if(e.introduction&&!1===this._filterProfanity("introduction",e))return vI({code:Vm});if(e.notification&&!1===this._filterProfanity("notification",e))return vI({code:Vm});var i=new s_("createTopicInCommunity");return this.request({protocolName:tv,requestData:t({},e)}).then((function(r){var a=r.data.topicID;return i.setMessage("topicID:".concat(a)).setNetworkType(n.getNetworkType()).end(),Pl.l("".concat(o," ok")),n._updateTopicMap([t(t({},e),{},{topicID:a})]),dI({topicID:a})})).catch((function(e){return n.probeNetwork().then((function(t){var n=_(t,2),o=n[0],r=n[1];i.setError(e,o,r).end()})),Pl.e("".concat(o," failed. error:"),e),vI(e)}))}},{key:"deleteTopicFromCommunity",value:function(e){var t=this,n="".concat(this._n,".").concat("deleteTopicFromCommunity"),o=e.groupID,r=e.topicIDList,i=void 0===r?[]:r,a=new s_("deleteTopicFromCommunity");return a.setMessage("groupID:".concat(o," topicIDList:").concat(i)),this.request({protocolName:nv,requestData:{groupID:o,topicIDList:i}}).then((function(e){var n=e.data.resultList,r=[],i=[];(void 0===n?[]:n).forEach((function(e){var t=e.topicID,n=e.errorCode,o=e.errorInfo;0===n?r.push({topicID:t}):i.push({topicID:t,code:n,message:o})}));var s="success count:".concat(r.length,", fail count:").concat(i.length);return a.setMoreMessage("".concat(s)).setNetworkType(t.getNetworkType()).end(),Pl.l("".concat(s)),r.forEach((function(e){t._deleteLocalTopic(o,e.topicID)})),dI({successTopicList:r,failureTopicList:i})})).catch((function(e){return t.probeNetwork().then((function(t){var n=_(t,2),o=n[0],r=n[1];a.setError(e,o,r).end()})),Pl.e("".concat(n," failed. error:"),e),vI(e)}))}},{key:"updateTopicProfile",value:function(e){var n=this,o="".concat(this._n,".").concat("updateTopicProfile");if(Pl.l("".concat(o," options:"),e),e.topicName&&!1===this._filterProfanity("topicName",e))return vI({code:Vm});if(e.introduction&&!1===this._filterProfanity("introduction",e))return vI({code:Vm});if(e.notification&&!1===this._filterProfanity("notification",e))return vI({code:Vm});var r=new s_("updateTopicProfile");return r.setMessage("groupID:".concat(e.groupID," topicID:").concat(e.topicID)),Ql(e.muteAllMembers)||(e.muteAllMembers=!0===e.muteAllMembers?"On":"Off"),this.request({protocolName:ov,requestData:t({},e)}).then((function(){return r.setNetworkType(n.getNetworkType()).end(),Pl.l("".concat(o," ok")),n._updateTopicMap([e]),dI({topic:n.getLocalTopic(e.groupID,e.topicID)})})).catch((function(e){return n.probeNetwork().then((function(t){var n=_(t,2),o=n[0],i=n[1];r.setError(e,o,i).end()})),Pl.e("".concat(o," failed. error:"),e),vI(e)}))}},{key:"getTopicList",value:function(e){var n=this,o="".concat(this._n,".").concat("getTopicList"),r=e.groupID,i=e.topicIDList,a=void 0===i?[]:i,s=0===a.length,u=new s_("getTopicList");if(u.setMessage("groupID:".concat(r)),this._getTopicTimeMap.has(r)){var c=this._getTopicTimeMap.get(r),l=c.isGetAll,d=c.time;if((l||!l&&!s)&&Date.now()-d<1e3*this.TOPIC_CACHE_TIME){var p=this._getLocalTopicList(r,a);if(s||p.length===a.length)return u.setNetworkType(this.getNetworkType()).setMoreMessage("from cache, topic count:".concat(p.length)).end(),Pl.l("".concat(o," groupID:").concat(r," from cache, topic count:").concat(p.length)),gI({successTopicList:p,failureTopicList:[]})}}return this.request({protocolName:rv,requestData:{groupID:r,topicIDList:a}}).then((function(e){var i=e.data.topicInfoList,a=[],c=[],l=[];(void 0===i?[]:i).forEach((function(e){var n=e.topic,o=e.selfInfo,r=e.errorCode,i=e.errorInfo,s=n.topicID;0===r?(a.push(t(t({},n),{},{selfInfo:o})),c.push(s)):l.push({topicID:s,code:r,message:i})})),n._updateTopicMap(a),n._handleTopicAtInfo(a);var d="success count:".concat(c.length,", fail count:").concat(l.length);u.setNetworkType(n.getNetworkType()).setMoreMessage("".concat(d)).end(),Pl.l("".concat(o," groupID:").concat(r," from remote, ").concat(d));var p=[];return Hd(c)||(n._getTopicTimeMap.set(r,{time:Date.now(),isGetAll:s}),p=n._getLocalTopicList(r,c)),dI({successTopicList:p,failureTopicList:l})})).catch((function(e){return n.probeNetwork(e).then((function(t){var n=_(t,2),o=n[0],r=n[1];u.setError(e,o,r).end()})),Pl.e("".concat(o," failed. error:"),e),vI(e)}))}},{key:"hasLocalTopic",value:function(e,t){return!!this._topicMap.has(e)&&this._topicMap.get(e).has(t)}},{key:"getLocalTopic",value:function(e,t){var n=null;return this._topicMap.has(e)&&(n=this._topicMap.get(e).get(t)),n}},{key:"_getLocalTopicList",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=this._topicMap.get(e),o=[];return n&&(o=y(n.values())),0===t.length?o:o.filter((function(e){return t.includes(e.topicID)}))}},{key:"_deleteLocalTopic",value:function(e,t){this._topicMap.has(e)&&(this._topicMap.get(e).delete(t),Pl.l("".concat(this._n,"._deleteLocalTopic groupID:").concat(e," topicID:").concat(t)))}},{key:"_updateTopicMap",value:function(e){var t=this,n=[];e.forEach((function(e){var o=e.groupID,r=e.topicID,i=null;t._topicMap.has(o)||t._topicMap.set(o,new Map),t._topicMap.get(o).has(r)?(i=t._topicMap.get(o).get(r)).updateTopic(e):(t._getTopicLastMessage(e),i=new DC(e,t.isIntl()),t._topicMap.get(o).set(r,i));var a=t._computeUnreadCount(i);i.updateUnreadCount(a),n.push({conversationID:"".concat(Ir.CONV_GROUP).concat(r),type:Ir.CONV_TOPIC,unreadCount:a})})),n.length>0&&this.getModule(Vf).updateTopicConversation(n)}},{key:"resetGetTopicTime",value:function(e){var t=this;Ql(e)?y(this._getTopicTimeMap.keys()).forEach((function(e){t._getTopicTimeMap.set(e,0)})):this._getTopicTimeMap.set(e,0)}},{key:"getTopicListOnReconnected",value:function(){var e=this,t=y(this._topicMap.keys()),n=[];t.forEach((function(t){var o=[];e._getLocalTopicList(t).forEach((function(t){var n=t.lastMessage.lastTime,r=void 0===n?0:n;Date.now()-1e3*r<1e3*e.TOPIC_LAST_ACTIVE_TIME&&o.push(t.topicID)})),o.length>0&&n.push({groupID:t,topicIDList:o})})),Pl.l("".concat(this._n,".getTopicListOnReconnected. active community count:").concat(n.length)),this._relayGetTopicList(n)}},{key:"_relayGetTopicList",value:function(e){var t=this;if(0!==e.length){var n=e.shift(),o=n.topicIDList.length>5?"topicIDList.length:".concat(n.topicIDList.length):"topicIDList:".concat(n.topicIDList),r=new s_("relayGetTopicList");r.setMessage(o),Pl.l("".concat(this._n,"._relayGetTopicList. ").concat(o)),this.getTopicList(n).then((function(){r.setNetworkType(t.getNetworkType()).end(),t._relayGetTopicList(e)})).catch((function(n){t.probeNetwork().then((function(e){var t=_(e,2),o=t[0],i=t[1];r.setError(n,o,i).end()})),t._relayGetTopicList(e)}))}}},{key:"_handleTopicAtInfo",value:function(e){var n=this;0!==e.length&&e.forEach((function(e){var o=e.groupID,r=e.topicID,i=e.groupAtInfoList,a=[];Ql(i)||(i.forEach((function(e){a.push(t(t({},e),{},{groupID:o,topicID:r}))})),n.getModule(Vf).onNewGroupAtTips({dataList:a}))}))}},{key:"_getTopicLastMessage",value:function(e){if(!Ql(e.lastMsg)){var t={time:e.lastMsg.time,sequence:e.lastMsg.sequence,from:e.lastMsg.from,payload:e.lastMsg.elements[0]?e.lastMsg.elements[0].content:null,type:e.lastMsg.elements[0]?e.lastMsg.elements[0].type:"",nick:e.lastMsg.nick,version:e.lastMsg.messageVersion,cloudCustomData:e.lastMsg.cloudCustomData,isRevoked:2===e.lastMsg.isPlaceMessage,revoker:Hd(e.lastMsg.revokerInfo)?null:e.lastMsg.revokerInfo.revoker};e.lastMessage=t}}},{key:"deleteTopicListInCommunity",value:function(e){var t=this,n=this._getLocalTopicList(e),o=this.getModule(Vf);n.forEach((function(n){var r=n.topicID;t._deleteLocalTopic(e,r),t._getTopicTimeMap.delete(e),o.deleteLocalConversation("".concat(Ir.CONV_GROUP).concat(r))}))}},{key:"_computeUnreadCount",value:function(e){var t=e.selfInfo,n=t.excludedUnreadSequenceList,o=t.readedSequence,r=e.nextMessageSeq-e.selfInfo.readedSequence-1;if($l(n)){var i=0;n.forEach((function(t){t>=o&&t<=e.nextMessageSeq-1&&(i+=1)})),i>=1&&(r-=i)}return r<0?0:r}},{key:"_filterProfanity",value:function(e,t){var n=this.getModule(ah);if(!n)return!0;var o=n.filterText(t[e],Hc),r=o.isAllowedToSend,i=o.modifiedText;return!0===r&&(t[e]=i,!0)}},{key:"updateLastMessage",value:function(e,t){var n=Gd(e),o=this.getLocalTopic(n,e);if(o){var r=t.sequence+1;o.updateNextMessageSeq(r),o.updateLastMessage(t),this.emitOuterEvent(Mr.TOPIC_UPDATED,{groupID:n,topic:o})}}},{key:"reset",value:function(){Pl.l("".concat(this._n,".reset")),this._topicMap.clear(),this._getTopicTimeMap.clear(),this.TOPIC_CACHE_TIME=300,this.TOPIC_LAST_ACTIVE_TIME=3600}}]),o}(lh),AC=function(){function e(t){r(this,e),this._userModule=t,this._n="ProfileHandler",this.TAG="profile",this.accountProfileMap=new Map,this.expirationTime=864e5}return a(e,[{key:"setExpirationTime",value:function(e){this.expirationTime=e}},{key:"getUserProfile",value:function(e){var t=this,n=e.userIDList;e.fromAccount=this._userModule.getMyAccount(),n.length>100&&(Pl.w("".concat(this._n,".getUserProfile ").concat(Bd(100))),n.length=100);for(var o,r=[],i=[],a=0,s=n.length;a<s;a++)o=n[a],this._userModule.isMyFriend(o)&&this._containsAccount(o)?i.push(this._getProfileFromMap(o)):r.push(o);if(0===r.length)return gI(i);e.toAccount=r;var u=e.bFromGetMyProfile||!1,c=[];e.toAccount.forEach((function(e){c.push({toAccount:e,standardSequence:0,customSequence:0})})),e.userItem=c;var l=new s_("getUserProfile");return l.setMessage(n.length>5?"userIDList.length:".concat(n.length):"userIDList:".concat(n)),this._userModule.request({protocolName:yh,requestData:e}).then((function(e){l.setNetworkType(t._userModule.getNetworkType()).end(),Pl.i("".concat(t._n,".getUserProfile ok"));var n=t._handleResponse(e).concat(i);return dI(u?n[0]:n)})).catch((function(e){return t._userModule.probeNetwork().then((function(t){var n=_(t,2),o=n[0],r=n[1];l.setError(e,o,r).end()})),Pl.e("".concat(t._n,".getUserProfile failed. error:"),e),vI(e)}))}},{key:"getMyProfile",value:function(){var e=this._userModule.getMyAccount();if(Pl.l("".concat(this._n,".getMyProfile myAccount:").concat(e)),this._fillMap(),this._containsAccount(e)){var t=this._getProfileFromMap(e);return Pl.d("".concat(this._n,".getMyProfile from cache, myProfile:")+JSON.stringify(t)),gI(t)}return this.getUserProfile({fromAccount:e,userIDList:[e],bFromGetMyProfile:!0})}},{key:"_handleResponse",value:function(e){for(var t,n,o=ad(),r=e.data.userProfileItem,i=[],a=0,s=r.length;a<s;a++)"@TLS#NOT_FOUND"!==r[a].to&&""!==r[a].to&&(t=r[a].to,n=this._updateMap(t,this._getLatestProfileFromResponse(t,r[a].profileItem)),i.push(n));return Pl.l("".concat(this._n,"._handleResponse cost ").concat(ad()-o," ms")),i}},{key:"_getLatestProfileFromResponse",value:function(e,t){var n={};if(n.userID=e,n.profileCustomField=[],!Hd(t))for(var o=0,r=t.length;o<r;o++)if(t[o].tag.indexOf("Tag_Profile_Custom")>-1)n.profileCustomField.push({key:t[o].tag,value:t[o].value});else switch(t[o].tag){case Ul.NICK:n.nick=t[o].value;break;case Ul.GENDER:n.gender=t[o].value;break;case Ul.BIRTHDAY:n.birthday=t[o].value;break;case Ul.LOCATION:n.location=t[o].value;break;case Ul.SELFSIGNATURE:n.selfSignature=t[o].value;break;case Ul.ALLOWTYPE:n.allowType=t[o].value;break;case Ul.LANGUAGE:n.language=t[o].value;break;case Ul.AVATAR:n.avatar=t[o].value;break;case Ul.MESSAGESETTINGS:n.messageSettings=t[o].value;break;case Ul.ADMINFORBIDTYPE:n.adminForbidType=t[o].value;break;case Ul.LEVEL:n.level=t[o].value;break;case Ul.ROLE:n.role=t[o].value;break;default:Pl.w("".concat(this._n,"._handleResponse unknown tag:"),t[o].tag,t[o].value)}return n}},{key:"updateMyProfile",value:function(e){var t=this,n="".concat(this._n,".updateMyProfile");if(e.nick&&!1===this._userModule.filterProfanity("nick",e))return vI({code:Vm});if(e.selfSignature&&!1===this._userModule.filterProfanity("selfSignature",e))return vI({code:Vm});var o=new s_("updateMyProfile");o.setMessage(JSON.stringify(e));var r=(new HI).validate(e);if(!r.valid)return o.setCode(Im).setMoreMessage("updateMyProfile info:".concat(r.tips)).setNetworkType(this._userModule.getNetworkType()).end(),Pl.e("".concat(n," info:").concat(r.tips)),vI({code:Im});var i=[];for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&("profileCustomField"===a?e.profileCustomField.forEach((function(e){i.push({tag:e.key,value:e.value})})):i.push({tag:Ul[a.toUpperCase()],value:e[a]}));if(0===i.length){var s=new pI({code:Cm});return o.setError(s,!0,this._userModule.getNetworkType()).end(),Pl.e("".concat(n," failed. error:"),s),vI(s)}return this._userModule.request({protocolName:Mh,requestData:{fromAccount:this._userModule.getMyAccount(),profileItem:i}}).then((function(r){o.setNetworkType(t._userModule.getNetworkType()).end(),Pl.i("".concat(n," ok"));var i=t._updateMap(t._userModule.getMyAccount(),e);return t._userModule.emitOuterEvent(Mr.PROFILE_UPDATED,[i]),gI(i)})).catch((function(e){return t._userModule.probeNetwork().then((function(t){var n=_(t,2),r=n[0],i=n[1];o.setError(e,r,i).end()})),Pl.e("".concat(n," failed. error:"),e),vI(e)}))}},{key:"onProfileModified",value:function(e){var t=e.dataList;if(!Hd(t)){var n,o,r=t.length;Pl.d("".concat(this._n,".onProfileModified count:").concat(r," dataList:"),e.dataList);for(var i=[],a=0;a<r;a++)n=t[a].userID,o=this._updateMap(n,this._getLatestProfileFromResponse(n,t[a].profileList)),i.push(o);i.length>0&&(this._userModule.emitInnerEvent(PI,i),this._userModule.emitOuterEvent(Mr.PROFILE_UPDATED,i))}}},{key:"_fillMap",value:function(){if(0===this.accountProfileMap.size){for(var e=this._getCachedProfiles(),t=Date.now(),n=0,o=e.length;n<o;n++)t-e[n].lastUpdatedTime<this.expirationTime&&this.accountProfileMap.set(e[n].userID,e[n]);Pl.l("".concat(this._n,"._fillMap from cache, map.size:").concat(this.accountProfileMap.size))}}},{key:"_updateMap",value:function(e,t){var n,o=Date.now();return this._containsAccount(e)?(n=this._getProfileFromMap(e),t.profileCustomField&&md(n.profileCustomField,t.profileCustomField),sd(n,t,["profileCustomField"]),n.lastUpdatedTime=o):(n=new HI(t),(this._userModule.isMyFriend(e)||e===this._userModule.getMyAccount())&&(n.lastUpdatedTime=o,this.accountProfileMap.set(e,n))),this._flushMap(e===this._userModule.getMyAccount()),n}},{key:"_flushMap",value:function(e){var t=y(this.accountProfileMap.values()),n=this._userModule.getStorageModule();Pl.d("".concat(this._n,"._flushMap length:").concat(t.length," flushAtOnce:").concat(e)),n.setItem(this.TAG,t,e)}},{key:"_containsAccount",value:function(e){return this.accountProfileMap.has(e)}},{key:"_getProfileFromMap",value:function(e){return this.accountProfileMap.get(e)}},{key:"_getCachedProfiles",value:function(){var e=this._userModule.getStorageModule().getItem(this.TAG);return Hd(e)?[]:e}},{key:"onConversationsProfileUpdated",value:function(e){for(var t,n,o,r=[],i=0,a=e.length;i<a;i++)n=(t=e[i]).userID,this._userModule.isMyFriend(n)||(this._containsAccount(n)?(o=this._getProfileFromMap(n),sd(o,t)>0&&r.push(n)):r.push(t.userID));0!==r.length&&(Pl.i("".concat(this._n,".onConversationsProfileUpdated toAccountList:").concat(r)),this.getUserProfile({userIDList:r}))}},{key:"getNickAndAvatarByUserID",value:function(e){if(this._containsAccount(e)){var t=this._getProfileFromMap(e);return{nick:t.nick,avatar:t.avatar}}return{nick:"",avatar:""}}},{key:"reset",value:function(){this._flushMap(!0),this.accountProfileMap.clear()}}]),e}(),LC=a((function e(t){r(this,e),Hd||(this.userID=t.userID||"",this.timeStamp=t.timeStamp||0)})),RC=function(){function e(t){r(this,e),this._userModule=t,this._n="BlacklistHandler",this._blacklistMap=new Map,this.startIndex=0,this.maxLimited=100,this.currentSequence=0}return a(e,[{key:"getLocalBlacklist",value:function(){return y(this._blacklistMap.keys())}},{key:"getBlacklist",value:function(){var e=this,t="".concat(this._n,".getBlacklist"),n={fromAccount:this._userModule.getMyAccount(),maxLimited:this.maxLimited,startIndex:0,lastSequence:this.currentSequence},o=new s_("getBlacklist");return this._userModule.request({protocolName:Ih,requestData:n}).then((function(n){var r=n.data,i=r.blackListItem,a=r.currentSequence,s=Hd(i)?0:i.length;o.setNetworkType(e._userModule.getNetworkType()).setMessage("count:".concat(s)).end(),Pl.i("".concat(t," ok")),e.currentSequence=a,e._handleResponse(i,!0),e._userModule.emitOuterEvent(Mr.BLACKLIST_UPDATED,y(e._blacklistMap.keys()))})).catch((function(n){return e._userModule.probeNetwork().then((function(e){var t=_(e,2),r=t[0],i=t[1];o.setError(n,r,i).end()})),Pl.e("".concat(t," failed. error:"),n),vI(n)}))}},{key:"addBlacklist",value:function(e){var t=this,n=new s_("addToBlacklist"),o="".concat(this._n,".addBlacklist"),r=this._userModule.getMyAccount();if(1===e.userIDList.length&&e.userIDList[0]===r){var i=km,a=this._userModule.getErrorMessage(i);n.setCode(i).setMessage(a).setNetworkType(this._userModule.getNetworkType()).end();var s=new pI({code:i});return Pl.e("".concat(o," failed. error:"),s),vI(s)}return e.userIDList.includes(r)&&(e.userIDList=e.userIDList.filter((function(e){return e!==r}))),e.fromAccount=this._userModule.getMyAccount(),e.toAccount=e.userIDList,this._userModule.request({protocolName:Ch,requestData:e}).then((function(r){return n.setNetworkType(t._userModule.getNetworkType()).setMessage(e.userIDList.length>5?"userIDList.length:".concat(e.userIDList.length):"userIDList:".concat(e.userIDList)).end(),Pl.i("".concat(o," ok")),t._handleResponse(r.resultItem,!0),dI(y(t._blacklistMap.keys()))})).catch((function(e){return t._userModule.probeNetwork().then((function(t){var o=_(t,2),r=o[0],i=o[1];n.setError(e,r,i).end()})),Pl.e("".concat(o," failed. error:"),e),vI(e)}))}},{key:"_handleResponse",value:function(e,t){if(!Hd(e))for(var n,o,r,i=0,a=e.length;i<a;i++)o=e[i].to,r=e[i].resultCode,(Ql(r)||0===r)&&(t?((n=this._blacklistMap.has(o)?this._blacklistMap.get(o):new LC).userID=o,!Hd(e[i].addBlackTimeStamp)&&(n.timeStamp=e[i].addBlackTimeStamp),this._blacklistMap.set(o,n)):this._blacklistMap.has(o)&&(n=this._blacklistMap.get(o),this._blacklistMap.delete(o)));Pl.l("".concat(this._n,"._handleResponse total:").concat(this._blacklistMap.size," bAdd:").concat(t))}},{key:"deleteBlacklist",value:function(e){var t=this,n="".concat(this._n,".deleteBlacklist"),o=new s_("removeFromBlacklist");return e.fromAccount=this._userModule.getMyAccount(),e.toAccount=e.userIDList,this._userModule.request({protocolName:kh,requestData:e}).then((function(r){return o.setNetworkType(t._userModule.getNetworkType()).setMessage(e.userIDList.length>5?"userIDList.length:".concat(e.userIDList.length):"userIDList:".concat(e.userIDList)).end(),Pl.i("".concat(n," ok")),t._handleResponse(r.data.resultItem,!1),dI(y(t._blacklistMap.keys()))})).catch((function(e){return t._userModule.probeNetwork().then((function(t){var n=_(t,2),r=n[0],i=n[1];o.setError(e,r,i).end()})),Pl.e("".concat(n," failed. error:"),e),vI(e)}))}},{key:"onAccountDeleted",value:function(e){for(var t,n=[],o=0,r=e.length;o<r;o++)t=e[o],this._blacklistMap.has(t)&&(this._blacklistMap.delete(t),n.push(t));n.length>0&&(Pl.l("".concat(this._n,".onAccountDeleted count:").concat(n.length," userIDList:"),n),this._userModule.emitOuterEvent(Mr.BLACKLIST_UPDATED,y(this._blacklistMap.keys())))}},{key:"onAccountAdded",value:function(e){for(var t,n=[],o=0,r=e.length;o<r;o++)t=e[o],this._blacklistMap.has(t)||(this._blacklistMap.set(t,new LC({userID:t})),n.push(t));n.length>0&&(Pl.l("".concat(this._n,".onAccountAdded count:").concat(n.length," userIDList:"),n),this._userModule.emitOuterEvent(Mr.BLACKLIST_UPDATED,y(this._blacklistMap.keys())))}},{key:"reset",value:function(){this._blacklistMap.clear(),this.startIndex=0,this.maxLimited=100,this.currentSequence=0}}]),e}(),wC=function(e){var t=String(e).replace(/[=]+$/,""),n="";if(t.length%4==1)return"";for(var o,r,i=0,a=0;r=t.charAt(a++);~r&&(o=i%4?64*o+r:r,i++%4)?n+=String.fromCharCode(255&o>>(-2*i&6)):0)r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(r);try{return decodeURIComponent(escape(n))}catch(yD){return""}},OC=function(){function e(t){r(this,e),this._userModule=t,this._n="UserStatusHandler",this.MAX_QUERY_USER_COUNT=500,this.MAX_SUBSCRIBE_USER_COUNT=100,this.MAX_UNSUBSCRIBE_USER_COUNT=100,this._userModule.getInnerEmitterInstance().on(NI,this._onCloudConfigUpdated,this)}return a(e,[{key:"_onCloudConfigUpdated",value:function(){var e=this._userModule.getCloudConfig("status_query_count"),t=this._userModule.getCloudConfig("status_sub_count"),n=this._userModule.getCloudConfig("status_unsub_count");Pl.l("".concat(this._n,"._onCloudConfigUpdated statusQueryCount:").concat(e," statusSubscribeCount:").concat(t)+" statusUnsubscribeCount:".concat(n)),Ql(e)||(this.MAX_QUERY_USER_COUNT=parseInt(e,10)),Ql(e)||(this.MAX_SUBSCRIBE_USER_COUNT=parseInt(t,10)),Ql(e)||(this.MAX_UNSUBSCRIBE_USER_COUNT=parseInt(n,10))}},{key:"onUserStatusUpdated",value:function(e){var t=e.dataList,n=this._userModule.getMyUserID(),o=this._userModule.getModule(Hf),r=t.map((function(e){var t=e.to,r=e.statusType,i=e.customStatus,a=wC(i);return t===n&&o.setCustomStatus(a),{userID:t,statusType:r,customStatus:a}}));this._userModule.emitOuterEvent(Mr.USER_STATUS_UPDATED,r)}},{key:"setSelfStatus",value:function(e){var t=this,n="".concat(this._n,".setSelfStatus");if(!1===this._userModule.filterProfanity("customStatus",e))return vI({code:Vm});var o=new s_("setSelfStatus"),r=e.customStatus;return this._userModule.request({protocolName:iv,requestData:{customStatus:r}}).then((function(e){return o.setNetworkType(t._userModule.getNetworkType()).setMessage("customStatus:".concat(r)).end(),Pl.l("".concat(n," ok. customStatus:").concat(r)),t._userModule.getModule(Hf).setCustomStatus(r),dI({userID:t._userModule.getMyUserID(),statusType:1,customStatus:r})})).catch((function(e){return t._userModule.probeNetwork().then((function(t){var n=_(t,2),r=n[0],i=n[1];o.setError(e,r,i).end()})),Pl.e("".concat(n," failed. error:"),e),vI(e)}))}},{key:"getUserStatus",value:function(e){var t=this,n="".concat(this._n,".getUserStatus"),o=e.userIDList,r=void 0===o?[]:o,i=this._userModule.getMyUserID(),a=y(r),s=void 0,u=a.indexOf(i);if(u>-1){a.splice(u,1);var c=this._userModule.getModule(Hf).getCustomStatus();s={userID:i,statusType:1,customStatus:c}}if(0===a.length)return gI({successUserList:[s],failureUserList:[]});if(!this._userModule.canIUse(Uc.USER_STATUS))return vI({code:Bm});a.length>this.MAX_QUERY_USER_COUNT&&(Pl.w("".concat(n," ").concat(Bd(this.MAX_QUERY_USER_COUNT))),a=r.slice(0,this.MAX_QUERY_USER_COUNT));var l=new s_("getUserStatus");return this._userModule.request({protocolName:av,requestData:{userIDList:a}}).then((function(e){var o=e.data,i=o.successUserList,a=void 0===i?[]:i,u=o.failureUserList,c=void 0===u?[]:u,d=a.map((function(e){var t=e.userID,n=e.statusType,o=e.customStatus;return{userID:t,statusType:n,customStatus:wC(o)}})),p=c.map((function(e){var t=e.userID,n=e.invalidUserID,o=e.errorCode,r=e.errorInfo;return{userID:Hd(n)?t:n,code:o,message:r}}));Ql(s)||d.unshift(s);var f="userID count:".concat(r.length,", success count:").concat(d.length,", fail count:").concat(p.length);return l.setNetworkType(t._userModule.getNetworkType()).setMessage("".concat(f)).end(),Pl.l("".concat(n," ok. ").concat(f,".")),dI({successUserList:d,failureUserList:p})})).catch((function(e){return t._userModule.probeNetwork().then((function(t){var n=_(t,2),o=n[0],i=n[1];l.setMessage("userID count:".concat(r.length)).setError(e,o,i).end()})),Pl.e("".concat(n," failed. error:"),e),vI(e)}))}},{key:"subscribeUserStatus",value:function(e){var t=this;if(!this._userModule.canIUse(Uc.USER_STATUS))return vI({code:Bm});var n="".concat(this._n,".subscribeUserStatus"),o=e.userIDList,r=void 0===o?[]:o,i=y(r);i.length>this.MAX_SUBSCRIBE_USER_COUNT&&(Pl.w("".concat(n," ").concat(Bd(this.MAX_SUBSCRIBE_USER_COUNT))),i=r.slice(0,this.MAX_SUBSCRIBE_USER_COUNT));var a=new s_("subscribeUserStatus"),s="userID count:".concat(r.length);return Pl.l("".concat(n," ").concat(s)),this._userModule.request({protocolName:sv,requestData:{userIDList:i}}).then((function(e){var o=e.data.failureUserList,r=(void 0===o?[]:o).map((function(e){var t=e.userID,n=e.invalidUserID,o=e.errorCode,r=e.errorInfo;return{userID:Hd(n)?t:n,code:o,message:r}}));return a.setNetworkType(t._userModule.getNetworkType()).setMessage("".concat(s," fail count:").concat(r.length)).end(),Pl.l("".concat(n," ok. fail count:").concat(r.length,".")),dI({failureUserList:r})})).catch((function(e){return t._userModule.probeNetwork().then((function(t){var n=_(t,2),o=n[0],r=n[1];a.setMessage("".concat(s)).setError(e,o,r).end()})),Pl.e("".concat(n," failed. error:"),e),vI(e)}))}},{key:"unsubscribeUserStatus",value:function(e){var t=this;if(!this._userModule.canIUse(Uc.USER_STATUS))return vI({code:Bm});var n="".concat(this._n,".unsubscribeUserStatus"),o=(e||{}).userIDList,r=void 0===o?[]:o,i=y(r);r.length>this.MAX_UNSUBSCRIBE_USER_COUNT&&(Pl.w("".concat(n," ").concat(Bd(this.MAX_UNSUBSCRIBE_USER_COUNT))),i=r.slice(0,this.MAX_UNSUBSCRIBE_USER_COUNT));var a=new s_("unsubscribeUserStatus"),s="userID count:".concat(r.length);Pl.l("".concat(n," ").concat(s));var u={userIDList:i};return 0===i.length&&(u.userIDList=void 0,u.unsubscribeAll=1),this._userModule.request({protocolName:uv,requestData:u}).then((function(e){var o=e.data.failureUserList,r=(void 0===o?[]:o).map((function(e){var t=e.userID,n=e.invalidUserID,o=e.errorCode,r=e.errorInfo;return{userID:Hd(n)?t:n,code:o,message:r}}));return a.setNetworkType(t._userModule.getNetworkType()).setMessage("".concat(s," fail count:").concat(r.length)).end(),Pl.l("".concat(n," ok. fail count:").concat(r.length,".")),dI({failureUserList:r})})).catch((function(e){return t._userModule.probeNetwork().then((function(t){var n=_(t,2),o=n[0],r=n[1];a.setMessage("".concat(s)).setError(e,o,r).end()})),Pl.e("".concat(n," failed. error:"),e),vI(e)}))}},{key:"reset",value:function(){this.MAX_QUERY_USER_COUNT=500,this.MAX_SUBSCRIBE_USER_COUNT=100,this.MAX_UNSUBSCRIBE_USER_COUNT=100}}]),e}(),NC=function(e){u(n,e);var t=m(n);function n(e){var o;return r(this,n),(o=t.call(this,e))._n="UserModule",o._profileHandler=new AC(g(o)),o._blacklistHandler=new RC(g(o)),o._userStatusHandler=new OC(g(o)),o.getInnerEmitterInstance().on(OI,o.onContextUpdated,g(o)),o}return a(n,[{key:"onContextUpdated",value:function(e){this._profileHandler.getMyProfile(),this._blacklistHandler.getBlacklist()}},{key:"onProfileModified",value:function(e){this._profileHandler.onProfileModified(e)}},{key:"onRelationChainModified",value:function(e){var t=e.dataList;if(!Hd(t)){var n=[];t.forEach((function(e){e.blackListDelAccount&&n.push.apply(n,y(e.blackListDelAccount))})),n.length>0&&this._blacklistHandler.onAccountDeleted(n);var o=[];t.forEach((function(e){e.blackListAddAccount&&o.push.apply(o,y(e.blackListAddAccount))})),o.length>0&&this._blacklistHandler.onAccountAdded(o)}}},{key:"onConversationsProfileUpdated",value:function(e){this._profileHandler.onConversationsProfileUpdated(e)}},{key:"getMyAccount",value:function(){return this.getMyUserID()}},{key:"getMyProfile",value:function(){return this._profileHandler.getMyProfile()}},{key:"getStorageModule",value:function(){return this.getModule(Kf)}},{key:"filterProfanity",value:function(e,t){var n=this.getModule(ah);if(!n)return!0;var o=n.filterText(t[e],Vc),r=o.isAllowedToSend,i=o.modifiedText;return!0===r&&(t[e]=i,!0)}},{key:"isMyFriend",value:function(e){var t=this.getModule(Ff);return!!t&&t.isMyFriend(e)}},{key:"getUserProfile",value:function(e){return this._profileHandler.getUserProfile(e)}},{key:"updateMyProfile",value:function(e){return this._profileHandler.updateMyProfile(e)}},{key:"getNickAndAvatarByUserID",value:function(e){return this._profileHandler.getNickAndAvatarByUserID(e)}},{key:"getLocalBlacklist",value:function(){var e=this._blacklistHandler.getLocalBlacklist();return gI(e)}},{key:"addBlacklist",value:function(e){return this._blacklistHandler.addBlacklist(e)}},{key:"deleteBlacklist",value:function(e){return this._blacklistHandler.deleteBlacklist(e)}},{key:"onUserStatusUpdated",value:function(e){this._userStatusHandler.onUserStatusUpdated(e)}},{key:"setSelfStatus",value:function(e){return this._userStatusHandler.setSelfStatus(e)}},{key:"getUserStatus",value:function(e){return this._userStatusHandler.getUserStatus(e)}},{key:"subscribeUserStatus",value:function(e){return this._userStatusHandler.subscribeUserStatus(e)}},{key:"unsubscribeUserStatus",value:function(e){return this._userStatusHandler.unsubscribeUserStatus(e)}},{key:"reset",value:function(){Pl.l("".concat(this._n,".reset")),this._profileHandler.reset(),this._blacklistHandler.reset(),this._userStatusHandler.reset()}}]),n}(lh),PC=function(){function e(t,n){r(this,e),this._m=t,this._isLoggedIn=!1,this._SDKAppID=n.SDKAppID,this._userID=n.userID||"",this._userSig=n.userSig||"",this._version="2.26.3",this._a2Key="",this._tinyID="",this._customStatus="",this._contentType="json",this._unlimitedAVChatRoom=n.unlimitedAVChatRoom,this._scene=n.scene||"",this._oversea=n.oversea,this._instanceID=n.instanceID,this._statusInstanceID=0,this._isDevMode=n.devMode,this._proxyServer=n.proxyServer}return a(e,[{key:"isLoggedIn",value:function(){return this._isLoggedIn}},{key:"isOversea",value:function(){return this._oversea}},{key:"isPrivateNetWork",value:function(){return this._proxyServer}},{key:"isDevMode",value:function(){return this._isDevMode}},{key:"isSingaporeSite",value:function(){return this._SDKAppID>=2e7&&this._SDKAppID<3e7||this._SDKAppID>=172e7&&this._SDKAppID<173e7}},{key:"isKoreaSite",value:function(){return this._SDKAppID>=3e7&&this._SDKAppID<4e7||this._SDKAppID>=173e7&&this._SDKAppID<174e7}},{key:"isGermanySite",value:function(){return this._SDKAppID>=4e7&&this._SDKAppID<5e7||this._SDKAppID>=174e7&&this._SDKAppID<175e7}},{key:"isIndiaSite",value:function(){return this._SDKAppID>=5e7&&this._SDKAppID<6e7||this._SDKAppID>=175e7&&this._SDKAppID<176e7}},{key:"isJapanSite",value:function(){return this._SDKAppID>=6e7&&this._SDKAppID<7e7||this._SDKAppID>=176e7&&this._SDKAppID<177e7}},{key:"isUSASite",value:function(){return this._SDKAppID>=7e7&&this._SDKAppID<8e7||this._SDKAppID>=177e7&&this._SDKAppID<178e7}},{key:"isIntl",value:function(){return 0===(e=this._SDKAppID)||e>=2e7&&e<8e7||e>=172e7&&e<178e7;var e}},{key:"isUnlimitedAVChatRoom",value:function(){return this._unlimitedAVChatRoom}},{key:"setUserID",value:function(e){this._userID=e}},{key:"getUserID",value:function(){return this._userID}},{key:"setUserSig",value:function(e){this._userSig=e}},{key:"getUserSig",value:function(){return this._userSig}},{key:"getSDKAppID",value:function(){return this._SDKAppID}},{key:"setTinyID",value:function(e){this._tinyID=e,this._isLoggedIn=!0}},{key:"getTinyID",value:function(){return this._tinyID}},{key:"setCustomStatus",value:function(e){this._customStatus=e}},{key:"getCustomStatus",value:function(){return this._customStatus}},{key:"getScene",value:function(){return Cl?window.tencent_cloud_im_csig_flutter_for_web_25F_cy:this._isTUIKit()?"tuikit":this._scene}},{key:"getInstanceID",value:function(){return this._instanceID}},{key:"getStatusInstanceID",value:function(){return this._statusInstanceID}},{key:"setStatusInstanceID",value:function(e){this._statusInstanceID=e}},{key:"getVersion",value:function(){return this._version}},{key:"getA2Key",value:function(){return this._a2Key}},{key:"setA2Key",value:function(e){this._a2Key=e}},{key:"getContentType",value:function(){return this._contentType}},{key:"getProxyServer",value:function(){return this._proxyServer}},{key:"_isTUIKit",value:function(){var e=!1,t=!1,n=!1,o=!1,r=[];tl&&(r=Object.keys(ol)),nl&&(r=el?Object.keys(uni):Object.keys(window));for(var i=0,a=r.length;i<a;i++)if(r[i].toLowerCase().includes("uikit")){e=!0;break}if(r=null,tl&&!td(ol.createGamePortal)&&!Ql(getApp())){var s=getApp().globalData;Xl(s)&&!0===s.isTUIKit&&(t=!0)}!0===this._m.getModule(Kf).getStorageSync("TIM_".concat(this._SDKAppID,"_isTUIKit"))&&(n=!0);var u=null;if(Wc&&!Jc&&"undefined"==typeof uni&&__wxConfig&&(u=__wxConfig.pages),Yc&&"undefined"==typeof uni&&__qqConfig&&(u=__qqConfig.pages),$l(u)&&u.length>0){for(var c=0,l=u.length;c<l;c++)if(u[c].toLowerCase().includes("tui")){o=!0;break}u=null}return e||t||n||o}},{key:"reset",value:function(){this._isLoggedIn=!1,this._userSig="",this._a2Key="",this._tinyID="",this._customStatus="",this._statusInstanceID=0}}]),e}(),GC=function(e){u(n,e);var t=m(n);function n(e){var o;return r(this,n),(o=t.call(this,e))._n="SignModule",o._helloInterval=120,o._lastLoginTs=0,o._lastWsHelloTs=0,o._isWebUniapp=0,GI.mixin(g(o)),o}return a(n,[{key:"onCheckTimer",value:function(e){this.isLoggedIn()&&e%this._helloInterval==0&&this._hello()}},{key:"login",value:function(e){var t="";if(this.isLoggedIn()){var n=this.getMyUserID();return(t=this.getErrorMessage("RepeatLogin",n))&&Pl.w(t),gI({actionStatus:"OK",errorCode:0,errorInfo:t,repeatLogin:!0})}if(Date.now()-this._lastLoginTs<=15e3)return this.outputWarning("LoggingIn",e.userID),vI({code:Mv});Pl.l("".concat(this._n,".login userID:").concat(e.userID));var o=this._checkLoginInfo(e);if(0!==o.code)return vI(o);var r=this.getModule(Hf),i=e.userID,a=e.userSig;return r.setUserID(i),r.setUserSig(a),this.getModule(Xf).updateProtocolConfig(),this._login()}},{key:"_login",value:function(){var e=this,t=this.getModule(Hf),n=t.getScene(),o=0,r=new s_("login");r.setMessage("".concat(n)).setMoreMessage("identifier:".concat(this.getMyUserID())),el?"tuikit"===n?r.setUIPlatform(4):r.setUIPlatform(3):tl?"tuikit"===n?r.setUIPlatform(12):r.setUIPlatform(11):nl&&(Cl?"flutter_web_uikit"===n?r.setUIPlatform(21):r.setUIPlatform(20):this._isReactUIKit()?Il?r.setUIPlatform(25):r.setUIPlatform(24):Il?"tuikit"===n?r.setUIPlatform(17):r.setUIPlatform(16):"tuikit"===n?r.setUIPlatform(14):r.setUIPlatform(13));var i=this.getModule(ih);if(i.canIUseOfflinePush()){this._isWebUniapp=i.getUniAppPlatform();var a=this._getStatusInstanceID();t.setStatusInstanceID(a),this.getModule(Xf).updateProtocolConfig(),o=i.getDeviceBrand()}var s="".concat(this._n,"._login");return this._lastLoginTs=Date.now(),this.request({protocolName:dh,requestData:{deviceBrand:o,isWebUniapp:this._isWebUniapp}}).then((function(o){e._lastLoginTs=0;var i=Date.now(),a=null,u=o.data,c=u.a2Key,l=u.tinyID,d=u.helloInterval,p=u.instanceID,f=u.timeStamp,h=u.customStatus,g=void 0===h?"":h;Pl.l("".concat(s," ok. scene:").concat(n," helloInterval:").concat(d," instanceID:").concat(p," timeStamp:").concat(f));var v=1e3*f,m=i-r.getStartTs(),_=v+parseInt(m/2)-i,y=r.getStartTs()+_;if(r.start(y),function(e,t){El=t;var n=new Date;n.setTime(e),Pl.i("baseTime from server:".concat(n," offset:").concat(El))}(v,_),!l)throw a=new pI({code:mv}),r.setError(a,!0,e.getNetworkType()).end(),a;if(!c)throw a=new pI({code:_v}),r.setError(a,!0,e.getNetworkType()).end(),a;var M=wC(g);r.setNetworkType(e.getNetworkType()).setMoreMessage("helloInterval:".concat(d," instanceID:").concat(p," offset:").concat(_," customStatus:").concat(M)).end(),t.setA2Key(c),t.setTinyID(l),t.setStatusInstanceID(p),t.setCustomStatus(M),e.getModule(Xf).updateProtocolConfig(),e.emitInnerEvent(OI),e._helloInterval=d,e.triggerReady();var I=e.getModule(ih);return I.canIUseOfflinePush()&&(uni.setStorageSync("timUniAppInstanceID",p),I.init()),e._fetchCloudControlConfig(),e.getModule(ah).init(),o})).catch((function(t){return e.probeNetwork().then((function(e){var n=_(e,2),o=n[0],i=n[1];r.setError(t,o,i).end(!0)})),e._m.setNotReadyReason(Nm),Pl.e("".concat(s," failed. error:"),t),e._lastLoginTs=0,e._m.onLoginFailed(),vI(t)}))}},{key:"logout",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(!this.isLoggedIn())return vI({code:yv});new s_("logout").setNetworkType(this.getNetworkType()).setMessage("identifier:".concat(this.getMyUserID())).end(!0);var n="".concat(this._n,".logout");return Pl.i("".concat(n," type:").concat(t)),0===t&&this._m.setNotReadyReason(xm),this.request({protocolName:ph,requestData:{type:t}}).then((function(){return e.resetReady(),gI({})})).catch((function(t){return Pl.e("".concat(n," error:"),t),e.resetReady(),gI({})}))}},{key:"_fetchCloudControlConfig",value:function(){this.getModule(eh).fetchConfig()}},{key:"_getStatusInstanceID",value:function(){return uni.getStorageSync("timUniAppInstanceID")}},{key:"_hello",value:function(){var e=this;this._lastWsHelloTs=Date.now(),this.request({protocolName:fh,requestData:{isWebUniapp:this._isWebUniapp}}).catch((function(t){Pl.w("".concat(e._n,"._hello error:"),t)}))}},{key:"getLastWsHelloTs",value:function(){return this._lastWsHelloTs}},{key:"_checkLoginInfo",value:function(e){var t=0;return Hd(this.getModule(Hf).getSDKAppID())?t=hv:Hd(e.userID)?t=gv:Hd(e.userSig)&&(t=vv),{code:t}}},{key:"_isReactUIKit",value:function(){return nl&&void 0!==window.tencent_cloud_im_csig_react_uikit_23F_xa}},{key:"onMultipleAccountKickedOut",value:function(e){var t=this;new s_("kickedOut").setNetworkType(this.getNetworkType()).setMessage("type:".concat(Ir.KICKED_OUT_MULT_ACCOUNT," newInstanceInfo:").concat(JSON.stringify(e))).end(!0),Pl.w("".concat(this._n,".onMultipleAccountKickedOut userID:").concat(this.getMyUserID()," newInstanceInfo:"),e),this.logout(1).then((function(){t.emitOuterEvent(Mr.KICKED_OUT,{type:Ir.KICKED_OUT_MULT_ACCOUNT}),t._m.setNotReadyReason(Gm),t._m.reset()}))}},{key:"onMultipleDeviceKickedOut",value:function(e){var t=this;new s_("kickedOut").setNetworkType(this.getNetworkType()).setMessage("type:".concat(Ir.KICKED_OUT_MULT_DEVICE," newInstanceInfo:").concat(JSON.stringify(e))).end(!0),Pl.w("".concat(this._n,".onMultipleDeviceKickedOut userID:").concat(this.getMyUserID()," newInstanceInfo:"),e),this.logout(1).then((function(){t.emitOuterEvent(Mr.KICKED_OUT,{type:Ir.KICKED_OUT_MULT_DEVICE}),t._m.setNotReadyReason(Pm),t._m.reset()}))}},{key:"onUserSigExpired",value:function(){new s_("kickedOut").setNetworkType(this.getNetworkType()).setMessage(Ir.KICKED_OUT_USERSIG_EXPIRED).end(!0),Pl.w("".concat(this._n,".onUserSigExpired: userSig expired")),0!==this.getModule(Hf).getStatusInstanceID()&&(this.emitOuterEvent(Mr.KICKED_OUT,{type:Ir.KICKED_OUT_USERSIG_EXPIRED}),this._m.setNotReadyReason(Um),this._m.reset())}},{key:"onRestApiKickedOut",value:function(e){new s_("kickedOut").setNetworkType(this.getNetworkType()).setMessage("type:".concat(Ir.KICKED_OUT_REST_API," newInstanceInfo:").concat(JSON.stringify(e))).end(!0),Pl.w("".concat(this._n,".onRestApiKickedOut userID:").concat(this.getMyUserID()," newInstanceInfo:"),e),0!==this.getModule(Hf).getStatusInstanceID()&&(this.emitOuterEvent(Mr.KICKED_OUT,{type:Ir.KICKED_OUT_REST_API}),this._m.setNotReadyReason(Fm),this._m.reset(),this.getModule($f).onRestApiKickedOut())}},{key:"reset",value:function(){Pl.l("".concat(this._n,".reset")),this.resetReady(),this._helloInterval=120,this._lastLoginTs=0,this._lastWsHelloTs=0,this._isWebUniapp=0}}]),n}(lh),UC=ot.f;function xC(){return null}on({target:"Object",stat:!0,forced:Object.defineProperty!==UC,sham:!O},{defineProperty:UC});var FC=function(){function e(t){r(this,e),this._m=t,this._n="StorageModule",this._storageQueue=new Map,this._errorTolerantHandle()}return a(e,[{key:"_errorTolerantHandle",value:function(){tl||!Ql(window)&&this._canIUseCookies()||(this.getItem=xC,this.setItem=xC,this.removeItem=xC,this.clear=xC)}},{key:"onCheckTimer",value:function(e){if(e%20==0){if(0===this._storageQueue.size)return;this._doFlush()}}},{key:"_doFlush",value:function(){try{var e,t=S(this._storageQueue);try{for(t.s();!(e=t.n()).done;){var n=_(e.value,2),o=n[0],r=n[1];this._setStorageSync(this._getKey(o),r)}}catch(a){t.e(a)}finally{t.f()}this._storageQueue.clear()}catch(yD){Pl.w("".concat(this._n,"._doFlush error:"),yD)}}},{key:"_getPrefix",value:function(){var e=this._m.getModule(Hf);return"TIM_".concat(e.getSDKAppID(),"_").concat(e.getUserID(),"_")}},{key:"_getKey",value:function(e){return"".concat(this._getPrefix()).concat(e)}},{key:"getItem",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];try{var n=t?this._getKey(e):e;return this.getStorageSync(n)}catch(yD){return Pl.w("".concat(this._n,".getItem error:"),yD),{}}}},{key:"setItem",value:function(e,t){if(arguments.length>2&&void 0!==arguments[2]&&arguments[2]){var n=arguments.length>3&&void 0!==arguments[3]&&!arguments[3]?e:this._getKey(e);this._setStorageSync(n,t)}else this._storageQueue.set(e,t)}},{key:"clear",value:function(){try{tl?ol.clearStorageSync():this._canIUseCookies()&&localStorage.clear()}catch(yD){Pl.w("".concat(this._n,".clear error:"),yD)}}},{key:"removeItem",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];try{var n=t?this._getKey(e):e;this._removeStorageSync(n)}catch(yD){Pl.w("".concat(this._n,".removeItem error:"),yD)}}},{key:"getSize",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"b";try{var o={size:0,limitSize:5242880,unit:n};if(Object.defineProperty(o,"leftSize",{enumerable:!0,get:function(){return o.limitSize-o.size}}),tl&&(o.limitSize=1024*ol.getStorageInfoSync().limitSize),e)o.size=JSON.stringify(this.getItem(e)).length+this._getKey(e).length;else if(tl)ol.getStorageInfoSync().keys.forEach((function(e){o.size+=JSON.stringify(t.getStorageSync(e)).length+t._getKey(e).length}));else if(this._canIUseCookies())for(var r in localStorage)localStorage.hasOwnProperty(r)&&(o.size+=localStorage.getItem(r).length+r.length);return this._convertUnit(o)}catch(yD){Pl.w("".concat(this._n," error:"),yD)}}},{key:"_convertUnit",value:function(e){var t={},n=e.unit;for(var o in t.unit=n,e)"number"==typeof e[o]&&("kb"===n.toLowerCase()?t[o]=Math.round(e[o]/1024):"mb"===n.toLowerCase()?t[o]=Math.round(e[o]/1024/1024):t[o]=e[o]);return t}},{key:"_setStorageSync",value:function(e,t){tl?$c?my.setStorageSync({key:e,data:t}):ol.setStorageSync(e,t):this._canIUseCookies()&&localStorage.setItem(e,JSON.stringify(t))}},{key:"getStorageSync",value:function(e){return tl?$c?my.getStorageSync({key:e}).data:ol.getStorageSync(e):this._canIUseCookies()?JSON.parse(localStorage.getItem(e)):{}}},{key:"_removeStorageSync",value:function(e){tl?$c?my.removeStorageSync({key:e}):ol.removeStorageSync(e):this._canIUseCookies()&&localStorage.removeItem(e)}},{key:"_canIUseCookies",value:function(){return navigator&&navigator.cookieEnabled&&localStorage}},{key:"reset",value:function(){Pl.l("".concat(this._n,".reset")),this._doFlush()}}]),e}(),qC=function(){function e(t){r(this,e),this._n="SSOLogBody",this._report=[]}return a(e,[{key:"pushIn",value:function(e){Pl.d("".concat(this._n,".pushIn"),this._report.length,e),this._report.push(e)}},{key:"backfill",value:function(e){var t;$l(e)&&0!==e.length&&(Pl.d("".concat(this._n,".backfill"),this._report.length,e.length),(t=this._report).unshift.apply(t,y(e)))}},{key:"getLogsNumInMemory",value:function(){return this._report.length}},{key:"isEmpty",value:function(){return 0===this._report.length}},{key:"_reset",value:function(){this._report.length=0,this._report=[]}},{key:"getLogsInMemory",value:function(){var e=this._report.slice();return this._reset(),e}}]),e}(),BC=function(e){var t=e.getModule(Hf);return{SDKType:10,SDKAppID:t.getSDKAppID(),SDKVersion:t.getVersion(),tinyID:Number(t.getTinyID()),userID:t.getUserID(),platform:e.getPlatform(),instanceID:t.getInstanceID(),traceID:Al()}},VC=function(e){u(o,e);var n=m(o);function o(e){var t;r(this,o),(t=n.call(this,e))._n="EventStatModule",t.TAG="im-ssolog-event",t._reportBody=new qC,t.MIN_THRESHOLD=20,t.MAX_THRESHOLD=100,t.WAITING_TIME=6e4,t.REPORT_LEVEL=[4,5,6],t.REPORT_SDKAPPID_BLACKLIST=[],t.REPORT_TINYID_WHITELIST=[],t._lastReportTime=Date.now();var i=t.getInnerEmitterInstance();return i.on(OI,t._onLoginSuccess,g(t)),i.on(NI,t._onCloudConfigUpdated,g(t)),t}return a(o,[{key:"reportAtOnce",value:function(){Pl.d("".concat(this._n,".reportAtOnce")),this._report()}},{key:"_onLoginSuccess",value:function(){var e=this,t=this.getModule(Kf),n=t.getItem(this.TAG,!1);!Hd(n)&&td(n.forEach)&&(Pl.l("".concat(this._n,"._onLoginSuccess get ssolog in storage, count:").concat(n.length)),n.forEach((function(t){e._reportBody.pushIn(t)})),t.removeItem(this.TAG,!1))}},{key:"_onCloudConfigUpdated",value:function(){var e=this.getCloudConfig("evt_rpt_threshold"),t=this.getCloudConfig("evt_rpt_waiting"),n=this.getCloudConfig("evt_rpt_level"),o=this.getCloudConfig("evt_rpt_sdkappid_bl"),r=this.getCloudConfig("evt_rpt_tinyid_wl");Ql(e)||(this.MIN_THRESHOLD=Number(e)),Ql(t)||(this.WAITING_TIME=Number(t)),Ql(n)||(this.REPORT_LEVEL=n.split(",").map((function(e){return Number(e)}))),Ql(o)||(this.REPORT_SDKAPPID_BLACKLIST=o.split(",").map((function(e){return Number(e)}))),Ql(r)||(this.REPORT_TINYID_WHITELIST=r.split(","))}},{key:"pushIn",value:function(e){e instanceof s_&&(e.updateTimeStamp(),this._reportBody.pushIn(e),this._reportBody.getLogsNumInMemory()>=this.MIN_THRESHOLD&&this._report())}},{key:"onCheckTimer",value:function(){Date.now()<this._lastReportTime+this.WAITING_TIME||this._reportBody.isEmpty()||this._report()}},{key:"_filterLogs",value:function(e){var t=this,n=this.getModule(Hf),o=n.getSDKAppID(),r=n.getTinyID();return Nd(this.REPORT_SDKAPPID_BLACKLIST,o)&&!Pd(this.REPORT_TINYID_WHITELIST,r)?[]:e.filter((function(e){return t.REPORT_LEVEL.includes(e.level)}))}},{key:"_report",value:function(){var e=this;if(!this._reportBody.isEmpty()){var n=this._reportBody.getLogsInMemory(),o=this._filterLogs(n);if(0!==o.length){var r={header:BC(this),event:o};this.request({protocolName:Vg,requestData:t({},r)}).then((function(){e._lastReportTime=Date.now()})).catch((function(t){Pl.w("".concat(e._n,".report failed. networkType:").concat(e.getNetworkType()," error:"),t),e._reportBody.backfill(n),e._reportBody.getLogsNumInMemory()>e.MAX_THRESHOLD&&e._flushAtOnce()}))}else this._lastReportTime=Date.now()}}},{key:"_flushAtOnce",value:function(){var e=this.getModule(Kf),t=e.getItem(this.TAG,!1),n=this._reportBody.getLogsInMemory(),o="".concat(this._n,"._flushAtOnce");if(Hd(t))Pl.l("".concat(o," count:").concat(n.length)),e.setItem(this.TAG,n,!0,!1);else{var r=n.concat(t);r.length>this.MAX_THRESHOLD&&(r=r.slice(0,this.MAX_THRESHOLD)),Pl.l("".concat(o," count:").concat(r.length)),e.setItem(this.TAG,r,!0,!1)}}},{key:"reset",value:function(){Pl.l("".concat(this._n,".reset")),this._lastReportTime=0,this._report(),this.REPORT_SDKAPPID_BLACKLIST=[],this.REPORT_TINYID_WHITELIST=[]}}]),o}(lh),HC="none",KC="online",jC=[Am,zm],zC=function(){function e(t){r(this,e),this._m=t,this._networkType="",this._n="NetMonitorModule",this.MAX_WAIT_TIME=3e3,this._mpNetworkStatusCallback=null,this._webOnlineCallback=null,this._webOfflineCallback=null}return a(e,[{key:"start",value:function(){var e=this;tl?(ol.getNetworkType({success:function(t){e._networkType=t.networkType,t.networkType===HC?Pl.w("".concat(e._n,".start no network, please check!")):Pl.i("".concat(e._n,".start networkType:").concat(t.networkType))}}),this._mpNetworkStatusCallback=this._onNetworkStatusChange.bind(this),ol.onNetworkStatusChange(this._mpNetworkStatusCallback)):(this._networkType=KC,this._webOnlineCallback=this._onWebOnline.bind(this),this._webOfflineCallback=this._onWebOffline.bind(this),window&&(window.addEventListener("online",this._webOnlineCallback),window.addEventListener("offline",this._webOfflineCallback)))}},{key:"_onWebOnline",value:function(){this._onNetworkStatusChange({isConnected:!0,networkType:KC})}},{key:"_onWebOffline",value:function(){this._onNetworkStatusChange({isConnected:!1,networkType:HC})}},{key:"_onNetworkStatusChange",value:function(e){var t=e.isConnected,n=e.networkType,o="".concat(this._n,"._onNetworkStatusChange"),r=!1;t?(Pl.i("".concat(o," previous:").concat(this._networkType," current:").concat(n)),this._networkType!==n&&(r=!0,this._m.getModule($f).reConnect(!0))):this._networkType!==n&&(r=!0,Pl.w("".concat(o," no network, please check!")),this._m.getModule($f).offline()),r&&(new s_("networkChange").setMessage("isConnected:".concat(t," previousNetworkType:").concat(this._networkType," networkType:").concat(n)).end(),this._networkType=n)}},{key:"probe",value:function(e){var t=this;if(!Ql(e)&&jC.includes(e.code))return Promise.resolve([!0,this._networkType]);var n="".concat(this._n,".probe");return new Promise((function(e,o){tl?ol.getNetworkType({success:function(o){t._networkType=o.networkType,o.networkType===HC?(Pl.w("".concat(n," no network, please check!")),e([!1,o.networkType])):(Pl.i("".concat(n," networkType:").concat(o.networkType)),e([!0,o.networkType]))}}):t._networkType===HC?e([!1,HC]):e([!0,KC])}))}},{key:"getNetworkType",value:function(){return this._networkType}},{key:"reset",value:function(){Pl.l("".concat(this._n,".reset")),tl?null!==this._mpNetworkStatusCallback&&(ol.offNetworkStatusChange&&(Qc||Jc?ol.offNetworkStatusChange(this._mpNetworkStatusCallback):ol.offNetworkStatusChange()),this._mpNetworkStatusCallback=null):window&&(null!==this._webOnlineCallback&&(window.removeEventListener("online",this._webOnlineCallback),this._webOnlineCallback=null),null!==this._onWebOffline&&(window.removeEventListener("offline",this._webOfflineCallback),this._webOfflineCallback=null))}}]),e}(),ZC=D((function(e){var t=Object.prototype.hasOwnProperty,n="~";function o(){}function r(e,t,n){this.fn=e,this.context=t,this.once=n||!1}function i(e,t,o,i,a){if("function"!=typeof o)throw new TypeError("The listener must be a function");var s=new r(o,i||e,a),u=n?n+t:t;return e._events[u]?e._events[u].fn?e._events[u]=[e._events[u],s]:e._events[u].push(s):(e._events[u]=s,e._eventsCount++),e}function a(e,t){0==--e._eventsCount?e._events=new o:delete e._events[t]}function s(){this._events=new o,this._eventsCount=0}Object.create&&(o.prototype=Object.create(null),(new o).__proto__||(n=!1)),s.prototype.eventNames=function(){var e,o,r=[];if(0===this._eventsCount)return r;for(o in e=this._events)t.call(e,o)&&r.push(n?o.slice(1):o);return Object.getOwnPropertySymbols?r.concat(Object.getOwnPropertySymbols(e)):r},s.prototype.listeners=function(e){var t=n?n+e:e,o=this._events[t];if(!o)return[];if(o.fn)return[o.fn];for(var r=0,i=o.length,a=new Array(i);r<i;r++)a[r]=o[r].fn;return a},s.prototype.listenerCount=function(e){var t=n?n+e:e,o=this._events[t];return o?o.fn?1:o.length:0},s.prototype.emit=function(e,t,o,r,i,a){var s=n?n+e:e;if(!this._events[s])return!1;var u,c,l=this._events[s],d=arguments.length;if(l.fn){switch(l.once&&this.removeListener(e,l.fn,void 0,!0),d){case 1:return l.fn.call(l.context),!0;case 2:return l.fn.call(l.context,t),!0;case 3:return l.fn.call(l.context,t,o),!0;case 4:return l.fn.call(l.context,t,o,r),!0;case 5:return l.fn.call(l.context,t,o,r,i),!0;case 6:return l.fn.call(l.context,t,o,r,i,a),!0}for(c=1,u=new Array(d-1);c<d;c++)u[c-1]=arguments[c];l.fn.apply(l.context,u)}else{var p,f=l.length;for(c=0;c<f;c++)switch(l[c].once&&this.removeListener(e,l[c].fn,void 0,!0),d){case 1:l[c].fn.call(l[c].context);break;case 2:l[c].fn.call(l[c].context,t);break;case 3:l[c].fn.call(l[c].context,t,o);break;case 4:l[c].fn.call(l[c].context,t,o,r);break;default:if(!u)for(p=1,u=new Array(d-1);p<d;p++)u[p-1]=arguments[p];l[c].fn.apply(l[c].context,u)}}return!0},s.prototype.on=function(e,t,n){return i(this,e,t,n,!1)},s.prototype.once=function(e,t,n){return i(this,e,t,n,!0)},s.prototype.removeListener=function(e,t,o,r){var i=n?n+e:e;if(!this._events[i])return this;if(!t)return a(this,i),this;var s=this._events[i];if(s.fn)s.fn!==t||r&&!s.once||o&&s.context!==o||a(this,i);else{for(var u=0,c=[],l=s.length;u<l;u++)(s[u].fn!==t||r&&!s[u].once||o&&s[u].context!==o)&&c.push(s[u]);c.length?this._events[i]=1===c.length?c[0]:c:a(this,i)}return this},s.prototype.removeAllListeners=function(e){var t;return e?(t=n?n+e:e,this._events[t]&&a(this,t)):(this._events=new o,this._eventsCount=0),this},s.prototype.off=s.prototype.removeListener,s.prototype.addListener=s.prototype.on,s.prefixed=n,s.EventEmitter=s,e.exports=s})),WC=function(e){u(n,e);var t=m(n);function n(e){var o;return r(this,n),(o=t.call(this,e))._n="BigDataChannelModule",o.FILETYPE={SOUND:2106,FILE:2107,VIDEO:2113},o._bdh_download_server="grouptalk.c2c.qq.com",o._BDHBizID=10001,o._authKey="",o._expireTime=0,o.getInnerEmitterInstance().on(OI,o._getAuthKey,g(o)),o}return a(n,[{key:"_getAuthKey",value:function(){var e=this;this.isIntl()||this.request({protocolName:vh}).then((function(t){t.data.authKey&&(e._authKey=t.data.authKey,e._expireTime=parseInt(t.data.expireTime))}))}},{key:"_isFromOlderVersion",value:function(e){return!(!e.content||2===e.content.downloadFlag)}},{key:"parseElements",value:function(e,t){if(!$l(e)||!t)return[];for(var n=[],o=null,r=0;r<e.length;r++)o=e[r],this._needParse(o)?n.push(this._parseElement(o,t)):n.push(e[r]);return n}},{key:"_needParse",value:function(e){return!e.cloudCustomData&&!(!this._isFromOlderVersion(e)||e.type!==Ir.MSG_AUDIO&&e.type!==Ir.MSG_FILE&&e.type!==Ir.MSG_VIDEO)}},{key:"_parseElement",value:function(e,t){switch(e.type){case Ir.MSG_AUDIO:return this._parseAudioElement(e,t);case Ir.MSG_FILE:return this._parseFileElement(e,t);case Ir.MSG_VIDEO:return this._parseVideoElement(e,t)}}},{key:"_parseAudioElement",value:function(e,t){return e.content.url=this._genAudioUrl(e.content.uuid,t),e}},{key:"_parseFileElement",value:function(e,t){return e.content.url=this._genFileUrl(e.content.uuid,t,e.content.fileName),e}},{key:"_parseVideoElement",value:function(e,t){return e.content.url=this._genVideoUrl(e.content.uuid,t),e}},{key:"_genAudioUrl",value:function(e,t){if(""===this._authKey)return"";var n=this.getModule(Hf).getSDKAppID();return"https://".concat(this._bdh_download_server,"/asn.com/stddownload_common_file?authkey=").concat(this._authKey,"&bid=").concat(this._BDHBizID,"&subbid=").concat(n,"&fileid=").concat(e,"&filetype=").concat(this.FILETYPE.SOUND,"&openid=").concat(t,"&ver=0")}},{key:"_genFileUrl",value:function(e,t,n){if(""===this._authKey)return"";n||(n="".concat(Math.floor(1e5*Math.random()),"-").concat(Date.now()));var o=this.getModule(Hf).getSDKAppID();return"https://".concat(this._bdh_download_server,"/asn.com/stddownload_common_file?authkey=").concat(this._authKey,"&bid=").concat(this._BDHBizID,"&subbid=").concat(o,"&fileid=").concat(e,"&filetype=").concat(this.FILETYPE.FILE,"&openid=").concat(t,"&ver=0&filename=").concat(encodeURIComponent(n))}},{key:"_genVideoUrl",value:function(e,t){if(""===this._authKey)return"";var n=this.getModule(Hf).getSDKAppID();return"https://".concat(this._bdh_download_server,"/asn.com/stddownload_common_file?authkey=").concat(this._authKey,"&bid=").concat(this._BDHBizID,"&subbid=").concat(n,"&fileid=").concat(e,"&filetype=").concat(this.FILETYPE.VIDEO,"&openid=").concat(t,"&ver=0")}},{key:"reset",value:function(){this._authKey="",this.expireTime=0}}]),n}(lh),YC=["requestSnapshotUrl"],JC=function(e){u(o,e);var n=m(o);function o(e){var t;return r(this,o),(t=n.call(this,e))._n="UploadModule",t.TIMUploadPlugin=null,t.timUploadPlugin=null,t.COSSDK=null,t._cosUploadMethod=null,t.expiredTimeLimit=600,t.appid=0,t.bucketName="",t.ciUrl="",t.directory="",t.downloadUrl="",t.uploadUrl="",t.region="ap-shanghai",t.cos=null,t.cosOptions={secretId:"",secretKey:"",sessionToken:"",expiredTime:0},t.uploadFileType="",t.duration=900,t.tryCount=0,t.getInnerEmitterInstance().on(OI,t._init,g(t)),t}return a(o,[{key:"_init",value:function(){var e=this.getModule(Yf);if(this.TIMUploadPlugin=e.getPlugin("tim-upload-plugin"),this.TIMUploadPlugin)this._initUploaderMethod();else{var t=tl?"cos-wx-sdk":"cos-js-sdk";this.COSSDK=e.getPlugin(t),this.COSSDK?(this._getAuthorizationKey(),this.outputWarning("CosReplacement",t)):this.outputWarning("PluginUndetected")}}},{key:"_getAuthorizationKey",value:function(){var e=this,t="".concat(this._n,".").concat("_getAuthorizationKey"),n=new s_("_getAuthorizationKey"),o=Math.ceil(Date.now()/1e3);this.request({protocolName:Fg,requestData:{duration:this.expiredTimeLimit}}).then((function(r){var i=r.data;Pl.l("".concat(t," ok. data:"),i);var a=i.expiredTime-o;n.setMessage("requestId:".concat(i.requestId," requestTime:").concat(o," expiredTime:").concat(i.expiredTime," diff:").concat(a,"s")).setNetworkType(e.getNetworkType()).end(),!tl&&i.region&&(e.region=i.region),e.appid=i.appid,e.bucketName=i.bucketName,e.ciUrl=i.ciUrl,e.directory=i.directory,e.downloadUrl=i.downloadUrl,e.uploadUrl=i.uploadUrl,e.cosOptions={secretId:i.secretId,secretKey:i.secretKey,sessionToken:i.sessionToken,expiredTime:i.expiredTime},Pl.l("".concat(t," ok. region:").concat(e.region," bucketName:").concat(e.bucketName)),e._initUploaderMethod()})).catch((function(o){e.probeNetwork().then((function(e){var t=_(e,2),r=t[0],i=t[1];n.setError(o,r,i).end()})),Pl.w("".concat(t," failed. error:"),o)}))}},{key:"_getCosPreSigUrl",value:function(e){var t=this,n="".concat(this._n,".").concat("_getCosPreSigUrl"),o=Math.ceil(Date.now()/1e3),r=new s_("_getCosPreSigUrl");return this.request({protocolName:qg,requestData:{fileType:e.fileType,fileName:e.fileName,uploadMethod:e.uploadMethod,duration:e.duration}}).then((function(e){t.tryCount=0;var i=e.data||{},a=i.expiredTime-o;return Pl.l("".concat(n," ok. data:"),i),r.setMessage("requestId:".concat(i.requestId," expiredTime:").concat(i.expiredTime," diff:").concat(a,"s")).setNetworkType(t.getNetworkType()).end(),i})).catch((function(o){return-1===o.code&&(o.code=Cv),t.probeNetwork().then((function(e){var t=_(e,2),n=t[0],i=t[1];r.setError(o,n,i).end()})),Pl.w("".concat(n," failed. error:"),o),t.tryCount<1?(t.tryCount++,t._getCosPreSigUrl(e)):(t.tryCount=0,vI({code:Cv}))}))}},{key:"_initUploaderMethod",value:function(){var e=this;if(this.TIMUploadPlugin)return this.timUploadPlugin=new this.TIMUploadPlugin,void(this._cosUploadMethod=function(t,n){e.timUploadPlugin.uploadFile(t,n)});this.appid&&(this.cos=tl?new this.COSSDK({ForcePathStyle:!0,getAuthorization:this._getAuthorization.bind(this)}):new this.COSSDK({getAuthorization:this._getAuthorization.bind(this)}),this._cosUploadMethod=tl?function(t,n){e.cos.postObject(t,n)}:function(t,n){e.cos.uploadFiles(t,n)})}},{key:"onCheckTimer",value:function(e){this.COSSDK&&(this.TIMUploadPlugin||this.isLoggedIn()&&e%60==0&&Math.ceil(Date.now()/1e3)>=this.cosOptions.expiredTime-120&&this._getAuthorizationKey())}},{key:"_getAuthorization",value:function(e,t){t({TmpSecretId:this.cosOptions.secretId,TmpSecretKey:this.cosOptions.secretKey,XCosSecurityToken:this.cosOptions.sessionToken,ExpiredTime:this.cosOptions.expiredTime})}},{key:"upload",value:function(e){if(!0===e.getRelayFlag())return Promise.resolve();var t=this.getModule(oh);switch(e.type){case Ir.MSG_IMAGE:return t.addTotalCount(Qm),this._uploadImage(e);case Ir.MSG_FILE:return t.addTotalCount(Qm),this._uploadFile(e);case Ir.MSG_AUDIO:return t.addTotalCount(Qm),this._uploadAudio(e);case Ir.MSG_VIDEO:return t.addTotalCount(Qm),this._uploadVideo(e);default:return Promise.resolve()}}},{key:"_uploadImage",value:function(e){var n=this,o=this.getModule(Nf),r=e.getElements()[0],i=o.getMessageOption(e.clientSequence);return this.doUploadImage({file:i.payload.file,to:i.to,onProgress:function(e){if(r.updatePercent(e),td(i.onProgress))try{i.onProgress(e)}catch(t){return vI({code:Ev})}}}).then((function(o){var i=o.location,a=o.fileType,s=o.fileSize,u=o.width,c=o.height,l=n.isPrivateNetWork()?i:gd(i);r.updateImageFormat(a);var d=Ld({originUrl:l,originWidth:u,originHeight:c,min:198}),p=Ld({originUrl:l,originWidth:u,originHeight:c,min:720});return r.updateImageInfoArray([{size:s,url:l,width:u,height:c},t({},p),t({},d)]),e}))}},{key:"_uploadFile",value:function(e){var t=this,n=this.getModule(Nf),o=e.getElements()[0],r=n.getMessageOption(e.clientSequence);return this.doUploadFile({file:r.payload.file,to:r.to,onProgress:function(e){if(o.updatePercent(e),td(r.onProgress))try{r.onProgress(e)}catch(t){return vI({code:Ev})}}}).then((function(n){var r=n.location,i=t.isPrivateNetWork()?r:gd(r);return o.updateFileUrl(i),e}))}},{key:"_uploadAudio",value:function(e){var t=this,n=this.getModule(Nf),o=e.getElements()[0],r=n.getMessageOption(e.clientSequence);return this.doUploadAudio({file:r.payload.file,to:r.to,onProgress:function(e){if(o.updatePercent(e),td(r.onProgress))try{r.onProgress(e)}catch(t){return vI({code:Ev})}}}).then((function(n){var r=n.location,i=t.isPrivateNetWork()?r:gd(r);return o.updateAudioUrl(i),e}))}},{key:"_uploadVideo",value:function(e){var t=this,n=this.getModule(Nf),o=e.getElements()[0],r=n.getMessageOption(e.clientSequence);return this.doUploadVideo({file:r.payload.file,to:r.to,onProgress:function(e){if(o.updatePercent(e),td(r.onProgress))try{r.onProgress(e)}catch(t){return vI({code:Ev})}}}).then((function(n){var r=n.location,i=n.snapshotInfo,a=t.isPrivateNetWork()?r:gd(r);return o.updateVideoUrl(a),Hd(i)||o.updateSnapshotInfo(i),e}))}},{key:"doUploadImage",value:function(e){var t=this;if(!e.file)return vI({code:Gv});var n=this._checkImageType(e.file);if(!0!==n)return n;var o=this._checkImageSize(e.file);if(!0!==o)return o;var r=null;return this._setUploadFileType(FI),this.uploadByCOS(e).then((function(e){return r=e,t.isPrivateNetWork()?bd(e.location):bd("https://".concat(e.location))})).then((function(e){return r.width=e.width,r.height=e.height,Promise.resolve(r)}))}},{key:"_checkImageType",value:function(e){var t="";return t=tl?e.url.slice(e.url.lastIndexOf(".")+1):e.files[0].name.slice(e.files[0].name.lastIndexOf(".")+1),UI.indexOf(t.toLowerCase())>=0||vI({code:Uv})}},{key:"_checkImageSize",value:function(e){var t=0;return 0===(t=tl?e.size:e.files[0].size)?vI({code:Dv}):t<20971520||vI({code:xv})}},{key:"doUploadFile",value:function(e){return e.file?e.file.files[0].size>104857600?vI({code:zv}):0===e.file.files[0].size?vI({code:Dv}):(this._setUploadFileType(VI),this.uploadByCOS(e)):vI({code:jv})}},{key:"doUploadVideo",value:function(e){return e.file.videoFile.size>104857600?vI({code:Vv}):0===e.file.videoFile.size?vI({code:Dv}):-1===xI.indexOf(e.file.videoFile.type)?vI({code:Hv}):(this._setUploadFileType(qI),tl?this.handleVideoUpload({file:e.file.videoFile,onProgress:e.onProgress}):nl?this.handleVideoUpload(e):void 0)}},{key:"handleVideoUpload",value:function(e){var t=this;return new Promise((function(n,o){t.uploadByCOS(e).then((function(e){n(e)})).catch((function(){t.uploadByCOS(e).then((function(e){n(e)})).catch((function(){o(new pI({code:Bv}))}))}))}))}},{key:"doUploadAudio",value:function(e){return e.file?e.file.size>20971520?vI({code:qv}):0===e.file.size?vI({code:Dv}):(this._setUploadFileType(BI),this.uploadByCOS(e)):vI({code:Fv})}},{key:"uploadByCOS",value:function(e){var t=this,n="".concat(this._n,".uploadByCOS");if(!td(this._cosUploadMethod))return this.outputWarning("PluginUndetected"),vI({code:Iv});if(this.timUploadPlugin)return this._uploadWithPreSigUrl(e);var o=new s_("upload"),r=Date.now(),i=this._getFile(e);return new Promise((function(a,s){var u=tl?t._createCosOptionsWXMiniApp(e):t._createCosOptionsWeb(e),c=t;t._cosUploadMethod(u,(function(e,u){var l=Object.create(null);if(u){if(e||$l(u.files)&&u.files[0].error){var d=new pI({code:Kv});return o.setError(d,!0,t.getNetworkType()).end(),Pl.l("".concat(n," failed. error:"),u.files[0].error),403===u.files[0].error.statusCode&&(Pl.w("".concat(n," failed. cos AccessKeyId was invalid, regain auth key!")),t._getAuthorizationKey()),void s(d)}l.fileName=i.name,l.fileSize=i.size,l.fileType=i.type.slice(i.type.indexOf("/")+1).toLowerCase(),l.location=tl?u.Location:u.files[0].data.Location;var p=Date.now()-r,f=c._formatFileSize(i.size),h=c._formatSpeed(1e3*i.size/p),g="size:".concat(f," time:").concat(p,"ms speed:").concat(h);Pl.l("".concat(n," success. name:").concat(i.name," ").concat(g)),a(l);var v=t.getModule(oh);return v.addCost(Qm,p),v.addFileSize(Qm,i.size),void o.setNetworkType(t.getNetworkType()).setMessage(g).end()}var m=new pI({code:Kv});o.setError(m,!0,c.getNetworkType()).end(),Pl.w("".concat(n," failed. error:"),e),403===e.statusCode&&(Pl.w("".concat(n," failed. cos AccessKeyId was invalid, regain auth key!")),t._getAuthorizationKey()),s(m)}))}))}},{key:"_uploadWithPreSigUrl",value:function(e){var t=this,n="".concat(this._n,"._uploadWithPreSigUrl"),o=this._getFile(e);return this._createCosOptionsPreSigUrl(e).then((function(e){return new Promise((function(r,i){var a=new s_("upload"),s=e.requestSnapshotUrl,u=void 0===s?void 0:s,c=h(e,YC),l=Date.now();t._cosUploadMethod(c,(function(e,s){var c=Object.create(null);if(e||403===s.statusCode)return a.setError(new pI(e),!0,t.getNetworkType()).end(),Pl.l("".concat(n," failed, error:"),e),void i(new pI({code:Kv}));var d=s.data.location||"";t.isPrivateNetWork()||0!==d.indexOf("https://")&&0!==d.indexOf("http://")||(d=d.split("//")[1]),c.fileName=o.name,c.fileSize=o.size,c.fileType=o.type.slice(o.type.indexOf("/")+1).toLowerCase(),c.location=d;var p=Date.now()-l,f=t._formatFileSize(o.size),h=t._formatSpeed(1e3*o.size/p),g="size:".concat(f,",time:").concat(p,"ms,speed:").concat(h," res:").concat(JSON.stringify(s.data));Pl.l("".concat(n," success name:").concat(o.name,",").concat(g)),a.setNetworkType(t.getNetworkType()).setMessage(g).end();var v=t.getModule(oh);if(v.addCost(Qm,p),v.addFileSize(Qm,o.size),!Hd(u))return t._getSnapshotInfoByUrl(u).then((function(e){c.snapshotInfo=e,r(c)}));r(c)}))}))}))}},{key:"_getFile",value:function(e){var t;return $l(e.file.files)||(t=e.file.files,"filelist"===od(t))?e.file.files[0]:e.file}},{key:"_formatFileSize",value:function(e){return e<1024?e+"B":e<1048576?Math.floor(e/1024)+"KB":Math.floor(e/1048576)+"MB"}},{key:"_formatSpeed",value:function(e){return e<=1048576?Od(e/1024,1)+"KB/s":Od(e/1048576,1)+"MB/s"}},{key:"_createCosOptionsWeb",value:function(e){var t=this._getFile(e),n=t.name,o=n.slice(n.lastIndexOf(".")),r=this._genFileName("".concat(ld(999999)).concat(o));return{files:[{Bucket:"".concat(this.bucketName,"-").concat(this.appid),Region:this.region,Key:"".concat(this.directory,"/").concat(r),Body:t}],SliceSize:1048576,onProgress:function(t){if("function"==typeof e.onProgress)try{e.onProgress(t.percent)}catch(n){Pl.w("onProgress callback error:",n)}},onFileFinish:function(e,t,n){}}}},{key:"_createCosOptionsWXMiniApp",value:function(e){var t=this._getFile(e),n=this._genFileName(t.name),o=t.url;return{Bucket:"".concat(this.bucketName,"-").concat(this.appid),Region:this.region,Key:"".concat(this.directory,"/").concat(n),FilePath:o,onProgress:function(t){if(Pl.l(JSON.stringify(t)),"function"==typeof e.onProgress)try{e.onProgress(t.percent)}catch(n){Pl.w("onProgress callback error:",n)}}}}},{key:"_createCosOptionsPreSigUrl",value:function(e){var t=this,n="",o="",r=0,i=this._getFile(e);if(tl)n=this._genFileName(i.name),o=i.url,r=1;else{var a=i.name,s=a.slice(a.lastIndexOf("."));n=this._genFileName("".concat(ld(999999)).concat(s)),o=i,r=0}return this._getCosPreSigUrl({fileType:this.uploadFileType,fileName:n,uploadMethod:r,duration:this.duration}).then((function(r){var i=r.uploadUrl,a=r.downloadUrl,s=r.requestSnapshotUrl,u=void 0===s?void 0:s;return{url:i,fileType:t.uploadFileType,fileName:n,resources:o,downloadUrl:a,requestSnapshotUrl:u,onProgress:function(t){if("function"==typeof e.onProgress)try{e.onProgress(t.percent)}catch(n){Pl.w("onProgress callback error:",n),Pl.e(n)}}}}))}},{key:"_genFileName",value:function(e){return"".concat(Dd(),"-").concat(e)}},{key:"_setUploadFileType",value:function(e){this.uploadFileType=e}},{key:"_getSnapshotInfoByUrl",value:function(e){var t=this,n=new s_("getSnapshotInfo");return this.request({protocolName:Bg,requestData:{platform:this.getPlatform(),coverName:this._genFileName(ld(99999)),requestSnapshotUrl:e}}).then((function(e){var t=(e.data||{}).snapshotUrl;return n.setMessage("snapshotUrl:".concat(t)).end(),Hd(t)?{}:bd(t).then((function(e){return{snapshotUrl:t,snapshotWidth:e.width,snapshotHeight:e.height}}))})).catch((function(e){return Pl.w("".concat(t._n,"._getSnapshotInfoByUrl failed. error:"),e),n.setCode(e.errorCode).setMessage(e.errorInfo).end(),{}}))}},{key:"reset",value:function(){Pl.l("".concat(this._n,".reset"))}}]),o}(lh),XC=["downloadKey","pbDownloadKey","messageList"],$C=function(){function e(t){r(this,e),this._n="MergerMessageHandler",this._messageModule=t}return a(e,[{key:"uploadMergerMessage",value:function(e,t){var n=this,o="".concat(this._n,".").concat("uploadMergerMessage");Pl.d("".concat(o," message:"),e,"messageBytes:".concat(t));var r=e.payload.messageList,i=r.length,a=new s_("uploadMergerMessage");return this._messageModule.request({protocolName:Wg,requestData:{messageList:r}}).then((function(e){Pl.d("".concat(o," ok. response:"),e.data);var r=e.data,s=r.pbDownloadKey,u=r.downloadKey,c={pbDownloadKey:s,downloadKey:u,messageNumber:i};return a.setNetworkType(n._messageModule.getNetworkType()).setMessage("".concat(i,"-").concat(t,"-").concat(u)).end(),c})).catch((function(e){throw Pl.w("".concat(o," failed. error:"),e),n._messageModule.probeNetwork().then((function(t){var n=_(t,2),o=n[0],r=n[1];a.setError(e,o,r).end()})),e}))}},{key:"downloadMergerMessage",value:function(e){var n=this,o="".concat(this._n,".").concat("downloadMergerMessage");Pl.d("".concat(o," message:"),e);var r=e.payload.downloadKey,i=new s_("downloadMergerMessage");return i.setMessage("downloadKey:".concat(r)),this._messageModule.request({protocolName:Yg,requestData:{downloadKey:r}}).then((function(r){if(Pl.d("".concat(o," ok. response:"),r.data),td(e.clearElement)){var a=e.payload,s=(a.downloadKey,a.pbDownloadKey,a.messageList,h(a,XC));e.clearElement(),e.setElement({type:e.type,content:t({messageList:r.data.messageList},s)})}else{var u=[];r.data.messageList.forEach((function(e){if(!Hd(e)){var t=new sI(e);u.push(t)}})),e.payload.messageList=u,e.payload.downloadKey="",e.payload.pbDownloadKey=""}return i.setNetworkType(n._messageModule.getNetworkType()).end(),e})).catch((function(e){throw Pl.w("".concat(o," failed. key:").concat(r," error:"),e),n._messageModule.probeNetwork().then((function(t){var n=_(t,2),o=n[0],r=n[1];i.setError(e,o,r).end()})),e}))}},{key:"createMergerMessagePack",value:function(e,t,n){return e.conversationType===Ir.CONV_C2C?this._createC2CMergerMessagePack(e,t,n):this._createGroupMergerMessagePack(e,t,n)}},{key:"_createC2CMergerMessagePack",value:function(e,t,n){var o=null;t&&(t.offlinePushInfo&&(o=t.offlinePushInfo),!0===t.onlineUserOnly&&(o?o.disablePush=!0:o={disablePush:!0}));var r=[];if(Xl(t)&&Xl(t.messageControlInfo)){var i=t.messageControlInfo,a=i.excludedFromUnreadCount,s=i.excludedFromLastMessage,u=i.excludedFromContentModeration;!0===a&&r.push("NoUnread"),!0===s&&r.push("NoLastMsg"),!0===u&&r.push("NoMsgCheck")}var c="";Yl(e.cloudCustomData)&&e.cloudCustomData.length>0&&(c=e.cloudCustomData);var l=n.pbDownloadKey,d=n.downloadKey,p=n.messageNumber,f=e.payload,h=f.title,g=f.abstractList,v=f.compatibleText,m=this._messageModule.getModule(Uf),_=m&&m.isOnlineMessage(e,t)?0:void 0;return{protocolName:mh,tjgID:this._messageModule.generateTjgID(e),requestData:{fromAccount:this._messageModule.getMyUserID(),toAccount:e.to,msgBody:[{msgType:e.type,msgContent:{pbDownloadKey:l,downloadKey:d,title:h,abstractList:g,compatibleText:v,messageNumber:p}}],cloudCustomData:c,clientTime:e.clientTime,msgSeq:e.sequence,msgRandom:e.random,msgLifeTime:_,offlinePushInfo:o?{pushFlag:!0===o.disablePush?1:0,title:o.title||"",desc:o.description||"",ext:o.extension||"",apnsInfo:{badgeMode:!0===o.ignoreIOSBadge?1:0},androidInfo:{OPPOChannelID:o.androidOPPOChannelID||""}}:void 0,messageControlInfo:0!==_?r:void 0,isSupportExtension:!0===e.isSupportExtension?1:0}}}},{key:"_createGroupMergerMessagePack",value:function(e,t,n){var o=null;t&&t.offlinePushInfo&&(o=t.offlinePushInfo);var r=[];if(Xl(t)&&Xl(t.messageControlInfo)){var i=t.messageControlInfo,a=i.excludedFromUnreadCount,s=i.excludedFromLastMessage,u=i.excludedFromContentModeration;!0===a&&r.push("NoUnread"),!0===s&&r.push("NoLastMsg"),!0===u&&r.push("NoMsgCheck")}var c="";Yl(e.cloudCustomData)&&e.cloudCustomData.length>0&&(c=e.cloudCustomData);var l=n.pbDownloadKey,d=n.downloadKey,p=n.messageNumber,f=e.payload,h=f.title,g=f.abstractList,v=f.compatibleText,m=this._messageModule.getModule(xf),_=m&&m.isOnlineMessage(e,t)?1:0;return{protocolName:_h,tjgID:this._messageModule.generateTjgID(e),requestData:{fromAccount:this._messageModule.getMyUserID(),groupID:e.to,msgBody:[{msgType:e.type,msgContent:{pbDownloadKey:l,downloadKey:d,title:h,abstractList:g,compatibleText:v,messageNumber:p}}],random:e.random,priority:e.priority,clientSequence:e.clientSequence,groupAtInfo:void 0,cloudCustomData:c,onlineOnlyFlag:_,offlinePushInfo:o?{pushFlag:!0===o.disablePush?1:0,title:o.title||"",desc:o.description||"",ext:o.extension||"",apnsInfo:{badgeMode:!0===o.ignoreIOSBadge?1:0},androidInfo:{OPPOChannelID:o.androidOPPOChannelID||""}}:void 0,clientTime:e.clientTime,needReadReceipt:!0!==e.needReadReceipt||m.isMessageFromOrToAVChatroom(e.to)?0:1,messageControlInfo:0===_?r:void 0,isSupportExtension:!0===e.isSupportExtension?1:0}}}}]),e}(),QC={ERR_SVR_COMM_SENSITIVE_TEXT:80001,ERR_SVR_COMM_BODY_SIZE_LIMIT:80002,OPEN_SERVICE_OVERLOAD_ERROR:60022,ERR_SVR_MSG_PKG_PARSE_FAILED:20001,ERR_SVR_MSG_INTERNAL_AUTH_FAILED:20002,ERR_SVR_MSG_INVALID_ID:20003,ERR_SVR_MSG_PUSH_DENY:20006,ERR_SVR_MSG_IN_PEER_BLACKLIST:20007,ERR_SVR_MSG_BOTH_NOT_FRIEND:20009,ERR_SVR_MSG_NOT_PEER_FRIEND:20010,ERR_SVR_MSG_NOT_SELF_FRIEND:20011,ERR_SVR_MSG_SHUTUP_DENY:20012,ERR_SVR_GROUP_INVALID_PARAMETERS:10004,ERR_SVR_GROUP_PERMISSION_DENY:10007,ERR_SVR_GROUP_NOT_FOUND:10010,ERR_SVR_GROUP_INVALID_GROUPID:10015,ERR_SVR_GROUP_REJECT_FROM_THIRDPARTY:10016,ERR_SVR_GROUP_SHUTUP_DENY:10017,MESSAGE_SEND_FAIL:2100,OVER_FREQUENCY_LIMIT:2996},ek=[Ev,Gv,Uv,Dv,xv,jv,zv,Vv,Hv,Fv,qv,Iv];function tk(e){var t=!1;return Object.values(QC).includes(e)&&(t=!0),(e>=120001&&e<=13e4||e>=10100&&e<=10200)&&(t=!0),t}var nk,ok=function(e){u(o,e);var n=m(o);function o(e){var t;return r(this,o),(t=n.call(this,e))._n="MessageModule",t._messageOptionsMap=new Map,t._mergerMessageHandler=new $C(g(t)),t}return a(o,[{key:"createTextMessage",value:function(e){var t=this.getMyUserID();e.currentUser=t,e.senderTinyID=this.getMyTinyID();var n=new lI(e),o="string"==typeof e.payload?e.payload:e.payload.text,r=new f_({text:o}),i=this._getNickAndAvatarByUserID(t);return n.setElement(r),n.setNickAndAvatar(i),n.setNameCard(this._getNameCardByGroupID(n)),n}},{key:"createImageMessage",value:function(e){var t=this.getMyUserID();e.currentUser=t,e.senderTinyID=this.getMyTinyID();var n=new lI(e);if(tl){var o=e.payload.file;if(Zl(o))return void this.outputWarning("FileUnsupportedInMP","createImageMessage");var r=o.tempFiles[0].path||o.tempFiles[0].tempFilePath,i={url:r,name:r.slice(r.lastIndexOf("/")+1),size:o.tempFiles&&o.tempFiles[0].size||1,type:r.slice(r.lastIndexOf(".")+1).toLowerCase()};e.payload.file=i}else if(nl)if(Zl(e.payload.file)){var a=e.payload.file;e.payload.file={files:[a]}}else if(Xl(e.payload.file)&&"undefined"!=typeof uni){var s=e.payload.file.tempFiles[0];e.payload.file={files:[s]}}var u=new jM({imageFormat:Gl.UNKNOWN,uuid:this._generateUUID(e.payload.file),file:e.payload.file}),c=this._getNickAndAvatarByUserID(t);return n.setElement(u),n.setNickAndAvatar(c),n.setNameCard(this._getNameCardByGroupID(n)),this._messageOptionsMap.set(n.clientSequence,e),n}},{key:"createAudioMessage",value:function(e){var t=e.payload.file;if(tl){var n={url:t.tempFilePath,name:t.tempFilePath.slice(t.tempFilePath.lastIndexOf("/")+1),size:t.fileSize,second:parseInt(t.duration)/1e3,type:t.tempFilePath.slice(t.tempFilePath.lastIndexOf(".")+1).toLowerCase()};e.payload.file=n}var o=this.getMyUserID();e.currentUser=o,e.senderTinyID=this.getMyTinyID();var r=new lI(e),i=new ZM({second:Math.floor(t.duration/1e3),size:t.fileSize||t.size,url:t.tempFilePath,uuid:this._generateUUID(e.payload.file)}),a=this._getNickAndAvatarByUserID(o);return r.setElement(i),r.setNickAndAvatar(a),r.setNameCard(this._getNameCardByGroupID(r)),this._messageOptionsMap.set(r.clientSequence,e),r}},{key:"createVideoMessage",value:function(e){var t=this.getMyUserID();e.currentUser=t,e.senderTinyID=this.getMyTinyID(),e.payload.file.thumbUrl="",e.payload.file.thumbSize=0;var n={};if(tl){if($c)return void this.outputWarning("VideoUnsupportedInAlipay");if(Zl(e.payload.file))return void this.outputWarning("FileUnsupportedInMP","createVideoMessage");var o=e.payload.file;$l(o.tempFiles)&&(o=o.tempFiles[0]),n.url=o.tempFilePath,n.name=o.tempFilePath.slice(o.tempFilePath.lastIndexOf("/")+1),n.size=o.size,n.second=o.duration,n.type=o.tempFilePath.slice(o.tempFilePath.lastIndexOf(".")+1).toLowerCase()}else if(nl){if(Zl(e.payload.file)){var r=e.payload.file;e.payload.file.files=[r]}else if(Xl(e.payload.file)&&"undefined"!=typeof uni){var i=e.payload.file.tempFile;e.payload.file.files=[i]}var a=e.payload.file;n.url=window.URL.createObjectURL(a.files[0]),n.name=a.files[0].name,n.size=a.files[0].size,n.second=a.files[0].duration||0,n.type=a.files[0].type.split("/")[1]}e.payload.file.videoFile=n;var s=new lI(e),u=new iI({videoFormat:n.type,videoSecond:Od(n.second,0),videoSize:n.size,remoteVideoUrl:"",videoUrl:n.url,videoUUID:this._generateUUID(e.payload.file.videoFile),thumbUUID:this._generateUUID(e.payload.file.videoFile),thumbWidth:e.payload.file.width||200,thumbHeight:e.payload.file.height||200,thumbUrl:e.payload.file.thumbUrl,thumbSize:e.payload.file.thumbSize,thumbFormat:e.payload.file.thumbUrl.slice(e.payload.file.thumbUrl.lastIndexOf(".")+1).toLowerCase()}),c=this._getNickAndAvatarByUserID(t);return s.setElement(u),s.setNickAndAvatar(c),s.setNameCard(this._getNameCardByGroupID(s)),this._messageOptionsMap.set(s.clientSequence,e),s}},{key:"createCustomMessage",value:function(e){var t=this.getMyUserID();e.currentUser=t,e.senderTinyID=this.getMyTinyID();var n=new lI(e),o=new rI({data:e.payload.data,description:e.payload.description,extension:e.payload.extension}),r=this._getNickAndAvatarByUserID(t);return n.setElement(o),n.setNickAndAvatar(r),n.setNameCard(this._getNameCardByGroupID(n)),n}},{key:"createFaceMessage",value:function(e){var t=this.getMyUserID();e.currentUser=t,e.senderTinyID=this.getMyTinyID();var n=new lI(e),o=new zM(e.payload),r=this._getNickAndAvatarByUserID(t);return n.setElement(o),n.setNickAndAvatar(r),n.setNameCard(this._getNameCardByGroupID(n)),n}},{key:"createMergerMessage",value:function(e){var t=this.getMyUserID();e.currentUser=t,e.senderTinyID=this.getMyTinyID();var n=this._getNickAndAvatarByUserID(t),o=new lI(e),r=new uI(e.payload);return o.setElement(r),o.setNickAndAvatar(n),o.setNameCard(this._getNameCardByGroupID(o)),o.setRelayFlag(!0),o}},{key:"createForwardMessage",value:function(e){var t=e.to,n=e.conversationType,o=e.priority,r=e.payload,i=e.needReadReceipt,a=e.receiverList,s=this.getMyUserID(),u=this._getNickAndAvatarByUserID(s);if(r.type===Ir.MSG_GRP_TIP)return vI({code:Xv});var c={to:t,conversationType:n,conversationID:"".concat(n).concat(t),priority:o,isPlaceMessage:0,status:xp.UNSEND,currentUser:s,senderTinyID:this.getMyTinyID(),cloudCustomData:e.cloudCustomData||r.cloudCustomData||"",needReadReceipt:i,receiverList:a,isSupportExtension:e.isSupportExtension||!1},l=new lI(c);return l.setElement(r.getElements()[0]),l.setNickAndAvatar(u),l.setNameCard(this._getNameCardByGroupID(r)),l.setRelayFlag(!0),l}},{key:"downloadMergerMessage",value:function(e){return this._mergerMessageHandler.downloadMergerMessage(e)}},{key:"createFileMessage",value:function(e){if(tl){if(!Wc&&!Yc&&!Qc)return;var n=ol.getSystemInfoSync().SDKVersion;if(Wc&&Ad(n,"2.5.0")<0)return void this.outputWarning("WXChooseMessageFile");if(Yc&&Ad(n,"1.18.0")<0)return void this.outputWarning("QQChooseMessageFile")}if(nl||Qc){if(Zl(e.payload.file)){var o=e.payload.file;e.payload.file={files:[o]}}else if(Xl(e.payload.file)&&"undefined"!=typeof uni){var r=e.payload.file,i=r.tempFiles,a=r.files,s=null;$l(i)?s=i[0]:$l(a)&&(s=a[0]),e.payload.file={files:[s]}}}else if(Wc||Yc){var u=e.payload.file.tempFiles,c=t(t({},u[0]),{},{url:u[0].path});e.payload.file={files:[c]}}var l=this.getMyUserID();e.currentUser=l,e.senderTinyID=this.getMyTinyID();var d=new lI(e),p=new oI({uuid:this._generateUUID(e.payload.file),file:e.payload.file}),f=this._getNickAndAvatarByUserID(l);return d.setElement(p),d.setNickAndAvatar(f),d.setNameCard(this._getNameCardByGroupID(d)),this._messageOptionsMap.set(d.clientSequence,e),d}},{key:"createLocationMessage",value:function(e){var t=this.getMyUserID();e.currentUser=t,e.senderTinyID=this.getMyTinyID();var n=new lI(e),o=new aI(e.payload),r=this._getNickAndAvatarByUserID(t);return n.setElement(o),n.setNickAndAvatar(r),n.setNameCard(this._getNameCardByGroupID(n)),n}},{key:"_onCannotFindModule",value:function(){return vI({code:Rm})}},{key:"sendMessageInstance",value:function(e,t){var n=this;if(!1===this.getModule(ah).filterMessage(e,t))return this._onSendMessageFailed(e,new pI({code:Vm}));var o,r=null;switch(e.conversationType){case Ir.CONV_C2C:if(!(r=this.getModule(Uf)))return this._onCannotFindModule();break;case Ir.CONV_GROUP:if(!(r=this.getModule(xf)))return this._onCannotFindModule();if(Md({groupID:e.to})){var i=r.getLocalGroupProfile(e.to);if(i&&i.isSupportTopic)return vI({code:Ov})}break;default:return vI({code:bv})}var a=this.getModule(Wf),s=this.getModule(xf);return a.upload(e).then((function(){return n._getSendMessageSpecifiedKey(e)===$m&&n.getModule(oh).addSuccessCount(Qm),s.guardForAVChatRoom(e).then((function(){if(!e.isSendable())return vI({code:Zv});n._addSendMessageTotalCount(e),o=Date.now();var i=function(e){var t="utf-8";nl&&document&&(t=document.charset.toLowerCase());var n,o,r=0;if(o=e.length,"utf-8"===t||"utf8"===t)for(var i=0;i<o;i++)(n=e.codePointAt(i))<=127?r+=1:n<=2047?r+=2:n<=65535?r+=3:(r+=4,i++);else if("utf-16"===t||"utf16"===t)for(var a=0;a<o;a++)(n=e.codePointAt(a))<=65535?r+=2:(r+=4,a++);else r=e.replace(/[^\x00-\xff]/g,"aa").length;return r}(JSON.stringify(e));return e.type===Ir.MSG_MERGER&&i>11264?n._mergerMessageHandler.uploadMergerMessage(e,i).then((function(o){var r=n._mergerMessageHandler.createMergerMessagePack(e,t,o);return n.request(r)})):(n.getModule(Vf).setMessageRandom(e),e.conversationType===Ir.CONV_C2C||e.conversationType===Ir.CONV_GROUP?r.sendMessage(e,t):void 0)})).then((function(i){var a=i.data,s=a.time,u=a.sequence,c=a.readReceiptCode;Wl(c)&&0!==c&&(new s_("sendMessageWithReceipt").setMessage("from:".concat(e.from," to:").concat(e.to," sequence:").concat(u," readReceiptCode:").concat(c)).end(),Pl.w("".concat(n._n,".sendMessageInstance readReceiptCode:").concat(c," message:").concat(n.getErrorMessage(c)))),n._addSendMessageSuccessCount(e,o),n._messageOptionsMap.delete(e.clientSequence);var l=n.getModule(Vf);e.status=xp.SUCCESS,e.time=s;var d=!1;if(e.conversationType===Ir.CONV_GROUP)e.sequence=u;else if(e.conversationType===Ir.CONV_C2C){var p=l.getLatestMessageSentByMe(e.conversationID);if(p){var f=p.nick,h=p.avatar;f===e.nick&&h===e.avatar||(d=!0)}}if(d&&l.modifyMessageSentByMe({conversationID:e.conversationID,latestNick:e.nick,latestAvatar:e.avatar}),r.isOnlineMessage(e,t))e._onlineOnlyFlag=!0;else{l.appendToMessageList(e);var g=e;Xl(t)&&Xl(t.messageControlInfo)&&(!0===t.messageControlInfo.excludedFromLastMessage&&(e._isExcludedFromLastMessage=!0,g=""),!0===t.messageControlInfo.excludedFromUnreadCount&&(e._isExcludedFromUnreadCount=!0));var v=e.conversationType;Id(e.to)&&(v=Ir.CONV_TOPIC,n.getModule(Bf).onMessageSent({groupID:Gd(e.to),topicID:e.to,lastMessage:g})),l.onMessageSent({conversationOptionsList:[{conversationID:e.conversationID,unreadCount:0,type:v,subType:e.conversationSubType,lastMessage:g}]})}return e.getRelayFlag()||"TIMImageElem"!==e.type||Rd(e.payload.imageInfoArray),dI({message:e})}))})).catch((function(t){return n._onSendMessageFailed(e,t)}))}},{key:"_onSendMessageFailed",value:function(e,t){e.status=xp.FAIL,this.getModule(Vf).deleteMessageRandom(e),this._addSendMessageFailCountOnUser(e,t);var n=new s_("sendMessage");return n.setMessage("tjg_id:".concat(this.generateTjgID(e)," type:").concat(e.type," from:").concat(e.from," to:").concat(e.to)),this.probeNetwork().then((function(e){var o=_(e,2),r=o[0],i=o[1];n.setError(t,r,i).end()})),Pl.e("".concat(this._n,"._onSendMessageFailed error:"),t),vI(new pI({code:t&&t.code?t.code:kv,message:t&&t.message?t.message:void 0,data:{message:e}}))}},{key:"_getSendMessageSpecifiedKey",value:function(e){if([Ir.MSG_IMAGE,Ir.MSG_AUDIO,Ir.MSG_VIDEO,Ir.MSG_FILE].includes(e.type))return $m;if(e.conversationType===Ir.CONV_C2C)return Ym;if(e.conversationType===Ir.CONV_GROUP){var t=this.getModule(xf).getLocalGroupProfile(e.to);if(!t)return;var n=t.type;return yd(n)?Xm:Jm}}},{key:"_addSendMessageTotalCount",value:function(e){var t=this._getSendMessageSpecifiedKey(e);t&&this.getModule(oh).addTotalCount(t)}},{key:"_addSendMessageSuccessCount",value:function(e,t){var n=Math.abs(Date.now()-t),o=this._getSendMessageSpecifiedKey(e);if(o){var r=this.getModule(oh);r.addSuccessCount(o),r.addCost(o,n)}}},{key:"_addSendMessageFailCountOnUser",value:function(e,t){var n,o,r=t.code,i=void 0===r?-1:r,a=this.getModule(oh),s=this._getSendMessageSpecifiedKey(e);s===$m&&(n=i,o=!1,ek.includes(n)&&(o=!0),o)?a.addFailedCountOfUserSide(Qm):tk(i)&&s&&a.addFailedCountOfUserSide(s)}},{key:"resendMessage",value:function(e){return e.isResend=!0,e.status=xp.UNSEND,this.sendMessageInstance(e)}},{key:"revokeMessage",value:function(e){var t=this,n=null;if(e.conversationType===Ir.CONV_C2C?n=this.getModule(Uf):e.conversationType===Ir.CONV_GROUP&&(n=this.getModule(xf)),!n)return this._onCannotFindModule();var o=new s_("revokeMessage");o.setMessage("tjg_id:".concat(this.generateTjgID(e)," type:").concat(e.type," from:").concat(e.from," to:").concat(e.to));var r="".concat(this._n,".").concat("revokeMessage");return n.revokeMessage(e).then((function(n){var i=n.data.recallRetList;if(!Hd(i)&&0!==i[0].retCode){var a=new pI({code:i[0].retCode,data:{message:e}});return o.setCode(a.code).setMoreMessage(a.message).end(),vI(a)}return Pl.i("".concat(r," ok. ID:").concat(e.ID)),e.isRevoked=!0,o.end(),t.getModule(Vf).onMessageRevoked([e]),dI({message:e})})).catch((function(n){t.probeNetwork().then((function(e){var t=_(e,2),r=t[0],i=t[1];o.setError(n,r,i).end()}));var i=new pI({code:n&&n.code?n.code:Av,message:n&&n.message?n.message:void 0,data:{message:e}});return Pl.w("".concat(r," failed. error:"),n),vI(i)}))}},{key:"deleteMessage",value:function(e){var t=this,n=null,o=e[0],r=o.conversationID,i="",a=[],s=[];if(o.conversationType===Ir.CONV_C2C)n=this.getModule(Uf),i=r.replace(Ir.CONV_C2C,""),e.forEach((function(e){e&&e.status===xp.SUCCESS&&e.conversationID===r&&(e._onlineOnlyFlag||a.push("".concat(e.sequence,"_").concat(e.random,"_").concat(e.time)),s.push(e))}));else if(o.conversationType===Ir.CONV_GROUP)n=this.getModule(xf),i=r.replace(Ir.CONV_GROUP,""),e.forEach((function(e){e&&e.status===xp.SUCCESS&&e.conversationID===r&&(e._onlineOnlyFlag||a.push("".concat(e.sequence)),s.push(e))}));else if(o.conversationType===Ir.CONV_SYSTEM)return vI({code:Nv});if(!n)return this._onCannotFindModule();if(0===a.length)return this._onMessageDeleted(s);a.length>30&&(a=a.slice(0,30),s=s.slice(0,30));var u=new s_("deleteMessage");u.setMessage("to:".concat(i," count:").concat(a.length));var c="".concat(this._n,".").concat("deleteMessage");return n.deleteMessage({to:i,keyList:a}).then((function(e){return u.end(),Pl.i("".concat(c," ok")),t._onMessageDeleted(s)})).catch((function(e){t.probeNetwork().then((function(t){var n=_(t,2),o=n[0],r=n[1];u.setError(e,o,r).end()})),Pl.w("".concat(c," failed. error:"),e);var n=new pI({code:e&&e.code?e.code:Lv,message:e&&e.message?e.message:void 0});return vI(n)}))}},{key:"_onMessageDeleted",value:function(e){return this.getModule(Vf).onMessageDeleted(e),gI({messageList:e})}},{key:"translateText",value:function(e){var n="".concat(this._n,".").concat("translateText"),o=e.sourceTextList,r=e.sourceLanguage,i=e.targetLanguage,a=new s_("translateText");return a.setMessage("sourceLanguage:".concat(r," targetLanguage:").concat(i)),this.request({protocolName:fv,requestData:{sourceTextList:o,source:r||"auto",target:i,from:this.getMyTinyID(),SDKAppID:this.getSDKAppID()}}).then((function(e){var o=e.data,r=o.error,i=o.requestID,s=o.translatedTextList;if(0===r.code)return a.end(),Pl.i("".concat(n," ok. requestID:").concat(i)),dI({translatedTextList:s});throw t(t({},r),{},{requestID:i})})).catch((function(e){return a.setCode(e.code).setMoreMessage(e.requestID).end(),Pl.w("".concat(n," failed. error:"),e),vI({code:Pv})}))}},{key:"modifyRemoteMessage",value:function(e){var t=this,n=null,o=e.conversationType,r=e.to;if(this.getModule(xf).isMessageFromOrToAVChatroom(r))return vI({code:Qv,data:{message:e}});if(!1===this.getModule(ah).filterMessage(e))return vI({code:Vm,data:{message:e}});o===Ir.CONV_C2C?n=this.getModule(Uf):o===Ir.CONV_GROUP&&(n=this.getModule(xf));var i=new s_("modifyMessage");i.setMessage("to:".concat(r));var a="".concat(this._n,".modifyRemoteMessage");return n.modifyRemoteMessage(e).then((function(n){i.end(),Pl.i("".concat(a," ok"));var o=t._onModifyRemoteMessageResp(e,n.data);return dI({message:o})})).catch((function(n){if(i.setCode(n.code).setMoreMessage(n.message).end(),Pl.w("".concat(a," failed. error:"),n),20027===n.code){var o=t._onModifyRemoteMessageResp(e,n.data);return vI({code:$v,data:{message:o}})}return vI({code:n.code,message:n.message,data:{message:e}})}))}},{key:"_onModifyRemoteMessageResp",value:function(e,t){Pl.d("".concat(this._n,"._onModifyRemoteMessageResp options:"),t);var n=e.conversationType,o=e.from,r=e.to,i=e.random,a=e.sequence,s=e.time,u=t.elements,c=t.messageVersion,l=t.cloudCustomData,d=void 0===l?"":l;return this.getModule(Vf).onMessageModified({conversationType:n,from:o,to:r,time:s,random:i,sequence:a,elements:u,cloudCustomData:d,messageVersion:c})}},{key:"_generateUUID",value:function(e){var t=this.getModule(Hf),n="".concat(t.getSDKAppID(),"-").concat(t.getUserID(),"-").concat(function(){for(var e="",t=32;t>0;--t)e+=dd[Math.floor(Math.random()*pd)];return e}()),o=e.name||e.value||e.url||e.tempFilePath,r=o&&o.slice(o.lastIndexOf(".")+1);return r&&(n="".concat(n,".").concat(r)),n}},{key:"getMessageOption",value:function(e){return this._messageOptionsMap.get(e)}},{key:"_getNickAndAvatarByUserID",value:function(e){return this.getModule(Gf).getNickAndAvatarByUserID(e)}},{key:"_getNameCardByGroupID",value:function(e){if(e.conversationType===Ir.CONV_GROUP){var t=this.getModule(xf);if(t)return t.getMyNameCardByGroupID(e.to)}return""}},{key:"reset",value:function(){Pl.l("".concat(this._n,".reset")),this._messageOptionsMap.clear()}}]),o}(lh),rk=function(e){u(n,e);var t=m(n);function n(e){var o;return r(this,n),(o=t.call(this,e))._n="MessageExtensionModule",o.messageExtensionMap=new Map,o.globalSeqMap=new Map,o.getMessageExtensionsMap=new Map,o}return a(n,[{key:"onMessageExtensionNotify",value:function(e){var t=this,n=e.dataList,o=n.messageInfo,r=n.operateType,i=n.operateResultList,a=n.tinyID,s=n.globalSequence,u=o.clientTime,c=o.random,l="".concat(a,"-").concat(u,"-").concat(c),d=[],p=[];Pl.l("".concat(this._n,".onMessageExtensionNotify messageID:").concat(l," operateType:").concat(r," globalSequence:").concat(s)),this._updateGlobalSequence(l,s);var f=!1,h=!1;i.forEach((function(e){var n=e.extensions,o=void 0===n?[]:n,i=e.clearSequence;1===r?(f=!0,o.forEach((function(e){d.push({key:e.key,value:e.value})})),t._updateLocalExtension(l,o)):2===r?(h=!0,o.forEach((function(e){p.push(e.key)})),t._updateLocalExtension(l,o)):3===r&&(h=!0,t._hasLocalExtension(l)&&t._getLocalExtension(l).forEach((function(e,t){e.seq<=i&&!Hd(e.value)&&p.push(t)})),t._clearLocalExtension(l,i))})),f&&this.emitOuterEvent(Mr.MESSAGE_EXTENSIONS_UPDATED,{messageID:l,extensions:d}),h&&this.emitOuterEvent(Mr.MESSAGE_EXTENSIONS_DELETED,{messageID:l,keyList:p})}},{key:"setMessageExtensions",value:function(e,t){var n=this;if(!this.canIUse(Uc.MSG_EXT))return vI({code:Bm});var o="".concat(this._n,".").concat("setMessageExtensions"),r=e.ID,i=e.conversationID,a=e.sequence,s=e.time,u=y(t);t.length>20&&(u=t.slice(0,20),Pl.w("".concat(o,". the length of extensions cannot exceed 20.")));var c="conversationID:".concat(i," messageID:").concat(r," sequence:").concat(a," time:").concat(s," count:").concat(u.length),l=new s_("setMessageExtensions");return l.setMessage(c),Pl.l("".concat(o," ").concat(c)),this._modifyMessageExtensions(e,u).then((function(e){var t=e.resultList,n=e.successCount,r=e.failureCount,i="success count:".concat(n," fail count:").concat(r);return l.setMoreMessage(i).end(),Pl.l("".concat(o," ok. ").concat(i)),dI({extensions:t})})).catch((function(e){return n.probeNetwork().then((function(t){var n=_(t,2),o=n[0],r=n[1];l.setError(e,o,r).end()})),Pl.e("".concat(o," failed. error:"),e),vI(e)}))}},{key:"getMessageExtensions",value:function(e){var t=this;if(!this.canIUse(Uc.MSG_EXT))return vI({code:Bm});var n="".concat(this._n,".").concat("getMessageExtensions"),o=e.ID,r=e.conversationID,i=e.sequence,a=e.time,s="conversationID:".concat(r," messageID:").concat(o," sequence:").concat(i," time:").concat(a),u=new s_("getMessageExtensions");u.setMessage(s),Pl.l("".concat(n," ").concat(s));var c=void 0;return this.getMessageExtensionsMap.has(o)&&(c=this._getGlobalSequence(o)),this._getMessageExtensions(e,c).then((function(e){return u.end(),Pl.l("".concat(n," ok. total count:").concat(e.length)),Ql(c)&&e.length>0&&t.getMessageExtensionsMap.set(o,1),dI({extensions:e})})).catch((function(e){return t.probeNetwork().then((function(t){var n=_(t,2),o=n[0],r=n[1];u.setError(e,o,r).end()})),Pl.e("".concat(n," failed. error:"),e),vI(e)}))}},{key:"deleteMessageExtensions",value:function(e,t){var n=this;if(!this.canIUse(Uc.MSG_EXT))return vI({code:Bm});var o="".concat(this._n,".").concat("deleteMessageExtensions"),r=[],i=3;Hd(t)||(i=2,t.forEach((function(e){r.push({key:e,value:"",seq:0})})));var a=e.ID,s=e.conversationID,u=e.sequence,c=e.time,l="conversationID:".concat(s," messageID:").concat(a," sequence:").concat(u," time:").concat(c," operateType:").concat(i),d=new s_("deleteMessageExtensions");return d.setMessage(l),Pl.l("".concat(o," ").concat(l)),this._modifyMessageExtensions(e,r,i).then((function(e){var t=e.resultList,n=e.successCount,r=e.failureCount,a="";return 2===i&&(a="success count:".concat(n," fail count:").concat(r)),d.setMoreMessage("".concat(a)).end(),Pl.l("".concat(o," ok. ").concat(a)),dI({extensions:t})})).catch((function(e){return n.probeNetwork().then((function(t){var n=_(t,2),o=n[0],r=n[1];d.setError(e,o,r).end()})),Pl.e("".concat(o," failed. error:"),e),vI(e)}))}},{key:"_modifyMessageExtensions",value:function(e,t){var n=this,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=e.conversationType,i=void 0;3!==o&&(i=this._getRequestExtensions(e,t));var a=null;switch(r){case Ir.CONV_C2C:a=this.getModule(Uf);break;case Ir.CONV_GROUP:a=this.getModule(xf);break;default:return vI({code:Rm})}return a.modifyMessageExtensions(e,i,o).then((function(t){var o=t.data,r=o.extensions,i=o.seq,a=[],s=0,u=0,c=[];return(r=Hd(r)?[]:r).forEach((function(e){var t=e.errorCode,n=e.extension,o=n.key,r=n.value,i=n.seq;a.push({code:t,key:o,value:r}),0===t?s++:u++,c.push({key:o,value:r,seq:i})})),n._updateGlobalSequence(e.ID,i),c.length>0&&(n._updateLocalExtension(e.ID,c),c=null),{resultList:a,successCount:s,failureCount:u}})).catch((function(e){return vI(e)}))}},{key:"_getRequestExtensions",value:function(e,t){var n=[];if(this._hasLocalExtension(e.ID)){var o=this._getLocalExtension(e.ID);return t.forEach((function(e){var t=e.key,r=e.value,i=0;o.has(t)&&(i=o.get(t).seq),n.push({key:t,value:r,seq:i})})),n}return t.forEach((function(e){var t=e.key,o=e.value;n.push({key:t,value:o,seq:0})})),n}},{key:"_getMessageExtensions",value:function(e,t){var n=this,o="".concat(this._n,"._getMessageExtensions"),r=e.ID,i=null;switch(e.conversationType){case Ir.CONV_C2C:i=this.getModule(Uf);break;case Ir.CONV_GROUP:i=this.getModule(xf);break;default:return vI({code:Rm})}return i.getMessageExtensions(e,t).then((function(t){var i=t.data,a=i.extensions,s=i.completeFlag,u=i.globalSequence,c=i.clearSequence;if(a=Hd(a)?[]:a,Pl.l("".concat(o," ok. completeFlag:").concat(s," globalSequence:").concat(u," clearSequence:").concat(c," count:").concat(a.length)),n._updateLocalExtension(r,a),n._clearLocalExtension(r,c),n._updateGlobalSequence(r,u),1!==s){var l=a.slice(-1)[0].seq+1;return n._getMessageExtensions(e,l)}return n._getLocalExtensions(r)})).catch((function(e){return vI(e)}))}},{key:"_hasLocalExtension",value:function(e){return this.messageExtensionMap.has(e)}},{key:"_getLocalExtension",value:function(e){return this.messageExtensionMap.get(e)}},{key:"_updateLocalExtension",value:function(e,t){this._hasLocalExtension(e)||this.messageExtensionMap.set(e,new Map);var n=this._getLocalExtension(e);t.forEach((function(e){var t=e.key,o=e.value,r=void 0===o?"":o,i=e.seq;n.set(t,{value:r,seq:i})}))}},{key:"_clearLocalExtension",value:function(e,t){if(!(t<=0)&&this._hasLocalExtension(e)){var n=this._getLocalExtension(e);n.forEach((function(e,o){e.seq<=t&&n.delete(o)}))}}},{key:"_getLocalExtensions",value:function(e){var t=[];return this._hasLocalExtension(e)&&this._getLocalExtension(e).forEach((function(e,n){var o=e.value;Hd(o)||t.push({key:n,value:o})})),t}},{key:"_getGlobalSequence",value:function(e){return this.globalSeqMap.get(e)}},{key:"_updateGlobalSequence",value:function(e,t){this.globalSeqMap.set(e,t)}},{key:"reset",value:function(){Pl.l("".concat(this._n,".reset")),this.messageExtensionMap.clear(),this.globalSeqMap.clear(),this.getMessageExtensionsMap.clear()}}]),n}(lh),ik=function(e){u(n,e);var t=m(n);function n(e){var o;return r(this,n),(o=t.call(this,e))._n="ComboMessageModule",o}return a(n,[{key:"sendMessage",value:function(e){var t=this,n=this._constructMessageInstance(e);if(null===n)return vI({code:kv});this._addSendMessageTotalCount(n);var o=Date.now();return this.getModule(Vf).setMessageRandom(n),this._sendComboMessage(n,e).then((function(e){var r=e.data,i=r.time,a=r.sequence,s=r.readReceiptCode;Wl(s)&&0!==s&&(new s_("sendMessageWithReceipt").setMessage("from:".concat(n.from," to:").concat(n.to," sequence:").concat(a," readReceiptCode:").concat(s)).end(),Pl.w("".concat(t._n,".sendMessage readReceiptCode:").concat(s," message:").concat(t.getErrorMessage(s)))),t._addSendMessageSuccessCount(n,o);var u=t.getModule(Vf);n.status=xp.SUCCESS,n.time=i,n.conversationType===Ir.CONV_GROUP&&(n.sequence=a),u.appendToMessageList(n);var c=n;return!0===n._isExcludedFromLastMessage&&(c=""),u.onMessageSent({conversationOptionsList:[{conversationID:n.conversationID,unreadCount:0,type:n.conversationType,subType:n.conversationSubType,lastMessage:c}]}),dI({message:n})})).catch((function(e){return t._onSendMessageFailed(n,e)}))}},{key:"_sendComboMessage",value:function(e,t){var n=this._m.getModule(Xf),o="";return e.conversationType===Ir.CONV_C2C&&(o="".concat(Gc.NAME.OPEN_IM,".").concat(Gc.CMD.SEND_MESSAGE)),e.conversationType===Ir.CONV_GROUP&&(o="".concat(Gc.NAME.GROUP,".").concat(Gc.CMD.SEND_GROUP_MESSAGE)),n.sendComboMessage({servcmd:o,data:t})}},{key:"_constructMessageInstance",value:function(e){var t="".concat(this._n,"._constructMessageInstance"),n=null;try{var o=this.getMyUserID(),r={};if(r.senderTinyID=this.getMyTinyID(),r.currentUser=o,r.from=e.From_Account||o,e.GroupId?(r.conversationID="".concat(Ir.CONV_GROUP).concat(e.GroupId),r.conversationType=Ir.CONV_GROUP,r.to=e.GroupId):e.To_Account&&(r.conversationID="".concat(Ir.CONV_C2C).concat(e.To_Account),r.conversationType=Ir.CONV_C2C,r.to=e.To_Account),r.time=e.MsgTimeStamp||0,r.random=e.Random||e.MsgRandom||0,r.priority=e.MsgPriority,Yl(e.CloudCustomData)&&e.CloudCustomData.length>0&&(r.cloudCustomData=e.CloudCustomData),$l(e.SendMsgControl)&&(r.messageControlInfo={},e.SendMsgControl.includes("NoUnread")&&(r.messageControlInfo.excludedFromUnreadCount=1),e.SendMsgControl.includes("NoLastMsg")&&(r.messageControlInfo.excludedFromLastMessage=1)),r.conversationType===Ir.CONV_GROUP&&$l(e.To_Account)&&e.To_Account.length>0){var i=e.To_Account;e.To_Account.length>50&&(i=e.To_Account.slice(0,50),Pl.w("".concat(t," To_Account must be less than or equal to 50."))),r.receiverList=y(i),e.To_Account=y(i)}1!==e.IsNeedReadReceipt&&1!==e.NeedReadReceipt||(r.needReadReceipt=!0),1===e.SupportMessageExtension&&(r.isSupportExtension=!0),(n=new lI(r)).status=xp.UNSEND,e.MsgClientTime=n.clientTime,n.conversationType===Ir.CONV_C2C&&(e.MsgSeq=n.sequence);for(var a,s=e.MsgBody.length,u=0;u<s;u++)"TIMTextElem"===(a=e.MsgBody[u]).MsgType?n.setTextElement(a.MsgContent.Text):"TIMCustomElem"===a.MsgType?n.setCustomElement({data:a.MsgContent.Data||"",description:a.MsgContent.Desc||"",extension:a.MsgContent.Ext||""}):"TIMFaceElem"===a.MsgType&&n.setFaceElement({index:a.MsgContent.Index,data:a.MsgContent.Data});var c=n.getElements();n.payload=c[0].content,n.type=c[0].type}catch(yD){n=null,Pl.e("".concat(t," failed. error:"),yD)}return n}},{key:"_onSendMessageFailed",value:function(e,t){e.status=xp.FAIL,this.getModule(Vf).deleteMessageRandom(e),this._addSendMessageFailCountOnUser(e,t);var n=new s_("sendMessage");return n.setMessage("tjg_id:".concat(this.generateTjgID(e)," type:").concat(e.type," from:").concat(e.from," to:").concat(e.to)),this.probeNetwork().then((function(e){var o=_(e,2),r=o[0],i=o[1];n.setError(t,r,i).end()})),Pl.e("".concat(this._n,"._onSendMessageFailed error:"),t),vI(new pI({code:t&&t.code?t.code:kv,message:t&&t.message?t.message:void 0,data:{message:e}}))}},{key:"_getSendMessageSpecifiedKey",value:function(e){if(e.conversationType===Ir.CONV_C2C)return Ym;if(e.conversationType===Ir.CONV_GROUP){var t=this.getModule(xf).getLocalGroupProfile(e.to);if(!t)return;var n=t.type;return yd(n)?Xm:Jm}}},{key:"_addSendMessageTotalCount",value:function(e){var t=this._getSendMessageSpecifiedKey(e);t&&this.getModule(oh).addTotalCount(t)}},{key:"_addSendMessageSuccessCount",value:function(e,t){var n=Math.abs(Date.now()-t),o=this._getSendMessageSpecifiedKey(e);if(o){var r=this.getModule(oh);r.addSuccessCount(o),r.addCost(o,n)}}},{key:"_addSendMessageFailCountOnUser",value:function(e,t){var n=t.code,o=void 0===n?-1:n,r=this.getModule(oh),i=this._getSendMessageSpecifiedKey(e);tk(o)&&i&&r.addFailedCountOfUserSide(i)}}]),n}(lh),ak=function(e){u(n,e);var t=m(n);function n(e){var o;return r(this,n),(o=t.call(this,e))._n="PluginModule",o.plugins={},o}return a(n,[{key:"registerPlugin",value:function(e){var t=this;Object.keys(e).forEach((function(n){t.plugins[n]=e[n]})),new s_("registerPlugin").setMessage("".concat(Object.keys(e))).end()}},{key:"getPlugin",value:function(e){return this.plugins[e]}},{key:"reset",value:function(){}}]),n}(lh),sk=function(e){u(o,e);var n=m(o);function o(e){var t;return r(this,o),(t=n.call(this,e))._n="SyncUnreadMessageModule",t._cookie="",t._onlineSyncFlag=!1,t.getInnerEmitterInstance().on(OI,t._onLoginSuccess,g(t)),t}return a(o,[{key:"_onLoginSuccess",value:function(e){this._startSync({cookie:this._cookie,syncFlag:0,isOnlineSync:0})}},{key:"_startSync",value:function(e){var n=this,o=e.cookie,r=e.syncFlag,i=e.isOnlineSync,a="".concat(this._n,"._startSync");Pl.l("".concat(a," cookie:").concat(o," syncFlag:").concat(r," isOnlineSync:").concat(i)),this.request({protocolName:gh,requestData:{cookie:o,syncFlag:r,isOnlineSync:i}}).then((function(e){var o=e.data,r=o.cookie,i=o.syncFlag;n._cookie=r,Hd(r)||(0===i||1===i?(n._dispatchUnreadMessage(t(t({},e.data),{},{isSyncingEnded:!1})),n._startSync({cookie:r,syncFlag:i,isOnlineSync:0})):2===i&&n._dispatchUnreadMessage(t(t({},e.data),{},{isSyncingEnded:!0})))})).catch((function(e){Pl.e("".concat(a," failed. error:"),e)}))}},{key:"_dispatchUnreadMessage",value:function(e){e.eventArray&&this.getModule(Xf).onMessage({head:{},body:{eventArray:e.eventArray,isInstantMessage:this._onlineSyncFlag,isSyncingEnded:e.isSyncingEnded}}),this.getModule(Uf).onNewC2CMessage({dataList:e.messageList,isInstantMessage:!!e.isSyncingEnded&&this._onlineSyncFlag,C2CRemainingUnreadList:e.C2CRemainingUnreadList,C2CPairUnreadList:e.C2CPairUnreadList})}},{key:"startOnlineSync",value:function(){Pl.l("".concat(this._n,".startOnlineSync")),this._onlineSyncFlag=!0,this._startSync({cookie:this._cookie,syncFlag:0,isOnlineSync:1})}},{key:"startSyncOnReconnected",value:function(){Pl.l("".concat(this._n,".startSyncOnReconnected.")),this._onlineSyncFlag=!0,this._startSync({cookie:this._cookie,syncFlag:0,isOnlineSync:0})}},{key:"reset",value:function(){Pl.l("".concat(this._n,".reset")),this._onlineSyncFlag=!1,this._cookie=""}}]),o}(lh),uk={request:{toAccount:"To_Account",fromAccount:"From_Account",to:"To_Account",from:"From_Account",groupID:"GroupId",groupAtUserID:"GroupAt_Account",extension:"Ext",data:"Data",description:"Desc",elements:"MsgBody",sizeType:"Type",downloadFlag:"Download_Flag",thumbUUID:"ThumbUUID",videoUUID:"VideoUUID",remoteAudioUrl:"Url",remoteVideoUrl:"VideoUrl",videoUrl:"",imageUrl:"URL",fileUrl:"Url",uuid:"UUID",priority:"MsgPriority",receiverUserID:"To_Account",receiverGroupID:"GroupId",messageSender:"SenderId",messageReceiver:"ReceiverId",nick:"From_AccountNick",avatar:"From_AccountHeadurl",messageNumber:"MsgNum",pbDownloadKey:"PbMsgKey",downloadKey:"JsonMsgKey",applicationType:"PendencyType",userIDList:"To_Account",groupNameList:"GroupName",userID:"To_Account",groupAttributeList:"GroupAttr",mainSequence:"AttrMainSeq",avChatRoomKey:"BytesKey",attributeControl:"AttrControl",sequence:"seq",messageControlInfo:"SendMsgControl",updateSequence:"UpdateSeq",clientTime:"MsgClientTime",sequenceList:"MsgSeqList",topicID:"TopicId",customData:"CustomString",isSupportTopic:"SupportTopic",isWebUniapp:"is_web_uniapp",isSupportExtension:"SupportMessageExtension",messageSequence:"MsgSeq",messageKey:"MsgKey",startSequence:"startSeq"},response:{MsgPriority:"priority",ThumbUUID:"thumbUUID",VideoUUID:"videoUUID",Download_Flag:"downloadFlag",GroupId:"groupID",Member_Account:"userID",MsgList:"messageList",SyncFlag:"syncFlag",To_Account:"to",From_Account:"from",MsgSeq:"sequence",MsgRandom:"random",MsgTime:"time",MsgTimeStamp:"time",MsgContent:"content",MsgBody:"elements",From_AccountNick:"nick",From_AccountHeadurl:"avatar",GroupWithdrawInfoArray:"revokedInfos",GroupReadInfoArray:"groupMessageReadNotice",LastReadMsgSeq:"lastMessageSeq",WithdrawC2cMsgNotify:"c2cMessageRevokedNotify",C2cWithdrawInfoArray:"revokedInfos",C2cReadedReceipt:"c2cMessageReadReceipt",ReadC2cMsgNotify:"c2cMessageReadNotice",LastReadTime:"peerReadTime",MsgRand:"random",MsgType:"type",MsgShow:"messageShow",NextMsgSeq:"nextMessageSeq",FaceUrl:"avatar",ProfileDataMod:"profileModify",Profile_Account:"userID",ValueBytes:"value",ValueNum:"value",NoticeSeq:"noticeSequence",NotifySeq:"notifySequence",MsgFrom_AccountExtraInfo:"messageFromAccountExtraInformation",Operator_Account:"operatorID",OpType:"operationType",ReportType:"operationType",UserId:"userID",User_Account:"userID",List_Account:"userIDList",MsgOperatorMemberExtraInfo:"operatorInfo",MsgMemberExtraInfo:"memberInfoList",ImageUrl:"avatar",NickName:"nick",MsgGroupNewInfo:"newGroupProfile",MsgAppDefinedData:"groupCustomField",Owner_Account:"ownerID",GroupFaceUrl:"avatar",GroupIntroduction:"introduction",GroupNotification:"notification",GroupApplyJoinOption:"joinOption",MsgKey:"messageKey",GroupInfo:"groupProfile",ShutupTime:"muteTime",Desc:"description",Ext:"extension",GroupAt_Account:"groupAtUserID",MsgNum:"messageNumber",PbMsgKey:"pbDownloadKey",JsonMsgKey:"downloadKey",MsgModifiedFlag:"isModified",PendencyItem:"applicationItem",PendencyType:"applicationType",AddTime:"time",AddSource:"source",AddWording:"wording",ProfileImImage:"avatar",PendencyAdd:"friendApplicationAdded",FrienPencydDel_Account:"friendApplicationDeletedUserIDList",Peer_Account:"userID",GroupAttr:"groupAttributeList",GroupAttrAry:"groupAttributeList",AttrMainSeq:"mainSequence",seq:"sequence",GroupAttrOption:"groupAttributeOption",BytesChangedKeys:"changedKeyList",GroupAttrInfo:"groupAttributeList",GroupAttrSeq:"mainSequence",PushChangedAttrValFlag:"isWithChangedAttributeInfo",SubKeySeq:"sequence",Val:"value",MsgGroupFromCardName:"senderNameCard",MsgGroupFromNickName:"senderNick",C2cNick:"peerNick",C2cImage:"peerAvatar",SendMsgControl:"messageControlInfo",NoLastMsg:"excludedFromLastMessage",NoUnread:"excludedFromUnreadCount",UpdateSeq:"updateSequence",MuteNotifications:"muteFlag",MsgClientTime:"clientTime",TinyId:"tinyID",GroupMsgReceiptList:"readReceiptList",ReadNum:"readCount",UnreadNum:"unreadCount",TopicId:"topicID",MillionGroupFlag:"communityType",SupportTopic:"isSupportTopic",MsgTopicNewInfo:"newTopicInfo",ShutupAll:"muteAllMembers",CustomString:"customData",TopicFaceUrl:"avatar",TopicIntroduction:"introduction",TopicNotification:"notification",TopicIdArray:"topicIDList",MsgVersion:"messageVersion",C2cMsgModNotifys:"c2cMessageModified",GroupMsgModNotifys:"groupMessageModified",ApplyJoinOption:"joinOption",MsgFlag:"messageRemindType",AtInfoList:"groupAtInfoList",AtFlagList:"groupAtType",AtMsgSeq:"sequence",BanDuration:"duration",BanDescription:"reason",NotVisible:"invisible",BytesTag:"tag",BytesValue:"value",RptBytesValue:"value",LatestSeq:"globalSequence",ClearSeq:"clearSequence",SupportMessageExtension:"isSupportExtension",ExtensionList:"extensions",GroupCounter:"counterList",Revoker_Account:"revoker"},ignoreKeyWord:["C2C","ID","USP"]},ck=bt.PROPER,lk=yn.trim;function dk(e,t){if("string"!=typeof e&&!Array.isArray(e))throw new TypeError("Expected the input to be `string | string[]`");var n;return t=Object.assign({pascalCase:!1},t),0===(e=Array.isArray(e)?e.map((function(e){return e.trim()})).filter((function(e){return e.length})).join("-"):e.trim()).length?"":1===e.length?t.pascalCase?e.toUpperCase():e.toLowerCase():(e!==e.toLowerCase()&&(e=pk(e)),e=e.replace(/^[_.\- ]+/,"").toLowerCase().replace(/[_.\- ]+(\w|$)/g,(function(e,t){return t.toUpperCase()})).replace(/\d+(\w|$)/g,(function(e){return e.toUpperCase()})),n=e,t.pascalCase?n.charAt(0).toUpperCase()+n.slice(1):n)}on({target:"String",proto:!0,forced:(nk="trim",w((function(){return!!fn[nk]()||"\u200b\x85\u180e"!=="\u200b\x85\u180e"[nk]()||ck&&fn[nk].name!==nk})))},{trim:function(){return lk(this)}});var pk=function(e){for(var t=!1,n=!1,o=!1,r=0;r<e.length;r++){var i=e[r];t&&/[a-zA-Z]/.test(i)&&i.toUpperCase()===i?(e=e.slice(0,r)+"-"+e.slice(r),t=!1,o=n,n=!0,r++):n&&o&&/[a-zA-Z]/.test(i)&&i.toLowerCase()===i?(e=e.slice(0,r-1)+"-"+e.slice(r-1),o=n,n=!1,t=!0):(t=i.toLowerCase()===i&&i.toUpperCase()!==i,o=n,n=i.toUpperCase()===i&&i.toLowerCase()!==i)}return e};function fk(e,t){var n=0;return function e(t,o){if(++n>100)return n--,t;if($l(t)){var r=t.map((function(t){return Jl(t)?e(t,o):t}));return n--,r}if(Jl(t)){var i=(a=t,s=function(e,t){if(!rd(t))return!1;if((r=t)!==dk(r))for(var n=0;n<uk.ignoreKeyWord.length&&!t.includes(uk.ignoreKeyWord[n]);n++);var r;return Ql(o[t])?function(e){return"OPPOChannelID"===e?e:e[0].toUpperCase()+dk(e).slice(1)}(t):o[t]},u=Object.create(null),Object.keys(a).forEach((function(e){var t=s(a[e],e);t&&(u[t]=a[e])})),u);return i=Sd(i,(function(t,n){return $l(t)||Jl(t)?e(t,o):t})),n--,i}var a,s,u}(e,t)}function hk(e,t){if($l(e))return e.map((function(e){return Jl(e)?hk(e,t):e}));if(Jl(e)){var n=(o=e,r=function(e,n){return Ql(t[n])?dk(n):t[n]},i={},Object.keys(o).forEach((function(e){i[r(o[e],e)]=o[e]})),i);return Sd(n,(function(e){return $l(e)||Jl(e)?hk(e,t):e}))}var o,r,i}var gk="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof DataView,vk=R.RangeError,mk=function(e){if(void 0===e)return 0;var t=Lt(e),n=Pt(t);if(t!==n)throw vk("Wrong length or index");return n},_k=R.Array,yk=Math.abs,Mk=Math.pow,Ik=Math.floor,Ck=Math.log,kk=Math.LN2,Tk=function(e,t,n){var o,r,i,a=_k(n),s=8*n-t-1,u=(1<<s)-1,c=u>>1,l=23===t?Mk(2,-24)-Mk(2,-77):0,d=e<0||0===e&&1/e<0?1:0,p=0;for((e=yk(e))!=e||1/0===e?(r=e!=e?1:0,o=u):(o=Ik(Ck(e)/kk),e*(i=Mk(2,-o))<1&&(o--,i*=2),(e+=o+c>=1?l/i:l*Mk(2,1-c))*i>=2&&(o++,i/=2),o+c>=u?(r=0,o=u):o+c>=1?(r=(e*i-1)*Mk(2,t),o+=c):(r=e*Mk(2,c-1)*Mk(2,t),o=0));t>=8;)a[p++]=255&r,r/=256,t-=8;for(o=o<<t|r,s+=t;s>0;)a[p++]=255&o,o/=256,s-=8;return a[--p]|=128*d,a},Sk=function(e,t){var n,o=e.length,r=8*o-t-1,i=(1<<r)-1,a=i>>1,s=r-7,u=o-1,c=e[u--],l=127&c;for(c>>=7;s>0;)l=256*l+e[u--],s-=8;for(n=l&(1<<-s)-1,l>>=-s,s+=t;s>0;)n=256*n+e[u--],s-=8;if(0===l)l=1-a;else{if(l===i)return n?NaN:c?-1/0:1/0;n+=Mk(2,t),l-=a}return(c?-1:1)*n*Mk(2,l-t)},bk=function(e){for(var t=De(this),n=Gt(t),o=arguments.length,r=Ot(o>1?arguments[1]:void 0,n),i=o>2?arguments[2]:void 0,a=void 0===i?n:Ot(i,n);a>r;)t[r++]=e;return t},Dk=Kt.f,Ek=ot.f,Ak=bt.PROPER,Lk=bt.CONFIGURABLE,Rk=Ct.get,wk=Ct.set,Ok=R.ArrayBuffer,Nk=Ok,Pk=Nk&&Nk.prototype,Gk=R.DataView,Uk=Gk&&Gk.prototype,xk=Object.prototype,Fk=R.Array,qk=R.RangeError,Bk=j(bk),Vk=j([].reverse),Hk=Tk,Kk=Sk,jk=function(e){return[255&e]},zk=function(e){return[255&e,e>>8&255]},Zk=function(e){return[255&e,e>>8&255,e>>16&255,e>>24&255]},Wk=function(e){return e[3]<<24|e[2]<<16|e[1]<<8|e[0]},Yk=function(e){return Hk(e,23,4)},Jk=function(e){return Hk(e,52,8)},Xk=function(e,t){Ek(e.prototype,t,{get:function(){return Rk(this)[t]}})},$k=function(e,t,n,o){var r=mk(n),i=Rk(e);if(r+t>i.byteLength)throw qk("Wrong index");var a=Rk(i.buffer).bytes,s=r+i.byteOffset,u=us(a,s,s+t);return o?u:Vk(u)},Qk=function(e,t,n,o,r,i){var a=mk(n),s=Rk(e);if(a+t>s.byteLength)throw qk("Wrong index");for(var u=Rk(s.buffer).bytes,c=a+s.byteOffset,l=o(+r),d=0;d<t;d++)u[c+d]=l[i?d:t-d-1]};if(gk){var eT=Ak&&"ArrayBuffer"!==Ok.name;if(w((function(){Ok(1)}))&&w((function(){new Ok(-1)}))&&!w((function(){return new Ok,new Ok(1.5),new Ok(NaN),eT&&!Lk})))eT&&Lk&&rt(Ok,"name","ArrayBuffer");else{(Nk=function(e){return ws(this,Pk),new Ok(mk(e))}).prototype=Pk;for(var tT,nT=Dk(Ok),oT=0;nT.length>oT;)(tT=nT[oT++])in Nk||rt(Nk,tT,Ok[tT]);Pk.constructor=Nk}cr&&Xo(Uk)!==xk&&cr(Uk,xk);var rT=new Gk(new Nk(2)),iT=j(Uk.setInt8);rT.setInt8(0,2147483648),rT.setInt8(1,2147483649),!rT.getInt8(0)&&rT.getInt8(1)||Es(Uk,{setInt8:function(e,t){iT(this,e,t<<24>>24)},setUint8:function(e,t){iT(this,e,t<<24>>24)}},{unsafe:!0})}else Pk=(Nk=function(e){ws(this,Pk);var t=mk(e);wk(this,{bytes:Bk(Fk(t),0),byteLength:t}),O||(this.byteLength=t)}).prototype,Uk=(Gk=function(e,t,n){ws(this,Uk),ws(e,Pk);var o=Rk(e).byteLength,r=Lt(t);if(r<0||r>o)throw qk("Wrong offset");if(r+(n=void 0===n?o-r:Pt(n))>o)throw qk("Wrong length");wk(this,{buffer:e,byteLength:n,byteOffset:r}),O||(this.buffer=e,this.byteLength=n,this.byteOffset=r)}).prototype,O&&(Xk(Nk,"byteLength"),Xk(Gk,"buffer"),Xk(Gk,"byteLength"),Xk(Gk,"byteOffset")),Es(Uk,{getInt8:function(e){return $k(this,1,e)[0]<<24>>24},getUint8:function(e){return $k(this,1,e)[0]},getInt16:function(e){var t=$k(this,2,e,arguments.length>1?arguments[1]:void 0);return(t[1]<<8|t[0])<<16>>16},getUint16:function(e){var t=$k(this,2,e,arguments.length>1?arguments[1]:void 0);return t[1]<<8|t[0]},getInt32:function(e){return Wk($k(this,4,e,arguments.length>1?arguments[1]:void 0))},getUint32:function(e){return Wk($k(this,4,e,arguments.length>1?arguments[1]:void 0))>>>0},getFloat32:function(e){return Kk($k(this,4,e,arguments.length>1?arguments[1]:void 0),23)},getFloat64:function(e){return Kk($k(this,8,e,arguments.length>1?arguments[1]:void 0),52)},setInt8:function(e,t){Qk(this,1,e,jk,t)},setUint8:function(e,t){Qk(this,1,e,jk,t)},setInt16:function(e,t){Qk(this,2,e,zk,t,arguments.length>2?arguments[2]:void 0)},setUint16:function(e,t){Qk(this,2,e,zk,t,arguments.length>2?arguments[2]:void 0)},setInt32:function(e,t){Qk(this,4,e,Zk,t,arguments.length>2?arguments[2]:void 0)},setUint32:function(e,t){Qk(this,4,e,Zk,t,arguments.length>2?arguments[2]:void 0)},setFloat32:function(e,t){Qk(this,4,e,Yk,t,arguments.length>2?arguments[2]:void 0)},setFloat64:function(e,t){Qk(this,8,e,Jk,t,arguments.length>2?arguments[2]:void 0)}});or(Nk,"ArrayBuffer"),or(Gk,"DataView");var aT={ArrayBuffer:Nk,DataView:Gk},sT=aT.ArrayBuffer,uT=aT.DataView,cT=uT.prototype,lT=j(sT.prototype.slice),dT=j(cT.getUint8),pT=j(cT.setUint8),fT=w((function(){return!new sT(2).slice(1,void 0).byteLength}));on({target:"ArrayBuffer",proto:!0,unsafe:!0,forced:fT},{slice:function(e,t){if(lT&&void 0===t)return lT($e(this),e);for(var n=$e(this).byteLength,o=Ot(e,n),r=Ot(void 0===t?n:t,n),i=new(qs(this,sT))(Pt(r-o)),a=new uT(this),s=new uT(i),u=0;o<r;)pT(s,u++,dT(a,o++));return i}});var hT,gT,vT,mT=ot.f,_T=R.Int8Array,yT=_T&&_T.prototype,MT=R.Uint8ClampedArray,IT=MT&&MT.prototype,CT=_T&&Xo(_T),kT=yT&&Xo(yT),TT=Object.prototype,ST=R.TypeError,bT=xe("toStringTag"),DT=Oe("TYPED_ARRAY_TAG"),ET=Oe("TYPED_ARRAY_CONSTRUCTOR"),AT=gk&&!!cr&&"Opera"!==ln(R.opera),LT=!1,RT={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8},wT={BigInt64Array:8,BigUint64Array:8},OT=function(e){if(!ne(e))return!1;var t=ln(e);return Ae(RT,t)||Ae(wT,t)};for(hT in RT)(vT=(gT=R[hT])&&gT.prototype)?rt(vT,ET,gT):AT=!1;for(hT in wT)(vT=(gT=R[hT])&&gT.prototype)&&rt(vT,ET,gT);if((!AT||!te(CT)||CT===Function.prototype)&&(CT=function(){throw ST("Incorrect invocation")},AT))for(hT in RT)R[hT]&&cr(R[hT],CT);if((!AT||!kT||kT===TT)&&(kT=CT.prototype,AT))for(hT in RT)R[hT]&&cr(R[hT].prototype,kT);if(AT&&Xo(IT)!==kT&&cr(IT,kT),O&&!Ae(kT,bT))for(hT in LT=!0,mT(kT,bT,{get:function(){return ne(this)?this[DT]:void 0}}),RT)R[hT]&&rt(R[hT],DT,hT);var NT={NATIVE_ARRAY_BUFFER_VIEWS:AT,TYPED_ARRAY_CONSTRUCTOR:ET,TYPED_ARRAY_TAG:LT&&DT,aTypedArray:function(e){if(OT(e))return e;throw ST("Target is not a typed array")},aTypedArrayConstructor:function(e){if(te(e)&&(!cr||ie(CT,e)))return e;throw ST(me(e)+" is not a typed array constructor")},exportTypedArrayMethod:function(e,t,n,o){if(O){if(n)for(var r in RT){var i=R[r];if(i&&Ae(i.prototype,e))try{delete i.prototype[e]}catch(yD){try{i.prototype[e]=t}catch(s){}}}kT[e]&&!n||Dt(kT,e,n?t:AT&&yT[e]||t,o)}},exportTypedArrayStaticMethod:function(e,t,n){var o,r;if(O){if(cr){if(n)for(o in RT)if((r=R[o])&&Ae(r,e))try{delete r[e]}catch(yD){}if(CT[e]&&!n)return;try{return Dt(CT,e,n?t:AT&&CT[e]||t)}catch(yD){}}for(o in RT)!(r=R[o])||r[e]&&!n||Dt(r,e,t)}},isView:function(e){if(!ne(e))return!1;var t=ln(e);return"DataView"===t||Ae(RT,t)||Ae(wT,t)},isTypedArray:OT,TypedArray:CT,TypedArrayPrototype:kT},PT=NT.NATIVE_ARRAY_BUFFER_VIEWS,GT=R.ArrayBuffer,UT=R.Int8Array,xT=!PT||!w((function(){UT(1)}))||!w((function(){new UT(-1)}))||!Uo((function(e){new UT,new UT(null),new UT(1.5),new UT(e)}),!0)||w((function(){return 1!==new UT(new GT(2),1,void 0).length})),FT=Math.floor,qT=Number.isInteger||function(e){return!ne(e)&&isFinite(e)&&FT(e)===e},BT=R.RangeError,VT=R.RangeError,HT=function(e,t){var n=function(e){var t=Lt(e);if(t<0)throw BT("The argument can't be less than 0");return t}(e);if(n%t)throw VT("Wrong offset");return n},KT=NT.aTypedArrayConstructor,jT=function(e){var t,n,o,r,i,a,s=xs(this),u=De(e),c=arguments.length,l=c>1?arguments[1]:void 0,d=void 0!==l,p=Eo(u);if(p&&!So(p))for(a=(i=Lo(u,p)).next,u=[];!(r=G(a,i)).done;)u.push(r.value);for(d&&c>2&&(l=jn(l,arguments[2])),n=Gt(u),o=new(KT(s))(n),t=0;n>t;t++)o[t]=d?l(u[t],t):u[t];return o};D((function(e){var t=Kt.f,n=so.forEach,o=Ct.get,r=Ct.set,i=ot.f,a=We.f,s=Math.round,u=R.RangeError,c=aT.ArrayBuffer,l=c.prototype,d=aT.DataView,p=NT.NATIVE_ARRAY_BUFFER_VIEWS,f=NT.TYPED_ARRAY_CONSTRUCTOR,h=NT.TYPED_ARRAY_TAG,g=NT.TypedArray,v=NT.TypedArrayPrototype,m=NT.aTypedArrayConstructor,_=NT.isTypedArray,y=function(e,t){m(e);for(var n=0,o=t.length,r=new e(o);o>n;)r[n]=t[n++];return r},M=function(e,t){i(e,t,{get:function(){return o(this)[t]}})},I=function(e){var t;return ie(l,e)||"ArrayBuffer"==(t=ln(e))||"SharedArrayBuffer"==t},C=function(e,t){return _(e)&&!ge(t)&&t in e&&qT(+t)&&t>=0},k=function(e,t){return t=Ve(t),C(e,t)?q(2,e[t]):a(e,t)},T=function(e,t,n){return t=Ve(t),!(C(e,t)&&ne(n)&&Ae(n,"value"))||Ae(n,"get")||Ae(n,"set")||n.configurable||Ae(n,"writable")&&!n.writable||Ae(n,"enumerable")&&!n.enumerable?i(e,t,n):(e[t]=n.value,e)};O?(p||(We.f=k,ot.f=T,M(v,"buffer"),M(v,"byteOffset"),M(v,"byteLength"),M(v,"length")),on({target:"Object",stat:!0,forced:!p},{getOwnPropertyDescriptor:k,defineProperty:T}),e.exports=function(e,a,l){var m=e.match(/\d+$/)[0]/8,M=e+(l?"Clamped":"")+"Array",C="get"+e,k="set"+e,T=R[M],S=T,b=S&&S.prototype,D={},E=function(e,t){i(e,t,{get:function(){return function(e,t){var n=o(e);return n.view[C](t*m+n.byteOffset,!0)}(this,t)},set:function(e){return function(e,t,n){var r=o(e);l&&(n=(n=s(n))<0?0:n>255?255:255&n),r.view[k](t*m+r.byteOffset,n,!0)}(this,t,e)},enumerable:!0})};p?xT&&(S=a((function(e,t,n,o){return ws(e,b),xr(ne(t)?I(t)?void 0!==o?new T(t,HT(n,m),o):void 0!==n?new T(t,HT(n,m)):new T(t):_(t)?y(S,t):G(jT,S,t):new T(mk(t)),e,S)})),cr&&cr(S,g),n(t(T),(function(e){e in S||rt(S,e,T[e])})),S.prototype=b):(S=a((function(e,t,n,o){ws(e,b);var i,a,s,l=0,p=0;if(ne(t)){if(!I(t))return _(t)?y(S,t):G(jT,S,t);i=t,p=HT(n,m);var f=t.byteLength;if(void 0===o){if(f%m)throw u("Wrong length");if((a=f-p)<0)throw u("Wrong length")}else if((a=Pt(o)*m)+p>f)throw u("Wrong length");s=a/m}else s=mk(t),i=new c(a=s*m);for(r(e,{buffer:i,byteOffset:p,byteLength:a,length:s,view:new d(i)});l<s;)E(e,l++)})),cr&&cr(S,g),b=S.prototype=Hn(v)),b.constructor!==S&&rt(b,"constructor",S),rt(b,f,S),h&&rt(b,h,M),D[M]=S,on({global:!0,forced:S!=T,sham:!p},D),"BYTES_PER_ELEMENT"in S||rt(S,"BYTES_PER_ELEMENT",m),"BYTES_PER_ELEMENT"in b||rt(b,"BYTES_PER_ELEMENT",m),Ls(M)}):e.exports=function(){}}))("Uint8",(function(e){return function(t,n,o){return e(this,t,n,o)}}));var zT=Math.min,ZT=j([].copyWithin||function(e,t){var n=De(this),o=Gt(n),r=Ot(e,o),i=Ot(t,o),a=arguments.length>2?arguments[2]:void 0,s=zT((void 0===a?o:Ot(a,o))-i,o-r),u=1;for(i<r&&r<i+s&&(u=-1,i+=s-1,r+=s-1);s-- >0;)i in n?n[r]=n[i]:delete n[r],r+=u,i+=u;return n}),WT=NT.aTypedArray;(0,NT.exportTypedArrayMethod)("copyWithin",(function(e,t){return ZT(WT(this),e,t,arguments.length>2?arguments[2]:void 0)}));var YT=so.every,JT=NT.aTypedArray;(0,NT.exportTypedArrayMethod)("every",(function(e){return YT(JT(this),e,arguments.length>1?arguments[1]:void 0)}));var XT=NT.aTypedArray;(0,NT.exportTypedArrayMethod)("fill",(function(e){var t=arguments.length;return G(bk,XT(this),e,t>1?arguments[1]:void 0,t>2?arguments[2]:void 0)}));var $T=NT.TYPED_ARRAY_CONSTRUCTOR,QT=NT.aTypedArrayConstructor,eS=function(e){return QT(qs(e,e[$T]))},tS=function(e,t){return function(e,t){for(var n=0,o=Gt(t),r=new e(o);o>n;)r[n]=t[n++];return r}(eS(e),t)},nS=so.filter,oS=NT.aTypedArray;(0,NT.exportTypedArrayMethod)("filter",(function(e){var t=nS(oS(this),e,arguments.length>1?arguments[1]:void 0);return tS(this,t)}));var rS=so.find,iS=NT.aTypedArray;(0,NT.exportTypedArrayMethod)("find",(function(e){return rS(iS(this),e,arguments.length>1?arguments[1]:void 0)}));var aS=so.findIndex,sS=NT.aTypedArray;(0,NT.exportTypedArrayMethod)("findIndex",(function(e){return aS(sS(this),e,arguments.length>1?arguments[1]:void 0)}));var uS=so.forEach,cS=NT.aTypedArray;(0,NT.exportTypedArrayMethod)("forEach",(function(e){uS(cS(this),e,arguments.length>1?arguments[1]:void 0)}));var lS=xt.includes,dS=NT.aTypedArray;(0,NT.exportTypedArrayMethod)("includes",(function(e){return lS(dS(this),e,arguments.length>1?arguments[1]:void 0)}));var pS=xt.indexOf,fS=NT.aTypedArray;(0,NT.exportTypedArrayMethod)("indexOf",(function(e){return pS(fS(this),e,arguments.length>1?arguments[1]:void 0)}));var hS=xe("iterator"),gS=R.Uint8Array,vS=j(Va.values),mS=j(Va.keys),_S=j(Va.entries),yS=NT.aTypedArray,MS=NT.exportTypedArrayMethod,IS=gS&&gS.prototype,CS=!w((function(){IS[hS].call([1])})),kS=!!IS&&IS.values&&IS[hS]===IS.values&&"values"===IS.values.name,TS=function(){return vS(yS(this))};MS("entries",(function(){return _S(yS(this))}),CS),MS("keys",(function(){return mS(yS(this))}),CS),MS("values",TS,CS||!kS,{name:"values"}),MS(hS,TS,CS||!kS,{name:"values"});var SS=NT.aTypedArray,bS=NT.exportTypedArrayMethod,DS=j([].join);bS("join",(function(e){return DS(SS(this),e)}));var ES=NT.aTypedArray;(0,NT.exportTypedArrayMethod)("lastIndexOf",(function(e){var t=arguments.length;return Ca(nI,ES(this),t>1?[e,arguments[1]]:[e])}));var AS=so.map,LS=NT.aTypedArray;(0,NT.exportTypedArrayMethod)("map",(function(e){return AS(LS(this),e,arguments.length>1?arguments[1]:void 0,(function(e,t){return new(eS(e))(t)}))}));var RS=R.TypeError,wS=function(e){return function(t,n,o,r){ye(n);var i=De(t),a=X(i),s=Gt(i),u=e?s-1:0,c=e?-1:1;if(o<2)for(;;){if(u in a){r=a[u],u+=c;break}if(u+=c,e?u<0:s<=u)throw RS("Reduce of empty array with no initial value")}for(;e?u>=0:s>u;u+=c)u in a&&(r=n(r,a[u],u,i));return r}},OS={left:wS(!1),right:wS(!0)},NS=OS.left,PS=NT.aTypedArray;(0,NT.exportTypedArrayMethod)("reduce",(function(e){var t=arguments.length;return NS(PS(this),e,t,t>1?arguments[1]:void 0)}));var GS=OS.right,US=NT.aTypedArray;(0,NT.exportTypedArrayMethod)("reduceRight",(function(e){var t=arguments.length;return GS(US(this),e,t,t>1?arguments[1]:void 0)}));var xS=NT.aTypedArray,FS=NT.exportTypedArrayMethod,qS=Math.floor;FS("reverse",(function(){for(var e,t=xS(this).length,n=qS(t/2),o=0;o<n;)e=this[o],this[o++]=this[--t],this[t]=e;return this}));var BS=R.RangeError,VS=R.Int8Array,HS=VS&&VS.prototype,KS=HS&&HS.set,jS=NT.aTypedArray,zS=NT.exportTypedArrayMethod,ZS=!w((function(){var e=new Uint8ClampedArray(2);return G(KS,e,{length:1,0:3},1),3!==e[1]})),WS=ZS&&NT.NATIVE_ARRAY_BUFFER_VIEWS&&w((function(){var e=new VS(2);return e.set(1),e.set("2",1),0!==e[0]||2!==e[1]}));zS("set",(function(e){jS(this);var t=HT(arguments.length>1?arguments[1]:void 0,1),n=De(e);if(ZS)return G(KS,this,n,t);var o=this.length,r=Gt(n),i=0;if(r+t>o)throw BS("Wrong length");for(;i<r;)this[t+i]=n[i++]}),!ZS||WS);var YS=NT.aTypedArray;(0,NT.exportTypedArrayMethod)("slice",(function(e,t){for(var n=Dn(YS(this),e,t),o=eS(this),r=0,i=n.length,a=new o(i);i>r;)a[r]=n[r++];return a}),w((function(){new Int8Array(1).slice()})));var JS=so.some,XS=NT.aTypedArray;(0,NT.exportTypedArrayMethod)("some",(function(e){return JS(XS(this),e,arguments.length>1?arguments[1]:void 0)}));var $S=R.Array,QS=NT.aTypedArray,eb=NT.exportTypedArrayMethod,tb=R.Uint16Array,nb=tb&&j(tb.prototype.sort),ob=!(!nb||w((function(){nb(new tb(2),null)}))&&w((function(){nb(new tb(2),{})}))),rb=!!nb&&!w((function(){if(de)return de<74;if(yI)return yI<67;if(MI)return!0;if(CI)return CI<602;var e,t,n=new tb(516),o=$S(516);for(e=0;e<516;e++)t=e%4,n[e]=515-e,o[e]=e-2*t+3;for(nb(n,(function(e,t){return(e/4|0)-(t/4|0)})),e=0;e<516;e++)if(n[e]!==o[e])return!0}));eb("sort",(function(e){return void 0!==e&&ye(e),rb?nb(this,e):q_(QS(this),function(e){return function(t,n){return void 0!==e?+e(t,n)||0:n!=n?-1:t!=t?1:0===t&&0===n?1/t>0&&1/n<0?1:-1:t>n}}(e))}),!rb||ob);var ib=NT.aTypedArray;(0,NT.exportTypedArrayMethod)("subarray",(function(e,t){var n=ib(this),o=n.length,r=Ot(e,o);return new(eS(n))(n.buffer,n.byteOffset+r*n.BYTES_PER_ELEMENT,Pt((void 0===t?o:Ot(t,o))-r))}));var ab=R.Int8Array,sb=NT.aTypedArray,ub=NT.exportTypedArrayMethod,cb=[].toLocaleString,lb=!!ab&&w((function(){cb.call(new ab(1))}));ub("toLocaleString",(function(){return Ca(cb,lb?Dn(sb(this)):sb(this),Dn(arguments))}),w((function(){return[1,2].toLocaleString()!=new ab([1,2]).toLocaleString()}))||!w((function(){ab.prototype.toLocaleString.call([1,2])})));var db=NT.exportTypedArrayMethod,pb=R.Uint8Array,fb=pb&&pb.prototype||{},hb=[].toString,gb=j([].join);w((function(){hb.call({})}))&&(hb=function(){return gb(this)});var vb=fb.toString!=hb;db("toString",hb,vb);var mb=R.RangeError,_b=String.fromCharCode,yb=String.fromCodePoint,Mb=j([].join),Ib=!!yb&&1!=yb.length;on({target:"String",stat:!0,forced:Ib},{fromCodePoint:function(e){for(var t,n=[],o=arguments.length,r=0;o>r;){if(t=+arguments[r++],Ot(t,1114111)!==t)throw mb(t+" is not a valid code point");n[r]=t<65536?_b(t):_b(55296+((t-=65536)>>10),t%1024+56320)}return Mb(n,"")}});var Cb=String.fromCharCode,kb=function(e){var t=0|e.charCodeAt(0);if(55296<=t)if(t<56320){var n=0|e.charCodeAt(1);if(56320<=n&&n<=57343){if((t=(t<<10)+n-56613888|0)>65535)return Cb(240|t>>>18,128|t>>>12&63,128|t>>>6&63,128|63&t)}else t=65533}else t<=57343&&(t=65533);return t<=2047?Cb(192|t>>>6,128|63&t):Cb(224|t>>>12,128|t>>>6&63,128|63&t)},Tb=function(e){for(var t=void 0===e?"":(""+e).replace(/[\x80-\uD7ff\uDC00-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]?/g,kb),n=0|t.length,o=new Uint8Array(n),r=0;r<n;r=r+1|0)o[r]=0|t.charCodeAt(r);return o},Sb=function(e){for(var t=new Uint8Array(e),n="",o=0,r=t.length;o<r;){var i=t[o],a=0,s=0;if(i<=127?(a=0,s=255&i):i<=223?(a=1,s=31&i):i<=239?(a=2,s=15&i):i<=244&&(a=3,s=7&i),r-o-a>0)for(var u=0;u<a;)s=s<<6|63&(i=t[o+u+1]),u+=1;else s=65533,a=r-o;n+=String.fromCodePoint(s),o+=a+1}return n},bb=function(){function e(t){r(this,e),this._handler=t;var n=t.getURL();if(this._socket=null,this._workerSocket=null,this._id=ld(),this._handler.getIsWorkerEnabled()){var o=URL.createObjectURL(new Blob([';let _socket = null;onmessage = function(event) {  if (event.data.cmd === "start") {    const url = event.data.url;    _socket = new WebSocket(url);    _socket.binaryType = "arraybuffer";    _socket.onopen = function() {      postMessage({ callback: "onOpen" });    };    _socket.onclose = function(e) {      postMessage({ callback: "onOpen", e: { code: e.code, reason: e.reason } });    };    _socket.onmessage = function(e) {      postMessage({ callback: "onMessage", data: e.data });    };    _socket.onerror = function(e) {      postMessage({ callback: "onError", e: { isTrusted: "true" } });    };  } else if (event.data.cmd === "sendMessage") {    if (_socket !== null) {      _socket.send(event.data.data);    }  } else if (event.data.cmd === "stop") {    if (_socket !== null) {      _socket.close(event.data.code);      _socket = null;    }  }};'],{type:"application/javascript; charset=utf-8"}));this._workerSocket=new Worker(o);var i=this;this._workerSocket.onmessage=function(e){var t=e.data,n=t.callback,o=t.e;"onOpen"===n?i._onOpen():"onClose"===n?i._onClose(o):"onError"===n?i._onError(o):"onMessage"===n&&i._onMessage(e.data)},this._workerSocket.postMessage({cmd:"start",id:this._id,url:n})}else tl?$c?(ol.connectSocket({url:n,header:{"content-type":"application/json"}}),ol.onSocketClose(this._onClose.bind(this)),ol.onSocketOpen(this._onOpen.bind(this)),ol.onSocketMessage(this._onMessage.bind(this)),ol.onSocketError(this._onError.bind(this))):(this._socket=ol.connectSocket({url:n,header:{"content-type":"application/json"},complete:function(){}}),this._socket.onClose(this._onClose.bind(this)),this._socket.onOpen(this._onOpen.bind(this)),this._socket.onMessage(this._onMessage.bind(this)),this._socket.onError(this._onError.bind(this))):nl&&(this._socket=new WebSocket(n),this._socket.binaryType="arraybuffer",this._socket.onopen=this._onOpen.bind(this),this._socket.onmessage=this._onMessage.bind(this),this._socket.onclose=this._onClose.bind(this),this._socket.onerror=this._onError.bind(this));this._canIUseBinaryFrame=t.canIUseBinaryFrame()}return a(e,[{key:"getID",value:function(){return this._id}},{key:"_onOpen",value:function(){this._handler.onOpen({id:this._id})}},{key:"_onClose",value:function(e){this._handler.onClose({id:this._id,e:e})}},{key:"_onMessage",value:function(e){this._handler.onMessage({data:this._canIUseBinaryFrame?Sb(e.data):e.data})}},{key:"_onError",value:function(e){this._handler.onError({id:this._id,e:e})}},{key:"setIsWorkerEnabled",value:function(e){this._isWorkerEnabled=!0}},{key:"close",value:function(e){if(this._workerSocket&&(this._workerSocket.postMessage({cmd:"stop",code:e}),this._workerSocket.terminate(),this._workerSocket=null),$c)return ol.offSocketClose(),ol.offSocketMessage(),ol.offSocketOpen(),ol.offSocketError(),void ol.closeSocket();this._socket&&(tl?(this._socket.onClose((function(){})),this._socket.onOpen((function(){})),this._socket.onMessage((function(){})),this._socket.onError((function(){}))):nl&&(this._socket.onopen=null,this._socket.onmessage=null,this._socket.onclose=null,this._socket.onerror=null),Xc?this._socket.close({code:e}):this._socket.close(e),this._socket=null)}},{key:"send",value:function(e){if(this._workerSocket)this._workerSocket.postMessage({cmd:"sendMessage",data:this._canIUseBinaryFrame?Tb(e.data).buffer:e.data});else{if($c)return void ol.sendSocketMessage({data:e.data,fail:function(){e.fail&&e.requestID&&e.fail(e.requestID)}});this._socket&&(tl?this._socket.send({data:this._canIUseBinaryFrame?Tb(e.data).buffer:e.data,fail:function(){e.fail&&e.requestID&&e.fail(e.requestID)}}):nl&&this._socket.send(this._canIUseBinaryFrame?Tb(e.data).buffer:e.data))}}}]),e}(),Db=4e3,Eb=4001,Ab=["keyMap"],Lb=["keyMap"],Rb="connected",wb="connecting",Ob="disconnected",Nb=function(){function e(t){r(this,e),this._channelModule=t,this._n="SocketHandler",this._promiseMap=new Map,this._readyState=Ob,this._simpleRequestMap=new Map,this.MAX_SIZE=100,this._startSequence=ld(),this._startTs=0,this._reConnectFlag=!1,this._nextPingTs=0,this._reConnectCount=0,this.MAX_RECONNECT_COUNT=3,this._socketID=-1,this._random=0,this._socket=null,this._url="",this._onOpenTs=0,this._canIUseBinaryFrame=!0,this._isWorkerEnabled=!0,this._setWebsocketHost(),this._initConnection()}return a(e,[{key:"_setWebsocketHost",value:function(){var e=this._channelModule.getModule(Hf),t=Ec;this._channelModule.isOversea()&&(t=Ac),e.isSingaporeSite()?t=Lc:e.isKoreaSite()?t=Rc:e.isGermanySite()?t=wc:e.isIndiaSite()?t=Oc:e.isJapanSite()?t=Nc:e.isUSASite()&&(t=Pc),Gc.HOST.setCurrent(t)}},{key:"_initConnection",value:function(){Ql(Gc.HOST.CURRENT.BACKUP)||""===this._url?this._url=Gc.HOST.CURRENT.DEFAULT:this._url===Gc.HOST.CURRENT.DEFAULT?this._url=Gc.HOST.CURRENT.BACKUP:this._url===Gc.HOST.CURRENT.BACKUP&&(this._url=Gc.HOST.CURRENT.DEFAULT);var e=this._channelModule.getModule(Hf).getProxyServer();Hd(e)||(this._url=e),this._connect(),this._nextPingTs=0}},{key:"onCheckTimer",value:function(e){e%1==0&&this._checkPromiseMap()}},{key:"_checkPromiseMap",value:function(){var e=this;0!==this._promiseMap.size&&this._promiseMap.forEach((function(t,n){var o=t.reject,r=t.timestamp,i=15e3;-1!==n.indexOf(dh)&&(i=9e4),Date.now()-r>=i&&(Pl.l("".concat(e._n,"._checkPromiseMap request timeout, delete requestID:").concat(n)),e._promiseMap.delete(n),o(new pI({code:Sm})),e._channelModule.onRequestTimeout(n))}))}},{key:"onOpen",value:function(e){if(""!==this._readyState){this._onOpenTs=Date.now();var t=e.id;this._socketID=t;var n=Date.now()-this._startTs;Pl.l("".concat(this._n,"._onOpen cost ").concat(n," ms. socketID:").concat(t)),new s_("wsOnOpen").setMessage(n).setCostTime(n).setMoreMessage("socketID:".concat(t)).end(),e.id===this._socketID&&(this._readyState=Rb,this._reConnectCount=0,this._resend(),!0===this._reConnectFlag&&(this._channelModule.onReconnected(),this._reConnectFlag=!1),this._channelModule.onOpen())}}},{key:"onClose",value:function(e){var t=new s_("wsOnClose"),n=e.id,o=e.e,r="sourceSocketID:".concat(n," currentSocketID:").concat(this._socketID," code:").concat(o.code," reason:").concat(o.reason),i=0;0!==this._onOpenTs&&(i=Date.now()-this._onOpenTs),t.setMessage(i).setCostTime(i).setMoreMessage(r).setCode(o.code).end(),Pl.l("".concat(this._n,"._onClose ").concat(r," onlineTime:").concat(i)),n===this._socketID&&(this._readyState=Ob,i<1e3?this._channelModule.onReconnectFailed():this._channelModule.onClose())}},{key:"onError",value:function(e){var t=e.id,n=e.e,o="sourceSocketID:".concat(t," currentSocketID:").concat(this._socketID);new s_("wsOnError").setMessage(n.errMsg||ud(n)).setMoreMessage(o).setLevel("error").end(),Pl.w("".concat(this._n,"._onError"),n,o),t===this._socketID&&(this._readyState="",this._channelModule.onError())}},{key:"onMessage",value:function(e){var t;try{t=JSON.parse(e.data)}catch(yD){new s_("jsonParseError").setMessage(e.data).end()}if(t&&t.head){var n=this._getRequestIDFromHead(t.head),o=t.body;if(!n.startsWith(Gc.NAME.TUIROOM_SVR)){var r=wd(t.head);o=hk(t.body,this._getResponseKeyMap(r))}if(Pl.d("".concat(this._n,".onMessage ret:").concat(JSON.stringify(o)," requestID:").concat(n," has:").concat(this._promiseMap.has(n))),this._setNextPingTs(),this._promiseMap.has(n)){var i=this._promiseMap.get(n),a=i.resolve,s=i.reject,u=i.timestamp;return this._promiseMap.delete(n),this._calcRTT(u),void(o.errorCode&&0!==o.errorCode?(this._channelModule.onErrorCodeNotZero(o),s(new pI({code:o.errorCode,message:o.errorInfo||"",data:n.includes(Rh)||n.includes(Mg)?{elements:o.elements,messageVersion:o.messageVersion,cloudCustomData:o.cloudCustomData}:void 0}))):a(dI(o)))}this._channelModule.onMessage({head:t.head,body:o})}}},{key:"_calcRTT",value:function(e){var t=Date.now()-e;this._channelModule.getModule(oh).addRTT(t)}},{key:"_connect",value:function(){this._startTs=Date.now(),this._onOpenTs=0,this._socket=new bb(this),this._socketID=this._socket.getID(),this._readyState=wb,Pl.l("".concat(this._n,"._connect isWorkerEnabled:").concat(this.getIsWorkerEnabled()," socketID:").concat(this._socketID," url:").concat(this.getURL())),new s_("wsConnect").setMessage("socketID:".concat(this._socketID," url:").concat(this.getURL())).end()}},{key:"getURL",value:function(){this._channelModule.isDevMode()&&(this._canIUseBinaryFrame=!1);var e=Ed();($c||Wc&&"windows"===e||Qc)&&(this._canIUseBinaryFrame=!1);var t=-1;"ios"===e?t=dl||-1:"android"===e&&(t=fl||-1);var n=this._channelModule.getModule(Hf),o=this._channelModule.getPlatform(),r=n.getSDKAppID(),i=n.getInstanceID(),a="sdkappid=".concat(r,"&instanceid=").concat(i,"&random=").concat(this._getRandom(),"&platform=").concat(o,"&host=").concat(e,"&version=").concat(t);return this._canIUseBinaryFrame?"".concat(this._url,"/binfo?").concat(a):"".concat(this._url,"/info?").concat(a)}},{key:"_closeConnection",value:function(e){Pl.l("".concat(this._n,"._closeConnection socketID:").concat(this._socketID)),this._socket&&(this._socket.close(e),this._socketID=-1,this._socket=null,this._readyState=Ob)}},{key:"_resend",value:function(){var e=this;if(Pl.l("".concat(this._n,"._resend reConnectFlag:").concat(this._reConnectFlag),"promiseMap.size:".concat(this._promiseMap.size," simpleRequestMap.size:").concat(this._simpleRequestMap.size)),this._promiseMap.size>0&&this._promiseMap.forEach((function(t,n){var o=t.uplinkData,r=t.resolve,i=t.reject;e._promiseMap.set(n,{resolve:r,reject:i,timestamp:Date.now(),uplinkData:o}),e._execute(n,o)})),this._simpleRequestMap.size>0){var t,n=S(this._simpleRequestMap);try{for(n.s();!(t=n.n()).done;){var o=_(t.value,2),r=o[0],i=o[1];this._execute(r,i)}}catch(s){n.e(s)}finally{n.f()}this._simpleRequestMap.clear()}}},{key:"send",value:function(e){var t=this;e.head.seq=this._getSequence(),e.head.reqtime=Math.floor(Date.now()/1e3),e.keyMap;var n=h(e,Ab),o=this._getRequestIDFromHead(e.head),r=JSON.stringify(n);return new Promise((function(e,i){t._promiseMap.set(o,{resolve:e,reject:i,timestamp:Date.now(),uplinkData:r}),Pl.d("".concat(t._n,".send uplinkData:").concat(JSON.stringify(n)," requestID:").concat(o," readyState:").concat(t._readyState)),t._readyState!==Rb?t._reConnect():(t._execute(o,r),t._channelModule.getModule(oh).addRequestCount())}))}},{key:"simplySend",value:function(e){e.head.seq=this._getSequence(),e.head.reqtime=Math.floor(Date.now()/1e3),e.keyMap;var t=h(e,Lb),n=this._getRequestIDFromHead(e.head),o=JSON.stringify(t);this._readyState!==Rb?(this._simpleRequestMap.size<this.MAX_SIZE?this._simpleRequestMap.set(n,o):Pl.l("".concat(this._n,".simplySend. simpleRequestMap is full, drop request!")),this._reConnect()):this._execute(n,o)}},{key:"_execute",value:function(e,t){this._socket.send({data:t,fail:tl?this._onSendFail.bind(this):void 0,requestID:e})}},{key:"_onSendFail",value:function(e){Pl.l("".concat(this._n,"._onSendFail requestID:").concat(e))}},{key:"_getSequence",value:function(){var e;if(this._startSequence<2415919103)return e=this._startSequence,this._startSequence+=1,2415919103===this._startSequence&&(this._startSequence=ld()),e}},{key:"_getRequestIDFromHead",value:function(e){return e.servcmd+e.seq}},{key:"_getResponseKeyMap",value:function(e){var n=this._channelModule.getKeyMap(e);return t(t({},uk.response),n.response)}},{key:"_reConnect",value:function(){this._readyState!==Rb&&this._readyState!==wb&&this.forcedReconnect()}},{key:"forcedReconnect",value:function(){var e=this,t="".concat(this._n,".forcedReconnect");Pl.l("".concat(t," count:").concat(this._reConnectCount," readyState:").concat(this._readyState)),this._reConnectFlag=!0,this._resetRandom(),this._reConnectCount<this.MAX_RECONNECT_COUNT?(this._reConnectCount+=1,this._closeConnection(Eb),this._initConnection()):(this._reConnectCount=0,this._channelModule.probeNetwork().then((function(n){var o=_(n,2),r=o[0];o[1],r?(Pl.w("".concat(t," disconnected from wsserver but network is ok, continue...")),e._closeConnection(Eb),e._initConnection()):e._channelModule.onReconnectFailed()})))}},{key:"getReconnectFlag",value:function(){return this._reConnectFlag}},{key:"_setNextPingTs",value:function(){this._nextPingTs=Date.now()+1e4}},{key:"getNextPingTs",value:function(){return this._nextPingTs}},{key:"isConnected",value:function(){return this._readyState===Rb}},{key:"canIUseBinaryFrame",value:function(){return this._canIUseBinaryFrame}},{key:"setIsWorkerEnabled",value:function(e){Pl.l("".concat(this._n,".setIsWorkerEnabled flag:").concat(e)),this._isWorkerEnabled=e}},{key:"getIsWorkerEnabled",value:function(){return this._isWorkerEnabled&&Ml}},{key:"_getRandom",value:function(){return 0===this._random&&(this._random=Math.random()),this._random}},{key:"_resetRandom",value:function(){this._random=0}},{key:"close",value:function(){Pl.l("".concat(this._n,".close")),this._closeConnection(Db),this._promiseMap.clear(),this._startSequence=ld(),this._readyState=Ob,this._simpleRequestMap.clear(),this._reConnectFlag=!1,this._reConnectCount=0,this._onOpenTs=0,this._url="",this._random=0,this._canIUseBinaryFrame=!0,this._isWorkerEnabled=!0}}]),e}(),Pb=function(e){u(n,e);var t=m(n);function n(e){var o;if(r(this,n),(o=t.call(this,e))._n="ChannelModule",o._socketHandler=new Nb(g(o)),o._probing=!1,o._isAppShowing=!0,o._previousState=Ir.NET_STATE_CONNECTED,tl&&"function"==typeof ol.onAppShow&&"function"==typeof ol.onAppHide){var i=o._onAppHide.bind(g(o)),a=o._onAppShow.bind(g(o));"function"==typeof ol.offAppHide&&ol.offAppHide(i),"function"==typeof ol.offAppShow&&ol.offAppShow(a),ol.onAppHide(i),ol.onAppShow(a)}return o._timerForNotLoggedIn=-1,o._timerForNotLoggedIn=setInterval(o.onCheckTimer.bind(g(o)),1e3),o._fatalErrorFlag=!1,o}return a(n,[{key:"onCheckTimer",value:function(e){this._socketHandler&&(this.isLoggedIn()?(this._timerForNotLoggedIn>0&&(clearInterval(this._timerForNotLoggedIn),this._timerForNotLoggedIn=-1),this._socketHandler.onCheckTimer(e)):this._socketHandler.onCheckTimer(1),this._checkNextPing())}},{key:"onErrorCodeNotZero",value:function(e){this.getModule(Xf).onErrorCodeNotZero(e)}},{key:"onMessage",value:function(e){this.getModule(Xf).onMessage(e)}},{key:"send",value:function(e){return this._socketHandler?this._previousState!==Ir.NET_STATE_CONNECTED&&e.head.servcmd.includes(Vg)?(this.reConnect(),this._sendLogViaHTTP(e)):this._socketHandler.send(e):Promise.reject()}},{key:"_sendLogViaHTTP",value:function(e){var t=Gc.HOST.CURRENT.STAT;return new Promise((function(n,o){var r="".concat(t,"/v4/imopenstat/tim_web_report_v2?sdkappid=").concat(e.head.sdkappid,"&reqtime=").concat(Date.now()),i=JSON.stringify(e.body),a="application/x-www-form-urlencoded;charset=UTF-8";if(tl)ol.request({url:r,data:i,method:"POST",timeout:3e3,header:{"content-type":a},success:function(){n()},fail:function(){o(new pI({code:Tm}))}});else{var s=new XMLHttpRequest,u=setTimeout((function(){s.abort(),o(new pI({code:Sm}))}),3e3);s.onreadystatechange=function(){4===s.readyState&&(clearTimeout(u),200===s.status||304===s.status?n():o(new pI({code:Tm})))},s.open("POST",r,!0),s.setRequestHeader("Content-type",a),s.send(i)}}))}},{key:"simplySend",value:function(e){return this._socketHandler?this._socketHandler.simplySend(e):Promise.reject()}},{key:"onOpen",value:function(){this._ping()}},{key:"onClose",value:function(){this._socketHandler&&this._socketHandler.getReconnectFlag()&&this._emitNetStateChangeEvent(Ir.NET_STATE_DISCONNECTED),this.reConnect()}},{key:"onError",value:function(){tl&&!Qc&&this.outputWarning("DomainNameInMP"),this._emitNetStateChangeEvent(Ir.NET_STATE_DISCONNECTED)}},{key:"getKeyMap",value:function(e){return this.getModule(Xf).getKeyMap(e)}},{key:"_onAppHide",value:function(){this._isAppShowing=!1}},{key:"_onAppShow",value:function(){this._isAppShowing=!0}},{key:"onRequestTimeout",value:function(e){}},{key:"onReconnected",value:function(){Pl.l("".concat(this._n,".onReconnected")),this._m.restartTimer(),this.getModule(Xf).onReconnected(),this._emitNetStateChangeEvent(Ir.NET_STATE_CONNECTED)}},{key:"onReconnectFailed",value:function(){Pl.l("".concat(this._n,".onReconnectFailed")),this._emitNetStateChangeEvent(Ir.NET_STATE_DISCONNECTED)}},{key:"setIsWorkerEnabled",value:function(e){this._socketHandler&&this._socketHandler.setIsWorkerEnabled(!1)}},{key:"offline",value:function(){this._emitNetStateChangeEvent(Ir.NET_STATE_DISCONNECTED)}},{key:"reConnect",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=!1;this._socketHandler&&(t=this._socketHandler.getReconnectFlag());var n="forcedFlag:".concat(e," fatalErrorFlag:").concat(this._fatalErrorFlag," previousState:").concat(this._previousState," reconnectFlag:").concat(t);if(Pl.l("".concat(this._n,".reConnect ").concat(n)),!this._fatalErrorFlag&&this._socketHandler){if(!0===e)this._socketHandler.forcedReconnect();else{if(this._previousState===Ir.NET_STATE_CONNECTING&&t)return;this._socketHandler.forcedReconnect()}this._emitNetStateChangeEvent(Ir.NET_STATE_CONNECTING)}}},{key:"_emitNetStateChangeEvent",value:function(e){this._previousState!==e&&(Pl.l("".concat(this._n,"._emitNetStateChangeEvent from ").concat(this._previousState," to ").concat(e)),this._previousState=e,this.emitOuterEvent(Mr.NET_STATE_CHANGE,{state:e}))}},{key:"_ping",value:function(){var e=this;if(!0!==this._probing){this._probing=!0;var t=this.getModule(Xf).getProtocolData({protocolName:Hg});this.send(t).then((function(){e._probing=!1})).catch((function(t){if(Pl.w("".concat(e._n,"._ping failed. error:"),t),e._probing=!1,t&&60002===t.code)return new s_("error").setMessage("code:".concat(t.code," message:").concat(t.message)).setNetworkType(e.getModule(zf).getNetworkType()).end(),e._fatalErrorFlag=!0,void e._emitNetStateChangeEvent(Ir.NET_STATE_DISCONNECTED);e.probeNetwork().then((function(t){var n=_(t,2),o=n[0],r=n[1];Pl.l("".concat(e._n,"._ping failed. probe network, isAppShowing:").concat(e._isAppShowing," online:").concat(o," networkType:").concat(r)),o?e.reConnect():e._emitNetStateChangeEvent(Ir.NET_STATE_DISCONNECTED)}))}))}}},{key:"_checkNextPing",value:function(){this._socketHandler&&this._socketHandler.isConnected()&&Date.now()>=this._socketHandler.getNextPingTs()&&this._ping()}},{key:"dealloc",value:function(){this._socketHandler&&(this._socketHandler.close(),this._socketHandler=null),this._timerForNotLoggedIn>-1&&clearInterval(this._timerForNotLoggedIn)}},{key:"onRestApiKickedOut",value:function(){this._socketHandler&&(this._socketHandler.close(),this.reConnect(!0))}},{key:"reset",value:function(){Pl.l("".concat(this._n,".reset")),this._previousState=Ir.NET_STATE_CONNECTED,this._probing=!1,this._fatalErrorFlag=!1,this._timerForNotLoggedIn=setInterval(this.onCheckTimer.bind(this),1e3)}}]),n}(lh),Gb=["a2","tinyid"],Ub=["a2","tinyid"],xb=function(){function e(t){r(this,e),this._n="ProtocolHandler",this._sessionModule=t,this._configMap=new Map,this._fillConfigMap()}return a(e,[{key:"_fillConfigMap",value:function(){this._configMap.clear();var e=this._sessionModule.genCommonHead(),n=this._sessionModule.genCosSpecifiedHead(),o=this._sessionModule.genSSOReportHead(),r=this._sessionModule.isIntl();this._configMap.set(dh,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.IM_OPEN_STATUS,".").concat(Gc.CMD.LOGIN)}),body:{state:"Online",isWebUniapp:0,deviceBrand:0},keyMap:{request:{deviceBrand:"InstType"},response:{InstId:"instanceID",HelloInterval:"helloInterval"}}}}(e)),this._configMap.set(ph,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.IM_OPEN_STATUS,".").concat(Gc.CMD.LOGOUT)}),body:{type:0},keyMap:{request:{type:"wslogout_type"}}}}(e)),this._configMap.set(fh,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.IM_OPEN_STATUS,".").concat(Gc.CMD.HELLO)}),body:{isWebUniapp:0},keyMap:{response:{NewInstInfo:"newInstanceInfo"}}}}(e)),this._configMap.set(hh,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.STAT_SERVICE,".").concat(Gc.CMD.KICK_OTHER)}),body:{}}}(e)),this._configMap.set(Fg,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.IM_COS_SIGN,".").concat(Gc.CMD.COS_SIGN)}),body:{cmd:"open_im_cos_svc",subCmd:"get_cos_token",duration:300,version:2},keyMap:{request:{userSig:"usersig",subCmd:"sub_cmd",cmd:"cmd",duration:"duration",version:"version"},response:{expired_time:"expiredTime",bucket_name:"bucketName",session_token:"sessionToken",tmp_secret_id:"secretId",tmp_secret_key:"secretKey"}}}}(n)),this._configMap.set(qg,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.CUSTOM_UPLOAD,".").concat(Gc.CMD.COS_PRE_SIG)}),body:{fileType:void 0,fileName:void 0,uploadMethod:0,duration:900},keyMap:{request:{userSig:"usersig",fileType:"file_type",fileName:"file_name",uploadMethod:"upload_method"},response:{expired_time:"expiredTime",request_id:"requestId",head_url:"headUrl",upload_url:"uploadUrl",download_url:"downloadUrl",ci_url:"ciUrl",snapshot_url:"requestSnapshotUrl"}}}}(n)),this._configMap.set(Bg,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.CUSTOM_UPLOAD,".").concat(Gc.CMD.VIDEO_COVER)}),body:{version:1,platform:void 0,coverName:void 0,requestSnapshotUrl:void 0},keyMap:{request:{version:"version",platform:"platform",coverName:"cover_name",requestSnapshotUrl:"snapshot_url"},response:{error_code:"errorCode",error_msg:"errorInfo",download_url:"snapshotUrl"}}}}(n)),this._configMap.set($g,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.IM_CONFIG_MANAGER,".").concat(Gc.CMD.FETCH_COMMERCIAL_CONFIG)}),body:{SDKAppID:0},keyMap:{request:{SDKAppID:"uint32_sdkappid"},response:{int32_error_code:"errorCode",str_error_message:"errorMessage",str_purchase_bits:"purchaseBits",uint32_expired_time:"expiredTime"}}}}(e)),this._configMap.set(Qg,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.IM_CONFIG_MANAGER,".").concat(Gc.CMD.PUSHED_COMMERCIAL_CONFIG)}),body:{},keyMap:{response:{int32_error_code:"errorCode",str_error_message:"errorMessage",str_purchase_bits:"purchaseBits",uint32_expired_time:"expiredTime"}}}}(e)),this._configMap.set(Jg,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.IM_CONFIG_MANAGER,".").concat(Gc.CMD.FETCH_CLOUD_CONTROL_CONFIG)}),body:{SDKAppID:0,version:0},keyMap:{request:{SDKAppID:"uint32_sdkappid",version:"uint64_version"},response:{int32_error_code:"errorCode",str_error_message:"errorMessage",str_json_config:"cloudControlConfig",uint32_expired_time:"expiredTime",uint32_sdkappid:"SDKAppID",uint64_version:"version"}}}}(e)),this._configMap.set(Xg,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.IM_CONFIG_MANAGER,".").concat(Gc.CMD.PUSHED_CLOUD_CONTROL_CONFIG)}),body:{},keyMap:{response:{int32_error_code:"errorCode",str_error_message:"errorMessage",str_json_config:"cloudControlConfig",uint32_expired_time:"expiredTime",uint32_sdkappid:"SDKAppID",uint64_version:"version"}}}}(e)),this._configMap.set(ev,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.OVERLOAD_PUSH,".").concat(Gc.CMD.OVERLOAD_NOTIFY)}),body:{},keyMap:{response:{OverLoadServCmd:"overloadCommand",DelaySecs:"waitingTime"}}}}(e)),this._configMap.set(gh,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.OPEN_IM,".").concat(Gc.CMD.GET_MESSAGES)}),body:{cookie:"",syncFlag:0,needAbstract:1,isOnlineSync:0,needSignaling:1},keyMap:{request:{fromAccount:"From_Account",toAccount:"To_Account",from:"From_Account",to:"To_Account",time:"MsgTimeStamp",sequence:"MsgSeq",random:"MsgRandom",elements:"MsgBody"},response:{MsgList:"messageList",SyncFlag:"syncFlag",To_Account:"to",From_Account:"from",ClientSeq:"clientSequence",MsgSeq:"sequence",NoticeSeq:"noticeSequence",NotifySeq:"notifySequence",MsgRandom:"random",MsgTimeStamp:"time",MsgContent:"content",ToGroupId:"to",MsgKey:"messageKey",GroupTips:"groupTips",MsgBody:"elements",MsgType:"type",C2CRemainingUnreadCount:"C2CRemainingUnreadList",C2CPairUnreadCount:"C2CPairUnreadList"}}}}(e)),r||(this._configMap.set(vh,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.OPEN_IM,".").concat(Gc.CMD.BIG_DATA_HALLWAY_AUTH_KEY)}),body:{}}}(e)),this._configMap.set(pv,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.IM_MSG_AUDIT_MGR,".").concat(Gc.CMD.GET_RPOFANITY_LIST)}),body:{version:0,deviceID:"",startIndex:void 0},keyMap:{request:{version:"uint64_version",deviceID:"str_device_id",startIndex:"uint64_start_index"},response:{msg_cmd_error_code:"errorInfo",str_err_msg:"errorMessage",uint32_code:"errorCode",msg_scene_ctl_config:"filterConfig",uint64_c2c_custom_msg_flag:"c2c_custom_message",uint64_c2c_text_msg_flag:"c2c_text_message",uint64_group_custom_msg_flag:"group_custom_message",uint64_group_text_msg_flag:"group_text_message",uint64_group_info_flag:"group_profile",uint64_group_member_info_flag:"group_member_profile",uint64_relation_chain_flag:"sns",uint64_user_info_flag:"user_profile",rpt_msg_dirty_word:"lexicon",str_dirty_word:"profanity",str_replaced_content:"replacement",uint64_filter_type:"filterType",uint64_id:"id",uint64_word_type:"profanityType",uint64_complete_flag:"completeFlag",uint64_next_start_index:"nextStartIndex",uint64_version:"version",uint64_expired_time:"expiredTime"}}}}(e))),this._configMap.set(mh,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.OPEN_IM,".").concat(Gc.CMD.SEND_MESSAGE)}),body:{fromAccount:"",toAccount:"",msgSeq:0,msgRandom:0,msgBody:[],cloudCustomData:void 0,nick:"",avatar:"",msgLifeTime:void 0,offlinePushInfo:{pushFlag:0,title:"",desc:"",ext:"",apnsInfo:{badgeMode:0,isVoipPush:void 0},androidInfo:{OPPOChannelID:""}},messageControlInfo:void 0,clientTime:void 0,needReadReceipt:0,isSupportExtension:0},keyMap:{request:{fromAccount:"From_Account",toAccount:"To_Account",msgTimeStamp:"MsgTimeStamp",msgSeq:"MsgSeq",msgRandom:"MsgRandom",msgBody:"MsgBody",count:"MaxCnt",lastMessageTime:"LastMsgTime",messageKey:"MsgKey",peerAccount:"Peer_Account",data:"Data",description:"Desc",extension:"Ext",type:"MsgType",content:"MsgContent",sizeType:"Type",uuid:"UUID",url:"",imageUrl:"URL",fileUrl:"Url",remoteAudioUrl:"Url",remoteVideoUrl:"VideoUrl",thumbUUID:"ThumbUUID",videoUUID:"VideoUUID",videoUrl:"",downloadFlag:"Download_Flag",nick:"From_AccountNick",avatar:"From_AccountHeadurl",from:"From_Account",time:"MsgTimeStamp",messageRandom:"MsgRandom",messageSequence:"MsgSeq",elements:"MsgBody",clientSequence:"ClientSeq",payload:"MsgContent",messageList:"MsgList",messageNumber:"MsgNum",abstractList:"AbstractList",messageBody:"MsgBody",needReadReceipt:"IsNeedReadReceipt"}}}}(e)),this._configMap.set(_h,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.GROUP,".").concat(Gc.CMD.SEND_GROUP_MESSAGE)}),body:{fromAccount:"",groupID:"",random:0,clientSequence:0,priority:"",msgBody:[],cloudCustomData:void 0,onlineOnlyFlag:0,offlinePushInfo:{pushFlag:0,title:"",desc:"",ext:"",apnsInfo:{badgeMode:0,isVoipPush:void 0},androidInfo:{OPPOChannelID:""}},groupAtInfo:[],messageControlInfo:void 0,clientTime:void 0,needReadReceipt:0,topicID:void 0,receiverList:void 0,isSupportExtension:0},keyMap:{request:{to:"GroupId",extension:"Ext",data:"Data",description:"Desc",random:"Random",sequence:"ReqMsgSeq",count:"ReqMsgNumber",type:"MsgType",priority:"MsgPriority",content:"MsgContent",elements:"MsgBody",sizeType:"Type",uuid:"UUID",url:"",imageUrl:"URL",fileUrl:"Url",remoteAudioUrl:"Url",remoteVideoUrl:"VideoUrl",thumbUUID:"ThumbUUID",videoUUID:"VideoUUID",videoUrl:"",downloadFlag:"Download_Flag",clientSequence:"ClientSeq",from:"From_Account",time:"MsgTimeStamp",messageRandom:"MsgRandom",messageSequence:"MsgSeq",payload:"MsgContent",messageList:"MsgList",messageNumber:"MsgNum",abstractList:"AbstractList",messageBody:"MsgBody",needReadReceipt:"NeedReadReceipt",receiverList:"To_Account"},response:{MsgTime:"time",MsgSeq:"sequence"}}}}(e)),this._configMap.set(Th,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.OPEN_IM,".").concat(Gc.CMD.REVOKE_C2C_MESSAGE)}),body:{msgInfo:{fromAccount:"",toAccount:"",msgTimeStamp:0,msgSeq:0,msgRandom:0}},keyMap:{request:{msgInfo:"MsgInfo",msgTimeStamp:"MsgTimeStamp",msgSeq:"MsgSeq",msgRandom:"MsgRandom"}}}}(e)),this._configMap.set(ag,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.GROUP,".").concat(Gc.CMD.REVOKE_GROUP_MESSAGE)}),body:{groupID:"",msgSeqList:void 0,topicID:""},keyMap:{request:{msgSeqList:"MsgSeqList",msgSeq:"MsgSeq"}}}}(e)),this._configMap.set(Eh,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.OPEN_IM,".").concat(Gc.CMD.GET_C2C_ROAM_MESSAGES)}),body:{peerAccount:"",count:15,lastMessageTime:0,messageKey:"",withRecalledMessage:1,direction:0},keyMap:{request:{messageKey:"MsgKey",peerAccount:"Peer_Account",count:"MaxCnt",lastMessageTime:"LastMsgTime",withRecalledMessage:"WithRecalledMsg",direction:"GetDirection"},response:{LastMsgTime:"lastMessageTime",IsNeedReadReceipt:"needReadReceipt",IsPeerRead:"readReceiptSentByPeer"}}}}(e)),this._configMap.set(Rh,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.OPEN_IM,".").concat(Gc.CMD.MODIFY_C2C_MESSAGE)}),body:{from:"",to:"",sequence:0,random:0,time:0,version:0,elements:void 0,cloudCustomData:void 0},keyMap:{request:{sequence:"MsgSeq",random:"MsgRandom",time:"MsgTime",version:"MsgVersion",type:"MsgType",content:"MsgContent"}}}}(e)),this._configMap.set(cg,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.GROUP,".").concat(Gc.CMD.GET_GROUP_ROAM_MESSAGES)}),body:{withRecalledMsg:1,groupID:"",count:15,sequence:"",topicID:void 0},keyMap:{request:{sequence:"ReqMsgSeq",count:"ReqMsgNumber",withRecalledMessage:"WithRecalledMsg"},response:{Random:"random",MsgTime:"time",MsgSeq:"sequence",ReqMsgSeq:"sequence",RspMsgList:"messageList",IsPlaceMsg:"isPlaceMessage",IsSystemMsg:"isSystemMessage",ToGroupId:"to",EnumFrom_AccountType:"fromAccountType",EnumTo_AccountType:"toAccountType",GroupCode:"groupCode",MsgPriority:"priority",MsgBody:"elements",MsgType:"type",MsgContent:"content",IsFinished:"complete",Download_Flag:"downloadFlag",ClientSeq:"clientSequence",ThumbUUID:"thumbUUID",VideoUUID:"videoUUID",ToTopicId:"topicID",InvisibleMsgSeq:"invisibleSequenceList"}}}}(e)),this._configMap.set(Sh,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.OPEN_IM,".").concat(Gc.CMD.SET_C2C_MESSAGE_READ)}),body:{C2CMsgReaded:void 0},keyMap:{request:{lastMessageTime:"LastedMsgTime"}}}}(e)),this._configMap.set(bh,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.OPEN_IM,".").concat(Gc.CMD.SET_C2C_PEER_MUTE_NOTIFICATIONS)}),body:{userIDList:void 0,muteFlag:0},keyMap:{request:{userIDList:"Peer_Account",muteFlag:"Mute_Notifications"}}}}(e)),this._configMap.set(Dh,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.OPEN_IM,".").concat(Gc.CMD.GET_C2C_PEER_MUTE_NOTIFICATIONS)}),body:{updateSequence:0},keyMap:{response:{MuteNotificationsList:"muteFlagList"}}}}(e)),this._configMap.set(sg,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.GROUP,".").concat(Gc.CMD.SET_GROUP_MESSAGE_READ)}),body:{groupID:void 0,messageReadSeq:void 0,topicID:void 0},keyMap:{request:{messageReadSeq:"MsgReadedSeq"}}}}(e)),this._configMap.set(ug,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.OPEN_IM,".").concat(Gc.CMD.SET_ALL_MESSAGE_READ)}),body:{readAllC2CMessage:0,groupMessageReadInfoList:[]},keyMap:{request:{readAllC2CMessage:"C2CReadAllMsg",groupMessageReadInfoList:"GroupReadInfo",messageSequence:"MsgSeq"},response:{C2CReadAllMsg:"readAllC2CMessage",GroupReadInfoArray:"groupMessageReadInfoList"}}}}(e)),this._configMap.set(Lh,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.OPEN_IM,".").concat(Gc.CMD.DELETE_C2C_MESSAGE)}),body:{fromAccount:"",to:"",keyList:void 0},keyMap:{request:{keyList:"MsgKeyList"}}}}(e)),this._configMap.set(yg,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.GROUP,".").concat(Gc.CMD.DELETE_GROUP_MESSAGE)}),body:{groupID:"",deleter:"",keyList:void 0,topicID:void 0},keyMap:{request:{deleter:"Deleter_Account",keyList:"Seqs"}}}}(e)),this._configMap.set(fv,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.IM_OPEN_TRANSLATE,".").concat(Gc.CMD.TRANSLATE_TEXT)}),body:{sourceTextList:void 0,SDKAppID:0,from:0,source:"",target:""},keyMap:{request:{sourceTextList:"SourceText",SDKAppID:"SdkAppId",from:"FromAccount"},response:{TargetText:"translatedTextList",RequestId:"requestID",CmdErrorCode:"error",ErrorCode:"code",ErrorInfo:"message"}}}}(e)),this._configMap.set(Mg,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.OPEN_IM,".").concat(Gc.CMD.MODIFY_GROUP_MESSAGE)}),body:{groupID:"",topicID:void 0,sequence:0,version:0,elements:void 0,cloudCustomData:void 0},keyMap:{request:{sequence:"MsgSeq",version:"MsgVersion",type:"MsgType",content:"MsgContent"}}}}(e)),this._configMap.set(lg,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.GROUP,".").concat(Gc.CMD.GET_READ_RECEIPT)}),body:{groupID:"",sequenceList:void 0},keyMap:{request:{sequence:"MsgSeq"}}}}(e)),this._configMap.set(pg,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.OPEN_IM,".").concat(Gc.CMD.SEND_C2C_READ_RECEIPT)}),body:{peerAccount:"",messageInfoList:void 0},keyMap:{request:{peerAccount:"Peer_Account",messageInfoList:"C2CMsgInfo",fromAccount:"From_Account",toAccount:"To_Account",sequence:"MsgSeq",random:"MsgRandom",time:"MsgTime",clientTime:"MsgClientTime"}}}}(e)),this._configMap.set(dg,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.GROUP,".").concat(Gc.CMD.SEND_READ_RECEIPT)}),body:{groupID:"",sequenceList:void 0},keyMap:{request:{sequenceList:"MsgSeqList",sequence:"MsgSeq"}}}}(e)),this._configMap.set(fg,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.GROUP,".").concat(Gc.CMD.GET_READ_RECEIPT_DETAIL)}),body:{groupID:"",sequence:void 0,flag:0,cursor:0,count:0},keyMap:{request:{sequence:"MsgSeq",count:"Num"},response:{ReadList:"readUserIDList",Read_Account:"userID",UnreadList:"unreadUserIDList",Unread_Account:"userID",IsFinish:"isCompleted"}}}}(e)),this._configMap.set(wh,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.OPEN_IM_MSG_EXT,".").concat(Gc.CMD.MODIFY_C2C_MESSAGE_EXTENSIONS)}),body:{from:void 0,to:void 0,messageKey:void 0,operateType:void 0,extensionList:void 0}}}(e)),this._configMap.set(Oh,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.OPEN_IM_MSG_EXT,".").concat(Gc.CMD.GET_C2C_MESSAGE_EXTENSIONS)}),body:{from:void 0,to:void 0,messageKey:void 0,startSequence:void 0}}}(e)),this._configMap.set(bg,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.OPEN_IM_MSG_EXT,".").concat(Gc.CMD.MODIFY_GROUP_MESSAGE_EXTENSIONS)}),body:{groupID:void 0,messageSequence:void 0,operateType:void 0,extensionList:void 0}}}(e)),this._configMap.set(Dg,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.OPEN_IM_MSG_EXT,".").concat(Gc.CMD.GET_GROUP_MESSAGE_EXTENSIONS)}),body:{groupID:void 0,messageSequence:void 0,startSequence:void 0}}}(e)),this._configMap.set(Ah,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.OPEN_IM,".").concat(Gc.CMD.GET_PEER_READ_TIME)}),body:{userIDList:void 0},keyMap:{request:{userIDList:"To_Account"},response:{ReadTime:"peerReadTimeList"}}}}(e)),this._configMap.set(Ph,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.RECENT_CONTACT,".").concat(Gc.CMD.GET_CONVERSATION_LIST)}),body:{fromAccount:void 0,count:0},keyMap:{request:{},response:{SessionItem:"conversations",ToAccount:"groupID",To_Account:"userID",UnreadMsgCount:"unreadCount",MsgGroupReadedSeq:"messageReadSeq",C2cPeerReadTime:"c2cPeerReadTime"}}}}(e)),this._configMap.set(Nh,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.RECENT_CONTACT,".").concat(Gc.CMD.PAGING_GET_CONVERSATION_LIST)}),body:{fromAccount:void 0,timeStamp:void 0,startIndex:void 0,pinnedTimeStamp:void 0,pinnedStartIndex:void 0,orderType:void 0,messageAssistFlag:4,assistFlag:15},keyMap:{request:{messageAssistFlag:"MsgAssistFlags",assistFlag:"AssistFlags",pinnedTimeStamp:"TopTimeStamp",pinnedStartIndex:"TopStartIndex"},response:{SessionItem:"conversations",ToAccount:"groupID",To_Account:"userID",UnreadMsgCount:"unreadCount",MsgGroupReadedSeq:"messageReadSeq",C2cPeerReadTime:"c2cPeerReadTime",LastMsgFlags:"lastMessageFlag",TopFlags:"isPinned",TopTimeStamp:"pinnedTimeStamp",TopStartIndex:"pinnedStartIndex",GroupId:"convGroupID"}}}}(e)),this._configMap.set(Gh,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.RECENT_CONTACT,".").concat(Gc.CMD.DELETE_CONVERSATION)}),body:{fromAccount:"",toAccount:void 0,type:1,toGroupID:void 0,clearHistoryMessage:1},keyMap:{request:{toGroupID:"ToGroupid",clearHistoryMessage:"ClearRamble"}}}}(e)),this._configMap.set(Uh,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.RECENT_CONTACT,".").concat(Gc.CMD.CLEAR_HISTORY_MESSAGE)}),body:{fromAccount:"",toAccount:void 0,type:1,toGroupID:void 0},keyMap:{request:{toGroupID:"ToGroupid"}}}}(e)),this._configMap.set(xh,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.RECENT_CONTACT,".").concat(Gc.CMD.PIN_CONVERSATION)}),body:{fromAccount:"",operationType:1,itemList:void 0},keyMap:{request:{itemList:"RecentContactItem"}}}}(e)),this._configMap.set(Fh,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.OPEN_IM,".").concat(Gc.CMD.DELETE_GROUP_AT_TIPS)}),body:{messageListToDelete:void 0},keyMap:{request:{messageListToDelete:"DelMsgList",messageSeq:"MsgSeq",messageRandom:"MsgRandom"}}}}(e)),this._configMap.set(qh,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.RECENT_CONTACT,".").concat(Gc.CMD.MARK_CONVERSATION)}),body:{fromAccount:"",itemList:void 0},keyMap:{request:{itemList:"MarkItem",operationType:"OptType",groupID:"ToGroupId"},response:{ToGroupId:"groupID",OptType:"operationType"}}}}(e)),this._configMap.set(Bh,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.RECENT_CONTACT,".").concat(Gc.CMD.MARK_CONVERSATION)}),body:{fromAccount:"",itemList:void 0},keyMap:{request:{itemList:"MarkItem",operationType:"OptType",groupID:"ToGroupId"},response:{ToGroupId:"groupID",OptType:"operationType"}}}}(e)),this._configMap.set(Vh,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.RECENT_CONTACT,".").concat(Gc.CMD.CREATE_CONVERSATION_GROUP)}),body:{fromAccount:"",itemList:void 0},keyMap:{request:{itemList:"GroupContactItem",groupID:"ToGroupId"},response:{GroupId:"convGroupID",ToGroupId:"groupID",OptType:"operationType"}}}}(e)),this._configMap.set(Hh,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.RECENT_CONTACT,".").concat(Gc.CMD.DELETE_CONVERSATION_GROUP)}),body:{fromAccount:"",groupName:void 0},keyMap:{request:{},response:{GroupId:"convGroupID"}}}}(e)),this._configMap.set(Kh,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.RECENT_CONTACT,".").concat(Gc.CMD.UPDATE_CONVERSATION_GROUP)}),body:{fromAccount:"",updateType:void 0,updateGroup:void 0},keyMap:{request:{oldName:"OldGroupName",newName:"NewGroupName",groupID:"ToGroupId",operationType:"ContactOptType",groupName:"OldGroupName",updateItem:"ContactUpdateItem"},response:{ContactOptType:"operationType",ToGroupId:"groupID",GroupId:"convGroupID"}}}}(e)),this._configMap.set(jh,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.RECENT_CONTACT,".").concat(Gc.CMD.UPDATE_CONVERSATION_GROUP)}),body:{fromAccount:"",updateType:void 0,updateGroup:{groupName:void 0,updateGroupType:void 0,updateItem:void 0}},keyMap:{request:{},response:{}}}}(e)),this._configMap.set(zh,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.RECENT_CONTACT,".").concat(Gc.CMD.UPDATE_CONVERSATION_GROUP)}),body:{fromAccount:"",updateType:void 0,updateGroup:void 0},keyMap:{request:{},response:{}}}}(e)),this._configMap.set(Zh,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.RECENT_CONTACT,".").concat(Gc.CMD.GET_CONVERSATION_GROUP_LIST)}),body:{fromAccount:"",startTime:void 0,startIndex:void 0},keyMap:{request:{},response:{GroupId:"convGroupID",ToGroupId:"groupID",OptType:"operationType",CustomMark:"customData",ContactGroupId:"convGroupIDList"}}}}(e)),this._configMap.set(yh,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.PROFILE,".").concat(Gc.CMD.PORTRAIT_GET)}),body:{fromAccount:"",userItem:[]},keyMap:{request:{toAccount:"To_Account",standardSequence:"StandardSequence",customSequence:"CustomSequence"}}}}(e)),this._configMap.set(Mh,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.PROFILE,".").concat(Gc.CMD.PORTRAIT_SET)}),body:{fromAccount:"",profileItem:[{tag:Ul.NICK,value:""},{tag:Ul.GENDER,value:""},{tag:Ul.ALLOWTYPE,value:""},{tag:Ul.AVATAR,value:""}]},keyMap:{request:{toAccount:"To_Account",standardSequence:"StandardSequence",customSequence:"CustomSequence"}}}}(e)),this._configMap.set(Ih,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.FRIEND,".").concat(Gc.CMD.GET_BLACKLIST)}),body:{fromAccount:"",startIndex:0,maxLimited:30,lastSequence:0},keyMap:{response:{CurruentSequence:"currentSequence"}}}}(e)),this._configMap.set(Ch,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.FRIEND,".").concat(Gc.CMD.ADD_BLACKLIST)}),body:{fromAccount:"",toAccount:[]}}}(e)),this._configMap.set(kh,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.FRIEND,".").concat(Gc.CMD.DELETE_BLACKLIST)}),body:{fromAccount:"",toAccount:[]}}}(e)),this._configMap.set(iv,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.IM_OPEN_STATUS,".").concat(Gc.CMD.SET_SELF_STATUS)}),body:{customStatus:""},keyMap:{}}}(e)),this._configMap.set(av,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.IM_OPEN_STATUS,".").concat(Gc.CMD.GET_USER_STATUS)}),body:{userIDList:void 0},keyMap:{response:{UserStatusList:"successUserList",ErrorList:"failureUserList",To_Account:"userID",Invalid_Account:"invalidUserID",Status:"statusType"}}}}(e)),this._configMap.set(sv,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.IM_OPEN_STATUS,".").concat(Gc.CMD.SUBSCRIBE_USER_STATUS)}),body:{userIDList:void 0},keyMap:{response:{ErrorList:"failureUserList",To_Account:"userID",Invalid_Account:"invalidUserID"}}}}(e)),this._configMap.set(uv,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.IM_OPEN_STATUS,".").concat(Gc.CMD.UNSUBSCRIBE_USER_STATUS)}),body:{userIDList:void 0,unsubscribeAll:void 0},keyMap:{response:{ErrorList:"failureUserList",To_Account:"userID",Invalid_Account:"invalidUserID"}}}}(e)),this._configMap.set(Wh,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.GROUP,".").concat(Gc.CMD.GET_JOINED_GROUPS)}),body:{memberAccount:"",limit:void 0,offset:void 0,groupType:void 0,responseFilter:{groupBaseInfoFilter:void 0,selfInfoFilter:void 0},isSupportTopic:0},keyMap:{request:{memberAccount:"Member_Account"},response:{GroupIdList:"groups",NoUnreadSeqList:"excludedUnreadSequenceList",MsgSeq:"readedSequence",LastRecallTime:"_lastRevokedTime"}}}}(e)),this._configMap.set(Yh,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.GROUP,".").concat(Gc.CMD.GET_GROUP_INFO)}),body:{groupIDList:void 0,responseFilter:{groupBaseInfoFilter:["Type","Name","Introduction","Notification","FaceUrl","Owner_Account","CreateTime","InfoSeq","LastInfoTime","LastMsgTime","MemberNum","MaxMemberNum","ApplyJoinOption","NextMsgSeq","ShutUpAllMember"],groupCustomFieldFilter:void 0,memberInfoFilter:void 0,memberCustomFieldFilter:void 0}},keyMap:{request:{groupIDList:"GroupIdList",groupCustomField:"AppDefinedData",memberCustomField:"AppMemberDefinedData",groupCustomFieldFilter:"AppDefinedDataFilter_Group",memberCustomFieldFilter:"AppDefinedDataFilter_GroupMember"},response:{GroupIdList:"groups",AppDefinedData:"groupCustomField",AppMemberDefinedData:"memberCustomField",AppDefinedDataFilter_Group:"groupCustomFieldFilter",AppDefinedDataFilter_GroupMember:"memberCustomFieldFilter",InfoSeq:"infoSequence",MemberList:"members",GroupInfo:"groups",ShutUpUntil:"muteUntil",ShutUpAllMember:"muteAllMembers"}}}}(e)),this._configMap.set(Jh,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.GROUP,".").concat(Gc.CMD.CREATE_GROUP)}),body:{type:void 0,name:void 0,groupID:void 0,ownerID:void 0,introduction:void 0,notification:void 0,maxMemberNum:void 0,joinOption:void 0,memberList:void 0,groupCustomField:void 0,memberCustomField:void 0,webPushFlag:1,avatar:"",isSupportTopic:void 0},keyMap:{request:{ownerID:"Owner_Account",userID:"Member_Account",avatar:"FaceUrl",maxMemberNum:"MaxMemberCount",joinOption:"ApplyJoinOption",groupCustomField:"AppDefinedData",memberCustomField:"AppMemberDefinedData"},response:{HugeGroupFlag:"avChatRoomFlag",OverJoinedGroupLimit_Account:"overLimitUserIDList"}}}}(e)),this._configMap.set(Xh,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.GROUP,".").concat(Gc.CMD.DESTROY_GROUP)}),body:{groupID:void 0}}}(e)),this._configMap.set($h,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.GROUP,".").concat(Gc.CMD.MODIFY_GROUP_INFO)}),body:{groupID:void 0,name:void 0,introduction:void 0,notification:void 0,avatar:void 0,joinOption:void 0,groupCustomField:void 0,muteAllMembers:void 0},keyMap:{request:{groupCustomField:"AppDefinedData",muteAllMembers:"ShutUpAllMember",joinOption:"ApplyJoinOption",avatar:"FaceUrl"},response:{AppDefinedData:"groupCustomField",ShutUpAllMember:"muteAllMembers"}}}}(e)),this._configMap.set(Qh,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.GROUP,".").concat(Gc.CMD.APPLY_JOIN_GROUP)}),body:{groupID:void 0,applyMessage:void 0,userDefinedField:void 0,webPushFlag:1,historyMessageFlag:void 0},keyMap:{request:{applyMessage:"ApplyMsg",historyMessageFlag:"HugeGroupHistoryMsgFlag"},response:{HugeGroupFlag:"avChatRoomFlag",AVChatRoomKey:"avChatRoomKey",RspMsgList:"messageList",ToGroupId:"to"}}}}(e)),this._configMap.set(eg,function(e){return e.a2,e.tinyid,{head:t(t({},h(e,Gb)),{},{servcmd:"".concat(Gc.NAME.BIG_GROUP_NO_AUTH,".").concat(Gc.CMD.APPLY_JOIN_GROUP)}),body:{groupID:void 0,applyMessage:void 0,userDefinedField:void 0,webPushFlag:1},keyMap:{request:{applyMessage:"ApplyMsg"},response:{HugeGroupFlag:"avChatRoomFlag"}}}}(e)),this._configMap.set(tg,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.GROUP,".").concat(Gc.CMD.QUIT_GROUP)}),body:{groupID:void 0}}}(e)),this._configMap.set(ng,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.GROUP,".").concat(Gc.CMD.SEARCH_GROUP_BY_ID)}),body:{groupIDList:void 0,responseFilter:{groupBasePublicInfoFilter:["Type","Name","Introduction","Notification","FaceUrl","CreateTime","Owner_Account","LastInfoTime","LastMsgTime","NextMsgSeq","MemberNum","MaxMemberNum","ApplyJoinOption"]}},keyMap:{response:{}}}}(e)),this._configMap.set(og,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.GROUP,".").concat(Gc.CMD.CHANGE_GROUP_OWNER)}),body:{groupID:void 0,newOwnerID:void 0},keyMap:{request:{newOwnerID:"NewOwner_Account"}}}}(e)),this._configMap.set(rg,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.GROUP,".").concat(Gc.CMD.HANDLE_APPLY_JOIN_GROUP)}),body:{groupID:void 0,applicant:void 0,handleAction:void 0,handleMessage:void 0,authentication:void 0,messageKey:void 0,userDefinedField:void 0},keyMap:{request:{applicant:"Applicant_Account",handleAction:"HandleMsg",handleMessage:"ApprovalMsg",messageKey:"MsgKey"}}}}(e)),this._configMap.set(ig,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.GROUP,".").concat(Gc.CMD.HANDLE_GROUP_INVITATION)}),body:{groupID:void 0,inviter:void 0,handleAction:void 0,handleMessage:void 0,authentication:void 0,messageKey:void 0,userDefinedField:void 0},keyMap:{request:{inviter:"Inviter_Account",handleAction:"HandleMsg",handleMessage:"ApprovalMsg",messageKey:"MsgKey"}}}}(e)),this._configMap.set(hg,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.GROUP,".").concat(Gc.CMD.GET_GROUP_APPLICATION)}),body:{startTime:void 0,limit:void 0,handleAccount:void 0},keyMap:{request:{handleAccount:"Handle_Account"}}}}(e)),this._configMap.set(gg,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.OPEN_IM,".").concat(Gc.CMD.DELETE_GROUP_SYSTEM_MESSAGE)}),body:{messageListToDelete:void 0},keyMap:{request:{messageListToDelete:"DelMsgList",messageSeq:"MsgSeq",messageRandom:"MsgRandom"}}}}(e)),this._configMap.set(vg,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.BIG_GROUP_LONG_POLLING,".").concat(Gc.CMD.AVCHATROOM_LONG_POLL)}),body:{USP:1,startSeq:1,startBroadcastSeq:void 0,holdTime:90,key:void 0},keyMap:{request:{USP:"USP"},response:{ToGroupId:"groupID",RspBroadcastMsgList:"broadcastMessageList",IsSystemMsg:"isSystemMessage"}}}}(e)),this._configMap.set(mg,function(e){return e.a2,e.tinyid,{head:t(t({},h(e,Ub)),{},{servcmd:"".concat(Gc.NAME.BIG_GROUP_LONG_POLLING_NO_AUTH,".").concat(Gc.CMD.AVCHATROOM_LONG_POLL)}),body:{USP:1,startSeq:1,holdTime:90,key:void 0},keyMap:{request:{USP:"USP"},response:{ToGroupId:"groupID"}}}}(e)),this._configMap.set(_g,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.GROUP,".").concat(Gc.CMD.GET_ONLINE_MEMBER_NUM)}),body:{groupID:void 0}}}(e)),this._configMap.set(Ig,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.GROUP,".").concat(Gc.CMD.SET_GROUP_ATTRIBUTES)}),body:{groupID:void 0,groupAttributeList:void 0,mainSequence:void 0,avChatRoomKey:void 0,attributeControl:["RaceConflict"]},keyMap:{request:{key:"key",value:"value"}}}}(e)),this._configMap.set(Cg,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.GROUP,".").concat(Gc.CMD.MODIFY_GROUP_ATTRIBUTES)}),body:{groupID:void 0,groupAttributeList:void 0,mainSequence:void 0,avChatRoomKey:void 0,attributeControl:["RaceConflict"]},keyMap:{request:{key:"key",value:"value"}}}}(e)),this._configMap.set(kg,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.GROUP,".").concat(Gc.CMD.DELETE_GROUP_ATTRIBUTES)}),body:{groupID:void 0,groupAttributeList:void 0,mainSequence:void 0,avChatRoomKey:void 0,attributeControl:["RaceConflict"]},keyMap:{request:{key:"key"}}}}(e)),this._configMap.set(Tg,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.GROUP,".").concat(Gc.CMD.CLEAR_GROUP_ATTRIBUTES)}),body:{groupID:void 0,mainSequence:void 0,avChatRoomKey:void 0,attributeControl:["RaceConflict"]}}}(e)),this._configMap.set(Sg,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.GROUP_ATTR,".").concat(Gc.CMD.GET_GROUP_ATTRIBUTES)}),body:{groupID:void 0,avChatRoomKey:void 0,groupType:1},keyMap:{request:{avChatRoomKey:"Key",groupType:"GroupType"}}}}(e)),this._configMap.set(Eg,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.GROUP,".").concat(Gc.CMD.GET_GROUP_NOTIFY)}),body:{notifyType:1,groupID:"",beginTime:0,endTime:0,limit:20},keyMap:{request:{},response:{NextMsgTime:"nextRevokedTime",NotifyMsgList:"notifyList"}}}}(e)),this._configMap.set(Ag,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.GROUP,".").concat(Gc.CMD.UPDATE_GROUP_COUNTER)}),body:{groupID:void 0,counterList:void 0,avChatRoomKey:void 0,mode:void 0},keyMap:{request:{counterList:"GroupCounter"}}}}(e)),this._configMap.set(Lg,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.GROUP,".").concat(Gc.CMD.GET_GROUP_COUNTER)}),body:{groupID:void 0,keyList:[],avChatRoomKey:void 0},keyMap:{request:{keyList:"GroupCounterKeys"}}}}(e)),this._configMap.set(tv,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.GROUP_COMMUNITY,".").concat(Gc.CMD.CREATE_TOPIC)}),body:{groupID:void 0,topicName:void 0,avatar:void 0,customData:void 0,topicID:void 0,notification:void 0,introduction:void 0},keyMap:{request:{avatar:"FaceUrl"}}}}(e)),this._configMap.set(nv,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.GROUP_COMMUNITY,".").concat(Gc.CMD.DELETE_TOPIC)}),body:{groupID:void 0,topicIDList:void 0},keyMap:{request:{topicIDList:"TopicIdList"},response:{DestroyResultItem:"resultList"}}}}(e)),this._configMap.set(ov,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.GROUP_COMMUNITY,".").concat(Gc.CMD.UPDATE_TOPIC_PROFILE)}),body:{groupID:void 0,topicID:void 0,avatar:void 0,customData:void 0,notification:void 0,introduction:void 0,muteAllMembers:void 0,topicName:void 0},keyMap:{request:{avatar:"FaceUrl",muteAllMembers:"ShutUpAllMember"}}}}(e)),this._configMap.set(rv,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.GROUP_COMMUNITY,".").concat(Gc.CMD.GET_TOPIC_LIST)}),body:{groupID:void 0,topicIDList:void 0,MemberInfoFilter:["NoUnreadSeqList"]},keyMap:{request:{topicIDList:"TopicIdList"},response:{TopicAndSelfInfo:"topicInfoList",TopicInfo:"topic",GroupID:"groupID",ShutUpTime:"muteTime",ShutUpAllFlag:"muteAllMembers",LastMsgTime:"lastMessageTime",MsgSeq:"readedSequence",LastMsgSeq:"sequence",NoUnreadSeqList:"excludedUnreadSequenceList"}}}}(e)),this._configMap.set(Rg,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.GROUP,".").concat(Gc.CMD.GET_GROUP_MEMBER_LIST)}),body:{groupID:void 0,limit:0,offset:void 0,next:void 0,memberRoleFilter:void 0,memberInfoFilter:["Role","NameCard","ShutUpUntil","JoinTime"],memberCustomFieldFilter:void 0},keyMap:{request:{memberCustomFieldFilter:"AppDefinedDataFilter_GroupMember"},response:{AppMemberDefinedData:"memberCustomField",AppDefinedDataFilter_GroupMember:"memberCustomFieldFilter",MemberList:"members",ShutUpUntil:"muteUntil"}}}}(e)),this._configMap.set(wg,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.GROUP_AVCHATROOM,".").concat(Gc.CMD.GET_AVCHATROOM_MEMBER_LIST)}),body:{groupID:void 0,offset:void 0,filter:void 0},keyMap:{request:{offset:"Timestamp",filter:"Mark"},response:{NextTimestamp:"offset"}}}}(e)),this._configMap.set(Og,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.GROUP,".").concat(Gc.CMD.GET_GROUP_MEMBER_INFO)}),body:{groupID:void 0,userIDList:void 0,memberInfoFilter:void 0,memberCustomFieldFilter:void 0},keyMap:{request:{userIDList:"Member_List_Account",memberCustomFieldFilter:"AppDefinedDataFilter_GroupMember"},response:{MemberList:"members",ShutUpUntil:"muteUntil",AppDefinedDataFilter_GroupMember:"memberCustomFieldFilter",AppMemberDefinedData:"memberCustomField"}}}}(e)),this._configMap.set(Ng,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.GROUP,".").concat(Gc.CMD.ADD_GROUP_MEMBER)}),body:{groupID:void 0,silence:void 0,userIDList:void 0},keyMap:{request:{userID:"Member_Account",userIDList:"MemberList"},response:{MemberList:"members"}}}}(e)),this._configMap.set(Pg,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.GROUP,".").concat(Gc.CMD.DELETE_GROUP_MEMBER)}),body:{groupID:void 0,userIDList:void 0,reason:void 0},keyMap:{request:{userIDList:"MemberToDel_Account"}}}}(e)),this._configMap.set(Gg,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.GROUP,".").concat(Gc.CMD.BAN_AVCHATROOM_MEMBER)}),body:{groupID:void 0,userIDList:void 0,duration:void 0,reason:""},keyMap:{request:{userIDList:"Members_Account",duration:"Duration",reason:"Description"}}}}(e)),this._configMap.set(Ug,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.GROUP,".").concat(Gc.CMD.MODIFY_GROUP_MEMBER_INFO)}),body:{groupID:void 0,topicID:void 0,userID:void 0,messageRemindType:void 0,nameCard:void 0,role:void 0,memberCustomField:void 0,muteTime:void 0},keyMap:{request:{userID:"Member_Account",memberCustomField:"AppMemberDefinedData",muteTime:"ShutUpTime",messageRemindType:"MsgFlag"}}}}(e)),this._configMap.set(xg,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.GROUP_AVCHATROOM,".").concat(Gc.CMD.MARK_AVCHATROOM_MEMBER_INFO)}),body:{groupID:void 0,operationType:1,memberList:[]},keyMap:{request:{operationType:"CommandType",memberList:"MemberList",markType:"Marks",userID:"Member_Account"},response:{CommandType:"operationType",Marks:"markType",Member_Account:"userID"}}}}(e)),this._configMap.set(Vg,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.IM_OPEN_STAT,".").concat(Gc.CMD.TIM_WEB_REPORT_V2)}),body:{header:{},event:[],quality:[]},keyMap:{request:{SDKType:"sdk_type",SDKVersion:"sdk_version",deviceType:"device_type",platform:"platform",instanceID:"instance_id",traceID:"trace_id",SDKAppID:"sdk_app_id",userID:"user_id",tinyID:"tiny_id",extension:"extension",timestamp:"timestamp",networkType:"network_type",eventType:"event_type",code:"error_code",message:"error_message",moreMessage:"more_message",duplicate:"duplicate",costTime:"cost_time",level:"level",qualityType:"quality_type",reportIndex:"report_index",wholePeriod:"whole_period",totalCount:"total_count",rttCount:"success_count_business",successRateOfRequest:"percent_business",countLessThan1Second:"success_count_business",percentOfCountLessThan1Second:"percent_business",countLessThan3Second:"success_count_platform",percentOfCountLessThan3Second:"percent_platform",successCountOfBusiness:"success_count_business",successRateOfBusiness:"percent_business",successCountOfPlatform:"success_count_platform",successRateOfPlatform:"percent_platform",successCountOfMessageReceived:"success_count_business",successRateOfMessageReceived:"percent_business",avgRTT:"average_value",avgDelay:"average_value",avgValue:"average_value",uiPlatform:"ui_platform"}}}}(o)),this._configMap.set(Hg,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.HEARTBEAT,".").concat(Gc.CMD.ALIVE)}),body:{}}}(e)),this._configMap.set(Kg,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.IM_OPEN_PUSH,".").concat(Gc.CMD.MESSAGE_PUSH)}),body:{},keyMap:{response:{C2cMsgArray:"C2CMessageArray",GroupMsgArray:"groupMessageArray",GroupTips:"groupTips",C2cNotifyMsgArray:"C2CNotifyMessageArray",C2cMsgInfo:"C2CReadReceiptArray",ClientSeq:"clientSequence",MsgPriority:"priority",NoticeSeq:"noticeSequence",MsgContent:"content",MsgType:"type",MsgBody:"elements",ToGroupId:"to",Desc:"description",Ext:"extension",IsSyncMsg:"isSyncMessage",Flag:"needSync",NeedAck:"needAck",PendencyAdd_Account:"userID",ProfileImNick:"nick",PendencyType:"applicationType",C2CReadAllMsg:"readAllC2CMessage",IsNeedReadReceipt:"needReadReceipt",Status:"statusType",MsgExtensionNotify:"messageExtensionNotify",ExtensionC2cMsgInfo:"messageInfo",ExtensionGroupMsgInfo:"messageInfo",MsgOptType:"operateType",SetKVInfo:"operateResultList",DeleteKVInfo:"operateResultList",ClearKVInfo:"operateResultList",MsgKeyValue:"extensions",ClearMsgSeq:"clearSequence",MsgLastSeq:"globalSequence"}}}}(e)),this._configMap.set(jg,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.IM_OPEN_PUSH,".").concat(Gc.CMD.MULTI_MESSAGE_PUSH)}),body:{},keyMap:{response:{GroupMsgArray:"groupMessageArray",GroupTips:"groupTips",ClientSeq:"clientSequence",MsgPriority:"priority",NoticeSeq:"noticeSequence",MsgContent:"content",MsgType:"type",MsgBody:"elements",ToGroupId:"to",Desc:"description",Ext:"extension",IsSyncMsg:"isSyncMessage",Flag:"needSync",NeedAck:"needAck",PendencyType:"applicationType"}}}}(e)),this._configMap.set(zg,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.OPEN_IM,".").concat(Gc.CMD.MESSAGE_PUSH_ACK)}),body:{sessionData:void 0},keyMap:{request:{sessionData:"SessionData"}}}}(e)),this._configMap.set(Zg,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.IM_OPEN_STATUS,".").concat(Gc.CMD.STATUS_FORCE_OFFLINE)}),body:{},keyMap:{response:{C2cNotifyMsgArray:"C2CNotifyMessageArray",NoticeSeq:"noticeSequence",KickoutMsgNotify:"kickoutMsgNotify",NewInstInfo:"newInstanceInfo"}}}}(e)),this._configMap.set(Yg,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.IM_LONG_MESSAGE,".").concat(Gc.CMD.DOWNLOAD_MERGER_MESSAGE)}),body:{downloadKey:""},keyMap:{response:{Data:"data",Desc:"description",Ext:"extension",Download_Flag:"downloadFlag",ThumbUUID:"thumbUUID",VideoUUID:"videoUUID"}}}}(e)),this._configMap.set(Wg,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.IM_LONG_MESSAGE,".").concat(Gc.CMD.UPLOAD_MERGER_MESSAGE)}),body:{messageList:[]},keyMap:{request:{fromAccount:"From_Account",toAccount:"To_Account",msgTimeStamp:"MsgTimeStamp",msgSeq:"MsgSeq",msgRandom:"MsgRandom",msgBody:"MsgBody",type:"MsgType",content:"MsgContent",data:"Data",description:"Desc",extension:"Ext",sizeType:"Type",uuid:"UUID",url:"",imageUrl:"URL",fileUrl:"Url",remoteAudioUrl:"Url",remoteVideoUrl:"VideoUrl",thumbUUID:"ThumbUUID",videoUUID:"VideoUUID",videoUrl:"",downloadFlag:"Download_Flag",from:"From_Account",time:"MsgTimeStamp",messageRandom:"MsgRandom",messageSequence:"MsgSeq",elements:"MsgBody",clientSequence:"ClientSeq",payload:"MsgContent",messageList:"MsgList",messageNumber:"MsgNum",abstractList:"AbstractList",messageBody:"MsgBody"}}}}(e)),this._configMap.set(dv,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.IM_OPEN_STATUS,".").concat(Gc.CMD.SET_TOKEN)}),body:{tokenID:"",pushMsg:0,sdkAppID:0,businessID:"",deviceBrand:"",deviceToken:"",isTpns:0,isWebUniapp:0},keyMap:{request:{tokenID:"TokenID",pushMsg:"PushMsg",sdkAppID:"EnterVersion",businessID:"BusiID",deviceBrand:"InstType",deviceToken:"VarToken",isTpns:"IsTpns"}}}}(e)),this._configMap.set(lv,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.IM_OPEN_STATUS,".").concat(Gc.CMD.STAT_FOREGROUND)}),body:{isWebUniapp:0}}}(e)),this._configMap.set(cv,function(e){return{head:t(t({},e),{},{servcmd:"".concat(Gc.NAME.IM_OPEN_STATUS,".").concat(Gc.CMD.STAT_BACKGROUND)}),body:{C2CUnread:0,GroupUnread:0,isWebUniapp:0},keyMap:{request:{c2cUnreadCount:"C2cUnread",groupUnreadCount:"GrpUnread"}}}}(e))}},{key:"has",value:function(e){return this._configMap.has(e)}},{key:"get",value:function(e){return this._configMap.get(e)}},{key:"update",value:function(){this._fillConfigMap()}},{key:"getKeyMap",value:function(e){return this.has(e)?this.get(e).keyMap||{}:(Pl.w("".concat(this._n,".getKeyMap unknown protocolName:").concat(e)),{})}},{key:"getProtocolData",value:function(e){var t=e.protocolName,n=e.requestData,o=this.get(t),r=null;if(n){var i=this._simpleDeepCopy(o),a=this._updateService(n,i),s=a.body,u=Object.create(null);for(var c in s)if(Object.prototype.hasOwnProperty.call(s,c)){if(u[c]=s[c],void 0===n[c])continue;u[c]=n[c]}a.body=u,r=this._getUplinkData(a)}else r=this._getUplinkData(o);return r}},{key:"_getUplinkData",value:function(e){var t=this._requestDataCleaner(e),n=wd(t.head),o=fk(t.body,this._getRequestKeyMap(n));return t.body=o,t}},{key:"_updateService",value:function(e,t){var n=wd(t.head);if(this._isFromGroupRequest(t)){var o=e.type,r=e.groupID,i=void 0===r?void 0:r,a=e.groupIDList,s=void 0===a?[]:a;Ql(i)&&(i=s[0]||""),Md({type:o,groupID:i})&&(t.head.servcmd="".concat(Gc.NAME.GROUP_COMMUNITY,".").concat(n))}return t}},{key:"_isFromGroupRequest",value:function(e){return e.head.servcmd.includes(Gc.NAME.GROUP)||e.head.servcmd.includes(Gc.NAME.GROUP_ATTR)}},{key:"_getRequestKeyMap",value:function(e){var n=this.getKeyMap(e);return t(t({},uk.request),n.request)}},{key:"_requestDataCleaner",value:function(e){var t=Array.isArray(e)?[]:Object.create(null);for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&rd(n)&&null!==e[n]&&void 0!==e[n]&&("object"!==o(e[n])?t[n]=e[n]:t[n]=this._requestDataCleaner.bind(this)(e[n]));return t}},{key:"_simpleDeepCopy",value:function(e){for(var t,n=Object.keys(e),o={},r=0,i=n.length;r<i;r++)t=n[r],$l(e[t])?o[t]=Array.from(e[t]):Jl(e[t])?o[t]=this._simpleDeepCopy(e[t]):o[t]=e[t];return o}}]),e}(),Fb=[zg],qb=function(){function e(t){r(this,e),this._sessionModule=t,this._n="DownlinkHandler",this._eventHandlerMap=new Map,this._eventHandlerMap.set("C2CMessageArray",this._c2cMessageArrayHandler.bind(this)),this._eventHandlerMap.set("groupMessageArray",this._groupMessageArrayHandler.bind(this)),this._eventHandlerMap.set("groupTips",this._groupTipsHandler.bind(this)),this._eventHandlerMap.set("C2CNotifyMessageArray",this._C2CNotifyMessageArrayHandler.bind(this)),this._eventHandlerMap.set("C2CReadReceiptArray",this._C2CReadReceiptArrayHandler.bind(this)),this._eventHandlerMap.set("profileModify",this._profileHandler.bind(this)),this._eventHandlerMap.set("friendListMod",this._relationChainHandler.bind(this)),this._eventHandlerMap.set("recentContactMod",this._recentContactHandler.bind(this)),this._eventHandlerMap.set("readAllC2CMessage",this._allMessageReadHandler.bind(this)),this._eventHandlerMap.set("c2cMessageModified",this._c2cMessageModifiedHandler.bind(this)),this._eventHandlerMap.set("groupMessageModified",this._groupMessageModifiedHandler.bind(this)),this._eventHandlerMap.set("userStatusList",this._userStatusListHandler.bind(this)),this._eventHandlerMap.set("messageExtensionNotify",this._messageExtensionNotifyHandler.bind(this)),this._keys=y(this._eventHandlerMap.keys())}return a(e,[{key:"_c2cMessageArrayHandler",value:function(e){var t=this._sessionModule.getModule(Uf);t&&(e.dataList.forEach((function(e){if(1===e.isSyncMessage){var t=e.from;e.from=e.to,e.to=t}})),1===e.needSync&&this._sessionModule.getModule(Jf).startOnlineSync(),t.onNewC2CMessage({dataList:e.dataList,isInstantMessage:!0}))}},{key:"_c2cMessageModifiedHandler",value:function(e){var t=this._sessionModule.getModule(Uf);t&&t.onC2CMessageModified(e)}},{key:"_groupMessageArrayHandler",value:function(e){var t=this._sessionModule.getModule(xf);t&&t.onNewGroupMessage({event:e.event,dataList:e.dataList,isInstantMessage:!0})}},{key:"_groupMessageModifiedHandler",value:function(e){var t=this._sessionModule.getModule(xf);t&&t.onGroupMessageModified(e)}},{key:"_groupTipsHandler",value:function(e){var t=this._sessionModule.getModule(xf);if(t){var n=e.event,o=e.dataList,r=e.isInstantMessage,i=void 0===r||r,a=e.isSyncingEnded;switch(n){case 4:case 6:t.onNewGroupTips({event:n,dataList:o});break;case 5:for(var s=0;s<o.length;s++)if($l(o[s].elements.revokedInfos))t.onGroupMessageRevoked({dataList:o});else if($l(o[s].elements.groupMessageReadNotice))t.onGroupMessageReadNotice({dataList:o});else{if(!$l(o[s].elements.readReceiptList)){t.onNewGroupSystemNotice({dataList:o,isInstantMessage:i,isSyncingEnded:a});break}t.onReadReceiptList({dataList:o})}break;case 12:this._sessionModule.getModule(Vf).onNewGroupAtTips({dataList:o});break;default:Pl.l("".concat(this._n,"._groupTipsHandler unknown event:").concat(n," dataList:"),o)}}}},{key:"_C2CNotifyMessageArrayHandler",value:function(e){var t=this,n=e.dataList;if($l(n)){var o=this._sessionModule.getModule(Uf);n.forEach((function(e){if(Xl(e))if(e.hasOwnProperty("kickoutMsgNotify")){var r=e.kickoutMsgNotify,i=r.kickType,a=r.newInstanceInfo,s=void 0===a?{}:a;1===i?t._sessionModule.onMultipleAccountKickedOut(s):2===i?t._sessionModule.onMultipleDeviceKickedOut(s):3===i&&t._sessionModule.onRestApiKickedOut(s)}else e.hasOwnProperty("c2cMessageRevokedNotify")?o&&o.onC2CMessageRevoked({dataList:n}):e.hasOwnProperty("c2cMessageReadReceipt")?o&&o.onC2CMessageReadReceipt({dataList:n}):e.hasOwnProperty("c2cMessageReadNotice")?o&&o.onC2CMessageReadNotice({dataList:n}):e.hasOwnProperty("muteNotificationsSync")&&t._sessionModule.getModule(Vf).onC2CMessageRemindTypeSynced({dataList:n})}))}}},{key:"_C2CReadReceiptArrayHandler",value:function(e){this._sessionModule.getModule(Uf).onReadReceiptList(e)}},{key:"_profileHandler",value:function(e){this._sessionModule.getModule(Gf).onProfileModified({dataList:e.dataList});var t=this._sessionModule.getModule(Ff);t&&t.onFriendProfileModified({dataList:e.dataList})}},{key:"_relationChainHandler",value:function(e){this._sessionModule.getModule(Gf).onRelationChainModified({dataList:e.dataList});var t=this._sessionModule.getModule(Ff);t&&t.onRelationChainModified({dataList:e.dataList})}},{key:"_recentContactHandler",value:function(e){var t=e.dataList;if($l(t)){var n=this._sessionModule.getModule(Vf);n&&t.forEach((function(e){var t=e.pushType;if(1===t){var o=e.recentContactDeleteItem;n.onConversationDeleted(o.recentContactList)}else if(2===t){var r=e.recentContactTopItem;n.onConversationPinned(r.recentContactList)}else if(3===t){var i=e.recentContactTopItem;n.onConversationUnpinned(i.recentContactList)}else if(4===t){var a=e.recentContactMarkContact;n.onConversationMarkUpdated(a.recentContactMarkContactItem)}else if(5===t){var s=e.recentContactCreateContactGroup;n.onConversationGroupCreated(s.msgContactGroupContactItem)}else if(6===t){var u=e.recentContactDelContactGroup;n.onConversationGroupDeleted(u.msgGroupItem)}else if(7===t){var c=e.recentContactUpdateContactGroup,l=c.updateType,d=c.msgUpdateGroup,p=c.msgUpdateContact;if(1===l){var f=d.updateGroupType;1===f?n.onConversationGroupNameUpdated(d):2===f&&n.onConversationInGroupUpdated(d)}else 2===l&&n.onConversationAddedToOrDeletedFromGroup(p)}}))}}},{key:"_allMessageReadHandler",value:function(e){var t=e.dataList,n=this._sessionModule.getModule(Vf);n&&n.onPushedAllMessageRead(t)}},{key:"_userStatusListHandler",value:function(e){this._sessionModule.getModule(Gf).onUserStatusUpdated(e)}},{key:"_messageExtensionNotifyHandler",value:function(e){this._sessionModule.getModule(Pf).onMessageExtensionNotify(e)}},{key:"onMessage",value:function(e){var t=this,n=e.body;if(this._filterMessageFromIMOpenPush(e)){var o=n.eventArray,r=n.isInstantMessage,i=n.isSyncingEnded,a=n.needSync;if($l(o))for(var s=null,u=null,c=0,l=0,d=o.length;l<d;l++){c=(s=o[l]).event;var p=Object.keys(s).find((function(e){return-1!==t._keys.indexOf(e)}));p?(u=14===c?{readAllC2CMessage:s[p],groupMessageReadInfoList:s.groupMessageReadNotice||[]}:16===c?{userID:s.userID,readReceiptList:s[p]}:s[p],this._eventHandlerMap.get(p)({event:c,dataList:u,isInstantMessage:r,isSyncingEnded:i,needSync:a})):Pl.l("".concat(this._n,".onMessage unknown eventItem:").concat(s))}}}},{key:"_filterMessageFromIMOpenPush",value:function(e){var t=e.head,n=e.body,o=t.servcmd,r=!1;if(Ql(o)||(r=o.includes(Gc.NAME.IM_CONFIG_MANAGER)||o.includes(Gc.NAME.OVERLOAD_PUSH)||o.includes(Gc.NAME.STAT_SERVICE)),!r)return!0;if(o.includes(Gc.CMD.PUSHED_CLOUD_CONTROL_CONFIG))this._sessionModule.getModule(eh).onPushedCloudControlConfig(n);else if(o.includes(Gc.CMD.PUSHED_COMMERCIAL_CONFIG))this._sessionModule.getModule(rh).onPushedConfig(n);else if(o.includes(Gc.CMD.OVERLOAD_NOTIFY))this._sessionModule.onPushedServerOverload(n);else if(o.includes(Gc.CMD.KICK_OTHER)){var i=Date.now();this._sessionModule.reLoginOnKickOther();var a=new s_("kickOther"),s=this._sessionModule.getModule(Of).getLastWsHelloTs(),u=i-s;a.setMessage("last wshello time:".concat(s," diff:").concat(u,"ms")).setNetworkType(this._sessionModule.getNetworkType()).end()}return!1}}]),e}(),Bb=[{cmd:Gc.CMD.GET_GROUP_INFO,interval:1,count:20},{cmd:Gc.CMD.GET_AVCHATROOM_MEMBER_LIST,interval:3,count:1},{cmd:Gc.CMD.GET_GROUP_APPLICATION,interval:1,count:1},{cmd:Gc.CMD.GET_TOPIC_LIST,interval:1,count:10},{cmd:Gc.CMD.SET_GROUP_ATTRIBUTES,interval:5,count:10},{cmd:Gc.CMD.MODIFY_GROUP_ATTRIBUTES,interval:5,count:10},{cmd:Gc.CMD.DELETE_GROUP_ATTRIBUTES,interval:5,count:10},{cmd:Gc.CMD.CLEAR_GROUP_ATTRIBUTES,interval:5,count:10},{cmd:Gc.CMD.GET_GROUP_ATTRIBUTES,interval:5,count:20},{cmd:Gc.CMD.UPDATE_GROUP_COUNTER,interval:5,count:20},{cmd:Gc.CMD.GET_GROUP_COUNTER,interval:5,count:20},{cmd:Gc.CMD.SET_ALL_MESSAGE_READ,interval:1,count:1},{cmd:Gc.CMD.GET_USER_STATUS,interval:5,count:20},{cmd:Gc.CMD.SUBSCRIBE_USER_STATUS,interval:5,count:20},{cmd:Gc.CMD.UNSUBSCRIBE_USER_STATUS,interval:5,count:20}],Vb=function(e){u(o,e);var n=m(o);function o(e){var t;return r(this,o),(t=n.call(this,e))._n="SessionModule",t._platform=t.getPlatform(),t._protocolHandler=new xb(g(t)),t._messageDispatcher=new qb(g(t)),t._commandFrequencyLimitMap=new Map,t._commandRequestInfoMap=new Map,t._serverOverloadInfoMap=new Map,t._init(),t.getInnerEmitterInstance().on(NI,t._onCloudConfigUpdated,g(t)),t}return a(o,[{key:"_init",value:function(){this._updateCommandFrequencyLimitMap(Bb)}},{key:"_onCloudConfigUpdated",value:function(){var e=this.getCloudConfig("cmd_frequency_limit");Ql(e)||(e=JSON.parse(e),this._updateCommandFrequencyLimitMap(e))}},{key:"_updateCommandFrequencyLimitMap",value:function(e){var t=this;e.forEach((function(e){t._commandFrequencyLimitMap.set(e.cmd,{interval:e.interval,count:e.count})}))}},{key:"updateProtocolConfig",value:function(){this._protocolHandler.update()}},{key:"request",value:function(e){Pl.d("".concat(this._n,".request options:"),e);var t=e.protocolName,n=e.tjgID;if(!this._protocolHandler.has(t))return Pl.w("".concat(this._n,".request unknown protocol:").concat(t)),vI({code:Lm});var o=this.getProtocolData(e),r=o.head.servcmd;if(this._isFrequencyOverLimit(r))return vI({code:Am});if(this._isServerOverload(r))return vI({code:zm});Hd(n)||(o.head.tjgID=n);var i=this.getModule($f);return Fb.includes(t)?i.simplySend(o):i.send(o)}},{key:"getKeyMap",value:function(e){return this._protocolHandler.getKeyMap(e)}},{key:"genCommonHead",value:function(){var e=this.getModule(Hf);return{ver:"v4",platform:this._platform,websdkappid:Dc,websdkversion:bc,a2:e.getA2Key()||void 0,tinyid:e.getTinyID()||void 0,status_instid:e.getStatusInstanceID(),sdkappid:e.getSDKAppID(),contenttype:e.getContentType(),reqtime:0,identifier:e.getA2Key()?void 0:e.getUserID(),usersig:e.getA2Key()?void 0:e.getUserSig(),sdkability:192371,tjgID:""}}},{key:"genCosSpecifiedHead",value:function(){var e=this.getModule(Hf);return{ver:"v4",platform:this._platform,websdkappid:Dc,websdkversion:bc,sdkappid:e.getSDKAppID(),contenttype:e.getContentType(),reqtime:0,identifier:e.getUserID(),usersig:e.getUserSig(),status_instid:e.getStatusInstanceID(),sdkability:192371}}},{key:"genSSOReportHead",value:function(){var e=this.getModule(Hf);return{ver:"v4",platform:this._platform,websdkappid:Dc,websdkversion:bc,sdkappid:e.getSDKAppID(),contenttype:"",reqtime:0,identifier:"",usersig:"",status_instid:e.getStatusInstanceID(),sdkability:192371}}},{key:"getProtocolData",value:function(e){return this._protocolHandler.getProtocolData(e)}},{key:"trans",value:function(e){var n=e.servcmd,o=e.data,r={head:t(t({},this.genCommonHead()),{},{servcmd:n}),body:o};return this.getModule($f).send(r)}},{key:"sendComboMessage",value:function(e){var n=e.servcmd,o=e.data,r={head:t(t({},this.genCommonHead()),{},{servcmd:n}),body:o};return this.getModule($f).send(r)}},{key:"onErrorCodeNotZero",value:function(e){var t=e.errorCode;if(t===jm){var n=e.kickType,o=e.newInstanceInfo,r=void 0===o?{}:o;1===n?this.onMultipleAccountKickedOut(r):2===n?this.onMultipleDeviceKickedOut(r):3===n&&this.onRestApiKickedOut(r)}t!==Hm&&t!==Km||(this._onUserSigExpired(),this.getModule($f).reConnect())}},{key:"onMessage",value:function(e){var t=e.body,n=t.needAck,o=void 0===n?0:n,r=t.sessionData;1===o&&this._sendACK(r),this._messageDispatcher.onMessage(e)}},{key:"onReconnected",value:function(){this._reLoginOnReconnected()}},{key:"reLoginOnKickOther",value:function(){Pl.l("".concat(this._n,".reLoginOnKickOther")),this._reLogin()}},{key:"_reLoginOnReconnected",value:function(){Pl.l("".concat(this._n,"._reLoginOnReconnected")),this._reLogin()}},{key:"_reLogin",value:function(){var e=this;if(this.isLoggedIn()){var t=0,n=this.getModule(ih);n.canIUseOfflinePush()&&(t=n.getUniAppPlatform()),this.request({protocolName:dh,requestData:{isWebUniapp:t}}).then((function(t){var n=t.data.instanceID;e.getModule(Hf).setStatusInstanceID(n),Pl.l("".concat(e._n,"._reLogin ok. start to sync unread messages")),e.getModule(Vf).syncConversationList().then((function(){e.getModule(nh).start()})),e.getModule(xf).updateLocalMainSequenceOnReconnected();var o=e.getModule(Bf);o.resetGetTopicTime(),o.getTopicListOnReconnected()}))}}},{key:"onMultipleAccountKickedOut",value:function(e){this.getModule(Of).onMultipleAccountKickedOut(e)}},{key:"onMultipleDeviceKickedOut",value:function(e){this.getModule(Of).onMultipleDeviceKickedOut(e)}},{key:"_onUserSigExpired",value:function(){this.getModule(Of).onUserSigExpired()}},{key:"onRestApiKickedOut",value:function(e){this.getModule(Of).onRestApiKickedOut(e)}},{key:"_sendACK",value:function(e){this.request({protocolName:zg,requestData:{sessionData:e}})}},{key:"_isFrequencyOverLimit",value:function(e){var t=e.split(".")[1];if(!this._commandFrequencyLimitMap.has(t))return!1;if(!this._commandRequestInfoMap.has(t))return this._commandRequestInfoMap.set(t,{startTime:Date.now(),requestCount:1}),!1;var n=this._commandFrequencyLimitMap.get(t),o=n.count,r=n.interval,i=this._commandRequestInfoMap.get(t),a=i.startTime,s=i.requestCount;if(Date.now()-a>1e3*r)return this._commandRequestInfoMap.set(t,{startTime:Date.now(),requestCount:1}),!1;s+=1,this._commandRequestInfoMap.set(t,{startTime:a,requestCount:s});var u=!1;return s>o&&(u=!0),u}},{key:"_isServerOverload",value:function(e){if(!this._serverOverloadInfoMap.has(e))return!1;var t=this._serverOverloadInfoMap.get(e),n=t.overloadTime,o=t.waitingTime,r=!1;return Date.now()-n<=1e3*o?r=!0:(this._serverOverloadInfoMap.delete(e),r=!1),r}},{key:"onPushedServerOverload",value:function(e){var t=e.overloadCommand,n=e.waitingTime;this._serverOverloadInfoMap.set(t,{overloadTime:Date.now(),waitingTime:n}),Pl.w("".concat(this._n,".onPushedServerOverload waitingTime:").concat(n,"s"))}},{key:"reset",value:function(){Pl.l("".concat(this._n,".reset")),this._updateCommandFrequencyLimitMap(Bb),this._commandRequestInfoMap.clear(),this._serverOverloadInfoMap.clear()}}]),o}(lh),Hb=function(e){u(n,e);var t=m(n);function n(e){var o;return r(this,n),(o=t.call(this,e))._n="MessageLossDetectionModule",o._maybeLostSequencesMap=new Map,o._firstRoundRet=[],o}return a(n,[{key:"onMessageMaybeLost",value:function(e,t,n){this._maybeLostSequencesMap.has(e)||this._maybeLostSequencesMap.set(e,[]);for(var o=this._maybeLostSequencesMap.get(e),r=0;r<n;r++)-1===o.indexOf(t+r)&&o.push(t+r)}},{key:"detectFirstRound",value:function(e,t){var n=this._maybeLostSequencesMap.get(e);if(!Hd(n)&&!Hd(t)){var o=n.filter((function(e){return-1===t.indexOf(e)}));0===o.length?Pl.i("".concat(this._n,".detectFirstRound no message loss. conversationID:").concat(e)):this._firstRoundRet=this._firstRoundRet.concat(o),n.length=0}}},{key:"detectSecondRound",value:function(e,t){if(!Hd(this._firstRoundRet)&&!Hd(t)){var n=this._firstRoundRet.filter((function(e){return-1===t.indexOf(e)}));this._firstRoundRet.length=0;var o,r=n.length;0!==r&&(r<=5?o=e+"-"+n.join("-"):(n.sort((function(e,t){return e-t})),o=e+" start:"+n[0]+" end:"+n[r-1]+" count:"+r),new s_("messageLoss").setMessage(o).setNetworkType(this.getNetworkType()).setLevel("warning").end(),Pl.i("".concat(this._n,".detectSecondRound message loss detected. conversationID:").concat(e," lostSequences:").concat(n)))}}},{key:"reset",value:function(){Pl.l("".concat(this._n,".reset")),this._maybeLostSequencesMap.clear(),this._firstRoundRet.length=0}}]),n}(lh),Kb=function(e){u(n,e);var t=m(n);function n(e){var o;return r(this,n),(o=t.call(this,e))._n="CloudControlModule",o._cloudConfig=new Map,o._expiredTime=0,o._version=0,o._isFetching=!1,o}return a(n,[{key:"getCloudConfig",value:function(e){return Ql(e)?this._cloudConfig:this._cloudConfig.has(e)?this._cloudConfig.get(e):void 0}},{key:"_canFetchConfig",value:function(){return this.isLoggedIn()&&!this._isFetching&&Date.now()>=this._expiredTime}},{key:"fetchConfig",value:function(){var e=this,t=this._canFetchConfig();if(Pl.l("".concat(this._n,".fetchConfig canFetchConfig:").concat(t)),t){var n=new s_("fetchCloudControlConfig"),o=this.getModule(Hf).getSDKAppID();this._isFetching=!0,this.request({protocolName:Jg,requestData:{SDKAppID:o,version:this._version}}).then((function(t){e._isFetching=!1,n.setMessage("version:".concat(e._version," newVersion:").concat(t.data.version," config:").concat(t.data.cloudControlConfig)).setNetworkType(e.getNetworkType()).end(),Pl.l("".concat(e._n,".fetchConfig ok")),e._parseCloudControlConfig(t.data)})).catch((function(t){e._isFetching=!1,e.probeNetwork().then((function(e){var o=_(e,2),r=o[0],i=o[1];n.setError(t,r,i).end()})),Pl.l("".concat(e._n,".fetchConfig failed. error:"),t),e._setExpiredTimeOnResponseError(12e4)}))}}},{key:"onPushedCloudControlConfig",value:function(e){Pl.l("".concat(this._n,".onPushedCloudControlConfig")),new s_("pushedCloudControlConfig").setNetworkType(this.getNetworkType()).setMessage("newVersion:".concat(e.version," config:").concat(e.cloudControlConfig)).end(),this._parseCloudControlConfig(e)}},{key:"onCheckTimer",value:function(e){this._canFetchConfig()&&this.fetchConfig()}},{key:"_parseCloudControlConfig",value:function(e){var t=this,n="".concat(this._n,"._parseCloudControlConfig"),o=e.errorCode,r=e.errorMessage,i=e.cloudControlConfig,a=e.version,s=e.expiredTime;if(0===o){if(this._version!==a){var u=null;try{u=JSON.parse(i)}catch(yD){this.isPrivateNetWork()||Pl.e("".concat(n," JSON parse error. cloudControlConfig:"),i)}u&&(this._cloudConfig.clear(),Object.keys(u).forEach((function(e){t._cloudConfig.set(e,u[e])})),this._version=a,this.emitInnerEvent(NI))}this._expiredTime=Date.now()+1e3*s}else Ql(o)?(Pl.l("".concat(n," failed. Invalid message format:"),e),this._setExpiredTimeOnResponseError(36e5)):(Pl.e("".concat(n," errorCode:").concat(o," errorMessage:").concat(r)),this._setExpiredTimeOnResponseError(12e4))}},{key:"_setExpiredTimeOnResponseError",value:function(e){this._expiredTime=Date.now()+e}},{key:"reset",value:function(){Pl.l("".concat(this._n,".reset")),this._cloudConfig.clear(),this._expiredTime=0,this._version=0,this._isFetching=!1}}]),n}(lh),jb=function(e){u(n,e);var t=m(n);function n(e){var o;return r(this,n),(o=t.call(this,e))._n="RecoverMessageModule",o.PULL_LIMIT_COUNT=15,o}return a(n,[{key:"start",value:function(){this._recoverGroupChat(),this._recoverC2CChat()}},{key:"_recoverGroupChat",value:function(){var e,t,n=this,o=this._getLocalConversationList().filter((function(e){return e.type===Ir.CONV_GROUP&&e.groupProfile.type!==Ir.GRP_AVCHATROOM})),r=this.getModule(Vf),i=0,a=0,s=0;o.forEach((function(o){var u=o.conversationID,c=o.lastMessage;t=u.replace(Ir.CONV_GROUP,""),e=r.getLocalLastMessage(u),c&&0!==c.lastSequence&&e?(a=c.lastSequence,i=e.sequence,s=a-i,i>0&&s>=1&&s<300?n._recoverGroupMessage({groupID:t,localLastMessageSequence:i,remoteLastMessageSequence:a}):n._getGroupNotify(t)):n._getGroupNotify(t)}))}},{key:"_recoverC2CChat",value:function(){var e,t=this,n=this._getLocalConversationList().filter((function(e){return e.type===Ir.CONV_C2C})),o=this.getModule(Vf),r=0,i=0,a=0,s=[Promise.resolve()];n.forEach((function(n){var u=n.conversationID,c=n.lastMessage;e=o.getLocalLastMessage(u),c&&0!==c.lastTime&&e&&(i=c.lastTime,r=e.time,a=i-r,r>0&&a>=1&&a<=600&&s.push(t._recoverC2CMessage({conversationID:u,localLastMessageTime:r,remoteLastMessageTime:i})))})),Promise.all(s).then((function(){Pl.l("".concat(t._n,"._recoverC2CChat all promise fulfilled, start to sync unread messages")),t.getModule(Jf).startSyncOnReconnected()}))}},{key:"_getLocalConversationList",value:function(){return this.getModule(Vf).getLocalConversationList()}},{key:"_recoverGroupMessage",value:function(e){var t=this,n="".concat(this._n,"._recoverGroupMessage");Pl.l("".concat(n," options:"),e);var o=e.groupID,r=e.localLastMessageSequence,i=e.remoteLastMessageSequence;this._getGroupRomaingMessage({groupID:o,sequence:r}).then((function(e){var r=e.data,a=r.complete,s=r.messageList;if(!Ql(s)){var u=s[0].sequence;Pl.l("".concat(n," pkgLastMessageSequence:").concat(u," complete:").concat(a)),u<i&&2!==a&&t._recoverGroupMessage({groupID:o,localLastMessageSequence:u,remoteLastMessageSequence:i}),new s_("recoverMessage").setNetworkType(t.getNetworkType()).setMessage("groupID:".concat(o," complete:").concat(a," messageList length:").concat(s.length)).end(),t.getModule(xf).onNewGroupMessage({dataList:s,isInstantMessage:!1,updateUnreadCount:!1}),t._getGroupNotify(o)}}))}},{key:"_getGroupNotify",value:function(e){this.getModule(xf).getGroupNotify(e)}},{key:"_getGroupRomaingMessage",value:function(e){var t=e.groupID,n=e.sequence;return this.request({protocolName:cg,requestData:{groupID:t,count:this.PULL_LIMIT_COUNT,sequence:n+this.PULL_LIMIT_COUNT-1}})}},{key:"_recoverC2CMessage",value:function(e){var t=this,n="".concat(this._n,"._recoverC2CMessage");Pl.l("".concat(this._n,"._recoverC2CMessage options:"),e);var o=e.conversationID,r=e.localLastMessageTime,i=e.remoteLastMessageTime;return this._getC2CRoamingMessage({conversationID:o,time:r}).then((function(e){var r=e.data,a=r.complete,s=r.messageList;if(!Ql(s)){new s_("recoverMessage").setNetworkType(t.getNetworkType()).setMessage("".concat(o," complete:").concat(a," messageList length:").concat(u)).end(),t.getModule(Uf).onNewC2CMessage({dataList:s,isInstantMessage:!0});var u=s.length,c=s[u-1].time;if(Pl.l("".concat(n," pkgLastMessageTime:").concat(c," complete:").concat(a)),c<i&&1!==a)return t._recoverC2CMessage({conversationID:o,localLastMessageTime:c,remoteLastMessageTime:i})}}))}},{key:"_getC2CRoamingMessage",value:function(e){var t=e.conversationID,n=e.time;return this.request({protocolName:Eh,requestData:{peerAccount:t.replace(Ir.CONV_C2C,""),count:this.PULL_LIMIT_COUNT+1,lastMessageTime:n,direction:1}})}},{key:"reset",value:function(){Pl.l("".concat(this._n,".reset"))}}]),n}(lh),zb=function(){function e(){r(this,e),this._n="AvgE2EDelay",this._e2eDelayArray=[]}return a(e,[{key:"addMessageDelay",value:function(e){var t=Rl()-e;t>=0&&this._e2eDelayArray.push(t)}},{key:"_calcAvg",value:function(e,t){if(0===t)return 0;var n=0;return e.forEach((function(e){n+=e})),Od(n/t,1)}},{key:"_calcCountWithLimit",value:function(e){var t=e.e2eDelayArray,n=e.min,o=e.max;return t.filter((function(e){return n<=e&&e<o})).length}},{key:"_calcPercent",value:function(e,t){var n=Od(e/t*100,2);return n>100&&(n=100),n}},{key:"_checkE2EDelayException",value:function(e,t){var n=e.filter((function(e){return e>t}));if(n.length>0){var o=n.length,r=Math.min.apply(Math,y(n)),i=Math.max.apply(Math,y(n)),a=this._calcAvg(n,o),s=Od(o/e.length*100,2);s>50&&new s_("messageE2EDelayException").setMessage("count:".concat(o," min:").concat(r," max:").concat(i," avg:").concat(a," percent:").concat(s)).setLevel("warning").end()}}},{key:"getStatResult",value:function(){var e=this._e2eDelayArray.length;if(0===e)return null;var t=y(this._e2eDelayArray),n=this._calcCountWithLimit({e2eDelayArray:t,min:0,max:1}),o=this._calcCountWithLimit({e2eDelayArray:t,min:1,max:3}),r=this._calcPercent(n,e),i=this._calcPercent(o,e),a=this._calcAvg(t,e);return this._checkE2EDelayException(t,3),t.length=0,this.reset(),{totalCount:e,countLessThan1Second:n,percentOfCountLessThan1Second:r,countLessThan3Second:o,percentOfCountLessThan3Second:i,avgDelay:a}}},{key:"reset",value:function(){this._e2eDelayArray.length=0}}]),e}(),Zb=function(){function e(){r(this,e),this._n="AvgRTT",this._requestCount=0,this._rttArray=[]}return a(e,[{key:"addRequestCount",value:function(){this._requestCount+=1}},{key:"addRTT",value:function(e){this._rttArray.push(e)}},{key:"_calcTotalCount",value:function(){return this._requestCount}},{key:"_calcRTTCount",value:function(e){return e.length}},{key:"_calcSuccessRateOfRequest",value:function(e,t){if(0===t)return 0;var n=Od(e/t*100,2);return n>100&&(n=100),n}},{key:"_calcAvg",value:function(e,t){if(0===t)return 0;var n=0;return e.forEach((function(e){n+=e})),parseInt(n/t)}},{key:"_calcMax",value:function(){return Math.max.apply(Math,y(this._rttArray))}},{key:"_calcMin",value:function(){return Math.min.apply(Math,y(this._rttArray))}},{key:"getStatResult",value:function(){var e=this._calcTotalCount(),t=y(this._rttArray);if(0===e)return null;var n=this._calcRTTCount(t),o=this._calcSuccessRateOfRequest(n,e),r=this._calcAvg(t,n);return Pl.l("".concat(this._n,".getStatResult max:").concat(this._calcMax()," min:").concat(this._calcMin()," avg:").concat(r)),this.reset(),{totalCount:e,rttCount:n,successRateOfRequest:o,avgRTT:r}}},{key:"reset",value:function(){this._requestCount=0,this._rttArray.length=0}}]),e}(),Wb=function(){function e(){r(this,e),this._map=new Map}return a(e,[{key:"initMap",value:function(e){var t=this;e.forEach((function(e){t._map.set(e,{totalCount:0,successCount:0,failedCountOfUserSide:0,costArray:[],fileSizeArray:[]})}))}},{key:"addTotalCount",value:function(e){return!(Ql(e)||!this._map.has(e))&&(this._map.get(e).totalCount+=1,!0)}},{key:"addSuccessCount",value:function(e){return!(Ql(e)||!this._map.has(e))&&(this._map.get(e).successCount+=1,!0)}},{key:"addFailedCountOfUserSide",value:function(e){return!(Ql(e)||!this._map.has(e))&&(this._map.get(e).failedCountOfUserSide+=1,!0)}},{key:"addCost",value:function(e,t){return!(Ql(e)||!this._map.has(e))&&(this._map.get(e).costArray.push(t),!0)}},{key:"addFileSize",value:function(e,t){return!(Ql(e)||!this._map.has(e))&&(this._map.get(e).fileSizeArray.push(t),!0)}},{key:"_calcSuccessRateOfBusiness",value:function(e){if(Ql(e)||!this._map.has(e))return-1;var t=this._map.get(e),n=Od(t.successCount/t.totalCount*100,2);return n>100&&(n=100),n}},{key:"_calcSuccessRateOfPlatform",value:function(e){if(Ql(e)||!this._map.has(e))return-1;var t=this._map.get(e),n=this._calcSuccessCountOfPlatform(e)/t.totalCount*100;return(n=Od(n,2))>100&&(n=100),n}},{key:"_calcTotalCount",value:function(e){return Ql(e)||!this._map.has(e)?-1:this._map.get(e).totalCount}},{key:"_calcSuccessCountOfBusiness",value:function(e){return Ql(e)||!this._map.has(e)?-1:this._map.get(e).successCount}},{key:"_calcSuccessCountOfPlatform",value:function(e){if(Ql(e)||!this._map.has(e))return-1;var t=this._map.get(e);return t.successCount+t.failedCountOfUserSide}},{key:"_calcAvg",value:function(e){return Ql(e)||!this._map.has(e)?-1:e===Qm?this._calcAvgSpeed(e):this._calcAvgCost(e)}},{key:"_calcAvgCost",value:function(e){var t=this._map.get(e).costArray.length;if(0===t)return 0;var n=0;return this._map.get(e).costArray.forEach((function(e){n+=e})),parseInt(n/t)}},{key:"_calcAvgSpeed",value:function(e){var t=0,n=0;return this._map.get(e).costArray.forEach((function(e){t+=e})),this._map.get(e).fileSizeArray.forEach((function(e){n+=e})),parseInt(1e3*n/t)}},{key:"getStatResult",value:function(e){var t=this._calcTotalCount(e);if(0===t)return null;var n=this._calcSuccessCountOfBusiness(e),o=this._calcSuccessRateOfBusiness(e),r=this._calcSuccessCountOfPlatform(e),i=this._calcSuccessRateOfPlatform(e),a=this._calcAvg(e);return this.reset(e),{totalCount:t,successCountOfBusiness:n,successRateOfBusiness:o,successCountOfPlatform:r,successRateOfPlatform:i,avgValue:a}}},{key:"reset",value:function(e){Ql(e)?this._map.clear():this._map.set(e,{totalCount:0,successCount:0,failedCountOfUserSide:0,costArray:[],fileSizeArray:[]})}}]),e}(),Yb=function(){function e(){r(this,e),this._lastMap=new Map,this._currentMap=new Map}return a(e,[{key:"initMap",value:function(e){var t=this;e.forEach((function(e){t._lastMap.set(e,new Map),t._currentMap.set(e,new Map)}))}},{key:"addMessageSequence",value:function(e){var t=e.key,n=e.message;if(Ql(t)||!this._lastMap.has(t)||!this._currentMap.has(t))return!1;var o=n.conversationID,r=n.sequence,i=o.replace(Ir.CONV_GROUP,"");if(0===this._lastMap.get(t).size)this._addCurrentMap(e);else if(this._lastMap.get(t).has(i)){var a=this._lastMap.get(t).get(i),s=a.length-1;r>a[0]&&r<a[s]?(a.push(r),a.sort(),this._lastMap.get(t).set(i,a)):this._addCurrentMap(e)}else this._addCurrentMap(e);return!0}},{key:"_addCurrentMap",value:function(e){var t=e.key,n=e.message,o=n.conversationID,r=n.sequence,i=o.replace(Ir.CONV_GROUP,"");this._currentMap.get(t).has(i)||this._currentMap.get(t).set(i,[]),this._currentMap.get(t).get(i).push(r)}},{key:"_copyData",value:function(e){if(!Ql(e)){this._lastMap.set(e,new Map);var t,n=this._lastMap.get(e),o=S(this._currentMap.get(e));try{for(o.s();!(t=o.n()).done;){var r=_(t.value,2),i=r[0],a=r[1];n.set(i,a)}}catch(u){o.e(u)}finally{o.f()}n=null,this._currentMap.set(e,new Map)}}},{key:"getStatResult",value:function(e){if(Ql(this._currentMap.get(e))||Ql(this._lastMap.get(e)))return null;if(0===this._lastMap.get(e).size)return this._copyData(e),null;var t=0,n=0;if(this._lastMap.get(e).forEach((function(e,o){var r=y(e.values()),i=r.length,a=r[i-1]-r[0]+1;t+=a,n+=i})),0===t)return null;var o=Od(n/t*100,2);return o>100&&(o=100),this._copyData(e),{totalCount:t,successCountOfMessageReceived:n,successRateOfMessageReceived:o}}},{key:"reset",value:function(){this._currentMap.clear(),this._lastMap.clear()}}]),e}(),Jb=function(e){u(o,e);var n=m(o);function o(e){var t;r(this,o),(t=n.call(this,e))._n="QualityStatModule",t.TAG="im-ssolog-quality-stat",t.reportIndex=0,t.wholePeriod=!1,t._qualityItems=[Zm,Wm,Ym,Jm,Xm,$m,Qm,e_,t_,n_],t._messageSentItems=[Ym,Jm,Xm,$m,Qm],t._messageReceivedItems=[e_,t_,n_],t.REPORT_INTERVAL=120,t.REPORT_SDKAPPID_BLACKLIST=[],t.REPORT_TINYID_WHITELIST=[],t._statInfoArr=[],t._avgRTT=new Zb,t._avgE2EDelay=new zb,t._rateMessageSent=new Wb,t._rateMessageReceived=new Yb;var i=t.getInnerEmitterInstance();return i.on(OI,t._onLoginSuccess,g(t)),i.on(NI,t._onCloudConfigUpdated,g(t)),t}return a(o,[{key:"_onLoginSuccess",value:function(){var e=this;this._rateMessageSent.initMap(this._messageSentItems),this._rateMessageReceived.initMap(this._messageReceivedItems);var t=this.getModule(Kf),n=t.getItem(this.TAG,!1);!Hd(n)&&td(n.forEach)&&(Pl.l("".concat(this._n,"._onLoginSuccess get quality stat logs from local storage, count:").concat(n.length)),n.forEach((function(t){e._statInfoArr.push(t)})),t.removeItem(this.TAG,!1))}},{key:"_onCloudConfigUpdated",value:function(){var e=this.getCloudConfig("q_rpt_interval"),t=this.getCloudConfig("q_rpt_sdkappid_bl"),n=this.getCloudConfig("q_rpt_tinyid_wl");Ql(e)||(this.REPORT_INTERVAL=Number(e)),Ql(t)||(this.REPORT_SDKAPPID_BLACKLIST=t.split(",").map((function(e){return Number(e)}))),Ql(n)||(this.REPORT_TINYID_WHITELIST=n.split(","))}},{key:"onCheckTimer",value:function(e){this.isLoggedIn()&&e%this.REPORT_INTERVAL==0&&(this.wholePeriod=!0,this._report())}},{key:"addRequestCount",value:function(){this._avgRTT.addRequestCount()}},{key:"addRTT",value:function(e){this._avgRTT.addRTT(e)}},{key:"addMessageDelay",value:function(e){this._avgE2EDelay.addMessageDelay(e)}},{key:"addTotalCount",value:function(e){this._rateMessageSent.addTotalCount(e)||Pl.w("".concat(this._n,".addTotalCount invalid key:"),e)}},{key:"addSuccessCount",value:function(e){this._rateMessageSent.addSuccessCount(e)||Pl.w("".concat(this._n,".addSuccessCount invalid key:"),e)}},{key:"addFailedCountOfUserSide",value:function(e){this._rateMessageSent.addFailedCountOfUserSide(e)||Pl.w("".concat(this._n,".addFailedCountOfUserSide invalid key:"),e)}},{key:"addCost",value:function(e,t){this._rateMessageSent.addCost(e,t)||Pl.w("".concat(this._n,".addCost invalid key or cost:"),e,t)}},{key:"addFileSize",value:function(e,t){this._rateMessageSent.addFileSize(e,t)||Pl.w("".concat(this._n,".addFileSize invalid key or size:"),e,t)}},{key:"addMessageSequence",value:function(e){this._rateMessageReceived.addMessageSequence(e)||Pl.w("".concat(this._n,".addMessageSequence invalid key:"),e.key)}},{key:"_getQualityItem",value:function(e){var n={},o=i_[this.getNetworkType()];Ql(o)&&(o=8);var r={qualityType:o_[e],timestamp:Al(),networkType:o,extension:""};switch(e){case Zm:n=this._avgRTT.getStatResult();break;case Wm:n=this._avgE2EDelay.getStatResult();break;case Ym:case Jm:case Xm:case $m:case Qm:n=this._rateMessageSent.getStatResult(e);break;case e_:case t_:case n_:n=this._rateMessageReceived.getStatResult(e)}return null===n?null:t(t({},r),n)}},{key:"_report",value:function(e){var t=this,n=[],o=null;Ql(e)?this._qualityItems.forEach((function(e){null!==(o=t._getQualityItem(e))&&(o.reportIndex=t.reportIndex,o.wholePeriod=t.wholePeriod,n.push(o))})):null!==(o=this._getQualityItem(e))&&(o.reportIndex=this.reportIndex,o.wholePeriod=this.wholePeriod,n.push(o)),Pl.d("".concat(this._n,"._report"),n),this._statInfoArr.length>0&&(n=n.concat(this._statInfoArr),this._statInfoArr=[]);var r=this.getModule(Hf),i=r.getSDKAppID(),a=r.getTinyID();Nd(this.REPORT_SDKAPPID_BLACKLIST,i)&&!Pd(this.REPORT_TINYID_WHITELIST,a)&&(n=[]),n.length>0&&this._doReport(n)}},{key:"_doReport",value:function(e){var n=this,o={header:BC(this),quality:e};this.request({protocolName:Vg,requestData:t({},o)}).then((function(){n.reportIndex++,n.wholePeriod=!1})).catch((function(t){Pl.w("".concat(n._n,"._doReport, online:").concat(n.getNetworkType()," error:"),t),n._statInfoArr=n._statInfoArr.concat(e),n._flushAtOnce()}))}},{key:"_flushAtOnce",value:function(){var e=this.getModule(Kf),t=e.getItem(this.TAG,!1),n=this._statInfoArr,o="".concat(this._n,"._flushAtOnce");if(Hd(t))Pl.l("".concat(o," count:").concat(n.length)),e.setItem(this.TAG,n,!0,!1);else{var r=n.concat(t);r.length>10&&(r=r.slice(0,10)),Pl.l("".concat(o," count:").concat(r.length)),e.setItem(this.TAG,r,!0,!1)}this._statInfoArr=[]}},{key:"reset",value:function(){Pl.l("".concat(this._n,".reset")),this._report(),this.reportIndex=0,this.wholePeriod=!1,this.REPORT_SDKAPPID_BLACKLIST=[],this.REPORT_TINYID_WHITELIST=[],this._avgRTT.reset(),this._avgE2EDelay.reset(),this._rateMessageSent.reset(),this._rateMessageReceived.reset()}}]),o}(lh),Xb=function(e){u(n,e);var t=m(n);function n(e){var o;return r(this,n),(o=t.call(this,e))._n="WorkerTimerModule",o._isWorkerEnabled=!0,o._workerTimer=null,o._init(),o.getInnerEmitterInstance().on(NI,o._onCloudConfigUpdated,g(o)),o}return a(n,[{key:"isWorkerEnabled",value:function(){return this._isWorkerEnabled&&Ml}},{key:"startWorkerTimer",value:function(){Pl.l("".concat(this._n,".startWorkerTimer")),this._workerTimer&&this._workerTimer.postMessage("start")}},{key:"stopWorkerTimer",value:function(){Pl.l("".concat(this._n,".stopWorkerTimer")),this._workerTimer&&this._workerTimer.postMessage("stop")}},{key:"_init",value:function(){if(Ml){var e=URL.createObjectURL(new Blob(['let interval = -1;onmessage = function(event) {  if (event.data === "start") {    if (interval > 0) {      clearInterval(interval);    }    interval = setInterval(() => {      postMessage("");    }, 1000)  } else if (event.data === "stop") {    clearInterval(interval);    interval = -1;  }};'],{type:"application/javascript; charset=utf-8"}));this._workerTimer=new Worker(e);var t=this;this._workerTimer.onmessage=function(){t._m.onCheckTimer()}}}},{key:"_onCloudConfigUpdated",value:function(){var e=this.getCloudConfig("enable_worker");Pl.l("".concat(this._n,"._onCloudConfigUpdated enableWorker:").concat(e)),Ql(e)||"1"===e?!this._isWorkerEnabled&&Ml&&(this._isWorkerEnabled=!0,this.startWorkerTimer(),this._m.onWorkerTimerEnabled()):this._isWorkerEnabled&&Ml&&(this._isWorkerEnabled=!1,this.stopWorkerTimer(),this._m.onWorkerTimerDisabled())}},{key:"terminate",value:function(){Pl.l("".concat(this._n,".terminate")),this._workerTimer&&(this._workerTimer.terminate(),this._workerTimer=null)}},{key:"reset",value:function(){Pl.l("".concat(this._n,".reset"))}}]),n}(lh),$b=function(){function e(){r(this,e),this._n="PurchasedFeatureHandler",this._purchasedFeatureMap=new Map}return a(e,[{key:"isValidPurchaseBits",value:function(e){return e&&"string"==typeof e&&e.length>=1&&e.length<=64&&/[01]{1,64}/.test(e)}},{key:"parsePurchaseBits",value:function(e){var t="".concat(this._n,".parsePurchaseBits");if(this.isValidPurchaseBits(e)){this._purchasedFeatureMap.clear();for(var n=null,o=e.length-1,r=0;o>=0;o--,r++)n=r<32?new kc(0,Math.pow(2,r)).toString():new kc(Math.pow(2,r-32),0).toString(),"1"===e[o]?this._purchasedFeatureMap.set(n,!0):this._purchasedFeatureMap.set(n,!1)}else Pl.w("".concat(t," invalid purchase bits:").concat(e))}},{key:"hasPurchasedFeature",value:function(e){return!!this._purchasedFeatureMap.get(e)}},{key:"isFeatureEnabled",value:function(e){for(var t=parseInt(e).toString(2),n=void 0,o=!0,r=t.length-1,i=0;r>=0;r--,i++)if("1"===t.charAt(r)&&(n=i<32?new kc(0,Math.pow(2,i)).toString():new kc(Math.pow(2,i-32),0).toString(),!this._purchasedFeatureMap.get(n))){o=!1;break}return Pl.l("".concat(this._n,".isFeatureEnabled decimalNumber:").concat(e," binaryString:").concat(t," ret:").concat(o)),gI({enabled:o})}},{key:"clear",value:function(){this._purchasedFeatureMap.clear()}}]),e}(),Qb=function(){function e(t){r(this,e),this._m=t,this._n="CommercialConfigModule",this._expiredTime=0,this._isFetching=!1,this._purchasedFeatureHandler=new $b}return a(e,[{key:"_canFetch",value:function(){return this._getModule(Hf).isLoggedIn()?!this._isFetching&&Date.now()>=this._expiredTime:(this._expiredTime=Date.now()+2e3,!1)}},{key:"onCheckTimer",value:function(e){this._canFetch()&&this.fetchConfig()}},{key:"fetchConfig",value:function(){var e=this,t=this._canFetch(),n="".concat(this._n,".fetchConfig");if(Pl.l("".concat(n," canFetch:").concat(t)),t){var o=this._getModule(zf),r=new s_("fetchCommercialConfig");r.setNetworkType(o.getNetworkType());var i=this._getModule(Hf).getSDKAppID(),a=this._getModule(Xf);this._isFetching=!0,a.request({protocolName:$g,requestData:{SDKAppID:i}}).then((function(t){r.setMessage("purchaseBits:".concat(t.data.purchaseBits)).end(),Pl.l("".concat(n," ok.")),e._parseConfig(t.data),e._isFetching=!1})).catch((function(t){o.probe().then((function(e){var n=_(e,2),o=n[0],i=n[1];r.setError(t,o,i).end()})),e._isFetching=!1}))}}},{key:"onPushedConfig",value:function(e){var t="".concat(this._n,".onPushedConfig");Pl.l("".concat(t)),new s_("pushedCommercialConfig").setNetworkType(this._getModule(zf).getNetworkType()).setMessage("purchaseBits:".concat(e.purchaseBits)).end(),this._parseConfig(e)}},{key:"_parseConfig",value:function(e){var t="".concat(this._n,"._parseConfig"),n=e.errorCode,o=e.errorMessage,r=e.purchaseBits,i=e.expiredTime;0===n?(this._purchasedFeatureHandler.parsePurchaseBits(r),this._expiredTime=Date.now()+1e3*i):Ql(n)?(Pl.l("".concat(t," failed. Invalid message format:"),e),this._setExpiredTimeOnResponseError(36e5)):(Pl.e("".concat(t," errorCode:").concat(n," errorMessage:").concat(o)),this._setExpiredTimeOnResponseError(12e4))}},{key:"_setExpiredTimeOnResponseError",value:function(e){this._expiredTime=Date.now()+e}},{key:"canIUse",value:function(e){return this._purchasedFeatureHandler.hasPurchasedFeature(e)}},{key:"isFeatureEnabled",value:function(e){return this._purchasedFeatureHandler.isFeatureEnabled(e)}},{key:"_getModule",value:function(e){return this._m.getModule(e)}},{key:"reset",value:function(){Pl.l("".concat(this._n,".reset")),this._expiredTime=0,this._isFetching=!1,this._purchasedFeatureHandler.clear()}}]),e}(),eD=function(e){u(n,e);var t=m(n);function n(e){var o;return r(this,n),(o=t.call(this,e))._m=e,o._n="OfflinePushModule",o._offlinePushPlugin=void 0,o._androidPushConfig={huaweiPushBussinessId:"",xiaomiPushBussinessId:"",xiaomiPushAppId:"",xiaomiPushAppKey:"",meizuPushBussinessId:"",meizuPushAppId:"",meizuPushAppKey:"",vivoPushBussinessId:"",fcmPushBussinessId:"",oppoPushBussinessId:"",oppoPushAppKey:"",oppoPushAppSecret:"",honorPushBussinessId:""},o._deviceToken="",o._businessID=0,o._iosBusinessID=0,o._c2cUnreadCount=0,o._groupUnreadCount=0,o._isWebUniapp=0,o}return a(n,[{key:"registerPlugin",value:function(e){if(Qc){this._offlinePushPlugin=e["tim-offline-push-plugin"];var t=e.offlinePushConfig||{},n=t.huaweiBusinessID,o=t.xiaomiBusinessID,r=t.xiaomiAppID,i=t.xiaomiAppKey,a=t.meizuBusinessID,s=t.meizuAppID,u=t.meizuAppKey,c=t.vivoBusinessID,l=t.oppoBusinessID,d=t.oppoAppKey,p=t.oppoAppSecret,f=t.honorBusinessID,h=t.iosBusinessID;this._androidPushConfig.huaweiPushBussinessId=n,this._androidPushConfig.xiaomiPushBussinessId=o,this._androidPushConfig.xiaomiPushAppId=r,this._androidPushConfig.xiaomiPushAppKey=i,this._androidPushConfig.meizuPushBussinessId=a,this._androidPushConfig.meizuPushAppId=s,this._androidPushConfig.meizuPushAppKey=u,this._androidPushConfig.vivoPushBussinessId=c,this._androidPushConfig.oppoPushBussinessId=l,this._androidPushConfig.oppoPushAppKey=d,this._androidPushConfig.oppoPushAppSecret=p,this._androidPushConfig.honorPushBussinessId=f,new s_("registerPlugin").setMessage("tim-offline-push-plugin").setMoreMessage("isExist:".concat(!Ql(this._offlinePushPlugin))).end(!0),Pl.l("".concat(this._n,".").concat("registerPlugin"," ok. offlinePushConfig:").concat(JSON.stringify(e.offlinePushConfig))),this._iosBusinessID=h,this._setAppShowListener()}else this.outputWarning("OfflinePushInUniapp")}},{key:"init",value:function(){this._isWebUniapp=this.getUniAppPlatform(),this._getDeviceToken()}},{key:"_getDeviceToken",value:function(){var e=this,t="".concat(this._n,".").concat("_getDeviceToken");if(td(this._offlinePushPlugin.getDeviceToken)){var n="androidPushConfig:".concat(JSON.stringify(this._androidPushConfig),", iosBusinessID:").concat(this._iosBusinessID);Pl.l("".concat(t," start. ").concat(n)),new s_("_getDeviceToken").setMessage("".concat(n)).end(!0),this._offlinePushPlugin.getDeviceToken(this._androidPushConfig,(function(o){var r=new s_("getDeviceTokenRes"),i=o.code,a=o.msg;if(0===i){var s=o.data,u=s.deviceToken,c=s.deviceBrand,l=s.deviceType,d=s.bussinessId;e._deviceToken=u,e._businessID=d||e._iosBusinessID,n="deviceToken:".concat(u,", deviceBrand:").concat(c||l,", businessID:").concat(e._businessID),Pl.l("".concat(t," ok. ").concat(n)),r.setMessage(n).end(!0),e._setToken()}else r.setMessage("code:".concat(i,", msg:").concat(a)).end(!0),Pl.e("".concat(t," failed. error:"),o)}))}else Pl.e("".concat(t," getDeviceToken is not a function"))}},{key:"canIUseOfflinePush",value:function(){return Qc&&!Ql(this._offlinePushPlugin)}},{key:"_setAppShowListener",value:function(){var e=this,t="".concat(this._n,".").concat("_setAppShowListener");Ql(this._offlinePushPlugin)?Pl.e("".concat(t," offlinePushPlugin is undefined")):td(this._offlinePushPlugin.setAppShowListener)?(new s_("_setAppShowListener").end(!0),Pl.l("".concat(t," start")),this._offlinePushPlugin.setAppShowListener((function(n){var o=(n||{}).appShow;new s_("setAppShowListenerRes").setMessage("appShow:".concat(o)).end(!0),Pl.l("".concat(t," ok. appShow:").concat(o)),e._m.isReady()&&(0===o?(e._getConvUnreadCount(),e._onBackground()):1===o&&e._onForeground())}))):Pl.e("".concat(t," setAppShowListener is not a function"))}},{key:"getDeviceBrand",value:function(){if(!Ql(this._offlinePushPlugin)&&td(this._offlinePushPlugin.getDeviceType)){var e=(this._offlinePushPlugin.getDeviceType()||{}).deviceType;return Pl.l("".concat(this._n,".getDeviceBrand ok. deviceType:").concat(e)),e}}},{key:"_setToken",value:function(){var e,t=this,n="".concat(this._n,"._setToken"),o=this.getModule(Hf),r=1,i="",a="";Hd(this._deviceToken)&&(r=0);var s=this.getUniAppPlatform(),u=this.getDeviceBrand();s===Sc.IOS||s===Sc.IPAD||s===Sc.MAC?a=this._deviceToken:s===Sc.ANDROID&&(i=this._deviceToken);var c=new s_("offlinePushSetToken");return e="deviceToken:".concat(a||i,", businessID:").concat(this._businessID,", ")+"deviceBrand:".concat(u,", isWebUniapp:").concat(this._isWebUniapp,", pushMsg:").concat(r,", platform:").concat(s),c.setMessage("".concat(e)),Pl.l("".concat(n," ").concat(e)),this.request({protocolName:dv,requestData:{tokenID:i,pushMsg:r,sdkAppID:o.getSDKAppID(),businessID:parseInt(this._businessID),deviceBrand:u,deviceToken:a,isWebUniapp:this._isWebUniapp}}).then((function(e){return c.end(),Pl.l("".concat(n," ok")),e})).catch((function(e){return t.probeNetwork().then((function(t){var n=_(t,2),o=n[0],r=n[1];c.setError(e,o,r).end()})),Pl.e("".concat(n," failed. error:"),e),vI(e)}))}},{key:"_getConvUnreadCount",value:function(){var e=this;this._c2cUnreadCount=0,this._groupUnreadCount=0,this.getModule(Vf).getLocalConversationList().forEach((function(t){t.type===Ir.CONV_C2C&&(e._c2cUnreadCount+=t.unreadCount),t.type===Ir.CONV_GROUP&&(e._groupUnreadCount+=t.unreadCount)}))}},{key:"_onBackground",value:function(){var e=this,t="".concat(this._n,".").concat("_onBackground"),n=new s_("_onBackground");this.request({protocolName:cv,requestData:{c2cUnreadCount:this._c2cUnreadCount,groupUnreadCount:this._groupUnreadCount,isWebUniapp:this._isWebUniapp}}).then((function(o){return n.setMessage("c2cUnreadCount: ".concat(e._c2cUnreadCount,", groupUnreadCount: ").concat(e._groupUnreadCount)).end(),Pl.l("".concat(t," ok")),o})).catch((function(o){e.probeNetwork().then((function(e){var t=_(e,2),r=t[0],i=t[1];n.setError(o,r,i).end()})),Pl.e("".concat(t," failed. error:"),o)}))}},{key:"_onForeground",value:function(){var e=this,t="".concat(this._n,".").concat("_onForeground"),n=new s_("_onForeground");this.request({protocolName:lv,requestData:{isWebUniapp:this._isWebUniapp}}).then((function(e){return n.end(),Pl.l("".concat(t," ok")),e})).catch((function(o){e.probeNetwork().then((function(e){var t=_(e,2),r=t[0],i=t[1];n.setError(o,r,i).end()})),Pl.e("".concat(t," failed. error:"),o)}))}},{key:"getUniAppPlatform",value:function(){var e=uni.getSystemInfoSync().platform,t=this.getDeviceBrand();return"ios"===e?Sc.IOS:"android"===e?Sc.ANDROID:1002===t?Sc.IPAD:1001===t?Sc.MAC:void 0}},{key:"reset",value:function(){this._deviceToken="",this._businessID=0,this._c2cUnreadCount=0,this._groupUnreadCount=0,this._isWebUniapp=0,Pl.l("".concat(this._n,".reset"))}}]),n}(lh),tD=function(e){u(n,e);var t=m(n);function n(e){var o;return r(this,n),(o=t.call(this,e))._n="ProfanityFilterModule",o._plugin=null,o._filterConfigMap=new Map,o._startIndex=0,o._version=0,o._canIUseLexicon=!1,o._isFetching=!1,o._expiredTime=0,o}return a(n,[{key:"init",value:function(){var e=this.getModule(Yf).getPlugin("tim-profanity-filter-plugin");e?(this._plugin=new e({logger:Pl,isArray:$l,isMap:zl,isDevMode:this.isDevMode()}),this._getLexicon()):this.outputWarning("ProfanityPluginNotFound")}},{key:"onCheckTimer",value:function(){this._plugin&&this._canIUseLexicon&&this.isLoggedIn()&&!this._isFetching&&Date.now()>=this._expiredTime&&this._getLexicon()}},{key:"filterMessage",value:function(e,t){var n=!0;if(!this._plugin||!this._canIUseLexicon)return n;if(t&&t.messageControlInfo&&!0===t.messageControlInfo.excludedFromContentModeration)return n;var o=e.type,r=e.conversationType;if(o!==Ir.MSG_TEXT&&o!==Ir.MSG_CUSTOM)return n;var i,a="".concat(this._n,".filterMessage");if(Pl.l("".concat(a)),o===Ir.MSG_TEXT){if(r===Ir.CONV_C2C?i=xc:r===Ir.CONV_GROUP&&(i=qc),!this._isConfigOn(i))return n;var s=this._plugin.filter(e.payload.text),u=s.type,c=s.modifiedText;1===u?n=!1:2===u&&(e.payload.text=c)}else if(o===Ir.MSG_CUSTOM){if(r===Ir.CONV_C2C?i=Fc:r===Ir.CONV_GROUP&&(i=Bc),!this._isConfigOn(i))return n;var l=this._plugin.filter(e.payload.data),d=this._plugin.filter(e.payload.description),p=this._plugin.filter(e.payload.extension);1===l.type||1===d.type||1===p.type?n=!1:(2===l.type&&(e.payload.data=l.modifiedText),2===d.type&&(e.payload.description=d.modifiedText),2===p.type&&(e.payload.extension=p.modifiedText))}return Pl.l("".concat(a," done. isAllowedToSend:").concat(n)),n}},{key:"filterText",value:function(e,t){var n="".concat(this._n,".filterText"),o={isAllowedToSend:!0,modifiedText:e};if(!this._plugin||!this._canIUseLexicon)return o;if(!this._isConfigOn(t))return o;Pl.l("".concat(n));var r=this._plugin.filter(e),i=r.type,a=r.modifiedText;return 1===i?o.isAllowedToSend=!1:2===i&&(o.modifiedText=a),Pl.l("".concat(n," done. ret:"),o),o}},{key:"_getLexicon",value:function(){var e=this,t=new s_("profanityFilter"),n="".concat(this._n,"._getLexicon");this._isFetching=!0,this.request({protocolName:pv,requestData:{startIndex:this._startIndex,version:this._version}}).then((function(o){var r=o.data,i=r.errorInfo,a=r.filterConfig,s=r.lexicon,u=r.strToken,c=r.completeFlag,l=r.nextStartIndex,d=r.version,p=r.expiredTime,f=i.errorCode,h=i.errorMessage;return 0!==f?(e._isFetching=!1,Pl.w("".concat(n," failed. error:"),i),void t.setCode(f).setMessage(h).end()):(e._onFilterConfig(a),e._getToken(u),1===c?(Pl.l("".concat(n," done. version:").concat(d," expiredTime:").concat(p)),e._version=d,e._canIUseLexicon=!0,e._isFetching=!1,e._expiredTime=Date.now()+1e3*p,void e._plugin.onLexiconCompleted(s)):(e._startIndex=l,e._plugin.onLexiconSliced(s),void e._getLexicon()))})).catch((function(o){e.probeNetwork().then((function(e){var n=_(e,2),r=n[0],i=n[1];t.setError(o,r,i).end()})),e._isFetching=!1,Pl.l("".concat(n," failed. error:"),o)}))}},{key:"_onFilterConfig",value:function(e){var t=this;Hd(e)||(this._filterConfigMap.clear(),Object.keys(e).forEach((function(n){t._filterConfigMap.set(n,e[n])})),Pl.l("".concat(this._n,"._onFilterConfig. keys:").concat(Array.from(this._filterConfigMap.keys())," values:").concat(Array.from(this._filterConfigMap.values()))))}},{key:"_isConfigOn",value:function(e){return 1===this._filterConfigMap.get(e)}},{key:"_getToken",value:function(e){if(Yl(e)){var t=e.length,n="";if(t%2==0)for(var o=0;o<=t-1;o+=2)n+=e[o+1],n+=e[o];else{for(var r=0;r<t-1;r+=2)n+=e[r+1],n+=e[r];n+=e[t-1]}this._plugin.onToken(n)}}},{key:"reset",value:function(){Pl.l("".concat(this._n,".reset")),this._plugin&&(this._plugin.reset(),this._plugin=null),this._filterConfigMap.clear(),this._startIndex=0,this._version=0,this._canIUseLexicon=!1,this._isFetching=!1,this._expiredTime=0}}]),n}(lh),nD=function(){function e(t){r(this,e),this._m=t,this._n="TransCmdModule"}return a(e,[{key:"sendTRTCCustomData",value:function(e){return this._trans(t({serv:Gc.NAME.TUIROOM_SVR},e))}},{key:"_trans",value:function(e){Pl.l("".concat(this._n,"._trans. options:").concat(JSON.stringify(e)));var t=e.serv,n=e.data;return this._m.getModule(Xf).trans({servcmd:"".concat(t,".*"),data:Yl(n)?JSON.parse(n):n})}},{key:"reset",value:function(){Pl.l("".concat(this._n,".reset"))}}]),e}(),oD=xe("replace"),rD=RegExp.prototype,iD=R.TypeError,aD=j(ri),sD=j("".indexOf),uD=(j("".replace),j("".slice)),cD=Math.max,lD=function(e,t,n){return n>e.length?-1:""===t?n:sD(e,t,n)};on({target:"String",proto:!0},{replaceAll:function(e,t){var n,o,r,i,a,s,u,c,l=Q(this),d=0,p=0,f="";if(null!=e){if(Wi(e)&&(n=pn(Q("flags"in rD?e.flags:aD(e))),!~sD(n,"g")))throw iD("`.replaceAll` does not allow non-global regexes");if(o=Me(e,oD))return G(o,e,l,t)}for(r=pn(l),i=pn(e),(a=te(t))||(t=pn(t)),s=i.length,u=cD(1,s),d=lD(r,i,0);-1!==d;)c=a?pn(t(i,d,r)):Aa(i,r,d,[],void 0,t),f+=uD(r,p,d)+c,p=d+s,d=lD(r,i,d+u);return p<r.length&&(f+=uD(r,p)),f}});var dD=function(){function e(t){r(this,e),this._m=t,this._n="ErrorMessageModule",this.TIM_ERROR_ASSISTANCE="tim_error_assistance",this.STORAGE_EXPIRES_TIME=6048e5,this._map=new Map,this._init()}return a(e,[{key:"_init",value:function(){var e=this._getStorageModule().getItem(this.TIM_ERROR_ASSISTANCE,!1);if(e){var t=JSON.parse(e);this._needToUpdate(t)?this._fetch():this._fillMap(t.message)}else this._fetch()}},{key:"_needToUpdate",value:function(e){var t=e.localSavedTime,n=e.localSavedVersion,o=t&&(new Date).getTime()-t>=this.STORAGE_EXPIRES_TIME,r=!n||"2.26.3"!==n;return Pl.l("".concat(this._n,"._needToUpdate isTimeout:").concat(o," isDifferentVersion:").concat(r)),o||r}},{key:"_fetch",value:function(){if(!this._m.getModule(Hf).isPrivateNetWork()){var e="https://web.sdk.qcloud.com/im/download/error-message/0.0.1/tim-error-message.txt",t="application/x-www-form-urlencoded;charset=UTF-8",n="".concat(this._n,"._fetch ok in"),o=this;if(tl)ol.request({url:e,method:"GET",timeout:3e3,header:{"content-type":t},success:function(e){o._fillAndSave(e.data),Pl.l("".concat(n," mini program"))},fail:function(){}});else{var r=new XMLHttpRequest,i=setTimeout((function(){r.abort()}),3e3);r.onreadystatechange=function(){4===r.readyState&&(clearTimeout(i),200!==r.status&&304!==r.status||(Pl.l("".concat(n," browser")),o._fillAndSave(r.responseText)))},r.open("GET",e,!0),r.setRequestHeader("Content-type",t),r.send()}}}},{key:"_fillAndSave",value:function(e){this._fillMap(e),this._getStorageModule().setItem(this.TIM_ERROR_ASSISTANCE,JSON.stringify({message:e,localSavedTime:(new Date).getTime(),localSavedVersion:"2.26.3"}),!0,!1)}},{key:"_getStorageModule",value:function(){return this._m.getModule(Kf)}},{key:"_fillMap",value:function(e){this._map.clear();for(var t,n,o,r=e.split(";\n"),i=r.length,a=0;a<i;a++)if(t=r[a].indexOf(":"),n=r[a].slice(0,t),o=r[a].slice(t+1,r[a].length),!n.startsWith("//")){if(Ql(o))continue;this._map.set(n,o.replaceAll("'",""))}}},{key:"get",value:function(e){var t=e.isIntl,n=e.key,o=e.replacement1,r=e.replacement2,i="".concat(n,t?"_en":"_cn");!this._map.has(i)&&this._map.has(n)&&(i=n);var a="";return this._map.has(i)?(a=this._map.get(i),Ql(o)||(a=a.replace("$replacement1",o)),Ql(r)||(a=a.replace("$replacement2",r)),a):a}},{key:"reset",value:function(){Pl.l("".concat(this._n,".reset"))}}]),e}(),pD=function(){function e(t){r(this,e);var n=new s_("sdkConstruct");this._n="ModuleManager",this._isReady=!1,this._reason=yv,this._startLoginTs=0,this._moduleMap=new Map,this._innerEmitter=null,this._outerEmitter=null,this._checkCount=0,this._checkTimer=-1,this._moduleMap.set(Hf,new PC(this,t)),this._moduleMap.set(rh,new Qb(this)),this._moduleMap.set(eh,new Kb(this)),this._moduleMap.set(th,new Xb(this)),this._moduleMap.set(oh,new Jb(this)),this._moduleMap.set($f,new Pb(this)),this._moduleMap.set(Xf,new Vb(this)),this._moduleMap.set(Of,new GC(this)),this._moduleMap.set(Nf,new ok(this)),this._moduleMap.set(Pf,new rk(this)),this._moduleMap.set(uh,new ik(this)),this._moduleMap.set(Gf,new NC(this)),this._moduleMap.set(Uf,new mI(this)),this._moduleMap.set(Vf,new nC(this)),this._moduleMap.set(xf,new CC(this)),this._moduleMap.set(qf,new TC(this)),this._moduleMap.set(Bf,new EC(this)),this._moduleMap.set(Kf,new FC(this)),this._moduleMap.set(ch,new dD(this)),this._moduleMap.set(jf,new VC(this)),this._moduleMap.set(zf,new zC(this)),this._moduleMap.set(Zf,new WC(this)),this._moduleMap.set(Wf,new JC(this)),this._moduleMap.set(Yf,new ak(this)),this._moduleMap.set(Jf,new sk(this)),this._moduleMap.set(Qf,new Hb(this)),this._moduleMap.set(nh,new jb(this)),this._moduleMap.set(ih,new eD(this)),this._moduleMap.set(ah,new tD(this)),this._moduleMap.set(sh,new nD(this)),this._eventThrottleMap=new Map;var o=t.instanceID,i=t.oversea,a=t.SDKAppID,s="instanceID:".concat(o," SDKAppID:").concat(a," host:").concat(Ed()," oversea:").concat(i," inBrowser:").concat(nl," inMiniApp:").concat(tl)+" workerAvailable:".concat(Ml," UserAgent:").concat(il);s_.bindEventStatModule(this._moduleMap.get(jf)),n.setMessage("".concat(s," ").concat(function(){var e="";if(tl)try{var t=ol.getSystemInfoSync(),n=t.model,o=t.version,r=t.system,i=t.platform,a=t.SDKVersion;e="model:".concat(n," version:").concat(o," system:").concat(r," platform:").concat(i," SDKVersion:").concat(a)}catch(yD){e=""}return e}())).end(),Pl.i("SDK ".concat(s)),pI.prototype._getErrorMessage=this.getErrorMessage.bind(this),this._readyList=void 0,this._ssoLogForReady=null,this._initReadyList()}return a(e,[{key:"_startTimer",value:function(){var e=this._moduleMap.get(th),t=e.isWorkerEnabled();Pl.l("".concat(this._n,".startTimer isWorkerEnabled:").concat(t," seed:").concat(this._checkTimer)),t?e.startWorkerTimer():this._startMainThreadTimer()}},{key:"_startMainThreadTimer",value:function(){this._checkTimer<0&&(this._checkTimer=setInterval(this.onCheckTimer.bind(this),1e3)),Pl.l("".concat(this._n,"._startMainThreadTimer seed:").concat(this._checkTimer))}},{key:"stopTimer",value:function(){var e=this._moduleMap.get(th),t=e.isWorkerEnabled();Pl.l("".concat(this._n,".stopTimer isWorkerEnabled:").concat(t," seed:").concat(this._checkTimer)),t?e.stopWorkerTimer():this._stopMainThreadTimer()}},{key:"_stopMainThreadTimer",value:function(){Pl.l("".concat(this._n,"._stopMainThreadTimer")),this._checkTimer>0&&(clearInterval(this._checkTimer),this._checkTimer=-1,this._checkCount=0)}},{key:"_stopMainThreadSocket",value:function(){Pl.l("".concat(this._n,"._stopMainThreadSocket"));var e=this._moduleMap.get($f);e.setIsWorkerEnabled(!0),e.reConnect()}},{key:"_startMainThreadSocket",value:function(){Pl.l("".concat(this._n,"._startMainThreadSocket"));var e=this._moduleMap.get($f);e.setIsWorkerEnabled(!1),e.reConnect()}},{key:"onWorkerTimerEnabled",value:function(){Pl.l("".concat(this._n,".onWorkerTimerEnabled, disable main thread timer and socket")),this._stopMainThreadTimer(),this._stopMainThreadSocket()}},{key:"onWorkerTimerDisabled",value:function(){Pl.l("".concat(this._n,".onWorkerTimerDisabled, enable main thread timer and socket")),this._startMainThreadTimer(),this._startMainThreadSocket()}},{key:"onCheckTimer",value:function(){this._checkCount+=1;var e,t=S(this._moduleMap);try{for(t.s();!(e=t.n()).done;){var n=_(e.value,2)[1];n.onCheckTimer&&n.onCheckTimer(this._checkCount)}}catch(r){t.e(r)}finally{t.f()}}},{key:"_initReadyList",value:function(){var e=this;this._readyList=[this._moduleMap.get(Of),this._moduleMap.get(Vf)],this._readyList.forEach((function(t){t.ready((function(){return e._onModuleReady()}))}))}},{key:"_onModuleReady",value:function(){var e=!0;if(this._readyList.forEach((function(t){t.isReady()||(e=!1)})),e&&!this._isReady){this._isReady=!0,this._outerEmitter.emit(Mr.SDK_READY);var t=Date.now()-this._startLoginTs;Pl.w("SDK is ready. cost ".concat(t," ms")),this._startLoginTs=Date.now();var n=this._moduleMap.get(zf).getNetworkType(),o=this._ssoLogForReady.getStartTs()+El;this._ssoLogForReady.setNetworkType(n).setMessage(t).start(o).end()}}},{key:"login",value:function(){0===this._startLoginTs&&(Ll(),this._startLoginTs=Date.now(),this._startTimer(),this._moduleMap.get(zf).start(),this._ssoLogForReady=new s_("sdkReady"),this._reason=Om)}},{key:"onLoginFailed",value:function(){this._startLoginTs=0}},{key:"getOuterEmitterInstance",value:function(){return null===this._outerEmitter&&(this._outerEmitter=new ZC,hI(this._outerEmitter),this._outerEmitter._emit=this._outerEmitter.emit,this._outerEmitter.emit=function(e,t){var n=this;if(e===Mr.CONVERSATION_LIST_UPDATED||e===Mr.FRIEND_LIST_UPDATED||e===Mr.GROUP_LIST_UPDATED||e===Mr.TOTAL_UNREAD_MESSAGE_COUNT_UPDATED)if(this._eventThrottleMap.has(e)){var o=Date.now(),r=this._eventThrottleMap.get(e);o-r.last<1e3?(r.timeoutID&&clearTimeout(r.timeoutID),r.timeoutID=setTimeout((function(){r.last=o,n._outerEmitter._emit.apply(n._outerEmitter,[e,{name:e,data:n._getEventData(e)}])}),500)):(r.last=o,this._outerEmitter._emit.apply(this._outerEmitter,[e,{name:e,data:this._getEventData(e)}]))}else this._eventThrottleMap.set(e,{last:Date.now(),timeoutID:-1}),this._outerEmitter._emit.apply(this._outerEmitter,[e,{name:e,data:this._getEventData(e)}]);else this._outerEmitter._emit.apply(this._outerEmitter,[e,{name:e,data:arguments[1]}])}.bind(this)),this._outerEmitter}},{key:"_getEventData",value:function(e){return e===Mr.CONVERSATION_LIST_UPDATED?this._moduleMap.get(Vf).getLocalConversationList():e===Mr.FRIEND_LIST_UPDATED?this._moduleMap.get(Ff).getLocalFriendList(!1):e===Mr.GROUP_LIST_UPDATED?this._moduleMap.get(xf).getLocalGroupList():e===Mr.TOTAL_UNREAD_MESSAGE_COUNT_UPDATED?this._moduleMap.get(Vf).getTotalUnreadMessageCount():void 0}},{key:"getInnerEmitterInstance",value:function(){return null===this._innerEmitter&&(this._innerEmitter=new ZC,this._innerEmitter._emit=this._innerEmitter.emit,this._innerEmitter.emit=function(e,t){var n;n=Xl(arguments[1])&&arguments[1].data?[e,{name:arguments[0],data:arguments[1].data}]:[e,{name:arguments[0],data:arguments[1]}],this._innerEmitter._emit.apply(this._innerEmitter,n)}.bind(this)),this._innerEmitter}},{key:"hasModule",value:function(e){return this._moduleMap.has(e)}},{key:"getModule",value:function(e){return this._moduleMap.get(e)}},{key:"isReady",value:function(){return this._isReady}},{key:"isIntl",value:function(){return this.getModule(Hf).isIntl()}},{key:"getNotReadyReason",value:function(){return this._reason}},{key:"setNotReadyReason",value:function(e){this._reason=e}},{key:"getErrorMessage",value:function(e,t,n){return this._moduleMap.get(ch).get({key:e,replacement1:t,replacement2:n,isIntl:this.isIntl()})}},{key:"outputWarning",value:function(e,t,n){var o=this.getErrorMessage(e,t,n);o&&Pl.w(o)}},{key:"onError",value:function(e){var t="code:".concat(e.code," message:").concat(e.message);Pl.w("Oops! ".concat(t)),new s_("error").setMessage(t).setNetworkType(this.getModule(zf).getNetworkType()).setLevel("error").end(),this.getOuterEmitterInstance().emit(Mr.ERROR,e)}},{key:"restartTimer",value:function(){Pl.l("".concat(this._n,".restartTimer")),this.stopTimer(),this._startTimer(),this.getModule(xf).restartPolling()}},{key:"reset",value:function(){Pl.l("".concat(this._n,".reset")),Ll();var e,t=S(this._moduleMap);try{for(t.s();!(e=t.n()).done;){var n=_(e.value,2)[1];n.reset&&n.reset()}}catch(s){t.e(s)}finally{t.f()}this._startLoginTs=0,this._initReadyList(),this._isReady=!1,this.stopTimer(),this._outerEmitter.emit(Mr.SDK_NOT_READY);var o,r=S(this._eventThrottleMap);try{for(r.s();!(o=r.n()).done;){var i=_(o.value,2)[1];i.timeoutID&&clearTimeout(i.timeoutID)}}catch(s){r.e(s)}finally{r.f()}this._eventThrottleMap.clear()}}]),e}(),fD=function(){function e(t){r(this,e),this._funcMap=new Map,this._m=t}return a(e,[{key:"defense",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;if("string"!=typeof e)return null;if(0===e.length)return null;if("function"!=typeof t)return null;if(this._funcMap.has(e)&&this._funcMap.get(e).has(t))return this._funcMap.get(e).get(t);this._funcMap.has(e)||this._funcMap.set(e,new Map);var o=null;return this._funcMap.get(e).has(t)?o=this._funcMap.get(e).get(t):(o=this._pack(e,t,n),this._funcMap.get(e).set(t,o)),o}},{key:"defenseOnce",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;return"function"!=typeof t?null:this._pack(e,t,n)}},{key:"find",value:function(e,t){return"string"!=typeof e||0===e.length||"function"!=typeof t?null:this._funcMap.has(e)&&this._funcMap.get(e).has(t)?this._funcMap.get(e).get(t):(this._m.outputWarning("ListenerFnNotFound",e),null)}},{key:"delete",value:function(e,t){return"function"==typeof t&&!!this._funcMap.has(e)&&!!this._funcMap.get(e).has(t)&&(this._funcMap.get(e).delete(t),0===this._funcMap.get(e).size&&this._funcMap.delete(e),!0)}},{key:"_pack",value:function(e,t,n){var o=this;return function(){try{t.apply(n,Array.from(arguments))}catch(c){var r=Object.values(Mr).indexOf(e),i="CallbackError";if(-1!==r){var a=Object.keys(Mr)[r];o._m.outputWarning(i,a,c)}new s_(i).setMessage("eventName:".concat(e)).setMoreMessage(c.message).end()}}}}]),e}(),hD=function(){function e(t){r(this,e);var n={SDKAppID:t.SDKAppID,unlimitedAVChatRoom:t.unlimitedAVChatRoom||!1,scene:t.scene||"",oversea:t.oversea||!1,instanceID:Dd(),devMode:t.devMode||!1,proxyServer:t.proxyServer||void 0};this._m=new pD(n),this._safetyCallbackFactory=new fD(this._m)}return a(e,[{key:"onError",value:function(e){this._m.onError(e)}},{key:"login",value:function(e){return this._m.login(),this._getModule(Of).login(e)}},{key:"logout",value:function(){var e=this;return this._getModule(Of).logout().then((function(t){return e._m.reset(),t}))}},{key:"isReady",value:function(){return this._m.isReady()}},{key:"isIntl",value:function(){return this._m.isIntl()}},{key:"getNotReadyReason",value:function(){return this._m.getNotReadyReason()}},{key:"getErrorMessage",value:function(e,t,n){return this._m.getErrorMessage(e,t,n)}},{key:"_getModule",value:function(e){return this._m.getModule(e)}},{key:"destroy",value:function(){var e=this;return this.logout().finally((function(){e._m.stopTimer(),e._getModule(th).terminate(),e._getModule($f).dealloc();var t=e._m.getOuterEmitterInstance(),n=e._getModule(Hf);t.emit(Mr.SDK_DESTROY,{SDKAppID:n.getSDKAppID()})}))}},{key:"on",value:function(e,t,n){Pl.d("on","eventName:".concat(e)),this._m.getOuterEmitterInstance().on(e,this._safetyCallbackFactory.defense(e,t,n),n)}},{key:"once",value:function(e,t,n){Pl.d("once","eventName:".concat(e)),this._m.getOuterEmitterInstance().once(e,this._safetyCallbackFactory.defenseOnce(e,t,n),n||this)}},{key:"off",value:function(e,t,n,o){Pl.d("off","eventName:".concat(e));var r=this._safetyCallbackFactory.find(e,t);null!==r&&(this._m.getOuterEmitterInstance().off(e,r,n,o),this._safetyCallbackFactory.delete(e,t))}},{key:"registerPlugin",value:function(e){Ql(e["tim-offline-push-plugin"])?this._getModule(Yf).registerPlugin(e):this._getModule(ih).registerPlugin(e)}},{key:"setLogLevel",value:function(e){if(e<=0){var t=this.getErrorMessage("TIM_ASCII_ART");t&&console.log(t);var n=this.getErrorMessage("API_REFER");n&&(qd()?console.log("%c ".concat("IM SDK API ->"," %c"),"background:#ff9d00; padding:1px; border-radius:3px; color: #fff","background:transparent",n):console.log("IM SDK API ->",n));var o=this.getErrorMessage("DOCS_GUIDE");o&&console.log(o)}Pl.setLevel(e)}},{key:"createTextMessage",value:function(e){return this._getModule(Nf).createTextMessage(e)}},{key:"createTextAtMessage",value:function(e){return this._getModule(Nf).createTextMessage(e)}},{key:"createImageMessage",value:function(e){return this._getModule(Nf).createImageMessage(e)}},{key:"createAudioMessage",value:function(e){return this._getModule(Nf).createAudioMessage(e)}},{key:"createVideoMessage",value:function(e){return this._getModule(Nf).createVideoMessage(e)}},{key:"createCustomMessage",value:function(e){return this._getModule(Nf).createCustomMessage(e)}},{key:"createFaceMessage",value:function(e){return this._getModule(Nf).createFaceMessage(e)}},{key:"createFileMessage",value:function(e){return this._getModule(Nf).createFileMessage(e)}},{key:"createLocationMessage",value:function(e){return this._getModule(Nf).createLocationMessage(e)}},{key:"createMergerMessage",value:function(e){return this._getModule(Nf).createMergerMessage(e)}},{key:"downloadMergerMessage",value:function(e){return e.type!==Ir.MSG_MERGER?vI({code:Wv}):Hd(e.payload.downloadKey)?vI({code:Yv}):this._getModule(Nf).downloadMergerMessage(e).catch((function(e){return vI({code:Jv})}))}},{key:"createForwardMessage",value:function(e){return this._getModule(Nf).createForwardMessage(e)}},{key:"sendMessage",value:function(e,t){return e instanceof lI?this._getModule(Nf).sendMessageInstance(e,t):vI({code:Sv})}},{key:"callExperimentalAPI",value:function(e,t){return"sendComboMessage"===e?this._getModule(uh).sendMessage(t):"handleGroupInvitation"===e?this._getModule(xf).handleGroupInvitation(t):"isCommercialAbilityEnabled"===e?this._getModule(rh).isFeatureEnabled(t):"isIntl"===e?this.isIntl():"sendTRTCCustomData"===e?this._getModule(sh).sendTRTCCustomData(t):vI({code:Em})}},{key:"revokeMessage",value:function(e){return this._getModule(Nf).revokeMessage(e)}},{key:"resendMessage",value:function(e){return this._getModule(Nf).resendMessage(e)}},{key:"deleteMessage",value:function(e){return this._getModule(Nf).deleteMessage(e)}},{key:"translateText",value:function(e){return this._getModule(Nf).translateText(e)}},{key:"setMessageExtensions",value:function(e,t){return this._getModule(Pf).setMessageExtensions(e,t)}},{key:"getMessageExtensions",value:function(e){return this._getModule(Pf).getMessageExtensions(e)}},{key:"deleteMessageExtensions",value:function(e,t){return this._getModule(Pf).deleteMessageExtensions(e,t)}},{key:"modifyMessage",value:function(e){return this._getModule(Nf).modifyRemoteMessage(e)}},{key:"getMessageList",value:function(e){return this._getModule(Vf).getMessageList(e)}},{key:"getMessageListHopping",value:function(e){return this._getModule(Vf).getMessageListHopping(e)}},{key:"sendMessageReadReceipt",value:function(e){return this._getModule(Vf).sendReadReceipt(e)}},{key:"getMessageReadReceiptList",value:function(e){return this._getModule(Vf).getReadReceiptList(e)}},{key:"getGroupMessageReadMemberList",value:function(e){return this._getModule(xf).getReadReceiptDetail(e)}},{key:"findMessage",value:function(e){return this._getModule(Vf).findMessage(e)}},{key:"setMessageRead",value:function(e){return this._getModule(Vf).setMessageRead(e)}},{key:"getConversationList",value:function(e){return this._getModule(Vf).getConversationList(e)}},{key:"getConversationProfile",value:function(e){return this._getModule(Vf).getConversationProfile(e)}},{key:"deleteConversation",value:function(e){return this._getModule(Vf).deleteConversation(e)}},{key:"clearHistoryMessage",value:function(e){return this._getModule(Vf).clearHistoryMessage(e)}},{key:"pinConversation",value:function(e){return this._getModule(Vf).pinConversation(e)}},{key:"setAllMessageRead",value:function(e){return this._getModule(Vf).setAllMessageRead(e)}},{key:"setMessageRemindType",value:function(e){return this._getModule(Vf).setMessageRemindType(e)}},{key:"getTotalUnreadMessageCount",value:function(){return this._getModule(Vf).getTotalUnreadMessageCount()}},{key:"setConversationCustomData",value:function(e){return this._getModule(Vf).setConversationCustomData(e)}},{key:"markConversation",value:function(e){return this._getModule(Vf).markConversation(e)}},{key:"getConversationGroupList",value:function(){return this._getModule(Vf).getConversationGroupList()}},{key:"createConversationGroup",value:function(e){return this._getModule(Vf).createConversationGroup(e)}},{key:"deleteConversationGroup",value:function(e){return this._getModule(Vf).deleteConversationGroup(e)}},{key:"renameConversationGroup",value:function(e){return this._getModule(Vf).renameConversationGroup(e)}},{key:"addConversationsToGroup",value:function(e){return this._getModule(Vf).addConversationsToGroup(e)}},{key:"deleteConversationsFromGroup",value:function(e){return this._getModule(Vf).deleteConversationsFromGroup(e)}},{key:"getMyProfile",value:function(){return this._getModule(Gf).getMyProfile()}},{key:"getUserProfile",value:function(e){return this._getModule(Gf).getUserProfile(e)}},{key:"updateMyProfile",value:function(e){return this._getModule(Gf).updateMyProfile(e)}},{key:"getBlacklist",value:function(){return this._getModule(Gf).getLocalBlacklist()}},{key:"addToBlacklist",value:function(e){return this._getModule(Gf).addBlacklist(e)}},{key:"removeFromBlacklist",value:function(e){return this._getModule(Gf).deleteBlacklist(e)}},{key:"setSelfStatus",value:function(e){return this._getModule(Gf).setSelfStatus(e)}},{key:"getUserStatus",value:function(e){return this._getModule(Gf).getUserStatus(e)}},{key:"subscribeUserStatus",value:function(e){return this._getModule(Gf).subscribeUserStatus(e)}},{key:"unsubscribeUserStatus",value:function(e){return this._getModule(Gf).unsubscribeUserStatus(e)}},{key:"getFriendList",value:function(){var e=this._getModule(Ff);return e?e.getLocalFriendList():vI({code:Rm})}},{key:"addFriend",value:function(e){var t=this._getModule(Ff);return t?t.addFriend(e):vI({code:Rm})}},{key:"deleteFriend",value:function(e){var t=this._getModule(Ff);return t?t.deleteFriend(e):vI({code:Rm})}},{key:"checkFriend",value:function(e){var t=this._getModule(Ff);return t?t.checkFriend(e):vI({code:Rm})}},{key:"getFriendProfile",value:function(e){var t=this._getModule(Ff);return t?t.getFriendProfile(e):vI({code:Rm})}},{key:"updateFriend",value:function(e){var t=this._getModule(Ff);return t?t.updateFriend(e):vI({code:Rm})}},{key:"getFriendApplicationList",value:function(){var e=this._getModule(Ff);return e?e.getLocalFriendApplicationList():vI({code:Rm})}},{key:"acceptFriendApplication",value:function(e){var t=this._getModule(Ff);return t?t.acceptFriendApplication(e):vI({code:Rm})}},{key:"refuseFriendApplication",value:function(e){var t=this._getModule(Ff);return t?t.refuseFriendApplication(e):vI({code:Rm})}},{key:"deleteFriendApplication",value:function(e){var t=this._getModule(Ff);return t?t.deleteFriendApplication(e):vI({code:Rm})}},{key:"setFriendApplicationRead",value:function(){var e=this._getModule(Ff);return e?e.setFriendApplicationRead():vI({code:Rm})}},{key:"getFriendGroupList",value:function(){var e=this._getModule(Ff);return e?e.getLocalFriendGroupList():vI({code:Rm})}},{key:"createFriendGroup",value:function(e){var t=this._getModule(Ff);return t?t.createFriendGroup(e):vI({code:Rm})}},{key:"deleteFriendGroup",value:function(e){var t=this._getModule(Ff);return t?t.deleteFriendGroup(e):vI({code:Rm})}},{key:"addToFriendGroup",value:function(e){var t=this._getModule(Ff);return t?t.addToFriendGroup(e):vI({code:Rm})}},{key:"removeFromFriendGroup",value:function(e){var t=this._getModule(Ff);return t?t.removeFromFriendGroup(e):vI({code:Rm})}},{key:"renameFriendGroup",value:function(e){var t=this._getModule(Ff);return t?t.renameFriendGroup(e):vI({code:Rm})}},{key:"getGroupList",value:function(e){return this._getModule(xf).getGroupList(e)}},{key:"getGroupProfile",value:function(e){return this._getModule(xf).getGroupProfile(e)}},{key:"createGroup",value:function(e){return this._getModule(xf).createGroup(e)}},{key:"dismissGroup",value:function(e){return this._getModule(xf).dismissGroup(e)}},{key:"updateGroupProfile",value:function(e){return this._getModule(xf).updateGroupProfile(e)}},{key:"joinGroup",value:function(e){return this._getModule(xf).joinGroup(e)}},{key:"quitGroup",value:function(e){return this._getModule(xf).quitGroup(e)}},{key:"searchGroupByID",value:function(e){return this._getModule(xf).searchGroupByID(e)}},{key:"getGroupOnlineMemberCount",value:function(e){return this._getModule(xf).getGroupOnlineMemberCount(e)}},{key:"changeGroupOwner",value:function(e){return this._getModule(xf).changeGroupOwner(e)}},{key:"getGroupApplicationList",value:function(){return this._getModule(xf).getGroupApplicationList()}},{key:"handleGroupApplication",value:function(e){return this._getModule(xf).handleGroupApplication(e)}},{key:"initGroupAttributes",value:function(e){return this._getModule(xf).initGroupAttributes(e)}},{key:"setGroupAttributes",value:function(e){return this._getModule(xf).setGroupAttributes(e)}},{key:"deleteGroupAttributes",value:function(e){return this._getModule(xf).deleteGroupAttributes(e)}},{key:"getGroupAttributes",value:function(e){return this._getModule(xf).getGroupAttributes(e)}},{key:"setGroupCounters",value:function(e){return this._getModule(xf).setGroupCounters(e)}},{key:"increaseGroupCounter",value:function(e){return this._getModule(xf).increaseGroupCounter(e)}},{key:"decreaseGroupCounter",value:function(e){return this._getModule(xf).decreaseGroupCounter(e)}},{key:"getGroupCounters",value:function(e){return this._getModule(xf).getGroupCounters(e)}},{key:"getGroupMemberList",value:function(e){return this._getModule(qf).getGroupMemberList(e)}},{key:"getGroupMemberProfile",value:function(e){return this._getModule(qf).getGroupMemberProfile(e)}},{key:"addGroupMember",value:function(e){return this._getModule(qf).addGroupMember(e)}},{key:"deleteGroupMember",value:function(e){return this._getModule(qf).deleteGroupMember(e)}},{key:"setGroupMemberMuteTime",value:function(e){return this._getModule(qf).setGroupMemberMuteTime(e)}},{key:"setGroupMemberRole",value:function(e){return this._getModule(qf).setGroupMemberRole(e)}},{key:"setGroupMemberNameCard",value:function(e){return this._getModule(qf).setGroupMemberNameCard(e)}},{key:"setGroupMemberCustomField",value:function(e){return this._getModule(qf).setGroupMemberCustomField(e)}},{key:"markGroupMemberList",value:function(e){return this._getModule(qf).markGroupMemberList(e)}},{key:"getJoinedCommunityList",value:function(){return this._getModule(Bf).getJoinedCommunityList()}},{key:"createTopicInCommunity",value:function(e){return this._getModule(Bf).createTopicInCommunity(e)}},{key:"deleteTopicFromCommunity",value:function(e){return this._getModule(Bf).deleteTopicFromCommunity(e)}},{key:"updateTopicProfile",value:function(e){return this._getModule(Bf).updateTopicProfile(e)}},{key:"getTopicList",value:function(e){return this._getModule(Bf).getTopicList(e)}}]),e}(),gD={login:1,logout:1,destroy:1,on:1,off:1,ready:1,setLogLevel:1,joinGroup:1,quitGroup:1,registerPlugin:1,getGroupOnlineMemberCount:1};function vD(e,t){if(e.isReady()||1===gD[t])return!0;var n=e.getNotReadyReason(),o={code:n,message:"".concat(e.getErrorMessage(n)," | ").concat(t," | ").concat(e.getErrorMessage(wm))};return e.onError(o),o}var mD={},_D={create:function(e){var n=0,o=e.SDKAppID;if(Wl(o))n=o;else if(n=parseInt(o),isNaN(o))return Pl.e("".concat("TIM.create"," failed. Failed to parse the SDKAppID, please check the arguments")),null;if(n&&mD[n])return mD[n];Pl.l("".concat("TIM.create"));var r=new hD(t(t({},e),{},{SDKAppID:n}));r.on(Mr.SDK_DESTROY,(function(e){mD[e.data.SDKAppID]=null,delete mD[e.data.SDKAppID]}));var i=function(e){var t=Object.create(null);return Object.keys(gf).forEach((function(n){if(e[n]){var o=new br;t[n]=function(){var t=Array.from(arguments);return o.use((function(t,o){var r=vD(e,n);return!0===r?o():vI(r)})).use((function(e,t){if(!0===Kd(e,hf[n],n))return t()})).use((function(t,o){return e[n].apply(e,t)})),o.run(t)}}})),t}(r);return mD[n]=i,hf.hookGetAPITips(r.getErrorMessage.bind(r)),Pl.l("".concat("TIM.create"," ok")),i}};return _D.TYPES=Ir,_D.EVENT=Mr,_D.VERSION="2.26.3",Pl.l("TIM.VERSION:".concat(_D.VERSION)),_D}()},3330:function(e){var t;t=function(){function e(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function t(t){for(var n=1;n<arguments.length;n++){var o=null!=arguments[n]?arguments[n]:{};n%2?e(Object(o),!0).forEach((function(e){a(t,e,o[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):e(Object(o)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(o,e))}))}return t}function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function i(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var s="undefined"!=typeof wx&&"function"==typeof wx.getSystemInfoSync&&Boolean(wx.getSystemInfoSync().fontSizeSetting),u="undefined"!=typeof qq&&"function"==typeof qq.getSystemInfoSync&&Boolean(qq.getSystemInfoSync().fontSizeSetting),c="undefined"!=typeof tt&&"function"==typeof tt.getSystemInfoSync&&Boolean(tt.getSystemInfoSync().fontSizeSetting),l="undefined"!=typeof swan&&"function"==typeof swan.getSystemInfoSync&&Boolean(swan.getSystemInfoSync().fontSizeSetting),d="undefined"!=typeof my&&"function"==typeof my.getSystemInfoSync&&Boolean(my.getSystemInfoSync().fontSizeSetting),p="undefined"!=typeof uni&&"undefined"==typeof window,f=p&&"ios"===uni.getDeviceInfo().platform.toLocaleLowerCase(),h=(p&&uni.getDeviceInfo().platform.toLocaleLowerCase(),s||u||c||l||d||p),g=u?qq:c?tt:l?swan:d?my:s?wx:p?uni:{},v=function(e){if("object"!==n(e)||null===e)return!1;var t=Object.getPrototypeOf(e);if(null===t)return!0;for(var o=t;null!==Object.getPrototypeOf(o);)o=Object.getPrototypeOf(o);return t===o};function m(e){if(null==e)return!0;if("boolean"==typeof e)return!1;if("number"==typeof e)return 0===e;if("string"==typeof e)return 0===e.length;if("function"==typeof e)return 0===e.length;if(Array.isArray(e))return 0===e.length;if(e instanceof Error)return""===e.message;if(v(e)){for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}return!1}var _=function(){function e(){o(this,e)}return i(e,[{key:"request",value:function(e,t){var n=this,o=e.downloadUrl||"",r=(e.method||"PUT").toUpperCase(),i=e.url;if(e.qs){var a=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"&",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"=";return m(e)?"":v(e)?Object.keys(e).map((function(o){var r=encodeURIComponent(o)+n;return Array.isArray(e[o])?e[o].map((function(e){return r+encodeURIComponent(e)})).join(t):r+encodeURIComponent(e[o])})).filter(Boolean).join(t):void 0}(e.qs);a&&(i+="".concat(-1===i.indexOf("?")?"?":"&").concat(a))}var s=new XMLHttpRequest;s.open(r,i,!0),s.responseType=e.dataType||"text";var u=e.headers||{};if(!m(u))for(var c in u)u.hasOwnProperty(c)&&"content-length"!==c.toLowerCase()&&"user-agent"!==c.toLowerCase()&&"origin"!==c.toLowerCase()&&"host"!==c.toLowerCase()&&s.setRequestHeader(c,u[c]);return s.onload=function(){if(200===s.status)t(null,n._xhrRes(s,n._xhrBody(s,o)));else{var e={code:s.status,message:JSON.stringify(s.responseText)};t(e,n._xhrRes(s,n._xhrBody(s)))}},s.onerror=function(e){var o=n._xhrBody(s),r={code:s.status,message:JSON.stringify(s.responseText)};o||s.statusText||0!==s.status||(e.message="CORS blocked or network error"),t(r,n._xhrRes(s,o)),r=null},e.onProgress&&s.upload&&(s.upload.onprogress=function(t){var n=t.total,o=t.loaded,r=Math.floor(100*o/n);e.onProgress({total:n,loaded:o,percent:(r>=100?100:r)/100})}),s.send(e.resources),s}},{key:"_xhrRes",value:function(e,t){var n={};return e.getAllResponseHeaders().trim().split("\n").forEach((function(e){if(e){var t=e.indexOf(":"),o=e.substr(0,t).trim().toLowerCase(),r=e.substr(t+1).trim();n[o]=r}})),{statusCode:e.status,statusMessage:e.statusText,headers:n,data:t}}},{key:"_xhrBody",value:function(e,t){return 200===e.status&&t?{location:t}:{response:e.responseText}}}]),e}(),y=["unknown","image","video","audio","log"],M=["name"],I=function(){function e(){o(this,e)}return i(e,[{key:"request",value:function(e,n){var o=this,r=e.resources,i=void 0===r?"":r,a=e.headers,s=void 0===a?{}:a,u=e.url,c=e.downloadUrl,l=void 0===c?"":c,p=u,h=null,v=l.match(/^(https?:\/\/[^/]+\/)([^/]*\/?)(.*)$/),m=decodeURIComponent(v[3]),_={key:m.indexOf("?")>-1?m.split("?")[0]:m,success_action_status:200,"Content-Type":""},I={};if(f){var C=u.split("?sign=");if(C.length>1){var k=C[1];p="".concat(C[0],"?sign=").concat(encodeURIComponent("".concat(k))),I.sign=decodeURIComponent(k),I.signature=decodeURIComponent(k)}}var T={url:p,header:s,name:"file",filePath:i,formData:t(t({},_),I),timeout:e.timeout||3e5};if(d){var S=T;S.name,T=t(t({},function(e,t){if(null==e)return{};var n,o,r=function(e,t){if(null==e)return{};var n,o,r={},i=Object.keys(e);for(o=0;o<i.length;o++)n=i[o],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}(S,M)),{},{fileName:"file",fileType:y[e.fileType]})}return(h=g.uploadFile(t(t({},T),{},{success:function(e){o._handleResponse({response:e,downloadUrl:l,callback:n})},fail:function(e){o._handleResponse({response:e,downloadUrl:l,callback:n})}}))).onProgressUpdate&&h.onProgressUpdate((function(t){e.onProgress&&e.onProgress({total:t.totalBytesExpectedToSend,loaded:t.totalBytesSent,percent:Math.floor(t.progress)/100})})),h}},{key:"_handleResponse",value:function(e){var n=e.downloadUrl,o=e.response,r=e.callback,i=o.header,a={};if(i)for(var s in i)i.hasOwnProperty(s)&&(a[s.toLowerCase()]=i[s]);var u=+o.statusCode;200===u?r(null,{statusCode:u,headers:a,data:t(t({},o.data),{},{location:n})}):r({code:u,message:JSON.stringify(o.data)},{statusCode:u,headers:a,data:void 0})}}]),e}();return function(){function e(){o(this,e),console.log("TIMUploadPlugin.VERSION: ".concat("1.1.0")),this.retry=1,this.tryCount=0,this.systemClockOffset=0,this.httpRequest=h?new I:new _}return i(e,[{key:"uploadFile",value:function(e,t){var n=this;return this.httpRequest.request(e,(function(o,r){o&&n.tryCount<n.retry&&n.allowRetry(o)?(n.tryCount++,n.uploadFile(e,t)):(n.tryCount=0,t(o,r))}))}},{key:"allowRetry",value:function(e){var t=!1,n=!1;if(e){var o=e.headers&&(e.headers.date||e.headers.Date)||e.error&&e.error.ServerTime;try{var r=e.error&&e.error.Code,i=e.error&&e.error.Message;("RequestTimeTooSkewed"===r||"AccessDenied"===r&&"Request has expired"===i)&&(n=!0)}catch(s){}if(n&&o){var a=Date.now(),u=Date.parse(o);Math.abs(a+this.systemClockOffset-u)>=3e4&&(this.systemClockOffset=u-a,t=!0)}else 5===Math.floor(e.statusCode/100)&&(t=!0)}return t}}]),e}()},e.exports=t()},8772:function(e){e.exports=function(e){return e&&e.__esModule?e:{default:e}},e.exports.__esModule=!0,e.exports.default=e.exports},8681:function(e,t,n){"use strict";function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}n.d(t,{Z:function(){return o}})},4572:function(e,t,n){"use strict";n.d(t,{Z:function(){return r}});var o=n(2958);function r(e,t,n){return(t=(0,o.Z)(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}},1163:function(e,t,n){"use strict";function o(){return o=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},o.apply(this,arguments)}n.d(t,{Z:function(){return o}})},574:function(e,t,n){"use strict";function o(e,t){if(null==e)return{};var n,o,r={},i=Object.keys(e);for(o=0;o<i.length;o++)n=i[o],t.indexOf(n)>=0||(r[n]=e[n]);return r}n.d(t,{Z:function(){return o}})},6377:function(e,t,n){"use strict";n.d(t,{Z:function(){return r}});var o=n(2266);function r(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var o,r,i,a,s=[],u=!0,c=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(o=i.call(n)).done)&&(s.push(o.value),s.length!==t);u=!0);}catch(l){c=!0,r=l}finally{try{if(!u&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(c)throw r}}return s}}(e,t)||(0,o.Z)(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}},1246:function(e,t,n){"use strict";n.d(t,{Z:function(){return i}});var o=n(8681);var r=n(2266);function i(e){return function(e){if(Array.isArray(e))return(0,o.Z)(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||(0,r.Z)(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}},2958:function(e,t,n){"use strict";n.d(t,{Z:function(){return r}});var o=n(6143);function r(e){var t=function(e,t){if("object"!==(0,o.Z)(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==(0,o.Z)(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===(0,o.Z)(t)?t:String(t)}},6143:function(e,t,n){"use strict";function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}n.d(t,{Z:function(){return o}})},2266:function(e,t,n){"use strict";n.d(t,{Z:function(){return r}});var o=n(8681);function r(e,t){if(e){if("string"===typeof e)return(0,o.Z)(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?(0,o.Z)(e,t):void 0}}}},t={};function n(o){var r=t[o];if(void 0!==r)return r.exports;var i=t[o]={exports:{}};return e[o].call(i.exports,i,i.exports,n),i.exports}n.m=e,n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,{a:t}),t},function(){var e,t=Object.getPrototypeOf?function(e){return Object.getPrototypeOf(e)}:function(e){return e.__proto__};n.t=function(o,r){if(1&r&&(o=this(o)),8&r)return o;if("object"===typeof o&&o){if(4&r&&o.__esModule)return o;if(16&r&&"function"===typeof o.then)return o}var i=Object.create(null);n.r(i);var a={};e=e||[null,t({}),t([]),t(t)];for(var s=2&r&&o;"object"==typeof s&&!~e.indexOf(s);s=t(s))Object.getOwnPropertyNames(s).forEach((function(e){a[e]=function(){return o[e]}}));return a.default=function(){return o},n.d(i,a),i}}(),n.d=function(e,t){for(var o in t)n.o(t,o)&&!n.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},n.f={},n.e=function(e){return Promise.all(Object.keys(n.f).reduce((function(t,o){return n.f[o](e,t),t}),[]))},n.u=function(e){return"static/js/"+e+".8dde7193.chunk.js"},n.miniCssF=function(e){},n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},function(){var e={},t="tim:";n.l=function(o,r,i,a){if(e[o])e[o].push(r);else{var s,u;if(void 0!==i)for(var c=document.getElementsByTagName("script"),l=0;l<c.length;l++){var d=c[l];if(d.getAttribute("src")==o||d.getAttribute("data-webpack")==t+i){s=d;break}}s||(u=!0,(s=document.createElement("script")).charset="utf-8",s.timeout=120,n.nc&&s.setAttribute("nonce",n.nc),s.setAttribute("data-webpack",t+i),s.src=o),e[o]=[r];var p=function(t,n){s.onerror=s.onload=null,clearTimeout(f);var r=e[o];if(delete e[o],s.parentNode&&s.parentNode.removeChild(s),r&&r.forEach((function(e){return e(n)})),t)return t(n)},f=setTimeout(p.bind(null,void 0,{type:"timeout",target:s}),12e4);s.onerror=p.bind(null,s.onerror),s.onload=p.bind(null,s.onload),u&&document.head.appendChild(s)}}}(),n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.p="./",function(){var e={179:0};n.f.j=function(t,o){var r=n.o(e,t)?e[t]:void 0;if(0!==r)if(r)o.push(r[2]);else{var i=new Promise((function(n,o){r=e[t]=[n,o]}));o.push(r[2]=i);var a=n.p+n.u(t),s=new Error;n.l(a,(function(o){if(n.o(e,t)&&(0!==(r=e[t])&&(e[t]=void 0),r)){var i=o&&("load"===o.type?"missing":o.type),a=o&&o.target&&o.target.src;s.message="Loading chunk "+t+" failed.\n("+i+": "+a+")",s.name="ChunkLoadError",s.type=i,s.request=a,r[1](s)}}),"chunk-"+t,t)}};var t=function(t,o){var r,i,a=o[0],s=o[1],u=o[2],c=0;if(a.some((function(t){return 0!==e[t]}))){for(r in s)n.o(s,r)&&(n.m[r]=s[r]);if(u)u(n)}for(t&&t(o);c<a.length;c++)i=a[c],n.o(e,i)&&e[i]&&e[i][0](),e[i]=0},o=self.webpackChunktim=self.webpackChunktim||[];o.forEach(t.bind(null,0)),o.push=t.bind(null,o.push.bind(o))}(),function(){"use strict";var e=n(3371),t=n(2379);function o(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var r=n(6377),i=(n(7362),n(1469)),a=(n(2623),n(6805)),s=n(7758),u=n(527),c=(0,i.w)((function(t,n){var o=t.styles,r=(0,s.O)([o],void 0,(0,e.useContext)(i.T)),c=(0,e.useRef)();return(0,u.j)((function(){var e=n.key+"-global",t=new n.sheet.constructor({key:e,nonce:n.sheet.nonce,container:n.sheet.container,speedy:n.sheet.isSpeedy}),o=!1,i=document.querySelector('style[data-emotion="'+e+" "+r.name+'"]');return n.sheet.tags.length&&(t.before=n.sheet.tags[0]),null!==i&&(o=!0,i.setAttribute("data-emotion",e),t.hydrate([i])),c.current=[t,o],function(){t.flush()}}),[n]),(0,u.j)((function(){var e=c.current,t=e[0];if(e[1])e[1]=!1;else{if(void 0!==r.next&&(0,a.My)(n,r.next,!0),t.tags.length){var o=t.tags[t.tags.length-1].nextElementSibling;t.before=o,t.flush()}n.insert("",r,t,!1)}}),[n,r.name]),null}));function l(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return(0,s.O)(t)}var d=function(){var e=l.apply(void 0,arguments),t="animation-"+e.name;return{name:t,styles:"@keyframes "+t+"{"+e.styles+"}",anim:1,toString:function(){return"_EMO_"+this.name+"_"+this.styles+"_EMO_"}}};var p=n(4572),f=n(574),h=n(1163),g=n(3788),v=n(8015),m=n(4095),_=n(1119),y=n(27),M=(0,n(8971).ZP)(),I=n(1997),C=n(3241),k=["className","component","disableGutters","fixed","maxWidth","classes"],T=(0,I.Z)(),S=M("div",{name:"MuiContainer",slot:"Root",overridesResolver:function(e,t){var n=e.ownerState;return[t.root,t["maxWidth".concat((0,v.Z)(String(n.maxWidth)))],n.fixed&&t.fixed,n.disableGutters&&t.disableGutters]}}),b=function(e){return(0,y.Z)({props:e,name:"MuiContainer",defaultTheme:T})},D=function(e,t){var n=e.classes,o=e.fixed,r=e.disableGutters,i=e.maxWidth,a={root:["root",i&&"maxWidth".concat((0,v.Z)(String(i))),o&&"fixed",r&&"disableGutters"]};return(0,_.Z)(a,(function(e){return(0,m.Z)(t,e)}),n)};var E=n(6589),A=n(6166),L=n(7070),R=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.createStyledComponent,o=void 0===n?S:n,r=t.useThemeProps,i=void 0===r?b:r,a=t.componentName,s=void 0===a?"MuiContainer":a,u=o((function(e){var t=e.theme,n=e.ownerState;return(0,h.Z)({width:"100%",marginLeft:"auto",boxSizing:"border-box",marginRight:"auto",display:"block"},!n.disableGutters&&(0,p.Z)({paddingLeft:t.spacing(2),paddingRight:t.spacing(2)},t.breakpoints.up("sm"),{paddingLeft:t.spacing(3),paddingRight:t.spacing(3)}))}),(function(e){var t=e.theme;return e.ownerState.fixed&&Object.keys(t.breakpoints.values).reduce((function(e,n){var o=n,r=t.breakpoints.values[o];return 0!==r&&(e[t.breakpoints.up(o)]={maxWidth:"".concat(r).concat(t.breakpoints.unit)}),e}),{})}),(function(e){var t=e.theme,n=e.ownerState;return(0,h.Z)({},"xs"===n.maxWidth&&(0,p.Z)({},t.breakpoints.up("xs"),{maxWidth:Math.max(t.breakpoints.values.xs,444)}),n.maxWidth&&"xs"!==n.maxWidth&&(0,p.Z)({},t.breakpoints.up(n.maxWidth),{maxWidth:"".concat(t.breakpoints.values[n.maxWidth]).concat(t.breakpoints.unit)}))}));return e.forwardRef((function(e,t){var n=i(e),o=n.className,r=n.component,a=void 0===r?"div":r,c=n.disableGutters,l=void 0!==c&&c,d=n.fixed,p=void 0!==d&&d,v=n.maxWidth,m=void 0===v?"lg":v,_=(0,f.Z)(n,k),y=(0,h.Z)({},n,{component:a,disableGutters:l,fixed:p,maxWidth:m}),M=D(y,s);return(0,C.jsx)(u,(0,h.Z)({as:a,ownerState:y,className:(0,g.Z)(M.root,o),ref:t},_))}))}({createStyledComponent:(0,A.ZP)("div",{name:"MuiContainer",slot:"Root",overridesResolver:function(e,t){var n=e.ownerState;return[t.root,t["maxWidth".concat((0,E.Z)(String(n.maxWidth)))],n.fixed&&t.fixed,n.disableGutters&&t.disableGutters]}}),useThemeProps:function(e){return(0,L.Z)({props:e,name:"MuiContainer"})}}),w=R,O=n(92),N=n(1246),P=n(6615),G=["sx"],U=function(e){var t,n,o={systemProps:{},otherProps:{}},r=null!=(t=null==e||null==(n=e.theme)?void 0:n.unstable_sxConfig)?t:P.Z;return Object.keys(e).forEach((function(t){r[t]?o.systemProps[t]=e[t]:o.otherProps[t]=e[t]})),o};function x(e){var t,n=e.sx,o=(0,f.Z)(e,G),r=U(o),i=r.systemProps,a=r.otherProps;return t=Array.isArray(n)?[i].concat((0,N.Z)(n)):"function"===typeof n?function(){var e=n.apply(void 0,arguments);return(0,O.P)(e)?(0,h.Z)({},i,e):i}:(0,h.Z)({},i,n),(0,h.Z)({},a,{sx:t})}var F=n(9380),q=n(782),B=["component","direction","spacing","divider","children","className"],V=(0,I.Z)(),H=M("div",{name:"MuiStack",slot:"Root",overridesResolver:function(e,t){return t.root}});function K(e){return(0,y.Z)({props:e,name:"MuiStack",defaultTheme:V})}function j(t,n){var o=e.Children.toArray(t).filter(Boolean);return o.reduce((function(t,r,i){return t.push(r),i<o.length-1&&t.push(e.cloneElement(n,{key:"separator-".concat(i)})),t}),[])}var z=function(e){var t=e.ownerState,n=e.theme,o=(0,h.Z)({display:"flex",flexDirection:"column"},(0,F.k9)({theme:n},(0,F.P$)({values:t.direction,breakpoints:n.breakpoints.values}),(function(e){return{flexDirection:e}})));if(t.spacing){var r=(0,q.hB)(n),i=Object.keys(n.breakpoints.values).reduce((function(e,n){return("object"===typeof t.spacing&&null!=t.spacing[n]||"object"===typeof t.direction&&null!=t.direction[n])&&(e[n]=!0),e}),{}),a=(0,F.P$)({values:t.direction,base:i}),s=(0,F.P$)({values:t.spacing,base:i});"object"===typeof a&&Object.keys(a).forEach((function(e,t,n){if(!a[e]){var o=t>0?a[n[t-1]]:"column";a[e]=o}}));o=(0,O.Z)(o,(0,F.k9)({theme:n},s,(function(e,n){return{"& > :not(style) + :not(style)":(0,p.Z)({margin:0},"margin".concat((o=n?a[n]:t.direction,{row:"Left","row-reverse":"Right",column:"Top","column-reverse":"Bottom"}[o])),(0,q.NA)(r,e))};var o})))}return o=(0,F.dt)(n.breakpoints,o)};var Z=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.createStyledComponent,o=void 0===n?H:n,r=t.useThemeProps,i=void 0===r?K:r,a=t.componentName,s=void 0===a?"MuiStack":a,u=o(z),c=e.forwardRef((function(e,t){var n=x(i(e)),o=n.component,r=void 0===o?"div":o,a=n.direction,c=void 0===a?"column":a,l=n.spacing,d=void 0===l?0:l,p=n.divider,v=n.children,y=n.className,M=(0,f.Z)(n,B),I={direction:c,spacing:d},k=(0,_.Z)({root:["root"]},(function(e){return(0,m.Z)(s,e)}),{});return(0,C.jsx)(u,(0,h.Z)({as:r,ownerState:I,ref:t,className:(0,g.Z)(k.root,y)},M,{children:p?j(v,p):v}))}));return c}({createStyledComponent:(0,A.ZP)("div",{name:"MuiStack",slot:"Root",overridesResolver:function(e,t){return t.root}}),useThemeProps:function(e){return(0,L.Z)({props:e,name:"MuiStack"})}}),W=Z,Y=n(3814);function J(e){return(0,m.Z)("MuiTypography",e)}(0,Y.Z)("MuiTypography",["root","h1","h2","h3","h4","h5","h6","subtitle1","subtitle2","body1","body2","inherit","button","caption","overline","alignLeft","alignRight","alignCenter","alignJustify","noWrap","gutterBottom","paragraph"]);var X=["align","className","component","gutterBottom","noWrap","paragraph","variant","variantMapping"],$=(0,A.ZP)("span",{name:"MuiTypography",slot:"Root",overridesResolver:function(e,t){var n=e.ownerState;return[t.root,n.variant&&t[n.variant],"inherit"!==n.align&&t["align".concat((0,E.Z)(n.align))],n.noWrap&&t.noWrap,n.gutterBottom&&t.gutterBottom,n.paragraph&&t.paragraph]}})((function(e){var t=e.theme,n=e.ownerState;return(0,h.Z)({margin:0},n.variant&&t.typography[n.variant],"inherit"!==n.align&&{textAlign:n.align},n.noWrap&&{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},n.gutterBottom&&{marginBottom:"0.35em"},n.paragraph&&{marginBottom:16})})),Q={h1:"h1",h2:"h2",h3:"h3",h4:"h4",h5:"h5",h6:"h6",subtitle1:"h6",subtitle2:"h6",body1:"p",body2:"p",inherit:"p"},ee={primary:"primary.main",textPrimary:"text.primary",secondary:"secondary.main",textSecondary:"text.secondary",error:"error.main"},te=e.forwardRef((function(e,t){var n=(0,L.Z)({props:e,name:"MuiTypography"}),o=function(e){return ee[e]||e}(n.color),r=x((0,h.Z)({},n,{color:o})),i=r.align,a=void 0===i?"inherit":i,s=r.className,u=r.component,c=r.gutterBottom,l=void 0!==c&&c,d=r.noWrap,p=void 0!==d&&d,v=r.paragraph,m=void 0!==v&&v,y=r.variant,M=void 0===y?"body1":y,I=r.variantMapping,k=void 0===I?Q:I,T=(0,f.Z)(r,X),S=(0,h.Z)({},r,{align:a,color:o,className:s,component:u,gutterBottom:l,noWrap:p,paragraph:m,variant:M,variantMapping:k}),b=u||(m?"p":k[M]||Q[M])||"span",D=function(e){var t=e.align,n=e.gutterBottom,o=e.noWrap,r=e.paragraph,i=e.variant,a=e.classes,s={root:["root",i,"inherit"!==e.align&&"align".concat((0,E.Z)(t)),n&&"gutterBottom",o&&"noWrap",r&&"paragraph"]};return(0,_.Z)(s,J,a)}(S);return(0,C.jsx)($,(0,h.Z)({as:b,ref:t,ownerState:S,className:(0,g.Z)(D.root,s)},T))})),ne=n(2814),oe=n(6935);function re(e){return(0,m.Z)("MuiLink",e)}var ie=(0,Y.Z)("MuiLink",["root","underlineNone","underlineHover","underlineAlways","button","focusVisible"]),ae=n(6197),se=n(2131),ue={primary:"primary.main",textPrimary:"text.primary",secondary:"secondary.main",textSecondary:"text.secondary",error:"error.main"},ce=function(e){var t=e.theme,n=e.ownerState,o=function(e){return ue[e]||e}(n.color),r=(0,ae.DW)(t,"palette.".concat(o),!1)||n.color,i=(0,ae.DW)(t,"palette.".concat(o,"Channel"));return"vars"in t&&i?"rgba(".concat(i," / 0.4)"):(0,se.Fq)(r,.4)},le=["className","color","component","onBlur","onFocus","TypographyClasses","underline","variant","sx"],de=(0,A.ZP)(te,{name:"MuiLink",slot:"Root",overridesResolver:function(e,t){var n=e.ownerState;return[t.root,t["underline".concat((0,E.Z)(n.underline))],"button"===n.component&&t.button]}})((function(e){var t=e.theme,n=e.ownerState;return(0,h.Z)({},"none"===n.underline&&{textDecoration:"none"},"hover"===n.underline&&{textDecoration:"none","&:hover":{textDecoration:"underline"}},"always"===n.underline&&(0,h.Z)({textDecoration:"underline"},"inherit"!==n.color&&{textDecorationColor:ce({theme:t,ownerState:n})},{"&:hover":{textDecorationColor:"inherit"}}),"button"===n.component&&(0,p.Z)({position:"relative",WebkitTapHighlightColor:"transparent",backgroundColor:"transparent",outline:0,border:0,margin:0,borderRadius:0,padding:0,cursor:"pointer",userSelect:"none",verticalAlign:"middle",MozAppearance:"none",WebkitAppearance:"none","&::-moz-focus-inner":{borderStyle:"none"}},"&.".concat(ie.focusVisible),{outline:"auto"}))})),pe=e.forwardRef((function(t,n){var o=(0,L.Z)({props:t,name:"MuiLink"}),i=o.className,a=o.color,s=void 0===a?"primary":a,u=o.component,c=void 0===u?"a":u,l=o.onBlur,d=o.onFocus,p=o.TypographyClasses,v=o.underline,m=void 0===v?"always":v,y=o.variant,M=void 0===y?"inherit":y,I=o.sx,k=(0,f.Z)(o,le),T=(0,ne.Z)(),S=T.isFocusVisibleRef,b=T.onBlur,D=T.onFocus,A=T.ref,R=e.useState(!1),w=(0,r.Z)(R,2),O=w[0],P=w[1],G=(0,oe.Z)(n,A),U=(0,h.Z)({},o,{color:s,component:c,focusVisible:O,underline:m,variant:M}),x=function(e){var t=e.classes,n=e.component,o=e.focusVisible,r=e.underline,i={root:["root","underline".concat((0,E.Z)(r)),"button"===n&&"button",o&&"focusVisible"]};return(0,_.Z)(i,re,t)}(U);return(0,C.jsx)(de,(0,h.Z)({color:s,className:(0,g.Z)(x.root,i),classes:p,component:c,onBlur:function(e){b(e),!1===S.current&&P(!1),l&&l(e)},onFocus:function(e){D(e),!0===S.current&&P(!0),d&&d(e)},ref:G,ownerState:U,variant:M,sx:[].concat((0,N.Z)(Object.keys(ue).includes(s)?[]:[{color:s}]),(0,N.Z)(Array.isArray(I)?I:[I]))},k))})),fe=n(3818),he=n(6143);function ge(){ge=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,o=Object.defineProperty||function(e,t,n){e[t]=n.value},r="function"==typeof Symbol?Symbol:{},i=r.iterator||"@@iterator",a=r.asyncIterator||"@@asyncIterator",s=r.toStringTag||"@@toStringTag";function u(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{u({},"")}catch(E){u=function(e,t,n){return e[t]=n}}function c(e,t,n,r){var i=t&&t.prototype instanceof p?t:p,a=Object.create(i.prototype),s=new S(r||[]);return o(a,"_invoke",{value:I(e,n,s)}),a}function l(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(E){return{type:"throw",arg:E}}}e.wrap=c;var d={};function p(){}function f(){}function h(){}var g={};u(g,i,(function(){return this}));var v=Object.getPrototypeOf,m=v&&v(v(b([])));m&&m!==t&&n.call(m,i)&&(g=m);var _=h.prototype=p.prototype=Object.create(g);function y(e){["next","throw","return"].forEach((function(t){u(e,t,(function(e){return this._invoke(t,e)}))}))}function M(e,t){function r(o,i,a,s){var u=l(e[o],e,i);if("throw"!==u.type){var c=u.arg,d=c.value;return d&&"object"==(0,he.Z)(d)&&n.call(d,"__await")?t.resolve(d.__await).then((function(e){r("next",e,a,s)}),(function(e){r("throw",e,a,s)})):t.resolve(d).then((function(e){c.value=e,a(c)}),(function(e){return r("throw",e,a,s)}))}s(u.arg)}var i;o(this,"_invoke",{value:function(e,n){function o(){return new t((function(t,o){r(e,n,t,o)}))}return i=i?i.then(o,o):o()}})}function I(e,t,n){var o="suspendedStart";return function(r,i){if("executing"===o)throw new Error("Generator is already running");if("completed"===o){if("throw"===r)throw i;return D()}for(n.method=r,n.arg=i;;){var a=n.delegate;if(a){var s=C(a,n);if(s){if(s===d)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===o)throw o="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o="executing";var u=l(e,t,n);if("normal"===u.type){if(o=n.done?"completed":"suspendedYield",u.arg===d)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o="completed",n.method="throw",n.arg=u.arg)}}}function C(e,t){var n=t.method,o=e.iterator[n];if(void 0===o)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=void 0,C(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),d;var r=l(o,e.iterator,t.arg);if("throw"===r.type)return t.method="throw",t.arg=r.arg,t.delegate=null,d;var i=r.arg;return i?i.done?(t[e.resultName]=i.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,d):i:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,d)}function k(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function T(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function S(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(k,this),this.reset(!0)}function b(e){if(e){var t=e[i];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,r=function t(){for(;++o<e.length;)if(n.call(e,o))return t.value=e[o],t.done=!1,t;return t.value=void 0,t.done=!0,t};return r.next=r}}return{next:D}}function D(){return{value:void 0,done:!0}}return f.prototype=h,o(_,"constructor",{value:h,configurable:!0}),o(h,"constructor",{value:f,configurable:!0}),f.displayName=u(h,s,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===f||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,h):(e.__proto__=h,u(e,s,"GeneratorFunction")),e.prototype=Object.create(_),e},e.awrap=function(e){return{__await:e}},y(M.prototype),u(M.prototype,a,(function(){return this})),e.AsyncIterator=M,e.async=function(t,n,o,r,i){void 0===i&&(i=Promise);var a=new M(c(t,n,o,r),i);return e.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},y(_),u(_,s,"Generator"),u(_,i,(function(){return this})),u(_,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),n=[];for(var o in t)n.push(o);return n.reverse(),function e(){for(;n.length;){var o=n.pop();if(o in t)return e.value=o,e.done=!1,e}return e.done=!0,e}},e.values=b,S.prototype={constructor:S,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(T),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function o(n,o){return a.type="throw",a.arg=e,t.next=n,o&&(t.method="next",t.arg=void 0),!!o}for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r],a=i.completion;if("root"===i.tryLoc)return o("end");if(i.tryLoc<=this.prev){var s=n.call(i,"catchLoc"),u=n.call(i,"finallyLoc");if(s&&u){if(this.prev<i.catchLoc)return o(i.catchLoc,!0);if(this.prev<i.finallyLoc)return o(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return o(i.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return o(i.finallyLoc)}}}},abrupt:function(e,t){for(var o=this.tryEntries.length-1;o>=0;--o){var r=this.tryEntries[o];if(r.tryLoc<=this.prev&&n.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var i=r;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,d):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),d},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),T(n),d}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var o=n.completion;if("throw"===o.type){var r=o.arg;T(n)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:b(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),d}},e}function ve(e,t,n,o,r,i,a){try{var s=e[i](a),u=s.value}catch(c){return void n(c)}s.done?t(u):Promise.resolve(u).then(o,r)}function me(e){return function(){var t=this,n=arguments;return new Promise((function(o,r){var i=e.apply(t,n);function a(e){ve(i,o,r,a,s,"next",e)}function s(e){ve(i,o,r,a,s,"throw",e)}a(void 0)}))}}var _e=n(5307),ye=n(9958),Me=n(2495),Ie=n(9091),Ce=n(4920),ke=n(7586),Te=n(1663),Se=["onChange","maxRows","minRows","style","value"];function be(e){return parseInt(e,10)||0}var De={visibility:"hidden",position:"absolute",overflow:"hidden",height:0,top:0,left:0,transform:"translateZ(0)"};function Ee(e){return void 0===e||null===e||0===Object.keys(e).length||0===e.outerHeightStyle&&!e.overflow}var Ae=e.forwardRef((function(t,n){var o=t.onChange,i=t.maxRows,a=t.minRows,s=void 0===a?1:a,u=t.style,c=t.value,l=(0,f.Z)(t,Se),d=e.useRef(null!=c).current,p=e.useRef(null),g=(0,Ie.Z)(n,p),v=e.useRef(null),m=e.useRef(0),_=e.useState({outerHeightStyle:0}),y=(0,r.Z)(_,2),M=y[0],I=y[1],k=e.useCallback((function(){var e=p.current,n=(0,Ce.Z)(e).getComputedStyle(e);if("0px"===n.width)return{outerHeightStyle:0};var o=v.current;o.style.width=n.width,o.value=e.value||t.placeholder||"x","\n"===o.value.slice(-1)&&(o.value+=" ");var r=n.boxSizing,a=be(n.paddingBottom)+be(n.paddingTop),u=be(n.borderBottomWidth)+be(n.borderTopWidth),c=o.scrollHeight;o.value="x";var l=o.scrollHeight,d=c;return s&&(d=Math.max(Number(s)*l,d)),i&&(d=Math.min(Number(i)*l,d)),{outerHeightStyle:(d=Math.max(d,l))+("border-box"===r?a+u:0),overflow:Math.abs(d-c)<=1}}),[i,s,t.placeholder]),T=function(e,t){var n=t.outerHeightStyle,o=t.overflow;return m.current<20&&(n>0&&Math.abs((e.outerHeightStyle||0)-n)>1||e.overflow!==o)?(m.current+=1,{overflow:o,outerHeightStyle:n}):e},S=e.useCallback((function(){var e=k();Ee(e)||I((function(t){return T(t,e)}))}),[k]);e.useEffect((function(){var e,t=(0,ke.Z)((function(){m.current=0,p.current&&function(){var e=k();Ee(e)||Me.flushSync((function(){I((function(t){return T(t,e)}))}))}()})),n=p.current,o=(0,Ce.Z)(n);return o.addEventListener("resize",t),"undefined"!==typeof ResizeObserver&&(e=new ResizeObserver(t)).observe(n),function(){t.clear(),o.removeEventListener("resize",t),e&&e.disconnect()}})),(0,Te.Z)((function(){S()})),e.useEffect((function(){m.current=0}),[c]);return(0,C.jsxs)(e.Fragment,{children:[(0,C.jsx)("textarea",(0,h.Z)({value:c,onChange:function(e){m.current=0,d||S(),o&&o(e)},ref:g,rows:s,style:(0,h.Z)({height:M.outerHeightStyle,overflow:M.overflow?"hidden":void 0},u)},l)),(0,C.jsx)("textarea",{"aria-hidden":!0,className:t.className,readOnly:!0,ref:v,tabIndex:-1,style:(0,h.Z)({},De,u,{padding:0})})]})})),Le=Ae;function Re(e){return"string"===typeof e}function we(e){var t=e.props,n=e.states,o=e.muiFormControl;return n.reduce((function(e,n){return e[n]=t[n],o&&"undefined"===typeof t[n]&&(e[n]=o[n]),e}),{})}var Oe=e.createContext(void 0);function Ne(){return e.useContext(Oe)}var Pe=n(2584);function Ge(e){var t=e.styles,n=e.defaultTheme,o=void 0===n?{}:n,r="function"===typeof t?function(e){return t(void 0===(n=e)||null===n||0===Object.keys(n).length?o:e);var n}:t;return(0,C.jsx)(c,{styles:r})}var Ue=n(2763);var xe=function(e){return(0,C.jsx)(Ge,(0,h.Z)({},e,{defaultTheme:Ue.Z}))};function Fe(e){return null!=e&&!(Array.isArray(e)&&0===e.length)}function qe(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return e&&(Fe(e.value)&&""!==e.value||t&&Fe(e.defaultValue)&&""!==e.defaultValue)}function Be(e){return(0,m.Z)("MuiInputBase",e)}var Ve=(0,Y.Z)("MuiInputBase",["root","formControl","focused","disabled","adornedStart","adornedEnd","error","sizeSmall","multiline","colorSecondary","fullWidth","hiddenLabel","readOnly","input","inputSizeSmall","inputMultiline","inputTypeSearch","inputAdornedStart","inputAdornedEnd","inputHiddenLabel"]),He=["aria-describedby","autoComplete","autoFocus","className","color","components","componentsProps","defaultValue","disabled","disableInjectingGlobalStyles","endAdornment","error","fullWidth","id","inputComponent","inputProps","inputRef","margin","maxRows","minRows","multiline","name","onBlur","onChange","onClick","onFocus","onKeyDown","onKeyUp","placeholder","readOnly","renderSuffix","rows","size","slotProps","slots","startAdornment","type","value"],Ke=function(e,t){var n=e.ownerState;return[t.root,n.formControl&&t.formControl,n.startAdornment&&t.adornedStart,n.endAdornment&&t.adornedEnd,n.error&&t.error,"small"===n.size&&t.sizeSmall,n.multiline&&t.multiline,n.color&&t["color".concat((0,E.Z)(n.color))],n.fullWidth&&t.fullWidth,n.hiddenLabel&&t.hiddenLabel]},je=function(e,t){var n=e.ownerState;return[t.input,"small"===n.size&&t.inputSizeSmall,n.multiline&&t.inputMultiline,"search"===n.type&&t.inputTypeSearch,n.startAdornment&&t.inputAdornedStart,n.endAdornment&&t.inputAdornedEnd,n.hiddenLabel&&t.inputHiddenLabel]},ze=(0,A.ZP)("div",{name:"MuiInputBase",slot:"Root",overridesResolver:Ke})((function(e){var t=e.theme,n=e.ownerState;return(0,h.Z)({},t.typography.body1,(0,p.Z)({color:(t.vars||t).palette.text.primary,lineHeight:"1.4375em",boxSizing:"border-box",position:"relative",cursor:"text",display:"inline-flex",alignItems:"center"},"&.".concat(Ve.disabled),{color:(t.vars||t).palette.text.disabled,cursor:"default"}),n.multiline&&(0,h.Z)({padding:"4px 0 5px"},"small"===n.size&&{paddingTop:1}),n.fullWidth&&{width:"100%"})})),Ze=(0,A.ZP)("input",{name:"MuiInputBase",slot:"Input",overridesResolver:je})((function(e){var t,n=e.theme,o=e.ownerState,r="light"===n.palette.mode,i=(0,h.Z)({color:"currentColor"},n.vars?{opacity:n.vars.opacity.inputPlaceholder}:{opacity:r?.42:.5},{transition:n.transitions.create("opacity",{duration:n.transitions.duration.shorter})}),a={opacity:"0 !important"},s=n.vars?{opacity:n.vars.opacity.inputPlaceholder}:{opacity:r?.42:.5};return(0,h.Z)((t={font:"inherit",letterSpacing:"inherit",color:"currentColor",padding:"4px 0 5px",border:0,boxSizing:"content-box",background:"none",height:"1.4375em",margin:0,WebkitTapHighlightColor:"transparent",display:"block",minWidth:0,width:"100%",animationName:"mui-auto-fill-cancel",animationDuration:"10ms","&::-webkit-input-placeholder":i,"&::-moz-placeholder":i,"&:-ms-input-placeholder":i,"&::-ms-input-placeholder":i,"&:focus":{outline:0},"&:invalid":{boxShadow:"none"},"&::-webkit-search-decoration":{WebkitAppearance:"none"}},(0,p.Z)(t,"label[data-shrink=false] + .".concat(Ve.formControl," &"),{"&::-webkit-input-placeholder":a,"&::-moz-placeholder":a,"&:-ms-input-placeholder":a,"&::-ms-input-placeholder":a,"&:focus::-webkit-input-placeholder":s,"&:focus::-moz-placeholder":s,"&:focus:-ms-input-placeholder":s,"&:focus::-ms-input-placeholder":s}),(0,p.Z)(t,"&.".concat(Ve.disabled),{opacity:1,WebkitTextFillColor:(n.vars||n).palette.text.disabled}),(0,p.Z)(t,"&:-webkit-autofill",{animationDuration:"5000s",animationName:"mui-auto-fill"}),t),"small"===o.size&&{paddingTop:1},o.multiline&&{height:"auto",resize:"none",padding:0,paddingTop:0},"search"===o.type&&{MozAppearance:"textfield"})})),We=(0,C.jsx)(xe,{styles:{"@keyframes mui-auto-fill":{from:{display:"block"}},"@keyframes mui-auto-fill-cancel":{from:{display:"block"}}}}),Ye=e.forwardRef((function(t,n){var o,i=(0,L.Z)({props:t,name:"MuiInputBase"}),a=i["aria-describedby"],s=i.autoComplete,u=i.autoFocus,c=i.className,l=i.components,d=void 0===l?{}:l,p=i.componentsProps,v=void 0===p?{}:p,m=i.defaultValue,y=i.disabled,M=i.disableInjectingGlobalStyles,I=i.endAdornment,k=i.fullWidth,T=void 0!==k&&k,S=i.id,b=i.inputComponent,D=void 0===b?"input":b,A=i.inputProps,R=void 0===A?{}:A,w=i.inputRef,O=i.maxRows,N=i.minRows,P=i.multiline,G=void 0!==P&&P,U=i.name,x=i.onBlur,F=i.onChange,q=i.onClick,B=i.onFocus,V=i.onKeyDown,H=i.onKeyUp,K=i.placeholder,j=i.readOnly,z=i.renderSuffix,Z=i.rows,W=i.slotProps,Y=void 0===W?{}:W,J=i.slots,X=void 0===J?{}:J,$=i.startAdornment,Q=i.type,ee=void 0===Q?"text":Q,te=i.value,ne=(0,f.Z)(i,He),re=null!=R.value?R.value:te,ie=e.useRef(null!=re).current,ae=e.useRef(),se=e.useCallback((function(e){0}),[]),ue=(0,oe.Z)(ae,w,R.ref,se),ce=e.useState(!1),le=(0,r.Z)(ce,2),de=le[0],pe=le[1],fe=Ne();var he=we({props:i,muiFormControl:fe,states:["color","disabled","error","hiddenLabel","size","required","filled"]});he.focused=fe?fe.focused:de,e.useEffect((function(){!fe&&y&&de&&(pe(!1),x&&x())}),[fe,y,de,x]);var ge=fe&&fe.onFilled,ve=fe&&fe.onEmpty,me=e.useCallback((function(e){qe(e)?ge&&ge():ve&&ve()}),[ge,ve]);(0,Pe.Z)((function(){ie&&me({value:re})}),[re,me,ie]);e.useEffect((function(){me(ae.current)}),[]);var _e=D,Me=R;G&&"input"===_e&&(Me=Z?(0,h.Z)({type:void 0,minRows:Z,maxRows:Z},Me):(0,h.Z)({type:void 0,maxRows:O,minRows:N},Me),_e=Le);e.useEffect((function(){fe&&fe.setAdornedStart(Boolean($))}),[fe,$]);var Ie=(0,h.Z)({},i,{color:he.color||"primary",disabled:he.disabled,endAdornment:I,error:he.error,focused:he.focused,formControl:fe,fullWidth:T,hiddenLabel:he.hiddenLabel,multiline:G,size:he.size,startAdornment:$,type:ee}),Ce=function(e){var t=e.classes,n=e.color,o=e.disabled,r=e.error,i=e.endAdornment,a=e.focused,s=e.formControl,u=e.fullWidth,c=e.hiddenLabel,l=e.multiline,d=e.readOnly,p=e.size,f=e.startAdornment,h=e.type,g={root:["root","color".concat((0,E.Z)(n)),o&&"disabled",r&&"error",u&&"fullWidth",a&&"focused",s&&"formControl","small"===p&&"sizeSmall",l&&"multiline",f&&"adornedStart",i&&"adornedEnd",c&&"hiddenLabel",d&&"readOnly"],input:["input",o&&"disabled","search"===h&&"inputTypeSearch",l&&"inputMultiline","small"===p&&"inputSizeSmall",c&&"inputHiddenLabel",f&&"inputAdornedStart",i&&"inputAdornedEnd",d&&"readOnly"]};return(0,_.Z)(g,Be,t)}(Ie),ke=X.root||d.Root||ze,Te=Y.root||v.root||{},Se=X.input||d.Input||Ze;return Me=(0,h.Z)({},Me,null!=(o=Y.input)?o:v.input),(0,C.jsxs)(e.Fragment,{children:[!M&&We,(0,C.jsxs)(ke,(0,h.Z)({},Te,!Re(ke)&&{ownerState:(0,h.Z)({},Ie,Te.ownerState)},{ref:n,onClick:function(e){ae.current&&e.currentTarget===e.target&&ae.current.focus(),q&&q(e)}},ne,{className:(0,g.Z)(Ce.root,Te.className,c,j&&"MuiInputBase-readOnly"),children:[$,(0,C.jsx)(Oe.Provider,{value:null,children:(0,C.jsx)(Se,(0,h.Z)({ownerState:Ie,"aria-invalid":he.error,"aria-describedby":a,autoComplete:s,autoFocus:u,defaultValue:m,disabled:he.disabled,id:S,onAnimationStart:function(e){me("mui-auto-fill-cancel"===e.animationName?ae.current:{value:"x"})},name:U,placeholder:K,readOnly:j,required:he.required,rows:Z,value:re,onKeyDown:V,onKeyUp:H,type:ee},Me,!Re(Se)&&{as:_e,ownerState:(0,h.Z)({},Ie,Me.ownerState)},{ref:ue,className:(0,g.Z)(Ce.input,Me.className,j&&"MuiInputBase-readOnly"),onBlur:function(e){x&&x(e),R.onBlur&&R.onBlur(e),fe&&fe.onBlur?fe.onBlur(e):pe(!1)},onChange:function(e){if(!ie){var t=e.target||ae.current;if(null==t)throw new Error((0,ye.Z)(1));me({value:t.value})}for(var n=arguments.length,o=new Array(n>1?n-1:0),r=1;r<n;r++)o[r-1]=arguments[r];R.onChange&&R.onChange.apply(R,[e].concat(o)),F&&F.apply(void 0,[e].concat(o))},onFocus:function(e){he.disabled?e.stopPropagation():(B&&B(e),R.onFocus&&R.onFocus(e),fe&&fe.onFocus?fe.onFocus(e):pe(!0))}}))}),I,z?z((0,h.Z)({},he,{startAdornment:$})):null]}))]})})),Je=Ye;function Xe(e){return(0,m.Z)("MuiInput",e)}var $e=(0,h.Z)({},Ve,(0,Y.Z)("MuiInput",["root","underline","input"])),Qe=["disableUnderline","components","componentsProps","fullWidth","inputComponent","multiline","slotProps","slots","type"],et=(0,A.ZP)(ze,{shouldForwardProp:function(e){return(0,A.FO)(e)||"classes"===e},name:"MuiInput",slot:"Root",overridesResolver:function(e,t){var n=e.ownerState;return[].concat((0,N.Z)(Ke(e,t)),[!n.disableUnderline&&t.underline])}})((function(e){var t,n=e.theme,o=e.ownerState,r="light"===n.palette.mode?"rgba(0, 0, 0, 0.42)":"rgba(255, 255, 255, 0.7)";return n.vars&&(r="rgba(".concat(n.vars.palette.common.onBackgroundChannel," / ").concat(n.vars.opacity.inputUnderline,")")),(0,h.Z)({position:"relative"},o.formControl&&{"label + &":{marginTop:16}},!o.disableUnderline&&(t={"&:after":{borderBottom:"2px solid ".concat((n.vars||n).palette[o.color].main),left:0,bottom:0,content:'""',position:"absolute",right:0,transform:"scaleX(0)",transition:n.transitions.create("transform",{duration:n.transitions.duration.shorter,easing:n.transitions.easing.easeOut}),pointerEvents:"none"}},(0,p.Z)(t,"&.".concat($e.focused,":after"),{transform:"scaleX(1) translateX(0)"}),(0,p.Z)(t,"&.".concat($e.error),{"&:before, &:after":{borderBottomColor:(n.vars||n).palette.error.main}}),(0,p.Z)(t,"&:before",{borderBottom:"1px solid ".concat(r),left:0,bottom:0,content:'"\\00a0"',position:"absolute",right:0,transition:n.transitions.create("border-bottom-color",{duration:n.transitions.duration.shorter}),pointerEvents:"none"}),(0,p.Z)(t,"&:hover:not(.".concat($e.disabled,", .").concat($e.error,"):before"),{borderBottom:"2px solid ".concat((n.vars||n).palette.text.primary),"@media (hover: none)":{borderBottom:"1px solid ".concat(r)}}),(0,p.Z)(t,"&.".concat($e.disabled,":before"),{borderBottomStyle:"dotted"}),t))})),tt=(0,A.ZP)(Ze,{name:"MuiInput",slot:"Input",overridesResolver:je})({}),nt=e.forwardRef((function(e,t){var n,o,r,i,a=(0,L.Z)({props:e,name:"MuiInput"}),s=a.disableUnderline,u=a.components,c=void 0===u?{}:u,l=a.componentsProps,d=a.fullWidth,p=void 0!==d&&d,g=a.inputComponent,v=void 0===g?"input":g,m=a.multiline,y=void 0!==m&&m,M=a.slotProps,I=a.slots,k=void 0===I?{}:I,T=a.type,S=void 0===T?"text":T,b=(0,f.Z)(a,Qe),D=function(e){var t=e.classes,n={root:["root",!e.disableUnderline&&"underline"],input:["input"]},o=(0,_.Z)(n,Xe,t);return(0,h.Z)({},t,o)}(a),E={root:{ownerState:{disableUnderline:s}}},A=(null!=M?M:l)?(0,O.Z)(null!=M?M:l,E):E,R=null!=(n=null!=(o=k.root)?o:c.Root)?n:et,w=null!=(r=null!=(i=k.input)?i:c.Input)?r:tt;return(0,C.jsx)(Je,(0,h.Z)({slots:{root:R,input:w},slotProps:A,fullWidth:p,inputComponent:v,multiline:y,ref:t,type:S},b,{classes:D}))}));nt.muiName="Input";var ot=nt;function rt(e){return(0,m.Z)("MuiFilledInput",e)}var it=(0,h.Z)({},Ve,(0,Y.Z)("MuiFilledInput",["root","underline","input"])),at=["disableUnderline","components","componentsProps","fullWidth","hiddenLabel","inputComponent","multiline","slotProps","slots","type"],st=(0,A.ZP)(ze,{shouldForwardProp:function(e){return(0,A.FO)(e)||"classes"===e},name:"MuiFilledInput",slot:"Root",overridesResolver:function(e,t){var n=e.ownerState;return[].concat((0,N.Z)(Ke(e,t)),[!n.disableUnderline&&t.underline])}})((function(e){var t,n,o,r=e.theme,i=e.ownerState,a="light"===r.palette.mode,s=a?"rgba(0, 0, 0, 0.42)":"rgba(255, 255, 255, 0.7)",u=a?"rgba(0, 0, 0, 0.06)":"rgba(255, 255, 255, 0.09)",c=a?"rgba(0, 0, 0, 0.09)":"rgba(255, 255, 255, 0.13)",l=a?"rgba(0, 0, 0, 0.12)":"rgba(255, 255, 255, 0.12)";return(0,h.Z)((t={position:"relative",backgroundColor:r.vars?r.vars.palette.FilledInput.bg:u,borderTopLeftRadius:(r.vars||r).shape.borderRadius,borderTopRightRadius:(r.vars||r).shape.borderRadius,transition:r.transitions.create("background-color",{duration:r.transitions.duration.shorter,easing:r.transitions.easing.easeOut}),"&:hover":{backgroundColor:r.vars?r.vars.palette.FilledInput.hoverBg:c,"@media (hover: none)":{backgroundColor:r.vars?r.vars.palette.FilledInput.bg:u}}},(0,p.Z)(t,"&.".concat(it.focused),{backgroundColor:r.vars?r.vars.palette.FilledInput.bg:u}),(0,p.Z)(t,"&.".concat(it.disabled),{backgroundColor:r.vars?r.vars.palette.FilledInput.disabledBg:l}),t),!i.disableUnderline&&(n={"&:after":{borderBottom:"2px solid ".concat(null==(o=(r.vars||r).palette[i.color||"primary"])?void 0:o.main),left:0,bottom:0,content:'""',position:"absolute",right:0,transform:"scaleX(0)",transition:r.transitions.create("transform",{duration:r.transitions.duration.shorter,easing:r.transitions.easing.easeOut}),pointerEvents:"none"}},(0,p.Z)(n,"&.".concat(it.focused,":after"),{transform:"scaleX(1) translateX(0)"}),(0,p.Z)(n,"&.".concat(it.error),{"&:before, &:after":{borderBottomColor:(r.vars||r).palette.error.main}}),(0,p.Z)(n,"&:before",{borderBottom:"1px solid ".concat(r.vars?"rgba(".concat(r.vars.palette.common.onBackgroundChannel," / ").concat(r.vars.opacity.inputUnderline,")"):s),left:0,bottom:0,content:'"\\00a0"',position:"absolute",right:0,transition:r.transitions.create("border-bottom-color",{duration:r.transitions.duration.shorter}),pointerEvents:"none"}),(0,p.Z)(n,"&:hover:not(.".concat(it.disabled,", .").concat(it.error,"):before"),{borderBottom:"1px solid ".concat((r.vars||r).palette.text.primary)}),(0,p.Z)(n,"&.".concat(it.disabled,":before"),{borderBottomStyle:"dotted"}),n),i.startAdornment&&{paddingLeft:12},i.endAdornment&&{paddingRight:12},i.multiline&&(0,h.Z)({padding:"25px 12px 8px"},"small"===i.size&&{paddingTop:21,paddingBottom:4},i.hiddenLabel&&{paddingTop:16,paddingBottom:17}))})),ut=(0,A.ZP)(Ze,{name:"MuiFilledInput",slot:"Input",overridesResolver:je})((function(e){var t=e.theme,n=e.ownerState;return(0,h.Z)({paddingTop:25,paddingRight:12,paddingBottom:8,paddingLeft:12},!t.vars&&{"&:-webkit-autofill":{WebkitBoxShadow:"light"===t.palette.mode?null:"0 0 0 100px #266798 inset",WebkitTextFillColor:"light"===t.palette.mode?null:"#fff",caretColor:"light"===t.palette.mode?null:"#fff",borderTopLeftRadius:"inherit",borderTopRightRadius:"inherit"}},t.vars&&(0,p.Z)({"&:-webkit-autofill":{borderTopLeftRadius:"inherit",borderTopRightRadius:"inherit"}},t.getColorSchemeSelector("dark"),{"&:-webkit-autofill":{WebkitBoxShadow:"0 0 0 100px #266798 inset",WebkitTextFillColor:"#fff",caretColor:"#fff"}}),"small"===n.size&&{paddingTop:21,paddingBottom:4},n.hiddenLabel&&{paddingTop:16,paddingBottom:17},n.multiline&&{paddingTop:0,paddingBottom:0,paddingLeft:0,paddingRight:0},n.startAdornment&&{paddingLeft:0},n.endAdornment&&{paddingRight:0},n.hiddenLabel&&"small"===n.size&&{paddingTop:8,paddingBottom:9})})),ct=e.forwardRef((function(e,t){var n,o,r,i,a=(0,L.Z)({props:e,name:"MuiFilledInput"}),s=a.components,u=void 0===s?{}:s,c=a.componentsProps,l=a.fullWidth,d=void 0!==l&&l,p=a.inputComponent,g=void 0===p?"input":p,v=a.multiline,m=void 0!==v&&v,y=a.slotProps,M=a.slots,I=void 0===M?{}:M,k=a.type,T=void 0===k?"text":k,S=(0,f.Z)(a,at),b=(0,h.Z)({},a,{fullWidth:d,inputComponent:g,multiline:m,type:T}),D=function(e){var t=e.classes,n={root:["root",!e.disableUnderline&&"underline"],input:["input"]},o=(0,_.Z)(n,rt,t);return(0,h.Z)({},t,o)}(a),E={root:{ownerState:b},input:{ownerState:b}},A=(null!=y?y:c)?(0,O.Z)(null!=y?y:c,E):E,R=null!=(n=null!=(o=I.root)?o:u.Root)?n:st,w=null!=(r=null!=(i=I.input)?i:u.Input)?r:ut;return(0,C.jsx)(Je,(0,h.Z)({slots:{root:R,input:w},componentsProps:A,fullWidth:d,inputComponent:g,multiline:m,ref:t,type:T},S,{classes:D}))}));ct.muiName="Input";var lt,dt=ct,pt=["children","classes","className","label","notched"],ft=(0,A.ZP)("fieldset")({textAlign:"left",position:"absolute",bottom:0,right:0,top:-5,left:0,margin:0,padding:"0 8px",pointerEvents:"none",borderRadius:"inherit",borderStyle:"solid",borderWidth:1,overflow:"hidden",minWidth:"0%"}),ht=(0,A.ZP)("legend")((function(e){var t=e.ownerState,n=e.theme;return(0,h.Z)({float:"unset",width:"auto",overflow:"hidden"},!t.withLabel&&{padding:0,lineHeight:"11px",transition:n.transitions.create("width",{duration:150,easing:n.transitions.easing.easeOut})},t.withLabel&&(0,h.Z)({display:"block",padding:0,height:11,fontSize:"0.75em",visibility:"hidden",maxWidth:.01,transition:n.transitions.create("max-width",{duration:50,easing:n.transitions.easing.easeOut}),whiteSpace:"nowrap","& > span":{paddingLeft:5,paddingRight:5,display:"inline-block",opacity:0,visibility:"visible"}},t.notched&&{maxWidth:"100%",transition:n.transitions.create("max-width",{duration:100,easing:n.transitions.easing.easeOut,delay:50})}))}));function gt(e){return(0,m.Z)("MuiOutlinedInput",e)}var vt=(0,h.Z)({},Ve,(0,Y.Z)("MuiOutlinedInput",["root","notchedOutline","input"])),mt=["components","fullWidth","inputComponent","label","multiline","notched","slots","type"],_t=(0,A.ZP)(ze,{shouldForwardProp:function(e){return(0,A.FO)(e)||"classes"===e},name:"MuiOutlinedInput",slot:"Root",overridesResolver:Ke})((function(e){var t,n=e.theme,o=e.ownerState,r="light"===n.palette.mode?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)";return(0,h.Z)((t={position:"relative",borderRadius:(n.vars||n).shape.borderRadius},(0,p.Z)(t,"&:hover .".concat(vt.notchedOutline),{borderColor:(n.vars||n).palette.text.primary}),(0,p.Z)(t,"@media (hover: none)",(0,p.Z)({},"&:hover .".concat(vt.notchedOutline),{borderColor:n.vars?"rgba(".concat(n.vars.palette.common.onBackgroundChannel," / 0.23)"):r})),(0,p.Z)(t,"&.".concat(vt.focused," .").concat(vt.notchedOutline),{borderColor:(n.vars||n).palette[o.color].main,borderWidth:2}),(0,p.Z)(t,"&.".concat(vt.error," .").concat(vt.notchedOutline),{borderColor:(n.vars||n).palette.error.main}),(0,p.Z)(t,"&.".concat(vt.disabled," .").concat(vt.notchedOutline),{borderColor:(n.vars||n).palette.action.disabled}),t),o.startAdornment&&{paddingLeft:14},o.endAdornment&&{paddingRight:14},o.multiline&&(0,h.Z)({padding:"16.5px 14px"},"small"===o.size&&{padding:"8.5px 14px"}))})),yt=(0,A.ZP)((function(e){var t=e.className,n=e.label,o=e.notched,r=(0,f.Z)(e,pt),i=null!=n&&""!==n,a=(0,h.Z)({},e,{notched:o,withLabel:i});return(0,C.jsx)(ft,(0,h.Z)({"aria-hidden":!0,className:t,ownerState:a},r,{children:(0,C.jsx)(ht,{ownerState:a,children:i?(0,C.jsx)("span",{children:n}):lt||(lt=(0,C.jsx)("span",{className:"notranslate",children:"\u200b"}))})}))}),{name:"MuiOutlinedInput",slot:"NotchedOutline",overridesResolver:function(e,t){return t.notchedOutline}})((function(e){var t=e.theme,n="light"===t.palette.mode?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)";return{borderColor:t.vars?"rgba(".concat(t.vars.palette.common.onBackgroundChannel," / 0.23)"):n}})),Mt=(0,A.ZP)(Ze,{name:"MuiOutlinedInput",slot:"Input",overridesResolver:je})((function(e){var t=e.theme,n=e.ownerState;return(0,h.Z)({padding:"16.5px 14px"},!t.vars&&{"&:-webkit-autofill":{WebkitBoxShadow:"light"===t.palette.mode?null:"0 0 0 100px #266798 inset",WebkitTextFillColor:"light"===t.palette.mode?null:"#fff",caretColor:"light"===t.palette.mode?null:"#fff",borderRadius:"inherit"}},t.vars&&(0,p.Z)({"&:-webkit-autofill":{borderRadius:"inherit"}},t.getColorSchemeSelector("dark"),{"&:-webkit-autofill":{WebkitBoxShadow:"0 0 0 100px #266798 inset",WebkitTextFillColor:"#fff",caretColor:"#fff"}}),"small"===n.size&&{padding:"8.5px 14px"},n.multiline&&{padding:0},n.startAdornment&&{paddingLeft:0},n.endAdornment&&{paddingRight:0})})),It=e.forwardRef((function(t,n){var o,r,i,a,s,u=(0,L.Z)({props:t,name:"MuiOutlinedInput"}),c=u.components,l=void 0===c?{}:c,d=u.fullWidth,p=void 0!==d&&d,g=u.inputComponent,v=void 0===g?"input":g,m=u.label,y=u.multiline,M=void 0!==y&&y,I=u.notched,k=u.slots,T=void 0===k?{}:k,S=u.type,b=void 0===S?"text":S,D=(0,f.Z)(u,mt),E=function(e){var t=e.classes,n=(0,_.Z)({root:["root"],notchedOutline:["notchedOutline"],input:["input"]},gt,t);return(0,h.Z)({},t,n)}(u),A=Ne(),R=we({props:u,muiFormControl:A,states:["required"]}),w=(0,h.Z)({},u,{color:R.color||"primary",disabled:R.disabled,error:R.error,focused:R.focused,formControl:A,fullWidth:p,hiddenLabel:R.hiddenLabel,multiline:M,size:R.size,type:b}),O=null!=(o=null!=(r=T.root)?r:l.Root)?o:_t,N=null!=(i=null!=(a=T.input)?a:l.Input)?i:Mt;return(0,C.jsx)(Je,(0,h.Z)({slots:{root:O,input:N},renderSuffix:function(t){return(0,C.jsx)(yt,{ownerState:w,className:E.notchedOutline,label:null!=m&&""!==m&&R.required?s||(s=(0,C.jsxs)(e.Fragment,{children:[m,"\u2009","*"]})):m,notched:"undefined"!==typeof I?I:Boolean(t.startAdornment||t.filled||t.focused)})},fullWidth:p,inputComponent:v,multiline:M,ref:n,type:b},D,{classes:(0,h.Z)({},E,{notchedOutline:null})}))}));It.muiName="Input";var Ct=It;function kt(e){return(0,m.Z)("MuiFormLabel",e)}var Tt=(0,Y.Z)("MuiFormLabel",["root","colorSecondary","focused","disabled","error","filled","required","asterisk"]),St=["children","className","color","component","disabled","error","filled","focused","required"],bt=(0,A.ZP)("label",{name:"MuiFormLabel",slot:"Root",overridesResolver:function(e,t){var n=e.ownerState;return(0,h.Z)({},t.root,"secondary"===n.color&&t.colorSecondary,n.filled&&t.filled)}})((function(e){var t,n=e.theme,o=e.ownerState;return(0,h.Z)({color:(n.vars||n).palette.text.secondary},n.typography.body1,(t={lineHeight:"1.4375em",padding:0,position:"relative"},(0,p.Z)(t,"&.".concat(Tt.focused),{color:(n.vars||n).palette[o.color].main}),(0,p.Z)(t,"&.".concat(Tt.disabled),{color:(n.vars||n).palette.text.disabled}),(0,p.Z)(t,"&.".concat(Tt.error),{color:(n.vars||n).palette.error.main}),t))})),Dt=(0,A.ZP)("span",{name:"MuiFormLabel",slot:"Asterisk",overridesResolver:function(e,t){return t.asterisk}})((function(e){var t=e.theme;return(0,p.Z)({},"&.".concat(Tt.error),{color:(t.vars||t).palette.error.main})})),Et=e.forwardRef((function(e,t){var n=(0,L.Z)({props:e,name:"MuiFormLabel"}),o=n.children,r=n.className,i=n.component,a=void 0===i?"label":i,s=(0,f.Z)(n,St),u=we({props:n,muiFormControl:Ne(),states:["color","required","focused","disabled","error","filled"]}),c=(0,h.Z)({},n,{color:u.color||"primary",component:a,disabled:u.disabled,error:u.error,filled:u.filled,focused:u.focused,required:u.required}),l=function(e){var t=e.classes,n=e.color,o=e.focused,r=e.disabled,i=e.error,a=e.filled,s=e.required,u={root:["root","color".concat((0,E.Z)(n)),r&&"disabled",i&&"error",a&&"filled",o&&"focused",s&&"required"],asterisk:["asterisk",i&&"error"]};return(0,_.Z)(u,kt,t)}(c);return(0,C.jsxs)(bt,(0,h.Z)({as:a,ownerState:c,className:(0,g.Z)(l.root,r),ref:t},s,{children:[o,u.required&&(0,C.jsxs)(Dt,{ownerState:c,"aria-hidden":!0,className:l.asterisk,children:["\u2009","*"]})]}))}));function At(e){return(0,m.Z)("MuiInputLabel",e)}(0,Y.Z)("MuiInputLabel",["root","focused","disabled","error","required","asterisk","formControl","sizeSmall","shrink","animated","standard","filled","outlined"]);var Lt=["disableAnimation","margin","shrink","variant","className"],Rt=(0,A.ZP)(Et,{shouldForwardProp:function(e){return(0,A.FO)(e)||"classes"===e},name:"MuiInputLabel",slot:"Root",overridesResolver:function(e,t){var n=e.ownerState;return[(0,p.Z)({},"& .".concat(Tt.asterisk),t.asterisk),t.root,n.formControl&&t.formControl,"small"===n.size&&t.sizeSmall,n.shrink&&t.shrink,!n.disableAnimation&&t.animated,t[n.variant]]}})((function(e){var t=e.theme,n=e.ownerState;return(0,h.Z)({display:"block",transformOrigin:"top left",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"100%"},n.formControl&&{position:"absolute",left:0,top:0,transform:"translate(0, 20px) scale(1)"},"small"===n.size&&{transform:"translate(0, 17px) scale(1)"},n.shrink&&{transform:"translate(0, -1.5px) scale(0.75)",transformOrigin:"top left",maxWidth:"133%"},!n.disableAnimation&&{transition:t.transitions.create(["color","transform","max-width"],{duration:t.transitions.duration.shorter,easing:t.transitions.easing.easeOut})},"filled"===n.variant&&(0,h.Z)({zIndex:1,pointerEvents:"none",transform:"translate(12px, 16px) scale(1)",maxWidth:"calc(100% - 24px)"},"small"===n.size&&{transform:"translate(12px, 13px) scale(1)"},n.shrink&&(0,h.Z)({userSelect:"none",pointerEvents:"auto",transform:"translate(12px, 7px) scale(0.75)",maxWidth:"calc(133% - 24px)"},"small"===n.size&&{transform:"translate(12px, 4px) scale(0.75)"})),"outlined"===n.variant&&(0,h.Z)({zIndex:1,pointerEvents:"none",transform:"translate(14px, 16px) scale(1)",maxWidth:"calc(100% - 24px)"},"small"===n.size&&{transform:"translate(14px, 9px) scale(1)"},n.shrink&&{userSelect:"none",pointerEvents:"auto",maxWidth:"calc(133% - 32px)",transform:"translate(14px, -9px) scale(0.75)"}))})),wt=e.forwardRef((function(e,t){var n=(0,L.Z)({name:"MuiInputLabel",props:e}),o=n.disableAnimation,r=void 0!==o&&o,i=n.shrink,a=n.className,s=(0,f.Z)(n,Lt),u=Ne(),c=i;"undefined"===typeof c&&u&&(c=u.filled||u.focused||u.adornedStart);var l=we({props:n,muiFormControl:u,states:["size","variant","required"]}),d=(0,h.Z)({},n,{disableAnimation:r,formControl:u,shrink:c,size:l.size,variant:l.variant,required:l.required}),p=function(e){var t=e.classes,n=e.formControl,o=e.size,r=e.shrink,i={root:["root",n&&"formControl",!e.disableAnimation&&"animated",r&&"shrink","small"===o&&"sizeSmall",e.variant],asterisk:[e.required&&"asterisk"]},a=(0,_.Z)(i,At,t);return(0,h.Z)({},t,a)}(d);return(0,C.jsx)(Rt,(0,h.Z)({"data-shrink":c,ownerState:d,ref:t,className:(0,g.Z)(p.root,a)},s,{classes:p}))})),Ot=n(2555);function Nt(e){return(0,m.Z)("MuiFormControl",e)}(0,Y.Z)("MuiFormControl",["root","marginNone","marginNormal","marginDense","fullWidth","disabled"]);var Pt=["children","className","color","component","disabled","error","focused","fullWidth","hiddenLabel","margin","required","size","variant"],Gt=(0,A.ZP)("div",{name:"MuiFormControl",slot:"Root",overridesResolver:function(e,t){var n=e.ownerState;return(0,h.Z)({},t.root,t["margin".concat((0,E.Z)(n.margin))],n.fullWidth&&t.fullWidth)}})((function(e){var t=e.ownerState;return(0,h.Z)({display:"inline-flex",flexDirection:"column",position:"relative",minWidth:0,padding:0,margin:0,border:0,verticalAlign:"top"},"normal"===t.margin&&{marginTop:16,marginBottom:8},"dense"===t.margin&&{marginTop:8,marginBottom:4},t.fullWidth&&{width:"100%"})})),Ut=e.forwardRef((function(t,n){var o=(0,L.Z)({props:t,name:"MuiFormControl"}),i=o.children,a=o.className,s=o.color,u=void 0===s?"primary":s,c=o.component,l=void 0===c?"div":c,d=o.disabled,p=void 0!==d&&d,v=o.error,m=void 0!==v&&v,y=o.focused,M=o.fullWidth,I=void 0!==M&&M,k=o.hiddenLabel,T=void 0!==k&&k,S=o.margin,b=void 0===S?"none":S,D=o.required,A=void 0!==D&&D,R=o.size,w=void 0===R?"medium":R,O=o.variant,N=void 0===O?"outlined":O,P=(0,f.Z)(o,Pt),G=(0,h.Z)({},o,{color:u,component:l,disabled:p,error:m,fullWidth:I,hiddenLabel:T,margin:b,required:A,size:w,variant:N}),U=function(e){var t=e.classes,n=e.margin,o=e.fullWidth,r={root:["root","none"!==n&&"margin".concat((0,E.Z)(n)),o&&"fullWidth"]};return(0,_.Z)(r,Nt,t)}(G),x=e.useState((function(){var t=!1;return i&&e.Children.forEach(i,(function(e){if((0,Ot.Z)(e,["Input","Select"])){var n=(0,Ot.Z)(e,["Select"])?e.props.input:e;n&&n.props.startAdornment&&(t=!0)}})),t})),F=(0,r.Z)(x,2),q=F[0],B=F[1],V=e.useState((function(){var t=!1;return i&&e.Children.forEach(i,(function(e){(0,Ot.Z)(e,["Input","Select"])&&qe(e.props,!0)&&(t=!0)})),t})),H=(0,r.Z)(V,2),K=H[0],j=H[1],z=e.useState(!1),Z=(0,r.Z)(z,2),W=Z[0],Y=Z[1];p&&W&&Y(!1);var J,X=void 0===y||p?W:y,$=e.useMemo((function(){return{adornedStart:q,setAdornedStart:B,color:u,disabled:p,error:m,filled:K,focused:X,fullWidth:I,hiddenLabel:T,size:w,onBlur:function(){Y(!1)},onEmpty:function(){j(!1)},onFilled:function(){j(!0)},onFocus:function(){Y(!0)},registerEffect:J,required:A,variant:N}}),[q,u,p,m,K,X,I,T,J,A,w,N]);return(0,C.jsx)(Oe.Provider,{value:$,children:(0,C.jsx)(Gt,(0,h.Z)({as:l,ownerState:G,className:(0,g.Z)(U.root,a),ref:n},P,{children:i}))})}));function xt(e){return(0,m.Z)("MuiFormHelperText",e)}var Ft,qt=(0,Y.Z)("MuiFormHelperText",["root","error","disabled","sizeSmall","sizeMedium","contained","focused","filled","required"]),Bt=["children","className","component","disabled","error","filled","focused","margin","required","variant"],Vt=(0,A.ZP)("p",{name:"MuiFormHelperText",slot:"Root",overridesResolver:function(e,t){var n=e.ownerState;return[t.root,n.size&&t["size".concat((0,E.Z)(n.size))],n.contained&&t.contained,n.filled&&t.filled]}})((function(e){var t,n=e.theme,o=e.ownerState;return(0,h.Z)({color:(n.vars||n).palette.text.secondary},n.typography.caption,(t={textAlign:"left",marginTop:3,marginRight:0,marginBottom:0,marginLeft:0},(0,p.Z)(t,"&.".concat(qt.disabled),{color:(n.vars||n).palette.text.disabled}),(0,p.Z)(t,"&.".concat(qt.error),{color:(n.vars||n).palette.error.main}),t),"small"===o.size&&{marginTop:4},o.contained&&{marginLeft:14,marginRight:14})})),Ht=e.forwardRef((function(e,t){var n=(0,L.Z)({props:e,name:"MuiFormHelperText"}),o=n.children,r=n.className,i=n.component,a=void 0===i?"p":i,s=(0,f.Z)(n,Bt),u=we({props:n,muiFormControl:Ne(),states:["variant","size","disabled","error","filled","focused","required"]}),c=(0,h.Z)({},n,{component:a,contained:"filled"===u.variant||"outlined"===u.variant,variant:u.variant,size:u.size,disabled:u.disabled,error:u.error,filled:u.filled,focused:u.focused,required:u.required}),l=function(e){var t=e.classes,n=e.contained,o=e.size,r=e.disabled,i=e.error,a=e.filled,s=e.focused,u=e.required,c={root:["root",r&&"disabled",i&&"error",o&&"size".concat((0,E.Z)(o)),n&&"contained",s&&"focused",a&&"filled",u&&"required"]};return(0,_.Z)(c,xt,t)}(c);return(0,C.jsx)(Vt,(0,h.Z)({as:a,ownerState:c,className:(0,g.Z)(l.root,r),ref:t},s,{children:" "===o?Ft||(Ft=(0,C.jsx)("span",{className:"notranslate",children:"\u200b"})):o}))})),Kt=(n(6727),n(8011));var jt=e.createContext({});function zt(e){return(0,m.Z)("MuiList",e)}(0,Y.Z)("MuiList",["root","padding","dense","subheader"]);var Zt=["children","className","component","dense","disablePadding","subheader"],Wt=(0,A.ZP)("ul",{name:"MuiList",slot:"Root",overridesResolver:function(e,t){var n=e.ownerState;return[t.root,!n.disablePadding&&t.padding,n.dense&&t.dense,n.subheader&&t.subheader]}})((function(e){var t=e.ownerState;return(0,h.Z)({listStyle:"none",margin:0,padding:0,position:"relative"},!t.disablePadding&&{paddingTop:8,paddingBottom:8},t.subheader&&{paddingTop:0})})),Yt=e.forwardRef((function(t,n){var o=(0,L.Z)({props:t,name:"MuiList"}),r=o.children,i=o.className,a=o.component,s=void 0===a?"ul":a,u=o.dense,c=void 0!==u&&u,l=o.disablePadding,d=void 0!==l&&l,p=o.subheader,v=(0,f.Z)(o,Zt),m=e.useMemo((function(){return{dense:c}}),[c]),y=(0,h.Z)({},o,{component:s,dense:c,disablePadding:d}),M=function(e){var t=e.classes,n={root:["root",!e.disablePadding&&"padding",e.dense&&"dense",e.subheader&&"subheader"]};return(0,_.Z)(n,zt,t)}(y);return(0,C.jsx)(jt.Provider,{value:m,children:(0,C.jsxs)(Wt,(0,h.Z)({as:s,className:(0,g.Z)(M.root,i),ref:n,ownerState:y},v,{children:[p,r]}))})}));function Jt(e){var t=e.documentElement.clientWidth;return Math.abs(window.innerWidth-t)}var Xt=Jt,$t=["actions","autoFocus","autoFocusItem","children","className","disabledItemsFocusable","disableListWrap","onKeyDown","variant"];function Qt(e,t,n){return e===t?e.firstChild:t&&t.nextElementSibling?t.nextElementSibling:n?null:e.firstChild}function en(e,t,n){return e===t?n?e.firstChild:e.lastChild:t&&t.previousElementSibling?t.previousElementSibling:n?null:e.lastChild}function tn(e,t){if(void 0===t)return!0;var n=e.innerText;return void 0===n&&(n=e.textContent),0!==(n=n.trim().toLowerCase()).length&&(t.repeating?n[0]===t.keys[0]:0===n.indexOf(t.keys.join("")))}function nn(e,t,n,o,r,i){for(var a=!1,s=r(e,t,!!t&&n);s;){if(s===e.firstChild){if(a)return!1;a=!0}var u=!o&&(s.disabled||"true"===s.getAttribute("aria-disabled"));if(s.hasAttribute("tabindex")&&tn(s,i)&&!u)return s.focus(),!0;s=r(e,s,n)}return!1}var on=e.forwardRef((function(t,n){var o=t.actions,r=t.autoFocus,i=void 0!==r&&r,a=t.autoFocusItem,s=void 0!==a&&a,u=t.children,c=t.className,l=t.disabledItemsFocusable,d=void 0!==l&&l,p=t.disableListWrap,g=void 0!==p&&p,v=t.onKeyDown,m=t.variant,_=void 0===m?"selectedMenu":m,y=(0,f.Z)(t,$t),M=e.useRef(null),I=e.useRef({keys:[],repeating:!0,previousKeyMatched:!0,lastTime:null});(0,Pe.Z)((function(){i&&M.current.focus()}),[i]),e.useImperativeHandle(o,(function(){return{adjustStyleForScrollbar:function(e,t){var n=!M.current.style.width;if(e.clientHeight<M.current.clientHeight&&n){var o="".concat(Xt((0,Kt.Z)(e)),"px");M.current.style["rtl"===t.direction?"paddingLeft":"paddingRight"]=o,M.current.style.width="calc(100% + ".concat(o,")")}return M.current}}}),[]);var k=(0,oe.Z)(M,n),T=-1;e.Children.forEach(u,(function(t,n){e.isValidElement(t)&&(t.props.disabled||("selectedMenu"===_&&t.props.selected||-1===T)&&(T=n),T===n&&(t.props.disabled||t.props.muiSkipListHighlight||t.type.muiSkipListHighlight)&&(T+=1)>=u.length&&(T=-1))}));var S=e.Children.map(u,(function(t,n){if(n===T){var o={};return s&&(o.autoFocus=!0),void 0===t.props.tabIndex&&"selectedMenu"===_&&(o.tabIndex=0),e.cloneElement(t,o)}return t}));return(0,C.jsx)(Yt,(0,h.Z)({role:"menu",ref:k,className:c,onKeyDown:function(e){var t=M.current,n=e.key,o=(0,Kt.Z)(t).activeElement;if("ArrowDown"===n)e.preventDefault(),nn(t,o,g,d,Qt);else if("ArrowUp"===n)e.preventDefault(),nn(t,o,g,d,en);else if("Home"===n)e.preventDefault(),nn(t,null,g,d,Qt);else if("End"===n)e.preventDefault(),nn(t,null,g,d,en);else if(1===n.length){var r=I.current,i=n.toLowerCase(),a=performance.now();r.keys.length>0&&(a-r.lastTime>500?(r.keys=[],r.repeating=!0,r.previousKeyMatched=!0):r.repeating&&i!==r.keys[0]&&(r.repeating=!1)),r.lastTime=a,r.keys.push(i);var s=o&&!r.repeating&&tn(o,r);r.previousKeyMatched&&(s||nn(t,o,!1,d,Qt,r))?e.preventDefault():r.previousKeyMatched=!1}v&&v(e)},tabIndex:i?0:-1},y,{children:S}))})),rn=function(e){return((e<1?5.11916*Math.pow(e,2):4.5*Math.log(e+1)+2)/100).toFixed(2)};function an(e){return(0,m.Z)("MuiPaper",e)}(0,Y.Z)("MuiPaper",["root","rounded","outlined","elevation","elevation0","elevation1","elevation2","elevation3","elevation4","elevation5","elevation6","elevation7","elevation8","elevation9","elevation10","elevation11","elevation12","elevation13","elevation14","elevation15","elevation16","elevation17","elevation18","elevation19","elevation20","elevation21","elevation22","elevation23","elevation24"]);var sn=["className","component","elevation","square","variant"],un=(0,A.ZP)("div",{name:"MuiPaper",slot:"Root",overridesResolver:function(e,t){var n=e.ownerState;return[t.root,t[n.variant],!n.square&&t.rounded,"elevation"===n.variant&&t["elevation".concat(n.elevation)]]}})((function(e){var t,n=e.theme,o=e.ownerState;return(0,h.Z)({backgroundColor:(n.vars||n).palette.background.paper,color:(n.vars||n).palette.text.primary,transition:n.transitions.create("box-shadow")},!o.square&&{borderRadius:n.shape.borderRadius},"outlined"===o.variant&&{border:"1px solid ".concat((n.vars||n).palette.divider)},"elevation"===o.variant&&(0,h.Z)({boxShadow:(n.vars||n).shadows[o.elevation]},!n.vars&&"dark"===n.palette.mode&&{backgroundImage:"linear-gradient(".concat((0,se.Fq)("#fff",rn(o.elevation)),", ").concat((0,se.Fq)("#fff",rn(o.elevation)),")")},n.vars&&{backgroundImage:null==(t=n.vars.overlays)?void 0:t[o.elevation]}))})),cn=e.forwardRef((function(e,t){var n=(0,L.Z)({props:e,name:"MuiPaper"}),o=n.className,r=n.component,i=void 0===r?"div":r,a=n.elevation,s=void 0===a?1:a,u=n.square,c=void 0!==u&&u,l=n.variant,d=void 0===l?"elevation":l,p=(0,f.Z)(n,sn),v=(0,h.Z)({},n,{component:i,elevation:s,square:c,variant:d}),m=function(e){var t=e.square,n=e.elevation,o=e.variant,r=e.classes,i={root:["root",o,!t&&"rounded","elevation"===o&&"elevation".concat(n)]};return(0,_.Z)(i,an,r)}(v);return(0,C.jsx)(un,(0,h.Z)({as:i,ownerState:v,className:(0,g.Z)(m.root,o),ref:t},p))})),ln=n(8755),dn=n(9860);function pn(e,t){return pn=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},pn(e,t)}function fn(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,pn(e,t)}var hn=!1,gn=e.createContext(null),vn="unmounted",mn="exited",_n="entering",yn="entered",Mn="exiting",In=function(t){function n(e,n){var o;o=t.call(this,e,n)||this;var r,i=n&&!n.isMounting?e.enter:e.appear;return o.appearStatus=null,e.in?i?(r=mn,o.appearStatus=_n):r=yn:r=e.unmountOnExit||e.mountOnEnter?vn:mn,o.state={status:r},o.nextCallback=null,o}fn(n,t),n.getDerivedStateFromProps=function(e,t){return e.in&&t.status===vn?{status:mn}:null};var o=n.prototype;return o.componentDidMount=function(){this.updateStatus(!0,this.appearStatus)},o.componentDidUpdate=function(e){var t=null;if(e!==this.props){var n=this.state.status;this.props.in?n!==_n&&n!==yn&&(t=_n):n!==_n&&n!==yn||(t=Mn)}this.updateStatus(!1,t)},o.componentWillUnmount=function(){this.cancelNextCallback()},o.getTimeouts=function(){var e,t,n,o=this.props.timeout;return e=t=n=o,null!=o&&"number"!==typeof o&&(e=o.exit,t=o.enter,n=void 0!==o.appear?o.appear:t),{exit:e,enter:t,appear:n}},o.updateStatus=function(e,t){if(void 0===e&&(e=!1),null!==t)if(this.cancelNextCallback(),t===_n){if(this.props.unmountOnExit||this.props.mountOnEnter){var n=this.props.nodeRef?this.props.nodeRef.current:Me.findDOMNode(this);n&&function(e){e.scrollTop}(n)}this.performEnter(e)}else this.performExit();else this.props.unmountOnExit&&this.state.status===mn&&this.setState({status:vn})},o.performEnter=function(e){var t=this,n=this.props.enter,o=this.context?this.context.isMounting:e,r=this.props.nodeRef?[o]:[Me.findDOMNode(this),o],i=r[0],a=r[1],s=this.getTimeouts(),u=o?s.appear:s.enter;!e&&!n||hn?this.safeSetState({status:yn},(function(){t.props.onEntered(i)})):(this.props.onEnter(i,a),this.safeSetState({status:_n},(function(){t.props.onEntering(i,a),t.onTransitionEnd(u,(function(){t.safeSetState({status:yn},(function(){t.props.onEntered(i,a)}))}))})))},o.performExit=function(){var e=this,t=this.props.exit,n=this.getTimeouts(),o=this.props.nodeRef?void 0:Me.findDOMNode(this);t&&!hn?(this.props.onExit(o),this.safeSetState({status:Mn},(function(){e.props.onExiting(o),e.onTransitionEnd(n.exit,(function(){e.safeSetState({status:mn},(function(){e.props.onExited(o)}))}))}))):this.safeSetState({status:mn},(function(){e.props.onExited(o)}))},o.cancelNextCallback=function(){null!==this.nextCallback&&(this.nextCallback.cancel(),this.nextCallback=null)},o.safeSetState=function(e,t){t=this.setNextCallback(t),this.setState(e,t)},o.setNextCallback=function(e){var t=this,n=!0;return this.nextCallback=function(o){n&&(n=!1,t.nextCallback=null,e(o))},this.nextCallback.cancel=function(){n=!1},this.nextCallback},o.onTransitionEnd=function(e,t){this.setNextCallback(t);var n=this.props.nodeRef?this.props.nodeRef.current:Me.findDOMNode(this),o=null==e&&!this.props.addEndListener;if(n&&!o){if(this.props.addEndListener){var r=this.props.nodeRef?[this.nextCallback]:[n,this.nextCallback],i=r[0],a=r[1];this.props.addEndListener(i,a)}null!=e&&setTimeout(this.nextCallback,e)}else setTimeout(this.nextCallback,0)},o.render=function(){var t=this.state.status;if(t===vn)return null;var n=this.props,o=n.children,r=(n.in,n.mountOnEnter,n.unmountOnExit,n.appear,n.enter,n.exit,n.timeout,n.addEndListener,n.onEnter,n.onEntering,n.onEntered,n.onExit,n.onExiting,n.onExited,n.nodeRef,(0,f.Z)(n,["children","in","mountOnEnter","unmountOnExit","appear","enter","exit","timeout","addEndListener","onEnter","onEntering","onEntered","onExit","onExiting","onExited","nodeRef"]));return e.createElement(gn.Provider,{value:null},"function"===typeof o?o(t,r):e.cloneElement(e.Children.only(o),r))},n}(e.Component);function Cn(){}In.contextType=gn,In.propTypes={},In.defaultProps={in:!1,mountOnEnter:!1,unmountOnExit:!1,appear:!1,enter:!0,exit:!0,onEnter:Cn,onEntering:Cn,onEntered:Cn,onExit:Cn,onExiting:Cn,onExited:Cn},In.UNMOUNTED=vn,In.EXITED=mn,In.ENTERING=_n,In.ENTERED=yn,In.EXITING=Mn;var kn=In,Tn=n(2318);function Sn(){return(0,Tn.Z)(Ue.Z)}var bn=function(e){return e.scrollTop};function Dn(e,t){var n,o,r=e.timeout,i=e.easing,a=e.style,s=void 0===a?{}:a;return{duration:null!=(n=s.transitionDuration)?n:"number"===typeof r?r:r[t.mode]||0,easing:null!=(o=s.transitionTimingFunction)?o:"object"===typeof i?i[t.mode]:i,delay:s.transitionDelay}}var En=["addEndListener","appear","children","easing","in","onEnter","onEntered","onEntering","onExit","onExited","onExiting","style","timeout","TransitionComponent"];function An(e){return"scale(".concat(e,", ").concat(Math.pow(e,2),")")}var Ln={entering:{opacity:1,transform:An(1)},entered:{opacity:1,transform:"none"}},Rn="undefined"!==typeof navigator&&/^((?!chrome|android).)*(safari|mobile)/i.test(navigator.userAgent)&&/(os |version\/)15(.|_)4/i.test(navigator.userAgent),wn=e.forwardRef((function(t,n){var o=t.addEndListener,r=t.appear,i=void 0===r||r,a=t.children,s=t.easing,u=t.in,c=t.onEnter,l=t.onEntered,d=t.onEntering,p=t.onExit,g=t.onExited,v=t.onExiting,m=t.style,_=t.timeout,y=void 0===_?"auto":_,M=t.TransitionComponent,I=void 0===M?kn:M,k=(0,f.Z)(t,En),T=e.useRef(),S=e.useRef(),b=Sn(),D=e.useRef(null),E=(0,oe.Z)(D,a.ref,n),A=function(e){return function(t){if(e){var n=D.current;void 0===t?e(n):e(n,t)}}},L=A(d),R=A((function(e,t){bn(e);var n,o=Dn({style:m,timeout:y,easing:s},{mode:"enter"}),r=o.duration,i=o.delay,a=o.easing;"auto"===y?(n=b.transitions.getAutoHeightDuration(e.clientHeight),S.current=n):n=r,e.style.transition=[b.transitions.create("opacity",{duration:n,delay:i}),b.transitions.create("transform",{duration:Rn?n:.666*n,delay:i,easing:a})].join(","),c&&c(e,t)})),w=A(l),O=A(v),N=A((function(e){var t,n=Dn({style:m,timeout:y,easing:s},{mode:"exit"}),o=n.duration,r=n.delay,i=n.easing;"auto"===y?(t=b.transitions.getAutoHeightDuration(e.clientHeight),S.current=t):t=o,e.style.transition=[b.transitions.create("opacity",{duration:t,delay:r}),b.transitions.create("transform",{duration:Rn?t:.666*t,delay:Rn?r:r||.333*t,easing:i})].join(","),e.style.opacity=0,e.style.transform=An(.75),p&&p(e)})),P=A(g);return e.useEffect((function(){return function(){clearTimeout(T.current)}}),[]),(0,C.jsx)(I,(0,h.Z)({appear:i,in:u,nodeRef:D,onEnter:R,onEntered:w,onEntering:L,onExit:N,onExited:P,onExiting:O,addEndListener:function(e){"auto"===y&&(T.current=setTimeout(e,S.current||0)),o&&o(D.current,e)},timeout:"auto"===y?null:y},k,{children:function(t,n){return e.cloneElement(a,(0,h.Z)({style:(0,h.Z)({opacity:0,transform:An(.75),visibility:"exited"!==t||u?void 0:"hidden"},Ln[t],m,a.props.style),ref:E},n))}}))}));wn.muiSupportAuto=!0;var On=wn,Nn=n(4481),Pn=n(8050),Gn=n(111),Un=n(6544);var xn=e.forwardRef((function(t,n){var o=t.children,i=t.container,a=t.disablePortal,s=void 0!==a&&a,u=e.useState(null),c=(0,r.Z)(u,2),l=c[0],d=c[1],p=(0,Ie.Z)(e.isValidElement(o)?o.ref:null,n);if((0,Te.Z)((function(){s||d(function(e){return"function"===typeof e?e():e}(i)||document.body)}),[i,s]),(0,Te.Z)((function(){if(l&&!s)return(0,Un.Z)(n,l),function(){(0,Un.Z)(n,null)}}),[n,l,s]),s){if(e.isValidElement(o)){var f={ref:p};return e.cloneElement(o,f)}return(0,C.jsx)(e.Fragment,{children:o})}return(0,C.jsx)(e.Fragment,{children:l?Me.createPortal(o,l):l})}));function Fn(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var qn=n(2958);function Bn(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,(0,qn.Z)(o.key),o)}}function Vn(e,t,n){return t&&Bn(e.prototype,t),n&&Bn(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function Hn(e,t){t?e.setAttribute("aria-hidden","true"):e.removeAttribute("aria-hidden")}function Kn(e){return parseInt((0,Ce.Z)(e).getComputedStyle(e).paddingRight,10)||0}function jn(e,t,n,o,r){var i=[t,n].concat((0,N.Z)(o));[].forEach.call(e.children,(function(e){var t=-1===i.indexOf(e),n=!function(e){var t=-1!==["TEMPLATE","SCRIPT","STYLE","LINK","MAP","META","NOSCRIPT","PICTURE","COL","COLGROUP","PARAM","SLOT","SOURCE","TRACK"].indexOf(e.tagName),n="INPUT"===e.tagName&&"hidden"===e.getAttribute("type");return t||n}(e);t&&n&&Hn(e,r)}))}function zn(e,t){var n=-1;return e.some((function(e,o){return!!t(e)&&(n=o,!0)})),n}function Zn(e,t){var n=[],o=e.container;if(!t.disableScrollLock){if(function(e){var t=(0,Nn.Z)(e);return t.body===e?(0,Ce.Z)(e).innerWidth>t.documentElement.clientWidth:e.scrollHeight>e.clientHeight}(o)){var r=Jt((0,Nn.Z)(o));n.push({value:o.style.paddingRight,property:"padding-right",el:o}),o.style.paddingRight="".concat(Kn(o)+r,"px");var i=(0,Nn.Z)(o).querySelectorAll(".mui-fixed");[].forEach.call(i,(function(e){n.push({value:e.style.paddingRight,property:"padding-right",el:e}),e.style.paddingRight="".concat(Kn(e)+r,"px")}))}var a;if(o.parentNode instanceof DocumentFragment)a=(0,Nn.Z)(o).body;else{var s=o.parentElement,u=(0,Ce.Z)(o);a="HTML"===(null==s?void 0:s.nodeName)&&"scroll"===u.getComputedStyle(s).overflowY?s:o}n.push({value:a.style.overflow,property:"overflow",el:a},{value:a.style.overflowX,property:"overflow-x",el:a},{value:a.style.overflowY,property:"overflow-y",el:a}),a.style.overflow="hidden"}return function(){n.forEach((function(e){var t=e.value,n=e.el,o=e.property;t?n.style.setProperty(o,t):n.style.removeProperty(o)}))}}var Wn=function(){function e(){Fn(this,e),this.containers=void 0,this.modals=void 0,this.modals=[],this.containers=[]}return Vn(e,[{key:"add",value:function(e,t){var n=this.modals.indexOf(e);if(-1!==n)return n;n=this.modals.length,this.modals.push(e),e.modalRef&&Hn(e.modalRef,!1);var o=function(e){var t=[];return[].forEach.call(e.children,(function(e){"true"===e.getAttribute("aria-hidden")&&t.push(e)})),t}(t);jn(t,e.mount,e.modalRef,o,!0);var r=zn(this.containers,(function(e){return e.container===t}));return-1!==r?(this.containers[r].modals.push(e),n):(this.containers.push({modals:[e],container:t,restore:null,hiddenSiblings:o}),n)}},{key:"mount",value:function(e,t){var n=zn(this.containers,(function(t){return-1!==t.modals.indexOf(e)})),o=this.containers[n];o.restore||(o.restore=Zn(o,t))}},{key:"remove",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this.modals.indexOf(e);if(-1===n)return n;var o=zn(this.containers,(function(t){return-1!==t.modals.indexOf(e)})),r=this.containers[o];if(r.modals.splice(r.modals.indexOf(e),1),this.modals.splice(n,1),0===r.modals.length)r.restore&&r.restore(),e.modalRef&&Hn(e.modalRef,t),jn(r.container,e.mount,e.modalRef,r.hiddenSiblings,!1),this.containers.splice(o,1);else{var i=r.modals[r.modals.length-1];i.modalRef&&Hn(i.modalRef,!1)}return n}},{key:"isTopModal",value:function(e){return this.modals.length>0&&this.modals[this.modals.length-1]===e}}]),e}(),Yn=["input","select","textarea","a[href]","button","[tabindex]","audio[controls]","video[controls]",'[contenteditable]:not([contenteditable="false"])'].join(",");function Jn(e){var t=[],n=[];return Array.from(e.querySelectorAll(Yn)).forEach((function(e,o){var r=function(e){var t=parseInt(e.getAttribute("tabindex")||"",10);return Number.isNaN(t)?"true"===e.contentEditable||("AUDIO"===e.nodeName||"VIDEO"===e.nodeName||"DETAILS"===e.nodeName)&&null===e.getAttribute("tabindex")?0:e.tabIndex:t}(e);-1!==r&&function(e){return!(e.disabled||"INPUT"===e.tagName&&"hidden"===e.type||function(e){if("INPUT"!==e.tagName||"radio"!==e.type)return!1;if(!e.name)return!1;var t=function(t){return e.ownerDocument.querySelector('input[type="radio"]'.concat(t))},n=t('[name="'.concat(e.name,'"]:checked'));return n||(n=t('[name="'.concat(e.name,'"]'))),n!==e}(e))}(e)&&(0===r?t.push(e):n.push({documentOrder:o,tabIndex:r,node:e}))})),n.sort((function(e,t){return e.tabIndex===t.tabIndex?e.documentOrder-t.documentOrder:e.tabIndex-t.tabIndex})).map((function(e){return e.node})).concat(t)}function Xn(){return!0}var $n=function(t){var n=t.children,o=t.disableAutoFocus,r=void 0!==o&&o,i=t.disableEnforceFocus,a=void 0!==i&&i,s=t.disableRestoreFocus,u=void 0!==s&&s,c=t.getTabbable,l=void 0===c?Jn:c,d=t.isEnabled,p=void 0===d?Xn:d,f=t.open,h=e.useRef(!1),g=e.useRef(null),v=e.useRef(null),m=e.useRef(null),_=e.useRef(null),y=e.useRef(!1),M=e.useRef(null),I=(0,Ie.Z)(n.ref,M),k=e.useRef(null);e.useEffect((function(){f&&M.current&&(y.current=!r)}),[r,f]),e.useEffect((function(){if(f&&M.current){var e=(0,Nn.Z)(M.current);return M.current.contains(e.activeElement)||(M.current.hasAttribute("tabIndex")||M.current.setAttribute("tabIndex","-1"),y.current&&M.current.focus()),function(){u||(m.current&&m.current.focus&&(h.current=!0,m.current.focus()),m.current=null)}}}),[f]),e.useEffect((function(){if(f&&M.current){var e=(0,Nn.Z)(M.current),t=function(t){var n=M.current;if(null!==n)if(e.hasFocus()&&!a&&p()&&!h.current){if(!n.contains(e.activeElement)){if(t&&_.current!==t.target||e.activeElement!==_.current)_.current=null;else if(null!==_.current)return;if(!y.current)return;var o=[];if(e.activeElement!==g.current&&e.activeElement!==v.current||(o=l(M.current)),o.length>0){var r,i,s=Boolean((null==(r=k.current)?void 0:r.shiftKey)&&"Tab"===(null==(i=k.current)?void 0:i.key)),u=o[0],c=o[o.length-1];"string"!==typeof u&&"string"!==typeof c&&(s?c.focus():u.focus())}else n.focus()}}else h.current=!1},n=function(t){k.current=t,!a&&p()&&"Tab"===t.key&&e.activeElement===M.current&&t.shiftKey&&(h.current=!0,v.current&&v.current.focus())};e.addEventListener("focusin",t),e.addEventListener("keydown",n,!0);var o=setInterval((function(){e.activeElement&&"BODY"===e.activeElement.tagName&&t(null)}),50);return function(){clearInterval(o),e.removeEventListener("focusin",t),e.removeEventListener("keydown",n,!0)}}}),[r,a,u,p,f,l]);var T=function(e){null===m.current&&(m.current=e.relatedTarget),y.current=!0};return(0,C.jsxs)(e.Fragment,{children:[(0,C.jsx)("div",{tabIndex:f?0:-1,onFocus:T,ref:g,"data-testid":"sentinelStart"}),e.cloneElement(n,{ref:I,onFocus:function(e){null===m.current&&(m.current=e.relatedTarget),y.current=!0,_.current=e.target;var t=n.props.onFocus;t&&t(e)}}),(0,C.jsx)("div",{tabIndex:f?0:-1,onFocus:T,ref:v,"data-testid":"sentinelEnd"})]})};function Qn(e){return(0,m.Z)("MuiModal",e)}(0,Y.Z)("MuiModal",["root","hidden","backdrop"]);function eo(e){if(void 0===e)return{};var t={};return Object.keys(e).filter((function(t){return!(t.match(/^on[A-Z]/)&&"function"===typeof e[t])})).forEach((function(n){t[n]=e[n]})),t}function to(e){var t=e.getSlotProps,n=e.additionalProps,o=e.externalSlotProps,r=e.externalForwardedProps,i=e.className;if(!t){var a=(0,g.Z)(null==r?void 0:r.className,null==o?void 0:o.className,i,null==n?void 0:n.className),s=(0,h.Z)({},null==n?void 0:n.style,null==r?void 0:r.style,null==o?void 0:o.style),u=(0,h.Z)({},n,r,o);return a.length>0&&(u.className=a),Object.keys(s).length>0&&(u.style=s),{props:u,internalRef:void 0}}var c=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(void 0===e)return{};var n={};return Object.keys(e).filter((function(n){return n.match(/^on[A-Z]/)&&"function"===typeof e[n]&&!t.includes(n)})).forEach((function(t){n[t]=e[t]})),n}((0,h.Z)({},r,o)),l=eo(o),d=eo(r),p=t(c),f=(0,g.Z)(null==p?void 0:p.className,null==n?void 0:n.className,i,null==r?void 0:r.className,null==o?void 0:o.className),v=(0,h.Z)({},null==p?void 0:p.style,null==n?void 0:n.style,null==r?void 0:r.style,null==o?void 0:o.style),m=(0,h.Z)({},p,n,d,l);return f.length>0&&(m.className=f),Object.keys(v).length>0&&(m.style=v),{props:m,internalRef:p.ref}}function no(e,t){return"function"===typeof e?e(t):e}var oo=["elementType","externalSlotProps","ownerState"];function ro(e){var t,n=e.elementType,o=e.externalSlotProps,r=e.ownerState,i=(0,f.Z)(e,oo),a=no(o,r),s=to((0,h.Z)({},i,{externalSlotProps:a})),u=s.props,c=s.internalRef,l=(0,Ie.Z)(c,null==a?void 0:a.ref,null==(t=e.additionalProps)?void 0:t.ref),d=function(e,t,n){return void 0===e||Re(e)?t:(0,h.Z)({},t,{ownerState:(0,h.Z)({},t.ownerState,n)})}(n,(0,h.Z)({},u,{ref:l}),r);return d}var io={disableDefaultClasses:!1},ao=e.createContext(io);var so=["children","closeAfterTransition","component","container","disableAutoFocus","disableEnforceFocus","disableEscapeKeyDown","disablePortal","disableRestoreFocus","disableScrollLock","hideBackdrop","keepMounted","manager","onBackdropClick","onClose","onKeyDown","open","onTransitionEnter","onTransitionExited","slotProps","slots"],uo=function(t){var n=t.open,o=t.exited,r={root:["root",!n&&o&&"hidden"],backdrop:["backdrop"]};return(0,_.Z)(r,function(t){var n=e.useContext(ao).disableDefaultClasses;return function(e){return n?"":t(e)}}(Qn))};var co=new Wn,lo=e.forwardRef((function(t,n){var o,i,a=t.children,s=t.closeAfterTransition,u=void 0!==s&&s,c=t.component,l=t.container,d=t.disableAutoFocus,p=void 0!==d&&d,g=t.disableEnforceFocus,v=void 0!==g&&g,m=t.disableEscapeKeyDown,_=void 0!==m&&m,y=t.disablePortal,M=void 0!==y&&y,I=t.disableRestoreFocus,k=void 0!==I&&I,T=t.disableScrollLock,S=void 0!==T&&T,b=t.hideBackdrop,D=void 0!==b&&b,E=t.keepMounted,A=void 0!==E&&E,L=t.manager,R=void 0===L?co:L,w=t.onBackdropClick,O=t.onClose,N=t.onKeyDown,P=t.open,G=t.onTransitionEnter,U=t.onTransitionExited,x=t.slotProps,F=void 0===x?{}:x,q=t.slots,B=void 0===q?{}:q,V=(0,f.Z)(t,so),H=e.useState(!P),K=(0,r.Z)(H,2),j=K[0],z=K[1],Z=e.useRef({}),W=e.useRef(null),Y=e.useRef(null),J=(0,Ie.Z)(Y,n),X=function(e){return!!e&&e.props.hasOwnProperty("in")}(a),$=null==(o=t["aria-hidden"])||o,Q=function(){return Z.current.modalRef=Y.current,Z.current.mountNode=W.current,Z.current},ee=function(){R.mount(Q(),{disableScrollLock:S}),Y.current&&(Y.current.scrollTop=0)},te=(0,Pn.Z)((function(){var e=function(e){return"function"===typeof e?e():e}(l)||(0,Nn.Z)(W.current).body;R.add(Q(),e),Y.current&&ee()})),ne=e.useCallback((function(){return R.isTopModal(Q())}),[R]),oe=(0,Pn.Z)((function(e){W.current=e,e&&Y.current&&(P&&ne()?ee():Hn(Y.current,$))})),re=e.useCallback((function(){R.remove(Q(),$)}),[R,$]);e.useEffect((function(){return function(){re()}}),[re]),e.useEffect((function(){P?te():X&&u||re()}),[P,re,X,u,te]);var ie=(0,h.Z)({},t,{closeAfterTransition:u,disableAutoFocus:p,disableEnforceFocus:v,disableEscapeKeyDown:_,disablePortal:M,disableRestoreFocus:k,disableScrollLock:S,exited:j,hideBackdrop:D,keepMounted:A}),ae=uo(ie),se={};void 0===a.props.tabIndex&&(se.tabIndex="-1"),X&&(se.onEnter=(0,Gn.Z)((function(){z(!1),G&&G()}),a.props.onEnter),se.onExited=(0,Gn.Z)((function(){z(!0),U&&U(),u&&re()}),a.props.onExited));var ue=null!=(i=null!=c?c:B.root)?i:"div",ce=ro({elementType:ue,externalSlotProps:F.root,externalForwardedProps:V,additionalProps:{ref:J,role:"presentation",onKeyDown:function(e){N&&N(e),"Escape"===e.key&&ne()&&(_||(e.stopPropagation(),O&&O(e,"escapeKeyDown")))}},className:ae.root,ownerState:ie}),le=B.backdrop,de=ro({elementType:le,externalSlotProps:F.backdrop,additionalProps:{"aria-hidden":!0,onClick:function(e){e.target===e.currentTarget&&(w&&w(e),O&&O(e,"backdropClick"))},open:P},className:ae.backdrop,ownerState:ie});return A||P||X&&!j?(0,C.jsx)(xn,{ref:oe,container:l,disablePortal:M,children:(0,C.jsxs)(ue,(0,h.Z)({},ce,{children:[!D&&le?(0,C.jsx)(le,(0,h.Z)({},de)):null,(0,C.jsx)($n,{disableEnforceFocus:v,disableAutoFocus:p,disableRestoreFocus:k,isEnabled:ne,open:P,children:e.cloneElement(a,se)})]}))}):null})),po=["addEndListener","appear","children","easing","in","onEnter","onEntered","onEntering","onExit","onExited","onExiting","style","timeout","TransitionComponent"],fo={entering:{opacity:1},entered:{opacity:1}},ho=e.forwardRef((function(t,n){var o=Sn(),r={enter:o.transitions.duration.enteringScreen,exit:o.transitions.duration.leavingScreen},i=t.addEndListener,a=t.appear,s=void 0===a||a,u=t.children,c=t.easing,l=t.in,d=t.onEnter,p=t.onEntered,g=t.onEntering,v=t.onExit,m=t.onExited,_=t.onExiting,y=t.style,M=t.timeout,I=void 0===M?r:M,k=t.TransitionComponent,T=void 0===k?kn:k,S=(0,f.Z)(t,po),b=e.useRef(null),D=(0,oe.Z)(b,u.ref,n),E=function(e){return function(t){if(e){var n=b.current;void 0===t?e(n):e(n,t)}}},A=E(g),L=E((function(e,t){bn(e);var n=Dn({style:y,timeout:I,easing:c},{mode:"enter"});e.style.webkitTransition=o.transitions.create("opacity",n),e.style.transition=o.transitions.create("opacity",n),d&&d(e,t)})),R=E(p),w=E(_),O=E((function(e){var t=Dn({style:y,timeout:I,easing:c},{mode:"exit"});e.style.webkitTransition=o.transitions.create("opacity",t),e.style.transition=o.transitions.create("opacity",t),v&&v(e)})),N=E(m);return(0,C.jsx)(T,(0,h.Z)({appear:s,in:l,nodeRef:b,onEnter:L,onEntered:R,onEntering:A,onExit:O,onExited:N,onExiting:w,addEndListener:function(e){i&&i(b.current,e)},timeout:I},S,{children:function(t,n){return e.cloneElement(u,(0,h.Z)({style:(0,h.Z)({opacity:0,visibility:"exited"!==t||l?void 0:"hidden"},fo[t],y,u.props.style),ref:D},n))}}))})),go=ho;function vo(e){return(0,m.Z)("MuiBackdrop",e)}(0,Y.Z)("MuiBackdrop",["root","invisible"]);var mo=["children","className","component","components","componentsProps","invisible","open","slotProps","slots","TransitionComponent","transitionDuration"],_o=(0,A.ZP)("div",{name:"MuiBackdrop",slot:"Root",overridesResolver:function(e,t){var n=e.ownerState;return[t.root,n.invisible&&t.invisible]}})((function(e){var t=e.ownerState;return(0,h.Z)({position:"fixed",display:"flex",alignItems:"center",justifyContent:"center",right:0,bottom:0,top:0,left:0,backgroundColor:"rgba(0, 0, 0, 0.5)",WebkitTapHighlightColor:"transparent"},t.invisible&&{backgroundColor:"transparent"})})),yo=e.forwardRef((function(e,t){var n,o,r,i=(0,L.Z)({props:e,name:"MuiBackdrop"}),a=i.children,s=i.className,u=i.component,c=void 0===u?"div":u,l=i.components,d=void 0===l?{}:l,p=i.componentsProps,v=void 0===p?{}:p,m=i.invisible,y=void 0!==m&&m,M=i.open,I=i.slotProps,k=void 0===I?{}:I,T=i.slots,S=void 0===T?{}:T,b=i.TransitionComponent,D=void 0===b?go:b,E=i.transitionDuration,A=(0,f.Z)(i,mo),R=(0,h.Z)({},i,{component:c,invisible:y}),w=function(e){var t=e.classes,n={root:["root",e.invisible&&"invisible"]};return(0,_.Z)(n,vo,t)}(R),O=null!=(n=k.root)?n:v.root;return(0,C.jsx)(D,(0,h.Z)({in:M,timeout:E},A,{children:(0,C.jsx)(_o,(0,h.Z)({"aria-hidden":!0},O,{as:null!=(o=null!=(r=S.root)?r:d.Root)?o:c,className:(0,g.Z)(w.root,s,null==O?void 0:O.className),ownerState:(0,h.Z)({},R,null==O?void 0:O.ownerState),classes:w,ref:t,children:a}))}))})),Mo=["BackdropComponent","BackdropProps","classes","className","closeAfterTransition","children","component","components","componentsProps","disableAutoFocus","disableEnforceFocus","disableEscapeKeyDown","disablePortal","disableRestoreFocus","disableScrollLock","hideBackdrop","keepMounted","slotProps","slots","theme"],Io=(0,A.ZP)("div",{name:"MuiModal",slot:"Root",overridesResolver:function(e,t){var n=e.ownerState;return[t.root,!n.open&&n.exited&&t.hidden]}})((function(e){var t=e.theme,n=e.ownerState;return(0,h.Z)({position:"fixed",zIndex:(t.vars||t).zIndex.modal,right:0,bottom:0,top:0,left:0},!n.open&&n.exited&&{visibility:"hidden"})})),Co=(0,A.ZP)(yo,{name:"MuiModal",slot:"Backdrop",overridesResolver:function(e,t){return t.backdrop}})({zIndex:-1}),ko=e.forwardRef((function(t,n){var o,i,a,s,u,c,l=(0,L.Z)({name:"MuiModal",props:t}),d=l.BackdropComponent,p=void 0===d?Co:d,v=l.BackdropProps,m=l.classes,_=l.className,y=l.closeAfterTransition,M=void 0!==y&&y,I=l.children,k=l.component,T=l.components,S=void 0===T?{}:T,b=l.componentsProps,D=void 0===b?{}:b,E=l.disableAutoFocus,A=void 0!==E&&E,R=l.disableEnforceFocus,w=void 0!==R&&R,O=l.disableEscapeKeyDown,N=void 0!==O&&O,P=l.disablePortal,G=void 0!==P&&P,U=l.disableRestoreFocus,x=void 0!==U&&U,F=l.disableScrollLock,q=void 0!==F&&F,B=l.hideBackdrop,V=void 0!==B&&B,H=l.keepMounted,K=void 0!==H&&H,j=l.slotProps,z=l.slots,Z=l.theme,W=(0,f.Z)(l,Mo),Y=e.useState(!0),J=(0,r.Z)(Y,2),X=J[0],$=J[1],Q={closeAfterTransition:M,disableAutoFocus:A,disableEnforceFocus:w,disableEscapeKeyDown:N,disablePortal:G,disableRestoreFocus:x,disableScrollLock:q,hideBackdrop:V,keepMounted:K},ee=(0,h.Z)({},l,Q,{exited:X}),te=null!=(o=null!=(i=null==z?void 0:z.root)?i:S.Root)?o:Io,ne=null!=(a=null!=(s=null==z?void 0:z.backdrop)?s:S.Backdrop)?a:p,oe=null!=(u=null==j?void 0:j.root)?u:D.root,re=null!=(c=null==j?void 0:j.backdrop)?c:D.backdrop;return(0,C.jsx)(lo,(0,h.Z)({slots:{root:te,backdrop:ne},slotProps:{root:function(){return(0,h.Z)({},no(oe,ee),!Re(te)&&{as:k,theme:Z},{className:(0,g.Z)(_,null==oe?void 0:oe.className,null==m?void 0:m.root,!ee.open&&ee.exited&&(null==m?void 0:m.hidden))})},backdrop:function(){return(0,h.Z)({},v,no(re,ee),{className:(0,g.Z)(null==re?void 0:re.className,null==m?void 0:m.backdrop)})}},onTransitionEnter:function(){return $(!1)},onTransitionExited:function(){return $(!0)},ref:n},W,Q,{children:I}))}));function To(e){return(0,m.Z)("MuiPopover",e)}(0,Y.Z)("MuiPopover",["root","paper"]);var So=["onEntering"],bo=["action","anchorEl","anchorOrigin","anchorPosition","anchorReference","children","className","container","elevation","marginThreshold","open","PaperProps","transformOrigin","TransitionComponent","transitionDuration","TransitionProps"];function Do(e,t){var n=0;return"number"===typeof t?n=t:"center"===t?n=e.height/2:"bottom"===t&&(n=e.height),n}function Eo(e,t){var n=0;return"number"===typeof t?n=t:"center"===t?n=e.width/2:"right"===t&&(n=e.width),n}function Ao(e){return[e.horizontal,e.vertical].map((function(e){return"number"===typeof e?"".concat(e,"px"):e})).join(" ")}function Lo(e){return"function"===typeof e?e():e}var Ro=(0,A.ZP)(ko,{name:"MuiPopover",slot:"Root",overridesResolver:function(e,t){return t.root}})({}),wo=(0,A.ZP)(cn,{name:"MuiPopover",slot:"Paper",overridesResolver:function(e,t){return t.paper}})({position:"absolute",overflowY:"auto",overflowX:"hidden",minWidth:16,minHeight:16,maxWidth:"calc(100% - 32px)",maxHeight:"calc(100% - 32px)",outline:0}),Oo=e.forwardRef((function(t,n){var o=(0,L.Z)({props:t,name:"MuiPopover"}),i=o.action,a=o.anchorEl,s=o.anchorOrigin,u=void 0===s?{vertical:"top",horizontal:"left"}:s,c=o.anchorPosition,l=o.anchorReference,d=void 0===l?"anchorEl":l,p=o.children,v=o.className,m=o.container,y=o.elevation,M=void 0===y?8:y,I=o.marginThreshold,k=void 0===I?16:I,T=o.open,S=o.PaperProps,b=void 0===S?{}:S,D=o.transformOrigin,E=void 0===D?{vertical:"top",horizontal:"left"}:D,A=o.TransitionComponent,R=void 0===A?On:A,w=o.transitionDuration,O=void 0===w?"auto":w,N=o.TransitionProps,P=(void 0===N?{}:N).onEntering,G=(0,f.Z)(o.TransitionProps,So),U=(0,f.Z)(o,bo),x=e.useRef(),F=(0,oe.Z)(x,b.ref),q=(0,h.Z)({},o,{anchorOrigin:u,anchorReference:d,elevation:M,marginThreshold:k,PaperProps:b,transformOrigin:E,TransitionComponent:R,transitionDuration:O,TransitionProps:G}),B=function(e){var t=e.classes;return(0,_.Z)({root:["root"],paper:["paper"]},To,t)}(q),V=e.useCallback((function(){if("anchorPosition"===d)return c;var e=Lo(a),t=(e&&1===e.nodeType?e:(0,Kt.Z)(x.current).body).getBoundingClientRect();return{top:t.top+Do(t,u.vertical),left:t.left+Eo(t,u.horizontal)}}),[a,u.horizontal,u.vertical,c,d]),H=e.useCallback((function(e){return{vertical:Do(e,E.vertical),horizontal:Eo(e,E.horizontal)}}),[E.horizontal,E.vertical]),K=e.useCallback((function(e){var t={width:e.offsetWidth,height:e.offsetHeight},n=H(t);if("none"===d)return{top:null,left:null,transformOrigin:Ao(n)};var o=V(),r=o.top-n.vertical,i=o.left-n.horizontal,s=r+t.height,u=i+t.width,c=(0,dn.Z)(Lo(a)),l=c.innerHeight-k,p=c.innerWidth-k;if(r<k){var f=r-k;r-=f,n.vertical+=f}else if(s>l){var h=s-l;r-=h,n.vertical+=h}if(i<k){var g=i-k;i-=g,n.horizontal+=g}else if(u>p){var v=u-p;i-=v,n.horizontal+=v}return{top:"".concat(Math.round(r),"px"),left:"".concat(Math.round(i),"px"),transformOrigin:Ao(n)}}),[a,d,V,H,k]),j=e.useState(T),z=(0,r.Z)(j,2),Z=z[0],W=z[1],Y=e.useCallback((function(){var e=x.current;if(e){var t=K(e);null!==t.top&&(e.style.top=t.top),null!==t.left&&(e.style.left=t.left),e.style.transformOrigin=t.transformOrigin,W(!0)}}),[K]);e.useEffect((function(){T&&Y()})),e.useImperativeHandle(i,(function(){return T?{updatePosition:function(){Y()}}:null}),[T,Y]),e.useEffect((function(){if(T){var e=(0,ln.Z)((function(){Y()})),t=(0,dn.Z)(a);return t.addEventListener("resize",e),function(){e.clear(),t.removeEventListener("resize",e)}}}),[a,T,Y]);var J=O;"auto"!==O||R.muiSupportAuto||(J=void 0);var X=m||(a?(0,Kt.Z)(Lo(a)).body:void 0);return(0,C.jsx)(Ro,(0,h.Z)({BackdropProps:{invisible:!0},className:(0,g.Z)(B.root,v),container:X,open:T,ref:n,ownerState:q},U,{children:(0,C.jsx)(R,(0,h.Z)({appear:!0,in:T,onEntering:function(e,t){P&&P(e,t),Y()},onExited:function(){W(!1)},timeout:J},G,{children:(0,C.jsx)(wo,(0,h.Z)({elevation:M},b,{ref:F,className:(0,g.Z)(B.paper,b.className)},Z?void 0:{style:(0,h.Z)({},b.style,{opacity:0})},{ownerState:q,children:p}))}))}))}));function No(e){return(0,m.Z)("MuiMenu",e)}(0,Y.Z)("MuiMenu",["root","paper","list"]);var Po=["onEntering"],Go=["autoFocus","children","disableAutoFocusItem","MenuListProps","onClose","open","PaperProps","PopoverClasses","transitionDuration","TransitionProps","variant"],Uo={vertical:"top",horizontal:"right"},xo={vertical:"top",horizontal:"left"},Fo=(0,A.ZP)(Oo,{shouldForwardProp:function(e){return(0,A.FO)(e)||"classes"===e},name:"MuiMenu",slot:"Root",overridesResolver:function(e,t){return t.root}})({}),qo=(0,A.ZP)(cn,{name:"MuiMenu",slot:"Paper",overridesResolver:function(e,t){return t.paper}})({maxHeight:"calc(100% - 96px)",WebkitOverflowScrolling:"touch"}),Bo=(0,A.ZP)(on,{name:"MuiMenu",slot:"List",overridesResolver:function(e,t){return t.list}})({outline:0}),Vo=e.forwardRef((function(t,n){var o=(0,L.Z)({props:t,name:"MuiMenu"}),r=o.autoFocus,i=void 0===r||r,a=o.children,s=o.disableAutoFocusItem,u=void 0!==s&&s,c=o.MenuListProps,l=void 0===c?{}:c,d=o.onClose,p=o.open,v=o.PaperProps,m=void 0===v?{}:v,y=o.PopoverClasses,M=o.transitionDuration,I=void 0===M?"auto":M,k=o.TransitionProps,T=(void 0===k?{}:k).onEntering,S=o.variant,b=void 0===S?"selectedMenu":S,D=(0,f.Z)(o.TransitionProps,Po),E=(0,f.Z)(o,Go),A=Sn(),R="rtl"===A.direction,w=(0,h.Z)({},o,{autoFocus:i,disableAutoFocusItem:u,MenuListProps:l,onEntering:T,PaperProps:m,transitionDuration:I,TransitionProps:D,variant:b}),O=function(e){var t=e.classes;return(0,_.Z)({root:["root"],paper:["paper"],list:["list"]},No,t)}(w),N=i&&!u&&p,P=e.useRef(null),G=-1;return e.Children.map(a,(function(t,n){e.isValidElement(t)&&(t.props.disabled||("selectedMenu"===b&&t.props.selected||-1===G)&&(G=n))})),(0,C.jsx)(Fo,(0,h.Z)({onClose:d,anchorOrigin:{vertical:"bottom",horizontal:R?"right":"left"},transformOrigin:R?Uo:xo,PaperProps:(0,h.Z)({as:qo},m,{classes:(0,h.Z)({},m.classes,{root:O.paper})}),className:O.root,open:p,ref:n,transitionDuration:I,TransitionProps:(0,h.Z)({onEntering:function(e,t){P.current&&P.current.adjustStyleForScrollbar(e,A),T&&T(e,t)}},D),ownerState:w},E,{classes:y,children:(0,C.jsx)(Bo,(0,h.Z)({onKeyDown:function(e){"Tab"===e.key&&(e.preventDefault(),d&&d(e,"tabKeyDown"))},actions:P,autoFocus:i&&(-1===G||u),autoFocusItem:N,variant:b},l,{className:(0,g.Z)(O.list,l.className),children:a}))}))}));function Ho(e){return(0,m.Z)("MuiNativeSelect",e)}var Ko=(0,Y.Z)("MuiNativeSelect",["root","select","multiple","filled","outlined","standard","disabled","icon","iconOpen","iconFilled","iconOutlined","iconStandard","nativeInput"]),jo=["className","disabled","IconComponent","inputRef","variant"],zo=function(e){var t,n=e.ownerState,o=e.theme;return(0,h.Z)((t={MozAppearance:"none",WebkitAppearance:"none",userSelect:"none",borderRadius:0,cursor:"pointer","&:focus":(0,h.Z)({},o.vars?{backgroundColor:"rgba(".concat(o.vars.palette.common.onBackgroundChannel," / 0.05)")}:{backgroundColor:"light"===o.palette.mode?"rgba(0, 0, 0, 0.05)":"rgba(255, 255, 255, 0.05)"},{borderRadius:0}),"&::-ms-expand":{display:"none"}},(0,p.Z)(t,"&.".concat(Ko.disabled),{cursor:"default"}),(0,p.Z)(t,"&[multiple]",{height:"auto"}),(0,p.Z)(t,"&:not([multiple]) option, &:not([multiple]) optgroup",{backgroundColor:(o.vars||o).palette.background.paper}),(0,p.Z)(t,"&&&",{paddingRight:24,minWidth:16}),t),"filled"===n.variant&&{"&&&":{paddingRight:32}},"outlined"===n.variant&&{borderRadius:(o.vars||o).shape.borderRadius,"&:focus":{borderRadius:(o.vars||o).shape.borderRadius},"&&&":{paddingRight:32}})},Zo=(0,A.ZP)("select",{name:"MuiNativeSelect",slot:"Select",shouldForwardProp:A.FO,overridesResolver:function(e,t){var n=e.ownerState;return[t.select,t[n.variant],(0,p.Z)({},"&.".concat(Ko.multiple),t.multiple)]}})(zo),Wo=function(e){var t=e.ownerState,n=e.theme;return(0,h.Z)((0,p.Z)({position:"absolute",right:0,top:"calc(50% - .5em)",pointerEvents:"none",color:(n.vars||n).palette.action.active},"&.".concat(Ko.disabled),{color:(n.vars||n).palette.action.disabled}),t.open&&{transform:"rotate(180deg)"},"filled"===t.variant&&{right:7},"outlined"===t.variant&&{right:7})},Yo=(0,A.ZP)("svg",{name:"MuiNativeSelect",slot:"Icon",overridesResolver:function(e,t){var n=e.ownerState;return[t.icon,n.variant&&t["icon".concat((0,E.Z)(n.variant))],n.open&&t.iconOpen]}})(Wo),Jo=e.forwardRef((function(t,n){var o=t.className,r=t.disabled,i=t.IconComponent,a=t.inputRef,s=t.variant,u=void 0===s?"standard":s,c=(0,f.Z)(t,jo),l=(0,h.Z)({},t,{disabled:r,variant:u}),d=function(e){var t=e.classes,n=e.variant,o=e.disabled,r=e.multiple,i=e.open,a={select:["select",n,o&&"disabled",r&&"multiple"],icon:["icon","icon".concat((0,E.Z)(n)),i&&"iconOpen",o&&"disabled"]};return(0,_.Z)(a,Ho,t)}(l);return(0,C.jsxs)(e.Fragment,{children:[(0,C.jsx)(Zo,(0,h.Z)({ownerState:l,className:(0,g.Z)(d.select,o),disabled:r,ref:a||n},c)),t.multiple?null:(0,C.jsx)(Yo,{as:i,ownerState:l,className:d.icon})]})})),Xo=n(7983);function $o(e){return(0,m.Z)("MuiSelect",e)}var Qo,er=(0,Y.Z)("MuiSelect",["select","multiple","filled","outlined","standard","disabled","focused","icon","iconOpen","iconFilled","iconOutlined","iconStandard","nativeInput"]),tr=["aria-describedby","aria-label","autoFocus","autoWidth","children","className","defaultOpen","defaultValue","disabled","displayEmpty","IconComponent","inputRef","labelId","MenuProps","multiple","name","onBlur","onChange","onClose","onFocus","onOpen","open","readOnly","renderValue","SelectDisplayProps","tabIndex","type","value","variant"],nr=(0,A.ZP)("div",{name:"MuiSelect",slot:"Select",overridesResolver:function(e,t){var n=e.ownerState;return[(0,p.Z)({},"&.".concat(er.select),t.select),(0,p.Z)({},"&.".concat(er.select),t[n.variant]),(0,p.Z)({},"&.".concat(er.multiple),t.multiple)]}})(zo,(0,p.Z)({},"&.".concat(er.select),{height:"auto",minHeight:"1.4375em",textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden"})),or=(0,A.ZP)("svg",{name:"MuiSelect",slot:"Icon",overridesResolver:function(e,t){var n=e.ownerState;return[t.icon,n.variant&&t["icon".concat((0,E.Z)(n.variant))],n.open&&t.iconOpen]}})(Wo),rr=(0,A.ZP)("input",{shouldForwardProp:function(e){return(0,A.Dz)(e)&&"classes"!==e},name:"MuiSelect",slot:"NativeInput",overridesResolver:function(e,t){return t.nativeInput}})({bottom:0,left:0,position:"absolute",opacity:0,pointerEvents:"none",width:"100%",boxSizing:"border-box"});function ir(e,t){return"object"===typeof t&&null!==t?e===t:String(e)===String(t)}function ar(e){return null==e||"string"===typeof e&&!e.trim()}var sr,ur,cr=e.forwardRef((function(t,n){var o=t["aria-describedby"],i=t["aria-label"],a=t.autoFocus,s=t.autoWidth,u=t.children,c=t.className,l=t.defaultOpen,d=t.defaultValue,p=t.disabled,v=t.displayEmpty,m=t.IconComponent,y=t.inputRef,M=t.labelId,I=t.MenuProps,k=void 0===I?{}:I,T=t.multiple,S=t.name,b=t.onBlur,D=t.onChange,A=t.onClose,L=t.onFocus,R=t.onOpen,w=t.open,O=t.readOnly,N=t.renderValue,P=t.SelectDisplayProps,G=void 0===P?{}:P,U=t.tabIndex,x=t.value,F=t.variant,q=void 0===F?"standard":F,B=(0,f.Z)(t,tr),V=(0,Xo.Z)({controlled:x,default:d,name:"Select"}),H=(0,r.Z)(V,2),K=H[0],j=H[1],z=(0,Xo.Z)({controlled:w,default:l,name:"Select"}),Z=(0,r.Z)(z,2),W=Z[0],Y=Z[1],J=e.useRef(null),X=e.useRef(null),$=e.useState(null),Q=(0,r.Z)($,2),ee=Q[0],te=Q[1],ne=e.useRef(null!=w).current,re=e.useState(),ie=(0,r.Z)(re,2),ae=ie[0],se=ie[1],ue=(0,oe.Z)(n,y),ce=e.useCallback((function(e){X.current=e,e&&te(e)}),[]),le=null==ee?void 0:ee.parentNode;e.useImperativeHandle(ue,(function(){return{focus:function(){X.current.focus()},node:J.current,value:K}}),[K]),e.useEffect((function(){l&&W&&ee&&!ne&&(se(s?null:le.clientWidth),X.current.focus())}),[ee,s]),e.useEffect((function(){a&&X.current.focus()}),[a]),e.useEffect((function(){if(M){var e=(0,Kt.Z)(X.current).getElementById(M);if(e){var t=function(){getSelection().isCollapsed&&X.current.focus()};return e.addEventListener("click",t),function(){e.removeEventListener("click",t)}}}}),[M]);var de,pe,fe=function(e,t){e?R&&R(t):A&&A(t),ne||(se(s?null:le.clientWidth),Y(e))},he=e.Children.toArray(u),ge=function(e){return function(t){var n;if(t.currentTarget.hasAttribute("tabindex")){if(T){n=Array.isArray(K)?K.slice():[];var o=K.indexOf(e.props.value);-1===o?n.push(e.props.value):n.splice(o,1)}else n=e.props.value;if(e.props.onClick&&e.props.onClick(t),K!==n&&(j(n),D)){var r=t.nativeEvent||t,i=new r.constructor(r.type,r);Object.defineProperty(i,"target",{writable:!0,value:{value:n,name:S}}),D(i,e)}T||fe(!1,t)}}},ve=null!==ee&&W;delete B["aria-invalid"];var me=[],_e=!1;(qe({value:K})||v)&&(N?de=N(K):_e=!0);var Me=he.map((function(t){if(!e.isValidElement(t))return null;var n;if(T){if(!Array.isArray(K))throw new Error((0,ye.Z)(2));n=K.some((function(e){return ir(e,t.props.value)})),n&&_e&&me.push(t.props.children)}else(n=ir(K,t.props.value))&&_e&&(pe=t.props.children);return n&&!0,e.cloneElement(t,{"aria-selected":n?"true":"false",onClick:ge(t),onKeyUp:function(e){" "===e.key&&e.preventDefault(),t.props.onKeyUp&&t.props.onKeyUp(e)},role:"option",selected:n,value:void 0,"data-value":t.props.value})}));_e&&(de=T?0===me.length?null:me.reduce((function(e,t,n){return e.push(t),n<me.length-1&&e.push(", "),e}),[]):pe);var Ie,Ce=ae;!s&&ne&&ee&&(Ce=le.clientWidth),Ie="undefined"!==typeof U?U:p?null:0;var ke=G.id||(S?"mui-component-select-".concat(S):void 0),Te=(0,h.Z)({},t,{variant:q,value:K,open:ve}),Se=function(e){var t=e.classes,n=e.variant,o=e.disabled,r=e.multiple,i=e.open,a={select:["select",n,o&&"disabled",r&&"multiple"],icon:["icon","icon".concat((0,E.Z)(n)),i&&"iconOpen",o&&"disabled"],nativeInput:["nativeInput"]};return(0,_.Z)(a,$o,t)}(Te);return(0,C.jsxs)(e.Fragment,{children:[(0,C.jsx)(nr,(0,h.Z)({ref:ce,tabIndex:Ie,role:"button","aria-disabled":p?"true":void 0,"aria-expanded":ve?"true":"false","aria-haspopup":"listbox","aria-label":i,"aria-labelledby":[M,ke].filter(Boolean).join(" ")||void 0,"aria-describedby":o,onKeyDown:function(e){if(!O){-1!==[" ","ArrowUp","ArrowDown","Enter"].indexOf(e.key)&&(e.preventDefault(),fe(!0,e))}},onMouseDown:p||O?null:function(e){0===e.button&&(e.preventDefault(),X.current.focus(),fe(!0,e))},onBlur:function(e){!ve&&b&&(Object.defineProperty(e,"target",{writable:!0,value:{value:K,name:S}}),b(e))},onFocus:L},G,{ownerState:Te,className:(0,g.Z)(G.className,Se.select,c),id:ke,children:ar(de)?Qo||(Qo=(0,C.jsx)("span",{className:"notranslate",children:"\u200b"})):de})),(0,C.jsx)(rr,(0,h.Z)({value:Array.isArray(K)?K.join(","):K,name:S,ref:J,"aria-hidden":!0,onChange:function(e){var t=he.map((function(e){return e.props.value})).indexOf(e.target.value);if(-1!==t){var n=he[t];j(n.props.value),D&&D(e,n)}},tabIndex:-1,disabled:p,className:Se.nativeInput,autoFocus:a,ownerState:Te},B)),(0,C.jsx)(or,{as:m,className:Se.icon,ownerState:Te}),(0,C.jsx)(Vo,(0,h.Z)({id:"menu-".concat(S||""),anchorEl:le,open:ve,onClose:function(e){fe(!1,e)},anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"}},k,{MenuListProps:(0,h.Z)({"aria-labelledby":M,role:"listbox",disableListWrap:!0},k.MenuListProps),PaperProps:(0,h.Z)({},k.PaperProps,{style:(0,h.Z)({minWidth:Ce},null!=k.PaperProps?k.PaperProps.style:null)}),children:Me}))]})})),lr=cr,dr=(0,n(8380).Z)((0,C.jsx)("path",{d:"M7 10l5 5 5-5z"}),"ArrowDropDown"),pr=["autoWidth","children","classes","className","defaultOpen","displayEmpty","IconComponent","id","input","inputProps","label","labelId","MenuProps","multiple","native","onClose","onOpen","open","renderValue","SelectDisplayProps","variant"],fr={name:"MuiSelect",overridesResolver:function(e,t){return t.root},shouldForwardProp:function(e){return(0,A.FO)(e)&&"variant"!==e},slot:"Root"},hr=(0,A.ZP)(ot,fr)(""),gr=(0,A.ZP)(Ct,fr)(""),vr=(0,A.ZP)(dt,fr)(""),mr=e.forwardRef((function(t,n){var o=(0,L.Z)({name:"MuiSelect",props:t}),r=o.autoWidth,i=void 0!==r&&r,a=o.children,s=o.classes,u=void 0===s?{}:s,c=o.className,l=o.defaultOpen,d=void 0!==l&&l,p=o.displayEmpty,v=void 0!==p&&p,m=o.IconComponent,_=void 0===m?dr:m,y=o.id,M=o.input,I=o.inputProps,k=o.label,T=o.labelId,S=o.MenuProps,b=o.multiple,D=void 0!==b&&b,E=o.native,A=void 0!==E&&E,R=o.onClose,w=o.onOpen,N=o.open,P=o.renderValue,G=o.SelectDisplayProps,U=o.variant,x=void 0===U?"outlined":U,F=(0,f.Z)(o,pr),q=A?Jo:lr,B=we({props:o,muiFormControl:Ne(),states:["variant"]}).variant||x,V=M||{standard:sr||(sr=(0,C.jsx)(hr,{})),outlined:(0,C.jsx)(gr,{label:k}),filled:ur||(ur=(0,C.jsx)(vr,{}))}[B],H=function(e){return e.classes}((0,h.Z)({},o,{variant:B,classes:u})),K=(0,oe.Z)(n,V.ref);return(0,C.jsx)(e.Fragment,{children:e.cloneElement(V,(0,h.Z)({inputComponent:q,inputProps:(0,h.Z)({children:a,IconComponent:_,variant:B,type:void 0,multiple:D},A?{id:y}:{autoWidth:i,defaultOpen:d,displayEmpty:v,labelId:T,MenuProps:S,onClose:R,onOpen:w,open:N,renderValue:P,SelectDisplayProps:(0,h.Z)({id:y},G)},I,{classes:I?(0,O.Z)(H,I.classes):H},M?M.props.inputProps:{})},D&&A&&"outlined"===B?{notched:!0}:{},{ref:K,className:(0,g.Z)(V.props.className,c)},!M&&{variant:B},F))})}));mr.muiName="Select";var _r=mr;function yr(e){return(0,m.Z)("MuiTextField",e)}(0,Y.Z)("MuiTextField",["root"]);var Mr=["autoComplete","autoFocus","children","className","color","defaultValue","disabled","error","FormHelperTextProps","fullWidth","helperText","id","InputLabelProps","inputProps","InputProps","inputRef","label","maxRows","minRows","multiline","name","onBlur","onChange","onFocus","placeholder","required","rows","select","SelectProps","type","value","variant"],Ir={standard:ot,filled:dt,outlined:Ct},Cr=(0,A.ZP)(Ut,{name:"MuiTextField",slot:"Root",overridesResolver:function(e,t){return t.root}})({}),kr=e.forwardRef((function(e,t){var n=(0,L.Z)({props:e,name:"MuiTextField"}),o=n.autoComplete,r=n.autoFocus,i=void 0!==r&&r,a=n.children,s=n.className,u=n.color,c=void 0===u?"primary":u,l=n.defaultValue,d=n.disabled,p=void 0!==d&&d,v=n.error,m=void 0!==v&&v,y=n.FormHelperTextProps,M=n.fullWidth,I=void 0!==M&&M,k=n.helperText,T=n.id,S=n.InputLabelProps,b=n.inputProps,D=n.InputProps,E=n.inputRef,A=n.label,R=n.maxRows,w=n.minRows,O=n.multiline,N=void 0!==O&&O,P=n.name,G=n.onBlur,U=n.onChange,x=n.onFocus,F=n.placeholder,q=n.required,B=void 0!==q&&q,V=n.rows,H=n.select,K=void 0!==H&&H,j=n.SelectProps,z=n.type,Z=n.value,W=n.variant,Y=void 0===W?"outlined":W,J=(0,f.Z)(n,Mr),X=(0,h.Z)({},n,{autoFocus:i,color:c,disabled:p,error:m,fullWidth:I,multiline:N,required:B,select:K,variant:Y}),$=function(e){var t=e.classes;return(0,_.Z)({root:["root"]},yr,t)}(X);var Q={};"outlined"===Y&&(S&&"undefined"!==typeof S.shrink&&(Q.notched=S.shrink),Q.label=A),K&&(j&&j.native||(Q.id=void 0),Q["aria-describedby"]=void 0);var ee=(0,_e.Z)(T),te=k&&ee?"".concat(ee,"-helper-text"):void 0,ne=A&&ee?"".concat(ee,"-label"):void 0,oe=Ir[Y],re=(0,C.jsx)(oe,(0,h.Z)({"aria-describedby":te,autoComplete:o,autoFocus:i,defaultValue:l,fullWidth:I,multiline:N,name:P,rows:V,maxRows:R,minRows:w,type:z,value:Z,id:ee,inputRef:E,onBlur:G,onChange:U,onFocus:x,placeholder:F,inputProps:b},Q,D));return(0,C.jsxs)(Cr,(0,h.Z)({className:(0,g.Z)($.root,s),disabled:p,error:m,fullWidth:I,ref:t,required:B,color:c,variant:Y,ownerState:X},J,{children:[null!=A&&""!==A&&(0,C.jsx)(wt,(0,h.Z)({htmlFor:ee,id:ne},S,{children:A})),K?(0,C.jsx)(_r,(0,h.Z)({"aria-describedby":te,id:ee,labelId:ne,value:Z,input:re},j,{children:a})):re,k&&(0,C.jsx)(Ht,(0,h.Z)({id:te},y,{children:k}))]}))})),Tr=n(4941),Sr=n(5881);function br(t,n){var o=Object.create(null);return t&&e.Children.map(t,(function(e){return e})).forEach((function(t){o[t.key]=function(t){return n&&(0,e.isValidElement)(t)?n(t):t}(t)})),o}function Dr(e,t,n){return null!=n[t]?n[t]:e.props[t]}function Er(t,n,o){var r=br(t.children),i=function(e,t){function n(n){return n in t?t[n]:e[n]}e=e||{},t=t||{};var o,r=Object.create(null),i=[];for(var a in e)a in t?i.length&&(r[a]=i,i=[]):i.push(a);var s={};for(var u in t){if(r[u])for(o=0;o<r[u].length;o++){var c=r[u][o];s[r[u][o]]=n(c)}s[u]=n(u)}for(o=0;o<i.length;o++)s[i[o]]=n(i[o]);return s}(n,r);return Object.keys(i).forEach((function(a){var s=i[a];if((0,e.isValidElement)(s)){var u=a in n,c=a in r,l=n[a],d=(0,e.isValidElement)(l)&&!l.props.in;!c||u&&!d?c||!u||d?c&&u&&(0,e.isValidElement)(l)&&(i[a]=(0,e.cloneElement)(s,{onExited:o.bind(null,s),in:l.props.in,exit:Dr(s,"exit",t),enter:Dr(s,"enter",t)})):i[a]=(0,e.cloneElement)(s,{in:!1}):i[a]=(0,e.cloneElement)(s,{onExited:o.bind(null,s),in:!0,exit:Dr(s,"exit",t),enter:Dr(s,"enter",t)})}})),i}var Ar=Object.values||function(e){return Object.keys(e).map((function(t){return e[t]}))},Lr=function(t){function n(e,n){var o,r=(o=t.call(this,e,n)||this).handleExited.bind(function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(o));return o.state={contextValue:{isMounting:!0},handleExited:r,firstRender:!0},o}fn(n,t);var o=n.prototype;return o.componentDidMount=function(){this.mounted=!0,this.setState({contextValue:{isMounting:!1}})},o.componentWillUnmount=function(){this.mounted=!1},n.getDerivedStateFromProps=function(t,n){var o,r,i=n.children,a=n.handleExited;return{children:n.firstRender?(o=t,r=a,br(o.children,(function(t){return(0,e.cloneElement)(t,{onExited:r.bind(null,t),in:!0,appear:Dr(t,"appear",o),enter:Dr(t,"enter",o),exit:Dr(t,"exit",o)})}))):Er(t,i,a),firstRender:!1}},o.handleExited=function(e,t){var n=br(this.props.children);e.key in n||(e.props.onExited&&e.props.onExited(t),this.mounted&&this.setState((function(t){var n=(0,h.Z)({},t.children);return delete n[e.key],{children:n}})))},o.render=function(){var t=this.props,n=t.component,o=t.childFactory,r=(0,f.Z)(t,["component","childFactory"]),i=this.state.contextValue,a=Ar(this.state.children).map(o);return delete r.appear,delete r.enter,delete r.exit,null===n?e.createElement(gn.Provider,{value:i},a):e.createElement(gn.Provider,{value:i},e.createElement(n,r,a))},n}(e.Component);Lr.propTypes={},Lr.defaultProps={component:"div",childFactory:function(e){return e}};var Rr=Lr;var wr=function(t){var n=t.className,o=t.classes,i=t.pulsate,a=void 0!==i&&i,s=t.rippleX,u=t.rippleY,c=t.rippleSize,l=t.in,d=t.onExited,p=t.timeout,f=e.useState(!1),h=(0,r.Z)(f,2),v=h[0],m=h[1],_=(0,g.Z)(n,o.ripple,o.rippleVisible,a&&o.ripplePulsate),y={width:c,height:c,top:-c/2+u,left:-c/2+s},M=(0,g.Z)(o.child,v&&o.childLeaving,a&&o.childPulsate);return l||v||m(!0),e.useEffect((function(){if(!l&&null!=d){var e=setTimeout(d,p);return function(){clearTimeout(e)}}}),[d,l,p]),(0,C.jsx)("span",{className:_,style:y,children:(0,C.jsx)("span",{className:M})})};var Or,Nr,Pr,Gr,Ur,xr,Fr,qr,Br=(0,Y.Z)("MuiTouchRipple",["root","ripple","rippleVisible","ripplePulsate","child","childLeaving","childPulsate"]),Vr=["center","classes","className"],Hr=d(Ur||(Ur=Or||(Or=o(["\n  0% {\n    transform: scale(0);\n    opacity: 0.1;\n  }\n\n  100% {\n    transform: scale(1);\n    opacity: 0.3;\n  }\n"])))),Kr=d(xr||(xr=Nr||(Nr=o(["\n  0% {\n    opacity: 1;\n  }\n\n  100% {\n    opacity: 0;\n  }\n"])))),jr=d(Fr||(Fr=Pr||(Pr=o(["\n  0% {\n    transform: scale(1);\n  }\n\n  50% {\n    transform: scale(0.92);\n  }\n\n  100% {\n    transform: scale(1);\n  }\n"])))),zr=(0,A.ZP)("span",{name:"MuiTouchRipple",slot:"Root"})({overflow:"hidden",pointerEvents:"none",position:"absolute",zIndex:0,top:0,right:0,bottom:0,left:0,borderRadius:"inherit"}),Zr=(0,A.ZP)(wr,{name:"MuiTouchRipple",slot:"Ripple"})(qr||(qr=Gr||(Gr=o(["\n  opacity: 0;\n  position: absolute;\n\n  &."," {\n    opacity: 0.3;\n    transform: scale(1);\n    animation-name: ",";\n    animation-duration: ","ms;\n    animation-timing-function: ",";\n  }\n\n  &."," {\n    animation-duration: ","ms;\n  }\n\n  & ."," {\n    opacity: 1;\n    display: block;\n    width: 100%;\n    height: 100%;\n    border-radius: 50%;\n    background-color: currentColor;\n  }\n\n  & ."," {\n    opacity: 0;\n    animation-name: ",";\n    animation-duration: ","ms;\n    animation-timing-function: ",";\n  }\n\n  & ."," {\n    position: absolute;\n    /* @noflip */\n    left: 0px;\n    top: 0;\n    animation-name: ",";\n    animation-duration: 2500ms;\n    animation-timing-function: ",";\n    animation-iteration-count: infinite;\n    animation-delay: 200ms;\n  }\n"]))),Br.rippleVisible,Hr,550,(function(e){return e.theme.transitions.easing.easeInOut}),Br.ripplePulsate,(function(e){return e.theme.transitions.duration.shorter}),Br.child,Br.childLeaving,Kr,550,(function(e){return e.theme.transitions.easing.easeInOut}),Br.childPulsate,jr,(function(e){return e.theme.transitions.easing.easeInOut})),Wr=e.forwardRef((function(t,n){var o=(0,L.Z)({props:t,name:"MuiTouchRipple"}),i=o.center,a=void 0!==i&&i,s=o.classes,u=void 0===s?{}:s,c=o.className,l=(0,f.Z)(o,Vr),d=e.useState([]),p=(0,r.Z)(d,2),v=p[0],m=p[1],_=e.useRef(0),y=e.useRef(null);e.useEffect((function(){y.current&&(y.current(),y.current=null)}),[v]);var M=e.useRef(!1),I=e.useRef(null),k=e.useRef(null),T=e.useRef(null);e.useEffect((function(){return function(){clearTimeout(I.current)}}),[]);var S=e.useCallback((function(e){var t=e.pulsate,n=e.rippleX,o=e.rippleY,r=e.rippleSize,i=e.cb;m((function(e){return[].concat((0,N.Z)(e),[(0,C.jsx)(Zr,{classes:{ripple:(0,g.Z)(u.ripple,Br.ripple),rippleVisible:(0,g.Z)(u.rippleVisible,Br.rippleVisible),ripplePulsate:(0,g.Z)(u.ripplePulsate,Br.ripplePulsate),child:(0,g.Z)(u.child,Br.child),childLeaving:(0,g.Z)(u.childLeaving,Br.childLeaving),childPulsate:(0,g.Z)(u.childPulsate,Br.childPulsate)},timeout:550,pulsate:t,rippleX:n,rippleY:o,rippleSize:r},_.current)])})),_.current+=1,y.current=i}),[u]),b=e.useCallback((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},o=t.pulsate,r=void 0!==o&&o,i=t.center,s=void 0===i?a||t.pulsate:i,u=t.fakeElement,c=void 0!==u&&u;if("mousedown"===(null==e?void 0:e.type)&&M.current)M.current=!1;else{"touchstart"===(null==e?void 0:e.type)&&(M.current=!0);var l,d,p,f=c?null:T.current,h=f?f.getBoundingClientRect():{width:0,height:0,left:0,top:0};if(s||void 0===e||0===e.clientX&&0===e.clientY||!e.clientX&&!e.touches)l=Math.round(h.width/2),d=Math.round(h.height/2);else{var g=e.touches&&e.touches.length>0?e.touches[0]:e,v=g.clientX,m=g.clientY;l=Math.round(v-h.left),d=Math.round(m-h.top)}if(s)(p=Math.sqrt((2*Math.pow(h.width,2)+Math.pow(h.height,2))/3))%2===0&&(p+=1);else{var _=2*Math.max(Math.abs((f?f.clientWidth:0)-l),l)+2,y=2*Math.max(Math.abs((f?f.clientHeight:0)-d),d)+2;p=Math.sqrt(Math.pow(_,2)+Math.pow(y,2))}null!=e&&e.touches?null===k.current&&(k.current=function(){S({pulsate:r,rippleX:l,rippleY:d,rippleSize:p,cb:n})},I.current=setTimeout((function(){k.current&&(k.current(),k.current=null)}),80)):S({pulsate:r,rippleX:l,rippleY:d,rippleSize:p,cb:n})}}),[a,S]),D=e.useCallback((function(){b({},{pulsate:!0})}),[b]),E=e.useCallback((function(e,t){if(clearTimeout(I.current),"touchend"===(null==e?void 0:e.type)&&k.current)return k.current(),k.current=null,void(I.current=setTimeout((function(){E(e,t)})));k.current=null,m((function(e){return e.length>0?e.slice(1):e})),y.current=t}),[]);return e.useImperativeHandle(n,(function(){return{pulsate:D,start:b,stop:E}}),[D,b,E]),(0,C.jsx)(zr,(0,h.Z)({className:(0,g.Z)(Br.root,u.root,c),ref:T},l,{children:(0,C.jsx)(Rr,{component:null,exit:!0,children:v})}))})),Yr=Wr;function Jr(e){return(0,m.Z)("MuiButtonBase",e)}var Xr,$r=(0,Y.Z)("MuiButtonBase",["root","disabled","focusVisible"]),Qr=["action","centerRipple","children","className","component","disabled","disableRipple","disableTouchRipple","focusRipple","focusVisibleClassName","LinkComponent","onBlur","onClick","onContextMenu","onDragLeave","onFocus","onFocusVisible","onKeyDown","onKeyUp","onMouseDown","onMouseLeave","onMouseUp","onTouchEnd","onTouchMove","onTouchStart","tabIndex","TouchRippleProps","touchRippleRef","type"],ei=(0,A.ZP)("button",{name:"MuiButtonBase",slot:"Root",overridesResolver:function(e,t){return t.root}})((Xr={display:"inline-flex",alignItems:"center",justifyContent:"center",position:"relative",boxSizing:"border-box",WebkitTapHighlightColor:"transparent",backgroundColor:"transparent",outline:0,border:0,margin:0,borderRadius:0,padding:0,cursor:"pointer",userSelect:"none",verticalAlign:"middle",MozAppearance:"none",WebkitAppearance:"none",textDecoration:"none",color:"inherit","&::-moz-focus-inner":{borderStyle:"none"}},(0,p.Z)(Xr,"&.".concat($r.disabled),{pointerEvents:"none",cursor:"default"}),(0,p.Z)(Xr,"@media print",{colorAdjust:"exact"}),Xr)),ti=e.forwardRef((function(t,n){var o=(0,L.Z)({props:t,name:"MuiButtonBase"}),i=o.action,a=o.centerRipple,s=void 0!==a&&a,u=o.children,c=o.className,l=o.component,d=void 0===l?"button":l,p=o.disabled,v=void 0!==p&&p,m=o.disableRipple,y=void 0!==m&&m,M=o.disableTouchRipple,I=void 0!==M&&M,k=o.focusRipple,T=void 0!==k&&k,S=o.LinkComponent,b=void 0===S?"a":S,D=o.onBlur,E=o.onClick,A=o.onContextMenu,R=o.onDragLeave,w=o.onFocus,O=o.onFocusVisible,N=o.onKeyDown,P=o.onKeyUp,G=o.onMouseDown,U=o.onMouseLeave,x=o.onMouseUp,F=o.onTouchEnd,q=o.onTouchMove,B=o.onTouchStart,V=o.tabIndex,H=void 0===V?0:V,K=o.TouchRippleProps,j=o.touchRippleRef,z=o.type,Z=(0,f.Z)(o,Qr),W=e.useRef(null),Y=e.useRef(null),J=(0,oe.Z)(Y,j),X=(0,ne.Z)(),$=X.isFocusVisibleRef,Q=X.onFocus,ee=X.onBlur,te=X.ref,re=e.useState(!1),ie=(0,r.Z)(re,2),ae=ie[0],se=ie[1];v&&ae&&se(!1),e.useImperativeHandle(i,(function(){return{focusVisible:function(){se(!0),W.current.focus()}}}),[]);var ue=e.useState(!1),ce=(0,r.Z)(ue,2),le=ce[0],de=ce[1];e.useEffect((function(){de(!0)}),[]);var pe=le&&!y&&!v;function fe(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:I;return(0,Sr.Z)((function(o){return t&&t(o),!n&&Y.current&&Y.current[e](o),!0}))}e.useEffect((function(){ae&&T&&!y&&le&&Y.current.pulsate()}),[y,T,ae,le]);var he=fe("start",G),ge=fe("stop",A),ve=fe("stop",R),me=fe("stop",x),_e=fe("stop",(function(e){ae&&e.preventDefault(),U&&U(e)})),ye=fe("start",B),Me=fe("stop",F),Ie=fe("stop",q),Ce=fe("stop",(function(e){ee(e),!1===$.current&&se(!1),D&&D(e)}),!1),ke=(0,Sr.Z)((function(e){W.current||(W.current=e.currentTarget),Q(e),!0===$.current&&(se(!0),O&&O(e)),w&&w(e)})),Te=function(){var e=W.current;return d&&"button"!==d&&!("A"===e.tagName&&e.href)},Se=e.useRef(!1),be=(0,Sr.Z)((function(e){T&&!Se.current&&ae&&Y.current&&" "===e.key&&(Se.current=!0,Y.current.stop(e,(function(){Y.current.start(e)}))),e.target===e.currentTarget&&Te()&&" "===e.key&&e.preventDefault(),N&&N(e),e.target===e.currentTarget&&Te()&&"Enter"===e.key&&!v&&(e.preventDefault(),E&&E(e))})),De=(0,Sr.Z)((function(e){T&&" "===e.key&&Y.current&&ae&&!e.defaultPrevented&&(Se.current=!1,Y.current.stop(e,(function(){Y.current.pulsate(e)}))),P&&P(e),E&&e.target===e.currentTarget&&Te()&&" "===e.key&&!e.defaultPrevented&&E(e)})),Ee=d;"button"===Ee&&(Z.href||Z.to)&&(Ee=b);var Ae={};"button"===Ee?(Ae.type=void 0===z?"button":z,Ae.disabled=v):(Z.href||Z.to||(Ae.role="button"),v&&(Ae["aria-disabled"]=v));var Le=(0,oe.Z)(n,te,W);var Re=(0,h.Z)({},o,{centerRipple:s,component:d,disabled:v,disableRipple:y,disableTouchRipple:I,focusRipple:T,tabIndex:H,focusVisible:ae}),we=function(e){var t=e.disabled,n=e.focusVisible,o=e.focusVisibleClassName,r=e.classes,i={root:["root",t&&"disabled",n&&"focusVisible"]},a=(0,_.Z)(i,Jr,r);return n&&o&&(a.root+=" ".concat(o)),a}(Re);return(0,C.jsxs)(ei,(0,h.Z)({as:Ee,className:(0,g.Z)(we.root,c),ownerState:Re,onBlur:Ce,onClick:E,onContextMenu:ge,onFocus:ke,onKeyDown:be,onKeyUp:De,onMouseDown:he,onMouseLeave:_e,onMouseUp:me,onDragLeave:ve,onTouchEnd:Me,onTouchMove:Ie,onTouchStart:ye,ref:Le,tabIndex:v?-1:H,type:z},Ae,Z,{children:[u,pe?(0,C.jsx)(Yr,(0,h.Z)({ref:J,center:s},K)):null]}))})),ni=ti;function oi(e){return(0,m.Z)("MuiButton",e)}var ri=(0,Y.Z)("MuiButton",["root","text","textInherit","textPrimary","textSecondary","textSuccess","textError","textInfo","textWarning","outlined","outlinedInherit","outlinedPrimary","outlinedSecondary","outlinedSuccess","outlinedError","outlinedInfo","outlinedWarning","contained","containedInherit","containedPrimary","containedSecondary","containedSuccess","containedError","containedInfo","containedWarning","disableElevation","focusVisible","disabled","colorInherit","textSizeSmall","textSizeMedium","textSizeLarge","outlinedSizeSmall","outlinedSizeMedium","outlinedSizeLarge","containedSizeSmall","containedSizeMedium","containedSizeLarge","sizeMedium","sizeSmall","sizeLarge","fullWidth","startIcon","endIcon","iconSizeSmall","iconSizeMedium","iconSizeLarge"]);var ii=e.createContext({}),ai=["children","color","component","className","disabled","disableElevation","disableFocusRipple","endIcon","focusVisibleClassName","fullWidth","size","startIcon","type","variant"],si=function(e){return(0,h.Z)({},"small"===e.size&&{"& > *:nth-of-type(1)":{fontSize:18}},"medium"===e.size&&{"& > *:nth-of-type(1)":{fontSize:20}},"large"===e.size&&{"& > *:nth-of-type(1)":{fontSize:22}})},ui=(0,A.ZP)(ni,{shouldForwardProp:function(e){return(0,A.FO)(e)||"classes"===e},name:"MuiButton",slot:"Root",overridesResolver:function(e,t){var n=e.ownerState;return[t.root,t[n.variant],t["".concat(n.variant).concat((0,E.Z)(n.color))],t["size".concat((0,E.Z)(n.size))],t["".concat(n.variant,"Size").concat((0,E.Z)(n.size))],"inherit"===n.color&&t.colorInherit,n.disableElevation&&t.disableElevation,n.fullWidth&&t.fullWidth]}})((function(e){var t,n,o,r=e.theme,i=e.ownerState;return(0,h.Z)({},r.typography.button,(t={minWidth:64,padding:"6px 16px",borderRadius:(r.vars||r).shape.borderRadius,transition:r.transitions.create(["background-color","box-shadow","border-color","color"],{duration:r.transitions.duration.short}),"&:hover":(0,h.Z)({textDecoration:"none",backgroundColor:r.vars?"rgba(".concat(r.vars.palette.text.primaryChannel," / ").concat(r.vars.palette.action.hoverOpacity,")"):(0,se.Fq)(r.palette.text.primary,r.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},"text"===i.variant&&"inherit"!==i.color&&{backgroundColor:r.vars?"rgba(".concat(r.vars.palette[i.color].mainChannel," / ").concat(r.vars.palette.action.hoverOpacity,")"):(0,se.Fq)(r.palette[i.color].main,r.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},"outlined"===i.variant&&"inherit"!==i.color&&{border:"1px solid ".concat((r.vars||r).palette[i.color].main),backgroundColor:r.vars?"rgba(".concat(r.vars.palette[i.color].mainChannel," / ").concat(r.vars.palette.action.hoverOpacity,")"):(0,se.Fq)(r.palette[i.color].main,r.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},"contained"===i.variant&&{backgroundColor:(r.vars||r).palette.grey.A100,boxShadow:(r.vars||r).shadows[4],"@media (hover: none)":{boxShadow:(r.vars||r).shadows[2],backgroundColor:(r.vars||r).palette.grey[300]}},"contained"===i.variant&&"inherit"!==i.color&&{backgroundColor:(r.vars||r).palette[i.color].dark,"@media (hover: none)":{backgroundColor:(r.vars||r).palette[i.color].main}}),"&:active":(0,h.Z)({},"contained"===i.variant&&{boxShadow:(r.vars||r).shadows[8]})},(0,p.Z)(t,"&.".concat(ri.focusVisible),(0,h.Z)({},"contained"===i.variant&&{boxShadow:(r.vars||r).shadows[6]})),(0,p.Z)(t,"&.".concat(ri.disabled),(0,h.Z)({color:(r.vars||r).palette.action.disabled},"outlined"===i.variant&&{border:"1px solid ".concat((r.vars||r).palette.action.disabledBackground)},"contained"===i.variant&&{color:(r.vars||r).palette.action.disabled,boxShadow:(r.vars||r).shadows[0],backgroundColor:(r.vars||r).palette.action.disabledBackground})),t),"text"===i.variant&&{padding:"6px 8px"},"text"===i.variant&&"inherit"!==i.color&&{color:(r.vars||r).palette[i.color].main},"outlined"===i.variant&&{padding:"5px 15px",border:"1px solid currentColor"},"outlined"===i.variant&&"inherit"!==i.color&&{color:(r.vars||r).palette[i.color].main,border:r.vars?"1px solid rgba(".concat(r.vars.palette[i.color].mainChannel," / 0.5)"):"1px solid ".concat((0,se.Fq)(r.palette[i.color].main,.5))},"contained"===i.variant&&{color:r.vars?r.vars.palette.text.primary:null==(n=(o=r.palette).getContrastText)?void 0:n.call(o,r.palette.grey[300]),backgroundColor:(r.vars||r).palette.grey[300],boxShadow:(r.vars||r).shadows[2]},"contained"===i.variant&&"inherit"!==i.color&&{color:(r.vars||r).palette[i.color].contrastText,backgroundColor:(r.vars||r).palette[i.color].main},"inherit"===i.color&&{color:"inherit",borderColor:"currentColor"},"small"===i.size&&"text"===i.variant&&{padding:"4px 5px",fontSize:r.typography.pxToRem(13)},"large"===i.size&&"text"===i.variant&&{padding:"8px 11px",fontSize:r.typography.pxToRem(15)},"small"===i.size&&"outlined"===i.variant&&{padding:"3px 9px",fontSize:r.typography.pxToRem(13)},"large"===i.size&&"outlined"===i.variant&&{padding:"7px 21px",fontSize:r.typography.pxToRem(15)},"small"===i.size&&"contained"===i.variant&&{padding:"4px 10px",fontSize:r.typography.pxToRem(13)},"large"===i.size&&"contained"===i.variant&&{padding:"8px 22px",fontSize:r.typography.pxToRem(15)},i.fullWidth&&{width:"100%"})}),(function(e){var t;return e.ownerState.disableElevation&&(t={boxShadow:"none","&:hover":{boxShadow:"none"}},(0,p.Z)(t,"&.".concat(ri.focusVisible),{boxShadow:"none"}),(0,p.Z)(t,"&:active",{boxShadow:"none"}),(0,p.Z)(t,"&.".concat(ri.disabled),{boxShadow:"none"}),t)})),ci=(0,A.ZP)("span",{name:"MuiButton",slot:"StartIcon",overridesResolver:function(e,t){var n=e.ownerState;return[t.startIcon,t["iconSize".concat((0,E.Z)(n.size))]]}})((function(e){var t=e.ownerState;return(0,h.Z)({display:"inherit",marginRight:8,marginLeft:-4},"small"===t.size&&{marginLeft:-2},si(t))})),li=(0,A.ZP)("span",{name:"MuiButton",slot:"EndIcon",overridesResolver:function(e,t){var n=e.ownerState;return[t.endIcon,t["iconSize".concat((0,E.Z)(n.size))]]}})((function(e){var t=e.ownerState;return(0,h.Z)({display:"inherit",marginRight:-4,marginLeft:8},"small"===t.size&&{marginRight:-2},si(t))})),di=e.forwardRef((function(t,n){var o=e.useContext(ii),r=(0,Tr.Z)(o,t),i=(0,L.Z)({props:r,name:"MuiButton"}),a=i.children,s=i.color,u=void 0===s?"primary":s,c=i.component,l=void 0===c?"button":c,d=i.className,p=i.disabled,v=void 0!==p&&p,m=i.disableElevation,y=void 0!==m&&m,M=i.disableFocusRipple,I=void 0!==M&&M,k=i.endIcon,T=i.focusVisibleClassName,S=i.fullWidth,b=void 0!==S&&S,D=i.size,A=void 0===D?"medium":D,R=i.startIcon,w=i.type,O=i.variant,N=void 0===O?"text":O,P=(0,f.Z)(i,ai),G=(0,h.Z)({},i,{color:u,component:l,disabled:v,disableElevation:y,disableFocusRipple:I,fullWidth:b,size:A,type:w,variant:N}),U=function(e){var t=e.color,n=e.disableElevation,o=e.fullWidth,r=e.size,i=e.variant,a=e.classes,s={root:["root",i,"".concat(i).concat((0,E.Z)(t)),"size".concat((0,E.Z)(r)),"".concat(i,"Size").concat((0,E.Z)(r)),"inherit"===t&&"colorInherit",n&&"disableElevation",o&&"fullWidth"],label:["label"],startIcon:["startIcon","iconSize".concat((0,E.Z)(r))],endIcon:["endIcon","iconSize".concat((0,E.Z)(r))]},u=(0,_.Z)(s,oi,a);return(0,h.Z)({},a,u)}(G),x=R&&(0,C.jsx)(ci,{className:U.startIcon,ownerState:G,children:R}),F=k&&(0,C.jsx)(li,{className:U.endIcon,ownerState:G,children:k});return(0,C.jsxs)(ui,(0,h.Z)({ownerState:G,className:(0,g.Z)(o.className,U.root,d),component:l,disabled:v,focusRipple:!I,focusVisibleClassName:(0,g.Z)(U.focusVisible,T),ref:n,type:w},P,{classes:U,children:[x,a,F]}))})),pi=n(5296),fi=n.n(pi),hi=n(3330),gi=n.n(hi),vi="undefined"!=typeof n.g?n.g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},mi=[],_i=[],yi="undefined"!=typeof Uint8Array?Uint8Array:Array,Mi=!1;function Ii(){Mi=!0;for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",t=0,n=e.length;t<n;++t)mi[t]=e[t],_i[e.charCodeAt(t)]=t;_i["-".charCodeAt(0)]=62,_i["_".charCodeAt(0)]=63}function Ci(e,t,n){for(var o,r,i=[],a=t;a<n;a+=3)o=(e[a]<<16)+(e[a+1]<<8)+e[a+2],i.push(mi[(r=o)>>18&63]+mi[r>>12&63]+mi[r>>6&63]+mi[63&r]);return i.join("")}function ki(e){var t;Mi||Ii();for(var n=e.length,o=n%3,r="",i=[],a=0,s=n-o;a<s;a+=16383)i.push(Ci(e,a,a+16383>s?s:a+16383));return 1===o?(t=e[n-1],r+=mi[t>>2],r+=mi[t<<4&63],r+="=="):2===o&&(t=(e[n-2]<<8)+e[n-1],r+=mi[t>>10],r+=mi[t>>4&63],r+=mi[t<<2&63],r+="="),i.push(r),i.join("")}function Ti(e,t,n,o,r){var i,a,s=8*r-o-1,u=(1<<s)-1,c=u>>1,l=-7,d=n?r-1:0,p=n?-1:1,f=e[t+d];for(d+=p,i=f&(1<<-l)-1,f>>=-l,l+=s;l>0;i=256*i+e[t+d],d+=p,l-=8);for(a=i&(1<<-l)-1,i>>=-l,l+=o;l>0;a=256*a+e[t+d],d+=p,l-=8);if(0===i)i=1-c;else{if(i===u)return a?NaN:1/0*(f?-1:1);a+=Math.pow(2,o),i-=c}return(f?-1:1)*a*Math.pow(2,i-o)}function Si(e,t,n,o,r,i){var a,s,u,c=8*i-r-1,l=(1<<c)-1,d=l>>1,p=23===r?Math.pow(2,-24)-Math.pow(2,-77):0,f=o?0:i-1,h=o?1:-1,g=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,a=l):(a=Math.floor(Math.log(t)/Math.LN2),t*(u=Math.pow(2,-a))<1&&(a--,u*=2),(t+=a+d>=1?p/u:p*Math.pow(2,1-d))*u>=2&&(a++,u/=2),a+d>=l?(s=0,a=l):a+d>=1?(s=(t*u-1)*Math.pow(2,r),a+=d):(s=t*Math.pow(2,d-1)*Math.pow(2,r),a=0));r>=8;e[n+f]=255&s,f+=h,s/=256,r-=8);for(a=a<<r|s,c+=r;c>0;e[n+f]=255&a,f+=h,a/=256,c-=8);e[n+f-h]|=128*g}var bi={}.toString,Di=Array.isArray||function(e){return"[object Array]"==bi.call(e)};function Ei(){return Li.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function Ai(e,t){if(Ei()<t)throw new RangeError("Invalid typed array length");return Li.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t)).__proto__=Li.prototype:(null===e&&(e=new Li(t)),e.length=t),e}function Li(e,t,n){if(!(Li.TYPED_ARRAY_SUPPORT||this instanceof Li))return new Li(e,t,n);if("number"==typeof e){if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return Oi(this,e)}return Ri(this,e,t,n)}function Ri(e,t,n,o){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?function(e,t,n,o){if(t.byteLength,n<0||t.byteLength<n)throw new RangeError("'offset' is out of bounds");if(t.byteLength<n+(o||0))throw new RangeError("'length' is out of bounds");return t=void 0===n&&void 0===o?new Uint8Array(t):void 0===o?new Uint8Array(t,n):new Uint8Array(t,n,o),Li.TYPED_ARRAY_SUPPORT?(e=t).__proto__=Li.prototype:e=Ni(e,t),e}(e,t,n,o):"string"==typeof t?function(e,t,n){if("string"==typeof n&&""!==n||(n="utf8"),!Li.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var o=0|Ui(t,n),r=(e=Ai(e,o)).write(t,n);return r!==o&&(e=e.slice(0,r)),e}(e,t,n):function(e,t){if(Gi(t)){var n=0|Pi(t.length);return 0===(e=Ai(e,n)).length||t.copy(e,0,0,n),e}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!=typeof t.length||(o=t.length)!=o?Ai(e,0):Ni(e,t);if("Buffer"===t.type&&Di(t.data))return Ni(e,t.data)}var o;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(e,t)}function wi(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function Oi(e,t){if(wi(t),e=Ai(e,t<0?0:0|Pi(t)),!Li.TYPED_ARRAY_SUPPORT)for(var n=0;n<t;++n)e[n]=0;return e}function Ni(e,t){var n=t.length<0?0:0|Pi(t.length);e=Ai(e,n);for(var o=0;o<n;o+=1)e[o]=255&t[o];return e}function Pi(e){if(e>=Ei())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+Ei().toString(16)+" bytes");return 0|e}function Gi(e){return!(null==e||!e._isBuffer)}function Ui(e,t){if(Gi(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var n=e.length;if(0===n)return 0;for(var o=!1;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return la(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return da(e).length;default:if(o)return la(e).length;t=(""+t).toLowerCase(),o=!0}}function xi(e,t,n){var o=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return Qi(this,t,n);case"utf8":case"utf-8":return Yi(this,t,n);case"ascii":return Xi(this,t,n);case"latin1":case"binary":return $i(this,t,n);case"base64":return Wi(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ea(this,t,n);default:if(o)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),o=!0}}function Fi(e,t,n){var o=e[t];e[t]=e[n],e[n]=o}function qi(e,t,n,o,r){if(0===e.length)return-1;if("string"==typeof n?(o=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=r?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(r)return-1;n=e.length-1}else if(n<0){if(!r)return-1;n=0}if("string"==typeof t&&(t=Li.from(t,o)),Gi(t))return 0===t.length?-1:Bi(e,t,n,o,r);if("number"==typeof t)return t&=255,Li.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?r?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):Bi(e,[t],n,o,r);throw new TypeError("val must be string, number or Buffer")}function Bi(e,t,n,o,r){var i,a=1,s=e.length,u=t.length;if(void 0!==o&&("ucs2"===(o=String(o).toLowerCase())||"ucs-2"===o||"utf16le"===o||"utf-16le"===o)){if(e.length<2||t.length<2)return-1;a=2,s/=2,u/=2,n/=2}function c(e,t){return 1===a?e[t]:e.readUInt16BE(t*a)}if(r){var l=-1;for(i=n;i<s;i++)if(c(e,i)===c(t,-1===l?0:i-l)){if(-1===l&&(l=i),i-l+1===u)return l*a}else-1!==l&&(i-=i-l),l=-1}else for(n+u>s&&(n=s-u),i=n;i>=0;i--){for(var d=!0,p=0;p<u;p++)if(c(e,i+p)!==c(t,p)){d=!1;break}if(d)return i}return-1}function Vi(e,t,n,o){n=Number(n)||0;var r=e.length-n;o?(o=Number(o))>r&&(o=r):o=r;var i=t.length;if(i%2!=0)throw new TypeError("Invalid hex string");o>i/2&&(o=i/2);for(var a=0;a<o;++a){var s=parseInt(t.substr(2*a,2),16);if(isNaN(s))return a;e[n+a]=s}return a}function Hi(e,t,n,o){return pa(la(t,e.length-n),e,n,o)}function Ki(e,t,n,o){return pa(function(e){for(var t=[],n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}(t),e,n,o)}function ji(e,t,n,o){return Ki(e,t,n,o)}function zi(e,t,n,o){return pa(da(t),e,n,o)}function Zi(e,t,n,o){return pa(function(e,t){for(var n,o,r,i=[],a=0;a<e.length&&!((t-=2)<0);++a)o=(n=e.charCodeAt(a))>>8,r=n%256,i.push(r),i.push(o);return i}(t,e.length-n),e,n,o)}function Wi(e,t,n){return 0===t&&n===e.length?ki(e):ki(e.slice(t,n))}function Yi(e,t,n){n=Math.min(e.length,n);for(var o=[],r=t;r<n;){var i,a,s,u,c=e[r],l=null,d=c>239?4:c>223?3:c>191?2:1;if(r+d<=n)switch(d){case 1:c<128&&(l=c);break;case 2:128==(192&(i=e[r+1]))&&(u=(31&c)<<6|63&i)>127&&(l=u);break;case 3:i=e[r+1],a=e[r+2],128==(192&i)&&128==(192&a)&&(u=(15&c)<<12|(63&i)<<6|63&a)>2047&&(u<55296||u>57343)&&(l=u);break;case 4:i=e[r+1],a=e[r+2],s=e[r+3],128==(192&i)&&128==(192&a)&&128==(192&s)&&(u=(15&c)<<18|(63&i)<<12|(63&a)<<6|63&s)>65535&&u<1114112&&(l=u)}null===l?(l=65533,d=1):l>65535&&(l-=65536,o.push(l>>>10&1023|55296),l=56320|1023&l),o.push(l),r+=d}return function(e){var t=e.length;if(t<=Ji)return String.fromCharCode.apply(String,e);for(var n="",o=0;o<t;)n+=String.fromCharCode.apply(String,e.slice(o,o+=Ji));return n}(o)}Li.TYPED_ARRAY_SUPPORT=void 0===vi.TYPED_ARRAY_SUPPORT||vi.TYPED_ARRAY_SUPPORT,Li.poolSize=8192,Li._augment=function(e){return e.__proto__=Li.prototype,e},Li.from=function(e,t,n){return Ri(null,e,t,n)},Li.TYPED_ARRAY_SUPPORT&&(Li.prototype.__proto__=Uint8Array.prototype,Li.__proto__=Uint8Array),Li.alloc=function(e,t,n){return function(e,t,n,o){return wi(t),t<=0?Ai(e,t):void 0!==n?"string"==typeof o?Ai(e,t).fill(n,o):Ai(e,t).fill(n):Ai(e,t)}(null,e,t,n)},Li.allocUnsafe=function(e){return Oi(null,e)},Li.allocUnsafeSlow=function(e){return Oi(null,e)},Li.isBuffer=fa,Li.compare=function(e,t){if(!Gi(e)||!Gi(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var n=e.length,o=t.length,r=0,i=Math.min(n,o);r<i;++r)if(e[r]!==t[r]){n=e[r],o=t[r];break}return n<o?-1:o<n?1:0},Li.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},Li.concat=function(e,t){if(!Di(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return Li.alloc(0);var n;if(void 0===t)for(t=0,n=0;n<e.length;++n)t+=e[n].length;var o=Li.allocUnsafe(t),r=0;for(n=0;n<e.length;++n){var i=e[n];if(!Gi(i))throw new TypeError('"list" argument must be an Array of Buffers');i.copy(o,r),r+=i.length}return o},Li.byteLength=Ui,Li.prototype._isBuffer=!0,Li.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)Fi(this,t,t+1);return this},Li.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)Fi(this,t,t+3),Fi(this,t+1,t+2);return this},Li.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)Fi(this,t,t+7),Fi(this,t+1,t+6),Fi(this,t+2,t+5),Fi(this,t+3,t+4);return this},Li.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?Yi(this,0,e):xi.apply(this,arguments)},Li.prototype.equals=function(e){if(!Gi(e))throw new TypeError("Argument must be a Buffer");return this===e||0===Li.compare(this,e)},Li.prototype.inspect=function(){var e="";return this.length>0&&(e=this.toString("hex",0,50).match(/.{2}/g).join(" "),this.length>50&&(e+=" ... ")),"<Buffer "+e+">"},Li.prototype.compare=function(e,t,n,o,r){if(!Gi(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===o&&(o=0),void 0===r&&(r=this.length),t<0||n>e.length||o<0||r>this.length)throw new RangeError("out of range index");if(o>=r&&t>=n)return 0;if(o>=r)return-1;if(t>=n)return 1;if(this===e)return 0;for(var i=(r>>>=0)-(o>>>=0),a=(n>>>=0)-(t>>>=0),s=Math.min(i,a),u=this.slice(o,r),c=e.slice(t,n),l=0;l<s;++l)if(u[l]!==c[l]){i=u[l],a=c[l];break}return i<a?-1:a<i?1:0},Li.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},Li.prototype.indexOf=function(e,t,n){return qi(this,e,t,n,!0)},Li.prototype.lastIndexOf=function(e,t,n){return qi(this,e,t,n,!1)},Li.prototype.write=function(e,t,n,o){if(void 0===t)o="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)o=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(n)?(n|=0,void 0===o&&(o="utf8")):(o=n,n=void 0)}var r=this.length-t;if((void 0===n||n>r)&&(n=r),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");o||(o="utf8");for(var i=!1;;)switch(o){case"hex":return Vi(this,e,t,n);case"utf8":case"utf-8":return Hi(this,e,t,n);case"ascii":return Ki(this,e,t,n);case"latin1":case"binary":return ji(this,e,t,n);case"base64":return zi(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Zi(this,e,t,n);default:if(i)throw new TypeError("Unknown encoding: "+o);o=(""+o).toLowerCase(),i=!0}},Li.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var Ji=4096;function Xi(e,t,n){var o="";n=Math.min(e.length,n);for(var r=t;r<n;++r)o+=String.fromCharCode(127&e[r]);return o}function $i(e,t,n){var o="";n=Math.min(e.length,n);for(var r=t;r<n;++r)o+=String.fromCharCode(e[r]);return o}function Qi(e,t,n){var o=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>o)&&(n=o);for(var r="",i=t;i<n;++i)r+=ca(e[i]);return r}function ea(e,t,n){for(var o=e.slice(t,n),r="",i=0;i<o.length;i+=2)r+=String.fromCharCode(o[i]+256*o[i+1]);return r}function ta(e,t,n){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}function na(e,t,n,o,r,i){if(!Gi(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>r||t<i)throw new RangeError('"value" argument is out of bounds');if(n+o>e.length)throw new RangeError("Index out of range")}function oa(e,t,n,o){t<0&&(t=65535+t+1);for(var r=0,i=Math.min(e.length-n,2);r<i;++r)e[n+r]=(t&255<<8*(o?r:1-r))>>>8*(o?r:1-r)}function ra(e,t,n,o){t<0&&(t=4294967295+t+1);for(var r=0,i=Math.min(e.length-n,4);r<i;++r)e[n+r]=t>>>8*(o?r:3-r)&255}function ia(e,t,n,o,r,i){if(n+o>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function aa(e,t,n,o,r){return r||ia(e,0,n,4),Si(e,t,n,o,23,4),n+4}function sa(e,t,n,o,r){return r||ia(e,0,n,8),Si(e,t,n,o,52,8),n+8}Li.prototype.slice=function(e,t){var n,o=this.length;if((e=~~e)<0?(e+=o)<0&&(e=0):e>o&&(e=o),(t=void 0===t?o:~~t)<0?(t+=o)<0&&(t=0):t>o&&(t=o),t<e&&(t=e),Li.TYPED_ARRAY_SUPPORT)(n=this.subarray(e,t)).__proto__=Li.prototype;else{var r=t-e;n=new Li(r,void 0);for(var i=0;i<r;++i)n[i]=this[i+e]}return n},Li.prototype.readUIntLE=function(e,t,n){e|=0,t|=0,n||ta(e,t,this.length);for(var o=this[e],r=1,i=0;++i<t&&(r*=256);)o+=this[e+i]*r;return o},Li.prototype.readUIntBE=function(e,t,n){e|=0,t|=0,n||ta(e,t,this.length);for(var o=this[e+--t],r=1;t>0&&(r*=256);)o+=this[e+--t]*r;return o},Li.prototype.readUInt8=function(e,t){return t||ta(e,1,this.length),this[e]},Li.prototype.readUInt16LE=function(e,t){return t||ta(e,2,this.length),this[e]|this[e+1]<<8},Li.prototype.readUInt16BE=function(e,t){return t||ta(e,2,this.length),this[e]<<8|this[e+1]},Li.prototype.readUInt32LE=function(e,t){return t||ta(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},Li.prototype.readUInt32BE=function(e,t){return t||ta(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},Li.prototype.readIntLE=function(e,t,n){e|=0,t|=0,n||ta(e,t,this.length);for(var o=this[e],r=1,i=0;++i<t&&(r*=256);)o+=this[e+i]*r;return o>=(r*=128)&&(o-=Math.pow(2,8*t)),o},Li.prototype.readIntBE=function(e,t,n){e|=0,t|=0,n||ta(e,t,this.length);for(var o=t,r=1,i=this[e+--o];o>0&&(r*=256);)i+=this[e+--o]*r;return i>=(r*=128)&&(i-=Math.pow(2,8*t)),i},Li.prototype.readInt8=function(e,t){return t||ta(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},Li.prototype.readInt16LE=function(e,t){t||ta(e,2,this.length);var n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},Li.prototype.readInt16BE=function(e,t){t||ta(e,2,this.length);var n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},Li.prototype.readInt32LE=function(e,t){return t||ta(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},Li.prototype.readInt32BE=function(e,t){return t||ta(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},Li.prototype.readFloatLE=function(e,t){return t||ta(e,4,this.length),Ti(this,e,!0,23,4)},Li.prototype.readFloatBE=function(e,t){return t||ta(e,4,this.length),Ti(this,e,!1,23,4)},Li.prototype.readDoubleLE=function(e,t){return t||ta(e,8,this.length),Ti(this,e,!0,52,8)},Li.prototype.readDoubleBE=function(e,t){return t||ta(e,8,this.length),Ti(this,e,!1,52,8)},Li.prototype.writeUIntLE=function(e,t,n,o){e=+e,t|=0,n|=0,o||na(this,e,t,n,Math.pow(2,8*n)-1,0);var r=1,i=0;for(this[t]=255&e;++i<n&&(r*=256);)this[t+i]=e/r&255;return t+n},Li.prototype.writeUIntBE=function(e,t,n,o){e=+e,t|=0,n|=0,o||na(this,e,t,n,Math.pow(2,8*n)-1,0);var r=n-1,i=1;for(this[t+r]=255&e;--r>=0&&(i*=256);)this[t+r]=e/i&255;return t+n},Li.prototype.writeUInt8=function(e,t,n){return e=+e,t|=0,n||na(this,e,t,1,255,0),Li.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},Li.prototype.writeUInt16LE=function(e,t,n){return e=+e,t|=0,n||na(this,e,t,2,65535,0),Li.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):oa(this,e,t,!0),t+2},Li.prototype.writeUInt16BE=function(e,t,n){return e=+e,t|=0,n||na(this,e,t,2,65535,0),Li.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):oa(this,e,t,!1),t+2},Li.prototype.writeUInt32LE=function(e,t,n){return e=+e,t|=0,n||na(this,e,t,4,4294967295,0),Li.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):ra(this,e,t,!0),t+4},Li.prototype.writeUInt32BE=function(e,t,n){return e=+e,t|=0,n||na(this,e,t,4,4294967295,0),Li.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):ra(this,e,t,!1),t+4},Li.prototype.writeIntLE=function(e,t,n,o){if(e=+e,t|=0,!o){var r=Math.pow(2,8*n-1);na(this,e,t,n,r-1,-r)}var i=0,a=1,s=0;for(this[t]=255&e;++i<n&&(a*=256);)e<0&&0===s&&0!==this[t+i-1]&&(s=1),this[t+i]=(e/a>>0)-s&255;return t+n},Li.prototype.writeIntBE=function(e,t,n,o){if(e=+e,t|=0,!o){var r=Math.pow(2,8*n-1);na(this,e,t,n,r-1,-r)}var i=n-1,a=1,s=0;for(this[t+i]=255&e;--i>=0&&(a*=256);)e<0&&0===s&&0!==this[t+i+1]&&(s=1),this[t+i]=(e/a>>0)-s&255;return t+n},Li.prototype.writeInt8=function(e,t,n){return e=+e,t|=0,n||na(this,e,t,1,127,-128),Li.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},Li.prototype.writeInt16LE=function(e,t,n){return e=+e,t|=0,n||na(this,e,t,2,32767,-32768),Li.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):oa(this,e,t,!0),t+2},Li.prototype.writeInt16BE=function(e,t,n){return e=+e,t|=0,n||na(this,e,t,2,32767,-32768),Li.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):oa(this,e,t,!1),t+2},Li.prototype.writeInt32LE=function(e,t,n){return e=+e,t|=0,n||na(this,e,t,4,2147483647,-2147483648),Li.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):ra(this,e,t,!0),t+4},Li.prototype.writeInt32BE=function(e,t,n){return e=+e,t|=0,n||na(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),Li.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):ra(this,e,t,!1),t+4},Li.prototype.writeFloatLE=function(e,t,n){return aa(this,e,t,!0,n)},Li.prototype.writeFloatBE=function(e,t,n){return aa(this,e,t,!1,n)},Li.prototype.writeDoubleLE=function(e,t,n){return sa(this,e,t,!0,n)},Li.prototype.writeDoubleBE=function(e,t,n){return sa(this,e,t,!1,n)},Li.prototype.copy=function(e,t,n,o){if(n||(n=0),o||0===o||(o=this.length),t>=e.length&&(t=e.length),t||(t=0),o>0&&o<n&&(o=n),o===n)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(o<0)throw new RangeError("sourceEnd out of bounds");o>this.length&&(o=this.length),e.length-t<o-n&&(o=e.length-t+n);var r,i=o-n;if(this===e&&n<t&&t<o)for(r=i-1;r>=0;--r)e[r+t]=this[r+n];else if(i<1e3||!Li.TYPED_ARRAY_SUPPORT)for(r=0;r<i;++r)e[r+t]=this[r+n];else Uint8Array.prototype.set.call(e,this.subarray(n,n+i),t);return i},Li.prototype.fill=function(e,t,n,o){if("string"==typeof e){if("string"==typeof t?(o=t,t=0,n=this.length):"string"==typeof n&&(o=n,n=this.length),1===e.length){var r=e.charCodeAt(0);r<256&&(e=r)}if(void 0!==o&&"string"!=typeof o)throw new TypeError("encoding must be a string");if("string"==typeof o&&!Li.isEncoding(o))throw new TypeError("Unknown encoding: "+o)}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;var i;if(t>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0),"number"==typeof e)for(i=t;i<n;++i)this[i]=e;else{var a=Gi(e)?e:la(new Li(e,o).toString()),s=a.length;for(i=0;i<n-t;++i)this[i+t]=a[i%s]}return this};var ua=/[^+\/0-9A-Za-z-_]/g;function ca(e){return e<16?"0"+e.toString(16):e.toString(16)}function la(e,t){var n;t=t||1/0;for(var o=e.length,r=null,i=[],a=0;a<o;++a){if((n=e.charCodeAt(a))>55295&&n<57344){if(!r){if(n>56319){(t-=3)>-1&&i.push(239,191,189);continue}if(a+1===o){(t-=3)>-1&&i.push(239,191,189);continue}r=n;continue}if(n<56320){(t-=3)>-1&&i.push(239,191,189),r=n;continue}n=65536+(r-55296<<10|n-56320)}else r&&(t-=3)>-1&&i.push(239,191,189);if(r=null,n<128){if((t-=1)<0)break;i.push(n)}else if(n<2048){if((t-=2)<0)break;i.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;i.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;i.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return i}function da(e){return function(e){var t,n,o,r,i,a;Mi||Ii();var s=e.length;if(s%4>0)throw new Error("Invalid string. Length must be a multiple of 4");i="="===e[s-2]?2:"="===e[s-1]?1:0,a=new yi(3*s/4-i),o=i>0?s-4:s;var u=0;for(t=0,n=0;t<o;t+=4,n+=3)r=_i[e.charCodeAt(t)]<<18|_i[e.charCodeAt(t+1)]<<12|_i[e.charCodeAt(t+2)]<<6|_i[e.charCodeAt(t+3)],a[u++]=r>>16&255,a[u++]=r>>8&255,a[u++]=255&r;return 2===i?(r=_i[e.charCodeAt(t)]<<2|_i[e.charCodeAt(t+1)]>>4,a[u++]=255&r):1===i&&(r=_i[e.charCodeAt(t)]<<10|_i[e.charCodeAt(t+1)]<<4|_i[e.charCodeAt(t+2)]>>2,a[u++]=r>>8&255,a[u++]=255&r),a}(function(e){if((e=function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}(e).replace(ua,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function pa(e,t,n,o){for(var r=0;r<o&&!(r+n>=t.length||r>=e.length);++r)t[r+n]=e[r];return r}function fa(e){return null!=e&&(!!e._isBuffer||ha(e)||function(e){return"function"==typeof e.readFloatLE&&"function"==typeof e.slice&&ha(e.slice(0,0))}(e))}function ha(e){return!!e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}function ga(e,t){return e(t={exports:{}},t.exports),t.exports}"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof n.g?n.g:"undefined"!=typeof self&&self;var va=ga((function(e,t){var n;e.exports=(n=n||function(e,t){var n=Object.create||function(){function e(){}return function(t){var n;return e.prototype=t,n=new e,e.prototype=null,n}}(),o={},r=o.lib={},i=r.Base={extend:function(e){var t=n(this);return e&&t.mixIn(e),t.hasOwnProperty("init")&&this.init!==t.init||(t.init=function(){t.$super.init.apply(this,arguments)}),t.init.prototype=t,t.$super=this,t},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}},a=r.WordArray=i.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=null!=t?t:4*e.length},toString:function(e){return(e||u).stringify(this)},concat:function(e){var t=this.words,n=e.words,o=this.sigBytes,r=e.sigBytes;if(this.clamp(),o%4)for(var i=0;i<r;i++){var a=n[i>>>2]>>>24-i%4*8&255;t[o+i>>>2]|=a<<24-(o+i)%4*8}else for(i=0;i<r;i+=4)t[o+i>>>2]=n[i>>>2];return this.sigBytes+=r,this},clamp:function(){var t=this.words,n=this.sigBytes;t[n>>>2]&=4294967295<<32-n%4*8,t.length=e.ceil(n/4)},clone:function(){var e=i.clone.call(this);return e.words=this.words.slice(0),e},random:function(t){for(var n,o=[],r=function(t){var n=987654321,o=4294967295;return function(){var r=((n=36969*(65535&n)+(n>>16)&o)<<16)+(t=18e3*(65535&t)+(t>>16)&o)&o;return r/=4294967296,(r+=.5)*(e.random()>.5?1:-1)}},i=0;i<t;i+=4){var s=r(4294967296*(n||e.random()));n=987654071*s(),o.push(4294967296*s()|0)}return new a.init(o,t)}}),s=o.enc={},u=s.Hex={stringify:function(e){for(var t=e.words,n=e.sigBytes,o=[],r=0;r<n;r++){var i=t[r>>>2]>>>24-r%4*8&255;o.push((i>>>4).toString(16)),o.push((15&i).toString(16))}return o.join("")},parse:function(e){for(var t=e.length,n=[],o=0;o<t;o+=2)n[o>>>3]|=parseInt(e.substr(o,2),16)<<24-o%8*4;return new a.init(n,t/2)}},c=s.Latin1={stringify:function(e){for(var t=e.words,n=e.sigBytes,o=[],r=0;r<n;r++){var i=t[r>>>2]>>>24-r%4*8&255;o.push(String.fromCharCode(i))}return o.join("")},parse:function(e){for(var t=e.length,n=[],o=0;o<t;o++)n[o>>>2]|=(255&e.charCodeAt(o))<<24-o%4*8;return new a.init(n,t)}},l=s.Utf8={stringify:function(e){try{return decodeURIComponent(escape(c.stringify(e)))}catch(e){throw new Error("Malformed UTF-8 data")}},parse:function(e){return c.parse(unescape(encodeURIComponent(e)))}},d=r.BufferedBlockAlgorithm=i.extend({reset:function(){this._data=new a.init,this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=l.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(t){var n=this._data,o=n.words,r=n.sigBytes,i=this.blockSize,s=r/(4*i),u=(s=t?e.ceil(s):e.max((0|s)-this._minBufferSize,0))*i,c=e.min(4*u,r);if(u){for(var l=0;l<u;l+=i)this._doProcessBlock(o,l);var d=o.splice(0,u);n.sigBytes-=c}return new a.init(d,c)},clone:function(){var e=i.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0}),p=(r.Hasher=d.extend({cfg:i.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){d.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(e){return function(t,n){return new e.init(n).finalize(t)}},_createHmacHelper:function(e){return function(t,n){return new p.HMAC.init(e,n).finalize(t)}}}),o.algo={});return o}(Math),n)})),ma=(ga((function(e,t){var n,o,r,i,a,s;e.exports=(r=(o=n=va).lib,i=r.Base,a=r.WordArray,(s=o.x64={}).Word=i.extend({init:function(e,t){this.high=e,this.low=t}}),s.WordArray=i.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=null!=t?t:8*e.length},toX32:function(){for(var e=this.words,t=e.length,n=[],o=0;o<t;o++){var r=e[o];n.push(r.high),n.push(r.low)}return a.create(n,this.sigBytes)},clone:function(){for(var e=i.clone.call(this),t=e.words=this.words.slice(0),n=t.length,o=0;o<n;o++)t[o]=t[o].clone();return e}}),n)})),ga((function(e,t){var n;e.exports=(n=va,function(){if("function"==typeof ArrayBuffer){var e=n.lib.WordArray,t=e.init;(e.init=function(e){if(e instanceof ArrayBuffer&&(e=new Uint8Array(e)),(e instanceof Int8Array||"undefined"!=typeof Uint8ClampedArray&&e instanceof Uint8ClampedArray||e instanceof Int16Array||e instanceof Uint16Array||e instanceof Int32Array||e instanceof Uint32Array||e instanceof Float32Array||e instanceof Float64Array)&&(e=new Uint8Array(e.buffer,e.byteOffset,e.byteLength)),e instanceof Uint8Array){for(var n=e.byteLength,o=[],r=0;r<n;r++)o[r>>>2]|=e[r]<<24-r%4*8;t.call(this,o,n)}else t.apply(this,arguments)}).prototype=e}}(),n.lib.WordArray)})),ga((function(e,t){var n;e.exports=(n=va,function(){var e=n,t=e.lib.WordArray,o=e.enc;function r(e){return e<<8&4278255360|e>>>8&16711935}o.Utf16=o.Utf16BE={stringify:function(e){for(var t=e.words,n=e.sigBytes,o=[],r=0;r<n;r+=2){var i=t[r>>>2]>>>16-r%4*8&65535;o.push(String.fromCharCode(i))}return o.join("")},parse:function(e){for(var n=e.length,o=[],r=0;r<n;r++)o[r>>>1]|=e.charCodeAt(r)<<16-r%2*16;return t.create(o,2*n)}},o.Utf16LE={stringify:function(e){for(var t=e.words,n=e.sigBytes,o=[],i=0;i<n;i+=2){var a=r(t[i>>>2]>>>16-i%4*8&65535);o.push(String.fromCharCode(a))}return o.join("")},parse:function(e){for(var n=e.length,o=[],i=0;i<n;i++)o[i>>>1]|=r(e.charCodeAt(i)<<16-i%2*16);return t.create(o,2*n)}}}(),n.enc.Utf16)})),ga((function(e,t){var n,o,r;e.exports=(r=(o=n=va).lib.WordArray,o.enc.Base64={stringify:function(e){var t=e.words,n=e.sigBytes,o=this._map;e.clamp();for(var r=[],i=0;i<n;i+=3)for(var a=(t[i>>>2]>>>24-i%4*8&255)<<16|(t[i+1>>>2]>>>24-(i+1)%4*8&255)<<8|t[i+2>>>2]>>>24-(i+2)%4*8&255,s=0;s<4&&i+.75*s<n;s++)r.push(o.charAt(a>>>6*(3-s)&63));var u=o.charAt(64);if(u)for(;r.length%4;)r.push(u);return r.join("")},parse:function(e){var t=e.length,n=this._map,o=this._reverseMap;if(!o){o=this._reverseMap=[];for(var i=0;i<n.length;i++)o[n.charCodeAt(i)]=i}var a=n.charAt(64);if(a){var s=e.indexOf(a);-1!==s&&(t=s)}return function(e,t,n){for(var o=[],i=0,a=0;a<t;a++)if(a%4){var s=n[e.charCodeAt(a-1)]<<a%4*2,u=n[e.charCodeAt(a)]>>>6-a%4*2;o[i>>>2]|=(s|u)<<24-i%4*8,i++}return r.create(o,i)}(e,t,o)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="},n.enc.Base64)})),ga((function(e,t){var n;e.exports=(n=va,function(e){var t=n,o=t.lib,r=o.WordArray,i=o.Hasher,a=t.algo,s=[];!function(){for(var t=0;t<64;t++)s[t]=4294967296*e.abs(e.sin(t+1))|0}();var u=a.MD5=i.extend({_doReset:function(){this._hash=new r.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(e,t){for(var n=0;n<16;n++){var o=t+n,r=e[o];e[o]=16711935&(r<<8|r>>>24)|4278255360&(r<<24|r>>>8)}var i=this._hash.words,a=e[t+0],u=e[t+1],f=e[t+2],h=e[t+3],g=e[t+4],v=e[t+5],m=e[t+6],_=e[t+7],y=e[t+8],M=e[t+9],I=e[t+10],C=e[t+11],k=e[t+12],T=e[t+13],S=e[t+14],b=e[t+15],D=i[0],E=i[1],A=i[2],L=i[3];D=c(D,E,A,L,a,7,s[0]),L=c(L,D,E,A,u,12,s[1]),A=c(A,L,D,E,f,17,s[2]),E=c(E,A,L,D,h,22,s[3]),D=c(D,E,A,L,g,7,s[4]),L=c(L,D,E,A,v,12,s[5]),A=c(A,L,D,E,m,17,s[6]),E=c(E,A,L,D,_,22,s[7]),D=c(D,E,A,L,y,7,s[8]),L=c(L,D,E,A,M,12,s[9]),A=c(A,L,D,E,I,17,s[10]),E=c(E,A,L,D,C,22,s[11]),D=c(D,E,A,L,k,7,s[12]),L=c(L,D,E,A,T,12,s[13]),A=c(A,L,D,E,S,17,s[14]),D=l(D,E=c(E,A,L,D,b,22,s[15]),A,L,u,5,s[16]),L=l(L,D,E,A,m,9,s[17]),A=l(A,L,D,E,C,14,s[18]),E=l(E,A,L,D,a,20,s[19]),D=l(D,E,A,L,v,5,s[20]),L=l(L,D,E,A,I,9,s[21]),A=l(A,L,D,E,b,14,s[22]),E=l(E,A,L,D,g,20,s[23]),D=l(D,E,A,L,M,5,s[24]),L=l(L,D,E,A,S,9,s[25]),A=l(A,L,D,E,h,14,s[26]),E=l(E,A,L,D,y,20,s[27]),D=l(D,E,A,L,T,5,s[28]),L=l(L,D,E,A,f,9,s[29]),A=l(A,L,D,E,_,14,s[30]),D=d(D,E=l(E,A,L,D,k,20,s[31]),A,L,v,4,s[32]),L=d(L,D,E,A,y,11,s[33]),A=d(A,L,D,E,C,16,s[34]),E=d(E,A,L,D,S,23,s[35]),D=d(D,E,A,L,u,4,s[36]),L=d(L,D,E,A,g,11,s[37]),A=d(A,L,D,E,_,16,s[38]),E=d(E,A,L,D,I,23,s[39]),D=d(D,E,A,L,T,4,s[40]),L=d(L,D,E,A,a,11,s[41]),A=d(A,L,D,E,h,16,s[42]),E=d(E,A,L,D,m,23,s[43]),D=d(D,E,A,L,M,4,s[44]),L=d(L,D,E,A,k,11,s[45]),A=d(A,L,D,E,b,16,s[46]),D=p(D,E=d(E,A,L,D,f,23,s[47]),A,L,a,6,s[48]),L=p(L,D,E,A,_,10,s[49]),A=p(A,L,D,E,S,15,s[50]),E=p(E,A,L,D,v,21,s[51]),D=p(D,E,A,L,k,6,s[52]),L=p(L,D,E,A,h,10,s[53]),A=p(A,L,D,E,I,15,s[54]),E=p(E,A,L,D,u,21,s[55]),D=p(D,E,A,L,y,6,s[56]),L=p(L,D,E,A,b,10,s[57]),A=p(A,L,D,E,m,15,s[58]),E=p(E,A,L,D,T,21,s[59]),D=p(D,E,A,L,g,6,s[60]),L=p(L,D,E,A,C,10,s[61]),A=p(A,L,D,E,f,15,s[62]),E=p(E,A,L,D,M,21,s[63]),i[0]=i[0]+D|0,i[1]=i[1]+E|0,i[2]=i[2]+A|0,i[3]=i[3]+L|0},_doFinalize:function(){var t=this._data,n=t.words,o=8*this._nDataBytes,r=8*t.sigBytes;n[r>>>5]|=128<<24-r%32;var i=e.floor(o/4294967296),a=o;n[15+(r+64>>>9<<4)]=16711935&(i<<8|i>>>24)|4278255360&(i<<24|i>>>8),n[14+(r+64>>>9<<4)]=16711935&(a<<8|a>>>24)|4278255360&(a<<24|a>>>8),t.sigBytes=4*(n.length+1),this._process();for(var s=this._hash,u=s.words,c=0;c<4;c++){var l=u[c];u[c]=16711935&(l<<8|l>>>24)|4278255360&(l<<24|l>>>8)}return s},clone:function(){var e=i.clone.call(this);return e._hash=this._hash.clone(),e}});function c(e,t,n,o,r,i,a){var s=e+(t&n|~t&o)+r+a;return(s<<i|s>>>32-i)+t}function l(e,t,n,o,r,i,a){var s=e+(t&o|n&~o)+r+a;return(s<<i|s>>>32-i)+t}function d(e,t,n,o,r,i,a){var s=e+(t^n^o)+r+a;return(s<<i|s>>>32-i)+t}function p(e,t,n,o,r,i,a){var s=e+(n^(t|~o))+r+a;return(s<<i|s>>>32-i)+t}t.MD5=i._createHelper(u),t.HmacMD5=i._createHmacHelper(u)}(Math),n.MD5)})),ga((function(e,t){var n,o,r,i,a,s,u,c;e.exports=(r=(o=n=va).lib,i=r.WordArray,a=r.Hasher,s=o.algo,u=[],c=s.SHA1=a.extend({_doReset:function(){this._hash=new i.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(e,t){for(var n=this._hash.words,o=n[0],r=n[1],i=n[2],a=n[3],s=n[4],c=0;c<80;c++){if(c<16)u[c]=0|e[t+c];else{var l=u[c-3]^u[c-8]^u[c-14]^u[c-16];u[c]=l<<1|l>>>31}var d=(o<<5|o>>>27)+s+u[c];d+=c<20?1518500249+(r&i|~r&a):c<40?1859775393+(r^i^a):c<60?(r&i|r&a|i&a)-1894007588:(r^i^a)-899497514,s=a,a=i,i=r<<30|r>>>2,r=o,o=d}n[0]=n[0]+o|0,n[1]=n[1]+r|0,n[2]=n[2]+i|0,n[3]=n[3]+a|0,n[4]=n[4]+s|0},_doFinalize:function(){var e=this._data,t=e.words,n=8*this._nDataBytes,o=8*e.sigBytes;return t[o>>>5]|=128<<24-o%32,t[14+(o+64>>>9<<4)]=Math.floor(n/4294967296),t[15+(o+64>>>9<<4)]=n,e.sigBytes=4*t.length,this._process(),this._hash},clone:function(){var e=a.clone.call(this);return e._hash=this._hash.clone(),e}}),o.SHA1=a._createHelper(c),o.HmacSHA1=a._createHmacHelper(c),n.SHA1)})),ga((function(e,t){var n;e.exports=(n=va,function(e){var t=n,o=t.lib,r=o.WordArray,i=o.Hasher,a=t.algo,s=[],u=[];!function(){function t(t){for(var n=e.sqrt(t),o=2;o<=n;o++)if(!(t%o))return!1;return!0}function n(e){return 4294967296*(e-(0|e))|0}for(var o=2,r=0;r<64;)t(o)&&(r<8&&(s[r]=n(e.pow(o,.5))),u[r]=n(e.pow(o,1/3)),r++),o++}();var c=[],l=a.SHA256=i.extend({_doReset:function(){this._hash=new r.init(s.slice(0))},_doProcessBlock:function(e,t){for(var n=this._hash.words,o=n[0],r=n[1],i=n[2],a=n[3],s=n[4],l=n[5],d=n[6],p=n[7],f=0;f<64;f++){if(f<16)c[f]=0|e[t+f];else{var h=c[f-15],g=(h<<25|h>>>7)^(h<<14|h>>>18)^h>>>3,v=c[f-2],m=(v<<15|v>>>17)^(v<<13|v>>>19)^v>>>10;c[f]=g+c[f-7]+m+c[f-16]}var _=o&r^o&i^r&i,y=(o<<30|o>>>2)^(o<<19|o>>>13)^(o<<10|o>>>22),M=p+((s<<26|s>>>6)^(s<<21|s>>>11)^(s<<7|s>>>25))+(s&l^~s&d)+u[f]+c[f];p=d,d=l,l=s,s=a+M|0,a=i,i=r,r=o,o=M+(y+_)|0}n[0]=n[0]+o|0,n[1]=n[1]+r|0,n[2]=n[2]+i|0,n[3]=n[3]+a|0,n[4]=n[4]+s|0,n[5]=n[5]+l|0,n[6]=n[6]+d|0,n[7]=n[7]+p|0},_doFinalize:function(){var t=this._data,n=t.words,o=8*this._nDataBytes,r=8*t.sigBytes;return n[r>>>5]|=128<<24-r%32,n[14+(r+64>>>9<<4)]=e.floor(o/4294967296),n[15+(r+64>>>9<<4)]=o,t.sigBytes=4*n.length,this._process(),this._hash},clone:function(){var e=i.clone.call(this);return e._hash=this._hash.clone(),e}});t.SHA256=i._createHelper(l),t.HmacSHA256=i._createHmacHelper(l)}(Math),n.SHA256)})),ga((function(e,t){var n,o,r,i,a,s;e.exports=(r=(o=n=va).lib.WordArray,i=o.algo,a=i.SHA256,s=i.SHA224=a.extend({_doReset:function(){this._hash=new r.init([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428])},_doFinalize:function(){var e=a._doFinalize.call(this);return e.sigBytes-=4,e}}),o.SHA224=a._createHelper(s),o.HmacSHA224=a._createHmacHelper(s),n.SHA224)})),ga((function(e,t){var n;e.exports=(n=va,function(){var e=n,t=e.lib.Hasher,o=e.x64,r=o.Word,i=o.WordArray,a=e.algo;function s(){return r.create.apply(r,arguments)}var u=[s(1116352408,3609767458),s(1899447441,602891725),s(3049323471,3964484399),s(3921009573,2173295548),s(961987163,4081628472),s(1508970993,3053834265),s(2453635748,2937671579),s(2870763221,3664609560),s(3624381080,2734883394),s(310598401,1164996542),s(607225278,1323610764),s(1426881987,3590304994),s(1925078388,4068182383),s(2162078206,991336113),s(2614888103,633803317),s(3248222580,3479774868),s(3835390401,2666613458),s(4022224774,944711139),s(264347078,2341262773),s(604807628,2007800933),s(770255983,1495990901),s(1249150122,1856431235),s(1555081692,3175218132),s(1996064986,2198950837),s(2554220882,3999719339),s(2821834349,766784016),s(2952996808,2566594879),s(3210313671,3203337956),s(3336571891,1034457026),s(3584528711,2466948901),s(113926993,3758326383),s(338241895,168717936),s(666307205,1188179964),s(773529912,1546045734),s(1294757372,1522805485),s(1396182291,2643833823),s(1695183700,2343527390),s(1986661051,1014477480),s(2177026350,1206759142),s(2456956037,344077627),s(2730485921,1290863460),s(2820302411,3158454273),s(3259730800,3505952657),s(3345764771,106217008),s(3516065817,3606008344),s(3600352804,1432725776),s(4094571909,1467031594),s(275423344,851169720),s(430227734,3100823752),s(506948616,1363258195),s(659060556,3750685593),s(883997877,3785050280),s(958139571,3318307427),s(1322822218,3812723403),s(1537002063,2003034995),s(1747873779,3602036899),s(1955562222,1575990012),s(2024104815,1125592928),s(2227730452,2716904306),s(2361852424,442776044),s(2428436474,593698344),s(2756734187,3733110249),s(3204031479,2999351573),s(3329325298,3815920427),s(3391569614,3928383900),s(3515267271,566280711),s(3940187606,3454069534),s(4118630271,4000239992),s(116418474,1914138554),s(174292421,2731055270),s(289380356,3203993006),s(460393269,320620315),s(685471733,587496836),s(852142971,1086792851),s(1017036298,365543100),s(1126000580,2618297676),s(1288033470,3409855158),s(1501505948,4234509866),s(1607167915,987167468),s(1816402316,1246189591)],c=[];!function(){for(var e=0;e<80;e++)c[e]=s()}();var l=a.SHA512=t.extend({_doReset:function(){this._hash=new i.init([new r.init(1779033703,4089235720),new r.init(3144134277,2227873595),new r.init(1013904242,4271175723),new r.init(2773480762,1595750129),new r.init(1359893119,2917565137),new r.init(2600822924,725511199),new r.init(528734635,4215389547),new r.init(1541459225,327033209)])},_doProcessBlock:function(e,t){for(var n=this._hash.words,o=n[0],r=n[1],i=n[2],a=n[3],s=n[4],l=n[5],d=n[6],p=n[7],f=o.high,h=o.low,g=r.high,v=r.low,m=i.high,_=i.low,y=a.high,M=a.low,I=s.high,C=s.low,k=l.high,T=l.low,S=d.high,b=d.low,D=p.high,E=p.low,A=f,L=h,R=g,w=v,O=m,N=_,P=y,G=M,U=I,x=C,F=k,q=T,B=S,V=b,H=D,K=E,j=0;j<80;j++){var z=c[j];if(j<16)var Z=z.high=0|e[t+2*j],W=z.low=0|e[t+2*j+1];else{var Y=c[j-15],J=Y.high,X=Y.low,$=(J>>>1|X<<31)^(J>>>8|X<<24)^J>>>7,Q=(X>>>1|J<<31)^(X>>>8|J<<24)^(X>>>7|J<<25),ee=c[j-2],te=ee.high,ne=ee.low,oe=(te>>>19|ne<<13)^(te<<3|ne>>>29)^te>>>6,re=(ne>>>19|te<<13)^(ne<<3|te>>>29)^(ne>>>6|te<<26),ie=c[j-7],ae=ie.high,se=ie.low,ue=c[j-16],ce=ue.high,le=ue.low;Z=(Z=(Z=$+ae+((W=Q+se)>>>0<Q>>>0?1:0))+oe+((W+=re)>>>0<re>>>0?1:0))+ce+((W+=le)>>>0<le>>>0?1:0),z.high=Z,z.low=W}var de,pe=U&F^~U&B,fe=x&q^~x&V,he=A&R^A&O^R&O,ge=L&w^L&N^w&N,ve=(A>>>28|L<<4)^(A<<30|L>>>2)^(A<<25|L>>>7),me=(L>>>28|A<<4)^(L<<30|A>>>2)^(L<<25|A>>>7),_e=(U>>>14|x<<18)^(U>>>18|x<<14)^(U<<23|x>>>9),ye=(x>>>14|U<<18)^(x>>>18|U<<14)^(x<<23|U>>>9),Me=u[j],Ie=Me.high,Ce=Me.low,ke=H+_e+((de=K+ye)>>>0<K>>>0?1:0),Te=me+ge;H=B,K=V,B=F,V=q,F=U,q=x,U=P+(ke=(ke=(ke=ke+pe+((de+=fe)>>>0<fe>>>0?1:0))+Ie+((de+=Ce)>>>0<Ce>>>0?1:0))+Z+((de+=W)>>>0<W>>>0?1:0))+((x=G+de|0)>>>0<G>>>0?1:0)|0,P=O,G=N,O=R,N=w,R=A,w=L,A=ke+(ve+he+(Te>>>0<me>>>0?1:0))+((L=de+Te|0)>>>0<de>>>0?1:0)|0}h=o.low=h+L,o.high=f+A+(h>>>0<L>>>0?1:0),v=r.low=v+w,r.high=g+R+(v>>>0<w>>>0?1:0),_=i.low=_+N,i.high=m+O+(_>>>0<N>>>0?1:0),M=a.low=M+G,a.high=y+P+(M>>>0<G>>>0?1:0),C=s.low=C+x,s.high=I+U+(C>>>0<x>>>0?1:0),T=l.low=T+q,l.high=k+F+(T>>>0<q>>>0?1:0),b=d.low=b+V,d.high=S+B+(b>>>0<V>>>0?1:0),E=p.low=E+K,p.high=D+H+(E>>>0<K>>>0?1:0)},_doFinalize:function(){var e=this._data,t=e.words,n=8*this._nDataBytes,o=8*e.sigBytes;return t[o>>>5]|=128<<24-o%32,t[30+(o+128>>>10<<5)]=Math.floor(n/4294967296),t[31+(o+128>>>10<<5)]=n,e.sigBytes=4*t.length,this._process(),this._hash.toX32()},clone:function(){var e=t.clone.call(this);return e._hash=this._hash.clone(),e},blockSize:32});e.SHA512=t._createHelper(l),e.HmacSHA512=t._createHmacHelper(l)}(),n.SHA512)})),ga((function(e,t){var n,o,r,i,a,s,u,c;e.exports=(r=(o=n=va).x64,i=r.Word,a=r.WordArray,s=o.algo,u=s.SHA512,c=s.SHA384=u.extend({_doReset:function(){this._hash=new a.init([new i.init(3418070365,3238371032),new i.init(1654270250,914150663),new i.init(2438529370,812702999),new i.init(355462360,4144912697),new i.init(1731405415,4290775857),new i.init(2394180231,1750603025),new i.init(3675008525,1694076839),new i.init(1203062813,3204075428)])},_doFinalize:function(){var e=u._doFinalize.call(this);return e.sigBytes-=16,e}}),o.SHA384=u._createHelper(c),o.HmacSHA384=u._createHmacHelper(c),n.SHA384)})),ga((function(e,t){var n;e.exports=(n=va,function(e){var t=n,o=t.lib,r=o.WordArray,i=o.Hasher,a=t.x64.Word,s=t.algo,u=[],c=[],l=[];!function(){for(var e=1,t=0,n=0;n<24;n++){u[e+5*t]=(n+1)*(n+2)/2%64;var o=(2*e+3*t)%5;e=t%5,t=o}for(e=0;e<5;e++)for(t=0;t<5;t++)c[e+5*t]=t+(2*e+3*t)%5*5;for(var r=1,i=0;i<24;i++){for(var s=0,d=0,p=0;p<7;p++){if(1&r){var f=(1<<p)-1;f<32?d^=1<<f:s^=1<<f-32}128&r?r=r<<1^113:r<<=1}l[i]=a.create(s,d)}}();var d=[];!function(){for(var e=0;e<25;e++)d[e]=a.create()}();var p=s.SHA3=i.extend({cfg:i.cfg.extend({outputLength:512}),_doReset:function(){for(var e=this._state=[],t=0;t<25;t++)e[t]=new a.init;this.blockSize=(1600-2*this.cfg.outputLength)/32},_doProcessBlock:function(e,t){for(var n=this._state,o=this.blockSize/2,r=0;r<o;r++){var i=e[t+2*r],a=e[t+2*r+1];i=16711935&(i<<8|i>>>24)|4278255360&(i<<24|i>>>8),a=16711935&(a<<8|a>>>24)|4278255360&(a<<24|a>>>8),(E=n[r]).high^=a,E.low^=i}for(var s=0;s<24;s++){for(var p=0;p<5;p++){for(var f=0,h=0,g=0;g<5;g++)f^=(E=n[p+5*g]).high,h^=E.low;var v=d[p];v.high=f,v.low=h}for(p=0;p<5;p++){var m=d[(p+4)%5],_=d[(p+1)%5],y=_.high,M=_.low;for(f=m.high^(y<<1|M>>>31),h=m.low^(M<<1|y>>>31),g=0;g<5;g++)(E=n[p+5*g]).high^=f,E.low^=h}for(var I=1;I<25;I++){var C=(E=n[I]).high,k=E.low,T=u[I];T<32?(f=C<<T|k>>>32-T,h=k<<T|C>>>32-T):(f=k<<T-32|C>>>64-T,h=C<<T-32|k>>>64-T);var S=d[c[I]];S.high=f,S.low=h}var b=d[0],D=n[0];for(b.high=D.high,b.low=D.low,p=0;p<5;p++)for(g=0;g<5;g++){var E=n[I=p+5*g],A=d[I],L=d[(p+1)%5+5*g],R=d[(p+2)%5+5*g];E.high=A.high^~L.high&R.high,E.low=A.low^~L.low&R.low}E=n[0];var w=l[s];E.high^=w.high,E.low^=w.low}},_doFinalize:function(){var t=this._data,n=t.words,o=(this._nDataBytes,8*t.sigBytes),i=32*this.blockSize;n[o>>>5]|=1<<24-o%32,n[(e.ceil((o+1)/i)*i>>>5)-1]|=128,t.sigBytes=4*n.length,this._process();for(var a=this._state,s=this.cfg.outputLength/8,u=s/8,c=[],l=0;l<u;l++){var d=a[l],p=d.high,f=d.low;p=16711935&(p<<8|p>>>24)|4278255360&(p<<24|p>>>8),f=16711935&(f<<8|f>>>24)|4278255360&(f<<24|f>>>8),c.push(f),c.push(p)}return new r.init(c,s)},clone:function(){for(var e=i.clone.call(this),t=e._state=this._state.slice(0),n=0;n<25;n++)t[n]=t[n].clone();return e}});t.SHA3=i._createHelper(p),t.HmacSHA3=i._createHmacHelper(p)}(Math),n.SHA3)})),ga((function(e,t){var n;e.exports=(n=va,function(e){var t=n,o=t.lib,r=o.WordArray,i=o.Hasher,a=t.algo,s=r.create([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13]),u=r.create([5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11]),c=r.create([11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6]),l=r.create([8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]),d=r.create([0,1518500249,1859775393,2400959708,2840853838]),p=r.create([1352829926,1548603684,1836072691,2053994217,0]),f=a.RIPEMD160=i.extend({_doReset:function(){this._hash=r.create([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(e,t){for(var n=0;n<16;n++){var o=t+n,r=e[o];e[o]=16711935&(r<<8|r>>>24)|4278255360&(r<<24|r>>>8)}var i,a,f,M,I,C,k,T,S,b,D,E=this._hash.words,A=d.words,L=p.words,R=s.words,w=u.words,O=c.words,N=l.words;for(C=i=E[0],k=a=E[1],T=f=E[2],S=M=E[3],b=I=E[4],n=0;n<80;n+=1)D=i+e[t+R[n]]|0,D+=n<16?h(a,f,M)+A[0]:n<32?g(a,f,M)+A[1]:n<48?v(a,f,M)+A[2]:n<64?m(a,f,M)+A[3]:_(a,f,M)+A[4],D=(D=y(D|=0,O[n]))+I|0,i=I,I=M,M=y(f,10),f=a,a=D,D=C+e[t+w[n]]|0,D+=n<16?_(k,T,S)+L[0]:n<32?m(k,T,S)+L[1]:n<48?v(k,T,S)+L[2]:n<64?g(k,T,S)+L[3]:h(k,T,S)+L[4],D=(D=y(D|=0,N[n]))+b|0,C=b,b=S,S=y(T,10),T=k,k=D;D=E[1]+f+S|0,E[1]=E[2]+M+b|0,E[2]=E[3]+I+C|0,E[3]=E[4]+i+k|0,E[4]=E[0]+a+T|0,E[0]=D},_doFinalize:function(){var e=this._data,t=e.words,n=8*this._nDataBytes,o=8*e.sigBytes;t[o>>>5]|=128<<24-o%32,t[14+(o+64>>>9<<4)]=16711935&(n<<8|n>>>24)|4278255360&(n<<24|n>>>8),e.sigBytes=4*(t.length+1),this._process();for(var r=this._hash,i=r.words,a=0;a<5;a++){var s=i[a];i[a]=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8)}return r},clone:function(){var e=i.clone.call(this);return e._hash=this._hash.clone(),e}});function h(e,t,n){return e^t^n}function g(e,t,n){return e&t|~e&n}function v(e,t,n){return(e|~t)^n}function m(e,t,n){return e&n|t&~n}function _(e,t,n){return e^(t|~n)}function y(e,t){return e<<t|e>>>32-t}t.RIPEMD160=i._createHelper(f),t.HmacRIPEMD160=i._createHmacHelper(f)}(),n.RIPEMD160)})),ga((function(e,t){var n,o,r,i;e.exports=(o=(n=va).lib.Base,r=n.enc,i=r.Utf8,void(n.algo.HMAC=o.extend({init:function(e,t){e=this._hasher=new e.init,"string"==typeof t&&(t=i.parse(t));var n=e.blockSize,o=4*n;t.sigBytes>o&&(t=e.finalize(t)),t.clamp();for(var r=this._oKey=t.clone(),a=this._iKey=t.clone(),s=r.words,u=a.words,c=0;c<n;c++)s[c]^=1549556828,u[c]^=909522486;r.sigBytes=a.sigBytes=o,this.reset()},reset:function(){var e=this._hasher;e.reset(),e.update(this._iKey)},update:function(e){return this._hasher.update(e),this},finalize:function(e){var t=this._hasher,n=t.finalize(e);return t.reset(),t.finalize(this._oKey.clone().concat(n))}})))})),ga((function(e,t){var n,o,r,i,a,s,u,c,l;e.exports=(i=(r=(o=n=va).lib).Base,a=r.WordArray,u=(s=o.algo).SHA1,c=s.HMAC,l=s.PBKDF2=i.extend({cfg:i.extend({keySize:4,hasher:u,iterations:1}),init:function(e){this.cfg=this.cfg.extend(e)},compute:function(e,t){for(var n=this.cfg,o=c.create(n.hasher,e),r=a.create(),i=a.create([1]),s=r.words,u=i.words,l=n.keySize,d=n.iterations;s.length<l;){var p=o.update(t).finalize(i);o.reset();for(var f=p.words,h=f.length,g=p,v=1;v<d;v++){g=o.finalize(g),o.reset();for(var m=g.words,_=0;_<h;_++)f[_]^=m[_]}r.concat(p),u[0]++}return r.sigBytes=4*l,r}}),o.PBKDF2=function(e,t,n){return l.create(n).compute(e,t)},n.PBKDF2)})),ga((function(e,t){var n,o,r,i,a,s,u,c;e.exports=(i=(r=(o=n=va).lib).Base,a=r.WordArray,u=(s=o.algo).MD5,c=s.EvpKDF=i.extend({cfg:i.extend({keySize:4,hasher:u,iterations:1}),init:function(e){this.cfg=this.cfg.extend(e)},compute:function(e,t){for(var n=this.cfg,o=n.hasher.create(),r=a.create(),i=r.words,s=n.keySize,u=n.iterations;i.length<s;){c&&o.update(c);var c=o.update(e).finalize(t);o.reset();for(var l=1;l<u;l++)c=o.finalize(c),o.reset();r.concat(c)}return r.sigBytes=4*s,r}}),o.EvpKDF=function(e,t,n){return c.create(n).compute(e,t)},n.EvpKDF)})),ga((function(e,t){var n,o,r,i,a,s,u,c,l,d,p,f,h,g,v,m,_,y,M,I,C,k,T;e.exports=void((n=va).lib.Cipher||(o=n,r=o.lib,i=r.Base,a=r.WordArray,s=r.BufferedBlockAlgorithm,u=o.enc,u.Utf8,c=u.Base64,l=o.algo,d=l.EvpKDF,p=r.Cipher=s.extend({cfg:i.extend(),createEncryptor:function(e,t){return this.create(this._ENC_XFORM_MODE,e,t)},createDecryptor:function(e,t){return this.create(this._DEC_XFORM_MODE,e,t)},init:function(e,t,n){this.cfg=this.cfg.extend(n),this._xformMode=e,this._key=t,this.reset()},reset:function(){s.reset.call(this),this._doReset()},process:function(e){return this._append(e),this._process()},finalize:function(e){return e&&this._append(e),this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(){function e(e){return"string"==typeof e?T:I}return function(t){return{encrypt:function(n,o,r){return e(o).encrypt(t,n,o,r)},decrypt:function(n,o,r){return e(o).decrypt(t,n,o,r)}}}}()}),r.StreamCipher=p.extend({_doFinalize:function(){return this._process(!0)},blockSize:1}),f=o.mode={},h=r.BlockCipherMode=i.extend({createEncryptor:function(e,t){return this.Encryptor.create(e,t)},createDecryptor:function(e,t){return this.Decryptor.create(e,t)},init:function(e,t){this._cipher=e,this._iv=t}}),g=f.CBC=function(){var e=h.extend();function t(e,t,n){var o=this._iv;if(o){var r=o;this._iv=undefined}else r=this._prevBlock;for(var i=0;i<n;i++)e[t+i]^=r[i]}return e.Encryptor=e.extend({processBlock:function(e,n){var o=this._cipher,r=o.blockSize;t.call(this,e,n,r),o.encryptBlock(e,n),this._prevBlock=e.slice(n,n+r)}}),e.Decryptor=e.extend({processBlock:function(e,n){var o=this._cipher,r=o.blockSize,i=e.slice(n,n+r);o.decryptBlock(e,n),t.call(this,e,n,r),this._prevBlock=i}}),e}(),v=o.pad={},m=v.Pkcs7={pad:function(e,t){for(var n=4*t,o=n-e.sigBytes%n,r=o<<24|o<<16|o<<8|o,i=[],s=0;s<o;s+=4)i.push(r);var u=a.create(i,o);e.concat(u)},unpad:function(e){var t=255&e.words[e.sigBytes-1>>>2];e.sigBytes-=t}},r.BlockCipher=p.extend({cfg:p.cfg.extend({mode:g,padding:m}),reset:function(){p.reset.call(this);var e=this.cfg,t=e.iv,n=e.mode;if(this._xformMode==this._ENC_XFORM_MODE)var o=n.createEncryptor;else{o=n.createDecryptor;this._minBufferSize=1}this._mode&&this._mode.__creator==o?this._mode.init(this,t&&t.words):(this._mode=o.call(n,this,t&&t.words),this._mode.__creator=o)},_doProcessBlock:function(e,t){this._mode.processBlock(e,t)},_doFinalize:function(){var e=this.cfg.padding;if(this._xformMode==this._ENC_XFORM_MODE){e.pad(this._data,this.blockSize);var t=this._process(!0)}else{t=this._process(!0);e.unpad(t)}return t},blockSize:4}),_=r.CipherParams=i.extend({init:function(e){this.mixIn(e)},toString:function(e){return(e||this.formatter).stringify(this)}}),y=o.format={},M=y.OpenSSL={stringify:function(e){var t=e.ciphertext,n=e.salt;if(n)var o=a.create([1398893684,1701076831]).concat(n).concat(t);else o=t;return o.toString(c)},parse:function(e){var t=c.parse(e),n=t.words;if(1398893684==n[0]&&1701076831==n[1]){var o=a.create(n.slice(2,4));n.splice(0,4),t.sigBytes-=16}return _.create({ciphertext:t,salt:o})}},I=r.SerializableCipher=i.extend({cfg:i.extend({format:M}),encrypt:function(e,t,n,o){o=this.cfg.extend(o);var r=e.createEncryptor(n,o),i=r.finalize(t),a=r.cfg;return _.create({ciphertext:i,key:n,iv:a.iv,algorithm:e,mode:a.mode,padding:a.padding,blockSize:e.blockSize,formatter:o.format})},decrypt:function(e,t,n,o){return o=this.cfg.extend(o),t=this._parse(t,o.format),e.createDecryptor(n,o).finalize(t.ciphertext)},_parse:function(e,t){return"string"==typeof e?t.parse(e,this):e}}),C=o.kdf={},k=C.OpenSSL={execute:function(e,t,n,o){o||(o=a.random(8));var r=d.create({keySize:t+n}).compute(e,o),i=a.create(r.words.slice(t),4*n);return r.sigBytes=4*t,_.create({key:r,iv:i,salt:o})}},T=r.PasswordBasedCipher=I.extend({cfg:I.cfg.extend({kdf:k}),encrypt:function(e,t,n,o){var r=(o=this.cfg.extend(o)).kdf.execute(n,e.keySize,e.ivSize);o.iv=r.iv;var i=I.encrypt.call(this,e,t,r.key,o);return i.mixIn(r),i},decrypt:function(e,t,n,o){o=this.cfg.extend(o),t=this._parse(t,o.format);var r=o.kdf.execute(n,e.keySize,e.ivSize,t.salt);return o.iv=r.iv,I.decrypt.call(this,e,t,r.key,o)}})))})),ga((function(e,t){var n;e.exports=((n=va).mode.CFB=function(){var e=n.lib.BlockCipherMode.extend();function t(e,t,n,o){var r=this._iv;if(r){var i=r.slice(0);this._iv=void 0}else i=this._prevBlock;o.encryptBlock(i,0);for(var a=0;a<n;a++)e[t+a]^=i[a]}return e.Encryptor=e.extend({processBlock:function(e,n){var o=this._cipher,r=o.blockSize;t.call(this,e,n,r,o),this._prevBlock=e.slice(n,n+r)}}),e.Decryptor=e.extend({processBlock:function(e,n){var o=this._cipher,r=o.blockSize,i=e.slice(n,n+r);t.call(this,e,n,r,o),this._prevBlock=i}}),e}(),n.mode.CFB)})),ga((function(e,t){var n,o,r;e.exports=((n=va).mode.CTR=(r=(o=n.lib.BlockCipherMode.extend()).Encryptor=o.extend({processBlock:function(e,t){var n=this._cipher,o=n.blockSize,r=this._iv,i=this._counter;r&&(i=this._counter=r.slice(0),this._iv=void 0);var a=i.slice(0);n.encryptBlock(a,0),i[o-1]=i[o-1]+1|0;for(var s=0;s<o;s++)e[t+s]^=a[s]}}),o.Decryptor=r,o),n.mode.CTR)})),ga((function(e,t){var n;e.exports=((n=va).mode.CTRGladman=function(){var e=n.lib.BlockCipherMode.extend();function t(e){if(255==(e>>24&255)){var t=e>>16&255,n=e>>8&255,o=255&e;255===t?(t=0,255===n?(n=0,255===o?o=0:++o):++n):++t,e=0,e+=t<<16,e+=n<<8,e+=o}else e+=1<<24;return e}var o=e.Encryptor=e.extend({processBlock:function(e,n){var o=this._cipher,r=o.blockSize,i=this._iv,a=this._counter;i&&(a=this._counter=i.slice(0),this._iv=void 0),function(e){0===(e[0]=t(e[0]))&&(e[1]=t(e[1]))}(a);var s=a.slice(0);o.encryptBlock(s,0);for(var u=0;u<r;u++)e[n+u]^=s[u]}});return e.Decryptor=o,e}(),n.mode.CTRGladman)})),ga((function(e,t){var n,o,r;e.exports=((n=va).mode.OFB=(r=(o=n.lib.BlockCipherMode.extend()).Encryptor=o.extend({processBlock:function(e,t){var n=this._cipher,o=n.blockSize,r=this._iv,i=this._keystream;r&&(i=this._keystream=r.slice(0),this._iv=void 0),n.encryptBlock(i,0);for(var a=0;a<o;a++)e[t+a]^=i[a]}}),o.Decryptor=r,o),n.mode.OFB)})),ga((function(e,t){var n,o;e.exports=((n=va).mode.ECB=((o=n.lib.BlockCipherMode.extend()).Encryptor=o.extend({processBlock:function(e,t){this._cipher.encryptBlock(e,t)}}),o.Decryptor=o.extend({processBlock:function(e,t){this._cipher.decryptBlock(e,t)}}),o),n.mode.ECB)})),ga((function(e,t){var n;e.exports=((n=va).pad.AnsiX923={pad:function(e,t){var n=e.sigBytes,o=4*t,r=o-n%o,i=n+r-1;e.clamp(),e.words[i>>>2]|=r<<24-i%4*8,e.sigBytes+=r},unpad:function(e){var t=255&e.words[e.sigBytes-1>>>2];e.sigBytes-=t}},n.pad.Ansix923)})),ga((function(e,t){var n;e.exports=((n=va).pad.Iso10126={pad:function(e,t){var o=4*t,r=o-e.sigBytes%o;e.concat(n.lib.WordArray.random(r-1)).concat(n.lib.WordArray.create([r<<24],1))},unpad:function(e){var t=255&e.words[e.sigBytes-1>>>2];e.sigBytes-=t}},n.pad.Iso10126)})),ga((function(e,t){var n;e.exports=((n=va).pad.Iso97971={pad:function(e,t){e.concat(n.lib.WordArray.create([2147483648],1)),n.pad.ZeroPadding.pad(e,t)},unpad:function(e){n.pad.ZeroPadding.unpad(e),e.sigBytes--}},n.pad.Iso97971)})),ga((function(e,t){var n;e.exports=((n=va).pad.ZeroPadding={pad:function(e,t){var n=4*t;e.clamp(),e.sigBytes+=n-(e.sigBytes%n||n)},unpad:function(e){for(var t=e.words,n=e.sigBytes-1;!(t[n>>>2]>>>24-n%4*8&255);)n--;e.sigBytes=n+1}},n.pad.ZeroPadding)})),ga((function(e,t){var n;e.exports=((n=va).pad.NoPadding={pad:function(){},unpad:function(){}},n.pad.NoPadding)})),ga((function(e,t){var n,o,r,i;e.exports=(r=(o=n=va).lib.CipherParams,i=o.enc.Hex,o.format.Hex={stringify:function(e){return e.ciphertext.toString(i)},parse:function(e){var t=i.parse(e);return r.create({ciphertext:t})}},n.format.Hex)})),ga((function(e,t){var n;e.exports=(n=va,function(){var e=n,t=e.lib.BlockCipher,o=e.algo,r=[],i=[],a=[],s=[],u=[],c=[],l=[],d=[],p=[],f=[];!function(){for(var e=[],t=0;t<256;t++)e[t]=t<128?t<<1:t<<1^283;var n=0,o=0;for(t=0;t<256;t++){var h=o^o<<1^o<<2^o<<3^o<<4;h=h>>>8^255&h^99,r[n]=h,i[h]=n;var g=e[n],v=e[g],m=e[v],_=257*e[h]^16843008*h;a[n]=_<<24|_>>>8,s[n]=_<<16|_>>>16,u[n]=_<<8|_>>>24,c[n]=_,_=16843009*m^65537*v^257*g^16843008*n,l[h]=_<<24|_>>>8,d[h]=_<<16|_>>>16,p[h]=_<<8|_>>>24,f[h]=_,n?(n=g^e[e[e[m^g]]],o^=e[e[o]]):n=o=1}}();var h=[0,1,2,4,8,16,32,64,128,27,54],g=o.AES=t.extend({_doReset:function(){if(!this._nRounds||this._keyPriorReset!==this._key){for(var e=this._keyPriorReset=this._key,t=e.words,n=e.sigBytes/4,o=4*((this._nRounds=n+6)+1),i=this._keySchedule=[],a=0;a<o;a++)if(a<n)i[a]=t[a];else{var s=i[a-1];a%n?n>6&&a%n==4&&(s=r[s>>>24]<<24|r[s>>>16&255]<<16|r[s>>>8&255]<<8|r[255&s]):(s=r[(s=s<<8|s>>>24)>>>24]<<24|r[s>>>16&255]<<16|r[s>>>8&255]<<8|r[255&s],s^=h[a/n|0]<<24),i[a]=i[a-n]^s}for(var u=this._invKeySchedule=[],c=0;c<o;c++)a=o-c,s=c%4?i[a]:i[a-4],u[c]=c<4||a<=4?s:l[r[s>>>24]]^d[r[s>>>16&255]]^p[r[s>>>8&255]]^f[r[255&s]]}},encryptBlock:function(e,t){this._doCryptBlock(e,t,this._keySchedule,a,s,u,c,r)},decryptBlock:function(e,t){var n=e[t+1];e[t+1]=e[t+3],e[t+3]=n,this._doCryptBlock(e,t,this._invKeySchedule,l,d,p,f,i),n=e[t+1],e[t+1]=e[t+3],e[t+3]=n},_doCryptBlock:function(e,t,n,o,r,i,a,s){for(var u=this._nRounds,c=e[t]^n[0],l=e[t+1]^n[1],d=e[t+2]^n[2],p=e[t+3]^n[3],f=4,h=1;h<u;h++){var g=o[c>>>24]^r[l>>>16&255]^i[d>>>8&255]^a[255&p]^n[f++],v=o[l>>>24]^r[d>>>16&255]^i[p>>>8&255]^a[255&c]^n[f++],m=o[d>>>24]^r[p>>>16&255]^i[c>>>8&255]^a[255&l]^n[f++],_=o[p>>>24]^r[c>>>16&255]^i[l>>>8&255]^a[255&d]^n[f++];c=g,l=v,d=m,p=_}g=(s[c>>>24]<<24|s[l>>>16&255]<<16|s[d>>>8&255]<<8|s[255&p])^n[f++],v=(s[l>>>24]<<24|s[d>>>16&255]<<16|s[p>>>8&255]<<8|s[255&c])^n[f++],m=(s[d>>>24]<<24|s[p>>>16&255]<<16|s[c>>>8&255]<<8|s[255&l])^n[f++],_=(s[p>>>24]<<24|s[c>>>16&255]<<16|s[l>>>8&255]<<8|s[255&d])^n[f++],e[t]=g,e[t+1]=v,e[t+2]=m,e[t+3]=_},keySize:8});e.AES=t._createHelper(g)}(),n.AES)})),ga((function(e,t){var n;e.exports=(n=va,function(){var e=n,t=e.lib,o=t.WordArray,r=t.BlockCipher,i=e.algo,a=[57,49,41,33,25,17,9,1,58,50,42,34,26,18,10,2,59,51,43,35,27,19,11,3,60,52,44,36,63,55,47,39,31,23,15,7,62,54,46,38,30,22,14,6,61,53,45,37,29,21,13,5,28,20,12,4],s=[14,17,11,24,1,5,3,28,15,6,21,10,23,19,12,4,26,8,16,7,27,20,13,2,41,52,31,37,47,55,30,40,51,45,33,48,44,49,39,56,34,53,46,42,50,36,29,32],u=[1,2,4,6,8,10,12,14,15,17,19,21,23,25,27,28],c=[{0:8421888,268435456:32768,536870912:8421378,805306368:2,1073741824:512,1342177280:8421890,1610612736:8389122,1879048192:8388608,2147483648:514,2415919104:8389120,2684354560:33280,2952790016:8421376,3221225472:32770,3489660928:8388610,3758096384:0,4026531840:33282,134217728:0,402653184:8421890,671088640:33282,939524096:32768,1207959552:8421888,1476395008:512,1744830464:8421378,2013265920:2,2281701376:8389120,2550136832:33280,2818572288:8421376,3087007744:8389122,3355443200:8388610,3623878656:32770,3892314112:514,4160749568:8388608,1:32768,268435457:2,536870913:8421888,805306369:8388608,1073741825:8421378,1342177281:33280,1610612737:512,1879048193:8389122,2147483649:8421890,2415919105:8421376,2684354561:8388610,2952790017:33282,3221225473:514,3489660929:8389120,3758096385:32770,4026531841:0,134217729:8421890,402653185:8421376,671088641:8388608,939524097:512,1207959553:32768,1476395009:8388610,1744830465:2,2013265921:33282,2281701377:32770,2550136833:8389122,2818572289:514,3087007745:8421888,3355443201:8389120,3623878657:0,3892314113:33280,4160749569:8421378},{0:1074282512,16777216:16384,33554432:524288,50331648:1074266128,67108864:1073741840,83886080:1074282496,100663296:1073758208,117440512:16,134217728:540672,150994944:1073758224,167772160:1073741824,184549376:540688,201326592:524304,218103808:0,234881024:16400,251658240:1074266112,8388608:1073758208,25165824:540688,41943040:16,58720256:1073758224,75497472:1074282512,92274688:1073741824,109051904:524288,125829120:1074266128,142606336:524304,159383552:0,176160768:16384,192937984:1074266112,209715200:1073741840,226492416:540672,243269632:1074282496,260046848:16400,268435456:0,285212672:1074266128,301989888:1073758224,318767104:1074282496,335544320:1074266112,352321536:16,369098752:540688,385875968:16384,402653184:16400,419430400:524288,436207616:524304,452984832:1073741840,469762048:540672,486539264:1073758208,503316480:1073741824,520093696:1074282512,276824064:540688,293601280:524288,310378496:1074266112,327155712:16384,343932928:1073758208,360710144:1074282512,377487360:16,394264576:1073741824,411041792:1074282496,427819008:1073741840,444596224:1073758224,461373440:524304,478150656:0,494927872:16400,511705088:1074266128,528482304:540672},{0:260,1048576:0,2097152:67109120,3145728:65796,4194304:65540,5242880:67108868,6291456:67174660,7340032:67174400,8388608:67108864,9437184:67174656,10485760:65792,11534336:67174404,12582912:67109124,13631488:65536,14680064:4,15728640:256,524288:67174656,1572864:67174404,2621440:0,3670016:67109120,4718592:67108868,5767168:65536,6815744:65540,7864320:260,8912896:4,9961472:256,11010048:67174400,12058624:65796,13107200:65792,14155776:67109124,15204352:67174660,16252928:67108864,16777216:67174656,17825792:65540,18874368:65536,19922944:67109120,20971520:256,22020096:67174660,23068672:67108868,24117248:0,25165824:67109124,26214400:67108864,27262976:4,28311552:65792,29360128:67174400,30408704:260,31457280:65796,32505856:67174404,17301504:67108864,18350080:260,19398656:67174656,20447232:0,21495808:65540,22544384:67109120,23592960:256,24641536:67174404,25690112:65536,26738688:67174660,27787264:65796,28835840:67108868,29884416:67109124,30932992:67174400,31981568:4,33030144:65792},{0:2151682048,65536:2147487808,131072:4198464,196608:2151677952,262144:0,327680:4198400,393216:2147483712,458752:4194368,524288:2147483648,589824:4194304,655360:64,720896:2147487744,786432:2151678016,851968:4160,917504:4096,983040:2151682112,32768:2147487808,98304:64,163840:2151678016,229376:2147487744,294912:4198400,360448:2151682112,425984:0,491520:2151677952,557056:4096,622592:2151682048,688128:4194304,753664:4160,819200:2147483648,884736:4194368,950272:4198464,1015808:2147483712,1048576:4194368,1114112:4198400,1179648:2147483712,1245184:0,1310720:4160,1376256:2151678016,1441792:2151682048,1507328:2147487808,1572864:2151682112,1638400:2147483648,1703936:2151677952,1769472:4198464,1835008:2147487744,1900544:4194304,1966080:64,2031616:4096,1081344:2151677952,1146880:2151682112,1212416:0,1277952:4198400,1343488:4194368,1409024:2147483648,1474560:2147487808,1540096:64,1605632:2147483712,1671168:4096,1736704:2147487744,1802240:2151678016,1867776:4160,1933312:2151682048,1998848:4194304,2064384:4198464},{0:128,4096:17039360,8192:262144,12288:536870912,16384:537133184,20480:16777344,24576:553648256,28672:262272,32768:16777216,36864:537133056,40960:536871040,45056:553910400,49152:553910272,53248:0,57344:17039488,61440:553648128,2048:17039488,6144:553648256,10240:128,14336:17039360,18432:262144,22528:537133184,26624:553910272,30720:536870912,34816:537133056,38912:0,43008:553910400,47104:16777344,51200:536871040,55296:553648128,59392:16777216,63488:262272,65536:262144,69632:128,73728:536870912,77824:553648256,81920:16777344,86016:553910272,90112:537133184,94208:16777216,98304:553910400,102400:553648128,106496:17039360,110592:537133056,114688:262272,118784:536871040,122880:0,126976:17039488,67584:553648256,71680:16777216,75776:17039360,79872:537133184,83968:536870912,88064:17039488,92160:128,96256:553910272,100352:262272,104448:553910400,108544:0,112640:553648128,116736:16777344,120832:262144,124928:537133056,129024:536871040},{0:268435464,256:8192,512:270532608,768:270540808,1024:268443648,1280:2097152,1536:2097160,1792:268435456,2048:0,2304:268443656,2560:2105344,2816:8,3072:270532616,3328:2105352,3584:8200,3840:270540800,128:270532608,384:270540808,640:8,896:2097152,1152:2105352,1408:268435464,1664:268443648,1920:8200,2176:2097160,2432:8192,2688:268443656,2944:270532616,3200:0,3456:270540800,3712:2105344,3968:268435456,4096:268443648,4352:270532616,4608:270540808,4864:8200,5120:2097152,5376:268435456,5632:268435464,5888:2105344,6144:2105352,6400:0,6656:8,6912:270532608,7168:8192,7424:268443656,7680:270540800,7936:2097160,4224:8,4480:2105344,4736:2097152,4992:268435464,5248:268443648,5504:8200,5760:270540808,6016:270532608,6272:270540800,6528:270532616,6784:8192,7040:2105352,7296:2097160,7552:0,7808:268435456,8064:268443656},{0:1048576,16:33555457,32:1024,48:1049601,64:34604033,80:0,96:1,112:34603009,128:33555456,144:1048577,160:33554433,176:34604032,192:34603008,208:1025,224:1049600,240:33554432,8:34603009,24:0,40:33555457,56:34604032,72:1048576,88:33554433,104:33554432,120:1025,136:1049601,152:33555456,168:34603008,184:1048577,200:1024,216:34604033,232:1,248:1049600,256:33554432,272:1048576,288:33555457,304:34603009,320:1048577,336:33555456,352:34604032,368:1049601,384:1025,400:34604033,416:1049600,432:1,448:0,464:34603008,480:33554433,496:1024,264:1049600,280:33555457,296:34603009,312:1,328:33554432,344:1048576,360:1025,376:34604032,392:33554433,408:34603008,424:0,440:34604033,456:1049601,472:1024,488:33555456,504:1048577},{0:134219808,1:131072,2:134217728,3:32,4:131104,5:134350880,6:134350848,7:2048,8:134348800,9:134219776,10:133120,11:134348832,12:2080,13:0,14:134217760,15:133152,2147483648:2048,2147483649:134350880,2147483650:134219808,2147483651:134217728,2147483652:134348800,2147483653:133120,2147483654:133152,2147483655:32,2147483656:134217760,2147483657:2080,2147483658:131104,2147483659:134350848,2147483660:0,2147483661:134348832,2147483662:134219776,2147483663:131072,16:133152,17:134350848,18:32,19:2048,20:134219776,21:134217760,22:134348832,23:131072,24:0,25:131104,26:134348800,27:134219808,28:134350880,29:133120,30:2080,31:134217728,2147483664:131072,2147483665:2048,2147483666:134348832,2147483667:133152,2147483668:32,2147483669:134348800,2147483670:134217728,2147483671:134219808,2147483672:134350880,2147483673:134217760,2147483674:134219776,2147483675:0,2147483676:133120,2147483677:2080,2147483678:131104,2147483679:134350848}],l=[4160749569,528482304,33030144,2064384,129024,8064,504,2147483679],d=i.DES=r.extend({_doReset:function(){for(var e=this._key.words,t=[],n=0;n<56;n++){var o=a[n]-1;t[n]=e[o>>>5]>>>31-o%32&1}for(var r=this._subKeys=[],i=0;i<16;i++){var c=r[i]=[],l=u[i];for(n=0;n<24;n++)c[n/6|0]|=t[(s[n]-1+l)%28]<<31-n%6,c[4+(n/6|0)]|=t[28+(s[n+24]-1+l)%28]<<31-n%6;for(c[0]=c[0]<<1|c[0]>>>31,n=1;n<7;n++)c[n]=c[n]>>>4*(n-1)+3;c[7]=c[7]<<5|c[7]>>>27}var d=this._invSubKeys=[];for(n=0;n<16;n++)d[n]=r[15-n]},encryptBlock:function(e,t){this._doCryptBlock(e,t,this._subKeys)},decryptBlock:function(e,t){this._doCryptBlock(e,t,this._invSubKeys)},_doCryptBlock:function(e,t,n){this._lBlock=e[t],this._rBlock=e[t+1],p.call(this,4,252645135),p.call(this,16,65535),f.call(this,2,858993459),f.call(this,8,16711935),p.call(this,1,1431655765);for(var o=0;o<16;o++){for(var r=n[o],i=this._lBlock,a=this._rBlock,s=0,u=0;u<8;u++)s|=c[u][((a^r[u])&l[u])>>>0];this._lBlock=a,this._rBlock=i^s}var d=this._lBlock;this._lBlock=this._rBlock,this._rBlock=d,p.call(this,1,1431655765),f.call(this,8,16711935),f.call(this,2,858993459),p.call(this,16,65535),p.call(this,4,252645135),e[t]=this._lBlock,e[t+1]=this._rBlock},keySize:2,ivSize:2,blockSize:2});function p(e,t){var n=(this._lBlock>>>e^this._rBlock)&t;this._rBlock^=n,this._lBlock^=n<<e}function f(e,t){var n=(this._rBlock>>>e^this._lBlock)&t;this._lBlock^=n,this._rBlock^=n<<e}e.DES=r._createHelper(d);var h=i.TripleDES=r.extend({_doReset:function(){var e=this._key.words;this._des1=d.createEncryptor(o.create(e.slice(0,2))),this._des2=d.createEncryptor(o.create(e.slice(2,4))),this._des3=d.createEncryptor(o.create(e.slice(4,6)))},encryptBlock:function(e,t){this._des1.encryptBlock(e,t),this._des2.decryptBlock(e,t),this._des3.encryptBlock(e,t)},decryptBlock:function(e,t){this._des3.decryptBlock(e,t),this._des2.encryptBlock(e,t),this._des1.decryptBlock(e,t)},keySize:6,ivSize:2,blockSize:2});e.TripleDES=r._createHelper(h)}(),n.TripleDES)})),ga((function(e,t){var n;e.exports=(n=va,function(){var e=n,t=e.lib.StreamCipher,o=e.algo,r=o.RC4=t.extend({_doReset:function(){for(var e=this._key,t=e.words,n=e.sigBytes,o=this._S=[],r=0;r<256;r++)o[r]=r;r=0;for(var i=0;r<256;r++){var a=r%n,s=t[a>>>2]>>>24-a%4*8&255;i=(i+o[r]+s)%256;var u=o[r];o[r]=o[i],o[i]=u}this._i=this._j=0},_doProcessBlock:function(e,t){e[t]^=i.call(this)},keySize:8,ivSize:0});function i(){for(var e=this._S,t=this._i,n=this._j,o=0,r=0;r<4;r++){n=(n+e[t=(t+1)%256])%256;var i=e[t];e[t]=e[n],e[n]=i,o|=e[(e[t]+e[n])%256]<<24-8*r}return this._i=t,this._j=n,o}e.RC4=t._createHelper(r);var a=o.RC4Drop=r.extend({cfg:r.cfg.extend({drop:192}),_doReset:function(){r._doReset.call(this);for(var e=this.cfg.drop;e>0;e--)i.call(this)}});e.RC4Drop=t._createHelper(a)}(),n.RC4)})),ga((function(e,t){var n;e.exports=(n=va,function(){var e=n,t=e.lib.StreamCipher,o=e.algo,r=[],i=[],a=[],s=o.Rabbit=t.extend({_doReset:function(){for(var e=this._key.words,t=this.cfg.iv,n=0;n<4;n++)e[n]=16711935&(e[n]<<8|e[n]>>>24)|4278255360&(e[n]<<24|e[n]>>>8);var o=this._X=[e[0],e[3]<<16|e[2]>>>16,e[1],e[0]<<16|e[3]>>>16,e[2],e[1]<<16|e[0]>>>16,e[3],e[2]<<16|e[1]>>>16],r=this._C=[e[2]<<16|e[2]>>>16,4294901760&e[0]|65535&e[1],e[3]<<16|e[3]>>>16,4294901760&e[1]|65535&e[2],e[0]<<16|e[0]>>>16,4294901760&e[2]|65535&e[3],e[1]<<16|e[1]>>>16,4294901760&e[3]|65535&e[0]];for(this._b=0,n=0;n<4;n++)u.call(this);for(n=0;n<8;n++)r[n]^=o[n+4&7];if(t){var i=t.words,a=i[0],s=i[1],c=16711935&(a<<8|a>>>24)|4278255360&(a<<24|a>>>8),l=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8),d=c>>>16|4294901760&l,p=l<<16|65535&c;for(r[0]^=c,r[1]^=d,r[2]^=l,r[3]^=p,r[4]^=c,r[5]^=d,r[6]^=l,r[7]^=p,n=0;n<4;n++)u.call(this)}},_doProcessBlock:function(e,t){var n=this._X;u.call(this),r[0]=n[0]^n[5]>>>16^n[3]<<16,r[1]=n[2]^n[7]>>>16^n[5]<<16,r[2]=n[4]^n[1]>>>16^n[7]<<16,r[3]=n[6]^n[3]>>>16^n[1]<<16;for(var o=0;o<4;o++)r[o]=16711935&(r[o]<<8|r[o]>>>24)|4278255360&(r[o]<<24|r[o]>>>8),e[t+o]^=r[o]},blockSize:4,ivSize:2});function u(){for(var e=this._X,t=this._C,n=0;n<8;n++)i[n]=t[n];for(t[0]=t[0]+1295307597+this._b|0,t[1]=t[1]+3545052371+(t[0]>>>0<i[0]>>>0?1:0)|0,t[2]=t[2]+886263092+(t[1]>>>0<i[1]>>>0?1:0)|0,t[3]=t[3]+1295307597+(t[2]>>>0<i[2]>>>0?1:0)|0,t[4]=t[4]+3545052371+(t[3]>>>0<i[3]>>>0?1:0)|0,t[5]=t[5]+886263092+(t[4]>>>0<i[4]>>>0?1:0)|0,t[6]=t[6]+1295307597+(t[5]>>>0<i[5]>>>0?1:0)|0,t[7]=t[7]+3545052371+(t[6]>>>0<i[6]>>>0?1:0)|0,this._b=t[7]>>>0<i[7]>>>0?1:0,n=0;n<8;n++){var o=e[n]+t[n],r=65535&o,s=o>>>16,u=((r*r>>>17)+r*s>>>15)+s*s,c=((4294901760&o)*o|0)+((65535&o)*o|0);a[n]=u^c}e[0]=a[0]+(a[7]<<16|a[7]>>>16)+(a[6]<<16|a[6]>>>16)|0,e[1]=a[1]+(a[0]<<8|a[0]>>>24)+a[7]|0,e[2]=a[2]+(a[1]<<16|a[1]>>>16)+(a[0]<<16|a[0]>>>16)|0,e[3]=a[3]+(a[2]<<8|a[2]>>>24)+a[1]|0,e[4]=a[4]+(a[3]<<16|a[3]>>>16)+(a[2]<<16|a[2]>>>16)|0,e[5]=a[5]+(a[4]<<8|a[4]>>>24)+a[3]|0,e[6]=a[6]+(a[5]<<16|a[5]>>>16)+(a[4]<<16|a[4]>>>16)|0,e[7]=a[7]+(a[6]<<8|a[6]>>>24)+a[5]|0}e.Rabbit=t._createHelper(s)}(),n.Rabbit)})),ga((function(e,t){var n;e.exports=(n=va,function(){var e=n,t=e.lib.StreamCipher,o=e.algo,r=[],i=[],a=[],s=o.RabbitLegacy=t.extend({_doReset:function(){var e=this._key.words,t=this.cfg.iv,n=this._X=[e[0],e[3]<<16|e[2]>>>16,e[1],e[0]<<16|e[3]>>>16,e[2],e[1]<<16|e[0]>>>16,e[3],e[2]<<16|e[1]>>>16],o=this._C=[e[2]<<16|e[2]>>>16,4294901760&e[0]|65535&e[1],e[3]<<16|e[3]>>>16,4294901760&e[1]|65535&e[2],e[0]<<16|e[0]>>>16,4294901760&e[2]|65535&e[3],e[1]<<16|e[1]>>>16,4294901760&e[3]|65535&e[0]];this._b=0;for(var r=0;r<4;r++)u.call(this);for(r=0;r<8;r++)o[r]^=n[r+4&7];if(t){var i=t.words,a=i[0],s=i[1],c=16711935&(a<<8|a>>>24)|4278255360&(a<<24|a>>>8),l=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8),d=c>>>16|4294901760&l,p=l<<16|65535&c;for(o[0]^=c,o[1]^=d,o[2]^=l,o[3]^=p,o[4]^=c,o[5]^=d,o[6]^=l,o[7]^=p,r=0;r<4;r++)u.call(this)}},_doProcessBlock:function(e,t){var n=this._X;u.call(this),r[0]=n[0]^n[5]>>>16^n[3]<<16,r[1]=n[2]^n[7]>>>16^n[5]<<16,r[2]=n[4]^n[1]>>>16^n[7]<<16,r[3]=n[6]^n[3]>>>16^n[1]<<16;for(var o=0;o<4;o++)r[o]=16711935&(r[o]<<8|r[o]>>>24)|4278255360&(r[o]<<24|r[o]>>>8),e[t+o]^=r[o]},blockSize:4,ivSize:2});function u(){for(var e=this._X,t=this._C,n=0;n<8;n++)i[n]=t[n];for(t[0]=t[0]+1295307597+this._b|0,t[1]=t[1]+3545052371+(t[0]>>>0<i[0]>>>0?1:0)|0,t[2]=t[2]+886263092+(t[1]>>>0<i[1]>>>0?1:0)|0,t[3]=t[3]+1295307597+(t[2]>>>0<i[2]>>>0?1:0)|0,t[4]=t[4]+3545052371+(t[3]>>>0<i[3]>>>0?1:0)|0,t[5]=t[5]+886263092+(t[4]>>>0<i[4]>>>0?1:0)|0,t[6]=t[6]+1295307597+(t[5]>>>0<i[5]>>>0?1:0)|0,t[7]=t[7]+3545052371+(t[6]>>>0<i[6]>>>0?1:0)|0,this._b=t[7]>>>0<i[7]>>>0?1:0,n=0;n<8;n++){var o=e[n]+t[n],r=65535&o,s=o>>>16,u=((r*r>>>17)+r*s>>>15)+s*s,c=((4294901760&o)*o|0)+((65535&o)*o|0);a[n]=u^c}e[0]=a[0]+(a[7]<<16|a[7]>>>16)+(a[6]<<16|a[6]>>>16)|0,e[1]=a[1]+(a[0]<<8|a[0]>>>24)+a[7]|0,e[2]=a[2]+(a[1]<<16|a[1]>>>16)+(a[0]<<16|a[0]>>>16)|0,e[3]=a[3]+(a[2]<<8|a[2]>>>24)+a[1]|0,e[4]=a[4]+(a[3]<<16|a[3]>>>16)+(a[2]<<16|a[2]>>>16)|0,e[5]=a[5]+(a[4]<<8|a[4]>>>24)+a[3]|0,e[6]=a[6]+(a[5]<<16|a[5]>>>16)+(a[4]<<16|a[4]>>>16)|0,e[7]=a[7]+(a[6]<<8|a[6]>>>24)+a[5]|0}e.RabbitLegacy=t._createHelper(s)}(),n.RabbitLegacy)})),ga((function(e,t){e.exports=va})));function _a(){throw new Error("setTimeout has not been defined")}function ya(){throw new Error("clearTimeout has not been defined")}var Ma=_a,Ia=ya;function Ca(e){if(Ma===setTimeout)return setTimeout(e,0);if((Ma===_a||!Ma)&&setTimeout)return Ma=setTimeout,setTimeout(e,0);try{return Ma(e,0)}catch(mi){try{return Ma.call(null,e,0)}catch(mi){return Ma.call(this,e,0)}}}"function"==typeof vi.setTimeout&&(Ma=setTimeout),"function"==typeof vi.clearTimeout&&(Ia=clearTimeout);var ka,Ta=[],Sa=!1,ba=-1;function Da(){Sa&&ka&&(Sa=!1,ka.length?Ta=ka.concat(Ta):ba=-1,Ta.length&&Ea())}function Ea(){if(!Sa){var e=Ca(Da);Sa=!0;for(var t=Ta.length;t;){for(ka=Ta,Ta=[];++ba<t;)ka&&ka[ba].run();ba=-1,t=Ta.length}ka=null,Sa=!1,function(e){if(Ia===clearTimeout)return clearTimeout(e);if((Ia===ya||!Ia)&&clearTimeout)return Ia=clearTimeout,clearTimeout(e);try{Ia(e)}catch(t){try{return Ia.call(null,e)}catch(t){return Ia.call(this,e)}}}(e)}}function Aa(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];Ta.push(new La(e,t)),1!==Ta.length||Sa||Ca(Ea)}function La(e,t){this.fun=e,this.array=t}La.prototype.run=function(){this.fun.apply(null,this.array)};var Ra=vi.performance||{};function wa(){}function Oa(){Oa.init.call(this)}function Na(e){return void 0===e._maxListeners?Oa.defaultMaxListeners:e._maxListeners}function Pa(e,t,n,o){var r,i,a,s;if("function"!=typeof n)throw new TypeError('"listener" argument must be a function');if((i=e._events)?(i.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),i=e._events),a=i[t]):(i=e._events=new wa,e._eventsCount=0),a){if("function"==typeof a?a=i[t]=o?[n,a]:[a,n]:o?a.unshift(n):a.push(n),!a.warned&&(r=Na(e))&&r>0&&a.length>r){a.warned=!0;var u=new Error("Possible EventEmitter memory leak detected. "+a.length+" "+t+" listeners added. Use emitter.setMaxListeners() to increase limit");u.name="MaxListenersExceededWarning",u.emitter=e,u.type=t,u.count=a.length,s=u,"function"==typeof console.warn?console.warn(s):console.log(s)}}else a=i[t]=n,++e._eventsCount;return e}function Ga(e,t,n){var o=!1;function r(){e.removeListener(t,r),o||(o=!0,n.apply(e,arguments))}return r.listener=n,r}function Ua(e){var t=this._events;if(t){var n=t[e];if("function"==typeof n)return 1;if(n)return n.length}return 0}function xa(e,t){for(var n=new Array(t);t--;)n[t]=e[t];return n}Ra.now||Ra.mozNow||Ra.msNow||Ra.oNow||Ra.webkitNow,wa.prototype=Object.create(null),Oa.EventEmitter=Oa,Oa.usingDomains=!1,Oa.prototype.domain=void 0,Oa.prototype._events=void 0,Oa.prototype._maxListeners=void 0,Oa.defaultMaxListeners=10,Oa.init=function(){this.domain=null,Oa.usingDomains&&(void 0).active&&(void 0).Domain,this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=new wa,this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},Oa.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||isNaN(e))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=e,this},Oa.prototype.getMaxListeners=function(){return Na(this)},Oa.prototype.emit=function(e){var t,n,o,r,i,a,s,u="error"===e;if(a=this._events)u=u&&null==a.error;else if(!u)return!1;if(s=this.domain,u){if(t=arguments[1],!s){if(t instanceof Error)throw t;var c=new Error('Uncaught, unspecified "error" event. ('+t+")");throw c.context=t,c}return t||(t=new Error('Uncaught, unspecified "error" event')),t.domainEmitter=this,t.domain=s,t.domainThrown=!1,s.emit("error",t),!1}if(!(n=a[e]))return!1;var l="function"==typeof n;switch(o=arguments.length){case 1:!function(e,t,n){if(t)e.call(n);else for(var o=e.length,r=xa(e,o),i=0;i<o;++i)r[i].call(n)}(n,l,this);break;case 2:!function(e,t,n,o){if(t)e.call(n,o);else for(var r=e.length,i=xa(e,r),a=0;a<r;++a)i[a].call(n,o)}(n,l,this,arguments[1]);break;case 3:!function(e,t,n,o,r){if(t)e.call(n,o,r);else for(var i=e.length,a=xa(e,i),s=0;s<i;++s)a[s].call(n,o,r)}(n,l,this,arguments[1],arguments[2]);break;case 4:!function(e,t,n,o,r,i){if(t)e.call(n,o,r,i);else for(var a=e.length,s=xa(e,a),u=0;u<a;++u)s[u].call(n,o,r,i)}(n,l,this,arguments[1],arguments[2],arguments[3]);break;default:for(r=new Array(o-1),i=1;i<o;i++)r[i-1]=arguments[i];!function(e,t,n,o){if(t)e.apply(n,o);else for(var r=e.length,i=xa(e,r),a=0;a<r;++a)i[a].apply(n,o)}(n,l,this,r)}return!0},Oa.prototype.addListener=function(e,t){return Pa(this,e,t,!1)},Oa.prototype.on=Oa.prototype.addListener,Oa.prototype.prependListener=function(e,t){return Pa(this,e,t,!0)},Oa.prototype.once=function(e,t){if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');return this.on(e,Ga(this,e,t)),this},Oa.prototype.prependOnceListener=function(e,t){if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');return this.prependListener(e,Ga(this,e,t)),this},Oa.prototype.removeListener=function(e,t){var n,o,r,i,a;if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');if(!(o=this._events))return this;if(!(n=o[e]))return this;if(n===t||n.listener&&n.listener===t)0==--this._eventsCount?this._events=new wa:(delete o[e],o.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!=typeof n){for(r=-1,i=n.length;i-- >0;)if(n[i]===t||n[i].listener&&n[i].listener===t){a=n[i].listener,r=i;break}if(r<0)return this;if(1===n.length){if(n[0]=void 0,0==--this._eventsCount)return this._events=new wa,this;delete o[e]}else!function(e,t){for(var n=t,o=n+1,r=e.length;o<r;n+=1,o+=1)e[n]=e[o];e.pop()}(n,r);o.removeListener&&this.emit("removeListener",e,a||t)}return this},Oa.prototype.removeAllListeners=function(e){var t,n;if(!(n=this._events))return this;if(!n.removeListener)return 0===arguments.length?(this._events=new wa,this._eventsCount=0):n[e]&&(0==--this._eventsCount?this._events=new wa:delete n[e]),this;if(0===arguments.length){for(var o,r=Object.keys(n),i=0;i<r.length;++i)"removeListener"!==(o=r[i])&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=new wa,this._eventsCount=0,this}if("function"==typeof(t=n[e]))this.removeListener(e,t);else if(t)do{this.removeListener(e,t[t.length-1])}while(t[0]);return this},Oa.prototype.listeners=function(e){var t,n=this._events;return n&&(t=n[e])?"function"==typeof t?[t.listener||t]:function(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}(t):[]},Oa.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):Ua.call(e,t)},Oa.prototype.listenerCount=Ua,Oa.prototype.eventNames=function(){return this._eventsCount>0?Reflect.ownKeys(this._events):[]};var Fa="function"==typeof Object.create?function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:function(e,t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e},qa=/%[sdj%]/g;function Ba(e){if(!Qa(e)){for(var t=[],n=0;n<arguments.length;n++)t.push(ja(arguments[n]));return t.join(" ")}n=1;for(var o=arguments,r=o.length,i=String(e).replace(qa,(function(e){if("%%"===e)return"%";if(n>=r)return e;switch(e){case"%s":return String(o[n++]);case"%d":return Number(o[n++]);case"%j":try{return JSON.stringify(o[n++])}catch(e){return"[Circular]"}default:return e}})),a=o[n];n<r;a=o[++n])$a(a)||!ns(a)?i+=" "+a:i+=" "+ja(a);return i}function Va(e,t){if(es(vi.process))return function(){return Va(e,t).apply(this,arguments)};var n=!1;return function(){return n||(console.error(t),n=!0),e.apply(this,arguments)}}var Ha,Ka={};function ja(e,t){var n={seen:[],stylize:Za};return arguments.length>=3&&(n.depth=arguments[2]),arguments.length>=4&&(n.colors=arguments[3]),Xa(t)?n.showHidden=t:t&&function(e,t){if(!t||!ns(t))return e;for(var n=Object.keys(t),o=n.length;o--;)e[n[o]]=t[n[o]]}(n,t),es(n.showHidden)&&(n.showHidden=!1),es(n.depth)&&(n.depth=2),es(n.colors)&&(n.colors=!1),es(n.customInspect)&&(n.customInspect=!0),n.colors&&(n.stylize=za),Wa(n,e,n.depth)}function za(e,t){var n=ja.styles[t];return n?"\x1b["+ja.colors[n][0]+"m"+e+"\x1b["+ja.colors[n][1]+"m":e}function Za(e,t){return e}function Wa(e,t,n){if(e.customInspect&&t&&is(t.inspect)&&t.inspect!==ja&&(!t.constructor||t.constructor.prototype!==t)){var o=t.inspect(n,e);return Qa(o)||(o=Wa(e,o,n)),o}var r=function(e,t){if(es(t))return e.stylize("undefined","undefined");if(Qa(t)){var n="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(n,"string")}return"number"==typeof t?e.stylize(""+t,"number"):Xa(t)?e.stylize(""+t,"boolean"):$a(t)?e.stylize("null","null"):void 0}(e,t);if(r)return r;var i=Object.keys(t),a=function(e){var t={};return e.forEach((function(e,n){t[e]=!0})),t}(i);if(e.showHidden&&(i=Object.getOwnPropertyNames(t)),rs(t)&&(i.indexOf("message")>=0||i.indexOf("description")>=0))return Ya(t);if(0===i.length){if(is(t)){var s=t.name?": "+t.name:"";return e.stylize("[Function"+s+"]","special")}if(ts(t))return e.stylize(RegExp.prototype.toString.call(t),"regexp");if(os(t))return e.stylize(Date.prototype.toString.call(t),"date");if(rs(t))return Ya(t)}var u,c,l="",d=!1,p=["{","}"];return u=t,Array.isArray(u)&&(d=!0,p=["[","]"]),is(t)&&(l=" [Function"+(t.name?": "+t.name:"")+"]"),ts(t)&&(l=" "+RegExp.prototype.toString.call(t)),os(t)&&(l=" "+Date.prototype.toUTCString.call(t)),rs(t)&&(l=" "+Ya(t)),0!==i.length||d&&0!=t.length?n<0?ts(t)?e.stylize(RegExp.prototype.toString.call(t),"regexp"):e.stylize("[Object]","special"):(e.seen.push(t),c=d?function(e,t,n,o,r){for(var i=[],a=0,s=t.length;a<s;++a)ss(t,String(a))?i.push(Ja(e,t,n,o,String(a),!0)):i.push("");return r.forEach((function(r){r.match(/^\d+$/)||i.push(Ja(e,t,n,o,r,!0))})),i}(e,t,n,a,i):i.map((function(o){return Ja(e,t,n,a,o,d)})),e.seen.pop(),function(e,t,n){return e.reduce((function(e,t){return t.indexOf("\n"),e+t.replace(/\u001b\[\d\d?m/g,"").length+1}),0)>60?n[0]+(""===t?"":t+"\n ")+" "+e.join(",\n  ")+" "+n[1]:n[0]+t+" "+e.join(", ")+" "+n[1]}(c,l,p)):p[0]+l+p[1]}function Ya(e){return"["+Error.prototype.toString.call(e)+"]"}function Ja(e,t,n,o,r,i){var a,s,u;if((u=Object.getOwnPropertyDescriptor(t,r)||{value:t[r]}).get?s=u.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):u.set&&(s=e.stylize("[Setter]","special")),ss(o,r)||(a="["+r+"]"),s||(e.seen.indexOf(u.value)<0?(s=$a(n)?Wa(e,u.value,null):Wa(e,u.value,n-1)).indexOf("\n")>-1&&(s=i?s.split("\n").map((function(e){return"  "+e})).join("\n").substr(2):"\n"+s.split("\n").map((function(e){return"   "+e})).join("\n")):s=e.stylize("[Circular]","special")),es(a)){if(i&&r.match(/^\d+$/))return s;(a=JSON.stringify(""+r)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(a=a.substr(1,a.length-2),a=e.stylize(a,"name")):(a=a.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),a=e.stylize(a,"string"))}return a+": "+s}function Xa(e){return"boolean"==typeof e}function $a(e){return null===e}function Qa(e){return"string"==typeof e}function es(e){return void 0===e}function ts(e){return ns(e)&&"[object RegExp]"===as(e)}function ns(e){return"object"==typeof e&&null!==e}function os(e){return ns(e)&&"[object Date]"===as(e)}function rs(e){return ns(e)&&("[object Error]"===as(e)||e instanceof Error)}function is(e){return"function"==typeof e}function as(e){return Object.prototype.toString.call(e)}function ss(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function us(){this.head=null,this.tail=null,this.length=0}ja.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},ja.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},us.prototype.push=function(e){var t={data:e,next:null};this.length>0?this.tail.next=t:this.head=t,this.tail=t,++this.length},us.prototype.unshift=function(e){var t={data:e,next:this.head};0===this.length&&(this.tail=t),this.head=t,++this.length},us.prototype.shift=function(){if(0!==this.length){var e=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,e}},us.prototype.clear=function(){this.head=this.tail=null,this.length=0},us.prototype.join=function(e){if(0===this.length)return"";for(var t=this.head,n=""+t.data;t=t.next;)n+=e+t.data;return n},us.prototype.concat=function(e){if(0===this.length)return Li.alloc(0);if(1===this.length)return this.head.data;for(var t=Li.allocUnsafe(e>>>0),n=this.head,o=0;n;)n.data.copy(t,o),o+=n.data.length,n=n.next;return t};var cs=Li.isEncoding||function(e){switch(e&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function ls(e){switch(this.encoding=(e||"utf8").toLowerCase().replace(/[-_]/,""),function(e){if(e&&!cs(e))throw new Error("Unknown encoding: "+e)}(e),this.encoding){case"utf8":this.surrogateSize=3;break;case"ucs2":case"utf16le":this.surrogateSize=2,this.detectIncompleteChar=ps;break;case"base64":this.surrogateSize=3,this.detectIncompleteChar=fs;break;default:return void(this.write=ds)}this.charBuffer=new Li(6),this.charReceived=0,this.charLength=0}function ds(e){return e.toString(this.encoding)}function ps(e){this.charReceived=e.length%2,this.charLength=this.charReceived?2:0}function fs(e){this.charReceived=e.length%3,this.charLength=this.charReceived?3:0}ls.prototype.write=function(e){for(var t="";this.charLength;){var n=e.length>=this.charLength-this.charReceived?this.charLength-this.charReceived:e.length;if(e.copy(this.charBuffer,this.charReceived,0,n),this.charReceived+=n,this.charReceived<this.charLength)return"";if(e=e.slice(n,e.length),!((o=(t=this.charBuffer.slice(0,this.charLength).toString(this.encoding)).charCodeAt(t.length-1))>=55296&&o<=56319)){if(this.charReceived=this.charLength=0,0===e.length)return t;break}this.charLength+=this.surrogateSize,t=""}this.detectIncompleteChar(e);var o,r=e.length;if(this.charLength&&(e.copy(this.charBuffer,0,e.length-this.charReceived,r),r-=this.charReceived),r=(t+=e.toString(this.encoding,0,r)).length-1,(o=t.charCodeAt(r))>=55296&&o<=56319){var i=this.surrogateSize;return this.charLength+=i,this.charReceived+=i,this.charBuffer.copy(this.charBuffer,i,0,i),e.copy(this.charBuffer,0,0,i),t.substring(0,r)}return t},ls.prototype.detectIncompleteChar=function(e){for(var t=e.length>=3?3:e.length;t>0;t--){var n=e[e.length-t];if(1==t&&n>>5==6){this.charLength=2;break}if(t<=2&&n>>4==14){this.charLength=3;break}if(t<=3&&n>>3==30){this.charLength=4;break}}this.charReceived=t},ls.prototype.end=function(e){var t="";if(e&&e.length&&(t=this.write(e)),this.charReceived){var n=this.charReceived,o=this.charBuffer,r=this.encoding;t+=o.slice(0,n).toString(r)}return t},vs.ReadableState=gs;var hs=function(e){return es(Ha)&&(Ha=""),e=e.toUpperCase(),Ka[e]||(new RegExp("\\b"+e+"\\b","i").test(Ha)?Ka[e]=function(){var t=Ba.apply(null,arguments);console.error("%s %d: %s",e,0,t)}:Ka[e]=function(){}),Ka[e]}("stream");function gs(e,t){e=e||{},this.objectMode=!!e.objectMode,t instanceof Ks&&(this.objectMode=this.objectMode||!!e.readableObjectMode);var n=e.highWaterMark,o=this.objectMode?16:16384;this.highWaterMark=n||0===n?n:o,this.highWaterMark=~~this.highWaterMark,this.buffer=new us,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.defaultEncoding=e.defaultEncoding||"utf8",this.ranOut=!1,this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,e.encoding&&(this.decoder=new ls(e.encoding),this.encoding=e.encoding)}function vs(e){if(!(this instanceof vs))return new vs(e);this._readableState=new gs(e,this),this.readable=!0,e&&"function"==typeof e.read&&(this._read=e.read),Oa.call(this)}function ms(e,t,n,o,r){var i=function(e,t){var n=null;return fa(t)||"string"==typeof t||null==t||e.objectMode||(n=new TypeError("Invalid non-string/buffer chunk")),n}(t,n);if(i)e.emit("error",i);else if(null===n)t.reading=!1,function(e,t){if(!t.ended){if(t.decoder){var n=t.decoder.end();n&&n.length&&(t.buffer.push(n),t.length+=t.objectMode?1:n.length)}t.ended=!0,Ms(e)}}(e,t);else if(t.objectMode||n&&n.length>0)if(t.ended&&!r){var a=new Error("stream.push() after EOF");e.emit("error",a)}else if(t.endEmitted&&r){var s=new Error("stream.unshift() after end event");e.emit("error",s)}else{var u;!t.decoder||r||o||(n=t.decoder.write(n),u=!t.objectMode&&0===n.length),r||(t.reading=!1),u||(t.flowing&&0===t.length&&!t.sync?(e.emit("data",n),e.read(0)):(t.length+=t.objectMode?1:n.length,r?t.buffer.unshift(n):t.buffer.push(n),t.needReadable&&Ms(e))),function(e,t){t.readingMore||(t.readingMore=!0,Aa(Cs,e,t))}(e,t)}else r||(t.reading=!1);return function(e){return!e.ended&&(e.needReadable||e.length<e.highWaterMark||0===e.length)}(t)}Fa(vs,Oa),vs.prototype.push=function(e,t){var n=this._readableState;return n.objectMode||"string"!=typeof e||(t=t||n.defaultEncoding)!==n.encoding&&(e=Li.from(e,t),t=""),ms(this,n,e,t,!1)},vs.prototype.unshift=function(e){return ms(this,this._readableState,e,"",!0)},vs.prototype.isPaused=function(){return!1===this._readableState.flowing},vs.prototype.setEncoding=function(e){return this._readableState.decoder=new ls(e),this._readableState.encoding=e,this};var _s=8388608;function ys(e,t){return e<=0||0===t.length&&t.ended?0:t.objectMode?1:e!=e?t.flowing&&t.length?t.buffer.head.data.length:t.length:(e>t.highWaterMark&&(t.highWaterMark=function(e){return e>=_s?e=_s:(e--,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e++),e}(e)),e<=t.length?e:t.ended?t.length:(t.needReadable=!0,0))}function Ms(e){var t=e._readableState;t.needReadable=!1,t.emittedReadable||(hs("emitReadable",t.flowing),t.emittedReadable=!0,t.sync?Aa(Is,e):Is(e))}function Is(e){hs("emit readable"),e.emit("readable"),Ss(e)}function Cs(e,t){for(var n=t.length;!t.reading&&!t.flowing&&!t.ended&&t.length<t.highWaterMark&&(hs("maybeReadMore read 0"),e.read(0),n!==t.length);)n=t.length;t.readingMore=!1}function ks(e){hs("readable nexttick read 0"),e.read(0)}function Ts(e,t){t.reading||(hs("resume read 0"),e.read(0)),t.resumeScheduled=!1,t.awaitDrain=0,e.emit("resume"),Ss(e),t.flowing&&!t.reading&&e.read(0)}function Ss(e){var t=e._readableState;for(hs("flow",t.flowing);t.flowing&&null!==e.read(););}function bs(e,t){return 0===t.length?null:(t.objectMode?n=t.buffer.shift():!e||e>=t.length?(n=t.decoder?t.buffer.join(""):1===t.buffer.length?t.buffer.head.data:t.buffer.concat(t.length),t.buffer.clear()):n=function(e,t,n){var o;return e<t.head.data.length?(o=t.head.data.slice(0,e),t.head.data=t.head.data.slice(e)):o=e===t.head.data.length?t.shift():n?function(e,t){var n=t.head,o=1,r=n.data;for(e-=r.length;n=n.next;){var i=n.data,a=e>i.length?i.length:e;if(a===i.length?r+=i:r+=i.slice(0,e),0===(e-=a)){a===i.length?(++o,n.next?t.head=n.next:t.head=t.tail=null):(t.head=n,n.data=i.slice(a));break}++o}return t.length-=o,r}(e,t):function(e,t){var n=Li.allocUnsafe(e),o=t.head,r=1;for(o.data.copy(n),e-=o.data.length;o=o.next;){var i=o.data,a=e>i.length?i.length:e;if(i.copy(n,n.length-e,0,a),0===(e-=a)){a===i.length?(++r,o.next?t.head=o.next:t.head=t.tail=null):(t.head=o,o.data=i.slice(a));break}++r}return t.length-=r,n}(e,t),o}(e,t.buffer,t.decoder),n);var n}function Ds(e){var t=e._readableState;if(t.length>0)throw new Error('"endReadable()" called on non-empty stream');t.endEmitted||(t.ended=!0,Aa(Es,t,e))}function Es(e,t){e.endEmitted||0!==e.length||(e.endEmitted=!0,t.readable=!1,t.emit("end"))}function As(e,t){for(var n=0,o=e.length;n<o;n++)if(e[n]===t)return n;return-1}function Ls(){}function Rs(e,t,n){this.chunk=e,this.encoding=t,this.callback=n,this.next=null}function ws(e,t){Object.defineProperty(this,"buffer",{get:Va((function(){return this.getBuffer()}),"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.")}),e=e||{},this.objectMode=!!e.objectMode,t instanceof Ks&&(this.objectMode=this.objectMode||!!e.writableObjectMode);var n=e.highWaterMark,o=this.objectMode?16:16384;this.highWaterMark=n||0===n?n:o,this.highWaterMark=~~this.highWaterMark,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1;var r=!1===e.decodeStrings;this.decodeStrings=!r,this.defaultEncoding=e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){!function(e,t){var n=e._writableState,o=n.sync,r=n.writecb;if(function(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0}(n),t)!function(e,t,n,o,r){--t.pendingcb,n?Aa(r,o):r(o),e._writableState.errorEmitted=!0,e.emit("error",o)}(e,n,o,t,r);else{var i=Us(n);i||n.corked||n.bufferProcessing||!n.bufferedRequest||Gs(e,n),o?Aa(Ps,e,n,i,r):Ps(e,n,i,r)}}(t,e)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new qs(this)}function Os(e){if(!(this instanceof Os||this instanceof Ks))return new Os(e);this._writableState=new ws(e,this),this.writable=!0,e&&("function"==typeof e.write&&(this._write=e.write),"function"==typeof e.writev&&(this._writev=e.writev)),Oa.call(this)}function Ns(e,t,n,o,r,i,a){t.writelen=o,t.writecb=a,t.writing=!0,t.sync=!0,n?e._writev(r,t.onwrite):e._write(r,i,t.onwrite),t.sync=!1}function Ps(e,t,n,o){n||function(e,t){0===t.length&&t.needDrain&&(t.needDrain=!1,e.emit("drain"))}(e,t),t.pendingcb--,o(),Fs(e,t)}function Gs(e,t){t.bufferProcessing=!0;var n=t.bufferedRequest;if(e._writev&&n&&n.next){var o=t.bufferedRequestCount,r=new Array(o),i=t.corkedRequestsFree;i.entry=n;for(var a=0;n;)r[a]=n,n=n.next,a+=1;Ns(e,t,!0,t.length,r,"",i.finish),t.pendingcb++,t.lastBufferedRequest=null,i.next?(t.corkedRequestsFree=i.next,i.next=null):t.corkedRequestsFree=new qs(t)}else{for(;n;){var s=n.chunk,u=n.encoding,c=n.callback;if(Ns(e,t,!1,t.objectMode?1:s.length,s,u,c),n=n.next,t.writing)break}null===n&&(t.lastBufferedRequest=null)}t.bufferedRequestCount=0,t.bufferedRequest=n,t.bufferProcessing=!1}function Us(e){return e.ending&&0===e.length&&null===e.bufferedRequest&&!e.finished&&!e.writing}function xs(e,t){t.prefinished||(t.prefinished=!0,e.emit("prefinish"))}function Fs(e,t){var n=Us(t);return n&&(0===t.pendingcb?(xs(e,t),t.finished=!0,e.emit("finish")):xs(e,t)),n}function qs(e){var t=this;this.next=null,this.entry=null,this.finish=function(n){var o=t.entry;for(t.entry=null;o;){var r=o.callback;e.pendingcb--,r(n),o=o.next}e.corkedRequestsFree?e.corkedRequestsFree.next=t:e.corkedRequestsFree=t}}vs.prototype.read=function(e){hs("read",e),e=parseInt(e,10);var t=this._readableState,n=e;if(0!==e&&(t.emittedReadable=!1),0===e&&t.needReadable&&(t.length>=t.highWaterMark||t.ended))return hs("read: emitReadable",t.length,t.ended),0===t.length&&t.ended?Ds(this):Ms(this),null;if(0===(e=ys(e,t))&&t.ended)return 0===t.length&&Ds(this),null;var o,r=t.needReadable;return hs("need readable",r),(0===t.length||t.length-e<t.highWaterMark)&&hs("length less than watermark",r=!0),t.ended||t.reading?hs("reading or ended",r=!1):r&&(hs("do read"),t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1,t.reading||(e=ys(n,t))),null===(o=e>0?bs(e,t):null)?(t.needReadable=!0,e=0):t.length-=e,0===t.length&&(t.ended||(t.needReadable=!0),n!==e&&t.ended&&Ds(this)),null!==o&&this.emit("data",o),o},vs.prototype._read=function(e){this.emit("error",new Error("not implemented"))},vs.prototype.pipe=function(e,t){var n=this,o=this._readableState;switch(o.pipesCount){case 0:o.pipes=e;break;case 1:o.pipes=[o.pipes,e];break;default:o.pipes.push(e)}o.pipesCount+=1,hs("pipe count=%d opts=%j",o.pipesCount,t);var r=t&&!1===t.end?c:a;function i(e){hs("onunpipe"),e===n&&c()}function a(){hs("onend"),e.end()}o.endEmitted?Aa(r):n.once("end",r),e.on("unpipe",i);var s=function(e){return function(){var t=e._readableState;hs("pipeOnDrain",t.awaitDrain),t.awaitDrain&&t.awaitDrain--,0===t.awaitDrain&&e.listeners("data").length&&(t.flowing=!0,Ss(e))}}(n);e.on("drain",s);var u=!1;function c(){hs("cleanup"),e.removeListener("close",f),e.removeListener("finish",h),e.removeListener("drain",s),e.removeListener("error",p),e.removeListener("unpipe",i),n.removeListener("end",a),n.removeListener("end",c),n.removeListener("data",d),u=!0,!o.awaitDrain||e._writableState&&!e._writableState.needDrain||s()}var l=!1;function d(t){hs("ondata"),l=!1,!1!==e.write(t)||l||((1===o.pipesCount&&o.pipes===e||o.pipesCount>1&&-1!==As(o.pipes,e))&&!u&&(hs("false write response, pause",n._readableState.awaitDrain),n._readableState.awaitDrain++,l=!0),n.pause())}function p(t){hs("onerror",t),g(),e.removeListener("error",p),0===("error",e.listeners("error").length)&&e.emit("error",t)}function f(){e.removeListener("finish",h),g()}function h(){hs("onfinish"),e.removeListener("close",f),g()}function g(){hs("unpipe"),n.unpipe(e)}return n.on("data",d),function(e,t,n){if("function"==typeof e.prependListener)return e.prependListener(t,n);e._events&&e._events[t]?Array.isArray(e._events[t])?e._events[t].unshift(n):e._events[t]=[n,e._events[t]]:e.on(t,n)}(e,"error",p),e.once("close",f),e.once("finish",h),e.emit("pipe",n),o.flowing||(hs("pipe resume"),n.resume()),e},vs.prototype.unpipe=function(e){var t=this._readableState;if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes||(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,t.flowing=!1,e&&e.emit("unpipe",this)),this;if(!e){var n=t.pipes,o=t.pipesCount;t.pipes=null,t.pipesCount=0,t.flowing=!1;for(var r=0;r<o;r++)n[r].emit("unpipe",this);return this}var i=As(t.pipes,e);return-1===i||(t.pipes.splice(i,1),t.pipesCount-=1,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this)),this},vs.prototype.on=function(e,t){var n=Oa.prototype.on.call(this,e,t);if("data"===e)!1!==this._readableState.flowing&&this.resume();else if("readable"===e){var o=this._readableState;o.endEmitted||o.readableListening||(o.readableListening=o.needReadable=!0,o.emittedReadable=!1,o.reading?o.length&&Ms(this):Aa(ks,this))}return n},vs.prototype.addListener=vs.prototype.on,vs.prototype.resume=function(){var e=this._readableState;return e.flowing||(hs("resume"),e.flowing=!0,function(e,t){t.resumeScheduled||(t.resumeScheduled=!0,Aa(Ts,e,t))}(this,e)),this},vs.prototype.pause=function(){return hs("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(hs("pause"),this._readableState.flowing=!1,this.emit("pause")),this},vs.prototype.wrap=function(e){var t=this._readableState,n=!1,o=this;for(var r in e.on("end",(function(){if(hs("wrapped end"),t.decoder&&!t.ended){var e=t.decoder.end();e&&e.length&&o.push(e)}o.push(null)})),e.on("data",(function(r){hs("wrapped data"),t.decoder&&(r=t.decoder.write(r)),t.objectMode&&null==r||(t.objectMode||r&&r.length)&&(o.push(r)||(n=!0,e.pause()))})),e)void 0===this[r]&&"function"==typeof e[r]&&(this[r]=function(t){return function(){return e[t].apply(e,arguments)}}(r));return function(e,t){for(var n=0,o=e.length;n<o;n++)t(e[n])}(["error","close","destroy","pause","resume"],(function(t){e.on(t,o.emit.bind(o,t))})),o._read=function(t){hs("wrapped _read",t),n&&(n=!1,e.resume())},o},vs._fromList=bs,Os.WritableState=ws,Fa(Os,Oa),ws.prototype.getBuffer=function(){for(var e=this.bufferedRequest,t=[];e;)t.push(e),e=e.next;return t},Os.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))},Os.prototype.write=function(e,t,n){var o=this._writableState,r=!1;return"function"==typeof t&&(n=t,t=null),Li.isBuffer(e)?t="buffer":t||(t=o.defaultEncoding),"function"!=typeof n&&(n=Ls),o.ended?function(e,t){var n=new Error("write after end");e.emit("error",n),Aa(t,n)}(this,n):function(e,t,n,o){var r=!0,i=!1;return null===n?i=new TypeError("May not write null values to stream"):Li.isBuffer(n)||"string"==typeof n||void 0===n||t.objectMode||(i=new TypeError("Invalid non-string/buffer chunk")),i&&(e.emit("error",i),Aa(o,i),r=!1),r}(this,o,e,n)&&(o.pendingcb++,r=function(e,t,n,o,r){n=function(e,t,n){return e.objectMode||!1===e.decodeStrings||"string"!=typeof t||(t=Li.from(t,n)),t}(t,n,o),Li.isBuffer(n)&&(o="buffer");var i=t.objectMode?1:n.length;t.length+=i;var a=t.length<t.highWaterMark;if(a||(t.needDrain=!0),t.writing||t.corked){var s=t.lastBufferedRequest;t.lastBufferedRequest=new Rs(n,o,r),s?s.next=t.lastBufferedRequest:t.bufferedRequest=t.lastBufferedRequest,t.bufferedRequestCount+=1}else Ns(e,t,!1,i,n,o,r);return a}(this,o,e,t,n)),r},Os.prototype.cork=function(){this._writableState.corked++},Os.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,e.writing||e.corked||e.finished||e.bufferProcessing||!e.bufferedRequest||Gs(this,e))},Os.prototype.setDefaultEncoding=function(e){if("string"==typeof e&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+e);return this._writableState.defaultEncoding=e,this},Os.prototype._write=function(e,t,n){n(new Error("not implemented"))},Os.prototype._writev=null,Os.prototype.end=function(e,t,n){var o=this._writableState;"function"==typeof e?(n=e,e=null,t=null):"function"==typeof t&&(n=t,t=null),null!=e&&this.write(e,t),o.corked&&(o.corked=1,this.uncork()),o.ending||o.finished||function(e,t,n){t.ending=!0,Fs(e,t),n&&(t.finished?Aa(n):e.once("finish",n)),t.ended=!0,e.writable=!1}(this,o,n)},Fa(Ks,vs);for(var Bs=Object.keys(Os.prototype),Vs=0;Vs<Bs.length;Vs++){var Hs=Bs[Vs];Ks.prototype[Hs]||(Ks.prototype[Hs]=Os.prototype[Hs])}function Ks(e){if(!(this instanceof Ks))return new Ks(e);vs.call(this,e),Os.call(this,e),e&&!1===e.readable&&(this.readable=!1),e&&!1===e.writable&&(this.writable=!1),this.allowHalfOpen=!0,e&&!1===e.allowHalfOpen&&(this.allowHalfOpen=!1),this.once("end",js)}function js(){this.allowHalfOpen||this._writableState.ended||Aa(zs,this)}function zs(e){e.end()}function Zs(e){this.afterTransform=function(t,n){return function(e,t,n){var o=e._transformState;o.transforming=!1;var r=o.writecb;if(!r)return e.emit("error",new Error("no writecb in Transform class"));o.writechunk=null,o.writecb=null,null!=n&&e.push(n),r(t);var i=e._readableState;i.reading=!1,(i.needReadable||i.length<i.highWaterMark)&&e._read(i.highWaterMark)}(e,t,n)},this.needTransform=!1,this.transforming=!1,this.writecb=null,this.writechunk=null,this.writeencoding=null}function Ws(e){if(!(this instanceof Ws))return new Ws(e);Ks.call(this,e),this._transformState=new Zs(this);var t=this;this._readableState.needReadable=!0,this._readableState.sync=!1,e&&("function"==typeof e.transform&&(this._transform=e.transform),"function"==typeof e.flush&&(this._flush=e.flush)),this.once("prefinish",(function(){"function"==typeof this._flush?this._flush((function(e){Ys(t,e)})):Ys(t)}))}function Ys(e,t){if(t)return e.emit("error",t);var n=e._writableState,o=e._transformState;if(n.length)throw new Error("Calling transform done when ws.length != 0");if(o.transforming)throw new Error("Calling transform done when still transforming");return e.push(null)}function Js(e){if(!(this instanceof Js))return new Js(e);Ws.call(this,e)}function Xs(){Oa.call(this)}Fa(Ws,Ks),Ws.prototype.push=function(e,t){return this._transformState.needTransform=!1,Ks.prototype.push.call(this,e,t)},Ws.prototype._transform=function(e,t,n){throw new Error("Not implemented")},Ws.prototype._write=function(e,t,n){var o=this._transformState;if(o.writecb=n,o.writechunk=e,o.writeencoding=t,!o.transforming){var r=this._readableState;(o.needTransform||r.needReadable||r.length<r.highWaterMark)&&this._read(r.highWaterMark)}},Ws.prototype._read=function(e){var t=this._transformState;null!==t.writechunk&&t.writecb&&!t.transforming?(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform)):t.needTransform=!0},Fa(Js,Ws),Js.prototype._transform=function(e,t,n){n(null,e)},Fa(Xs,Oa),Xs.Readable=vs,Xs.Writable=Os,Xs.Duplex=Ks,Xs.Transform=Ws,Xs.PassThrough=Js,Xs.Stream=Xs,Xs.prototype.pipe=function(e,t){var n=this;function o(t){e.writable&&!1===e.write(t)&&n.pause&&n.pause()}function r(){n.readable&&n.resume&&n.resume()}n.on("data",o),e.on("drain",r),e._isStdio||t&&!1===t.end||(n.on("end",a),n.on("close",s));var i=!1;function a(){i||(i=!0,e.end())}function s(){i||(i=!0,"function"==typeof e.destroy&&e.destroy())}function u(e){if(c(),0===Oa.listenerCount(this,"error"))throw e}function c(){n.removeListener("data",o),e.removeListener("drain",r),n.removeListener("end",a),n.removeListener("close",s),n.removeListener("error",u),e.removeListener("error",u),n.removeListener("end",c),n.removeListener("close",c),e.removeListener("close",c)}return n.on("error",u),e.on("error",u),n.on("end",c),n.on("close",c),e.on("close",c),e.emit("pipe",n),e};var $s={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"};function Qs(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}function eu(e,t,n,o,r){if(t.subarray&&e.subarray)e.set(t.subarray(n,n+o),r);else for(var i=0;i<o;i++)e[r+i]=t[n+i]}var tu=Uint8Array,nu=Uint16Array,ou=Int32Array,ru=4,iu=0,au=1,su=2;function uu(e){for(var t=e.length;--t>=0;)e[t]=0}var cu=0,lu=1,du=2,pu=29,fu=256,hu=fu+1+pu,gu=30,vu=19,mu=2*hu+1,_u=15,yu=16,Mu=7,Iu=256,Cu=16,ku=17,Tu=18,Su=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],bu=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],Du=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],Eu=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],Au=new Array(2*(hu+2));uu(Au);var Lu=new Array(2*gu);uu(Lu);var Ru=new Array(512);uu(Ru);var wu=new Array(256);uu(wu);var Ou=new Array(pu);uu(Ou);var Nu,Pu,Gu,Uu=new Array(gu);function xu(e,t,n,o,r){this.static_tree=e,this.extra_bits=t,this.extra_base=n,this.elems=o,this.max_length=r,this.has_stree=e&&e.length}function Fu(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}function qu(e){return e<256?Ru[e]:Ru[256+(e>>>7)]}function Bu(e,t){e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255}function Vu(e,t,n){e.bi_valid>yu-n?(e.bi_buf|=t<<e.bi_valid&65535,Bu(e,e.bi_buf),e.bi_buf=t>>yu-e.bi_valid,e.bi_valid+=n-yu):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=n)}function Hu(e,t,n){Vu(e,n[2*t],n[2*t+1])}function Ku(e,t){var n=0;do{n|=1&e,e>>>=1,n<<=1}while(--t>0);return n>>>1}function ju(e,t,n){var o,r,i=new Array(_u+1),a=0;for(o=1;o<=_u;o++)i[o]=a=a+n[o-1]<<1;for(r=0;r<=t;r++){var s=e[2*r+1];0!==s&&(e[2*r]=Ku(i[s]++,s))}}function zu(e){var t;for(t=0;t<hu;t++)e.dyn_ltree[2*t]=0;for(t=0;t<gu;t++)e.dyn_dtree[2*t]=0;for(t=0;t<vu;t++)e.bl_tree[2*t]=0;e.dyn_ltree[2*Iu]=1,e.opt_len=e.static_len=0,e.last_lit=e.matches=0}function Zu(e){e.bi_valid>8?Bu(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0}function Wu(e,t,n,o){var r=2*t,i=2*n;return e[r]<e[i]||e[r]===e[i]&&o[t]<=o[n]}function Yu(e,t,n){for(var o=e.heap[n],r=n<<1;r<=e.heap_len&&(r<e.heap_len&&Wu(t,e.heap[r+1],e.heap[r],e.depth)&&r++,!Wu(t,o,e.heap[r],e.depth));)e.heap[n]=e.heap[r],n=r,r<<=1;e.heap[n]=o}function Ju(e,t,n){var o,r,i,a,s=0;if(0!==e.last_lit)do{o=e.pending_buf[e.d_buf+2*s]<<8|e.pending_buf[e.d_buf+2*s+1],r=e.pending_buf[e.l_buf+s],s++,0===o?Hu(e,r,t):(Hu(e,(i=wu[r])+fu+1,t),0!==(a=Su[i])&&Vu(e,r-=Ou[i],a),Hu(e,i=qu(--o),n),0!==(a=bu[i])&&Vu(e,o-=Uu[i],a))}while(s<e.last_lit);Hu(e,Iu,t)}function Xu(e,t){var n,o,r,i=t.dyn_tree,a=t.stat_desc.static_tree,s=t.stat_desc.has_stree,u=t.stat_desc.elems,c=-1;for(e.heap_len=0,e.heap_max=mu,n=0;n<u;n++)0!==i[2*n]?(e.heap[++e.heap_len]=c=n,e.depth[n]=0):i[2*n+1]=0;for(;e.heap_len<2;)i[2*(r=e.heap[++e.heap_len]=c<2?++c:0)]=1,e.depth[r]=0,e.opt_len--,s&&(e.static_len-=a[2*r+1]);for(t.max_code=c,n=e.heap_len>>1;n>=1;n--)Yu(e,i,n);r=u;do{n=e.heap[1],e.heap[1]=e.heap[e.heap_len--],Yu(e,i,1),o=e.heap[1],e.heap[--e.heap_max]=n,e.heap[--e.heap_max]=o,i[2*r]=i[2*n]+i[2*o],e.depth[r]=(e.depth[n]>=e.depth[o]?e.depth[n]:e.depth[o])+1,i[2*n+1]=i[2*o+1]=r,e.heap[1]=r++,Yu(e,i,1)}while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],function(e,t){var n,o,r,i,a,s,u=t.dyn_tree,c=t.max_code,l=t.stat_desc.static_tree,d=t.stat_desc.has_stree,p=t.stat_desc.extra_bits,f=t.stat_desc.extra_base,h=t.stat_desc.max_length,g=0;for(i=0;i<=_u;i++)e.bl_count[i]=0;for(u[2*e.heap[e.heap_max]+1]=0,n=e.heap_max+1;n<mu;n++)(i=u[2*u[2*(o=e.heap[n])+1]+1]+1)>h&&(i=h,g++),u[2*o+1]=i,o>c||(e.bl_count[i]++,a=0,o>=f&&(a=p[o-f]),s=u[2*o],e.opt_len+=s*(i+a),d&&(e.static_len+=s*(l[2*o+1]+a)));if(0!==g){do{for(i=h-1;0===e.bl_count[i];)i--;e.bl_count[i]--,e.bl_count[i+1]+=2,e.bl_count[h]--,g-=2}while(g>0);for(i=h;0!==i;i--)for(o=e.bl_count[i];0!==o;)(r=e.heap[--n])>c||(u[2*r+1]!==i&&(e.opt_len+=(i-u[2*r+1])*u[2*r],u[2*r+1]=i),o--)}}(e,t),ju(i,c,e.bl_count)}function $u(e,t,n){var o,r,i=-1,a=t[1],s=0,u=7,c=4;for(0===a&&(u=138,c=3),t[2*(n+1)+1]=65535,o=0;o<=n;o++)r=a,a=t[2*(o+1)+1],++s<u&&r===a||(s<c?e.bl_tree[2*r]+=s:0!==r?(r!==i&&e.bl_tree[2*r]++,e.bl_tree[2*Cu]++):s<=10?e.bl_tree[2*ku]++:e.bl_tree[2*Tu]++,s=0,i=r,0===a?(u=138,c=3):r===a?(u=6,c=3):(u=7,c=4))}function Qu(e,t,n){var o,r,i=-1,a=t[1],s=0,u=7,c=4;for(0===a&&(u=138,c=3),o=0;o<=n;o++)if(r=a,a=t[2*(o+1)+1],!(++s<u&&r===a)){if(s<c)do{Hu(e,r,e.bl_tree)}while(0!=--s);else 0!==r?(r!==i&&(Hu(e,r,e.bl_tree),s--),Hu(e,Cu,e.bl_tree),Vu(e,s-3,2)):s<=10?(Hu(e,ku,e.bl_tree),Vu(e,s-3,3)):(Hu(e,Tu,e.bl_tree),Vu(e,s-11,7));s=0,i=r,0===a?(u=138,c=3):r===a?(u=6,c=3):(u=7,c=4)}}uu(Uu);var ec=!1;function tc(e,t,n,o){Vu(e,(cu<<1)+(o?1:0),3),function(e,t,n,o){Zu(e),Bu(e,n),Bu(e,~n),eu(e.pending_buf,e.window,t,n,e.pending),e.pending+=n}(e,t,n)}function nc(e,t,n){return e.pending_buf[e.d_buf+2*e.last_lit]=t>>>8&255,e.pending_buf[e.d_buf+2*e.last_lit+1]=255&t,e.pending_buf[e.l_buf+e.last_lit]=255&n,e.last_lit++,0===t?e.dyn_ltree[2*n]++:(e.matches++,t--,e.dyn_ltree[2*(wu[n]+fu+1)]++,e.dyn_dtree[2*qu(t)]++),e.last_lit===e.lit_bufsize-1}function oc(e,t,n,o){for(var r=65535&e|0,i=e>>>16&65535|0,a=0;0!==n;){n-=a=n>2e3?2e3:n;do{i=i+(r=r+t[o++]|0)|0}while(--a);r%=65521,i%=65521}return r|i<<16|0}var rc=function(){for(var e,t=[],n=0;n<256;n++){e=n;for(var o=0;o<8;o++)e=1&e?3988292384^e>>>1:e>>>1;t[n]=e}return t}();function ic(e,t,n,o){var r=rc,i=o+n;e^=-1;for(var a=o;a<i;a++)e=e>>>8^r[255&(e^t[a])];return-1^e}var ac,sc=0,uc=1,cc=3,lc=4,dc=5,pc=0,fc=1,hc=-2,gc=-5,vc=1,mc=2,_c=3,yc=2,Mc=8,Ic=286,Cc=30,kc=19,Tc=2*Ic+1,Sc=15,bc=3,Dc=258,Ec=Dc+bc+1,Ac=32,Lc=42,Rc=69,wc=73,Oc=91,Nc=103,Pc=113,Gc=666,Uc=1,xc=2,Fc=3,qc=4,Bc=3;function Vc(e,t){return e.msg=$s[t],t}function Hc(e){return(e<<1)-(e>4?9:0)}function Kc(e){for(var t=e.length;--t>=0;)e[t]=0}function jc(e){var t=e.state,n=t.pending;n>e.avail_out&&(n=e.avail_out),0!==n&&(eu(e.output,t.pending_buf,t.pending_out,n,e.next_out),e.next_out+=n,t.pending_out+=n,e.total_out+=n,e.avail_out-=n,t.pending-=n,0===t.pending&&(t.pending_out=0))}function zc(e,t){(function(e,t,n,o){var r,i,a=0;e.level>0?(e.strm.data_type===su&&(e.strm.data_type=function(e){var t,n=4093624447;for(t=0;t<=31;t++,n>>>=1)if(1&n&&0!==e.dyn_ltree[2*t])return iu;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return au;for(t=32;t<fu;t++)if(0!==e.dyn_ltree[2*t])return au;return iu}(e)),Xu(e,e.l_desc),Xu(e,e.d_desc),a=function(e){var t;for($u(e,e.dyn_ltree,e.l_desc.max_code),$u(e,e.dyn_dtree,e.d_desc.max_code),Xu(e,e.bl_desc),t=vu-1;t>=3&&0===e.bl_tree[2*Eu[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t}(e),r=e.opt_len+3+7>>>3,(i=e.static_len+3+7>>>3)<=r&&(r=i)):r=i=n+5,n+4<=r&&-1!==t?tc(e,t,n,o):e.strategy===ru||i===r?(Vu(e,(lu<<1)+(o?1:0),3),Ju(e,Au,Lu)):(Vu(e,(du<<1)+(o?1:0),3),function(e,t,n,o){var r;for(Vu(e,t-257,5),Vu(e,n-1,5),Vu(e,o-4,4),r=0;r<o;r++)Vu(e,e.bl_tree[2*Eu[r]+1],3);Qu(e,e.dyn_ltree,t-1),Qu(e,e.dyn_dtree,n-1)}(e,e.l_desc.max_code+1,e.d_desc.max_code+1,a+1),Ju(e,e.dyn_ltree,e.dyn_dtree)),zu(e),o&&Zu(e)})(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,jc(e.strm)}function Zc(e,t){e.pending_buf[e.pending++]=t}function Wc(e,t){e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t}function Yc(e,t){var n,o,r=e.max_chain_length,i=e.strstart,a=e.prev_length,s=e.nice_match,u=e.strstart>e.w_size-Ec?e.strstart-(e.w_size-Ec):0,c=e.window,l=e.w_mask,d=e.prev,p=e.strstart+Dc,f=c[i+a-1],h=c[i+a];e.prev_length>=e.good_match&&(r>>=2),s>e.lookahead&&(s=e.lookahead);do{if(c[(n=t)+a]===h&&c[n+a-1]===f&&c[n]===c[i]&&c[++n]===c[i+1]){i+=2,n++;do{}while(c[++i]===c[++n]&&c[++i]===c[++n]&&c[++i]===c[++n]&&c[++i]===c[++n]&&c[++i]===c[++n]&&c[++i]===c[++n]&&c[++i]===c[++n]&&c[++i]===c[++n]&&i<p);if(o=Dc-(p-i),i=p-Dc,o>a){if(e.match_start=t,a=o,o>=s)break;f=c[i+a-1],h=c[i+a]}}}while((t=d[t&l])>u&&0!=--r);return a<=e.lookahead?a:e.lookahead}function Jc(e){var t,n,o,r,i,a,s,u,c,l,d=e.w_size;do{if(r=e.window_size-e.lookahead-e.strstart,e.strstart>=d+(d-Ec)){eu(e.window,e.window,d,d,0),e.match_start-=d,e.strstart-=d,e.block_start-=d,t=n=e.hash_size;do{o=e.head[--t],e.head[t]=o>=d?o-d:0}while(--n);t=n=d;do{o=e.prev[--t],e.prev[t]=o>=d?o-d:0}while(--n);r+=d}if(0===e.strm.avail_in)break;if(a=e.strm,s=e.window,u=e.strstart+e.lookahead,c=r,l=void 0,(l=a.avail_in)>c&&(l=c),n=0===l?0:(a.avail_in-=l,eu(s,a.input,a.next_in,l,u),1===a.state.wrap?a.adler=oc(a.adler,s,l,u):2===a.state.wrap&&(a.adler=ic(a.adler,s,l,u)),a.next_in+=l,a.total_in+=l,l),e.lookahead+=n,e.lookahead+e.insert>=bc)for(i=e.strstart-e.insert,e.ins_h=e.window[i],e.ins_h=(e.ins_h<<e.hash_shift^e.window[i+1])&e.hash_mask;e.insert&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[i+bc-1])&e.hash_mask,e.prev[i&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=i,i++,e.insert--,!(e.lookahead+e.insert<bc)););}while(e.lookahead<Ec&&0!==e.strm.avail_in)}function Xc(e,t){for(var n,o;;){if(e.lookahead<Ec){if(Jc(e),e.lookahead<Ec&&t===sc)return Uc;if(0===e.lookahead)break}if(n=0,e.lookahead>=bc&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+bc-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==n&&e.strstart-n<=e.w_size-Ec&&(e.match_length=Yc(e,n)),e.match_length>=bc)if(o=nc(e,e.strstart-e.match_start,e.match_length-bc),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=bc){e.match_length--;do{e.strstart++,e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+bc-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart}while(0!=--e.match_length);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+1])&e.hash_mask;else o=nc(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(o&&(zc(e,!1),0===e.strm.avail_out))return Uc}return e.insert=e.strstart<bc-1?e.strstart:bc-1,t===lc?(zc(e,!0),0===e.strm.avail_out?Fc:qc):e.last_lit&&(zc(e,!1),0===e.strm.avail_out)?Uc:xc}function $c(e,t){for(var n,o,r;;){if(e.lookahead<Ec){if(Jc(e),e.lookahead<Ec&&t===sc)return Uc;if(0===e.lookahead)break}if(n=0,e.lookahead>=bc&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+bc-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=bc-1,0!==n&&e.prev_length<e.max_lazy_match&&e.strstart-n<=e.w_size-Ec&&(e.match_length=Yc(e,n),e.match_length<=5&&(e.strategy===vc||e.match_length===bc&&e.strstart-e.match_start>4096)&&(e.match_length=bc-1)),e.prev_length>=bc&&e.match_length<=e.prev_length){r=e.strstart+e.lookahead-bc,o=nc(e,e.strstart-1-e.prev_match,e.prev_length-bc),e.lookahead-=e.prev_length-1,e.prev_length-=2;do{++e.strstart<=r&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+bc-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart)}while(0!=--e.prev_length);if(e.match_available=0,e.match_length=bc-1,e.strstart++,o&&(zc(e,!1),0===e.strm.avail_out))return Uc}else if(e.match_available){if((o=nc(e,0,e.window[e.strstart-1]))&&zc(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return Uc}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(o=nc(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<bc-1?e.strstart:bc-1,t===lc?(zc(e,!0),0===e.strm.avail_out?Fc:qc):e.last_lit&&(zc(e,!1),0===e.strm.avail_out)?Uc:xc}function Qc(e,t,n,o,r){this.good_length=e,this.max_lazy=t,this.nice_length=n,this.max_chain=o,this.func=r}function el(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=Mc,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new nu(2*Tc),this.dyn_dtree=new nu(2*(2*Cc+1)),this.bl_tree=new nu(2*(2*kc+1)),Kc(this.dyn_ltree),Kc(this.dyn_dtree),Kc(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new nu(Sc+1),this.heap=new nu(2*Ic+1),Kc(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new nu(2*Ic+1),Kc(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function tl(e){var t,n=function(e){var t;return e&&e.state?(e.total_in=e.total_out=0,e.data_type=yc,(t=e.state).pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap?Lc:Pc,e.adler=2===t.wrap?0:1,t.last_flush=sc,function(e){ec||(function(){var e,t,n,o,r,i=new Array(_u+1);for(n=0,o=0;o<pu-1;o++)for(Ou[o]=n,e=0;e<1<<Su[o];e++)wu[n++]=o;for(wu[n-1]=o,r=0,o=0;o<16;o++)for(Uu[o]=r,e=0;e<1<<bu[o];e++)Ru[r++]=o;for(r>>=7;o<gu;o++)for(Uu[o]=r<<7,e=0;e<1<<bu[o]-7;e++)Ru[256+r++]=o;for(t=0;t<=_u;t++)i[t]=0;for(e=0;e<=143;)Au[2*e+1]=8,e++,i[8]++;for(;e<=255;)Au[2*e+1]=9,e++,i[9]++;for(;e<=279;)Au[2*e+1]=7,e++,i[7]++;for(;e<=287;)Au[2*e+1]=8,e++,i[8]++;for(ju(Au,hu+1,i),e=0;e<gu;e++)Lu[2*e+1]=5,Lu[2*e]=Ku(e,5);Nu=new xu(Au,Su,fu+1,hu,_u),Pu=new xu(Lu,bu,0,gu,_u),Gu=new xu(new Array(0),Du,0,vu,Mu)}(),ec=!0),e.l_desc=new Fu(e.dyn_ltree,Nu),e.d_desc=new Fu(e.dyn_dtree,Pu),e.bl_desc=new Fu(e.bl_tree,Gu),e.bi_buf=0,e.bi_valid=0,zu(e)}(t),pc):Vc(e,hc)}(e);return n===pc&&((t=e.state).window_size=2*t.w_size,Kc(t.head),t.max_lazy_match=ac[t.level].max_lazy,t.good_match=ac[t.level].good_length,t.nice_match=ac[t.level].nice_length,t.max_chain_length=ac[t.level].max_chain,t.strstart=0,t.block_start=0,t.lookahead=0,t.insert=0,t.match_length=t.prev_length=bc-1,t.match_available=0,t.ins_h=0),n}function nl(e,t){var n,o,r,i;if(!e||!e.state||t>dc||t<0)return e?Vc(e,hc):hc;if(o=e.state,!e.output||!e.input&&0!==e.avail_in||o.status===Gc&&t!==lc)return Vc(e,0===e.avail_out?gc:hc);if(o.strm=e,n=o.last_flush,o.last_flush=t,o.status===Lc)if(2===o.wrap)e.adler=0,Zc(o,31),Zc(o,139),Zc(o,8),o.gzhead?(Zc(o,(o.gzhead.text?1:0)+(o.gzhead.hcrc?2:0)+(o.gzhead.extra?4:0)+(o.gzhead.name?8:0)+(o.gzhead.comment?16:0)),Zc(o,255&o.gzhead.time),Zc(o,o.gzhead.time>>8&255),Zc(o,o.gzhead.time>>16&255),Zc(o,o.gzhead.time>>24&255),Zc(o,9===o.level?2:o.strategy>=mc||o.level<2?4:0),Zc(o,255&o.gzhead.os),o.gzhead.extra&&o.gzhead.extra.length&&(Zc(o,255&o.gzhead.extra.length),Zc(o,o.gzhead.extra.length>>8&255)),o.gzhead.hcrc&&(e.adler=ic(e.adler,o.pending_buf,o.pending,0)),o.gzindex=0,o.status=Rc):(Zc(o,0),Zc(o,0),Zc(o,0),Zc(o,0),Zc(o,0),Zc(o,9===o.level?2:o.strategy>=mc||o.level<2?4:0),Zc(o,Bc),o.status=Pc);else{var a=Mc+(o.w_bits-8<<4)<<8;a|=(o.strategy>=mc||o.level<2?0:o.level<6?1:6===o.level?2:3)<<6,0!==o.strstart&&(a|=Ac),a+=31-a%31,o.status=Pc,Wc(o,a),0!==o.strstart&&(Wc(o,e.adler>>>16),Wc(o,65535&e.adler)),e.adler=1}if(o.status===Rc)if(o.gzhead.extra){for(r=o.pending;o.gzindex<(65535&o.gzhead.extra.length)&&(o.pending!==o.pending_buf_size||(o.gzhead.hcrc&&o.pending>r&&(e.adler=ic(e.adler,o.pending_buf,o.pending-r,r)),jc(e),r=o.pending,o.pending!==o.pending_buf_size));)Zc(o,255&o.gzhead.extra[o.gzindex]),o.gzindex++;o.gzhead.hcrc&&o.pending>r&&(e.adler=ic(e.adler,o.pending_buf,o.pending-r,r)),o.gzindex===o.gzhead.extra.length&&(o.gzindex=0,o.status=wc)}else o.status=wc;if(o.status===wc)if(o.gzhead.name){r=o.pending;do{if(o.pending===o.pending_buf_size&&(o.gzhead.hcrc&&o.pending>r&&(e.adler=ic(e.adler,o.pending_buf,o.pending-r,r)),jc(e),r=o.pending,o.pending===o.pending_buf_size)){i=1;break}i=o.gzindex<o.gzhead.name.length?255&o.gzhead.name.charCodeAt(o.gzindex++):0,Zc(o,i)}while(0!==i);o.gzhead.hcrc&&o.pending>r&&(e.adler=ic(e.adler,o.pending_buf,o.pending-r,r)),0===i&&(o.gzindex=0,o.status=Oc)}else o.status=Oc;if(o.status===Oc)if(o.gzhead.comment){r=o.pending;do{if(o.pending===o.pending_buf_size&&(o.gzhead.hcrc&&o.pending>r&&(e.adler=ic(e.adler,o.pending_buf,o.pending-r,r)),jc(e),r=o.pending,o.pending===o.pending_buf_size)){i=1;break}i=o.gzindex<o.gzhead.comment.length?255&o.gzhead.comment.charCodeAt(o.gzindex++):0,Zc(o,i)}while(0!==i);o.gzhead.hcrc&&o.pending>r&&(e.adler=ic(e.adler,o.pending_buf,o.pending-r,r)),0===i&&(o.status=Nc)}else o.status=Nc;if(o.status===Nc&&(o.gzhead.hcrc?(o.pending+2>o.pending_buf_size&&jc(e),o.pending+2<=o.pending_buf_size&&(Zc(o,255&e.adler),Zc(o,e.adler>>8&255),e.adler=0,o.status=Pc)):o.status=Pc),0!==o.pending){if(jc(e),0===e.avail_out)return o.last_flush=-1,pc}else if(0===e.avail_in&&Hc(t)<=Hc(n)&&t!==lc)return Vc(e,gc);if(o.status===Gc&&0!==e.avail_in)return Vc(e,gc);if(0!==e.avail_in||0!==o.lookahead||t!==sc&&o.status!==Gc){var s=o.strategy===mc?function(e,t){for(var n;;){if(0===e.lookahead&&(Jc(e),0===e.lookahead)){if(t===sc)return Uc;break}if(e.match_length=0,n=nc(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,n&&(zc(e,!1),0===e.strm.avail_out))return Uc}return e.insert=0,t===lc?(zc(e,!0),0===e.strm.avail_out?Fc:qc):e.last_lit&&(zc(e,!1),0===e.strm.avail_out)?Uc:xc}(o,t):o.strategy===_c?function(e,t){for(var n,o,r,i,a=e.window;;){if(e.lookahead<=Dc){if(Jc(e),e.lookahead<=Dc&&t===sc)return Uc;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=bc&&e.strstart>0&&(o=a[r=e.strstart-1])===a[++r]&&o===a[++r]&&o===a[++r]){i=e.strstart+Dc;do{}while(o===a[++r]&&o===a[++r]&&o===a[++r]&&o===a[++r]&&o===a[++r]&&o===a[++r]&&o===a[++r]&&o===a[++r]&&r<i);e.match_length=Dc-(i-r),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=bc?(n=nc(e,1,e.match_length-bc),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(n=nc(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),n&&(zc(e,!1),0===e.strm.avail_out))return Uc}return e.insert=0,t===lc?(zc(e,!0),0===e.strm.avail_out?Fc:qc):e.last_lit&&(zc(e,!1),0===e.strm.avail_out)?Uc:xc}(o,t):ac[o.level].func(o,t);if(s!==Fc&&s!==qc||(o.status=Gc),s===Uc||s===Fc)return 0===e.avail_out&&(o.last_flush=-1),pc;if(s===xc&&(t===uc?function(e){Vu(e,lu<<1,3),Hu(e,Iu,Au),function(e){16===e.bi_valid?(Bu(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=255&e.bi_buf,e.bi_buf>>=8,e.bi_valid-=8)}(e)}(o):t!==dc&&(tc(o,0,0,!1),t===cc&&(Kc(o.head),0===o.lookahead&&(o.strstart=0,o.block_start=0,o.insert=0))),jc(e),0===e.avail_out))return o.last_flush=-1,pc}return t!==lc?pc:o.wrap<=0?fc:(2===o.wrap?(Zc(o,255&e.adler),Zc(o,e.adler>>8&255),Zc(o,e.adler>>16&255),Zc(o,e.adler>>24&255),Zc(o,255&e.total_in),Zc(o,e.total_in>>8&255),Zc(o,e.total_in>>16&255),Zc(o,e.total_in>>24&255)):(Wc(o,e.adler>>>16),Wc(o,65535&e.adler)),jc(e),o.wrap>0&&(o.wrap=-o.wrap),0!==o.pending?pc:fc)}ac=[new Qc(0,0,0,0,(function(e,t){var n=65535;for(n>e.pending_buf_size-5&&(n=e.pending_buf_size-5);;){if(e.lookahead<=1){if(Jc(e),0===e.lookahead&&t===sc)return Uc;if(0===e.lookahead)break}e.strstart+=e.lookahead,e.lookahead=0;var o=e.block_start+n;if((0===e.strstart||e.strstart>=o)&&(e.lookahead=e.strstart-o,e.strstart=o,zc(e,!1),0===e.strm.avail_out))return Uc;if(e.strstart-e.block_start>=e.w_size-Ec&&(zc(e,!1),0===e.strm.avail_out))return Uc}return e.insert=0,t===lc?(zc(e,!0),0===e.strm.avail_out?Fc:qc):(e.strstart>e.block_start&&(zc(e,!1),e.strm.avail_out),Uc)})),new Qc(4,4,8,4,Xc),new Qc(4,5,16,8,Xc),new Qc(4,6,32,32,Xc),new Qc(4,4,16,16,$c),new Qc(8,16,32,32,$c),new Qc(8,16,128,128,$c),new Qc(8,32,128,256,$c),new Qc(32,128,258,1024,$c),new Qc(32,258,258,4096,$c)];var ol=30,rl=12;function il(e,t){var n,o,r,i,a,s,u,c,l,d,p,f,h,g,v,m,_,y,M,I,C,k,T,S,b;n=e.state,o=e.next_in,S=e.input,r=o+(e.avail_in-5),i=e.next_out,b=e.output,a=i-(t-e.avail_out),s=i+(e.avail_out-257),u=n.dmax,c=n.wsize,l=n.whave,d=n.wnext,p=n.window,f=n.hold,h=n.bits,g=n.lencode,v=n.distcode,m=(1<<n.lenbits)-1,_=(1<<n.distbits)-1;e:do{h<15&&(f+=S[o++]<<h,h+=8,f+=S[o++]<<h,h+=8),y=g[f&m];t:for(;;){if(f>>>=M=y>>>24,h-=M,0===(M=y>>>16&255))b[i++]=65535&y;else{if(!(16&M)){if(0==(64&M)){y=g[(65535&y)+(f&(1<<M)-1)];continue t}if(32&M){n.mode=rl;break e}e.msg="invalid literal/length code",n.mode=ol;break e}I=65535&y,(M&=15)&&(h<M&&(f+=S[o++]<<h,h+=8),I+=f&(1<<M)-1,f>>>=M,h-=M),h<15&&(f+=S[o++]<<h,h+=8,f+=S[o++]<<h,h+=8),y=v[f&_];n:for(;;){if(f>>>=M=y>>>24,h-=M,!(16&(M=y>>>16&255))){if(0==(64&M)){y=v[(65535&y)+(f&(1<<M)-1)];continue n}e.msg="invalid distance code",n.mode=ol;break e}if(C=65535&y,h<(M&=15)&&(f+=S[o++]<<h,(h+=8)<M&&(f+=S[o++]<<h,h+=8)),(C+=f&(1<<M)-1)>u){e.msg="invalid distance too far back",n.mode=ol;break e}if(f>>>=M,h-=M,C>(M=i-a)){if((M=C-M)>l&&n.sane){e.msg="invalid distance too far back",n.mode=ol;break e}if(k=0,T=p,0===d){if(k+=c-M,M<I){I-=M;do{b[i++]=p[k++]}while(--M);k=i-C,T=b}}else if(d<M){if(k+=c+d-M,(M-=d)<I){I-=M;do{b[i++]=p[k++]}while(--M);if(k=0,d<I){I-=M=d;do{b[i++]=p[k++]}while(--M);k=i-C,T=b}}}else if(k+=d-M,M<I){I-=M;do{b[i++]=p[k++]}while(--M);k=i-C,T=b}for(;I>2;)b[i++]=T[k++],b[i++]=T[k++],b[i++]=T[k++],I-=3;I&&(b[i++]=T[k++],I>1&&(b[i++]=T[k++]))}else{k=i-C;do{b[i++]=b[k++],b[i++]=b[k++],b[i++]=b[k++],I-=3}while(I>2);I&&(b[i++]=b[k++],I>1&&(b[i++]=b[k++]))}break}}break}}while(o<r&&i<s);o-=I=h>>3,f&=(1<<(h-=I<<3))-1,e.next_in=o,e.next_out=i,e.avail_in=o<r?r-o+5:5-(o-r),e.avail_out=i<s?s-i+257:257-(i-s),n.hold=f,n.bits=h}var al=15,sl=852,ul=592,cl=0,ll=1,dl=2,pl=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],fl=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],hl=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],gl=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];function vl(e,t,n,o,r,i,a,s){var u,c,l,d,p,f,h,g,v,m=s.bits,_=0,y=0,M=0,I=0,C=0,k=0,T=0,S=0,b=0,D=0,E=null,A=0,L=new nu(al+1),R=new nu(al+1),w=null,O=0;for(_=0;_<=al;_++)L[_]=0;for(y=0;y<o;y++)L[t[n+y]]++;for(C=m,I=al;I>=1&&0===L[I];I--);if(C>I&&(C=I),0===I)return r[i++]=20971520,r[i++]=20971520,s.bits=1,0;for(M=1;M<I&&0===L[M];M++);for(C<M&&(C=M),S=1,_=1;_<=al;_++)if(S<<=1,(S-=L[_])<0)return-1;if(S>0&&(e===cl||1!==I))return-1;for(R[1]=0,_=1;_<al;_++)R[_+1]=R[_]+L[_];for(y=0;y<o;y++)0!==t[n+y]&&(a[R[t[n+y]]++]=y);if(e===cl?(E=w=a,f=19):e===ll?(E=pl,A-=257,w=fl,O-=257,f=256):(E=hl,w=gl,f=-1),D=0,y=0,_=M,p=i,k=C,T=0,l=-1,d=(b=1<<C)-1,e===ll&&b>sl||e===dl&&b>ul)return 1;for(;;){h=_-T,a[y]<f?(g=0,v=a[y]):a[y]>f?(g=w[O+a[y]],v=E[A+a[y]]):(g=96,v=0),u=1<<_-T,M=c=1<<k;do{r[p+(D>>T)+(c-=u)]=h<<24|g<<16|v|0}while(0!==c);for(u=1<<_-1;D&u;)u>>=1;if(0!==u?(D&=u-1,D+=u):D=0,y++,0==--L[_]){if(_===I)break;_=t[n+a[y]]}if(_>C&&(D&d)!==l){for(0===T&&(T=C),p+=M,S=1<<(k=_-T);k+T<I&&!((S-=L[k+T])<=0);)k++,S<<=1;if(b+=1<<k,e===ll&&b>sl||e===dl&&b>ul)return 1;r[l=D&d]=C<<24|k<<16|p-i|0}}return 0!==D&&(r[p+D]=_-T<<24|64<<16|0),s.bits=C,0}var ml=0,_l=1,yl=2,Ml=4,Il=5,Cl=6,kl=0,Tl=1,Sl=2,bl=-2,Dl=-3,El=-4,Al=-5,Ll=8,Rl=1,wl=2,Ol=3,Nl=4,Pl=5,Gl=6,Ul=7,xl=8,Fl=9,ql=10,Bl=11,Vl=12,Hl=13,Kl=14,jl=15,zl=16,Zl=17,Wl=18,Yl=19,Jl=20,Xl=21,$l=22,Ql=23,ed=24,td=25,nd=26,od=27,rd=28,id=29,ad=30,sd=31,ud=852,cd=592;function ld(e){return(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24)}function dd(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new nu(320),this.work=new nu(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function pd(e){var t;return e&&e.state?((t=e.state).wsize=0,t.whave=0,t.wnext=0,function(e){var t;return e&&e.state?(t=e.state,e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=Rl,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new ou(ud),t.distcode=t.distdyn=new ou(cd),t.sane=1,t.back=-1,kl):bl}(e)):bl}var fd,hd,gd=!0;function vd(e){if(gd){var t;for(fd=new ou(512),hd=new ou(32),t=0;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(vl(_l,e.lens,0,288,fd,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;vl(yl,e.lens,0,32,hd,0,e.work,{bits:5}),gd=!1}e.lencode=fd,e.lenbits=9,e.distcode=hd,e.distbits=5}var md,_d=1,yd=7;function Md(e){if(e<_d||e>yd)throw new TypeError("Bad argument");this.mode=e,this.init_done=!1,this.write_in_progress=!1,this.pending_close=!1,this.windowBits=0,this.level=0,this.memLevel=0,this.strategy=0,this.dictionary=null}function Id(e,t){for(var n=0;n<e.length;n++)this[t+n]=e[n]}Md.prototype.init=function(e,t,n,o,r){var i;switch(this.windowBits=e,this.level=t,this.memLevel=n,this.strategy=o,3!==this.mode&&4!==this.mode||(this.windowBits+=16),this.mode===yd&&(this.windowBits+=32),5!==this.mode&&6!==this.mode||(this.windowBits=-this.windowBits),this.strm=new Qs,this.mode){case _d:case 3:case 5:i=function(e,t,n,o,r,i){if(!e)return hc;var a=1;if(-1===t&&(t=6),o<0?(a=0,o=-o):o>15&&(a=2,o-=16),r<1||r>9||8!==Mc||o<8||o>15||t<0||t>9||i<0||i>4)return Vc(e,hc);8===o&&(o=9);var s=new el;return e.state=s,s.strm=e,s.wrap=a,s.gzhead=null,s.w_bits=o,s.w_size=1<<s.w_bits,s.w_mask=s.w_size-1,s.hash_bits=r+7,s.hash_size=1<<s.hash_bits,s.hash_mask=s.hash_size-1,s.hash_shift=~~((s.hash_bits+bc-1)/bc),s.window=new tu(2*s.w_size),s.head=new nu(s.hash_size),s.prev=new nu(s.w_size),s.lit_bufsize=1<<r+6,s.pending_buf_size=4*s.lit_bufsize,s.pending_buf=new tu(s.pending_buf_size),s.d_buf=1*s.lit_bufsize,s.l_buf=3*s.lit_bufsize,s.level=t,s.strategy=i,s.method=8,tl(e)}(this.strm,this.level,0,this.windowBits,this.memLevel,this.strategy);break;case 2:case 4:case 6:case yd:i=function(e,t){var n,o;return e?(o=new dd,e.state=o,o.window=null,(n=function(e,t){var n,o;return e&&e.state?(o=e.state,t<0?(n=0,t=-t):(n=1+(t>>4),t<48&&(t&=15)),t&&(t<8||t>15)?bl:(null!==o.window&&o.wbits!==t&&(o.window=null),o.wrap=n,o.wbits=t,pd(e))):bl}(e,t))!==kl&&(e.state=null),n):bl}(this.strm,this.windowBits);break;default:throw new Error("Unknown mode "+this.mode)}0===i?(this.write_in_progress=!1,this.init_done=!0):this._error(i)},Md.prototype.params=function(){throw new Error("deflateParams Not supported")},Md.prototype._writeCheck=function(){if(!this.init_done)throw new Error("write before init");if(0===this.mode)throw new Error("already finalized");if(this.write_in_progress)throw new Error("write already in progress");if(this.pending_close)throw new Error("close is pending")},Md.prototype.write=function(e,t,n,o,r,i,a){this._writeCheck(),this.write_in_progress=!0;var s=this;return Aa((function(){s.write_in_progress=!1;var u=s._write(e,t,n,o,r,i,a);s.callback(u[0],u[1]),s.pending_close&&s.close()})),this},Md.prototype.writeSync=function(e,t,n,o,r,i,a){return this._writeCheck(),this._write(e,t,n,o,r,i,a)},Md.prototype._write=function(e,t,n,o,r,i,a){if(this.write_in_progress=!0,0!==e&&1!==e&&2!==e&&3!==e&&4!==e&&5!==e)throw new Error("Invalid flush value");null==t&&(t=new Li(0),o=0,n=0),r._set?r.set=r._set:r.set=Id;var s,u=this.strm;switch(u.avail_in=o,u.input=t,u.next_in=n,u.avail_out=a,u.output=r,u.next_out=i,this.mode){case _d:case 3:case 5:s=nl(u,e);break;case yd:case 2:case 4:case 6:s=function(e,t){var n,o,r,i,a,s,u,c,l,d,p,f,h,g,v,m,_,y,M,I,C,k,T,S,b=0,D=new tu(4),E=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!e||!e.state||!e.output||!e.input&&0!==e.avail_in)return bl;(n=e.state).mode===Vl&&(n.mode=Hl),a=e.next_out,r=e.output,u=e.avail_out,i=e.next_in,o=e.input,s=e.avail_in,c=n.hold,l=n.bits,d=s,p=u,k=kl;e:for(;;)switch(n.mode){case Rl:if(0===n.wrap){n.mode=Hl;break}for(;l<16;){if(0===s)break e;s--,c+=o[i++]<<l,l+=8}if(2&n.wrap&&35615===c){n.check=0,D[0]=255&c,D[1]=c>>>8&255,n.check=ic(n.check,D,2,0),c=0,l=0,n.mode=wl;break}if(n.flags=0,n.head&&(n.head.done=!1),!(1&n.wrap)||(((255&c)<<8)+(c>>8))%31){e.msg="incorrect header check",n.mode=ad;break}if((15&c)!==Ll){e.msg="unknown compression method",n.mode=ad;break}if(l-=4,C=8+(15&(c>>>=4)),0===n.wbits)n.wbits=C;else if(C>n.wbits){e.msg="invalid window size",n.mode=ad;break}n.dmax=1<<C,e.adler=n.check=1,n.mode=512&c?ql:Vl,c=0,l=0;break;case wl:for(;l<16;){if(0===s)break e;s--,c+=o[i++]<<l,l+=8}if(n.flags=c,(255&n.flags)!==Ll){e.msg="unknown compression method",n.mode=ad;break}if(57344&n.flags){e.msg="unknown header flags set",n.mode=ad;break}n.head&&(n.head.text=c>>8&1),512&n.flags&&(D[0]=255&c,D[1]=c>>>8&255,n.check=ic(n.check,D,2,0)),c=0,l=0,n.mode=Ol;case Ol:for(;l<32;){if(0===s)break e;s--,c+=o[i++]<<l,l+=8}n.head&&(n.head.time=c),512&n.flags&&(D[0]=255&c,D[1]=c>>>8&255,D[2]=c>>>16&255,D[3]=c>>>24&255,n.check=ic(n.check,D,4,0)),c=0,l=0,n.mode=Nl;case Nl:for(;l<16;){if(0===s)break e;s--,c+=o[i++]<<l,l+=8}n.head&&(n.head.xflags=255&c,n.head.os=c>>8),512&n.flags&&(D[0]=255&c,D[1]=c>>>8&255,n.check=ic(n.check,D,2,0)),c=0,l=0,n.mode=Pl;case Pl:if(1024&n.flags){for(;l<16;){if(0===s)break e;s--,c+=o[i++]<<l,l+=8}n.length=c,n.head&&(n.head.extra_len=c),512&n.flags&&(D[0]=255&c,D[1]=c>>>8&255,n.check=ic(n.check,D,2,0)),c=0,l=0}else n.head&&(n.head.extra=null);n.mode=Gl;case Gl:if(1024&n.flags&&((f=n.length)>s&&(f=s),f&&(n.head&&(C=n.head.extra_len-n.length,n.head.extra||(n.head.extra=new Array(n.head.extra_len)),eu(n.head.extra,o,i,f,C)),512&n.flags&&(n.check=ic(n.check,o,f,i)),s-=f,i+=f,n.length-=f),n.length))break e;n.length=0,n.mode=Ul;case Ul:if(2048&n.flags){if(0===s)break e;f=0;do{C=o[i+f++],n.head&&C&&n.length<65536&&(n.head.name+=String.fromCharCode(C))}while(C&&f<s);if(512&n.flags&&(n.check=ic(n.check,o,f,i)),s-=f,i+=f,C)break e}else n.head&&(n.head.name=null);n.length=0,n.mode=xl;case xl:if(4096&n.flags){if(0===s)break e;f=0;do{C=o[i+f++],n.head&&C&&n.length<65536&&(n.head.comment+=String.fromCharCode(C))}while(C&&f<s);if(512&n.flags&&(n.check=ic(n.check,o,f,i)),s-=f,i+=f,C)break e}else n.head&&(n.head.comment=null);n.mode=Fl;case Fl:if(512&n.flags){for(;l<16;){if(0===s)break e;s--,c+=o[i++]<<l,l+=8}if(c!==(65535&n.check)){e.msg="header crc mismatch",n.mode=ad;break}c=0,l=0}n.head&&(n.head.hcrc=n.flags>>9&1,n.head.done=!0),e.adler=n.check=0,n.mode=Vl;break;case ql:for(;l<32;){if(0===s)break e;s--,c+=o[i++]<<l,l+=8}e.adler=n.check=ld(c),c=0,l=0,n.mode=Bl;case Bl:if(0===n.havedict)return e.next_out=a,e.avail_out=u,e.next_in=i,e.avail_in=s,n.hold=c,n.bits=l,Sl;e.adler=n.check=1,n.mode=Vl;case Vl:if(t===Il||t===Cl)break e;case Hl:if(n.last){c>>>=7&l,l-=7&l,n.mode=od;break}for(;l<3;){if(0===s)break e;s--,c+=o[i++]<<l,l+=8}switch(n.last=1&c,l-=1,3&(c>>>=1)){case 0:n.mode=Kl;break;case 1:if(vd(n),n.mode=Jl,t===Cl){c>>>=2,l-=2;break e}break;case 2:n.mode=Zl;break;case 3:e.msg="invalid block type",n.mode=ad}c>>>=2,l-=2;break;case Kl:for(c>>>=7&l,l-=7&l;l<32;){if(0===s)break e;s--,c+=o[i++]<<l,l+=8}if((65535&c)!=(c>>>16^65535)){e.msg="invalid stored block lengths",n.mode=ad;break}if(n.length=65535&c,c=0,l=0,n.mode=jl,t===Cl)break e;case jl:n.mode=zl;case zl:if(f=n.length){if(f>s&&(f=s),f>u&&(f=u),0===f)break e;eu(r,o,i,f,a),s-=f,i+=f,u-=f,a+=f,n.length-=f;break}n.mode=Vl;break;case Zl:for(;l<14;){if(0===s)break e;s--,c+=o[i++]<<l,l+=8}if(n.nlen=257+(31&c),c>>>=5,l-=5,n.ndist=1+(31&c),c>>>=5,l-=5,n.ncode=4+(15&c),c>>>=4,l-=4,n.nlen>286||n.ndist>30){e.msg="too many length or distance symbols",n.mode=ad;break}n.have=0,n.mode=Wl;case Wl:for(;n.have<n.ncode;){for(;l<3;){if(0===s)break e;s--,c+=o[i++]<<l,l+=8}n.lens[E[n.have++]]=7&c,c>>>=3,l-=3}for(;n.have<19;)n.lens[E[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,T={bits:n.lenbits},k=vl(ml,n.lens,0,19,n.lencode,0,n.work,T),n.lenbits=T.bits,k){e.msg="invalid code lengths set",n.mode=ad;break}n.have=0,n.mode=Yl;case Yl:for(;n.have<n.nlen+n.ndist;){for(;m=(b=n.lencode[c&(1<<n.lenbits)-1])>>>16&255,_=65535&b,!((v=b>>>24)<=l);){if(0===s)break e;s--,c+=o[i++]<<l,l+=8}if(_<16)c>>>=v,l-=v,n.lens[n.have++]=_;else{if(16===_){for(S=v+2;l<S;){if(0===s)break e;s--,c+=o[i++]<<l,l+=8}if(c>>>=v,l-=v,0===n.have){e.msg="invalid bit length repeat",n.mode=ad;break}C=n.lens[n.have-1],f=3+(3&c),c>>>=2,l-=2}else if(17===_){for(S=v+3;l<S;){if(0===s)break e;s--,c+=o[i++]<<l,l+=8}l-=v,C=0,f=3+(7&(c>>>=v)),c>>>=3,l-=3}else{for(S=v+7;l<S;){if(0===s)break e;s--,c+=o[i++]<<l,l+=8}l-=v,C=0,f=11+(127&(c>>>=v)),c>>>=7,l-=7}if(n.have+f>n.nlen+n.ndist){e.msg="invalid bit length repeat",n.mode=ad;break}for(;f--;)n.lens[n.have++]=C}}if(n.mode===ad)break;if(0===n.lens[256]){e.msg="invalid code -- missing end-of-block",n.mode=ad;break}if(n.lenbits=9,T={bits:n.lenbits},k=vl(_l,n.lens,0,n.nlen,n.lencode,0,n.work,T),n.lenbits=T.bits,k){e.msg="invalid literal/lengths set",n.mode=ad;break}if(n.distbits=6,n.distcode=n.distdyn,T={bits:n.distbits},k=vl(yl,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,T),n.distbits=T.bits,k){e.msg="invalid distances set",n.mode=ad;break}if(n.mode=Jl,t===Cl)break e;case Jl:n.mode=Xl;case Xl:if(s>=6&&u>=258){e.next_out=a,e.avail_out=u,e.next_in=i,e.avail_in=s,n.hold=c,n.bits=l,il(e,p),a=e.next_out,r=e.output,u=e.avail_out,i=e.next_in,o=e.input,s=e.avail_in,c=n.hold,l=n.bits,n.mode===Vl&&(n.back=-1);break}for(n.back=0;m=(b=n.lencode[c&(1<<n.lenbits)-1])>>>16&255,_=65535&b,!((v=b>>>24)<=l);){if(0===s)break e;s--,c+=o[i++]<<l,l+=8}if(m&&0==(240&m)){for(y=v,M=m,I=_;m=(b=n.lencode[I+((c&(1<<y+M)-1)>>y)])>>>16&255,_=65535&b,!(y+(v=b>>>24)<=l);){if(0===s)break e;s--,c+=o[i++]<<l,l+=8}c>>>=y,l-=y,n.back+=y}if(c>>>=v,l-=v,n.back+=v,n.length=_,0===m){n.mode=nd;break}if(32&m){n.back=-1,n.mode=Vl;break}if(64&m){e.msg="invalid literal/length code",n.mode=ad;break}n.extra=15&m,n.mode=$l;case $l:if(n.extra){for(S=n.extra;l<S;){if(0===s)break e;s--,c+=o[i++]<<l,l+=8}n.length+=c&(1<<n.extra)-1,c>>>=n.extra,l-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=Ql;case Ql:for(;m=(b=n.distcode[c&(1<<n.distbits)-1])>>>16&255,_=65535&b,!((v=b>>>24)<=l);){if(0===s)break e;s--,c+=o[i++]<<l,l+=8}if(0==(240&m)){for(y=v,M=m,I=_;m=(b=n.distcode[I+((c&(1<<y+M)-1)>>y)])>>>16&255,_=65535&b,!(y+(v=b>>>24)<=l);){if(0===s)break e;s--,c+=o[i++]<<l,l+=8}c>>>=y,l-=y,n.back+=y}if(c>>>=v,l-=v,n.back+=v,64&m){e.msg="invalid distance code",n.mode=ad;break}n.offset=_,n.extra=15&m,n.mode=ed;case ed:if(n.extra){for(S=n.extra;l<S;){if(0===s)break e;s--,c+=o[i++]<<l,l+=8}n.offset+=c&(1<<n.extra)-1,c>>>=n.extra,l-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){e.msg="invalid distance too far back",n.mode=ad;break}n.mode=td;case td:if(0===u)break e;if(f=p-u,n.offset>f){if((f=n.offset-f)>n.whave&&n.sane){e.msg="invalid distance too far back",n.mode=ad;break}f>n.wnext?(f-=n.wnext,h=n.wsize-f):h=n.wnext-f,f>n.length&&(f=n.length),g=n.window}else g=r,h=a-n.offset,f=n.length;f>u&&(f=u),u-=f,n.length-=f;do{r[a++]=g[h++]}while(--f);0===n.length&&(n.mode=Xl);break;case nd:if(0===u)break e;r[a++]=n.length,u--,n.mode=Xl;break;case od:if(n.wrap){for(;l<32;){if(0===s)break e;s--,c|=o[i++]<<l,l+=8}if(p-=u,e.total_out+=p,n.total+=p,p&&(e.adler=n.check=n.flags?ic(n.check,r,p,a-p):oc(n.check,r,p,a-p)),p=u,(n.flags?c:ld(c))!==n.check){e.msg="incorrect data check",n.mode=ad;break}c=0,l=0}n.mode=rd;case rd:if(n.wrap&&n.flags){for(;l<32;){if(0===s)break e;s--,c+=o[i++]<<l,l+=8}if(c!==(4294967295&n.total)){e.msg="incorrect length check",n.mode=ad;break}c=0,l=0}n.mode=id;case id:k=Tl;break e;case ad:k=Dl;break e;case sd:return El;default:return bl}return e.next_out=a,e.avail_out=u,e.next_in=i,e.avail_in=s,n.hold=c,n.bits=l,(n.wsize||p!==e.avail_out&&n.mode<ad&&(n.mode<od||t!==Ml))&&function(e,t,n,o){var r,i=e.state;null===i.window&&(i.wsize=1<<i.wbits,i.wnext=0,i.whave=0,i.window=new tu(i.wsize)),o>=i.wsize?(eu(i.window,t,n-i.wsize,i.wsize,0),i.wnext=0,i.whave=i.wsize):((r=i.wsize-i.wnext)>o&&(r=o),eu(i.window,t,n-o,r,i.wnext),(o-=r)?(eu(i.window,t,n-o,o,0),i.wnext=o,i.whave=i.wsize):(i.wnext+=r,i.wnext===i.wsize&&(i.wnext=0),i.whave<i.wsize&&(i.whave+=r)))}(e,e.output,e.next_out,p-e.avail_out),d-=e.avail_in,p-=e.avail_out,e.total_in+=d,e.total_out+=p,n.total+=p,n.wrap&&p&&(e.adler=n.check=n.flags?ic(n.check,r,p,e.next_out-p):oc(n.check,r,p,e.next_out-p)),e.data_type=n.bits+(n.last?64:0)+(n.mode===Vl?128:0)+(n.mode===Jl||n.mode===jl?256:0),(0===d&&0===p||t===Ml)&&k===kl&&(k=Al),k}(u,e);break;default:throw new Error("Unknown mode "+this.mode)}return 1!==s&&0!==s&&this._error(s),this.write_in_progress=!1,[u.avail_in,u.avail_out]},Md.prototype.close=function(){this.write_in_progress?this.pending_close=!0:(this.pending_close=!1,this.mode===_d||3===this.mode||5===this.mode?function(e){var t;e&&e.state&&((t=e.state.status)!==Lc&&t!==Rc&&t!==wc&&t!==Oc&&t!==Nc&&t!==Pc&&t!==Gc?Vc(e,hc):(e.state=null,t===Pc&&Vc(e,-3)))}(this.strm):function(e){if(!e||!e.state)return bl;var t=e.state;t.window&&(t.window=null),e.state=null}(this.strm),this.mode=0)},Md.prototype.reset=function(){switch(this.mode){case _d:case 5:md=tl(this.strm);break;case 2:case 6:md=pd(this.strm)}0!==md&&this._error(md)},Md.prototype._error=function(e){this.onerror($s[e]+": "+this.strm.msg,e),this.write_in_progress=!1,this.pending_close&&this.close()};var Cd=Object.freeze({NONE:0,DEFLATE:_d,INFLATE:2,GZIP:3,GUNZIP:4,DEFLATERAW:5,INFLATERAW:6,UNZIP:yd,Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8,Zlib:Md}),kd={};Object.keys(Cd).forEach((function(e){kd[e]=Cd[e]})),kd.Z_MIN_WINDOWBITS=8,kd.Z_MAX_WINDOWBITS=15,kd.Z_DEFAULT_WINDOWBITS=15,kd.Z_MIN_CHUNK=64,kd.Z_MAX_CHUNK=1/0,kd.Z_DEFAULT_CHUNK=16384,kd.Z_MIN_MEMLEVEL=1,kd.Z_MAX_MEMLEVEL=9,kd.Z_DEFAULT_MEMLEVEL=8,kd.Z_MIN_LEVEL=-1,kd.Z_MAX_LEVEL=9,kd.Z_DEFAULT_LEVEL=kd.Z_DEFAULT_COMPRESSION;var Td={Z_OK:kd.Z_OK,Z_STREAM_END:kd.Z_STREAM_END,Z_NEED_DICT:kd.Z_NEED_DICT,Z_ERRNO:kd.Z_ERRNO,Z_STREAM_ERROR:kd.Z_STREAM_ERROR,Z_DATA_ERROR:kd.Z_DATA_ERROR,Z_MEM_ERROR:kd.Z_MEM_ERROR,Z_BUF_ERROR:kd.Z_BUF_ERROR,Z_VERSION_ERROR:kd.Z_VERSION_ERROR};function Sd(e,t){if("string"==typeof t&&(t=new Li(t)),!fa(t))throw new TypeError("Not a string or buffer");var n=kd.Z_FINISH;return e._processChunk(t,n)}function bd(e){if(!(this instanceof bd))return new bd(e);Od.call(this,e,kd.DEFLATE)}function Dd(e){if(!(this instanceof Dd))return new Dd(e);Od.call(this,e,kd.INFLATE)}function Ed(e){if(!(this instanceof Ed))return new Ed(e);Od.call(this,e,kd.GZIP)}function Ad(e){if(!(this instanceof Ad))return new Ad(e);Od.call(this,e,kd.GUNZIP)}function Ld(e){if(!(this instanceof Ld))return new Ld(e);Od.call(this,e,kd.DEFLATERAW)}function Rd(e){if(!(this instanceof Rd))return new Rd(e);Od.call(this,e,kd.INFLATERAW)}function wd(e){if(!(this instanceof wd))return new wd(e);Od.call(this,e,kd.UNZIP)}function Od(e,t){if(this._opts=e=e||{},this._chunkSize=e.chunkSize||kd.Z_DEFAULT_CHUNK,Ws.call(this,e),e.flush&&e.flush!==kd.Z_NO_FLUSH&&e.flush!==kd.Z_PARTIAL_FLUSH&&e.flush!==kd.Z_SYNC_FLUSH&&e.flush!==kd.Z_FULL_FLUSH&&e.flush!==kd.Z_FINISH&&e.flush!==kd.Z_BLOCK)throw new Error("Invalid flush flag: "+e.flush);if(this._flushFlag=e.flush||kd.Z_NO_FLUSH,e.chunkSize&&(e.chunkSize<kd.Z_MIN_CHUNK||e.chunkSize>kd.Z_MAX_CHUNK))throw new Error("Invalid chunk size: "+e.chunkSize);if(e.windowBits&&(e.windowBits<kd.Z_MIN_WINDOWBITS||e.windowBits>kd.Z_MAX_WINDOWBITS))throw new Error("Invalid windowBits: "+e.windowBits);if(e.level&&(e.level<kd.Z_MIN_LEVEL||e.level>kd.Z_MAX_LEVEL))throw new Error("Invalid compression level: "+e.level);if(e.memLevel&&(e.memLevel<kd.Z_MIN_MEMLEVEL||e.memLevel>kd.Z_MAX_MEMLEVEL))throw new Error("Invalid memLevel: "+e.memLevel);if(e.strategy&&e.strategy!=kd.Z_FILTERED&&e.strategy!=kd.Z_HUFFMAN_ONLY&&e.strategy!=kd.Z_RLE&&e.strategy!=kd.Z_FIXED&&e.strategy!=kd.Z_DEFAULT_STRATEGY)throw new Error("Invalid strategy: "+e.strategy);if(e.dictionary&&!fa(e.dictionary))throw new Error("Invalid dictionary: it should be a Buffer instance");this._binding=new kd.Zlib(t);var n=this;this._hadError=!1,this._binding.onerror=function(e,t){n._binding=null,n._hadError=!0;var o=new Error(e);o.errno=t,o.code=kd.codes[t],n.emit("error",o)};var o=kd.Z_DEFAULT_COMPRESSION;"number"==typeof e.level&&(o=e.level);var r=kd.Z_DEFAULT_STRATEGY;"number"==typeof e.strategy&&(r=e.strategy),this._binding.init(e.windowBits||kd.Z_DEFAULT_WINDOWBITS,o,e.memLevel||kd.Z_DEFAULT_MEMLEVEL,r,e.dictionary),this._buffer=new Li(this._chunkSize),this._offset=0,this._closed=!1,this._level=o,this._strategy=r,this.once("end",this.close)}Object.keys(Td).forEach((function(e){Td[Td[e]]=e})),Fa(Od,Ws),Od.prototype.params=function(e,t,n){if(e<kd.Z_MIN_LEVEL||e>kd.Z_MAX_LEVEL)throw new RangeError("Invalid compression level: "+e);if(t!=kd.Z_FILTERED&&t!=kd.Z_HUFFMAN_ONLY&&t!=kd.Z_RLE&&t!=kd.Z_FIXED&&t!=kd.Z_DEFAULT_STRATEGY)throw new TypeError("Invalid strategy: "+t);if(this._level!==e||this._strategy!==t){var o=this;this.flush(kd.Z_SYNC_FLUSH,(function(){o._binding.params(e,t),o._hadError||(o._level=e,o._strategy=t,n&&n())}))}else Aa(n)},Od.prototype.reset=function(){return this._binding.reset()},Od.prototype._flush=function(e){this._transform(new Li(0),"",e)},Od.prototype.flush=function(e,t){var n=this._writableState;if(("function"==typeof e||void 0===e&&!t)&&(t=e,e=kd.Z_FULL_FLUSH),n.ended)t&&Aa(t);else if(n.ending)t&&this.once("end",t);else if(n.needDrain){var o=this;this.once("drain",(function(){o.flush(t)}))}else this._flushFlag=e,this.write(new Li(0),"",t)},Od.prototype.close=function(e){if(e&&Aa(e),!this._closed){this._closed=!0,this._binding.close();var t=this;Aa((function(){t.emit("close")}))}},Od.prototype._transform=function(e,t,n){var o,r=this._writableState,i=(r.ending||r.ended)&&(!e||r.length===e.length);if(null===!e&&!fa(e))return n(new Error("invalid input"));i?o=kd.Z_FINISH:(o=this._flushFlag,e.length>=r.length&&(this._flushFlag=this._opts.flush||kd.Z_NO_FLUSH)),this._processChunk(e,o,n)},Od.prototype._processChunk=function(e,t,n){var o=e&&e.length,r=this._chunkSize-this._offset,i=0,a=this,s="function"==typeof n;if(!s){var u,c=[],l=0;this.on("error",(function(e){u=e}));do{var d=this._binding.writeSync(t,e,i,o,this._buffer,this._offset,r)}while(!this._hadError&&h(d[0],d[1]));if(this._hadError)throw u;var p=Li.concat(c,l);return this.close(),p}var f=this._binding.write(t,e,i,o,this._buffer,this._offset,r);function h(u,d){if(!a._hadError){var p=r-d;if(function(e,t){if(!e)throw new Error("have should not go down")}(p>=0),p>0){var f=a._buffer.slice(a._offset,a._offset+p);a._offset+=p,s?a.push(f):(c.push(f),l+=f.length)}if((0===d||a._offset>=a._chunkSize)&&(r=a._chunkSize,a._offset=0,a._buffer=new Li(a._chunkSize)),0===d){if(i+=o-u,o=u,!s)return!0;var g=a._binding.write(t,e,i,o,a._buffer,a._offset,a._chunkSize);return g.callback=h,void(g.buffer=e)}if(!s)return!1;n()}}f.buffer=e,f.callback=h},Fa(bd,Od),Fa(Dd,Od),Fa(Ed,Od),Fa(Ad,Od),Fa(Ld,Od),Fa(Rd,Od),Fa(wd,Od);var Nd=function(e,t){return Sd(new bd(t),e)},Pd=function(e,t){return Sd(new Dd(t),e)},Gd=function(){function e(t,n,o){Fn(this,e),this.SDKAPPID=t,this.EXPIRETIME=o,this.PRIVATEKEY=n}return Vn(e,[{key:"genTestUserSig",value:function(e){return this._isNumber(this.SDKAPPID)?this._isString(this.PRIVATEKEY)?this._isString(e)?this._isNumber(this.EXPIRETIME)?(console.log("sdkAppID="+this.SDKAPPID+" key="+this.PRIVATEKEY+" userID="+e+" expire="+this.EXPIRETIME),this.genSigWithUserbuf(e,this.EXPIRETIME,null)):(console.error("expireTime must be a number"),""):(console.error("userID must be a string"),""):(console.error("privateKey must be a string"),""):(console.error("sdkAppID must be a number"),"")}},{key:"newBuffer",value:function(e,t){return Li.from?Li.from(e,t):new Li(e,t)}},{key:"unescape",value:function(e){return e.replace(/_/g,"=").replace(/\-/g,"/").replace(/\*/g,"+")}},{key:"escape",value:function(e){return e.replace(/\+/g,"*").replace(/\//g,"-").replace(/=/g,"_")}},{key:"encode",value:function(e){return this.escape(this.newBuffer(e).toString("base64"))}},{key:"decode",value:function(e){return this.newBuffer(this.unescape(e),"base64")}},{key:"base64encode",value:function(e){return this.newBuffer(e).toString("base64")}},{key:"base64decode",value:function(e){return this.newBuffer(e,"base64").toString()}},{key:"_hmacsha256",value:function(e,t,n,o){var r="TLS.identifier:"+e+"\n";r+="TLS.sdkappid:"+this.SDKAPPID+"\n",r+="TLS.time:"+t+"\n",r+="TLS.expire:"+n+"\n",null!=o&&(r+="TLS.userbuf:"+o+"\n");var i=ma.HmacSHA256(r,this.PRIVATEKEY);return ma.enc.Base64.stringify(i)}},{key:"_utc",value:function(){return Math.round(Date.now()/1e3)}},{key:"_isNumber",value:function(e){return null!==e&&("number"==typeof e&&!isNaN(e-0)||"object"==typeof e&&e.constructor===Number)}},{key:"_isString",value:function(e){return"string"==typeof e}},{key:"genSigWithUserbuf",value:function(e,t,n){var o=this._utc(),r={"TLS.ver":"2.0","TLS.identifier":e,"TLS.sdkappid":this.SDKAPPID,"TLS.time":o,"TLS.expire":t},i="";if(null!=n){var a=this.base64encode(n);r["TLS.userbuf"]=a,i=this._hmacsha256(e,o,t,a)}else i=this._hmacsha256(e,o,t,null);r["TLS.sig"]=i;var s=JSON.stringify(r),u=Nd(this.newBuffer(s)).toString("base64"),c=this.escape(u);return console.log("ret="+c),c}},{key:"validate",value:function(e){var t=this.decode(e),n=Pd(t);console.log("validate ret="+n)}}]),e}(),Ud=604800;function xd(e,t,n){return console.log({SDKAppID:e,secretKey:t,userID:n}),{sdkAppID:e,userSig:new Gd(e,t,Ud).genTestUserSig(n)}}var Fd=function(t){var n=(0,e.useState)(!!t),o=(0,r.Z)(n,2),i=o[0],a=o[1],s=(0,e.useCallback)((function(){return a((function(e){return!e}))}),[]);return[i,s,a]},qd=(0,e.createContext)(void 0),Bd=function(e){var t=e.children,n=e.value;return(0,C.jsx)(qd.Provider,{value:n,children:t})},Vd=function(t){var n=(0,e.useContext)(qd);return!n&&t?{}:n},Hd=n(2266);var Kd=0;function jd(e,t){var n="atom".concat(++Kd),o={toString:function(){return n}};return"function"===typeof e?o.read=e:(o.init=e,o.read=function(e){return e(o)},o.write=function(e,t,n){return t(o,"function"===typeof n?n(e(o)):n)}),t&&(o.write=t),o}var zd,Zd=function(e){return"init"in e},Wd=function(e){return!!e.write},Yd=new WeakMap,Jd=function(e,t){var n=Yd.get(e);n&&(Yd.delete(e),n(t))},Xd=function(e,t){e.status="fulfilled",e.value=t},$d=function(e,t){e.status="rejected",e.reason=t},Qd=function(e,t){return"v"in e&&"v"in t&&Object.is(e.v,t.v)},ep=function(e,t){return"e"in e&&"e"in t&&Object.is(e.e,t.e)},tp=function(e){return"v"in e&&e.v instanceof Promise},np=function(e){if("e"in e)throw e.e;return e.v},op=function(){var e,t,n,o=new WeakMap,i=new WeakMap,a=new Map;e=new Set,t=new Set,n=new Set;var s=function(e){return o.get(e)},u=function(e,t){Object.freeze(t);var n=o.get(e);if(o.set(e,t),a.has(e)||a.set(e,n),n&&tp(n)){var r="v"in t?t.v instanceof Promise?t.v:Promise.resolve(t.v):Promise.reject(t.e);Jd(n.v,r)}},c=function(e,t,n){var o=new Map,r=!1;n.forEach((function(n){var i=n===e?t:s(n);i?(o.set(n,i),t.d.get(n)!==i&&(r=!0)):console.warn("[Bug] atom state not found")})),(r||t.d.size!==o.size)&&(t.d=o)},l=function(e,t,n){var o=s(e),r={d:(null==o?void 0:o.d)||new Map,v:t};return n&&c(e,r,n),o&&Qd(o,r)&&o.d===r.d?o:(u(e,r),r)},d=function e(t){var n=s(t);if(n&&(n.d.forEach((function(n,o){o===t||i.has(o)||e(o)})),Array.from(n.d).every((function(e){var n=(0,r.Z)(e,2),o=n[0],i=n[1];return o===t||s(o)===i}))))return n;var o,a,d=new Set,p=!0,f={get signal(){return o||(o=new AbortController),o.signal},get setSelf(){return Wd(t)||console.warn("setSelf function cannot be used with read-only atom"),!a&&Wd(t)&&(a=function(){if(p&&console.warn("setSelf function cannot be called in sync"),!p){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return v.apply(void 0,[t].concat(n))}}),a}};try{var h=t.read((function(n){if(d.add(n),n===t){var o=s(n);if(o)return np(o);if(Zd(n))return n.init;throw new Error("no atom init")}var r=e(n);return np(r)}),f);if(h instanceof Promise){var g,m=new Promise((function(e,n){var o=!1;h.then((function(n){o||(o=!0,l(t,m,d),Xd(m,n),e(n))}),(function(e){o||(o=!0,l(t,m,d),$d(m,e),n(e))})),g=function(t){o||(o=!0,t.then((function(e){return Xd(m,e)}),(function(e){return $d(m,e)})),e(t))}}));return m.status="pending",function(e,t){Yd.set(e,t),e.catch((function(){})).finally((function(){return Yd.delete(e)}))}(m,(function(e){e&&g(e),null==o||o.abort()})),l(t,m,d)}return l(t,h,d)}catch(_){return function(e,t,n){var o=s(e),r={d:(null==o?void 0:o.d)||new Map,e:t};return n&&c(e,r,n),o&&ep(o,r)&&o.d===r.d?o:(u(e,r),r)}(t,_,d)}finally{p=!1}},p=function(e){return np(d(e))},f=function(e,t){return!t.l.size&&(!t.t.size||1===t.t.size&&t.t.has(e))},h=function e(t){var n=i.get(t);null==n||n.t.forEach((function(n){if(n!==t){var o=s(n),r=d(n);o&&Qd(o,r)||e(n)}}))},g=function e(t){for(var n=!0,o=arguments.length,r=new Array(o>1?o-1:0),i=1;i<o;i++)r[i-1]=arguments[i];var a=t.write.apply(t,[function(e){return np(d(e))},function(o){for(var r,i=arguments.length,a=new Array(i>1?i-1:0),u=1;u<i;u++)a[u-1]=arguments[u];if(o===t){if(!Zd(o))throw new Error("atom not writable");var c=s(o),d=l(o,a[0]);c&&Qd(c,d)||h(o)}else r=e.apply(void 0,[o].concat(a));return n||M(),r}].concat(r));return n=!1,a},v=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),o=1;o<t;o++)n[o-1]=arguments[o];var r=g.apply(void 0,[e].concat(n));return M(),r},m=function e(t,o){var r={t:new Set(o&&[o]),l:new Set};if(i.set(t,r),n.add(t),d(t).d.forEach((function(n,o){var r=i.get(o);r?r.t.add(t):o!==t&&e(o,t)})),d(t),Wd(t)&&t.onMount){var a=t.onMount((function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return v.apply(void 0,[t].concat(n))}));a&&(r.u=a)}return r},_=function e(t){var o,r=null==(o=i.get(t))?void 0:o.u;r&&r(),i.delete(t),n.delete(t);var a=s(t);a?(tp(a)&&Jd(a.v),a.d.forEach((function(n,o){if(o!==t){var r=i.get(o);r&&(r.t.delete(t),f(o,r)&&e(o))}}))):console.warn("[Bug] could not find atom state to unmount",t)},y=function(e,t,n){var o=new Set(t.d.keys());null==n||n.forEach((function(t,n){if(o.has(n))o.delete(n);else{var r=i.get(n);r&&(r.t.delete(e),f(n,r)&&_(n))}})),o.forEach((function(t){var n=i.get(t);n?n.t.add(e):i.has(e)&&m(t,e)}))},M=function(){for(;a.size;){var n=Array.from(a);a.clear(),n.forEach((function(e){var t=(0,r.Z)(e,2),n=t[0],o=t[1],a=s(n);if(a){a.d!==(null==o?void 0:o.d)&&y(n,a,null==o?void 0:o.d);var u=i.get(n);!u||o&&!tp(o)&&(Qd(o,a)||ep(o,a))||u.l.forEach((function(e){return e()}))}else console.warn("[Bug] no atom state to flush")}))}e.forEach((function(e){return e()})),t.forEach((function(e){return e("state")}))},I=function(e,n){var o=function(e){var t=i.get(e);return t||(t=m(e)),t}(e);M();var r=o.l;return r.add(n),t.forEach((function(e){return e("sub")})),function(){r.delete(n),function(e){var t=i.get(e);t&&f(e,t)&&_(e)}(e),t.forEach((function(e){return e("unsub")}))}};return{get:p,set:v,sub:I,dev_subscribe_state:function(t){return console.warn("[DEPRECATED] dev_subscribe_state is deprecated and will be removed in the next minor version. use dev_subscribe_store instead."),e.add(t),function(){e.delete(t)}},dev_subscribe_store:function(e){return t.add(e),function(){t.delete(e)}},dev_get_mounted_atoms:function(){return n.values()},dev_get_atom_state:function(e){return o.get(e)},dev_get_mounted:function(e){return i.get(e)},dev_restore_atoms:function(e){var t,n=function(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=(0,Hd.Z)(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var o=0,r=function(){};return{s:r,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}(e);try{for(n.s();!(t=n.n()).done;){var o=(0,r.Z)(t.value,2),i=o[0],a=o[1];Zd(i)&&(l(i,a),h(i))}}catch(s){n.e(s)}finally{n.f()}M()}}},rp=jd(""),ip=jd(""),ap=(0,e.createContext)(void 0),sp=function(t){var n=(0,e.useContext)(ap);return(null==t?void 0:t.store)||n||(zd||(zd=op()),zd)},up=function(e){return e instanceof Promise},cp=e.use||function(e){if("pending"===e.status)throw e;if("fulfilled"===e.status)return e.value;throw"rejected"===e.status?e.reason:(e.status="pending",e.then((function(t){e.status="fulfilled",e.value=t}),(function(t){e.status="rejected",e.reason=t})),e)};function lp(t,n){var o=sp(n),i=(0,e.useReducer)((function(e){var n=o.get(t);return Object.is(e[0],n)&&e[1]===o&&e[2]===t?e:[n,o,t]}),void 0,(function(){return[o.get(t),o,t]})),a=(0,r.Z)(i,2),s=(0,r.Z)(a[0],3),u=s[0],c=s[1],l=s[2],d=a[1],p=u;c===o&&l===t||(d(),p=o.get(t));var f=null==n?void 0:n.delay;return(0,e.useEffect)((function(){var e=o.sub(t,(function(){"number"!==typeof f?d():setTimeout(d,f)}));return d(),e}),[o,t,f]),(0,e.useDebugValue)(p),up(p)?cp(p):p}function dp(t,n){var o=sp(n),r=(0,e.useCallback)((function(){if(!("write"in t))throw new Error("not writable atom");for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return o.set.apply(o,[t].concat(n))}),[o,t]);return r}function pp(e,t){return[lp(e,t),dp(e,t)]}var fp=function(){var e=me(ge().mark((function e(t){return ge().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){t.registerPlugin({"tim-upload-plugin":gi()}),e()})));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),hp=function(t){var n=pp(rp),o=(0,r.Z)(n,2)[1],i=Fd(!0),a=(0,r.Z)(i,3),s=a[0],u=a[2],c=(0,e.useState)(""),l=(0,r.Z)(c,2),d=l[0],p=l[1],f=(0,e.useState)(""),h=(0,r.Z)(f,2),g=h[0],v=h[1],m=(0,e.useState)(""),_=(0,r.Z)(m,2),y=_[0],M=_[1],I=function(){var e=me(ge().mark((function e(){var n;return ge().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=fi().create({SDKAppID:+d}),console.log("init"),e.next=4,fp(n);case 4:return console.log("login"),e.next=7,n.login({userID:y,userSig:xd(+d,g,y).userSig});case 7:console.log("setTim"),o(y),t.setTim(n);case 10:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,C.jsxs)(W,{spacing:2,sx:{width:500},children:[(0,C.jsx)(kr,{id:"outlined-basic",label:"SDKAppID",variant:"outlined",sx:{width:200},onChange:function(e){var t=e.target.value;p(t),u(t.length*g.length*y.length===0)}}),(0,C.jsx)(kr,{id:"outlined-basic",label:"Secret key",variant:"outlined",onChange:function(e){var t=e.target.value;v(t),u(d.length*t.length*y.length===0)}}),(0,C.jsx)(kr,{id:"outlined-basic",label:"My userId",value:y,variant:"outlined",sx:{width:200},onChange:function(e){var t=e.target.value;M(t),u(d.length*g.length*t.length===0)}}),(0,C.jsx)(di,{disabled:s,variant:"contained",sx:{width:150},onClick:I,children:"create Client"})]})};function gp(e){return(0,m.Z)("MuiDivider",e)}(0,Y.Z)("MuiDivider",["root","absolute","fullWidth","inset","middle","flexItem","light","vertical","withChildren","withChildrenVertical","textAlignRight","textAlignLeft","wrapper","wrapperVertical"]);var vp,mp=["absolute","children","className","component","flexItem","light","orientation","role","textAlign","variant"],_p=(0,A.ZP)("div",{name:"MuiDivider",slot:"Root",overridesResolver:function(e,t){var n=e.ownerState;return[t.root,n.absolute&&t.absolute,t[n.variant],n.light&&t.light,"vertical"===n.orientation&&t.vertical,n.flexItem&&t.flexItem,n.children&&t.withChildren,n.children&&"vertical"===n.orientation&&t.withChildrenVertical,"right"===n.textAlign&&"vertical"!==n.orientation&&t.textAlignRight,"left"===n.textAlign&&"vertical"!==n.orientation&&t.textAlignLeft]}})((function(e){var t=e.theme,n=e.ownerState;return(0,h.Z)({margin:0,flexShrink:0,borderWidth:0,borderStyle:"solid",borderColor:(t.vars||t).palette.divider,borderBottomWidth:"thin"},n.absolute&&{position:"absolute",bottom:0,left:0,width:"100%"},n.light&&{borderColor:t.vars?"rgba(".concat(t.vars.palette.dividerChannel," / 0.08)"):(0,se.Fq)(t.palette.divider,.08)},"inset"===n.variant&&{marginLeft:72},"middle"===n.variant&&"horizontal"===n.orientation&&{marginLeft:t.spacing(2),marginRight:t.spacing(2)},"middle"===n.variant&&"vertical"===n.orientation&&{marginTop:t.spacing(1),marginBottom:t.spacing(1)},"vertical"===n.orientation&&{height:"100%",borderBottomWidth:0,borderRightWidth:"thin"},n.flexItem&&{alignSelf:"stretch",height:"auto"})}),(function(e){var t=e.theme,n=e.ownerState;return(0,h.Z)({},n.children&&{display:"flex",whiteSpace:"nowrap",textAlign:"center",border:0,"&::before, &::after":{position:"relative",width:"100%",borderTop:"thin solid ".concat((t.vars||t).palette.divider),top:"50%",content:'""',transform:"translateY(50%)"}})}),(function(e){var t=e.theme,n=e.ownerState;return(0,h.Z)({},n.children&&"vertical"===n.orientation&&{flexDirection:"column","&::before, &::after":{height:"100%",top:"0%",left:"50%",borderTop:0,borderLeft:"thin solid ".concat((t.vars||t).palette.divider),transform:"translateX(0%)"}})}),(function(e){var t=e.ownerState;return(0,h.Z)({},"right"===t.textAlign&&"vertical"!==t.orientation&&{"&::before":{width:"90%"},"&::after":{width:"10%"}},"left"===t.textAlign&&"vertical"!==t.orientation&&{"&::before":{width:"10%"},"&::after":{width:"90%"}})})),yp=(0,A.ZP)("span",{name:"MuiDivider",slot:"Wrapper",overridesResolver:function(e,t){var n=e.ownerState;return[t.wrapper,"vertical"===n.orientation&&t.wrapperVertical]}})((function(e){var t=e.theme,n=e.ownerState;return(0,h.Z)({display:"inline-block",paddingLeft:"calc(".concat(t.spacing(1)," * 1.2)"),paddingRight:"calc(".concat(t.spacing(1)," * 1.2)")},"vertical"===n.orientation&&{paddingTop:"calc(".concat(t.spacing(1)," * 1.2)"),paddingBottom:"calc(".concat(t.spacing(1)," * 1.2)")})})),Mp=e.forwardRef((function(e,t){var n=(0,L.Z)({props:e,name:"MuiDivider"}),o=n.absolute,r=void 0!==o&&o,i=n.children,a=n.className,s=n.component,u=void 0===s?i?"div":"hr":s,c=n.flexItem,l=void 0!==c&&c,d=n.light,p=void 0!==d&&d,v=n.orientation,m=void 0===v?"horizontal":v,y=n.role,M=void 0===y?"hr"!==u?"separator":void 0:y,I=n.textAlign,k=void 0===I?"center":I,T=n.variant,S=void 0===T?"fullWidth":T,b=(0,f.Z)(n,mp),D=(0,h.Z)({},n,{absolute:r,component:u,flexItem:l,light:p,orientation:m,role:M,textAlign:k,variant:S}),E=function(e){var t=e.absolute,n=e.children,o=e.classes,r=e.flexItem,i=e.light,a=e.orientation,s=e.textAlign,u={root:["root",t&&"absolute",e.variant,i&&"light","vertical"===a&&"vertical",r&&"flexItem",n&&"withChildren",n&&"vertical"===a&&"withChildrenVertical","right"===s&&"vertical"!==a&&"textAlignRight","left"===s&&"vertical"!==a&&"textAlignLeft"],wrapper:["wrapper","vertical"===a&&"wrapperVertical"]};return(0,_.Z)(u,gp,o)}(D);return(0,C.jsx)(_p,(0,h.Z)({as:u,className:(0,g.Z)(E.root,a),role:M,ref:t,ownerState:D},b,{children:i?(0,C.jsx)(yp,{className:E.wrapper,ownerState:D,children:i}):null}))})),Ip=function(){var e=pp(rp),t=(0,r.Z)(e,1)[0];return(0,C.jsx)(W,{spacing:2,sx:{width:200},children:(0,C.jsxs)("p",{children:["UserID:",t]})})},Cp=n(3437),kp=n.n(Cp),Tp=n(7967),Sp=function(){var t=pp(ip),n=(0,r.Z)(t,2),o=n[0],i=n[1],a=Fd(!0),s=(0,r.Z)(a,3),u=s[0],c=s[2],l=(0,e.useState)(""),d=(0,r.Z)(l,2),p=d[0],f=d[1],h=(0,e.useState)(""),g=(0,r.Z)(h,2),v=g[0],m=g[1],_=Vd().tim,y=function(){var e=me(ge().mark((function e(){var t,n;return ge().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=_.createTextMessage({to:p,conversationType:kp().TYPES.CONV_C2C,payload:{text:v}}),e.next=3,_.sendMessage(t);case 3:n=">>> ".concat(p,":").concat(v,"<br>").concat(o),i(n),m("");case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,C.jsxs)(W,{spacing:2,children:[(0,C.jsx)(kr,{id:"outlined-basic",label:"Peer userId",variant:"outlined",value:p,onChange:function(e){var t=e.target.value;f(t),c(0===t.length||0===v.length)}}),(0,C.jsx)(kr,{id:"standard-multiline-flexible",label:"Message",value:v,multiline:!0,rows:4,variant:"outlined",sx:{width:"500px"},onChange:function(e){var t=e.target.value;m(t),c(0===p.length||0===t.length)}}),(0,C.jsx)(di,{disabled:u,variant:"contained",endIcon:(0,C.jsx)(Tp.Z,{}),sx:{width:100},onClick:y,children:"Send"})]})},bp=void 0,Dp=function(){var t=pp(ip),n=(0,r.Z)(t,2),o=n[0],i=n[1];return function(t){var n=Vd("useMessageReceviedListener").tim;(0,e.useEffect)((function(){console.log("useEffect",{tim:n});var e=function(e){console.log("handleMessageRecevied",e.data),t(e.data)};return n.on(kp().EVENT.MESSAGE_RECEIVED,e,bp),function(){n.off(kp().EVENT.MESSAGE_RECEIVED,e,bp)}}),[n,t])}((function(e){console.log("updateMessageList",{messageList:e});var t=o;e.forEach((function(e){t="<<< [".concat(e.time,"] ").concat(e.from,",").concat(e.nick,",").concat(e.payload.text,"<br>").concat(t)})),i(t)})),(0,C.jsxs)("div",{children:[(0,C.jsx)(te,{variant:"h2",sx:{fontSize:18},children:"Log"}),(0,C.jsx)("p",{dangerouslySetInnerHTML:{__html:o}})]})},Ep=function(e){var t=e.tim;return(0,C.jsx)(Bd,{value:{tim:t},children:(0,C.jsxs)(W,{spacing:4,children:[(0,C.jsxs)(W,{direction:"row",divider:(0,C.jsx)(Mp,{orientation:"vertical",flexItem:!0}),spacing:4,children:[(0,C.jsx)(Ip,{}),(0,C.jsx)(Sp,{})]}),(0,C.jsx)(Dp,{})]})})},Ap=C.Fragment;function Lp(e,t,n){return i.h.call(t,"css")?(0,C.jsx)(i.E,(0,i.c)(e,t),n):(0,C.jsx)(e,t,n)}function Rp(e,t,n){return i.h.call(t,"css")?(0,C.jsxs)(i.E,(0,i.c)(e,t),n):(0,C.jsxs)(e,t,n)}function wp(){var t=(0,e.useState)(),n=(0,r.Z)(t,2),o=n[0],i=n[1];return Lp(Ap,{children:Lp(w,{sx:{padding:4},children:Rp(W,{spacing:4,children:[Rp(W,{direction:"row",justifyContent:"space-between",children:[Lp(te,{variant:"h1",sx:{fontSize:24},children:"Tencent Chat - Peer Message Tool"}),Lp("p",{children:Rp(pe,{href:"https://github.com/1-10/2303_Tencent_tim",underline:"always",color:"secondary",target:"_blank",css:Op,children:[Lp(fe.Z,{sx:{mr:1}})," GitHub"]})})]}),void 0===o?Lp(hp,{setTim:i}):Lp(Ep,{tim:o})]})})})}var Op=l(vp||(vp=o(["\n  display: flex;\n  align-items: center;\n  color: #009688;\n"]))),Np=function(e){e&&e instanceof Function&&n.e(596).then(n.bind(n,4596)).then((function(t){var n=t.getCLS,o=t.getFID,r=t.getFCP,i=t.getLCP,a=t.getTTFB;n(e),o(e),r(e),i(e),a(e)}))};t.createRoot(document.getElementById("root")).render((0,C.jsx)(e.StrictMode,{children:(0,C.jsx)(wp,{})})),Np()}()}();
//# sourceMappingURL=main.d1a10fad.js.map